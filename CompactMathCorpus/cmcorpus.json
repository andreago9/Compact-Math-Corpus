{
  "sentences": [
    "Abstract Algebra\nTheory and Applications\n\nAbstract Algebra\nTheory and Applications\nThomas W. Judson\nStephen F. Austin State University\nSage Exercises for Abstract Algebra\nRobert A. Beezer\nUniversity of Puget Sound\nTraducción al español\nAntonio Behn\nUniversidad de Chile\nJuly 28, 2022\n\nEdition: Annual Edition 2022\nWebsite:",
    "abstract.pugetsound.edu\n©1997–2022\nThomas W. Judson, Robert A. Beezer\nPermission is granted to copy, distribute and/or modify this document under the terms\nof the GNU Free Documentation License, Version 1.2 or any later version published by\nthe Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no\nBack-Cover Texts.",
    "A copy of the license is included in the appendix entitled “GNU Free\nDocumentation License.”\n\n",
    "Acknowledgements\nI would like to acknowledge the following reviewers for their helpful comments and sugges-\ntions.\n• David Anderson, University of Tennessee, Knoxville\n• Robert Beezer, University of Puget Sound\n• Myron Hood, California Polytechnic State University\n• Herbert Kasube, Bradley University\n• John Kurtzke, University of Portland\n• Inessa Levi, University of Louisville\n• Geoffrey Mason, University of California, Santa Cruz\n• Bruce Mericle, Mankato State University\n• Kimmo Rosenthal, Union College\n• Mark Teply, University of Wisconsin\nI would also like to thank Steve Quigley, Marnie Pommett, Cathie Griﬀin, Kelle Karshick,\nand the rest of the staff at PWS Publishing for their guidance throughout this project.",
    "It\nhas been a pleasure to work with them.\n",
    "Robert Beezer encouraged me to make Abstract Algebra: Theory and Applications avail-\nable as an open source textbook, a decision that I have never regretted.",
    "With his assistance,\nthe book has been rewritten in PreTeXt (pretextbook.org1), making it possible to quickly\noutput print, web, pdf versions and more from the same source.",
    "The open source version\nof this book has received support from the National Science Foundation (Awards #DUE-\n1020957, #DUE–1625223, and #DUE–1821329).\n",
    "1pretextbook.org\niv\n\nPreface\nThis text is intended for a one or two-semester undergraduate course in abstract algebra.\n",
    "Traditionally, these courses have covered the theoretical aspects of groups, rings, and fields.\n",
    "However, with the development of computing in the last several decades, applications that\ninvolve abstract algebra and discrete mathematics have become increasingly important,\nand many science, engineering, and computer science students are now electing to minor in\nmathematics.",
    "Though theory still occupies a central role in the subject of abstract algebra\nand no student should go through such a course without a good notion of what a proof is, the\nimportance of applications such as coding theory and cryptography has grown significantly.\n",
    "Until recently most abstract algebra texts included few if any applications.",
    "However,\none of the major problems in teaching an abstract algebra course is that for many students it\nis their first encounter with an environment that requires them to do rigorous proofs.",
    "Such\nstudents often find it hard to see the use of learning to prove theorems and propositions;\napplied examples help the instructor provide motivation.\n",
    "This text contains more material than can possibly be covered in a single semester.\n",
    "Certainly there is adequate material for a two-semester course, and perhaps more; however,\nfor a one-semester course it would be quite easy to omit selected chapters and still have a\nuseful text.",
    "The order of presentation of topics is standard: groups, then rings, and finally\nfields.",
    "Emphasis can be placed either on theory or on applications.",
    "A typical one-semester\ncourse might cover groups and rings while briefly touching on field theory, using Chapters 1\nthrough 6, 9, 10, 11, 13 (the first part), 16, 17, 18 (the first part), 20, and 21.",
    "Parts of\nthese chapters could be deleted and applications substituted according to the interests of\nthe students and the instructor.",
    "A two-semester course emphasizing theory might cover\nChapters 1 through 6, 9, 10, 11, 13 through 18, 20, 21, 22 (the first part), and 23.",
    "On\nthe other hand, if applications are to be emphasized, the course might cover Chapters 1\nthrough 14, and 16 through 22.",
    "In an applied course, some of the more theoretical results\ncould be assumed or omitted.",
    "A chapter dependency chart appears below.",
    "(A broken line\nindicates a partial dependency.)\nv\n\nvi\nChapters 1–6\nChapter 8\nChapter 9\nChapter 7\nChapter 10\nChapter 11\nChapter 13\nChapter 16\nChapter 12\nChapter 14\nChapter 17\nChapter 15\nChapter 18\nChapter 20\nChapter 19\nChapter 21\nChapter 22\nChapter 23\nThough there are no specific prerequisites for a course in abstract algebra, students\nwho have had other higher-level courses in mathematics will generally be more prepared\nthan those who have not, because they will possess a bit more mathematical sophistication.\n",
    "Occasionally, we shall assume some basic linear algebra; that is, we shall take for granted an\nelementary knowledge of matrices and determinants.",
    "This should present no great problem,\nsince most students taking a course in abstract algebra have been introduced to matrices\nand determinants elsewhere in their career, if they have not already taken a sophomore or\njunior-level course in linear algebra.\n",
    "Exercise sections are the heart of any mathematics text.",
    "An exercise set appears at the\nend of each chapter.",
    "The nature of the exercises ranges over several categories; computa-\ntional, conceptual, and theoretical problems are included.",
    "A section presenting hints and\nsolutions to many of the exercises appears at the end of the text.",
    "Often in the solutions\na proof is only sketched, and it is up to the student to provide the details.",
    "The exercises\nrange in diﬀiculty from very easy to very challenging.",
    "Many of the more substantial prob-\nlems require careful thought, so the student should not be discouraged if the solution is not\nforthcoming after a few minutes of work.\n",
    "Ideally, students should read the relavent material before attending class.",
    "Reading ques-\ntions have been added to each chapter before the exercises.",
    "To prepare for class, students\n\nvii\nshould read the chapter before class and then answer the section’s reading questions to\nprepare for the class.\n",
    "There are additional exercises or computer projects at the ends of many of the chapters.\n",
    "The computer projects usually require a knowledge of programming.",
    "All of these exercises\nand projects are more substantial in nature and allow the exploration of new results and\ntheory.\n",
    "Sage (sagemath.org2) is a free, open source, software system for advanced mathematics,\nwhich is ideal for assisting with a study of abstract algebra.",
    "Sage can be used either on\nyour own computer, a local server, or on CoCalc (cocalc.com3).",
    "Robert Beezer has written\na comprehensive introduction to Sage and a selection of relevant exercises that appear at\nthe end of each chapter, including live Sage cells in the web version of the book.",
    "All of the\nSage code has been subject to automated tests of accuracy, using the most recent version\navailable at this time: SageMath Version 9.6 (released 2022-05-15).\n",
    "Thomas W. Judson\nNacogdoches, Texas 2022\n2sagemath.org\n3cocalc.com\n\nContents\nAcknowledgements\niv\nPreface\nv\n1 Preliminaries\n1\n1.1\nA Short Note on Proofs\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "1\n1.2\nSets and Equivalence Relations\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "3\n1.3\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "13\n1.4\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "14\n1.5\nReferences and Suggested Readings.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "16\n2 The Integers\n17\n2.1\nMathematical Induction .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    ".\n.\n",
    "17\n2.2\nThe Division Algorithm\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "20\n2.3\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "24\n2.4\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "24\n2.5\nProgramming Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "26\n2.6\nReferences and Suggested Readings.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "26\n3 Groups\n28\n3.1\nInteger Equivalence Classes and Symmetries .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "28\n3.2\nDefinitions and Examples.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "33\n3.3\nSubgroups.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "38\n3.4\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "40\n3.5\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "40\n3.6\nAdditional Exercises: Detecting Errors\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "43\n3.7\nReferences and Suggested Readings.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "45\n4 Cyclic Groups\n46\n4.1\nCyclic Subgroups .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "46\n4.2\nMultiplicative Group of Complex Numbers.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "49\n4.3\nThe Method of Repeated Squares\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "53\nviii\n\nCONTENTS\nix\n4.4\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "55\n4.5\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "55\n4.6\nProgramming Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "58\n4.7\nReferences and Suggested Readings.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "58\n5 Permutation Groups\n59\n5.1\nDefinitions and Notation .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "59\n5.2\nDihedral Groups .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "65\n5.3\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "70\n5.4\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "71\n6 Cosets and Lagrange’s Theorem\n74\n6.1\nCosets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "74\n6.2\nLagrange’s Theorem .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "76\n6.3\nFermat’s and Euler’s Theorems\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "77\n6.4\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "78\n6.5\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "78\n7 Introduction to Cryptography\n81\n7.1\nPrivate Key Cryptography .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "81\n7.2\nPublic Key Cryptography\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "83\n7.3\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "86\n7.4\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "87\n7.5\nAdditional Exercises: Primality and Factoring\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "88\n7.6\nReferences and Suggested Readings.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "89\n8 Algebraic Coding Theory\n91\n8.1\nError-Detecting and Correcting Codes\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "91\n8.2\nLinear Codes.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "98\n8.3\nParity-Check and Generator Matrices .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n101\n8.4\nEﬀicient Decoding\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "106\n8.5\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "109\n8.6\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "109\n8.7\nProgramming Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n113\n8.8\nReferences and Suggested Readings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n113\n9 Isomorphisms\n114\n9.1\nDefinition and Examples .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "114\n9.2\nDirect Products\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "118\n9.3\nReading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "121\n9.4\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "121\n10 Normal Subgroups and Factor Groups\n125\n10.1 Factor Groups and Normal Subgroups.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "125\n10.2 The Simplicity of the Alternating Group.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "127\n10.3 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "130\n10.4 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "130\n\nCONTENTS\nx\n11 Homomorphisms\n133\n11.1 Group Homomorphisms\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "133\n11.2 The Isomorphism Theorems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "135\n11.3 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "138\n11.4 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "138\n11.5 Additional Exercises: Automorphisms .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "139\n12 Matrix Groups and Symmetry\n141\n12.1 Matrix Groups .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "141\n12.2 Symmetry .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "148\n12.3 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "154\n12.4 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n155\n12.5 References and Suggested Readings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "157\n13 The Structure of Groups\n158\n13.1 Finite Abelian Groups .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "158\n13.2 Solvable Groups\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "162\n13.3 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "165\n13.4 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "165\n13.5 Programming Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "167\n13.6 References and Suggested Readings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "167\n14 Group Actions\n168\n14.1 Groups Acting on Sets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "168\n14.2",
    "The Class Equation .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "170\n14.3 Burnside’s Counting Theorem .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "172\n14.4 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "178\n14.5 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "178\n14.6 Programming Exercise .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n180\n14.7 References and Suggested Reading .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "180\n15 The Sylow Theorems\n181\n15.1 The Sylow Theorems\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "181\n15.2 Examples and Applications .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "184\n15.3 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "187\n15.4 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n187\n15.5 A Project .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n188\n15.6 References and Suggested Readings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "189\n16 Rings\n190\n16.1 Rings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "190\n16.2 Integral Domains and Fields\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "193\n16.3 Ring Homomorphisms and Ideals.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "195\n16.4 Maximal and Prime Ideals .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "198\n16.5 An Application to Software Design .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "200\n16.6 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n203\n16.7 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "204\n\nCONTENTS\nxi\n16.8 Programming Exercise .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "207\n16.9 References and Suggested Readings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "207\n17 Polynomials\n209\n17.1 Polynomial Rings .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "209\n17.2 The Division Algorithm\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "212\n17.3 Irreducible Polynomials\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "215\n17.4 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n220\n17.5 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n220\n17.6 Additional Exercises: Solving the Cubic and Quartic Equations\n.\n.\n.\n.\n.\n",
    "222\n18 Integral Domains\n225\n18.1 Fields of Fractions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "225\n18.2 Factorization in Integral Domains\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "228\n18.3 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "235\n18.4 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "235\n18.5 References and Suggested Readings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "237\n19 Lattices and Boolean Algebras\n238\n19.1 Lattices.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "238\n19.2 Boolean Algebras .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "241\n19.3 The Algebra of Electrical Circuits .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "246\n19.4 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "248\n19.5 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "249\n19.6 Programming Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "251\n19.7 References and Suggested Readings.\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "251\n20 Vector Spaces\n252\n20.1 Definitions and Examples.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "252\n20.2 Subspaces .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "253\n20.3 Linear Independence\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "254\n20.4 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "256\n20.5 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "256\n20.6 References and Suggested Readings.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "259\n21 Fields\n260\n21.1 Extension Fields .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "260\n21.2 Splitting Fields .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "268\n21.3 Geometric Constructions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "270\n21.4 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "275\n21.5 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "275\n21.6 References and Suggested Readings.\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "277\n22 Finite Fields\n278\n22.1 Structure of a Finite Field .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "278\n22.2 Polynomial Codes.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "282\n22.3 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "289\n\nCONTENTS\nxii\n22.4 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "289\n22.5 Additional Exercises: Error Correction for BCH Codes .\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "291\n22.6 References and Suggested Readings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "291\n23 Galois Theory\n293\n23.1 Field Automorphisms .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "293\n23.2 The Fundamental Theorem .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "297\n23.3 Applications .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n303\n23.4 Reading Questions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "307\n23.5 Exercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "308\n23.6 References and Suggested Readings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "309\nAppendices\nA GNU Free Documentation License\n311\nB Hints and Answers to Selected Exercises\n318\nC Notation\n336\nBack Matter\nIndex\n339\n\n1\nPreliminaries\nA certain amount of mathematical maturity is necessary to find and study applications\nof abstract algebra.",
    "A basic knowledge of set theory, mathematical induction, equivalence\nrelations, and matrices is a must.",
    "Even more important is the ability to read and understand\nmathematical proofs.",
    "In this chapter we will outline the background needed for a course in\nabstract algebra.\n",
    "1.1 A Short Note on Proofs\nAbstract mathematics is different from other sciences.",
    "In laboratory sciences such as chem-\nistry and physics, scientists perform experiments to discover new principles and verify theo-\nries.",
    "Although mathematics is often motivated by physical experimentation or by computer\nsimulations, it is made rigorous through the use of logical arguments.",
    "In studying abstract\nmathematics, we take what is called an axiomatic approach; that is, we take a collection\nof objects S and assume some rules about their structure.",
    "These rules are called axioms.\n",
    "Using the axioms for S, we wish to derive other information about S by using logical argu-\nments.",
    "We require that our axioms be consistent; that is, they should not contradict one\nanother.",
    "We also demand that there not be too many axioms.",
    "If a system of axioms is too\nrestrictive, there will be few examples of the mathematical structure.\n",
    "A statement in logic or mathematics is an assertion that is either true or false.",
    "Consider\nthe following examples:\n• 3 + 56 −13 + 8/2.\n",
    "•",
    "All cats are black.\n",
    "• 2 + 3 = 5.\n• 2x",
    "= 6 exactly when x = 4.\n•",
    "If ax2 + bx + c = 0 and a ̸= 0, then\nx = −b ±\n√\nb2 −4ac\n2a\n.\n",
    "• x3 −4x2 + 5x −6.\n",
    "All but the first and last examples are statements, and must be either true or false.\n",
    "A mathematical proof is nothing more than a convincing argument about the accuracy\nof a statement.",
    "Such an argument should contain enough detail to convince the audience; for\n1\n\nCHAPTER 1.",
    "PRELIMINARIES\n2\ninstance, we can see that the statement “2x = 6 exactly when x = 4” is false by evaluating\n2 · 4 and noting that 6 ̸= 8, an argument that would satisfy anyone.",
    "Of course, audiences\nmay vary widely: proofs can be addressed to another student, to a professor, or to the\nreader of a text.",
    "If more detail than needed is presented in the proof, then the explanation\nwill be either long-winded or poorly written.",
    "If too much detail is omitted, then the proof\nmay not be convincing.",
    "Again it is important to keep the audience in mind.",
    "High school\nstudents require much more detail than do graduate students.",
    "A good rule of thumb for an\nargument in an introductory abstract algebra course is that it should be written to convince\none’s peers, whether those peers be other students or other readers of the text.\n",
    "Let us examine different types of statements.",
    "A statement could be as simple as “10/5 =\n2;” however, mathematicians are usually interested in more complex statements such as “If\np, then q,” where p and q are both statements.",
    "If certain statements are known or assumed\nto be true, we wish to know what we can say about other statements.",
    "Here p is called\nthe hypothesis and q is known as the conclusion.\n",
    "Consider the following statement: If\nax2 + bx + c = 0 and a ̸= 0, then\nx = −b ±\n√\nb2 −4ac\n2a\n.\n",
    "The hypothesis is ax2 + bx + c = 0 and a ̸= 0; the conclusion is\nx = −b ±\n√\nb2 −4ac\n2a\n.\n",
    "Notice that the statement says nothing about whether or not the hypothesis is true.",
    "How-\never, if this entire statement is true and we can show that ax2 + bx + c",
    "= 0 with a ̸= 0 is\ntrue, then the conclusion must be true.",
    "A proof of this statement might simply be a series\nof equations:\nax2 + bx + c",
    "= 0\nx2 + b\nax = −c\na\nx2 + b\nax +\n\u0012 b\n2a\n\u00132\n=\n\u0012 b\n2a\n\u00132\n−c\na\n\u0012\nx + b\n2a\n\u00132\n= b2 −4ac\n4a2\nx + b\n2a = ±\n√\nb2 −4ac\n2a\nx = −b ±\n√\nb2 −4ac\n2a\n.\n",
    "If we can prove a statement true, then that statement is called a proposition.",
    "A propo-\nsition of major importance is called a theorem.",
    "Sometimes instead of proving a theorem\nor proposition all at once, we break the proof down into modules; that is, we prove several\nsupporting propositions, which are called lemmas, and use the results of these propositions\nto prove the main result.",
    "If we can prove a proposition or a theorem, we will often, with\nvery little effort, be able to derive other related propositions called corollaries.\n",
    "Some Cautions and Suggestions\nThere are several different strategies for proving propositions.",
    "In addition to using different\nmethods of proof, students often make some common mistakes when they are first learning\n\nCHAPTER 1.",
    "PRELIMINARIES\n3\nhow to prove theorems.",
    "To aid students who are studying abstract mathematics for the\nfirst time, we list here some of the diﬀiculties that they may encounter and some of the\nstrategies of proof available to them.",
    "It is a good idea to keep referring back to this list as\na reminder.",
    "(Other techniques of proof will become apparent throughout this chapter and\nthe remainder of the text.)\n",
    "•",
    "A theorem cannot be proved by example; however, the standard way to show that a\nstatement is not a theorem is to provide a counterexample.\n",
    "•",
    "Quantifiers are important.",
    "Words and phrases such as only, for all, for every, and for\nsome possess different meanings.\n",
    "• Never assume any hypothesis that is not explicitly stated in the theorem.",
    "You cannot\ntake things for granted.\n",
    "• Suppose you wish to show that an object exists and is unique.",
    "First show that there\nactually is such an object.",
    "To show that it is unique, assume that there are two such\nobjects, say r and s, and then show that r = s.\n• Sometimes it is easier to prove the contrapositive of a statement.",
    "Proving the state-\nment “If p, then q” is exactly the same as proving the statement “If not q, then not\np.”\n•",
    "Although it is usually better to find a direct proof of a theorem, this task can some-\ntimes be diﬀicult.",
    "It may be easier to assume that the theorem that you are trying\nto prove is false, and to hope that in the course of your argument you are forced to\nmake some statement that cannot possibly be true.\n",
    "Remember that one of the main objectives of higher mathematics is proving theorems.\n",
    "Theorems are tools that make new and productive applications of mathematics possible.",
    "We\nuse examples to give insight into existing theorems and to foster intuitions as to what new\ntheorems might be true.",
    "Applications, examples, and proofs are tightly interconnected—\nmuch more so than they may seem at first appearance.\n",
    "1.2 Sets and Equivalence Relations\nSet Theory\n",
    "A set is a well-defined collection of objects; that is, it is defined in such a manner that we\ncan determine for any given object x whether or not x belongs to the set.",
    "The objects that\nbelong to a set are called its elements or members.",
    "We will denote sets by capital letters,\nsuch as A or X; if a is an element of the set A, we write a ∈A.\nA set is usually specified either by listing all of its elements inside a pair of braces or\nby stating the property that determines whether or not an object x belongs to the set.",
    "We\nmight write\nX = {x1, x2, . . .",
    ", xn}\nfor a set containing elements x1, x2, . . .",
    ", xn or\nX = {x : x satisfies P}\nif each x in X satisfies a certain property P.",
    "For example, if E is the set of even positive\nintegers, we can describe E by writing either\nE = {2, 4, 6, . . .",
    "}\nor\nE = {x : x is an even integer and x > 0}.\n\n",
    "CHAPTER 1.",
    "PRELIMINARIES\n4\nWe write 2 ∈E when we want to say that 2 is in the set E, and −3 /∈E to say that −3 is\nnot in the set E.\nSome of the more important sets that we will consider are the following:\nN = {n : n is a natural number} = {1, 2, 3, . . .}",
    ";\nZ = {n : n is an integer} = {. . .",
    ", −1, 0, 1, 2, . . .};\nQ = {r : r is a rational number} = {p/q : p, q ∈Z where q ̸= 0};\nR = {x : x is a real number};\nC = {z : z is a complex number}.\n",
    "We can find various relations between sets as well as perform operations on sets.",
    "A set\nA is a subset of B, written A ⊂B or B ⊃A, if every element of A is also an element of B.\nFor example,\n{4, 5, 8} ⊂{2, 3, 4, 5, 6, 7, 8, 9}\nand\nN ⊂Z ⊂Q ⊂R ⊂C.\nTrivially, every set is a subset of itself.",
    "A set B is a proper subset of a set A if B ⊂A but\nB ̸= A.",
    "If A is not a subset of B, we write A ̸⊂B; for example, {4, 7, 9} ̸⊂{2, 4, 5, 8, 9}.\n",
    "Two sets are equal, written A = B, if we can show that A ⊂B and B ⊂A.\nIt is convenient to have a set with no elements in it.",
    "This set is called the empty set\nand is denoted by ∅. Note that the empty set is a subset of every set.\n",
    "To construct new sets out of old sets, we can perform certain operations: the union\nA ∪B of two sets A and B is defined as\nA ∪B = {x : x ∈A or x ∈B};\nthe intersection of A and B is defined by\nA ∩B = {x : x ∈A and x ∈B}.\n",
    "If A = {1, 3, 5} and B = {1, 2, 3, 9}, then\nA ∪B = {1, 2, 3, 5, 9}\nand\nA ∩B = {1, 3}.\n",
    "We can consider the union and the intersection of more than two sets.",
    "In this case we write\nn[\ni=1\nAi = A1 ∪. . .",
    "∪An\nand\nn\\\ni=1\nAi = A1 ∩. . .",
    "∩An\nfor the union and intersection, respectively, of the sets A1, . .",
    ".",
    ", An.\n",
    "When two sets have no elements in common, they are said to be disjoint; for example,\nif E is the set of even integers and O is the set of odd integers, then E and O are disjoint.\n",
    "Two sets A and B are disjoint exactly when A ∩B = ∅.\n",
    "Sometimes we will work within one fixed set U, called the universal set.",
    "For any set\nA ⊂U, we define the complement of A, denoted by A′, to be the set\nA′ = {x : x ∈U and x /∈A}.\n",
    "We define the difference of two sets A and B to be\nA \\ B = A ∩B′ = {x : x ∈A and x /∈B}.\n\n",
    "CHAPTER 1.",
    "PRELIMINARIES\n5\nExample 1.1 Let R be the universal set and suppose",
    "that\nA = {x ∈R : 0 <",
    "x ≤3}\nand\nB = {x ∈R : 2 ≤x < 4}.\n",
    "Then\nA ∩B = {x ∈R : 2 ≤x ≤3}\nA ∪B = {x ∈R : 0 < x < 4}\nA \\ B = {x ∈R : 0 < x < 2}\nA′ = {x ∈R : x ≤0 or x > 3}.\n",
    "□\nProposition 1.2 Let A, B, and",
    "C be sets.",
    "Then\n1.",
    "A ∪A = A, A ∩A = A, and A \\ A = ∅;\n2.",
    "A ∪∅= A and A ∩∅= ∅;\n3.",
    "A ∪(B ∪C) = (A ∪B) ∪C and A ∩(B ∩C)",
    "= (A ∩B) ∩C;\n4.",
    "A ∪B = B ∪A and A ∩B = B ∩A;\n5.",
    "A ∪(B ∩C)",
    "= (A ∪B) ∩(A ∪C);\n6.",
    "A ∩(B ∪C)",
    "= (A ∩B) ∪(A ∩C).\n",
    "Proof.\n",
    "We will prove (1) and (3) and leave the remaining results to be proven in the\nexercises.\n",
    "(1) Observe that\nA ∪A = {x : x ∈A or x ∈A}\n= {x : x ∈A}\n= A\nand\nA ∩A = {x : x ∈A and x ∈A}\n= {x : x ∈A}\n= A.\nAlso, A \\ A = A ∩A′ = ∅.\n(3) For sets A, B, and C,\nA ∪(B ∪C)",
    "= A ∪{x : x ∈B or x ∈C}\n= {x : x ∈A or x ∈B, or x ∈C}\n= {x : x ∈A or x ∈B} ∪C\n= (A ∪B) ∪C.\nA similar argument proves that A ∩(B ∩C) = (A ∩B)",
    "∩C.\n■\nTheorem 1.3 De Morgan’s Laws.",
    "Let A and B be sets.",
    "Then\n1.",
    "(A ∪B)′ = A′ ∩B′;\n2.",
    "(A ∩B)′ = A′ ∪B′.\n\nCHAPTER 1.",
    "PRELIMINARIES\n6\nProof.",
    "(1) If A∪B = ∅, then the theorem follows immediately since both A and B are the\nempty set.",
    "Otherwise, we must show that (A ∪B)′ ⊂A′ ∩B′ and (A ∪B)′ ⊃A′ ∩B′. Let\nx ∈(A ∪B)′.",
    "Then x /∈A ∪B.",
    "So x is neither in A nor in B, by the definition of the union\nof sets.",
    "By the definition of the complement, x ∈A′ and x ∈B′.",
    "Therefore, x ∈A′ ∩B′\nand we have (A ∪B)′ ⊂A′ ∩B′.\nTo show the reverse inclusion, suppose that x",
    "∈A′ ∩B′.",
    "Then x ∈A′ and x ∈B′, and\nso x /∈A and x /∈B.",
    "Thus x /∈A ∪B and so x ∈(A ∪B)′.",
    "Hence, (A ∪B)′ ⊃A′ ∩B′ and\nso (A ∪B)′ = A′ ∩B′.\n",
    "The proof of (2) is left as an exercise.\n",
    "■\nExample 1.4 Other relations between sets often hold true.",
    "For example,\n(A \\ B) ∩(B \\ A) = ∅.\nTo see that this is true, observe that\n(A \\ B) ∩(B",
    "\\ A) = (A ∩B′) ∩(B",
    "∩A′)\n= A ∩A′ ∩B ∩B′\n= ∅.\n□\nCartesian Products and Mappings\nGiven sets A and B, we can define a new set A × B, called the Cartesian product of A and\nB, as a set of ordered pairs.",
    "That is,\nA × B = {(a, b) : a ∈A and b ∈B}.\n",
    "Example 1.5 If A = {x, y}, B = {1, 2, 3}, and C = ∅, then A × B is the set\n{(x, 1), (x, 2), (x, 3), (y, 1), (y, 2), (y, 3)}\nand\nA × C = ∅.\n□\nWe define the Cartesian product of n sets to be\nA1 × · · · ×",
    "An = {(a1, . . . , an) : ai ∈Ai for i = 1, . . . , n}.\n",
    "If A = A1 = A2 = · · · = An, we often write An for A × · · · ×",
    "A (where A would be written\nn times).",
    "For example, the set R3 consists of all of 3-tuples of real numbers.\n",
    "Subsets of A × B are called relations.",
    "We will define a mapping or function f ⊂A × B\nfrom a set A to a set B to be the special type of relation where each element a ∈A has\na unique element b ∈B such that (a, b) ∈f.",
    "Another way of saying this is that for every\nelement in A, f assigns a unique element in B.",
    "We usually write f : A →B or A\nf→B.\nInstead of writing down ordered pairs (a, b) ∈A × B, we write f(a) = b or f : a 7→b.",
    "The\nset A is called the domain of f and\nf(A) = {f(a) : a ∈A} ⊂B\nis called the range or image of f.",
    "We can think of the elements in the function’s domain as\ninput values and the elements in the function’s range as output values.\n\n",
    "CHAPTER 1.",
    "PRELIMINARIES\n7\nExample 1.6 Suppose",
    "A = {1, 2, 3} and B = {a, b, c}.",
    "In Figure 1.7 we define relations f\nand g from A to B.",
    "The relation f is a mapping, but g is not because 1 ∈A is not assigned\nto a unique element in B; that is, g(1) = a and g(1) = b.\n1\n2\n3\na\nb\nc\nA\nB\nf\nA\nB\ng\n1\n2\n3\na\nb\nc\nFigure 1.7 Mappings and relations\n□\nGiven a function f :",
    "A →B, it is often possible to write a list describing what the\nfunction does to each specific element in the domain.",
    "However, not all functions can be\ndescribed in this manner.",
    "For example, the function f : R →R that sends each real number\nto its cube is a mapping that must be described by writing f(x) = x3 or f :",
    "x 7→x3.\nConsider the relation f : Q →Z given by f(p/q) =",
    "p.",
    "We know that 1/2 = 2/4, but\nis f(1/2) = 1 or 2?",
    "This relation cannot be a mapping because it is not well-defined.",
    "A\nrelation is well-defined if each element in the domain is assigned to a unique element in the\nrange.\n",
    "If f : A →B is a map and the image of f is B, i.e., f(A) = B, then f is said to\nbe onto or surjective.",
    "In other words, if there exists an a ∈A for each b ∈B such that\nf(a) = b, then f is onto.",
    "A map is one-to-one or injective if a1 ̸= a2 implies f(a1) ̸= f(a2).\n",
    "Equivalently, a function is one-to-one if f(a1) = f(a2) implies a1",
    "= a2.",
    "A map that is both\none-to-one and onto is called bijective.\n",
    "Example 1.8 Let f : Z →Q be defined by f(n) = n/1.",
    "Then f is one-to-one but not onto.\n",
    "Define g : Q →Z by g(p/q) = p where p/q is a rational number expressed in its lowest\nterms with a positive denominator.",
    "The function g is onto but not one-to-one.\n□\nGiven two functions, we can construct a new function by using the range of the first\nfunction as the domain of the second function.",
    "Let f : A →B and g : B →C be mappings.\n",
    "Define a new map, the composition of f and g from A to C, by (g ◦f)(x) = g(f(x)).\n\n",
    "CHAPTER 1.",
    "PRELIMINARIES\n8\nA\nB\nC\nf\ng\n1\n2\n3\na\nb\nc\nX\nY\nZ\nA\nC\ng ◦f\n1\n2\n3\nX\nY\nZ\nFigure 1.9 Composition of maps\nExample 1.10 Consider the functions f :",
    "A →B and g : B →C that are defined in\nFigure 1.9 (top).",
    "The composition of these functions, g ◦f",
    ":",
    "A →C, is defined in Figure 1.9\n(bottom).\n",
    "□\nExample 1.11 Let f(x) = x2 and g(x) = 2x + 5.",
    "Then\n(f ◦g)(x) = f(g(x))",
    "= (2x + 5)2 = 4x2 + 20x + 25\nand\n(g ◦f)(x) = g(f(x))",
    "= 2x2",
    "+ 5.\nIn general, order makes a difference; that is, in most cases f ◦g ̸= g ◦f.\n□\nExample 1.12",
    "Sometimes it is the case that f ◦g = g ◦f. Let f(x) = x3 and g(x)",
    "=\n3√x.\n",
    "Then\n(f ◦g)(x) = f(g(x))",
    "= f( 3√x ) = ( 3√x )3 = x\nand\n(g ◦f)(x) = g(f(x))",
    "= g(x3) =\n3√\nx3 = x.\n□\nExample 1.13 Given a 2 × 2 matrix\nA =\n\u0012a\nb\nc\nd\n\u0013\n,\n\nCHAPTER 1.",
    "PRELIMINARIES\n9\nwe can define a map TA : R2 →R2 by\nTA(x, y) = (ax + by, cx + dy)\nfor (x, y) in R2.",
    "This is actually matrix multiplication; that is,\n\u0012a\nb\nc\nd\n\u0013 \u0012x\ny\n\u0013\n=\n\u0012ax + by\ncx + dy\n\u0013\n.\n",
    "Maps from Rn to Rm given by matrices are called linear maps or linear transformations.\n",
    "□\nExample 1.14 Suppose that S = {1, 2, 3}.",
    "Define a map π : S →S by\nπ(1) = 2,\nπ(2) = 1,\nπ(3) = 3.\n",
    "This is a bijective map.",
    "An alternative way to write π is\n\u0012 1\n2\n3\nπ(1)\nπ(2)\nπ(3)\n\u0013\n",
    "=\n\u00121\n2\n3\n2\n1\n3\n\u0013\n.\n",
    "For any set S, a one-to-one and onto mapping π : S →S is called a permutation of S.\n□\nTheorem 1.15 Let f : A →B, g : B →C, and h : C →D.",
    "Then\n1.",
    "The composition of mappings is associative; that is, (h ◦g) ◦f = h ◦(g ◦f);\n2.",
    "If f and g are both one-to-one, then the mapping g ◦f is one-to-one;\n3.",
    "If f and g are both onto, then the mapping g ◦f is onto;\n4.",
    "If f and g are bijective, then so is g ◦f.\nProof.",
    "We will prove (1) and (3).",
    "Part (2) is left as an exercise.",
    "Part (4) follows directly\nfrom (2) and (3).\n",
    "(1) We must show that\nh ◦(g ◦f) = (h ◦g) ◦f.\nFor a ∈A we have\n(h ◦(g ◦f))(a) = h((g ◦f)(a))\n",
    "= h(g(f(a)))\n",
    "= (h ◦g)(f(a))\n",
    "= ((h ◦g) ◦f)(a).\n",
    "(3) Assume that f and g are both onto functions.",
    "Given c ∈C, we must show that\nthere exists an a ∈A such that (g ◦f)(a) = g(f(a))",
    "= c.",
    "However, since g is onto, there\nis an element b ∈B such that g(b) = c. Similarly, there is an a ∈A such that f(a) = b.\nAccordingly,\n(g ◦f)(a) = g(f(a))",
    "= g(b) = c.\n■\nIf S is any set, we will use idS or id to denote the identity mapping from S to itself.\n",
    "Define this map by id(s)",
    "= s for all s ∈S.",
    "A map g : B →A is an inverse mapping of\nf :",
    "A →B if g ◦f = idA and f ◦g = idB; in other words, the inverse function of a function\nsimply “undoes” the function.",
    "A map is said to be invertible if it has an inverse.",
    "We usually\nwrite f−1 for the inverse of f.\n\nCHAPTER 1.",
    "PRELIMINARIES\n10\nExample 1.16",
    "The function f(x)",
    "= x3 has inverse f−1(x)",
    "=\n3√x by Example 1.12.\n",
    "□\nExample 1.17",
    "The natural logarithm and the exponential functions, f(x) = ln x and\nf−1(x) = ex, are inverses of each other provided that we are careful about choosing domains.\n",
    "Observe that\nf(f−1(x))",
    "= f(ex) = ln ex = x\nand\nf−1(f(x))",
    "= f−1(ln x) = eln x = x\nwhenever composition makes sense.\n",
    "□\nExample 1.18 Suppose that\nA =\n\u00123\n1\n5\n2\n\u0013\n.\n",
    "Then A defines a map from R2 to R2 by\nTA(x, y) = (3x + y, 5x + 2y).\n",
    "We can find an inverse map of TA by simply inverting the matrix A; that is, T −1\nA\n= TA−1.\n",
    "In this example,\nA−1 =\n\u0012 2\n−1\n−5\n3\n\u0013\n;\nhence, the inverse map is given by\nT −1\nA (x, y) = (2x −y, −5x + 3y).\n",
    "It is easy to check that\nT −1\nA\n◦TA(x, y) =",
    "TA ◦T −1\nA (x, y) = (x, y).\n",
    "Not every map has an inverse.",
    "If we consider the map\nTB(x, y) = (3x, 0)\ngiven by the matrix\nB =\n\u00123\n0\n0\n0\n\u0013\n,\nthen an inverse map would have to be of the form\nT −1\nB (x, y) = (ax + by, cx + dy)\nand\n(x, y) = TB ◦T −1\nB (x, y) = (3ax + 3by, 0)\nfor all x and y.",
    "Clearly this is impossible because y might not be 0.\n",
    "□\nExample 1.19 Given the permutation\nπ =\n\u00121\n2\n3\n2\n3\n1\n\u0013\n\nCHAPTER 1.",
    "PRELIMINARIES\n11\non S = {1, 2, 3}, it is easy to see that the permutation defined by\nπ−1 =\n\u00121\n2\n3\n3\n1\n2\n\u0013\nis the inverse of π.",
    "In fact, any bijective mapping possesses an inverse, as we will see in the\nnext theorem.\n",
    "□\nTheorem 1.20",
    "A mapping is invertible if and only if it is both one-to-one and onto.\nProof.\n",
    "Suppose first that f : A →B is invertible with inverse g : B →A.\nThen\ng ◦f = idA is the identity map; that is, g(f(a))",
    "= a.",
    "If a1, a2 ∈A with f(a1) = f(a2), then\na1 = g(f(a1))",
    "= g(f(a2))",
    "= a2.",
    "Consequently, f is one-to-one.",
    "Now suppose that b ∈B.\nTo show that f is onto, it is necessary to find an a ∈A such that f(a) = b, but f(g(b))",
    "= b\nwith g(b)",
    "∈A.",
    "Let a = g(b).\n",
    "Conversely, let f be bijective and let b ∈B. Since f is onto, there exists an a ∈A such\nthat f(a)",
    "= b.",
    "Because f is one-to-one, a must be unique.",
    "Define g by letting g(b) = a.",
    "We\nhave now constructed the inverse of f.\n■\nEquivalence Relations and Partitions\nA fundamental notion in mathematics is that of equality.",
    "We can generalize equality with\nequivalence relations and equivalence classes.\n",
    "An equivalence relation on a set X is a\nrelation R ⊂X ×",
    "X such that\n• (x, x) ∈R for all x ∈X (reflexive property);\n• (x, y) ∈R implies (y, x) ∈R (symmetric property);\n• (x, y) and (y, z) ∈R imply (x, z) ∈R (transitive property).\n",
    "Given an equivalence relation R on a set X, we usually write x ∼y instead of (x, y) ∈R.\nIf the equivalence relation already has an associated notation such as =, ≡, or ∼=, we will\nuse that notation.\n",
    "Example 1.21 Let p, q, r, and s be integers, where q and s are nonzero.",
    "Define p/q ∼r/s\nif ps = qr.",
    "Clearly ∼is reflexive and symmetric.",
    "To show that it is also transitive, suppose\nthat p/q ∼r/s and r/s ∼t/u, with q, s, and u all nonzero.",
    "Then ps = qr and ru = st.\n",
    "Therefore,\npsu = qru = qst.\n",
    "Since s ̸= 0, pu = qt.",
    "Consequently, p/q ∼t/u.\n□\nExample 1.22 Suppose that f and g are differentiable functions on R. We can define an\nequivalence relation on such functions by letting f(x) ∼g(x) if f′(x) = g′(x).",
    "It is clear that\n∼is both reflexive and symmetric.",
    "To demonstrate transitivity, suppose that f(x) ∼g(x)\nand g(x) ∼h(x).",
    "From calculus we know that f(x)−g(x) = c1 and g(x)−h(x)",
    "= c2, where\nc1 and c2 are both constants.",
    "Hence,\nf(x) −h(x)",
    "= (f(x) −g(x))",
    "+ (g(x) −h(x))",
    "= c1 + c2\nand f′(x) −h′(x)",
    "= 0.",
    "Therefore, f(x) ∼h(x).\n",
    "□\nExample 1.23 For (x1, y1) and (x2, y2) in R2, define (x1, y1) ∼(x2, y2) if x2\n1 +y2\n1 = x2\n2 +y2\n2.\n",
    "Then ∼is an equivalence relation on R2.\n",
    "□\nExample 1.24 Let A and B be 2 × 2 matrices with entries in the real numbers.",
    "We can\ndefine an equivalence relation on the set of 2 × 2 matrices, by saying A ∼B if there exists\n\nCHAPTER 1.",
    "PRELIMINARIES\n12\nan invertible matrix P such that PAP −1 = B.",
    "For example, if\nA =\n\u0012 1\n2\n−1\n1\n\u0013\nand\nB =\n\u0012−18\n33\n−11\n20\n\u0013\n,\nthen A ∼B since PAP −1 = B for\nP =\n\u00122\n5\n1\n3\n\u0013\n.\n",
    "Let I be the 2 × 2 identity matrix; that is,\nI =\n\u00121\n0\n0\n1\n\u0013\n.\n",
    "Then IAI−1 = IAI = A; therefore, the relation is reflexive.",
    "To show symmetry, suppose\nthat A ∼B. Then there exists an invertible matrix P such that PAP −1 = B. So\nA = P −1BP",
    "= P −1B(P −1)−1.\n",
    "Finally, suppose that A ∼B and B ∼C. Then there exist invertible matrices P and Q\nsuch that PAP −1 = B and QBQ−1 = C. Since\nC = QBQ−1 = QPAP −1Q−1 = (QP)A(QP)−1,\nthe relation is transitive.",
    "Two matrices that are equivalent in this manner are said to be\nsimilar.\n",
    "□\nA partition P of a set X is a collection of nonempty sets X1, X2, . . .",
    "such that Xi∩Xj = ∅\nfor i ̸= j and S\nk Xk = X. Let ∼be an equivalence relation on a set X and let x ∈X. Then\n[x] = {y ∈X : y ∼x} is called the equivalence class of x.",
    "We will see that an equivalence\nrelation gives rise to a partition via equivalence classes.",
    "Also, whenever a partition of a\nset exists, there is some natural underlying equivalence relation, as the following theorem\ndemonstrates.\n",
    "Theorem 1.25 Given an equivalence relation ∼on a set X, the equivalence classes of X\nform a partition of X. Conversely, if P = {Xi} is a partition of a set X, then there is an\nequivalence relation on X with equivalence classes Xi.\nProof.",
    "Suppose there exists an equivalence relation ∼on the set X.",
    "For any x ∈X, the\nreflexive property shows that x ∈[x] and so",
    "[x] is nonempty.",
    "Clearly X = S\nx∈X[x].",
    "Now\nlet x, y ∈X. We need to show that either [x] = [y] or [x] ∩[y]",
    "= ∅. Suppose that the\nintersection of [x] and [y] is not empty and that z ∈[x] ∩[y].",
    "Then z ∼x and z ∼y.",
    "By\nsymmetry and transitivity x ∼y; hence, [x] ⊂[y].",
    "Similarly, [y] ⊂[x] and so",
    "[x] = [y].\n",
    "Therefore, any two equivalence classes are either disjoint or exactly the same.\n",
    "Conversely, suppose that P = {Xi} is a partition of a set X.\nLet two elements be\nequivalent if they are in the same partition.",
    "Clearly, the relation is reflexive.",
    "If x is in the\nsame partition as y, then y is in the same partition as x, so x ∼y implies y ∼x.",
    "Finally, if\nx is in the same partition as y and y is in the same partition as z, then x must be in the\nsame partition as z, and transitivity holds.\n",
    "■\nCorollary 1.26 Two equivalence classes of an equivalence relation are either disjoint or\nequal.\n",
    "Let us examine some of the partitions given by the equivalence classes in the last set of\nexamples.\n\n",
    "CHAPTER 1.",
    "PRELIMINARIES\n13\nExample 1.27 In the equivalence relation in Example 1.21, two pairs of integers, (p, q) and\n(r, s), are in the same equivalence class when they reduce to the same fraction in its lowest\nterms.\n",
    "□\nExample 1.28 In the equivalence relation in Example 1.22, two functions f(x) and g(x)\nare in the same partition when they differ by a constant.\n",
    "□\nExample 1.29 We defined an equivalence class on R2 by (x1, y1) ∼(x2, y2) if x2\n1 + y2\n1 =\nx2\n2 + y2\n2.",
    "Two pairs of real numbers are in the same partition when they lie on the same\ncircle about the origin.\n",
    "□\nExample 1.30 Let r and s be two integers and suppose that n ∈N.",
    "We say that r is\ncongruent to s modulo n, or r is congruent to s mod n, if r −s is evenly divisible by n; that\nis, r −s = nk for",
    "some k ∈Z.",
    "In this case we write r ≡s (mod n).",
    "For example, 41 ≡17\n(mod 8) since 41 −17 = 24 is divisible by 8.",
    "We claim that congruence modulo n forms an\nequivalence relation of Z.",
    "Certainly any integer r is equivalent to itself since r −r = 0 is\ndivisible by n.",
    "We will now show that the relation is symmetric.",
    "If r ≡s (mod n), then\nr −s = −(s −r) is divisible by n.",
    "So s −r is divisible by n and s ≡r (mod n).",
    "Now\nsuppose that r ≡s (mod n) and s ≡t (mod n).",
    "Then there exist integers k and l such\nthat r −s = kn and s −t = ln.",
    "To show transitivity, it is necessary to prove that r −t is\ndivisible by n.",
    "However,\nr −t = r −s + s −t = kn + ln = (k + l)n,\nand so r −t is divisible by n.\n",
    "If we consider the equivalence relation established by the integers modulo 3, then\n[0] = {. .",
    ".",
    ", −3, 0, 3, 6, . . .",
    "},\n[1] = {. . .",
    ", −2, 1, 4, 7, . . .},\n",
    "[2] = {. . .",
    ", −1, 2, 5, 8, . . .}.\n",
    "Notice that [0] ∪[1] ∪[2] = Z and also that the sets are disjoint.",
    "The sets [0], [1], and [2]\nform a partition of the integers.\n",
    "The integers modulo n are a very important example in the study of abstract algebra\nand will become quite useful in our investigation of various algebraic structures such as\ngroups and rings.",
    "In our discussion of the integers modulo n we have actually assumed a\nresult known as the division algorithm, which will be stated and proved in Chapter 2.\n□\nSage.\n",
    "Sage is a powerful, open source, system for exact, numerical, and symbolic mathe-\nmatical computations.",
    "Electronic versions of this text contain comprehensive introductions\nto the use of Sage to study abstract algebra, and include a set of exercises.",
    "These can be\nfound at the book’s website.",
    "Due to the format of this version of the text, at the end of\neach chapter we have just included brief suggestions of how Sage might be employed.\n",
    "1.3 Reading Questions\n1.\n",
    "What do relations and mappings have in common?\n2.\n",
    "What makes relations and mappings different?\n",
    "3.\n",
    "State carefully the three defining properties of an equivalence relation.",
    "In other words,\ndo not just name the properties, give their definitions.\n",
    "4.\n",
    "What is the big deal about equivalence relations?",
    "(Hint: Partitions.)\n\n",
    "CHAPTER 1.",
    "PRELIMINARIES\n14\n5.\nDescribe a general technique for proving that two sets are equal.\n",
    "1.4 Exercises\n1.\nSuppose that\n",
    "A = {x : x ∈N and x is even},\nB = {x : x ∈N and x is prime},\nC = {x : x ∈N and x is a multiple of 5}.\n",
    "Describe each of the following sets.\n",
    "(a) A ∩B\n(b) B ∩C\n(c) A ∪B\n(d) A ∩(B ∪C)\n2.\n",
    "If A = {a, b, c}, B = {1, 2, 3}, C = {x}, and D = ∅, list all of the elements in each of\nthe following sets.\n",
    "(a) A × B\n(b) B ×",
    "A\n(c)",
    "A × B × C\n(d)",
    "A × D\n3.\nFind an example of two nonempty sets A and B for which A × B = B ×",
    "A is true.\n",
    "4.\nProve A ∪∅= A and A ∩∅= ∅.\n5.\nProve A ∪B = B ∪A and A ∩B = B ∩A.\n6.\n",
    "Prove A ∪(B ∩C)",
    "= (A ∪B) ∩(A ∪C).\n",
    "7.\nProve A ∩(B ∪C) = (A ∩B) ∪(A ∩C).\n",
    "8.\nProve A ⊂B if and",
    "only if A ∩B = A.\n9.\nProve (A ∩B)′ = A′ ∪B′.\n10.",
    "Prove A ∪B = (A ∩B) ∪(A \\ B) ∪(B",
    "\\ A).\n",
    "11.",
    "Prove (A ∪B) ×",
    "C = (A × C) ∪(B × C).\n",
    "12.",
    "Prove (A ∩B) \\ B = ∅.\n13.",
    "Prove (A ∪B) \\ B =",
    "A \\ B.\n14.",
    "Prove A \\ (B ∪C) = (A \\ B) ∩(A \\ C).\n",
    "15.",
    "Prove A ∩(B \\ C) = (",
    "A ∩B) \\ (A ∩C).\n",
    "16.",
    "Prove (A \\ B) ∪(B \\ A) = (A ∪B) \\ (A ∩B).\n",
    "17.",
    "Which of the following relations f : Q →Q define a mapping?",
    "In each case, supply a\nreason why f is or is not a mapping.\n(a) f(p/q) = p + 1\np −2\n(b) f(p/q) = 3p\n3q\n(c) f(p/q) = p + q\nq2\n(d) f(p/q) = 3p2\n7q2 −p\nq\n18.",
    "Determine which of the following functions are one-to-one and which are onto.",
    "If the\nfunction is not onto, determine its range.\n",
    "(a) f :",
    "R →R defined by f(x) = ex\n(b) f : Z →Z defined by f(n)",
    "= n2 + 3\n(c) f :",
    "R →R defined by f(x) = sin x\n(d) f : Z →Z defined by f(x) = x2\n\nCHAPTER 1.",
    "PRELIMINARIES\n15\n19.",
    "Let f : A →B and g : B →C be invertible mappings; that is, mappings such that f−1\nand g−1 exist.",
    "Show that (g ◦f)−1",
    "= f−1 ◦g−1.\n20.\n(a) Define a function f : N →N that is one-to-one but not onto.\n",
    "(b) Define a function f :",
    "N →N that is onto but not one-to-one.\n",
    "21.",
    "Prove the relation defined on R2 by (x1, y1) ∼(x2, y2) if x2\n1 + y2\n1 = x2\n2 + y2\n2 is an\nequivalence relation.\n",
    "22.",
    "Let f : A →B and g : B →C be maps.\n",
    "(a) If f and g are both one-to-one functions, show that g ◦f is one-to-one.\n(b) If g ◦f is onto, show that g is onto.\n",
    "(c) If g ◦f is one-to-one, show that f is one-to-one.\n(d) If g ◦f is one-to-one and f is onto, show that g is one-to-one.\n(e) If g ◦f is onto and g is one-to-one, show that f is onto.\n23.",
    "Define a function on the real numbers by\nf(x)",
    "= x + 1\nx −1.\n",
    "What are the domain and range of f?",
    "What is the inverse of f?",
    "Compute f ◦f−1 and\nf−1 ◦f.\n24.",
    "Let f : X →Y be a map with A1, A2 ⊂X and B1, B2 ⊂Y .\n(a) Prove f(A1",
    "∪A2) = f(A1) ∪f(A2).\n",
    "(b) Prove f(A1 ∩A2) ⊂f(A1) ∩f(A2).",
    "Give an example in which equality fails.\n",
    "(c) Prove f−1(B1 ∪B2) = f−1(B1) ∪f−1(B2), where\nf−1(B) = {x ∈X : f(x) ∈B}.\n",
    "(d) Prove f−1(B1 ∩B2)",
    "= f−1(B1) ∩f−1(B2).\n",
    "(e) Prove f−1(Y \\ B1) = X \\ f−1(B1).\n",
    "25. Determine whether or not the following relations are equivalence relations on the given\nset.",
    "If the relation is an equivalence relation, describe the partition given by it.",
    "If the\nrelation is not an equivalence relation, state why it fails to be one.\n(a) x ∼y in R if x ≥y\n(b) m ∼n in Z if mn > 0\n(c) x ∼y in R if |x −y| ≤4\n(d) m ∼n in Z if m ≡n (mod 6)\n26.",
    "Define a relation ∼on R2 by stating that (a, b) ∼(c, d) if and only if a2 + b2 ≤c2 + d2.\n",
    "Show that ∼is reflexive and transitive but not symmetric.\n27.",
    "Show that an m × n matrix gives rise to a well-defined map from Rn to Rm.\n28.",
    "Find the error in the following argument by providing a counterexample.",
    "“The reflexive\nproperty is redundant in the axioms for an equivalence relation.",
    "If x ∼y, then y ∼x\nby the symmetric property.",
    "Using the transitive property, we can deduce that x ∼x.”\n29.",
    "Projective Real Line.",
    "Define a relation on R2 \\ {(0, 0)} by letting (x1, y1) ∼(x2, y2)\nif there exists a nonzero real number λ such that (x1, y1) = (λx2, λy2).",
    "Prove that ∼\n\nCHAPTER 1.",
    "PRELIMINARIES\n16\ndefines an equivalence relation on R2 \\ (0, 0).",
    "What are the corresponding equivalence\nclasses?",
    "This equivalence relation defines the projective line, denoted by P(R), which\nis very important in geometry.\n",
    "1.5 References and Suggested Readings\n[1]\nArtin, M. Algebra (Classic Version).",
    "2nd ed.",
    "Pearson, Upper Saddle River, NJ, 2018.\n",
    "[2]\nChilds, L. A Concrete Introduction to Higher Algebra.",
    "2nd ed.",
    "Springer-Verlag, New\nYork, 1995.\n",
    "[3]\nDummit, D. and Foote, R. Abstract Algebra.",
    "3rd ed.",
    "Wiley, New York, 2003.\n",
    "[4]\nEhrlich, G. Fundamental Concepts of Algebra.",
    "PWS-KENT, Boston, 1991.\n",
    "[5]\nFraleigh, J. B. A First Course in Abstract Algebra.",
    "7th ed.",
    "Pearson, Upper Saddle\nRiver, NJ, 2003.\n",
    "[6]\nGallian, J. A. Contemporary Abstract Algebra.",
    "7th ed.",
    "Brooks/Cole, Belmont, CA,\n2009.\n",
    "[7]\nHalmos, P. Naive Set Theory.",
    "Springer, New York, 1991.",
    "One of the best references\nfor set theory.\n",
    "[8]\nHerstein, I. N. Abstract Algebra.",
    "3rd ed.",
    "Wiley, New York, 1996.\n",
    "[9]\nHungerford, T. W. Algebra.",
    "Springer, New York, 1974.",
    "One of the standard graduate\nalgebra texts.\n",
    "[10] Lang, S. Algebra.",
    "3rd ed.",
    "Springer, New York, 2002.",
    "Another standard graduate text.\n",
    "[11] Lidl, R. and Pilz, G. Applied Abstract Algebra.",
    "2nd ed.",
    "Springer, New York, 1998.\n",
    "[12] Mackiw, G. Applications of Abstract Algebra.",
    "Wiley, New York, 1985.\n",
    "[13] Nickelson, W. K. Introduction to Abstract Algebra.",
    "3rd ed.",
    "Wiley, New York, 2006.\n",
    "[14] Solow, D. How to Read and Do Proofs.",
    "5th ed.",
    "Wiley, New York, 2009.\n",
    "[15] van der Waerden, B. L.",
    "A History of Algebra.",
    "Springer-Verlag, New York, 1985.",
    "An\naccount of the historical development of algebra.\n\n",
    "2\nThe Integers\n",
    "The integers are the building blocks of mathematics.",
    "In this chapter we will investigate\nthe fundamental properties of the integers, including mathematical induction, the division\nalgorithm, and the Fundamental Theorem of Arithmetic.\n",
    "2.1 Mathematical Induction\nSuppose we wish to show that\n1 + 2 + · · · + n = n(n + 1)\n2\nfor any natural number n.",
    "This formula is easily verified for small numbers such as n = 1,\n2, 3, or 4, but it is impossible to verify for all natural numbers on a case-by-case basis.",
    "To\nprove the formula true in general, a more generic method is required.\n",
    "Suppose we have verified the equation for the first n cases.",
    "We will attempt to show\nthat we can generate the formula for the (n + 1)th case from this knowledge.",
    "The formula\nis true for n = 1 since\n1 = 1(1 + 1)\n2\n.\n",
    "If we have verified the first n cases, then\n1 + 2 + · · · + n + (n + 1) = n(n + 1)\n2\n+ n + 1\n= n2 +",
    "3n",
    "+ 2\n2\n= (n + 1)[(n",
    "+ 1)",
    "+ 1]\n2\n.\n",
    "This is exactly the formula for the (n + 1)th case.\n",
    "This method of proof is known as mathematical induction.",
    "Instead of attempting to\nverify a statement about some subset S of the positive integers N on a case-by-case basis, an\nimpossible task if S is an infinite set, we give a specific proof for the smallest integer being\nconsidered, followed by a generic argument showing that if the statement holds for a given\ncase, then it must also hold for the next case in the sequence.",
    "We summarize mathematical\ninduction in the following axiom.\n",
    "Principle 2.1 First Principle of Mathematical Induction.",
    "Let S(n) be a statement\nabout integers for n ∈N and suppose S(n0) is true for some integer n0.",
    "If for all integers k\n17\n\nCHAPTER 2.",
    "THE INTEGERS\n18\nwith k ≥n0, S(k) implies that S(k",
    "+ 1) is true, then S(n) is true for all integers n greater\nthan or equal to n0.\n",
    "Example 2.2 For all integers n ≥3, 2n > n + 4.",
    "Since\n8 = 23 > 3 + 4 = 7,\nthe statement is true for n0 = 3.",
    "Assume that 2k >",
    "k + 4 for k ≥3.",
    "Then 2k+1 = 2 · 2k >\n2(k + 4).",
    "But\n2(k + 4) = 2k + 8 > k",
    "+ 5 = (k + 1) + 4\nsince k is positive.",
    "Hence, by induction, the statement holds for all integers n ≥3.\n□\nExample 2.3 Every integer 10n+1",
    "+ 3 · 10n",
    "+ 5 is divisible by 9 for n ∈N. For n = 1,\n101+1 + 3 · 10 + 5 = 135 = 9 · 15\nis divisible by 9.",
    "Suppose that 10k+1 + 3 · 10k + 5 is divisible by 9 for k ≥1.",
    "Then\n10(k+1)+1 + 3 · 10k+1 + 5 = 10k+2 + 3 · 10k+1 + 50 −45\n= 10(10k+1 + 3 · 10k + 5) −45\nis divisible by 9.\n□\nExample 2.4 We will prove the binomial theorem using mathematical induction; that is,\n(a + b)n =\nn\nX\nk=0\n\u0012n\nk\n\u0013\nakbn−k,\nwhere a and b are real numbers, n ∈N, and\n\u0012n\nk\n\u0013\n=\nn!\nk!(n −k)!\nis the binomial coeﬀicient.\n",
    "We first show that\n\u0012n",
    "+ 1\nk\n\u0013\n=\n\u0012n\nk\n\u0013\n+\n\u0012\nn\nk −1\n\u0013\n.\n",
    "This result follows from\n\u0012n\nk\n\u0013\n+\n\u0012\nn\nk −1\n\u0013\n=\nn!\nk!(n −k)!",
    "+\nn!\n(k −1)!(n −k + 1)!\n",
    "=\n(n + 1)!\nk!(n",
    "+ 1 −k)!\n",
    "=\n\u0012n",
    "+ 1\nk\n\u0013\n.\n",
    "If n = 1, the binomial theorem is easy to verify.",
    "Now assume that the result is true for n\ngreater than or equal to 1.",
    "Then\n(a + b)n+1 = (a + b)(a + b)n\n= (a + b)\n n\nX\nk=0\n\u0012n\nk\n\u0013\nakbn−k\n!\n\n",
    "CHAPTER 2.",
    "THE INTEGERS\n19\n=\nn\nX\nk=0\n\u0012n\nk\n\u0013\nak+1bn−k +\nn\nX\nk=0\n\u0012n\nk\n\u0013\nakbn+1−k\n= an+1",
    "+\nn\nX\nk=1\n\u0012\nn\nk −1\n\u0013\nakbn+1−k",
    "+\nn\nX\nk=1\n\u0012n\nk\n\u0013\nakbn+1−k + bn+1\n= an+1",
    "+\nn\nX\nk=1\n\u0014\u0012\nn\nk −1\n\u0013\n",
    "+\n\u0012n\nk\n\u0013\u0015\nakbn+1−k + bn+1\n=\nn+1\nX\nk=0\n\u0012n",
    "+ 1\nk\n\u0013\nakbn+1−k.\n□\nWe have an equivalent statement of the Principle of Mathematical Induction that is\noften very useful.\n",
    "Principle 2.5 Second Principle of Mathematical Induction.",
    "Let S(n) be a statement\nabout integers for n ∈N and suppose S(n0) is true for some integer n0.",
    "If S(n0), S(n0 +\n1), . .",
    ".",
    ", S(k) imply that S(k",
    "+ 1) for k ≥n0, then the statement S(n) is true for all integers\nn ≥n0.\n",
    "A nonempty subset S of Z is well-ordered if S contains a least element.",
    "Notice that the\nset Z is not well-ordered since it does not contain a smallest element.",
    "However, the natural\nnumbers are well-ordered.\n",
    "Principle 2.6\nPrinciple of Well-Ordering.\n",
    "Every nonempty subset of the natural\nnumbers is well-ordered.\n",
    "The Principle of Well-Ordering is equivalent to the Principle of Mathematical Induction.\n",
    "Lemma 2.7 The Principle of Mathematical Induction implies that 1 is the least positive\nnatural number.\nProof.",
    "Let S = {n ∈N : n ≥1}.",
    "Then 1 ∈S. Assume that n ∈S. Since 0 < 1, it must\nbe the case that n = n + 0 < n + 1.",
    "Therefore, 1 ≤n < n + 1.",
    "Consequently, if n ∈S,\nthen n + 1 must also be in S, and by the Principle of Mathematical Induction, and we have\nS = N.\n■\nTheorem 2.8 The Principle of Mathematical Induction implies the Principle of Well-\nOrdering.",
    "That is, every nonempty subset of N contains a least element.\nProof.\n",
    "We must show that if S is a nonempty subset of the natural numbers, then S\ncontains a least element.",
    "If S contains 1, then the theorem is true by Lemma 2.7.",
    "Assume\nthat if S contains an integer k such that 1 ≤k ≤n, then S contains a least element.",
    "We\nwill show that if a set S contains an integer less than or equal to n + 1, then S has a least\nelement.",
    "If S does not contain an integer less than n + 1, then n + 1 is the smallest integer\nin S. Otherwise, since S is nonempty, S must contain an integer less than or equal to n. In\nthis case, by induction, S contains a least element.\n",
    "■\nInduction can also be very useful in formulating definitions.",
    "For instance, there are two\nways to define n!, the factorial of a positive integer n.\n•",
    "The explicit definition: n! = 1 · 2 · 3 · · · (n −1) · n.\n• The inductive or recursive definition: 1! = 1 and n! = n(n −1)!",
    "for n > 1.\nEvery good mathematician or computer scientist knows that looking at problems recursively,\nas opposed to explicitly, often results in better understanding of complex issues.\n\n",
    "CHAPTER 2.",
    "THE INTEGERS\n20\n2.2 The Division Algorithm\n",
    "An application of the Principle of Well-Ordering that we will use often is the division\nalgorithm.\n",
    "Theorem 2.9\nDivision Algorithm.",
    "Let a and b be integers, with b > 0.",
    "Then there\nexist unique integers q and r such that\na = bq + r\nwhere 0",
    "≤r < b.\nProof.",
    "This is a perfect example of the existence-and-uniqueness type of proof.",
    "We must\nfirst prove that the numbers q and r actually exist.",
    "Then we must show that if q′ and r′\nare two other such numbers, then q = q′ and r = r′.\nExistence of q and r. Let\nS = {a −bk : k ∈Z and a −bk ≥0}.\n",
    "If 0 ∈S, then b divides a, and we can let q = a/b and r = 0.",
    "If 0 /∈S, we can use the\nWell-Ordering Principle.",
    "We must first show that S is nonempty.",
    "If a > 0, then a−b·0 ∈S.\nIf a < 0, then a −b(2a) = a(1 −2b)",
    "∈S.",
    "In either case S ̸= ∅. By the Well-Ordering\nPrinciple, S must have a smallest member, say r = a −bq.",
    "Therefore, a = bq + r, r ≥0.\n",
    "We now show that r < b. Suppose",
    "that r > b.",
    "Then\na −b(q",
    "+ 1) = a −bq −b = r −b > 0.\n",
    "In this case we would have a −b(q",
    "+ 1) in the set S.",
    "But then a −b(q",
    "+ 1) < a −bq, which\nwould contradict the fact that r = a −bq is the smallest member of S. So r ≤b.",
    "Since\n0 /∈S, r ̸= b and so r < b.\nUniqueness of q and r. Suppose there exist integers r, r′, q, and q′ such that\na = bq + r, 0 ≤r < b\nand\na = bq′ + r′, 0",
    "≤r′ < b.\n",
    "Then bq+r = bq′+r′. Assume that r′ ≥r.",
    "From the last equation we have b(q−q′) = r′−r;\ntherefore, b must divide r′ −r and 0",
    "≤r′ −r ≤r′ <",
    "b.",
    "This is possible only if r′ −r = 0.\n",
    "Hence, r = r′ and q = q′.\n■\nLet a and b be integers.",
    "If b = ak for some integer k, we write a | b.",
    "An integer d\nis called a common divisor of a and b if d | a and d | b.",
    "The greatest common divisor of\nintegers a and b is a positive integer d such that d is a common divisor of a and b and if d′\nis any other common divisor of a and b, then d′ | d.\n",
    "We write d = gcd(a, b); for example,\ngcd(24, 36) = 12 and gcd(120, 102) = 6.",
    "We say that two integers a and b are relatively\nprime if gcd(a, b) = 1.\n",
    "Theorem 2.10 Let a and b be nonzero integers.",
    "Then there exist integers r and s such that\ngcd(a, b) = ar + bs.\n",
    "Furthermore, the greatest common divisor of a and b is unique.\nProof.",
    "Let\nS = {am + bn : m, n ∈Z and am + bn > 0}.\n",
    "Clearly, the set S is nonempty; hence, by the Well-Ordering Principle S must have a smallest\nmember, say d = ar + bs.",
    "We claim that d = gcd(a, b).",
    "Write a = dq + r′ where 0 ≤r′ < d.\n\nCHAPTER 2.",
    "THE INTEGERS\n21\n",
    "If r′ > 0, then\nr′ = a −dq\n= a −(ar + bs)q\n= a −arq −bsq\n= a(1 −rq)",
    "+ b(−sq),\nwhich is in S.",
    "But this would contradict the fact that d is the smallest member of S. Hence,\nr′ = 0 and d divides a.",
    "A similar argument shows that d divides b.",
    "Therefore, d is a common\ndivisor of a and b.\nSuppose that d′ is another common divisor of a and b, and we want to show that d′ | d.\n",
    "If we let a = d′h and b = d′k, then\nd = ar + bs = d′hr",
    "+ d′ks = d′(hr + ks).\n",
    "So d′ must divide d.",
    "Hence, d must be the unique greatest common divisor of a and b.\n■\nCorollary 2.11 Let a and b be two integers that are relatively prime.",
    "Then there exist\nintegers r and s such that ar + bs",
    "= 1.\n",
    "The Euclidean Algorithm\nAmong other things, Theorem 2.10 allows us to compute the greatest common divisor of\ntwo integers.\n",
    "Example 2.12 Let us compute the greatest common divisor of 945 and 2415.",
    "First observe\nthat\n2415 = 945 · 2 + 525\n945 = 525 · 1 + 420\n525 = 420 · 1 + 105\n420 = 105 · 4 + 0.\n",
    "Reversing our steps, 105 divides 420, 105 divides 525, 105 divides 945, and 105 divides 2415.\n",
    "Hence, 105 divides both 945 and 2415.",
    "If d were another common divisor of 945 and 2415,\nthen d would also have to divide 105.",
    "Therefore, gcd(945, 2415) = 105.\n",
    "If we work backward through the above sequence of equations, we can also obtain num-\nbers r and s such that 945r + 2415s = 105.",
    "Observe that\n105 = 525 + (−1) ·",
    "420\n= 525 + (−1) ·",
    "[945 + (−1) · 525]\n= 2 · 525 + (−1) · 945\n= 2 · [2415 + (−2) · 945] + (−1) · 945\n= 2 · 2415 + (−5) · 945.\n",
    "So r = −5 and s = 2.",
    "Notice that r and s are not unique, since r = 41 and s = −16 would\nalso work.\n",
    "□\nTo compute gcd(a, b) = d, we are using repeated divisions to obtain a decreasing se-\nquence of positive integers r1 > r2 > · · · > rn = d; that is,\nb = aq1 + r1\n\nCHAPTER 2.",
    "THE INTEGERS\n22\na = r1q2 + r2\nr1 = r2q3 + r3\n...\n",
    "rn−2 = rn−1qn + rn\nrn−1 = rnqn+1.\n",
    "To find r and s such that ar+bs = d, we begin with this last equation and substitute results\nobtained from the previous equations:\n",
    "d = rn\n= rn−2 −rn−1qn\n= rn−2 −qn(rn−3 −qn−1rn−2)\n= −qnrn−3 + (1 + qnqn−1)rn−2\n...\n= ra + sb.\n",
    "The algorithm that we have just used to find the greatest common divisor d of two integers\na and b and to write d as the linear combination of a and b is known as the Euclidean\nalgorithm.\n",
    "Prime Numbers\nLet p be an integer such that p > 1.",
    "We say that p is a prime number, or simply p is prime,\nif the only positive numbers that divide p are 1 and p itself.",
    "An integer n > 1 that is not\nprime is said to be composite.\n",
    "Lemma 2.13\nEuclid.",
    "Let a and b be integers and p be a prime number.",
    "If p | ab, then\neither p | a or p | b.\nProof.",
    "Suppose that p does not divide a.",
    "We must show that p | b.",
    "Since gcd(a, p) = 1,\nthere exist integers r and s such that ar + ps = 1.",
    "So\nb = b(ar + ps) = (ab)r + p(bs).\n",
    "Since p divides both ab and itself, p must divide b = (ab)r + p(bs).\n",
    "■\nTheorem 2.14 Euclid.",
    "There exist an infinite number of primes.\n",
    "Proof.",
    "We will prove this theorem by contradiction.",
    "Suppose that there are only a finite\nnumber of primes, say p1, p2, . . .",
    ", pn.",
    "Let P = p1p2 · · · pn + 1.",
    "Then P must be divisible\nby some pi for 1 ≤i ≤n.",
    "In this case, pi must divide P −p1p2 · · · pn = 1, which is a\ncontradiction.",
    "Hence, either P is prime or there exists an additional prime number p ̸= pi\nthat divides P.\n■\nTheorem 2.15 Fundamental Theorem of Arithmetic.",
    "Let n be an integer such that\nn > 1.",
    "Then\nn = p1p2 · · · pk,\nwhere p1, . .",
    ".",
    ", pk are primes (not necessarily distinct).",
    "Furthermore, this factorization is\nunique; that is, if\nn = q1q2 · · · ql,\nthen k = l and the qi’s are just the pi’s rearranged.\n\n",
    "CHAPTER 2.",
    "THE INTEGERS\n23\nProof.\nUniqueness.",
    "To show uniqueness we will use induction on n.",
    "The theorem is\ncertainly true for n = 2 since in this case n is prime.",
    "Now assume that the result holds for\nall integers m such that 1 ≤m < n, and\nn = p1p2 · · · pk = q1q2 · · · ql,\nwhere p1 ≤p2 ≤· · · ≤pk and q1 ≤q2 ≤· · · ≤ql.",
    "By Lemma 2.13, p1 | qi for some\ni = 1, . . .",
    ", l and q1 | pj for some j = 1, . .",
    ". ,",
    "k.",
    "Since all of the pi’s and qi’s are prime, p1 = qi\nand q1 = pj.",
    "Hence, p1 = q1 since p1 ≤pj = q1 ≤qi = p1.",
    "By the induction hypothesis,\nn′ = p2 · · · pk = q2 · · · ql\nhas a unique factorization.",
    "Hence, k = l and qi = pi for i = 1, . . .",
    ", k.\nExistence.",
    "To show existence, suppose that there is some integer that cannot be written\nas the product of primes.",
    "Let S be the set of all such numbers.",
    "By the Principle of Well-\nOrdering, S has a smallest number, say a.",
    "If the only positive factors of a are a and 1, then\na is prime, which is a contradiction.",
    "Hence, a = a1a2 where 1 < a1 < a and 1 < a2 < a.\n",
    "Neither a1 ∈S nor a2 ∈S, since a is the smallest element in S. So\na1 = p1 · · · pr\na2 = q1 · · · qs.\n",
    "Therefore,\na = a1a2 = p1 · · · prq1 · · · qs.\n",
    "So a /∈S, which is a contradiction.\n",
    "■\nHistorical Note\nPrime numbers were first studied by the ancient Greeks.",
    "Two important results from antiq-\nuity are Euclid’s proof that an infinite number of primes exist and the Sieve of Eratosthenes,\na method of computing all of the prime numbers less than a fixed positive integer n.",
    "One\nproblem in number theory is to find a function f such that f(n) is prime for each integer n.\nPierre Fermat (1601?–1665) conjectured that 22n",
    "+ 1 was prime for all n, but later it was\nshown by Leonhard Euler (1707–1783) that\n225 + 1 = 4,294,967,297\nis a composite number.",
    "One of the many unproven conjectures about prime numbers is\nGoldbach’s Conjecture.",
    "In a letter to Euler in 1742, Christian Goldbach stated the conjec-\nture that every even integer with the exception of 2 seemed to be the sum of two primes:\n4 = 2 + 2, 6 = 3 + 3, 8 = 3 + 5, . . ..",
    "Although the conjecture has been verified for the\nnumbers up through 4 × 1018, it has yet to be proven in general.",
    "Since prime numbers play\nan important role in public key cryptography, there is currently a great deal of interest in\ndetermining whether or not a large number is prime.\n",
    "Sage.\n",
    "Sage’s original purpose was to support research in number theory, so it is perfect\nfor the types of computations with the integers that we have in this chapter.\n\n",
    "CHAPTER 2.",
    "THE INTEGERS\n24\n2.3 Reading Questions\n1.\nUse Sage to express 123456792 as a product of prime numbers.\n",
    "2.\nFind the greatest common divisor of 84 and 52.\n",
    "3.\nFind integers r and s so that r(84)",
    "+ s(52)",
    "= gcd(84, 52).\n",
    "4.\nExplain the use of the term “induction hypothesis.”\n5.\nWhat is Goldbach’s Conjecture?",
    "And why is it called a “conjecture”?\n",
    "2.4 Exercises\n1.\nProve that\n12 + 22 + · · · + n2 = n(n + 1)(2n + 1)\n6\nfor n ∈N.\n2.\nProve that\n13 + 23 + · · · + n3 = n2(n",
    "+ 1)2\n4\nfor n ∈N.\n3.\nProve that n! > 2n for n ≥4.\n4.\nProve that\n",
    "x + 4x + 7x + · · · + (3n −2)x = n(3n −1)x\n2\nfor n ∈N.\n5.\nProve that 10n+1",
    "+ 10n",
    "+ 1 is divisible by 3 for n ∈N.\n6.\nProve that 4 · 102n + 9 · 102n−1 + 5 is divisible by 99 for n ∈N.\n7.\n",
    "Show that\nn√a1a2 · · · an ≤1\nn\nn\nX\nk=1\nak.\n8.\nProve the Leibniz rule for f(n)(x), where f(n) is the nth derivative of f; that is, show\nthat\n(fg)(n)(x) =\nn\nX\nk=0\n\u0012n\nk\n\u0013\nf(k)(x)g(n−k)(x).\n",
    "9.\nUse induction to prove that 1 + 2 + 22 + · · · + 2n = 2n+1 −1 for n ∈N.\n10.",
    "Prove that\n1\n2 + 1\n6 + · · · +\n1\nn(n + 1) =\nn\nn + 1\nfor n ∈N.\n11.",
    "If x is a nonnegative real number, then show that (1 + x)n −1 ≥nx for n = 0, 1, 2, . .",
    "..\n12.",
    "Power Sets.",
    "Let X be a set.",
    "Define the power set of X, denoted P(X), to be the set\nof all subsets of X.",
    "For example,\nP({a, b}) = {∅, {a}, {b}, {a, b}}.\n",
    "For every positive integer n, show that a set with exactly n elements has a power set\nwith exactly 2n elements.\n\n",
    "CHAPTER 2.",
    "THE INTEGERS\n25\n13.",
    "Prove that the two principles of mathematical induction stated in Section 2.1 are\nequivalent.\n14.",
    "Show that the Principle of Well-Ordering for the natural numbers implies that 1 is the\nsmallest natural number.",
    "Use this result to show that the Principle of Well-Ordering\nimplies the Principle of Mathematical Induction; that is, show that if S ⊂N such that\n1 ∈S and n + 1 ∈S whenever n ∈S, then S = N.\n15.",
    "For each of the following pairs of numbers a and b, calculate gcd(a, b) and find integers\nr and s such that gcd(a, b) = ra + sb.\n(a) 14 and 39\n(b) 234 and 165\n(c) 1739 and 9923\n(d) 471 and 562\n(e) 23771 and 19945\n(f) −4357 and 3754\n16.",
    "Let a and b be nonzero integers.",
    "If there exist integers r and s such that ar + bs = 1,\nshow that a and b are relatively prime.\n",
    "17.",
    "Fibonacci Numbers.",
    "The Fibonacci numbers are\n1, 1, 2, 3, 5, 8, 13, 21, . . . .\n",
    "We can define them inductively by f1 = 1, f2 = 1, and fn+2 = fn+1 + fn for n ∈N.\n(a) Prove that fn < 2n.\n",
    "(b) Prove that fn+1fn−1 = f2\nn + (−1)n, n ≥2.\n",
    "(c) Prove that fn =",
    "[(1 +\n√\n5 )n −(1 −\n√\n5 )n]/2n√\n5.\n(d) Show that ϕ = limn→∞fn+1/fn = (\n√\n5",
    "+ 1)/2.",
    "The constant ϕ is known as the\ngolden ratio.\n",
    "(e) Prove that fn and fn+1 are relatively prime.\n",
    "18.",
    "Let a and b be integers such that gcd(a, b) =",
    "1. Let r and s be integers such that\nar + bs",
    "= 1.",
    "Prove that\ngcd(a, s) = gcd(r, b) = gcd(r, s) = 1.\n",
    "19.",
    "Let x, y ∈N be relatively prime.",
    "If xy is a perfect square, prove that x and y must\nboth be perfect squares.\n",
    "20.",
    "Using the division algorithm, show that every perfect square is of the form 4k or 4k +1\nfor some nonnegative integer k.\n21.",
    "Suppose that a, b, r, s are pairwise relatively prime and that\na2 + b2 = r2\na2 −b2 = s2.\n",
    "Prove that a, r, and s are odd and b is even.\n",
    "22.",
    "Let n ∈N. Use the division algorithm to prove that every integer is congruent mod n\nto precisely one of the integers 0, 1, . . . , n −1.",
    "Conclude that if r is an integer, then\nthere is exactly one s in Z such that 0",
    "≤s < n",
    "and",
    "[r] =",
    "[s].",
    "Hence, the integers are\nindeed partitioned by congruence mod n.\n23.",
    "Define the least common multiple of two nonzero integers a and b, denoted by lcm(a, b),\nto be the nonnegative integer m such that both a and b divide m, and if a and b divide\nany other integer n, then m also divides n. Prove there exists a unique least common\n\nCHAPTER 2.",
    "THE INTEGERS\n26\nmultiple for any two integers a and b.\n24.",
    "If d = gcd(a, b) and m = lcm(a, b), prove that dm = |ab|.\n",
    "25.",
    "Show that lcm(a, b) = ab if and only if gcd(a, b) = 1.\n26.",
    "Prove that gcd(a, c) = gcd(b, c) = 1 if and only if gcd(ab, c) = 1 for integers a, b, and\nc.\n27.",
    "Let a, b, c ∈Z. Prove that if gcd(a, b) = 1 and a | bc, then a | c.\n28.",
    "Let p ≥2.",
    "Prove that if 2p −1 is prime, then p must also be prime.\n",
    "29.",
    "Prove that there are an infinite number of primes of the form 6n + 5.\n30.",
    "Prove that there are an infinite number of primes of the form 4n −1.\n",
    "31.",
    "Using the fact that 2 is prime, show that there do not exist integers p and q",
    "such that\np2 = 2q2.",
    "Demonstrate that therefore\n√\n2 cannot be a rational number.\n",
    "2.5 Programming Exercises\n1.\n",
    "The Sieve of Eratosthenes.",
    "One method of computing all of the prime numbers\nless than a certain fixed positive integer N is to list all of the numbers n such that\n1 < n < N. Begin by eliminating all of the multiples of 2.",
    "Next eliminate all of the\nmultiples of 3.",
    "Now eliminate all of the multiples of 5.",
    "Notice that 4 has already been\ncrossed out.",
    "Continue in this manner, noticing that we do not have to go all the way\nto N; it suﬀices to stop at\n√\nN. Using this method, compute all of the prime numbers\nless than N = 250.",
    "We can also use this method to find all of the integers that are\nrelatively prime to an integer N. Simply eliminate the prime factors of N and all of\ntheir multiples.",
    "Using this method, find all of the numbers that are relatively prime\nto N",
    "= 120.",
    "Using the Sieve of Eratosthenes, write a program that will compute all\nof the primes less than an integer N.\n2.\n",
    "Let N0 = N ∪{0}.",
    "Ackermann’s function is the function A :",
    "N0 ×",
    "N0 →N0 defined by\nthe equations\nA(0, y) = y + 1,\nA(x + 1, 0) = A(x, 1),\nA(x + 1, y + 1) = A(x, A(x + 1, y)).\n",
    "Use this definition to compute A(3, 1).\n",
    "Write a program to evaluate Ackermann’s\nfunction.\n",
    "Modify the program to count the number of statements executed in the\nprogram when Ackermann’s function is evaluated.",
    "How many statements are executed\nin the evaluation of A(4, 1)?",
    "What about A(5, 1)?\n3.\nWrite a computer program that will implement the Euclidean algorithm.",
    "The program\nshould accept two positive integers a and b as input and should output gcd(a, b) as\nwell as integers r and s such that\ngcd(a, b) = ra + sb.\n2.6 References and Suggested Readings\n[1]\nBrookshear, J. G. Theory of Computation: Formal Languages, Automata, and Com-\nplexity.",
    "Benjamin/Cummings, Redwood City, CA, 1989.",
    "Shows the relationships of\nthe theoretical aspects of computer science to set theory and the integers.\n\n",
    "CHAPTER 2.",
    "THE INTEGERS\n27\n[2]\nHardy, G. H. and Wright, E. M. An Introduction to the Theory of Numbers.",
    "6th ed.\n",
    "Oxford University Press, New York, 2008.\n",
    "[3]\nNiven, I. and Zuckerman, H. S. An Introduction to the Theory of Numbers.",
    "5th ed.\n",
    "Wiley, New York, 1991.\n",
    "[4]\nVanden Eynden, C. Elementary Number Theory.\n",
    "2nd ed.\n",
    "Waveland Press, Long\nGrove IL, 2001.\n\n",
    "3\nGroups\nWe begin our study of algebraic structures by investigating sets associated with single\noperations that satisfy certain reasonable axioms; that is, we want to define an operation\non a set in a way that will generalize such familiar structures as the integers Z together\nwith the single operation of addition, or invertible 2 × 2 matrices together with the single\noperation of matrix multiplication.",
    "The integers and the 2×2 matrices, together with their\nrespective single operations, are examples of algebraic structures known as groups.\n",
    "The theory of groups occupies a central position in mathematics.",
    "Modern group theory\narose from an attempt to find the roots of a polynomial in terms of its coeﬀicients.",
    "Groups\nnow play a central role in such areas as coding theory, counting, and the study of symmetries;\nmany areas of biology, chemistry, and physics have benefited from group theory.\n",
    "3.1 Integer Equivalence Classes and Symmetries\nLet us now investigate some mathematical structures that can be viewed as sets with single\noperations.\n",
    "The Integers mod n\nThe integers mod n have become indispensable in the theory and applications of algebra.\n",
    "In mathematics they are used in cryptography, coding theory, and the detection of errors\nin identification codes.\n",
    "We have already seen that two integers a and b are equivalent mod n if n divides a −b.\n",
    "The integers mod n also partition Z into n different equivalence classes; we will denote the set\nof these equivalence classes by Zn.",
    "Consider the integers modulo 12 and the corresponding\npartition of the integers:\n",
    "[0] = {. . .",
    ", −12, 0, 12, 24, . . .",
    "},\n[1] = {. . .",
    ", −11, 1, 13, 25, . . .},\n...\n",
    "[11] = {. . .",
    ", −1, 11, 23, 35, . . .}.\n",
    "When no confusion can arise, we will use 0, 1, . . .",
    ", 11 to indicate the equivalence classes\n[0], [1], . .",
    ".",
    ",",
    "[11] respectively.",
    "We can do arithmetic on Zn.",
    "For two integers a and b, define\naddition modulo n to be (a + b) (mod n); that is, the remainder when a + b is divided by\n28\n\nCHAPTER 3.",
    "GROUPS\n29\nn.",
    "Similarly, multiplication modulo n is defined as (ab) (mod n), the remainder when ab is\ndivided by n.\nExample 3.1 The following examples illustrate integer arithmetic modulo n:\n7 + 4 ≡1\n(mod 5)\n7 · 3 ≡1\n(mod 5)\n3 + 5 ≡0\n(mod 8)\n3 · 5 ≡7\n(mod 8)\n3 + 4 ≡7\n(mod 12)\n3 · 4 ≡0\n(mod 12).\n",
    "In particular, notice that it is possible that the product of two nonzero numbers modulo n\ncan be equivalent to 0 modulo n.\n□\nExample 3.2 Most, but not all, of the usual laws of arithmetic hold for addition and\nmultiplication in Zn.",
    "For instance, it is not necessarily true that there is a multiplicative\ninverse.",
    "Consider the multiplication table for Z8 in Figure 3.3.",
    "Notice that 2, 4, and 6 do\nnot have multiplicative inverses; that is, for n = 2, 4, or 6, there is no integer k such that\nkn ≡1 (mod 8).\n",
    "·\n0\n1\n2\n3\n4\n5\n6\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n1\n2\n3\n4\n5\n6\n7\n2\n0\n2\n4\n6\n0\n2\n4\n6\n3\n0\n3\n6\n1\n4\n7\n2\n5\n4\n0\n4\n0\n4\n0\n4\n0\n4\n5\n0\n5\n2\n7\n4\n1\n6\n3\n6\n0\n6\n4\n2\n0\n6\n4\n2\n7\n0\n7\n6\n5\n4\n3\n2\n1\nFigure 3.3 Multiplication table for Z8\n□\nProposition 3.4 Let Zn be the set of equivalence classes of the integers mod n and a, b, c ∈\nZn.\n1.",
    "Addition and multiplication are commutative:\na + b ≡b + a\n(mod n)\nab ≡ba\n(mod n).\n",
    "2.",
    "Addition and multiplication are associative:\n(a + b)",
    "+",
    "c ≡a",
    "+ (b + c)\n(mod n)\n(ab)c ≡a(bc)\n(mod n).\n",
    "3.",
    "There are both additive and multiplicative identities:\na + 0 ≡a\n(mod n)\na · 1 ≡a\n(mod n).\n",
    "4. Multiplication distributes over addition:\na(b + c) ≡ab + ac\n(mod n).\n\n",
    "CHAPTER 3. GROUPS\n30\n5.",
    "For every integer a there is an additive inverse −a:\na + (−a) ≡0\n(mod n).\n",
    "6.",
    "Let a be a nonzero integer.",
    "Then gcd(a, n) = 1 if and only if there exists a multiplicative\ninverse b for a (mod n); that is, a nonzero integer b such that\nab ≡1\n(mod n).\n",
    "Proof.",
    "We will prove (1) and (6) and leave the remaining properties to be proven in the\nexercises.\n",
    "(1) Addition and multiplication are commutative modulo n since the remainder of a + b\ndivided by n is the same as the remainder of b + a divided by n.\n(6) Suppose that gcd(a, n) = 1.",
    "Then there exist integers r and s such that ar + ns =",
    "1.\nSince ns = 1 −ar, it must be the case that ar ≡1 (mod n).",
    "Letting b be the equivalence\nclass of r, ab ≡1 (mod n).\n",
    "Conversely, suppose that there exists an integer b such that ab ≡1 (mod n).",
    "Then n\ndivides ab −1, so there is an integer k such that ab −nk = 1.",
    "Let d = gcd(a, n).",
    "Since d\ndivides ab −nk, d must also divide 1; hence, d = 1.\n",
    "■\n\nCHAPTER 3. GROUPS\n31\nSymmetries\nidentity\nB\nC\nA\nD\nB\nC\nA\nD\n180◦\nrotation\nB\nC\nA\nD\nD\nA\nC\nB\nreflection\nvertical axis\nB\nC\nA\nD\nA\nD\nB\nC\nreflection\nhorizontal axis\nB\nC\nA\nD\nC\nB\nD\nA\nFigure 3.5 Rigid motions of a rectangle\nA symmetry of a geometric figure is a rearrangement of the figure preserving the arrange-\nment of its sides and vertices as well as its distances and angles.",
    "A map from the plane\nto itself preserving the symmetry of an object is called a rigid motion.",
    "For example, if we\nlook at the rectangle in Figure 3.5, it is easy to see that a rotation of 180◦or 360◦returns\na rectangle in the plane with the same orientation as the original rectangle and the same\nrelationship among the vertices.",
    "A reflection of the rectangle across either the vertical axis\nor the horizontal axis can also be seen to be a symmetry.",
    "However, a 90◦rotation in either\ndirection cannot be a symmetry unless the rectangle is a square.\n\n",
    "CHAPTER 3. GROUPS\n32\nA\nB\nC\nA\nB\nC\nidentity\nid =\n\u0012A\nB\nC\nA\nB\nC\n\u0013\n",
    "A\nB\nC\nC\nB\nA\nrotation\nρ1 =\n\u0012A\nB\nC\nB\nC\nA\n\u0013\nA\nB\nC\nB\nA\nC\nrotation\nρ2 =\n\u0012A\nB\nC\nC\nA\nB\n\u0013\nA\nB\nC\nreflection\nA\nC\nB\nµ1 =\n\u0012A\nB\nC\nA\nC\nB\n\u0013\nA\nB\nC\nreflection\nC\nB\nA\nµ2 =\n\u0012A\nB\nC\nC\nB\nA\n\u0013\nA\nB\nC\nreflection\nB\nA\nC\nµ3 =\n\u0012A\nB\nC\nB\nA\nC\n\u0013\nFigure 3.6 Symmetries of a triangle\nLet us find the symmetries of the equilateral triangle △ABC.",
    "To find a symmetry of\n\nCHAPTER 3. GROUPS\n33\n△ABC, we must first examine the permutations of the vertices A, B, and C and then ask\nif a permutation extends to a symmetry of the triangle.",
    "Recall that a permutation of a set\nS is a one-to-one and onto map π : S →S. The three vertices have 3!",
    "= 6 permutations,\nso the triangle has at most six symmetries.",
    "To see that there are six permutations, observe\nthere are three different possibilities for the first vertex, and two for the second, and the\nremaining vertex is determined by the placement of the first two.",
    "So we have 3·2·1 = 3!",
    "= 6\ndifferent arrangements.",
    "To denote the permutation of the vertices of an equilateral triangle\nthat sends A to B, B to C, and C to A, we write the array\n\u0012A\nB\nC\nB\nC\nA\n\u0013\n.\n",
    "Notice that this particular permutation corresponds to the rigid motion of rotating the\ntriangle by 120◦in a clockwise direction.",
    "In fact, every permutation gives rise to a symmetry\nof the triangle.",
    "All of these symmetries are shown in Figure 3.6.\n",
    "A natural question to ask is what happens if one motion of the triangle △ABC is\nfollowed by another.\n",
    "Which symmetry is µ1ρ1; that is, what happens when we do the\npermutation ρ1 and then the permutation µ1?",
    "Remember that we are composing functions\nhere.",
    "Although we usually multiply left to right, we compose functions right to left.",
    "We have\n(µ1ρ1)(A) = µ1(ρ1(A))",
    "= µ1(B) = C\n(µ1ρ1)(B) = µ1(ρ1(B))",
    "= µ1(C) = B\n(µ1ρ1)(C) = µ1(ρ1(C))",
    "= µ1(A) = A.\n",
    "This is the same symmetry as µ2.\n",
    "Suppose we do these motions in the opposite order,\nρ1 then µ1.\n",
    "It is easy to determine that this is the same as the symmetry µ3; hence,\nρ1µ1 ̸= µ1ρ1.",
    "A multiplication table for the symmetries of an equilateral triangle △ABC is\ngiven in Figure 3.7.\n",
    "Notice that in the multiplication table for the symmetries of an equilateral triangle, for\nevery motion of the triangle α there is another motion β such that αβ = id; that is, for\nevery motion there is another motion that takes the triangle back to its original orientation.\n",
    "◦\nid\nρ1\nρ2\nµ1\nµ2\nµ3\nid\nid\nρ1\nρ2\nµ1\nµ2\nµ3\nρ1\nρ1\nρ2\nid\nµ3\nµ1\nµ2\nρ2\nρ2\nid\nρ1\nµ2\nµ3\nµ1\nµ1\nµ1\nµ2\nµ3\nid\nρ1\nρ2\nµ2\nµ2\nµ3\nµ1\nρ2\nid\nρ1\nµ3\nµ3\nµ1\nµ2\nρ1\nρ2\nid\nFigure 3.7 Symmetries of an equilateral triangle\n3.2 Definitions and Examples\n",
    "The integers mod n and the symmetries of a triangle or a rectangle are examples of groups.\n",
    "A binary operation or law of composition on a set G is a function G ×",
    "G →G that assigns\nto each pair (a, b) ∈G",
    "× G a unique element a ◦b, or ab in G, called the composition of\na and b.",
    "A group (G, ◦) is a set G together with a law of composition (a, b) 7→a",
    "◦b that\nsatisfies the following axioms.\n\n",
    "CHAPTER 3. GROUPS\n34\n•",
    "The law of composition is associative.",
    "That is,\n(a ◦b) ◦c",
    "= a ◦(b ◦c)\nfor a, b, c ∈G.\n• There exists an element e ∈G, called the identity element, such that for any element\na ∈G\ne ◦a = a ◦e = a.\n•",
    "For each element a ∈G, there exists an inverse element in G, denoted by a−1, such\nthat\na ◦a−1 = a−1 ◦a = e.\nA group G with the property that a ◦b = b ◦a for all a, b ∈G is called abelian or com-\nmutative.",
    "Groups not satisfying this property are said to be nonabelian or noncommutative.\n",
    "Example 3.8 The integers Z = {. . .",
    ", −1, 0, 1, 2, . . .} form a group under the operation of\naddition.",
    "The binary operation on two integers m, n ∈Z is just their sum.",
    "Since the integers\nunder addition already have a well-established notation, we will use the operator + instead\nof ◦; that is, we shall write m",
    "+ n instead of m ◦n.",
    "The identity is 0, and the inverse of\nn ∈Z is written as −n instead of n−1.",
    "Notice that the set of integers under addition have\nthe additional property that m + n = n + m and therefore form an abelian group.\n",
    "□\nMost of the time we will write ab instead of a ◦b; however, if the group already has a\nnatural operation such as addition in the integers, we will use that operation.",
    "That is, if\nwe are adding two integers, we still write m",
    "+ n, −n for the inverse, and 0 for the identity\nas usual.",
    "We also write m −n instead of m +",
    "(−n).\n",
    "It is often convenient to describe a group in terms of an addition or multiplication table.\n",
    "Such a table is called a Cayley table.\n",
    "Example 3.9 The integers mod n form a group under addition modulo n. Consider Z5,\nconsisting of the equivalence classes of the integers 0, 1, 2, 3, and 4.",
    "We define the group\noperation on Z5 by modular addition.",
    "We write the binary operation on the group additively;\nthat is, we write m +",
    "n.",
    "The element 0 is the identity of the group and each element in Z5\nhas an inverse.",
    "For instance, 2 + 3 = 3 + 2 = 0.",
    "Figure 3.10 is a Cayley table for Z5.",
    "By\nProposition 3.4, Zn = {0, 1, . . .",
    ", n −1} is a group under the binary operation of addition\nmod n.\n",
    "+\n0\n1\n2\n3\n4\n0\n0\n1\n2\n3\n4\n1\n1\n2\n3\n4\n0\n2\n2\n3\n4\n0\n1\n3\n3\n4\n0\n1\n2\n4\n4\n0\n1\n2\n3\nFigure 3.10 Cayley table for (Z5, +)\n□\nExample 3.11 Not every set with a binary operation is a group.",
    "For example, if we let\nmodular multiplication be the binary operation on Zn, then Zn fails to be a group.",
    "The\nelement 1 acts as a group identity since 1 · k = k · 1 = k for any k ∈Zn; however, a\nmultiplicative inverse for 0 does not exist since 0 ·",
    "k = k · 0",
    "= 0 for every k in Zn.",
    "Even if\nwe consider the set Zn \\ {0}, we still may not have a group.",
    "For instance, let 2 ∈Z6.",
    "Then\n\nCHAPTER 3. GROUPS\n35\n2 has no multiplicative inverse since\n0 · 2 = 0\n1 · 2 = 2\n2 · 2 = 4\n3 · 2 = 0\n4 · 2 = 2\n5 · 2 = 4.\n",
    "By Proposition 3.4, every nonzero k does have an inverse in Zn if k is relatively prime to\nn.",
    "Denote the set of all such nonzero elements in Zn by U(n).",
    "Then U(n) is a group called\nthe group of units of Zn. Figure 3.12 is a Cayley table for the group U(8).\n",
    "·\n1\n3\n5\n7\n1\n1\n3\n5\n7\n3\n3\n1\n7\n5\n5\n5\n7\n1\n3\n7\n7\n5\n3\n1\nFigure 3.12 Multiplication table for U(8)\n□\nExample 3.13 The symmetries of an equilateral triangle described in Section 3.1 form\na nonabelian group.\n",
    "As we observed, it is not necessarily true that αβ",
    "= βα for two\nsymmetries α and β.",
    "Using Figure 3.7, which is a Cayley table for this group, we can easily\ncheck that the symmetries of an equilateral triangle are indeed a group.",
    "We will denote this\ngroup by either S3 or D3, for reasons that will be explained later.\n",
    "□\nExample 3.14 We use M2(R) to denote the set of all 2 × 2 matrices.",
    "Let GL2(R) be the\nsubset of M2(R) consisting of invertible matrices; that is, a matrix\nA =\n\u0012a\nb\nc\nd\n\u0013\nis in GL2(R) if there exists a matrix A−1 such that AA−1 = A−1A = I, where I is the 2 × 2\nidentity matrix.",
    "For A to have an inverse is equivalent to requiring that the determinant of\nA be nonzero; that is, det A = ad −bc ̸= 0.",
    "The set of invertible matrices forms a group\ncalled the general linear group.\n",
    "The identity of the group is the identity matrix\nI =\n\u00121\n0\n0\n1\n\u0013\n.\n",
    "The inverse of A ∈GL2(R) is\nA−1 =\n1\nad −bc\n\u0012 d\n−b\n−c\na\n\u0013\n.\n",
    "The product of two invertible matrices is again invertible.",
    "Matrix multiplication is associa-\ntive, satisfying the other group axiom.",
    "For matrices it is not true in general that AB = BA;\nhence, GL2(R) is another example of a nonabelian group.\n",
    "□\nExample 3.15 Let\n1 =\n\u00121\n0\n0\n1\n\u0013\nI =\n\u0012 0\n1\n−1\n0\n\u0013\n\nCHAPTER 3. GROUPS\n36\nJ =\n\u00120\ni\ni\n0\n\u0013\nK =\n\u0012i\n0\n0\n−i\n\u0013\n,\nwhere i2 = −1.",
    "Then the relations I2 = J2 = K2 = −1, IJ = K, JK = I, KI = J,\nJI = −K, KJ = −I, and IK = −J hold.",
    "The set Q8 = {±1, ±I, ±J, ±K} is a group\ncalled the quaternion group.\n",
    "Notice that Q8 is noncommutative.\n",
    "□\nExample 3.16 Let C∗be the set of nonzero complex numbers.",
    "Under the operation of\nmultiplication C∗forms a group.",
    "The identity is 1.",
    "If z = a + bi is a nonzero complex\nnumber, then\nz−1 = a −bi\na2 + b2\nis the inverse of z.",
    "It is easy to see that the remaining group axioms hold.\n",
    "□\nA group is finite, or has finite order, if it contains a finite number of elements; otherwise,\nthe group is said to be infinite or to have infinite order.",
    "The order of a finite group is the\nnumber of elements that it contains.\n",
    "If G is a group containing n elements, we write\n|G| = n.",
    "The group Z5 is a finite group of order 5; the integers Z form an infinite group\nunder addition, and we sometimes write |Z| = ∞.\nBasic Properties of Groups\nProposition 3.17",
    "The identity element in a group G is unique; that is, there exists only\none element e ∈G such that eg = ge = g for all g ∈G.\nProof.",
    "Suppose that e and e′ are both identities in G. Then eg = ge = g and e′g = ge′",
    "= g\nfor all g ∈G. We need to show that e = e′.",
    "If we think of e as the identity, then ee′ = e′;\nbut if e′ is the identity, then ee′ = e. Combining these two equations, we have e = ee′ = e′.\n■\nInverses in a group are also unique.\n",
    "If g′ and g′′ are both inverses of an element g\nin a group G, then gg′ = g′g = e and gg′′ = g′′g = e. We want to show that g′ = g′′,\nbut g′ = g′e = g′(gg′′)",
    "= (g′g)g′′ = eg′′ = g′′. We summarize this fact in the following\nproposition.\n",
    "Proposition 3.18 If g is any element in a group G, then the inverse of g, denoted by g−1,\nis unique.\n",
    "Proposition 3.19 Let G be a group.",
    "If a, b ∈G, then (ab)−1 = b−1a−1.\nProof.",
    "Let a, b ∈G. Then abb−1a−1 = aea−1 = aa−1 = e. Similarly, b−1a−1ab = e.",
    "But\nby the previous proposition, inverses are unique; hence, (ab)−1 = b−1a−1.\n",
    "■\nProposition 3.20 Let G be a group.",
    "For any a ∈G, (a−1)−1 = a.\nProof.",
    "Observe that a−1(a−1)−1 = e. Consequently, multiplying both sides of this equa-\ntion by a, we have\n(a−1)−1 = e(a−1)−1 = aa−1(a−1)−1 = ae = a.\n■\nIt makes sense to write equations with group elements and group operations.",
    "If a and b\nare two elements in a group G, does there exist an element x ∈G such that ax = b?",
    "If such\nan x does exist, is it unique?",
    "The following proposition answers both of these questions\npositively.\n",
    "Proposition 3.21 Let G be a group and a and b be any two elements in G.",
    "Then the\nequations ax = b and xa = b have unique solutions in G.\n\nCHAPTER 3. GROUPS\n37\nProof.",
    "Suppose that ax = b.",
    "We must show that such an x exists.",
    "We can multiply both\nsides of ax = b by a−1 to find x = ex = a−1ax = a−1b.\nTo show uniqueness, suppose that x1 and x2 are both solutions of ax = b; then ax1 =\nb = ax2.",
    "So x1 = a−1ax1 = a−1ax2",
    "=",
    "x2.",
    "The proof for the existence and uniqueness of\nthe solution of xa = b is similar.\n",
    "■\nProposition 3.22 If G is a group and a, b, c ∈G, then ba = ca implies b = c and ab = ac\nimplies b = c.\n",
    "This proposition tells us that the right and left cancellation laws are true in groups.",
    "We\nleave the proof as an exercise.\n",
    "We can use exponential notation for groups just as we do in ordinary algebra.",
    "If G is a\ngroup and g ∈G, then we define g0 = e. For n ∈N, we define\ngn = g · g · · · g\n|\n{z\n}\nn times\nand\ng−n = g−1 · g−1 · · · g−1\n|\n{z\n}\nn times\n.\n",
    "Theorem 3.23 In a group, the usual laws of exponents hold; that is, for all g, h ∈G,\n1.",
    "gmgn = gm+n for all m, n ∈Z;\n2.",
    "(gm)n = gmn for all m, n ∈Z;\n3.",
    "(gh)n = (h−1g−1)−n for all n ∈Z.",
    "Furthermore, if G is abelian, then (gh)n = gnhn.\nWe will leave the proof of this theorem as an exercise.",
    "Notice that (gh)n ̸= gnhn in\ngeneral, since the group may not be abelian.",
    "If the group is Z or Zn, we write the group\noperation additively and the exponential operation multiplicatively; that is, we write ng\ninstead of gn.",
    "The laws of exponents now become\n1.",
    "mg +",
    "ng = (m + n)g for all m, n ∈Z;\n2. m(ng)",
    "= (mn)g for all m, n ∈Z;\n3. m(g",
    "+ h)",
    "= mg + mh for all n ∈Z.\nIt is important to realize that the last statement can be made only because Z and Zn\nare commutative groups.\n",
    "Historical Note\nAlthough the first clear axiomatic definition of a group was not given until the late 1800s,\ngroup-theoretic methods had been employed before this time in the development of many\nareas of mathematics, including geometry and the theory of algebraic equations.\n",
    "Joseph-Louis Lagrange used group-theoretic methods in a 1770–1771 memoir to study meth-\nods of solving polynomial equations.",
    "Later, Évariste Galois (1811–1832) succeeded in devel-\noping the mathematics necessary to determine exactly which polynomial equations could be\nsolved in terms of the coeﬀicients of the polynomial.",
    "Galois’ primary tool was group theory.\n",
    "The study of geometry was revolutionized in 1872 when Felix Klein proposed that geo-\nmetric spaces should be studied by examining those properties that are invariant under\na transformation of the space.",
    "Sophus Lie, a contemporary of Klein, used group theory\nto study solutions of partial differential equations.",
    "One of the first modern treatments of\ngroup theory appeared in William Burnside’s The Theory of Groups of Finite Order [1],\nfirst published in 1897.\n\n",
    "CHAPTER 3. GROUPS\n38\n3.3 Subgroups\nDefinitions and Examples\nSometimes we wish to investigate smaller groups sitting inside a larger group.",
    "The set of\neven integers 2Z = {. . . , −2, 0, 2, 4, . . .} is a group under the operation of addition.",
    "This\nsmaller group sits naturally inside of the group of integers under addition.",
    "We define a\nsubgroup H of a group G to be a subset H of G such that when the group operation of\nG is restricted to H, H is a group in its own right.",
    "Observe that every group G with at\nleast two elements will always have at least two subgroups, the subgroup consisting of the\nidentity element alone and the entire group itself.",
    "The subgroup H = {e} of a group G\nis called the trivial subgroup.",
    "A subgroup that is a proper subset of G is called a proper\nsubgroup.",
    "In many of the examples that we have investigated up to this point, there exist\nother subgroups besides the trivial and improper subgroups.\n",
    "Example 3.24 Consider the set of nonzero real numbers, R∗, with the group operation of\nmultiplication.",
    "The identity of this group is 1 and the inverse of any element a ∈R∗is just\n1/a. We will show that\nQ∗= {p/q : p and q are nonzero integers}\nis a subgroup of R∗. The identity of R∗is 1; however, 1 = 1/1 is the quotient of two nonzero\nintegers.",
    "Hence, the identity of R∗is in Q∗. Given two elements in Q∗, say p/q and r/s,\ntheir product pr/qs is also in Q∗.",
    "The inverse of any element p/q ∈Q∗is again in Q∗since\n(p/q)−1 = q/p. Since multiplication in R∗is associative, multiplication in Q∗is associative.\n",
    "□\nExample 3.25 Recall that C∗is the multiplicative group of nonzero complex numbers.",
    "Let\nH = {1, −1, i, −i}.",
    "Then H is a subgroup of C∗.",
    "It is quite easy to verify that H is a group\nunder multiplication and that H ⊂C∗.\n□\nExample 3.26 Let SL2(R) be the subset of GL2(R) consisting of matrices of determinant\none; that is, a matrix\nA =\n\u0012a\nb\nc\nd\n\u0013\nis in SL2(R) exactly when ad −bc = 1.",
    "To show that SL2(R) is a subgroup of the general\nlinear group, we must show that it is a group under matrix multiplication.",
    "The 2×2 identity\nmatrix is in SL2(R), as is the inverse of the matrix A:\n",
    "A−1 =\n\u0012 d\n−b\n−c\na\n\u0013\n.\n",
    "It remains to show that multiplication is closed; that is, that the product of two matrices\nof determinant one also has determinant one.",
    "We will leave this task as an exercise.",
    "The\ngroup SL2(R) is called the special linear group.\n",
    "□\nExample 3.27",
    "It is important to realize that a subset H of a group G can be a group\nwithout being a subgroup of G. For H to be a subgroup of G, it must inherit the binary\noperation of G. The set of all 2 × 2 matrices, M2(R), forms a group under the operation of\naddition.",
    "The 2 × 2 general linear group is a subset of M2(R) and is a group under matrix\nmultiplication, but it is not a subgroup of M2(R).",
    "If we add two invertible matrices, we do\n\nCHAPTER 3. GROUPS\n39\nnot necessarily obtain another invertible matrix.",
    "Observe that\n\u00121\n0\n0\n1\n\u0013\n+\n\u0012−1\n0\n0\n−1\n\u0013\n=\n\u00120\n0\n0\n0\n\u0013\n,\nbut the zero matrix is not in GL2(R).\n",
    "□\nExample 3.28 One way of telling whether or not two groups are the same is by examining\ntheir subgroups.",
    "Other than the trivial subgroup and the group itself, the group Z4 has\na single subgroup consisting of the elements 0 and 2.",
    "From the group Z2, we can form\nanother group of four elements as follows.",
    "As a set this group is Z2 × Z2.",
    "We perform the\ngroup operation coordinatewise; that is, (a, b) + (c, d) = (a + c, b + d).",
    "Figure 3.29 is an\naddition table for Z2 × Z2.",
    "Since there are three nontrivial proper subgroups of Z2 × Z2,\nH1 = {(0, 0), (0, 1)}, H2 = {(0, 0), (1, 0)}, and H3 = {(0, 0), (1, 1)}, Z4 and Z2 ×",
    "Z2 must be\ndifferent groups.\n",
    "+\n(0, 0)\n(0, 1)\n(1, 0)\n(1, 1)\n(0, 0)\n(0, 0)\n(0, 1)\n(1, 0)\n(1, 1)\n(0, 1)\n(0, 1)\n(0, 0)\n(1, 1)\n(1, 0)\n(1, 0)\n(1, 0)\n(1, 1)\n(0, 0)\n(0, 1)\n(1, 1)\n(1, 1)\n(1, 0)\n(0, 1)\n(0, 0)\nFigure 3.29 Addition table for Z2 ×",
    "Z2\n□\nSome Subgroup Theorems\nLet us examine some criteria for determining exactly when a subset of a group is a subgroup.\n",
    "Proposition 3.30",
    "A subset H of G is a subgroup if and only if it satisfies the following\nconditions.\n",
    "1.",
    "The identity e of G is in H.\n2.",
    "If h1, h2 ∈H, then h1h2 ∈H.\n3.",
    "If h ∈H, then h−1 ∈H.\nProof.",
    "First suppose that H is a subgroup of G. We must show that the three conditions\nhold.",
    "Since H is a group, it must have an identity eH. We must show that eH = e, where e is\nthe identity of G.",
    "We know that eHeH = eH and that eeH = eHe = eH; hence, eeH = eHeH.\nBy right-hand cancellation, e = eH.",
    "The second condition holds since a subgroup H is a\ngroup.",
    "To prove the third condition, let h ∈H. Since H is a group, there is an element\nh′ ∈H such that hh′ = h′h = e.",
    "By the uniqueness of the inverse in G, h′ = h−1.\n",
    "Conversely, if the three conditions hold, we must show that H is a group under the same\noperation as G; however, these conditions plus the associativity of the binary operation are\nexactly the axioms stated in the definition of a group.\n",
    "■\nProposition 3.31 Let H be a subset of a group",
    "G. Then H is a subgroup of G if and only\nif H ̸= ∅, and whenever g, h ∈H then gh−1 is in H.\nProof.",
    "First assume that H is a subgroup of G. We wish to show that gh−1 ∈H whenever\ng and h are in H. Since h is in H, its inverse h−1 must also be in H. Because of the closure\nof the group operation, gh−1 ∈H.\nConversely, suppose that H ⊂G such that H ̸= ∅and gh−1 ∈H whenever g, h",
    "∈H. If\ng ∈H, then gg−1 = e is in H. If g ∈H, then eg−1 = g−1 is also in H. Now let h1, h2 ∈H.\n\nCHAPTER 3.",
    "GROUPS\n40\n",
    "We must show that their product is also in H. However,",
    "h1(h−1\n2 )−1 =",
    "h1h2 ∈H. Hence, H\nis a subgroup of G.\n■\nSage.\n",
    "The first half of this text is about group theory.",
    "Sage includes Groups, Algorithms\nand Programming (gap), a program designed primarly for just group theory, and in con-\ntinuous development since 1986.",
    "Many of Sage’s computations for groups ultimately are\nperformed by GAP.\n",
    "3.4 Reading Questions\n1.\n",
    "In the group Z8 compute, (a) 6 + 7, and (b) 2−1.\n2.\n",
    "In the group U(16) compute, (a) 5 · 7, and (b) 3−1.\n",
    "3.\nState the definition of a group.\n",
    "4.\nExplain a single method that will decide if a subset of a group is itself a subgroup.\n",
    "5.\nExplain the origin of the term “abelian” for a commutative group.\n",
    "6.\nGive an example of a group you have seen in your previous mathematical experience,\nbut that is not an example in this chapter.\n",
    "3.5 Exercises\n1.\nFind all x ∈Z satisfying each of the following equations.\n",
    "(a) 3x ≡2 (mod 7)\n(b) 5x + 1 ≡13 (mod 23)\n(c) 5x + 1 ≡13 (mod 26)\n(d) 9x ≡3 (mod 5)\n(e) 5x ≡1 (mod 6)\n(f) 3x ≡1 (mod 6)\n2.\n",
    "Which of the following multiplication tables defined on the set G = {a, b, c, d} form a\ngroup?",
    "Support your answer in each case.\n",
    "(a)\n◦\na\nb\nc\nd\na\na\nc\nd\na\nb\nb\nb\nc\nd\nc\nc\nd\na\nb\nd\nd\na\nb\nc\n(b)\n◦\na\nb\nc\nd\na\na\nb\nc\nd\nb\nb\na\nd\nc\nc\nc\nd\na\nb\nd\nd\nc\nb\na\n(c)\n◦\na\nb\nc\nd\na\na\nb\nc\nd\nb\nb\nc\nd\na\nc\nc\nd\na\nb\nd\nd\na\nb\nc\n(d)\n◦\na\nb\nc\nd\na\na\nb\nc\nd\nb\nb\na\nc\nd\nc\nc\nb\na\nd\nd\nd\nd\nb\nc\n3.\nWrite out Cayley tables for groups formed by the symmetries of a rectangle and for\n(Z4, +).",
    "How many elements are in each group?",
    "Are the groups the same?",
    "Why or\nwhy not?\n4.\nDescribe the symmetries of a rhombus and prove that the set of symmetries forms a\ngroup.",
    "Give Cayley tables for both the symmetries of a rectangle and the symmetries\nof a rhombus.",
    "Are the symmetries of a rectangle and those of a rhombus the same?\n\nCHAPTER 3.",
    "GROUPS\n41\n5.\nDescribe the symmetries of a square and prove that the set of symmetries is a group.\n",
    "Give a Cayley table for the symmetries.",
    "How many ways can the vertices of a square be\npermuted?",
    "Is each permutation necessarily a symmetry of the square?",
    "The symmetry\ngroup of the square is denoted by D4.\n",
    "6.\nGive a multiplication table for the group U(12).\n",
    "7.\nLet S = R \\ {−1} and define a binary operation on S by a ∗b = a + b + ab.",
    "Prove that\n(S, ∗) is an abelian group.\n",
    "8.\nGive an example of two elements A and B in GL2(R) with AB ̸= BA.\n",
    "9.\nProve that the product of two matrices in SL2(R) has determinant one.\n10.",
    "Prove that the set of matrices of the form\n\n\n1\nx\ny\n0\n1\nz\n0\n0\n1\n\n\nis a group under matrix multiplication.",
    "This group, known as the Heisenberg group,\nis important in quantum physics.",
    "Matrix multiplication in the Heisenberg group is\ndefined by\n\n\n1\nx\ny\n0\n1\nz\n0\n0\n1\n\n",
    "\n\n\n1\nx′\ny′\n0\n1\nz′\n0\n0\n1\n\n",
    "=\n\n\n1\nx + x′\ny",
    "+ y′ + xz′\n0\n1\nz + z′\n0\n0\n1\n\n.\n11.",
    "Prove that det(AB) = det(A) det(B) in GL2(R).",
    "Use this result to show that the\nbinary operation in the group GL2(R) is closed; that is, if A and B are in GL2(R),\nthen AB ∈GL2(R).\n",
    "12.",
    "Let Zn\n2 = {(a1, a2, . .",
    ".",
    ", an) : ai ∈Z2}.",
    "Define a binary operation on Zn\n2 by\n(a1, a2, . .",
    ".",
    ", an) + (b1, b2, . .",
    ".",
    ", bn) = (a1 + b1, a2 + b2, . . .",
    ", an + bn).\n",
    "Prove that Zn\n2 is a group under this operation.",
    "This group is important in algebraic\ncoding theory.\n13.",
    "Show that R∗= R \\ {0} is a group under the operation of multiplication.\n",
    "14.",
    "Given the groups R∗and Z, let G = R∗× Z. Define a binary operation ◦on G by\n(a, m) ◦(b, n) = (ab, m + n).",
    "Show that G is a group under this operation.\n15.",
    "Prove or disprove that every group containing six elements is abelian.\n",
    "16.",
    "Give a specific example of some group G and elements g, h ∈G where (gh)n ̸= gnhn.\n17.",
    "Give an example of three different groups with eight elements.",
    "Why are the groups\ndifferent?\n18.",
    "Show that there are n! permutations of a set containing n items.\n19.",
    "Show that\n0",
    "+ a ≡a + 0 ≡a\n(mod n)\nfor all a ∈Zn.\n",
    "20.",
    "Prove that there is a multiplicative identity for the integers modulo n:\na · 1 ≡a\n(mod n).\n",
    "21.",
    "For each a ∈Zn find an element b ∈Zn such that\na + b ≡b + a ≡0\n(mod n).\n\n",
    "CHAPTER 3. GROUPS\n42\n22.",
    "Show that addition and multiplication mod n are well defined operations.",
    "That is,\nshow that the operations do not depend on the choice of the representative from the\nequivalence classes mod n.\n23.",
    "Show that addition and multiplication mod n are associative operations.\n",
    "24.",
    "Show that multiplication distributes over addition modulo n:\na(b + c) ≡ab + ac\n(mod n).\n",
    "25.",
    "Let a and b be elements in a group G. Prove that abna−1 = (aba−1)n for n ∈Z.\n26.",
    "Let U(n) be the group of units in Zn.",
    "If n > 2, prove that there is an element k ∈U(n)\nsuch that k2 = 1 and k ̸= 1.\n27.",
    "Prove that the inverse of g1g2 · · · gn is g−1\nn g−1\nn−1 · · · g−1\n1 .\n28.",
    "Prove the remainder of Proposition 3.21: if G is a group and a, b ∈G, then the equation\nxa = b has a unique solution in G.\n29.",
    "Prove Theorem 3.23.\n",
    "30.",
    "Prove the right and left cancellation laws for a group G; that is, show that in the group\nG, ba = ca implies b = c and ab = ac implies b = c for elements a, b, c ∈G.\n31.",
    "Show that if a2 = e for all elements a in a group G, then G must be abelian.\n",
    "32.",
    "Show that if G is a finite group of even order, then there is an a ∈G such that a is\nnot the identity and a2 = e.\n33.",
    "Let G be a group and suppose that (ab)2 = a2b2 for all a and b in G. Prove that G is\nan abelian group.\n",
    "34.",
    "Find all the subgroups of Z3 ×Z3.",
    "Use this information to show that Z3 ×Z3 is not the\nsame group as Z9.",
    "(See Example 3.28 for a short description of the product of groups.)\n35.",
    "Find all the subgroups of the symmetry group of an equilateral triangle.\n36.",
    "Compute the subgroups of the symmetry group of a square.\n",
    "37.",
    "Let H = {2k : k ∈Z}.",
    "Show that H is a subgroup of Q∗.\n38.",
    "Let n = 0, 1, 2, . . .",
    "and nZ = {nk : k ∈Z}.",
    "Prove that nZ is a subgroup of Z. Show\nthat these subgroups are the only subgroups of Z.\n39.",
    "Let T = {z ∈C∗:",
    "|z| = 1}.",
    "Prove that T is a subgroup of C∗.\n40.",
    "Let G consist of the 2 × 2 matrices of the form\n\u0012cos θ\n−sin θ\nsin θ\ncos θ\n\u0013\n,\nwhere θ ∈R. Prove that G is a subgroup of SL2(R).\n",
    "41. Prove that\nG = {a + b\n√\n2 : a, b ∈Q and a and b are not both zero}\nis a subgroup of R∗under the group operation of multiplication.\n",
    "42.",
    "Let G be the group of 2 × 2 matrices under addition and\n",
    "H =\n\u001a\u0012a\nb\nc\nd\n\u0013\n:",
    "a + d = 0\n\u001b\n.\n",
    "Prove that H is a subgroup of G.\n\nCHAPTER 3. GROUPS\n43\n43.",
    "Prove or disprove: SL2(Z), the set of 2×2 matrices with integer entries and determinant\none, is a subgroup of SL2(R).\n",
    "44.",
    "List the subgroups of the quaternion group, Q8.\n45.",
    "Prove that the intersection of two subgroups of a group G is also a subgroup of G.\n46.",
    "Prove or disprove: If H and K are subgroups of a group G, then H ∪K is a subgroup\nof G.\n47.",
    "Prove or disprove: If H and K are subgroups of a group G, then HK = {hk : h ∈\nH and k ∈K} is a subgroup of G.",
    "What if G is abelian?\n48.",
    "Let G be a group and g ∈G. Show that\nZ(G) = {x ∈G :",
    "gx = xg for all g ∈G}\nis a subgroup of G. This subgroup is called the center of G.\n49.",
    "Let a and b be elements of a group G.",
    "If a4b = ba and a3 = e, prove that ab = ba.\n50.",
    "Give an example of an infinite group in which every nontrivial subgroup is infinite.\n51.",
    "If xy = x−1y−1 for all x and y in G, prove that G must be abelian.\n52.",
    "Prove or disprove: Every proper subgroup of a nonabelian group is nonabelian.\n",
    "53.",
    "Let H be a subgroup of G and\nC(H)",
    "= {g ∈G :",
    "gh = hg for all h ∈H}.\n",
    "Prove C(H) is a subgroup of G. This subgroup is called the centralizer of H in G.\n54.",
    "Let H be a subgroup of G. If g ∈G, show that gHg−1 = {ghg−1 : h ∈H} is also a\nsubgroup of G.\n3.6 Additional Exercises: Detecting Errors\n1.\nUPC Symbols.\n",
    "Universal Product Code (upc) symbols are found on most prod-\nucts in grocery and retail stores.",
    "The upc symbol is a 12-digit code identifying the\nmanufacturer of a product and the product itself (Figure 3.32).",
    "The first 11 digits\ncontain information about the product; the twelfth digit is used for error detection.",
    "If\nd1d2 · · · d12 is a valid upc number, then\n3 · d1 + 1 · d2 + 3 · d3 + · · · + 3 · d11 + 1 · d12 ≡0\n(mod 10).\n",
    "(a) Show that the upc number 0-50000-30042-6, which appears in Figure 3.32, is a\nvalid upc number.\n",
    "(b) Show that the number 0-50000-30043-6 is not a valid upc number.\n",
    "(c) Write a formula to calculate the check digit, d12, in the upc number.\n",
    "(d) The upc error detection scheme can detect most transposition errors; that is, it\ncan determine if two digits have been interchanged.",
    "Show that the transposition\nerror 0-05000-30042-6 is not detected.",
    "Find a transposition error that is detected.\n",
    "Can you find a general rule for the types of transposition errors that can be\ndetected?\n(e) Write a program that will determine whether or not a upc number is valid.\n\n",
    "CHAPTER 3. GROUPS\n44\n0\n50000\n30042\n6\nFigure 3.32 A upc code\n2.\n",
    "It is often useful to use an inner product notation for this type of error detection\nscheme; hence, we will use the notion\n(d1, d2, . .",
    ".",
    ", dk) · (w1, w2, . .",
    ".",
    ", wk) ≡0\n(mod n)\nto mean\nd1w1 + d2w2 + · · · + dkwk ≡0\n(mod n).\n",
    "Suppose that (d1, d2, . . .",
    ", dk) · (w1, w2, . .",
    ".",
    ", wk) ≡0 (mod n) is an error detection\nscheme for the k-digit identification number d1d2 · · · dk, where 0 ≤di < n. Prove that\nall single-digit errors are detected if and only if gcd(wi, n) = 1 for 1 ≤i ≤k.\n",
    "3.\nLet (d1, d2, . . .",
    ", dk) · (w1, w2, . .",
    ".",
    ", wk) ≡0 (mod n) be an error detection scheme for the\nk-digit identification number d1d2 · · · dk, where 0 ≤di < n. Prove that all transposition\nerrors of two digits di and dj are detected if and only if gcd(wi −wj, n) = 1 for i and\nj between 1 and k.\n4.\nISBN Codes.",
    "Every book has an International Standard Book Number (isbn) code.\n",
    "This is a 10-digit code indicating the book’s publisher and title.",
    "The tenth digit is a\ncheck digit satisfying\n(d1, d2, . . .",
    ", d10) · (10, 9, . . .",
    ", 1) ≡0\n(mod 11).\n",
    "One problem is that d10 might have to be a 10 to make the inner product zero; in this\ncase, 11 digits would be needed to make this scheme work.",
    "Therefore, the character X\nis used for the eleventh digit.",
    "So isbn 3-540-96035-X is a valid isbn code.\n",
    "(a) Is isbn 0-534-91500-0 a valid isbn code?",
    "What about isbn 0-534-91700-0 and\nisbn 0-534-19500-0?\n(b) Does this method detect all single-digit errors?",
    "What about all transposition\nerrors?\n(c) How many different isbn codes are there?\n(d) Write a computer program that will calculate the check digit for the first nine\ndigits of an isbn code.\n",
    "(e) A publisher has houses in Germany and the United States.",
    "Its German prefix is 3-\n540.",
    "If its United States prefix will be 0-abc, find abc such that the rest of the isbn\ncode will be the same for a book printed in Germany and in the United States.\n",
    "Under the isbn coding method the first digit identifies the language; German is\n3 and English is 0.",
    "The next group of numbers identifies the publisher, and the\nlast group identifies the specific book.\n\n",
    "CHAPTER 3. GROUPS\n45\n3.7 References and Suggested Readings\n",
    "[1]\nBurnside, W. Theory of Groups of Finite Order.",
    "2nd ed.",
    "Cambridge University Press,\nCambridge, 1911; Dover, New York, 1953.",
    "A classic.",
    "Also available at books.google.com.\n",
    "[2]\nGallian, J. A. and Winters, S. “Modular Arithmetic in the Marketplace,” The Amer-\nican Mathematical Monthly 95 (1988): 548–51.\n",
    "[3]\nGallian, J. A. Contemporary Abstract Algebra.",
    "7th ed.",
    "Brooks/Cole, Belmont, CA,\n2009.\n",
    "[4]\nHall, M. Theory of Groups.",
    "2nd ed.",
    "American Mathematical Society, Providence,\n1959.\n",
    "[5]\nKurosh, A. E. The Theory of Groups, vols.",
    "I and II.",
    "American Mathematical Society,\nProvidence, 1979.\n",
    "[6]\nRotman, J. J. An Introduction to the Theory of Groups.",
    "4th ed.",
    "Springer, New York,\n1995.\n\n",
    "4\nCyclic Groups\nThe groups Z and Zn, which are among the most familiar and easily understood groups, are\nboth examples of what are called cyclic groups.",
    "In this chapter we will study the properties\nof cyclic groups and cyclic subgroups, which play a fundamental part in the classification\nof all abelian groups.\n",
    "4.1 Cyclic Subgroups\nOften a subgroup will depend entirely on a single element of the group; that is, knowing\nthat particular element will allow us to compute any other element in the subgroup.\n",
    "Example 4.1 Suppose that we consider 3 ∈Z and look at all multiples (both positive and\nnegative) of 3.",
    "As a set, this is\n3Z = {. . .",
    ", −3, 0, 3, 6, . . .}.\n",
    "It is easy to see that 3Z is a subgroup of the integers.",
    "This subgroup is completely deter-\nmined by the element 3 since we can obtain all of the other elements of the group by taking\nmultiples of 3.",
    "Every element in the subgroup is “generated” by 3.\n□\nExample 4.2 If H = {2n : n ∈Z}, then H is a subgroup of the multiplicative group of\nnonzero rational numbers, Q∗. If a = 2m and b = 2n are in H, then ab−1 = 2m2−n = 2m−n\nis also in H. By Proposition 3.31, H is a subgroup of Q∗determined by the element 2.\n□\nTheorem 4.3 Let G be a group and a be any element in G.",
    "Then the set\n⟨a⟩= {ak : k ∈Z}\nis a subgroup of G. Furthermore, ⟨a⟩is the smallest subgroup of G that contains a.\nProof.",
    "The identity is in ⟨a⟩since a0 = e.",
    "If g and h are any two elements in ⟨a⟩, then\nby the definition of ⟨a⟩we can write g = am and h = an for some integers m and n.",
    "So\ngh = aman =",
    "am+n is again in ⟨a⟩. Finally, if g = an in ⟨a⟩, then the inverse g−1 = a−n is\nalso in ⟨a⟩. Clearly, any subgroup H of G containing a must contain all the powers of a by\nclosure; hence, H contains ⟨a⟩. Therefore, ⟨a⟩is the smallest subgroup of G containing a.\n■\nRemark 4.4",
    "If we are using the “+” notation, as in the case of the integers under addition,\nwe write ⟨a⟩= {na : n ∈Z}.\n",
    "For a ∈G, we call ⟨a⟩the cyclic subgroup generated by a.",
    "If G contains some element\na such that G = ⟨a⟩, then G is a cyclic group.",
    "In this case a is a generator of G. If a is an\n46\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n47\nelement of a group G, we define the order of a to be the smallest positive integer n such\nthat an = e, and we write |a| = n.",
    "If there is no such integer n, we say that the order of a\nis infinite and write |a| = ∞to denote the order of a.\nExample 4.5 Notice that a cyclic group can have more than a single generator.",
    "Both 1 and\n5 generate Z6; hence, Z6 is a cyclic group.",
    "Not every element in a cyclic group is necessarily\na generator of the group.",
    "The order of 2 ∈Z6 is 3.",
    "The cyclic subgroup generated by 2 is\n⟨2⟩= {0, 2, 4}.\n",
    "□\nThe groups Z and Zn are cyclic groups.",
    "The elements 1 and −1 are generators for Z.\n",
    "We can certainly generate Zn with 1 although there may be other generators of Zn, as in\nthe case of Z6.\n",
    "Example 4.6 The group of units, U(9), in Z9 is a cyclic group.\n",
    "As a set, U(9) is\n{1, 2, 4, 5, 7, 8}.",
    "The element 2 is a generator for U(9) since\n21 = 2\n22 = 4\n23 = 8\n24 = 7\n25 = 5\n26 = 1.\n□\nExample 4.7 Not every group is a cyclic group.\n",
    "Consider the symmetry group of an\nequilateral triangle S3.",
    "The multiplication table for this group is Figure 3.7.",
    "The subgroups\nof S3 are shown in Figure 4.8.",
    "Notice that every subgroup is cyclic; however, no single\nelement generates the entire group.\n",
    "S3\n{id, ρ1, ρ2} {id, µ1}\n{id, µ2}\n{id, µ3}\n{id}\nFigure 4.8 Subgroups of S3\n□\nTheorem 4.9 Every cyclic group is abelian.\n",
    "Proof.",
    "Let G be a cyclic group and a ∈G be a generator for G. If g and h are in G, then\nthey can be written as powers of a, say g = ar and h = as.",
    "Since\ngh = aras = ar+s = as+r = asar = hg,\nG is abelian.\n",
    "■\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n48\nSubgroups of Cyclic Groups\n",
    "We can ask some interesting questions about cyclic subgroups of a group and subgroups of\na cyclic group.",
    "If G is a group, which subgroups of G are cyclic?",
    "If G is a cyclic group,\nwhat type of subgroups does G possess?\n",
    "Theorem 4.10",
    "Every subgroup of a cyclic group is cyclic.\n",
    "Proof.",
    "The main tools used in this proof are the division algorithm and the Principle of\nWell-Ordering.",
    "Let G be a cyclic group generated by a and suppose that H is a subgroup\nof G. If H = {e}, then trivially H is cyclic.",
    "Suppose that H contains some other element\ng distinct from the identity.",
    "Then g can be written as an for some integer n.",
    "Since H is a\nsubgroup, g−1 = a−n must also be in H. Since either n or −n is positive, we can assume\nthat H contains positive powers of a and n > 0.",
    "Let m be the smallest natural number\nsuch that am ∈H.",
    "Such an m exists by the Principle of Well-Ordering.\n",
    "We claim that h = am is a generator for H. We must show that every h′ ∈H can be\nwritten as a power of h. Since h′ ∈H and H is a subgroup of G, h′ = ak for some integer\nk. Using the division algorithm, we can find numbers q and r such that k = mq + r where\n0 ≤r < m; hence,\nak = amq+r = (am)qar = hqar.\n",
    "So ar = akh−q.",
    "Since ak and h−q are in H, ar must also be in H. However, m was the\nsmallest positive number such that am was in H; consequently, r = 0 and so k = mq.\n",
    "Therefore,\nh′ = ak = amq = hq\nand H is generated by h.\n■\nCorollary 4.11 The subgroups of Z are exactly nZ for n = 0, 1, 2, . .",
    "..\n",
    "Proposition 4.12 Let G be a cyclic group of order n and suppose that a is a generator for\nG. Then ak = e if and only if n divides k.\nProof.",
    "First suppose that ak = e. By the division algorithm, k = nq + r where 0 ≤r < n;\nhence,\ne = ak = anq+r = anqar = ear = ar.\n",
    "Since the smallest positive integer m such that am = e is n, r = 0.\n",
    "Conversely, if n divides k, then k = ns for some integer s.",
    "Consequently,\nak = ans = (an)s = es = e.\n■\nTheorem 4.13 Let G be a cyclic group of order n and suppose that a ∈G is a generator\nof the group.",
    "If b = ak, then the order of b is n/d, where d = gcd(k, n).\n",
    "Proof.\n",
    "We wish to find the smallest integer m such that e = bm = akm.",
    "By Proposi-\ntion 4.12, this is the smallest integer m such that n divides km or, equivalently, n/d divides\nm(k/d).",
    "Since d is the greatest common divisor of n and k, n/d and k/d are relatively\nprime.",
    "Hence, for n/d to divide m(k/d) it must divide m.",
    "The smallest such m is n/d.\n■\nCorollary 4.14 The generators of Zn are the integers r such that 1 ≤r < n and gcd(r, n) =\n1.\n",
    "Example 4.15 Let us examine the group Z16.",
    "The numbers 1, 3, 5, 7, 9, 11, 13, and 15\nare the elements of Z16 that are relatively prime to 16.",
    "Each of these elements generates\nZ16.",
    "For example,\n1 · 9 = 9\n2 · 9 = 2\n3 · 9 = 11\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n49\n4 · 9 = 4\n5 · 9 = 13\n6 · 9 = 6\n7 · 9 = 15\n8 · 9 = 8\n9 · 9 = 1\n10 · 9 = 10\n11 · 9 = 3\n12 · 9 = 12\n13 · 9 = 5\n14 · 9 = 14\n15 · 9 = 7.\n□\n4.2 Multiplicative Group of Complex Numbers\nThe complex numbers are defined as\nC = {a + bi : a, b ∈R},\nwhere i2 = −1.",
    "If z = a + bi, then a is the real part of z and b is the imaginary part of z.\n",
    "To add two complex numbers z = a + bi and w = c + di, we just add the corresponding\nreal and imaginary parts:\nz + w = (a + bi) +",
    "(c + di) = (a + c)",
    "+ (b + d)i.\n",
    "Remembering that i2 = −1, we multiply complex numbers just like polynomials.\n",
    "The\nproduct of z and w is\n(a + bi)(c + di) = ac + bdi2 + adi + bci = (ac −bd)",
    "+ (ad + bc)i.\n",
    "Every nonzero complex number z = a + bi has a multiplicative inverse; that is, there\nexists a z−1 ∈C∗such that zz−1 = z−1z = 1.",
    "If z = a + bi, then\nz−1 = a −bi\na2 + b2 .\n",
    "The complex conjugate of a complex number z = a + bi is defined to be z = a −bi.",
    "The\nabsolute value or modulus of z = a + bi is |z| =\n√\na2 + b2.\n",
    "Example 4.16 Let z = 2 + 3i and w = 1 −2i.",
    "Then\nz + w = (2 + 3i) + (1 −2i) = 3 + i\nand\nzw = (2 + 3i)(1 −2i)",
    "= 8 −i.\n",
    "Also,\nz−1 = 2\n13 −3\n13i\n|z| =\n√\n13\nz = 2 −3i.\n",
    "□\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n50\ny\nx\n0\nz1 = 2 + 3i\nz3 = −3 + 2i\nz2 = 1 −2i\nFigure 4.17 Rectangular coordinates of a complex number\nThere are several ways of graphically representing complex numbers.",
    "We can represent\na complex number z = a + bi as an ordered pair on the xy plane where a is the x (or\nreal) coordinate and b is the y (or imaginary) coordinate.",
    "This is called the rectangular or\nCartesian representation.",
    "The rectangular representations of z1 = 2 + 3i, z2 = 1 −2i, and\nz3 = −3 + 2i are depicted in Figure 4.17.\n",
    "y\nx\n0\na + bi\nr\nθ\nFigure 4.18 Polar coordinates of a complex number\nNonzero complex numbers can also be represented using polar coordinates.",
    "To specify\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n51\nany nonzero point on the plane, it suﬀices to give an angle θ from the positive x axis in the\ncounterclockwise direction and a distance r from the origin, as in Figure 4.18.",
    "We can see\nthat\nz = a +",
    "bi = r(cos θ",
    "+ i sin θ).\n",
    "Hence,\nr = |z| =\np\na2 + b2\nand\na = r cos θ\nb = r sin θ.\n",
    "We sometimes abbreviate r(cos θ + i sin θ) as r cis θ.",
    "To assure that the representation of z\nis well-defined, we also require that 0◦≤θ < 360◦.",
    "If the measurement is in radians, then\n0 ≤θ < 2π.\n",
    "Example 4.19 Suppose that z = 2 cis 60◦.",
    "Then\na = 2 cos 60◦= 1\nand\nb = 2 sin 60◦=\n√\n3.\n",
    "Hence, the rectangular representation is z = 1 +\n√\n3 i.\nConversely, if we are given a rectangular representation of a complex number, it is often\nuseful to know the number’s polar representation.",
    "If z = 3\n√\n2 −3\n√\n2 i, then\nr =\np\na2 + b2 =\n√\n36 = 6\nand\nθ = arctan\n\u0012 b\na\n\u0013\n= arctan(−1) = 315◦,\nso 3\n√\n2 −3\n√\n2",
    "i = 6 cis 315◦.\n",
    "□\nThe polar representation of a complex number makes it easy to find products and powers\nof complex numbers.",
    "The proof of the following proposition is straightforward and is left\nas an exercise.\n",
    "Proposition 4.20 Let z = r cis θ and w = s cis ϕ be two nonzero complex numbers.",
    "Then\nzw = rs cis(θ + ϕ).\n",
    "Example 4.21",
    "If z = 3 cis(π/3) and w = 2 cis(π/6), then zw = 6 cis(π/2) = 6i.\n",
    "□\nTheorem 4.22 DeMoivre.",
    "Let z = r cis θ be a nonzero complex number.",
    "Then\n[r cis θ]n = rn cis(nθ)\nfor n = 1, 2, . .",
    "..\n",
    "Proof.",
    "We will use induction on n. For n = 1 the theorem is trivial.",
    "Assume that the\ntheorem is true for all k such that 1 ≤k ≤n.",
    "Then\nzn+1 = znz\n= rn(cos nθ",
    "+ i sin nθ)r(cos θ",
    "+ i sin θ)\n=",
    "rn+1[(cos nθ cos θ −sin nθ sin θ)",
    "+ i(sin nθ cos θ + cos nθ sin θ)]\n= rn+1[cos(nθ + θ)",
    "+ i sin(nθ + θ)]\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n52\n= rn+1[cos(n + 1)θ",
    "+ i sin(n",
    "+ 1)θ].\n",
    "■\nExample 4.23 Suppose that z = 1+i and we wish to compute z10.",
    "Rather than computing\n(1 + i)10 directly, it is much easier to switch to polar coordinates and calculate z10 using\nDeMoivre’s Theorem:\nz10 = (1 + i)10\n=\n\u0010√\n2 cis\n\u0010π\n4\n\u0011\u001110\n= (\n√\n2 )10 cis\n\u00125π\n2\n\u0013\n= 32 cis\n\u0010π\n2\n\u0011\n= 32i.\n□\nThe Circle Group and the Roots of Unity\nThe multiplicative group of the complex numbers, C∗, possesses some interesting subgroups.\n",
    "Whereas Q∗and R∗have no interesting subgroups of finite order, C∗has many.",
    "We first\nconsider the circle group,\nT = {z ∈C : |z| = 1}.\n",
    "The following proposition is a direct result of Proposition 4.20.\n",
    "Proposition 4.24",
    "The circle group is a subgroup of C∗.\nAlthough the circle group has infinite order, it has many interesting finite subgroups.\n",
    "Suppose that H = {1, −1, i, −i}.",
    "Then H is a subgroup of the circle group.",
    "Also, 1, −1, i,\nand −i are exactly those complex numbers that satisfy the equation z4 = 1.",
    "The complex\nnumbers satisfying the equation",
    "zn",
    "= 1 are called the nth roots of unity.\n",
    "Theorem 4.25",
    "If zn = 1, then the nth roots of unity are\nz = cis\n\u00122kπ\nn\n\u0013\n,\nwhere k = 0, 1, . .",
    ". , n −1.",
    "Furthermore, the nth roots of unity form a cyclic subgroup of T\nof order n\nProof.",
    "By DeMoivre’s Theorem,\nzn = cis\n\u0012\nn2kπ\nn\n\u0013\n= cis(2kπ) = 1.\n",
    "The z’s are distinct since the numbers 2kπ/n are all distinct and are greater than or equal\nto 0",
    "but less than 2π.",
    "The fact that these are all of the roots of the equation",
    "zn",
    "= 1 follows\nfrom from Corollary 17.9, which states that a polynomial of degree n can have at most n\nroots.",
    "We will leave the proof that the nth roots of unity form a cyclic subgroup of T as an\nexercise.\n",
    "■\nA generator for the group of the nth roots of unity is called a primitive nth root of\nunity.\n\n",
    "CHAPTER 4.",
    "CYCLIC GROUPS\n53\nExample 4.26",
    "The 8th roots of unity can be represented as eight equally spaced points on\nthe unit circle (Figure 4.27).",
    "The primitive 8th roots of unity are\nω =\n√\n2\n2 +\n√\n2\n2 i\nω3 = −\n√\n2\n2 +\n√\n2\n2 i\nω5 = −\n√\n2\n2 −\n√\n2\n2 i\nω7 =\n√\n2\n2 −\n√\n2\n2 i.\ny\nx\n0\n1\nω\ni\nω3\n−1\nω5\n−i\nω7\nFigure 4.27 8th roots of unity\n□\n4.3 The Method of Repeated Squares\nComputing large powers can be very time-consuming.",
    "Just as anyone can compute 22 or\n28, everyone knows how to compute\n221,000,000.\n",
    "However, such numbers are so large that we do not want to attempt the calculations;\nmoreover, past a certain point the computations would not be feasible even if we had\nevery computer in the world at our disposal.",
    "Even writing down the decimal representation\nof a very large number may not be reasonable.",
    "It could be thousands or even millions of\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n54\ndigits long.",
    "However, if we could compute something like\n237,398,332\n(mod 46,389),\nwe could very easily write the result down since it would be a number between 0 and 46,388.\n",
    "If we want to compute powers modulo n quickly and eﬀiciently, we will have to be clever.4\nThe first thing to notice is that any number a can be written as the sum of distinct\npowers of 2; that is, we can write\na = 2k1 + 2k2 + · · ·",
    "+ 2kn,\nwhere k1 < k2 < · · · < kn.",
    "This is just the binary representation of a. For example, the\nbinary representation of 57 is 111001, since we can write 57 = 20 + 23 + 24 + 25.\n",
    "The laws of exponents still work in Zn; that is, if b ≡ax (mod n) and c ≡ay (mod n),\nthen bc ≡ax+y (mod n).",
    "We can compute a2k (mod n) in k multiplications by computing\na20\n(mod n)\na21\n(mod n)\n...\na2k\n(mod n).\n",
    "Each step involves squaring the answer obtained in the previous step, dividing by n, and\ntaking the remainder.\n",
    "Example 4.28 We will compute 271321 (mod 481).",
    "Notice that\n321 = 20 + 26 + 28;\nhence, computing 271321 (mod 481) is the same as computing\n27120+26+28 ≡27120 · 27126 · 27128\n(mod 481).\n",
    "So it will suﬀice to compute 2712i (mod 481) where i = 0, 6, 8.",
    "It is very easy to see that\n27121 = 73,441 ≡329\n(mod 481).\n",
    "We can square this result to obtain a value for 27122 (mod 481):\n27122 ≡(27121)2\n(mod 481)\n≡(329)2\n(mod 481)\n≡108,241\n(mod 481)\n≡16\n(mod 481).\n",
    "We are using the fact that (a2n)2 ≡a2·2n ≡a2n+1 (mod n).",
    "Continuing, we can calculate\n27126 ≡419\n(mod 481)\nand\n27128 ≡16\n(mod 481).\n",
    "Therefore,\n271321 ≡27120+26+28\n(mod 481)\n4The results in this section are needed only in Chapter 7\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n55\n≡27120 · 27126 · 27128\n(mod 481)\n≡271 · 419 · 16\n(mod 481)\n≡1,816,784\n(mod 481)\n≡47\n(mod 481).\n",
    "□\nThe method of repeated squares will prove to be a very useful tool when we explore rsa\ncryptography in Chapter 7.",
    "To encode and decode messages in a reasonable manner under\nthis scheme, it is necessary to be able to quickly compute large powers of integers mod n.\nSage.\n",
    "Sage support for cyclic groups is a little spotty — but we can still make effective\nuse of Sage and perhaps this situation could change soon.\n",
    "4.4 Reading Questions\n1.\n",
    "What is the order of the element 3 in U(20)?\n2.\n",
    "What is the order of the element 5 in U(23)?\n",
    "3.\nFind three generators of Z8.\n",
    "4.\nFind three generators of the 5th roots of unity.\n",
    "5.\nShow how to compute 1540 (mod 23) eﬀiciently by hand.\n",
    "Check your answer with\nSage.\n",
    "4.5 Exercises\n1.\nProve or disprove each of the following statements.\n",
    "(a) All of the generators of Z60 are prime.\n",
    "(b) U(8) is cyclic.\n",
    "(c) Q is cyclic.\n",
    "(d)",
    "If every proper subgroup of a group G is cyclic, then G is a cyclic group.\n",
    "(e) A group with a finite number of subgroups is finite.\n",
    "2.\nFind the order of each of the following elements.\n",
    "(a) 5 ∈Z12\n(b)\n√\n3 ∈R\n(c)\n√\n3 ∈R∗\n(d) −i ∈C∗\n(e) 72 ∈Z240\n(f) 312 ∈Z471\n3.\n",
    "List all of the elements in each of the following subgroups.\n",
    "(a) The subgroup of Z generated by 7\n(b) The subgroup of Z24 generated by 15\n(c)",
    "All subgroups of Z12\n(d) All subgroups of Z60\n(e) All subgroups of Z13\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n56\n(f)",
    "All subgroups of Z48\n(g) The subgroup generated by 3 in U(20)\n(h)",
    "The subgroup generated by 5 in U(18)\n(i) The subgroup of R∗generated by 7\n(j) The subgroup of C∗generated by i where i2 = −1\n(k)",
    "The subgroup of C∗generated by 2i\n(l) The subgroup of C∗generated by (1 + i)/\n√\n2\n(m)",
    "The subgroup of C∗generated by (1 +\n√\n3 i)/2\n4.\nFind the subgroups of GL2(R) generated by each of the following matrices.\n",
    "(a)\n\u0012 0\n1\n−1\n0\n\u0013\n(b)\n\u00120\n1/3\n3\n0\n\u0013\n(c)\n\u00121\n−1\n1\n0\n\u0013\n(d)\n\u00121\n−1\n0\n1\n\u0013\n(e)\n\u0012 1\n−1\n−1\n0\n\u0013\n(f)\n\u0012√\n3/2\n1/2\n−1/2\n√\n3/2\n\u0013\n5.\nFind the order of every element in Z18.\n",
    "6.\nFind the order of every element in the symmetry group of the square, D4.\n",
    "7.\n",
    "What are all of the cyclic subgroups of the quaternion group, Q8?\n8.\nList all of the cyclic subgroups of U(30).\n",
    "9.\nList every generator of each subgroup of order 8 in Z32.\n",
    "10.",
    "Find all elements of finite order in each of the following groups.",
    "Here the “∗” indicates\nthe set with zero removed.\n",
    "(a) Z\n(b) Q∗\n(c) R∗\n11.",
    "If a24 = e in a group G, what are the possible orders of a?\n12.",
    "Find a cyclic group with exactly one generator.",
    "Can you find cyclic groups with exactly\ntwo generators?",
    "Four generators?",
    "How about n generators?\n13.",
    "For n ≤20, which groups U(n) are cyclic?",
    "Make a conjecture as to what is true in\ngeneral.",
    "Can you prove your conjecture?\n14.",
    "Let\nA =\n\u0012 0\n1\n−1\n0\n\u0013\nand\nB =\n\u00120\n−1\n1\n−1\n\u0013\nbe elements in GL2(R).",
    "Show that A and B have finite orders but AB does not.\n15.",
    "Evaluate each of the following.\n",
    "(a) (3 −2i) + (5i −6)\n(b) (4 −5i) −(4i −4)\n(c) (5 −4i)(7 + 2i)\n(d) (9 −i)(9 −i)\n(e) i45\n(f) (1 + i)",
    "+ (1 + i)\n",
    "16.",
    "Convert the following complex numbers to the form a + bi.\n(a) 2 cis(π/6)\n(b) 5 cis(9π/4)\n(c) 3 cis(π)\n(d) cis(7π/4)/2\n\nCHAPTER 4.",
    "CYCLIC GROUPS\n57\n17.",
    "Change the following complex numbers to polar representation.\n",
    "(a) 1 −i\n(b) −5\n(c) 2 + 2i\n(d)\n√\n3 + i\n(e) −3i\n(f) 2i + 2\n√\n3\n18.",
    "Calculate each of the following expressions.\n",
    "(a) (1 + i)−1\n(b) (1 −i)6\n(c) (\n√\n3 + i)5\n(d) (−i)10\n(e) ((1 −i)/2)4\n(f) (−\n√\n2 −\n√\n2 i)12\n(g) (−2 + 2i)−5\n19.",
    "Prove each of the following statements.\n",
    "(a) |z| = |z|\n(b) zz = |z|2\n(c) z−1",
    "= z/|z|2\n(d) |z + w| ≤|z| + |w|\n(e) |z −w| ≥||z| −|w||\n(f) |zw| =",
    "|z||w|\n20.",
    "List and graph the 6th roots of unity.",
    "What are the generators of this group?",
    "What\nare the primitive 6th roots of unity?\n21.",
    "List and graph the 5th roots of unity.",
    "What are the generators of this group?",
    "What\nare the primitive 5th roots of unity?\n22.",
    "Calculate each of the following.\n",
    "(a) 2923171 (mod 582)\n(b) 2557341 (mod 5681)\n(c) 20719521 (mod 4724)\n(d) 971321 (mod 765)\n23.",
    "Let a, b ∈G. Prove the following statements.\n",
    "(a) The order of a is the same as the order of a−1.\n(b) For all g ∈G, |a| = |g−1ag|.\n",
    "(c)",
    "The order of ab is the same as the order of ba.\n24.",
    "Let p and q be distinct primes.",
    "How many generators does Zpq have?\n25.",
    "Let p be prime and r be a positive integer.",
    "How many generators does Zpr have?\n26.",
    "Prove that Zp has no nontrivial subgroups if p is prime.\n",
    "27.",
    "If g and h have orders 15 and 16 respectively in a group G, what is the order of ⟨g⟩∩⟨h⟩?\n28.",
    "Let a be an element in a group G.",
    "What is a generator for the subgroup ⟨am⟩∩⟨an⟩?\n29.",
    "Prove that Zn has an even number of generators for n > 2.\n30.",
    "Suppose that G is a group and let a, b ∈G. Prove that if |a| = m and |b| = n with\ngcd(m, n) = 1, then ⟨a⟩∩⟨b⟩= {e}.\n31.",
    "Let G be an abelian group.",
    "Show that the elements of finite order in G form a subgroup.\n",
    "This subgroup is called the torsion subgroup of G.\n32.",
    "Let G be a finite cyclic group of order n generated by x. Show that if y = xk where\ngcd(k, n) = 1, then y must be a generator of G.\n33.",
    "If G is an abelian group that contains a pair of cyclic subgroups of order 2, show that\nG must contain a subgroup of order 4.",
    "Does this subgroup have to be cyclic?\n34.",
    "Let G be an abelian group of order pq where gcd(p, q) = 1.",
    "If G contains elements a\nand b of order p and q respectively, then show that G is cyclic.\n35.",
    "Prove that the subgroups of Z are exactly nZ for n = 0, 1, 2, . .",
    "..\n\n",
    "CHAPTER 4.",
    "CYCLIC GROUPS\n58\n36.",
    "Prove that the generators of Zn are the integers r such that 1 ≤r < n and gcd(r, n) = 1.\n37.",
    "Prove that if G has no proper nontrivial subgroups, then G is a cyclic group.\n",
    "38.",
    "Prove that the order of an element in a cyclic group G must divide the order of the\ngroup.\n39.",
    "Prove that if G is a cyclic group of order m and d | m, then G must have a subgroup\nof order d.\n40.",
    "For what integers n is −1 an nth root of unity?\n41.",
    "If z = r(cos θ + i sin θ) and w = s(cos ϕ",
    "+ i sin ϕ) are two nonzero complex numbers,\nshow that\nzw = rs[cos(θ + ϕ)",
    "+ i sin(θ + ϕ)].\n",
    "42.",
    "Prove that the circle group is a subgroup of C∗.\n43.",
    "Prove that the nth roots of unity form a cyclic subgroup of T of order n.\n44.",
    "Let α ∈T. Prove that αm = 1 and αn = 1 if and only if αd = 1 for d = gcd(m, n).\n",
    "45.",
    "Let z ∈C∗.",
    "If |z| ̸= 1, prove that the order of z is infinite.\n46.",
    "Let z = cos θ",
    "+ i sin θ be in T where θ ∈Q. Prove that the order of z is infinite.\n",
    "4.6 Programming Exercises\n1.\nWrite a computer program that will write any decimal number as the sum of distinct\npowers of 2.",
    "What is the largest integer that your program will handle?\n2.\nWrite a computer program to calculate ax (mod n) by the method of repeated squares.\n",
    "What are the largest values of n and x that your program will accept?\n4.7 References and Suggested Readings\n[1]\nKoblitz, N. A Course in Number Theory and Cryptography.",
    "2nd ed.",
    "Springer, New\nYork, 1994.\n",
    "[2]\nPomerance, C. “Cryptology and Computational Number Theory—An Introduction,”\nin Cryptology and Computational Number Theory, Pomerance, C., ed.",
    "Proceedings of\nSymposia in Applied Mathematics, vol.",
    "42, American Mathematical Society, Provi-\ndence, RI, 1990.",
    "This book gives an excellent account of how the method of repeated\nsquares is used in cryptography.\n\n",
    "5\nPermutation Groups\nPermutation groups are central to the study of geometric symmetries and to Galois the-\nory, the study of finding solutions of polynomial equations.",
    "They also provide abundant\nexamples of nonabelian groups.\n",
    "Let us recall for a moment the symmetries of the equilateral triangle △ABC from\nChapter 3.",
    "The symmetries actually consist of permutations of the three vertices, where a\npermutation of the set S = {A, B, C} is a one-to-one and onto map π : S →S. The three\nvertices have the following six permutations.\n",
    "\u0012A\nB\nC\nA\nB\nC\n\u0013\n\u0012A\nB\nC\nC\nA\nB\n\u0013\n\u0012A\nB\nC\nB\nC\nA\n\u0013\n\u0012A\nB\nC\nA\nC\nB\n\u0013\n\u0012A\nB\nC\nC\nB\nA\n\u0013\n\u0012A\nB\nC\nB\nA\nC\n\u0013\n",
    "We have used the array\n\u0012A\nB\nC\nB\nC\nA\n\u0013\nto denote the permutation that sends A to B, B to C, and C to A. That is,\nA 7→B\nB 7→C\nC 7→A.\n",
    "The symmetries of a triangle form a group.",
    "In this chapter we will study groups of this\ntype.\n",
    "5.1 Definitions and Notation\nIn general, the permutations of a set X form a group SX.",
    "If X is a finite set, we can assume\nX = {1, 2, . .",
    ". , n}.",
    "In this case we write Sn instead of SX.",
    "The following theorem says that\nSn is a group.",
    "We call this group the symmetric group on n letters.\n",
    "Theorem 5.1 The symmetric group on n letters, Sn, is a group with n! elements, where\nthe binary operation is the composition of maps.\nProof.",
    "The identity of Sn is just the identity map that sends 1 to 1, 2 to 2, . .",
    "., n to n. If\nf :",
    "Sn →Sn is a permutation, then f−1 exists, since f is one-to-one and onto; hence, every\npermutation has an inverse.",
    "Composition of maps is associative, which makes the group\n59\n\nCHAPTER 5.",
    "PERMUTATION GROUPS\n60\noperation associative.",
    "We leave the proof that |Sn| = n!",
    "as an exercise.\n",
    "■\nA subgroup of Sn is called a permutation group.\n",
    "Example 5.2 Consider the subgroup G of S5 consisting of the identity permutation id and\nthe permutations\nσ",
    "=\n\u00121\n2\n3\n4\n5\n1\n2\n3\n5\n4\n\u0013\nτ =\n\u00121\n2\n3\n4\n5\n3\n2\n1\n4\n5\n\u0013\nµ =\n\u00121\n2\n3\n4\n5\n3\n2\n1\n5\n4\n\u0013\n.\n",
    "The following table tells us how to multiply elements in the permutation group G.\n◦\nid\nσ\nτ\nµ\nid\nid\nσ\nτ\nµ\nσ\nσ\nid\nµ\nτ\nτ\nτ\nµ\nid\nσ\nµ\nµ\nτ\nσ\nid\n□\nRemark 5.3 Though it is natural to multiply elements in a group from left to right,\nfunctions are composed from right to left.",
    "Let σ and τ be permutations on a set X. To\ncompose σ and τ as functions, we calculate (σ◦τ)(x)",
    "= σ(τ(x)).",
    "That is, we do τ",
    "first, then\nσ.",
    "There are several ways to approach this inconsistency.",
    "We will adopt the convention of\nmultiplying permutations right to left.",
    "To compute στ, do τ first and then σ.",
    "That is, by\nστ(x) we mean σ(τ(x)).",
    "(Another way of solving this problem would be to write functions\non the right; that is, instead of writing σ(x), we could write (x)σ.",
    "We could also multiply\npermutations left to right to agree with the usual way of multiplying elements in a group.\n",
    "Certainly all of these methods have been used.\n",
    "Example 5.4 Permutation multiplication is not usually commutative.",
    "Let\nσ =\n\u00121\n2\n3\n4\n4\n1\n2\n3\n\u0013\nτ",
    "=\n\u00121\n2\n3\n4\n2\n1\n4\n3\n\u0013\n.\n",
    "Then\nστ =\n\u00121\n2\n3\n4\n1\n4\n3\n2\n\u0013\n,\nbut\nτσ =\n\u00121\n2\n3\n4\n3\n2\n1\n4\n\u0013\n.\n",
    "□\nCycle Notation\nThe notation that we have used to represent permutations up to this point is cumbersome,\nto say the least.",
    "To work effectively with permutation groups, we need a more streamlined\n\nCHAPTER 5.",
    "PERMUTATION GROUPS\n61\nmethod of writing down and manipulating permutations.\n",
    "A permutation σ ∈SX is a cycle of length k if there exist elements a1, a2, . . .",
    ", ak ∈X\nsuch that\nσ(a1) = a2\nσ(a2) = a3\n...\nσ(ak) = a1\nand σ(x) = x for all other elements x",
    "∈X. We will write (a1, a2, . . .",
    ", ak) to denote the\ncycle σ.",
    "Cycles are the building blocks of all permutations.\n",
    "Example 5.5",
    "The permutation\nσ =\n\u00121\n2\n3\n4\n5\n6\n7\n6\n3\n5\n1\n4\n2\n7\n\u0013\n= (1 6 2 3 5 4)\nis a cycle of length 6, whereas\nτ =\n\u00121\n2\n3\n4\n5\n6\n1\n4\n2\n3\n5\n6\n\u0013\n= (2 4 3)\nis a cycle of length 3.\n",
    "Not every permutation is a cycle.",
    "Consider the permutation\n\u00121\n2\n3\n4\n5\n6\n2\n4\n1\n3\n6\n5\n\u0013\n= (1 2 4 3)(5 6).\n",
    "This permutation actually contains a cycle of length 2 and a cycle of length 4.\n□\nExample 5.6",
    "It is very easy to compute products of cycles.",
    "Suppose that\nσ = (1 3 5 2)\nand\nτ = (2 5 6).\n",
    "If we think of σ as\n1 7→3,\n3 7→5,\n5 7→2,\n2 7→1,\nand τ as\n2 7→5,\n5 7→6,\n6 7→2,\nthen for στ remembering that we apply τ first and then σ, it must be the case that\n1 7→3,\n3 7→5,\n5 7→6,\n6 7→2 7→1,\nor στ = (1 3 5 6).",
    "If µ = (1 6 3 4), then σµ = (1 6 5 2)(3 4).\n",
    "□\nTwo cycles in SX, σ = (a1, a2, . . .",
    ", ak) and τ = (b1, b2, . .",
    ".",
    ", bl), are disjoint if ai ̸= bj for\nall i and j.\n",
    "Example 5.7",
    "The cycles (1 3 5) and (2 7) are disjoint; however, the cycles (1 3 5) and (3 4 7)\nare not.",
    "Calculating their products, we find that\n(1 3 5)(2 7) = (1 3 5)(2 7)\n(1 3 5)(3 4 7) = (1 3 4 7 5).\n",
    "The product of two cycles that are not disjoint may reduce to something less complicated;\nthe product of disjoint cycles cannot be simplified.\n",
    "□\n\nCHAPTER 5.",
    "PERMUTATION GROUPS\n62\nProposition 5.8 Let σ and τ be two disjoint cycles in SX.",
    "Then στ = τσ.\nProof.",
    "Let σ = (a1, a2, . . .",
    ", ak) and τ = (b1, b2, . .",
    ".",
    ", bl).",
    "We must show that στ(x) = τσ(x)\nfor all x ∈X. If x is neither in {a1, a2, . . .",
    ", ak} nor {b1, b2, . .",
    ".",
    ", bl}, then both σ and τ fix x.\n",
    "That is, σ(x) = x and τ(x)",
    "= x.",
    "Hence,\nστ(x) = σ(τ(x))",
    "= σ(x) = x = τ(x)",
    "= τ(σ(x))",
    "= τσ(x).\n",
    "Do not forget that we are multiplying permutations right to left, which is the opposite of the\norder in which we usually multiply group elements.",
    "Now suppose that x ∈{a1, a2, . . .",
    ", ak}.\n",
    "Then σ(ai)",
    "= a(i mod k)+1; that is,\na1 7→a2\na2 7→a3\n...\nak−1 7→ak\nak 7→a1.\n",
    "However, τ(ai) = ai since σ and τ are disjoint.",
    "Therefore,\nστ(ai) = σ(τ(ai))\n= σ(ai)\n= a(i mod k)+1\n= τ(a(i mod k)+1)\n= τ(σ(ai))\n= τσ(ai).\n",
    "Similarly, if x ∈{b1, b2, . .",
    ".",
    ", bl}, then σ and τ also commute.\n",
    "■\nTheorem 5.9 Every permutation in Sn can be written as the product of disjoint cycles.\nProof.\n",
    "We can assume that X = {1, 2, . . .",
    ", n}.\n",
    "If σ ∈Sn and we define X1 to be\n{σ(1), σ2(1), . . .",
    "}, then the set X1 is finite since X is finite.",
    "Now let i be the first integer in\nX that is not in X1 and define X2 by {σ(i), σ2(i), . . .}.",
    "Again, X2 is a finite set.",
    "Continuing\nin this manner, we can define finite disjoint sets X3, X4, . . ..",
    "Since X is a finite set, we are\nguaranteed that this process will end and there will be only a finite number of these sets,\nsay r. If σi is the cycle defined by\nσi(x) =\n(\nσ(x)\nx ∈Xi\nx\nx /∈Xi\n,\nthen σ = σ1σ2 · · · σr.",
    "Since the sets X1, X2, . .",
    ".",
    ", Xr are disjoint, the cycles σ1, σ2, . . .",
    ", σr\nmust also be disjoint.\n",
    "■\nExample 5.10 Let\nσ =\n\u00121\n2\n3\n4\n5\n6\n6\n4\n3\n1\n5\n2\n\u0013\nτ =\n\u00121\n2\n3\n4\n5\n6\n3\n2\n1\n5\n6\n4\n\u0013\n.\n\n",
    "CHAPTER 5.",
    "PERMUTATION GROUPS\n63\nUsing cycle notation, we can write\nσ = (1 6 2 4)\nτ",
    "= (1 3)(4 5 6)\nστ = (1 3 6)(2 4 5)\nτσ = (1 4 3)(2 5 6).\n",
    "□\nRemark 5.11 From this point forward we will find it convenient to use cycle notation to rep-\nresent permutations.",
    "When using cycle notation, we often denote the identity permutation\nby (1).\n",
    "Transpositions\nThe simplest permutation is a cycle of length 2.",
    "Such cycles are called transpositions.",
    "Since\n(a1, a2, . . .",
    ", an) = (a1, an)(a1, an−1) · · · (a1, a3)(a1, a2),\nany cycle can be written as the product of transpositions, leading to the following proposi-\ntion.\n",
    "Proposition 5.12 Any permutation of a finite set containing at least two elements can be\nwritten as the product of transpositions.\n",
    "Example 5.13 Consider the permutation\n(1 6)(2 5 3) = (1 6)(2 3)(2 5) = (1 6)(4 5)(2 3)(4 5)(2 5).\n",
    "As we can see, there is no unique way to represent permutation as the product of transposi-\ntions.",
    "For instance, we can write the identity permutation as (1 2)(1 2), as (1 3)(2 4)(1 3)(2 4),\nand in many other ways.",
    "However, as it turns out, no permutation can be written as the\nproduct of both an even number of transpositions and an odd number of transpositions.\n",
    "For instance, we could represent the permutation (1 6) by\n(2 3)(1 6)(2 3)\nor by\n(3 5)(1 6)(1 3)(1 6)(1 3)(3 5)(5 6),\nbut (1 6) will always be the product of an odd number of transpositions.\n",
    "□\nLemma 5.14 If the identity is written as the product of r transpositions,\nid = τ1τ2 · · · τr,\nthen r is an even number.\n",
    "Proof.\n",
    "We will employ induction on r. A transposition cannot be the identity; hence,\nr > 1.",
    "If r = 2, then we are done.",
    "Suppose that r > 2.",
    "In this case the product of the last\ntwo transpositions, τr−1τr, must be one of the following cases:\n(a, b)(a, b) = id\n(b, c)(a, b) = (a, c)(b, c)\n(c, d)(a, b) = (a, b)(c, d)\n(a, c)(a, b) = (a, b)(b, c),\nwhere a, b, c, and d are distinct.\n\n",
    "CHAPTER 5.",
    "PERMUTATION GROUPS\n64\n",
    "The first equation simply says that a transposition is its own inverse.",
    "If this case occurs,\ndelete τr−1τr from the product to obtain\nid = τ1τ2 · · · τr−3τr−2.\n",
    "By induction r −2 is even; hence, r must be even.\n",
    "In each of the other three cases, we can replace τr−1τr with the right-hand side of the\ncorresponding equation to obtain a new product of r transpositions for the identity.",
    "In this\nnew product the last occurrence of a will be in the next-to-the-last transposition.",
    "We can\ncontinue this process with τr−2τr−1 to obtain either a product of r −2 transpositions or a\nnew product of r transpositions where the last occurrence of a is in τr−2.",
    "If the identity is\nthe product of r −2 transpositions, then again we are done, by our induction hypothesis;\notherwise, we will repeat the procedure with τr−3τr−2.\n",
    "At some point either we will have two adjacent, identical transpositions canceling each\nother out or a will be shuffled so that it will appear only in the first transposition.",
    "However,\nthe latter case cannot occur, because the identity would not fix a in this instance.",
    "Therefore,\nthe identity permutation must be the product of r −2 transpositions and, again by our\ninduction hypothesis, we are done.\n",
    "■\nTheorem 5.15 If a permutation σ can be expressed as the product of an even number of\ntranspositions, then any other product of transpositions equaling σ must also contain an even\nnumber of transpositions.",
    "Similarly, if σ can be expressed as the product of an odd number\nof transpositions, then any other product of transpositions equaling σ must also contain an\nodd number of transpositions.\nProof.",
    "Suppose that\nσ = σ1σ2 · ·",
    "· σm = τ1τ2 · · · τn,\nwhere m is even.",
    "We must show that n is also an even number.",
    "The inverse of σ is σm · · · σ1.\n",
    "Since\nid = σσm · · · σ1 = τ1 · · · τnσm · · · σ1,\nn must be even by Lemma 5.14.",
    "The proof for the case in which σ can be expressed as an\nodd number of transpositions is left as an exercise.\n",
    "■\nIn light of Theorem 5.15, we define a permutation to be even if it can be expressed\nas an even number of transpositions and odd if it can be expressed as an odd number of\ntranspositions.\n",
    "The Alternating Groups\nOne of the most important subgroups of Sn is the set of all even permutations, An.",
    "The\ngroup An is called the alternating group on n letters.\n",
    "Theorem 5.16",
    "The set An is a subgroup of Sn.\nProof.",
    "Since the product of two even permutations must also be an even permutation,\nAn is closed.",
    "The identity is an even permutation and therefore is in An.",
    "If σ is an even\npermutation, then\nσ = σ1σ2 · · · σr,\nwhere σi is a transposition and r is even.",
    "Since the inverse of any transposition is itself,\nσ−1 = σrσr−1 · · · σ1\nis also in An.\n■\n\nCHAPTER 5.",
    "PERMUTATION GROUPS\n65\nProposition 5.17",
    "The number of even permutations in Sn, n ≥2, is equal to the number\nof odd permutations; hence, the order of An is n!/2.\nProof.",
    "Let An be the set of even permutations in Sn and Bn be the set of odd permutations.\n",
    "If we can show that there is a bijection between these sets, they must contain the same\nnumber of elements.",
    "Fix a transposition σ in Sn.",
    "Since n ≥2, such a σ exists.",
    "Define\nλσ : An →Bn\nby\nλσ(τ) = στ.\nSuppose that λσ(τ) = λσ(µ).",
    "Then στ = σµ",
    "and so\nτ = σ−1στ = σ−1σµ = µ.\n",
    "Therefore, λσ is one-to-one.",
    "We will leave the proof that λσ is surjective to the reader.\n",
    "■\nExample 5.18",
    "The group A4 is the subgroup of S4 consisting of even permutations.",
    "There\nare twelve elements in A4:\n(1)\n(1 2)(3 4)\n(1 3)(2 4)\n(1 4)(2 3)\n(1 2 3)\n(1 3 2)\n(1 2 4)\n(1 4 2)\n(1 3 4)\n(1 4 3)\n(2 3 4)\n(2 4 3).\n",
    "One of the end-of-chapter exercises will be to write down all the subgroups of A4.",
    "You will\nfind that there is no subgroup of order 6.",
    "Does this surprise you?\n□\nHistorical Note\nLagrange first thought of permutations as functions from a set to itself, but it was Cauchy\nwho developed the basic theorems and notation for permutations.\n",
    "He was the first to\nuse cycle notation.",
    "Augustin-Louis Cauchy (1789–1857) was born in Paris at the height\nof the French Revolution.",
    "His family soon left Paris for the village of Arcueil to escape\nthe Reign of Terror.",
    "One of the family’s neighbors there was Pierre-Simon Laplace (1749–\n1827), who encouraged him to seek a career in mathematics.",
    "Cauchy began his career as\na mathematician by solving a problem in geometry given to him by Lagrange.\n",
    "Cauchy\nwrote over 800 papers on such diverse topics as differential equations, finite groups, applied\nmathematics, and complex analysis.\n",
    "He was one of the mathematicians responsible for\nmaking calculus rigorous.",
    "Perhaps more theorems and concepts in mathematics have the\nname Cauchy attached to them than that of any other mathematician.\n",
    "5.2 Dihedral Groups\nAnother special type of permutation group is the dihedral group.",
    "Recall the symmetry\ngroup of an equilateral triangle in Chapter 3.",
    "Such groups consist of the rigid motions of a\nregular n-sided polygon or n-gon.",
    "For n = 3, 4, . .",
    "., we define the nth dihedral group to be\nthe group of rigid motions of a regular n-gon.",
    "We will denote this group by Dn.",
    "We can\nnumber the vertices of a regular n-gon by 1, 2, . .",
    ". , n (Figure 5.19).",
    "Notice that there are\nexactly n choices to replace the first vertex.",
    "If we replace the first vertex by k, then the\nsecond vertex must be replaced either by vertex k+1 or by vertex k−1; hence, there are 2n\npossible rigid motions of the n-gon.",
    "We summarize these results in the following theorem.\n\n",
    "CHAPTER 5.",
    "PERMUTATION GROUPS\n66\n1\n2\n3\n4\n5\nn −1\nn\nFigure 5.19 A regular n-gon\nTheorem 5.20",
    "The dihedral group, Dn, is a subgroup of Sn of order 2n.\n",
    "Theorem 5.21",
    "The group Dn, n ≥3, consists of all products of the two elements r and s,\nwhere r has order n and s has order 2, and these two elements satisfy the relation srs = r−1.\nProof.",
    "The possible motions of a regular n-gon are either reflections or rotations (Fig-\nure 5.22).",
    "There are exactly n possible rotations:\nid, 360◦\nn , 2 · 360◦\nn , . . .",
    ", (n −1) · 360◦\nn .\n",
    "We will denote the rotation 360◦/n by r.",
    "The rotation r generates all of the other rotations.\n",
    "That is,\nrk = k · 360◦\nn .\n\n",
    "CHAPTER 5.",
    "PERMUTATION GROUPS\n67\n1\n2\n3\n4\n5\n6\n7\n8\n1\n2\n3\n4\n5\n6\n7\n8\nrotation\n1\n2\n3\n4\n5\n6\n7\n8\n1\n2\n3\n4\n5\n6\n7\n8\nreflection\nFigure 5.22 Rotations and reflections of a regular n-gon\nLabel the n reflections s1, s2, . .",
    ".",
    ", sn, where sk is the reflection that leaves vertex k fixed.\n",
    "There are two cases of reflections, depending on whether n is even or odd.",
    "If there are an\neven number of vertices, then two vertices are left fixed by a reflection, and s1 = sn/2+1, s2 =\nsn/2+2, . . .",
    ", sn/2 = sn.",
    "If there are an odd number of vertices, then only a single vertex is left\nfixed by a reflection and s1, s2, . .",
    ".",
    ", sn are distinct (Figure 5.23).",
    "In either case, the order of\neach sk is two.",
    "Let s = s1.",
    "Then s2 = 1 and rn = 1.",
    "Since any rigid motion t of the n-gon\nreplaces the first vertex by the vertex k, the second vertex must be replaced by either k + 1\nor by k −1.",
    "If the second vertex is replaced by k + 1, then t = rk.",
    "If the second vertex is\nreplaced by k −1, then t = rks.5 Hence, r and s generate Dn.",
    "That is, Dn consists of all\nfinite products of r and s,\nDn = {1, r, r2, . .",
    ". , rn−1, s, rs, r2s, . .",
    ".",
    ", rn−1s}.\n",
    "We will leave the proof that srs = r−1 as an exercise.\n\n",
    "CHAPTER 5.",
    "PERMUTATION GROUPS\n68\n1\n2\n3\n4\n5\n6\n1\n6\n5\n4\n3\n2\n1\n2\n3\n4\n5\n1\n6\n4\n3\n2\nFigure 5.23 Types of reflections of a regular n-gon\n■\nExample 5.24",
    "The group of rigid motions of a square, D4, consists of eight elements.",
    "With\nthe vertices numbered 1, 2, 3, 4 (Figure 5.25), the rotations are\nr = (1 2 3 4)\nr2 = (1 3)(2 4)\nr3 = (1 4 3 2)\nr4 = (1)\nand the reflections are\ns1 = (2 4)\ns2 = (1 3).\n",
    "The order of D4 is 8.",
    "The remaining two elements are\nrs1 = (1 2)(3 4)\nr3s1",
    "= (1 4)(2 3).\n",
    "5Since we are in an abstract group, we will adopt the convention that group elements are multiplied left\nto right.\n\n",
    "CHAPTER 5.",
    "PERMUTATION GROUPS\n69\n1\n2\n3\n4\nFigure 5.25",
    "The group D4\n□\nThe Motion Group of a Cube\nWe can investigate the groups of rigid motions of geometric objects other than a regular\nn-sided polygon to obtain interesting examples of permutation groups.",
    "Let us consider the\ngroup of rigid motions of a cube.",
    "By rigid motion, we mean a rotation with the axis of\nrotation about opposing faces, edges, or vertices.",
    "One of the first questions that we can ask\nabout this group is “what is its order?”",
    "A cube has 6 sides.",
    "If a particular side is facing\nupward, then there are four possible rotations of the cube that will preserve the upward-\nfacing side.",
    "Hence, the order of the group is 6 · 4 = 24.",
    "We have just proved the following\nproposition.\n",
    "Proposition 5.26 The group of rigid motions of a cube contains 24 elements.\n",
    "Theorem 5.27 The group of rigid motions of a cube is S4.\n",
    "Proof.",
    "From Proposition 5.26, we already know that the motion group of the cube has 24\nelements, the same number of elements as there are in S4.",
    "There are exactly four diagonals\nin the cube.",
    "If we label these diagonals 1, 2, 3, and 4, we must show that the motion group\nof the cube will give us any permutation of the diagonals (Figure 5.28).",
    "If we can obtain\nall of these permutations, then S4 and the group of rigid motions of the cube must be the\nsame.",
    "To obtain a transposition we can rotate the cube 180◦about the axis joining the\nmidpoints of opposite edges (Figure 5.29).",
    "There are six such axes, giving all transpositions\nin S4.",
    "Since every element in S4 is the product of a finite number of transpositions, the\nmotion group of a cube must be S4.\n\n",
    "CHAPTER 5.",
    "PERMUTATION GROUPS\n70\n1\n2\n3\n4\n1\n2\n3\n4\nFigure 5.28",
    "The motion group of a cube\n1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\nFigure 5.29 Transpositions in the motion group of a cube\n■\nSage.\n",
    "A permutation group is a very concrete representation of a group, and Sage support\nfor permutations groups is very good — making Sage a natural place for beginners to learn\nabout group theory.\n",
    "5.3 Reading Questions\n1.\nExpress (1 3 4)(3 5 4) as a cycle, or a product of disjoint cycles.",
    "(Interpret the compo-\nsition of functions in the order used by Sage, which is the reverse of the order used in\nthe book.)\n",
    "2.\n",
    "What is a transposition?\n3.\n",
    "What does it mean for a permutation to be even or odd?\n4.\nDescribe another group that is fundamentally the same as A3.\n\n",
    "CHAPTER 5.",
    "PERMUTATION GROUPS\n71\n5.\nWrite the elements of the symmetry group of a pentagon using permutations in cycle\nnotation.",
    "Do this exercise by hand, and without the assistance of Sage.\n",
    "5.4 Exercises\n1.\nWrite the following permutations in cycle notation.\n",
    "(a)\n\u00121\n2\n3\n4\n5\n2\n4\n1\n5\n3\n\u0013\n(b)\n\u00121\n2\n3\n4\n5\n4\n2\n5\n1\n3\n\u0013\n(c)\n\u00121\n2\n3\n4\n5\n3\n5\n1\n4\n2\n\u0013\n(d)\n\u00121\n2\n3\n4\n5\n1\n4\n3\n2\n5\n\u0013\n2.\n",
    "Compute each of the following.\n",
    "(a) (1 3 4 5)(2 3 4)\n(b) (1 2)(1 2 5 3)\n(c) (1 4 3)(2 3)(2 4)\n(d) (1 4 2 3)(3 4)(5 6)(1 3 2 4)\n(e) (1 2 5 4)(1 3)(2 5)\n(f) (1 2 5 4)(1 3)(2 5)2\n(g) (1 2 5 4)−1(1 2 3)(4 5)(1 2 5 4)\n(h) (1 2 5 4)2(1 2 3)(4 5)\n(i) (1 2 3)(4 5)(1 2 5 4)−2\n(j) (1 2 5 4)100\n(k) |(1 2 5 4)|\n(l) |(1 2 5 4)2|\n(m) (1 2)−1\n(n) (1 2 5 3 7)−1\n(o)",
    "[(1 2)(3 4)(1 2)(4 7)]−1\n(p)",
    "[(1 2 3 5)(4 6 7)]−1\n3.\nExpress the following permutations as products of transpositions and identify them as\neven or odd.\n",
    "(a) (1 4 3 5 6)\n(b) (1 5 6)(2 3 4)\n(c) (1 4 2 6)(1 4 2)\n(d) (1 7 2 5 4)(1 4 2 3)(1 5 4 6 3 2)\n(e) (1 4 2 6 3 7)\n4.\nFind (a1, a2, . . .",
    ", an)−1.\n5.\n",
    "List all of the subgroups of S4.",
    "Find each of the following sets:\n(a) {σ ∈S4 : σ(1) = 3}\n(b) {σ ∈S4 : σ(2)",
    "= 2}\n(c) {σ ∈S4 : σ(1)",
    "= 3 and σ(2) = 2}.\n",
    "Are any of these sets subgroups of S4?\n6.\nFind all of the subgroups in A4.",
    "What is the order of each subgroup?\n7.\nFind all possible orders of elements in S7 and A7.\n",
    "8.\nShow that A10 contains an element of order 15.\n9.\n",
    "Does A8 contain an element of order 26?\n10.",
    "Find an element of largest order in Sn for n = 3, . . .",
    ", 10.\n11.",
    "What are the possible cycle structures of elements of A5?",
    "What about A6?\n\nCHAPTER 5.",
    "PERMUTATION GROUPS\n72\n12.",
    "Let σ ∈Sn have order n. Show that for all integers i and j, σi = σj if and only if i ≡j\n(mod n).\n",
    "13.",
    "Let σ = σ1 · · ·",
    "σm ∈Sn be the product of disjoint cycles.",
    "Prove that the order of σ is\nthe least common multiple of the lengths of the cycles σ1, . . .",
    ", σm.\n14.",
    "Using cycle notation, list the elements in D5.",
    "What are r and s?",
    "Write every element\nas a product of r and s.\n15.",
    "If the diagonals of a cube are labeled as Figure 5.28, to which motion of the cube\ndoes the permutation (12)(34) correspond?",
    "What about the other permutations of the\ndiagonals?\n16.",
    "Find the group of rigid motions of a tetrahedron.",
    "Show that this is the same group as\nA4.\n17.",
    "Prove that Sn is nonabelian for n ≥3.\n18.",
    "Show that An is nonabelian for n ≥4.\n19.",
    "Prove that Dn is nonabelian for n ≥3.\n20.",
    "Let σ ∈Sn be a cycle.",
    "Prove that σ can be written as the product of at most n −1\ntranspositions.\n",
    "21.",
    "Let σ ∈Sn.",
    "If σ is not a cycle, prove that σ can be written as the product of at most\nn −2 transpositions.\n",
    "22.",
    "If σ can be expressed as an odd number of transpositions, show that any other product\nof transpositions equaling σ must also be odd.\n23.",
    "If σ is a cycle of odd length, prove that σ2 is also a cycle.\n",
    "24.",
    "Show that a 3-cycle is an even permutation.\n",
    "25. Prove that in An with n ≥3, any permutation is a product of cycles of length 3.\n26.",
    "Prove that any element in Sn can be written as a finite product of the following\npermutations.\n",
    "(a) (1 2), (1 3), . . .",
    ", (1 n)\n(b) (1 2), (2 3), . . .",
    ", (n −1, n)\n(c) (1 2), (1 2 . . .",
    "n)\n27.",
    "Let G be a group and define a map λg : G →G by λg(a)",
    "= ga.",
    "Prove that λg is a\npermutation of G.\n28.",
    "Prove that there exist n! permutations of a set containing n elements.\n",
    "29.",
    "Recall that the center of a group G is\nZ(G)",
    "= {g ∈G :",
    "gx = xg for all x ∈G}.\n",
    "Find the center of D8.",
    "What about the center of D10?",
    "What is the center of Dn?\n30.",
    "Let τ = (a1, a2, . . .",
    ", ak) be a cycle of length k.\n(a) Prove that if σ is any permutation, then\nστσ−1 = (σ(a1), σ(a2), . . .",
    ", σ(ak))\nis a cycle of length k.\n(b) Let µ be a cycle of length k. Prove that there is a permutation σ such that\nστσ−1 = µ.\n\nCHAPTER 5.",
    "PERMUTATION GROUPS\n73\n31.",
    "For α and β in Sn, define α ∼β if there exists an σ ∈Sn such that σασ−1 = β.",
    "Show\nthat ∼is an equivalence relation on Sn.\n32.",
    "Let σ ∈SX.",
    "If σn(x) = y for some n ∈Z, we will say that x ∼y.\n",
    "(a) Show that ∼is an equivalence relation on X.\n(b) Define the orbit of x ∈X under σ ∈SX to be the set\nOx,σ = {y : x ∼y}.\n",
    "Compute the orbits of each element in {1, 2, 3, 4, 5} under each of the following\nelements in S5:\nα = (1 2 5 4)\nβ",
    "= (1 2 3)(4 5)\n",
    "γ = (1 3)(2 5).\n",
    "(c) If Ox,σ ∩Oy,σ ̸= ∅, prove that Ox,σ = Oy,σ.",
    "The orbits under a permutation σ\nare the equivalence classes corresponding to the equivalence relation ∼.\n(d) A subgroup H of SX is transitive if for every x, y ∈X, there exists a σ ∈H\nsuch that σ(x) = y. Prove that ⟨σ⟩is transitive if and only if Ox,σ = X for some\nx ∈X.\n33.",
    "Let α ∈Sn for n ≥3.",
    "If αβ = βα for all β ∈Sn, prove that α must be the identity\npermutation; hence, the center of Sn is the trivial subgroup.\n",
    "34.",
    "If α is even, prove that α−1 is also even.",
    "Does a corresponding result hold if α is odd?\n35.",
    "If σ ∈An and τ ∈Sn, show that τ −1στ ∈An.\n36.",
    "Show that α−1β−1αβ is even for α, β ∈Sn.\n",
    "37.",
    "Let r and s be the elements in Dn described in Theorem 5.21\n(a) Show that srs = r−1.\n(b) Show that rks = sr−k in Dn.\n(c) Prove that the order of rk ∈Dn is n/ gcd(k, n).\n\n",
    "6\nCosets and Lagrange’s Theorem\nLagrange’s Theorem, one of the most important results in finite group theory, states that the\norder of a subgroup must divide the order of the group.",
    "This theorem provides a powerful\ntool for analyzing finite groups; it gives us an idea of exactly what type of subgroups we\nmight expect a finite group to possess.",
    "Central to understanding Lagranges’s Theorem is\nthe notion of a coset.\n",
    "6.1 Cosets\nLet G be a group and H a subgroup of G. Define a left coset of H with representative\ng ∈G to be the set\ngH",
    "= {gh : h ∈H}.\n",
    "Right cosets can be defined similarly by\nHg = {hg : h ∈H}.\n",
    "If left and right cosets coincide or if it is clear from the context to which type of coset that\nwe are referring, we will use the word coset without specifying left or right.\n",
    "Example 6.1 Let H be the subgroup of Z6 consisting of the elements 0 and 3.",
    "The cosets\nare\n0",
    "+ H = 3 + H = {0, 3}\n1",
    "+ H = 4 + H = {1, 4}\n2 +",
    "H = 5 + H = {2, 5}.\n",
    "We will always write the cosets of subgroups of Z and Zn with the additive notation we have\nused for cosets here.",
    "In a commutative group, left and right cosets are always identical.\n",
    "□\nExample 6.2 Let H be the subgroup of S3 defined by the permutations {(1), (1 2 3), (1 3 2)}.\n",
    "The left cosets of H are\n(1)H = (1 2 3)H = (1 3 2)H = {(1), (1 2 3), (1 3 2)}\n(1 2)H = (1 3)H = (2 3)H = {(1 2), (1 3), (2 3)}.\n",
    "The right cosets of H are exactly the same as the left cosets:\nH(1) = H(1 2 3) = H(1 3 2) = {(1), (1 2 3), (1 3 2)}\nH(1 2) = H(1 3) = H(2 3) = {(1 2), (1 3), (2 3)}.\n",
    "74\n\nCHAPTER 6. COSETS AND LAGRANGE’S THEOREM\n75\n",
    "It is not always the case that a left coset is the same as a right coset.",
    "Let K be the\nsubgroup of S3 defined by the permutations {(1), (1 2)}.",
    "Then the left cosets of K are\n(1)K = (1 2)K = {(1), (1 2)}\n(1 3)K = (1 2 3)K = {(1 3), (1 2 3)}\n(2 3)K = (1 3 2)K = {(2 3), (1 3 2)};\nhowever, the right cosets of K are\nK(1) = K(1 2) = {(1), (1 2)}\nK(1 3) = K(1 3 2) = {(1 3), (1 3 2)}\nK(2 3) = K(1 2 3) = {(2 3), (1 2 3)}.\n",
    "□\nThe following lemma is quite useful when dealing with cosets.",
    "(We leave its proof as an\nexercise.)\n",
    "Lemma 6.3 Let H be a subgroup of a group G and suppose that g1, g2 ∈G.",
    "The following\nconditions are equivalent.\n",
    "1. g1H",
    "= g2H;\n2.",
    "Hg−1\n1\n= Hg−1\n2 ;\n3. g1H ⊂g2H;\n4. g2 ∈g1H;\n5.",
    "g−1\n1 g2 ∈H.\nIn all of our examples the cosets of a subgroup H partition",
    "the larger group G. The\nfollowing theorem proclaims that this will always be the case.\n",
    "Theorem 6.4 Let H be a subgroup of a group",
    "G. Then the left cosets of H in G partition\nG.",
    "That is, the group G is the disjoint union of the left cosets of H in G.\nProof.",
    "Let g1H and g2H be two cosets of H in G. We must show that either g1H∩g2H = ∅\nor g1H = g2H. Suppose that g1H ∩g2H ̸= ∅and a ∈g1H ∩g2H. Then by the definition\nof a left coset, a = g1h1 = g2h2 for some elements h1 and h2 in H. Hence, g1 = g2h2h−1\n1\nor\ng1 ∈g2H. By Lemma 6.3, g1H = g2H.\n■\nRemark 6.5 There is nothing special in this theorem about left cosets.",
    "Right cosets also\npartition G; the proof of this fact is exactly the same as the proof for left cosets except that\nall group multiplications are done on the opposite side of H.\nLet G be a group and H be a subgroup of G. Define the index\nof H in G to be the\nnumber of left cosets of H in G. We will denote the index by [G : H].\n",
    "Example 6.6 Let G = Z6 and H = {0, 3}.",
    "Then [G : H] = 3.\n□\nExample 6.7 Suppose that G = S3, H = {(1), (1 2 3), (1 3 2)}, and K = {(1), (1 2)}.",
    "Then\n[G : H] = 2 and",
    "[G : K] = 3.\n□\nTheorem 6.8 Let H be a subgroup of a group G.",
    "The number of left cosets of H in G is\nthe same as the number of right cosets of H in G.\nProof.",
    "Let LH and RH denote the set of left and right cosets of H in G, respectively.\n",
    "If\nwe can define a bijective map ϕ : LH →RH, then the theorem will be proved.",
    "If gH ∈LH,\nlet ϕ(gH)",
    "= Hg−1.",
    "By Lemma 6.3, the map ϕ is well-defined; that is, if g1H = g2H, then\n\nCHAPTER 6.",
    "COSETS AND LAGRANGE’S THEOREM\n76\nHg−1\n1\n= Hg−1\n2 .",
    "To show that ϕ is one-to-one, suppose that\nHg−1\n1\n= ϕ(g1H) = ϕ(g2H) = Hg−1\n2 .\n",
    "Again by Lemma 6.3, g1H = g2H.",
    "The map ϕ is onto since ϕ(g−1H)",
    "= Hg.\n",
    "■\n6.2 Lagrange’s Theorem\nProposition 6.9 Let H be a subgroup of G with g ∈G and define a map ϕ :",
    "H →gH by\nϕ(h)",
    "= gh.",
    "The map ϕ is bijective; hence, the number of elements in H is the same as the\nnumber of elements in gH.\nProof.\n",
    "We first show that the map ϕ is one-to-one.",
    "Suppose that ϕ(h1) = ϕ(h2) for\nelements h1, h2 ∈H.",
    "We must show that h1 = h2, but ϕ(h1) = gh1 and ϕ(h2)",
    "= gh2.",
    "So\ngh1 = gh2, and by left cancellation h1 = h2.",
    "To show that ϕ is onto is easy.",
    "By definition\nevery element of gH is of the form gh for some h ∈H and ϕ(h)",
    "= gh.\n",
    "■\nTheorem 6.10\nLagrange.",
    "Let G be a finite group and let H be a subgroup of G. Then\n|G|/|H| =",
    "[G : H] is the number of distinct left cosets of H in G. In particular, the number\nof elements in H must divide the number of elements in G.\nProof.",
    "The group G is partitioned into [G : H] distinct left cosets.",
    "Each left coset has\n|H| elements; therefore, |G| =",
    "[G : H]|H|.\n",
    "■\nCorollary 6.11 Suppose that G is a finite group and g ∈G. Then the order of g must\ndivide the number of elements in G.\nCorollary 6.12 Let |G| = p with p a prime number.",
    "Then G is cyclic and any g ∈G such\nthat g ̸= e is a generator.\n",
    "Proof.",
    "Let g be in G such that g ̸= e.",
    "Then by Corollary 6.11, the order of g must divide\nthe order of the group.",
    "Since |⟨g⟩| > 1, it must be p.",
    "Hence, g generates G.\n■\nCorollary 6.12 suggests that groups of prime order p must somehow look like Zp.\n",
    "Corollary 6.13 Let H and K be subgroups of a finite group G such that G ⊃H ⊃K.\nThen\n",
    "[G : K] =",
    "[G : H][H : K].\nProof.",
    "Observe that\n[G : K] = |G|\n|K| = |G|\n|H| · |H|\n|K| =",
    "[G : H][H : K].\n",
    "■\nRemark 6.14",
    "The converse of Lagrange’s Theorem is false.",
    "The group A4 has order\n12; however, it can be shown that it does not possess a subgroup of order 6.",
    "According to\nLagrange’s Theorem, subgroups of a group of order 12 can have orders of either 1, 2, 3, 4, or\n6.",
    "However, we are not guaranteed that subgroups of every possible order exist.",
    "To prove\nthat A4 has no subgroup of order 6, we will assume that it does have such a subgroup H\nand show that a contradiction must occur.",
    "Since A4 contains eight 3-cycles, we know that\nH must contain a 3-cycle.",
    "We will show that if H contains one 3-cycle, then it must contain\nmore than 6 elements.\n",
    "Proposition 6.15",
    "The group A4 has no subgroup of order 6.\nProof.",
    "Since [A4 : H] = 2, there are only two cosets of H in A4.",
    "Inasmuch as one of the\ncosets is H itself, right and left cosets must coincide; therefore, gH",
    "= Hg or gHg−1 = H\nfor every g ∈A4.",
    "Since there are eight 3-cycles in A4, at least one 3-cycle must be in H.\nWithout loss of generality, assume that (1 2 3) is in H. Then (1 2 3)−1 = (1 3 2) must also\n\nCHAPTER 6.",
    "COSETS AND LAGRANGE’S THEOREM\n77\nbe in H. Since ghg−1 ∈H for all g ∈A4",
    "and all h ∈H and\n(1 2 4)(1 2 3)(1 2 4)−1 = (1 2 4)(1 2 3)(1 4 2) = (2 4 3)\n(2 4 3)(1 2 3)(2 4 3)−1 = (2 4 3)(1 2 3)(2 3 4) = (1 4 2)\nwe can conclude that H must have at least seven elements\n(1), (1 2 3), (1 3 2), (2 4 3), (2 4 3)−1 = (2 3 4), (1 4 2), (1 4 2)−1 = (1 2 4).\n",
    "Therefore, A4 has no subgroup of order 6.\n■\nIn fact, we can say more about when two cycles have the same length.\n",
    "Theorem 6.16 Two cycles τ and µ in Sn have the same length if and only if there exists\na σ ∈Sn such that µ = στσ−1.\nProof.",
    "Suppose that\nτ = (a1, a2, . . .",
    ", ak)\nµ = (b1, b2, . . .",
    ", bk).\n",
    "Define σ to be the permutation\nσ(a1) = b1\nσ(a2)",
    "= b2\n...\nσ(ak) = bk.\n",
    "Then µ = στσ−1.\n",
    "Conversely, suppose that τ",
    "= (a1, a2, . . .",
    ", ak) is a k-cycle and σ ∈Sn.",
    "If σ(ai) = b and\nσ(a(i mod k)+1) = b′, then µ(b) = b′.",
    "Hence,\nµ = (σ(a1), σ(a2), . . .",
    ", σ(ak)).\n",
    "Since σ is one-to-one and onto, µ is a cycle of the same length as τ.\n■\n6.3 Fermat’s and",
    "Euler’s Theorems\nThe Euler ϕ-function is the map ϕ : N",
    "→N defined by ϕ(n) = 1 for n = 1, and, for n > 1,\nϕ(n) is the number of positive integers m with 1 ≤m < n and gcd(m, n) = 1.\nFrom Proposition 3.4, we know that the order of U(n), the group of units in Zn, is ϕ(n).\n",
    "For example, |U(12)| = ϕ(12)",
    "= 4 since the numbers that are relatively prime to 12 are 1, 5,\n7, and 11.",
    "For any prime p, ϕ(p) = p −1.",
    "We state these results in the following theorem.\n",
    "Theorem 6.17 Let U(n) be the group of units in Zn.",
    "Then |U(n)| = ϕ(n).\n",
    "The following theorem is an important result in number theory, due to Leonhard Euler.\n",
    "Theorem 6.18 Euler’s Theorem.",
    "Let a and n be integers such that n > 0",
    "and gcd(a, n) =\n1.",
    "Then aϕ(n) ≡1 (mod n).\n",
    "Proof.\n",
    "By Theorem 6.17 the order of U(n) is ϕ(n).\n",
    "Consequently, aϕ(n) = 1 for all\na ∈U(n); or aϕ(n) −1 is divisible by n. Therefore, aϕ(n) ≡1 (mod n).\n",
    "■\nIf we consider the special case of Euler’s Theorem in which n = p is prime and recall\nthat ϕ(p) = p −1, we obtain the following result, due to Pierre de Fermat.\n\n",
    "CHAPTER 6. COSETS AND LAGRANGE’S THEOREM\n78\nTheorem 6.19 Fermat’s Little Theorem.",
    "Let p be any prime number and suppose that\np ∤a (p does not divide a).",
    "Then\nap−1 ≡1\n(mod p).\n",
    "Furthermore, for any integer b, bp ≡b (mod p).\n",
    "Sage.\n",
    "Sage can create all the subgroups of a group, so long as the group is not too large.\n",
    "It can also create the cosets of a subgroup.\n",
    "Historical Note\nJoseph-Louis Lagrange (1736–1813), born in Turin, Italy, was of French and Italian descent.\n",
    "His talent for mathematics became apparent at an early age.",
    "Leonhard Euler recognized\nLagrange’s abilities when Lagrange, who was only 19, communicated to Euler some work\nthat he had done in the calculus of variations.",
    "That year he was also named a professor at\nthe Royal Artillery School in Turin.",
    "At the age of 23 he joined the Berlin Academy.",
    "Frederick\nthe Great had written to Lagrange proclaiming that the “greatest king in Europe” should\nhave the “greatest mathematician in Europe” at his court.",
    "For 20 years Lagrange held the\nposition vacated by his mentor, Euler.",
    "His works include contributions to number theory,\ngroup theory, physics and mechanics, the calculus of variations, the theory of equations, and\ndifferential equations.",
    "Along with Laplace and Lavoisier, Lagrange was one of the people\nresponsible for designing the metric system.",
    "During his life Lagrange profoundly influenced\nthe development of mathematics, leaving much to the next generation of mathematicians\nin the form of examples and new problems to be solved.\n",
    "6.4 Reading Questions\n1.\nState Lagrange’s Theorem in your own words.\n",
    "2.\nDetermine the left cosets of ⟨3⟩in Z9.\n",
    "3.\n",
    "The set {(), (1 2)(3 4), (1 3)(2 4), (1 4)(2 3)} is a subgroup of S4.",
    "What is its index in\nS4?\n",
    "4.\nSuppose G is a group of order 29.",
    "Describe G.\n5.\n",
    "The number p = 137909 is prime.",
    "Explain how to compute 57137909 (mod 137909)\nwithout a calculator.\n",
    "6.5 Exercises\n1.\nSuppose that G is a finite group with an element g of order 5 and an element h of order\n7.",
    "Why must |G| ≥35?\n2.\nSuppose that G is a finite group with 60 elements.",
    "What are the orders of possible\nsubgroups of G?\n3.\nProve or disprove: Every subgroup of the integers has finite index.\n",
    "4.\nProve or disprove: Every subgroup of the integers has finite order.\n\n",
    "CHAPTER 6. COSETS AND LAGRANGE’S THEOREM\n79\n5.\n",
    "List the left and right cosets of the subgroups in each of the following.\n",
    "(a) ⟨8⟩in Z24\n(b) ⟨3⟩in U(8)\n(c) 3Z in Z\n(d) A4 in S4\n(e)",
    "An in Sn\n(f) D4 in S4\n(g) T in C∗\n(h) H = {(1), (1 2 3), (1 3 2)} in S4\n6.\nDescribe the left cosets of SL2(R) in GL2(R).",
    "What is the index of SL2(R) in GL2(R)?\n",
    "7.\nVerify Euler’s Theorem for n = 15 and a = 4.\n8.\n",
    "Use Fermat’s Little Theorem to show that if p = 4n + 3 is prime, there is no solution\nto the equation x2 ≡−1 (mod p).\n",
    "9.\nShow that the integers have infinite index in the additive group of rational numbers.\n10.",
    "Show that the additive group of real numbers has infinite index in the additive group\nof the complex numbers.\n11.",
    "Let H be a subgroup of a group G and suppose that g1, g2 ∈G.\nProve that the\nfollowing conditions are equivalent.\n",
    "(a) g1H",
    "= g2H\n(b) Hg−1\n1\n= Hg−1\n2\n(c) g1H ⊂g2H\n(d) g2 ∈g1H\n(e) g−1\n1 g2 ∈H\n12.",
    "If ghg−1 ∈H for all g ∈G and h ∈H, show that right cosets are identical to left\ncosets.",
    "That is, show that gH",
    "= Hg for all g ∈G.\n13.",
    "What fails in the proof of Theorem 6.8 if ϕ : LH →RH is defined by ϕ(gH)",
    "= Hg?\n14.",
    "Suppose that gn = e. Show that the order of g divides n.\n15.",
    "The cycle structure of a permutation σ is defined as the unordered list of the sizes of the\ncycles in the cycle decomposition σ.",
    "For example, the permutation σ = (1 2)(3 4 5)(7 8)(9)\nhas cycle structure (2, 3, 2, 1) which can also be written as (1, 2, 2, 3).\n",
    "Show that any two permutations α, β ∈Sn have the same cycle structure",
    "if and\nonly if there exists a permutation",
    "γ such that β =",
    "γαγ−1.",
    "If β = γαγ−1 for some\nγ ∈Sn, then α and β are conjugate.\n",
    "16.",
    "If |G| = 2n, prove that the number of elements of order 2 is odd.",
    "Use this result to\nshow that G must contain a subgroup of order 2.\n17.",
    "Suppose that [G : H] = 2.",
    "If a and b are not in H, show that ab ∈H.\n18.",
    "If [G : H] = 2, prove that gH",
    "= Hg.\n19.",
    "Let H and K be subgroups of a group G. Prove that gH",
    "∩gK is a coset of H ∩K in\nG.\n20.",
    "Let H and K be subgroups of a group G.\nDefine a relation ∼on G by a ∼b if\nthere exists an h ∈H and a k ∈K such that hak = b. Show that this relation is an\nequivalence relation.",
    "The corresponding equivalence classes are called double cosets.\n",
    "Compute the double cosets of H = {(1), (1 2 3), (1 3 2)} in A4.\n",
    "21.",
    "Let G be a cyclic group of order n. Show that there are exactly ϕ(n) generators for G.\n\nCHAPTER 6. COSETS AND LAGRANGE’S THEOREM\n80\n22.",
    "Let n = pe1\n1 pe2\n2 · · · pek\nk , where p1, p2, . .",
    ".",
    ", pk are distinct primes.",
    "Prove that\nϕ(n) = n\n\u0012\n1 −1\np1\n\u0013 \u0012\n1 −1\np2\n\u0013\n· · ·\n\u0012\n1 −1\npk\n\u0013\n.\n23.",
    "Show that\nn =\nX\nd|n\nϕ(d)\nfor all positive integers n.\n\n7\nIntroduction to Cryptography\nCryptography is the study of sending and receiving secret messages.",
    "The aim of cryptogra-\nphy is to send messages across a channel so that only the intended recipient of the message\ncan read it.",
    "In addition, when a message is received, the recipient usually requires some\nassurance that the message is authentic; that is, that it has not been sent by someone who\nis trying to deceive the recipient.",
    "Modern cryptography is heavily dependent on abstract\nalgebra and number theory.\n",
    "The message to be sent is called the plaintext message.",
    "The disguised message is called\nthe ciphertext.",
    "The plaintext and the ciphertext are both written in an alphabet, consisting\nof letters or characters.",
    "Characters can include not only the familiar alphabetic characters\nA, . .",
    "., Z and a, . .",
    ".,",
    "z but also digits, punctuation marks, and blanks.",
    "A cryptosystem,\nor cipher, has two parts: encryption, the process of transforming a plaintext message to\na ciphertext message, and decryption, the reverse transformation of changing a ciphertext\nmessage into a plaintext message.\n",
    "There are many different families of cryptosystems, each distinguished by a particular\nencryption algorithm.",
    "Cryptosystems in a specified cryptographic family are distinguished\nfrom one another by a parameter to the encryption function called a key.\n",
    "A classical\ncryptosystem has a single key, which must be kept secret, known only to the sender and\nthe receiver of the message.",
    "If person A wishes to send secret messages to two different\npeople B and C, and does not wish to have B understand C’s messages or vice versa, A\nmust use two separate keys, so one cryptosystem is used for exchanging messages with B,\nand another is used for exchanging messages with C.\nSystems that use two separate keys, one for encoding and another for decoding, are\ncalled public key cryptosystems.\n",
    "Since knowledge of the encoding key does not allow\nanyone to guess at the decoding key, the encoding key can be made public.",
    "A public key\ncryptosystem allows A and B to send messages to C using the same encoding key.",
    "Anyone\nis capable of encoding a message to be sent to C, but only C knows how to decode such a\nmessage.\n",
    "7.1 Private Key Cryptography\nIn single or private key cryptosystems the same key is used for both encrypting and de-\ncrypting messages.",
    "To encrypt a plaintext message, we apply to the message some function\nwhich is kept secret, say f.",
    "This function will yield an encrypted message.",
    "Given the en-\ncrypted form of the message, we can recover the original message by applying the inverse\ntransformation f−1.",
    "The transformation f must be relatively easy to compute, as must f−1;\nhowever, f must be extremely diﬀicult to guess from available examples of coded messages.\n",
    "81\n\nCHAPTER 7. INTRODUCTION TO CRYPTOGRAPHY\n82\nExample 7.1 One of the first and most famous private key cryptosystems was the shift code\nused by Julius Caesar.",
    "We first digitize the alphabet by letting A = 00, B = 01, . . .",
    ", Z = 25.\n",
    "The encoding function will be\nf(p)",
    "= p + 3 mod 26;\nthat is, A 7→D, B 7→E, . . .",
    ", Z 7→C.",
    "The decoding function is then\nf−1(p) = p −3",
    "mod 26 = p + 23 mod 26.\n",
    "Suppose we receive the encoded message DOJHEUD.",
    "To decode this message, we first\ndigitize it:\n3, 14, 9, 7, 4, 20, 3.\n",
    "Next we apply the inverse transformation to get\n0, 11, 6, 4, 1, 17, 0,\nor ALGEBRA.",
    "Notice here that there is nothing special about either of the numbers 3 or\n26.",
    "We could have used a larger alphabet or a different shift.\n",
    "□\nCryptanalysis is concerned with deciphering a received or intercepted message.",
    "Methods\nfrom probability and statistics are great aids in deciphering an intercepted message; for\nexample, the frequency analysis of the characters appearing in the intercepted message\noften makes its decryption possible.\n",
    "Example 7.2 Suppose we receive a message that we know was encrypted by using a shift\ntransformation on single letters of the 26-letter alphabet.",
    "To find out exactly what the shift\ntransformation was, we must compute b in the equation f(p)",
    "= p + b mod 26.",
    "We can do\nthis using frequency analysis.",
    "The letter E = 04 is the most commonly occurring letter\nin the English language.",
    "Suppose that S",
    "= 18 is the most commonly occurring letter in\nthe ciphertext.",
    "Then we have good reason to suspect that 18 = 4 + b mod 26, or b = 14.\n",
    "Therefore, the most likely encrypting function is\nf(p)",
    "= p + 14 mod 26.\n",
    "The corresponding decrypting function is\nf−1(p) = p + 12 mod 26.\n",
    "It is now easy to determine whether or not our guess is correct.\n",
    "□\nSimple shift codes are examples of monoalphabetic cryptosystems.",
    "In these ciphers a\ncharacter in the enciphered message represents exactly one character in the original message.\n",
    "Such cryptosystems are not very sophisticated and are quite easy to break.",
    "In fact, in a\nsimple shift as described in Example 7.1, there are only 26 possible keys.",
    "It would be quite\neasy to try them all rather than to use frequency analysis.\n",
    "Let us investigate a slightly more sophisticated cryptosystem.",
    "Suppose that the encoding\nfunction is given by\nf(p)",
    "= ap",
    "+",
    "b mod 26.\n",
    "We first need to find out when a decoding function f−1 exists.",
    "Such a decoding function\nexists when we can solve the equation\nc = ap",
    "+",
    "b mod 26\nfor p.",
    "By Proposition 3.4, this is possible exactly when a has an inverse or, equivalently,\n\nCHAPTER 7.",
    "INTRODUCTION TO CRYPTOGRAPHY\n83\nwhen gcd(a, 26) = 1.",
    "In this case\nf−1(p) = a−1p −a−1b mod 26.\n",
    "Such a cryptosystem is called an aﬀine cryptosystem.\n",
    "Example 7.3 Let us consider the aﬀine cryptosystem f(p)",
    "= ap",
    "+",
    "b mod 26.\n",
    "For this\ncryptosystem to work we must choose an a ∈Z26 that is invertible.",
    "This is only possible if\ngcd(a, 26) = 1.",
    "Recognizing this fact, we will let a = 5 since gcd(5, 26) = 1.",
    "It is easy to see\nthat a−1 = 21.",
    "Therefore, we can take our encryption function to be f(p)",
    "= 5p + 3 mod 26.\n",
    "Thus, ALGEBRA is encoded as 3, 6, 7, 23, 8, 10, 3, or DGHXIKD.",
    "The decryption function\nwill be\nf−1(p) = 21p −21 · 3 mod 26 = 21p + 15 mod 26.\n□\nA cryptosystem would be more secure if a ciphertext letter could represent more than\none plaintext letter.",
    "To give an example of this type of cryptosystem, called a polyalphabetic\ncryptosystem, we will generalize aﬀine codes by using matrices.",
    "The idea works roughly the\nsame as before; however, instead of encrypting one letter at a time we will encrypt pairs of\nletters.",
    "We can store a pair of letters p1 and p2 in a vector\np =\n\u0012p1\np2\n\u0013\n.\n",
    "Let A be a 2 × 2 invertible matrix with entries in Z26.",
    "We can define an encoding function\nby\nf(p)",
    "= Ap + b,\nwhere b is a fixed column vector and matrix operations are performed in Z26.",
    "The decoding\nfunction must be\nf−1(p)",
    "= A−1p −A−1b.\n",
    "Example 7.4 Suppose that we wish to encode the word HELP.",
    "The corresponding digit\nstring is 7, 4, 11, 15.",
    "If\nA =\n\u00123\n5\n1\n2\n\u0013\n,\nthen\nA−1 =\n\u0012 2\n21\n25\n3\n\u0013\n.\n",
    "If b = (2, 2)t, then our message is encrypted as RRGR.",
    "The encrypted letter R represents\nmore than one plaintext letter.\n",
    "□\nFrequency analysis can still be performed on a polyalphabetic cryptosystem, because we\nhave a good understanding of how pairs of letters appear in the English language.",
    "The pair\nth appears quite often; the pair qz never appears.",
    "To avoid decryption by a third party, we\nmust use a larger matrix than the one we used in Example 7.4.\n",
    "7.2 Public Key Cryptography\nIf traditional cryptosystems are used, anyone who knows enough to encode a message will\nalso know enough to decode an intercepted message.",
    "In 1976, W. Diﬀie and M. Hellman\nproposed public key cryptography, which is based on the observation that the encryption and\ndecryption procedures need not have the same key.",
    "This removes the requirement that the\n\nCHAPTER 7.",
    "INTRODUCTION TO CRYPTOGRAPHY\n84\nencoding key be kept secret.",
    "The encoding function f must be relatively easy to compute,\nbut f−1 must be extremely diﬀicult to compute without some additional information, so\nthat someone who knows only the encrypting key cannot find the decrypting key without\nprohibitive computation.",
    "It is interesting to note that to date, no system has been proposed\nthat has been proven to be “one-way;” that is, for any existing public key cryptosystem,\nit has never been shown to be computationally prohibitive to decode messages with only\nknowledge of the encoding key.\n",
    "The RSA Cryptosystem\nThe rsa cryptosystem introduced by R. Rivest, A. Shamir, and L. Adleman in 1978, is\nbased on the diﬀiculty of factoring large numbers.",
    "Though it is not a diﬀicult task to find\ntwo large random primes and multiply them together, factoring a 150-digit number that is\nthe product of two large primes would take 100 million computers operating at 10 million\ninstructions per second about 50 million years under the fastest algorithms available in the\nearly 1990s.",
    "Although the algorithms have improved, factoring a number that is a product\nof two large primes is still computationally prohibitive.\n",
    "The rsa cryptosystem works as follows.\n",
    "Suppose that we choose two random 150-\ndigit prime numbers p and q.",
    "Next, we compute the product n = pq and also compute\nϕ(n)",
    "= m = (p −1)(q −1), where ϕ is the Euler ϕ-function.",
    "Now we start choosing random\nintegers E until we find one that is relatively prime to m; that is, we choose E such that\ngcd(E, m) = 1.",
    "Using the Euclidean algorithm, we can find a number D such that DE ≡1\n(mod m).",
    "The numbers n and E are now made public.\n",
    "Suppose now that person B (Bob) wishes to send person A (Alice) a message over a\npublic line.\n",
    "Since E and n are known to everyone, anyone can encode messages.\n",
    "Bob\nfirst digitizes the message according to some scheme, say A = 00, B = 02, . .",
    ".",
    ", Z = 25.",
    "If\nnecessary, he will break the message into pieces such that each piece is a positive integer\nless than n. Suppose x is one of the pieces.",
    "Bob forms the number y = xE mod n and\nsends y to Alice.",
    "For Alice to recover x, she need only compute x",
    "= yD mod n. Only Alice\nknows D.\nExample 7.5 Before exploring the theory behind the rsa cryptosystem or attempting to\nuse large integers, we will use some small integers just to see that the system does indeed\nwork.",
    "Suppose that we wish to send some message, which when digitized is 25.",
    "Let p = 23\nand q = 29.",
    "Then\nn = pq = 667\nand\nϕ(n)",
    "= m = (p −1)(q −1)",
    "= 616.\n",
    "We can let E = 487, since gcd(616, 487) = 1.",
    "The encoded message is computed to be\n25487 mod 667 = 169.\n",
    "This computation can be reasonably done by using the method of repeated squares as\ndescribed in Chapter 4.",
    "Using the Euclidean algorithm, we determine that",
    "191E = 1+151m;\ntherefore, the decrypting key is (n, D) = (667, 191).",
    "We can recover the original message\nby calculating\n169191 mod 667 = 25.\n□\nNow let us examine why the rsa cryptosystem works.",
    "We know that DE ≡1 (mod m);\n\nCHAPTER 7.",
    "INTRODUCTION TO CRYPTOGRAPHY\n85\nhence, there exists a k such that\nDE = km + 1 = kϕ(n)",
    "+",
    "1.\nThere are two cases to consider.",
    "In the first case assume that gcd(x, n) = 1.",
    "Then by\nTheorem 6.18,\nyD = (xE)D = xDE",
    "= xkm+1 = (xϕ(n))kx = (1)kx = x mod n.\n",
    "So we see that Alice recovers the original message x when she computes yD mod n.\n",
    "For the other case, assume that gcd(x, n) ̸= 1.",
    "Since n = pq and x < n, we know x is\na multiple of p or a multiple of q, but not both.",
    "We will describe the first possibility only,\nsince the second is entirely similar.",
    "There is then an integer r, with r < q and x = rp.",
    "Note\nthat we have gcd(x, q) = 1 and that m = ϕ(n) = (p −1)(q −1)",
    "= ϕ(p)ϕ(q).",
    "Then, using\nTheorem 6.18, but now mod q,\nxkm = xkϕ(p)ϕ(q) = (xϕ(q))kϕ(p) = (1)kϕ(p) = 1 mod q.\n",
    "So there is an integer t such that xkm = 1",
    "+ tq.",
    "Thus, Alice also recovers the message in\nthis case,\nyD = xkm+1 = xkmx =",
    "(1 + tq)x = x + tq(rp) = x + trn = x mod n.\n",
    "We can now ask how one would go about breaking the rsa cryptosystem.",
    "To find D\ngiven n and E, we simply need to factor n and solve for D by using the Euclidean algorithm.\n",
    "If we had known that 667 = 23 · 29 in Example 7.5, we could have recovered D.\nMessage Verification\nThere is a problem of message verification in public key cryptosystems.",
    "Since the encoding\nkey is public knowledge, anyone has the ability to send an encoded message.\n",
    "If Alice\nreceives a message from Bob, she would like to be able to verify that it was Bob who\nactually sent the message.",
    "Suppose that Bob’s encrypting key is (n′, E′) and his decrypting\nkey is (n′, D′).",
    "Also, suppose that Alice’s encrypting key is (n, E) and her decrypting key is\n(n, D).",
    "Since encryption keys are public information, they can exchange coded messages at\ntheir convenience.",
    "Bob wishes to assure Alice that the message he is sending is authentic.\n",
    "Before Bob sends the message x to Alice, he decrypts x with his own key:\nx′ = xD′ mod n′.\nAnyone can change x′ back to x just by encryption, but only Bob has the ability to form\nx′.",
    "Now Bob encrypts x′ with Alice’s encryption key to form\ny′ = x′E mod n,\na message that only Alice can decode.",
    "Alice decodes the message and then encodes the\nresult with Bob’s key to read the original message, a message that could have only been\nsent by Bob.\nHistorical Note\nEncrypting secret messages goes as far back as ancient Greece and Rome.",
    "As we know,\nJulius Caesar used a simple shift code to send and receive messages.",
    "However, the formal\nstudy of encoding and decoding messages probably began with the Arabs in the 1400s.",
    "In\nthe fifteenth and sixteenth centuries mathematicians such as Alberti and Viete discovered\n\nCHAPTER 7.",
    "INTRODUCTION TO CRYPTOGRAPHY\n86\nthat monoalphabetic cryptosystems offered no real security.",
    "In the 1800s, F. W. Kasiski\nestablished methods for breaking ciphers in which a ciphertext letter can represent more\nthan one plaintext letter, if the same key was used several times.",
    "This discovery led to the\nuse of cryptosystems with keys that were used only a single time.",
    "Cryptography was placed\non firm mathematical foundations by such people as W. Friedman and L. Hill in the early\npart of the twentieth century.\n",
    "The period after World War I saw the development of special-purpose machines for encrypt-\ning and decrypting messages, and mathematicians were very active in cryptography during\nWorld War II.",
    "Efforts to penetrate the cryptosystems of the Axis nations were organized\nin England and in the United States by such notable mathematicians as Alan Turing and\nA. A. Albert.",
    "The Allies gained a tremendous advantage in World War II by breaking the\nciphers produced by the German Enigma machine and the Japanese Purple ciphers.\n",
    "By the 1970s, interest in commercial cryptography had begun to take hold.",
    "There was\na growing need to protect banking transactions, computer data, and electronic mail.",
    "In\nthe early 1970s, ibm developed and implemented luzifer, the forerunner of the National\nBureau of Standards’ Data Encryption Standard (DES).\n",
    "The concept of a public key cryptosystem, due to Diﬀie and Hellman, is very recent (1976).",
    "It\nwas further developed by Rivest, Shamir, and Adleman with the rsa cryptosystem (1978).\n",
    "It is not known how secure any of these systems are.",
    "The trapdoor knapsack cryptosys-\ntem, developed by Merkle and Hellman, has been broken.\n",
    "It is still an open question\nwhether or not the rsa system can be broken.",
    "In 1991, rsa Laboratories published a list\nof semiprimes (numbers with exactly two prime factors) with a cash prize for whoever was\nable to provide a factorization (http://www.emc.com/emc-plus/rsa-labs/historical/the-rsa-\nchallenge-numbers.htma).",
    "Although the challenge ended in 2007, many of these numbers\nhave not yet been factored.\n",
    "There been a great deal of controversy about research in cryptography and cryptography\nitself.",
    "In 1929, when Henry Stimson, Secretary of State under Herbert Hoover, dismissed the\nBlack Chamber (the State Department’s cryptography division) on the ethical grounds that\n“gentlemen do not read each other’s mail.”",
    "During the last two decades of the twentieth\ncentury, the National Security Agency wanted to keep information about cryptography\nsecret, whereas the academic community fought for the right to publish basic research.\n",
    "Currently, research in mathematical cryptography and computational number theory is\nvery active, and mathematicians are free to publish their results in these areas.\n",
    "awww.emc.com/emc-plus/rsa-labs/historical/the-rsa-challenge-numbers.htm\nSage.\n",
    "Sage’s early development featured powerful routines for number theory, and later\nincluded significant support for algebraic structures and other areas of discrete mathematics.\n",
    "So it is a natural tool for the study of cryptology, including topics like RSA, elliptic curve\ncryptography, and AES (Advanced Encryption Standard).\n",
    "7.3 Reading Questions\n1.\nUse the euler_phi()function in Sage to compute ϕ(893 456 123).\n",
    "2.\nUse the power_mod()function in Sage to compute 7324 (mod 895).\n",
    "3.\nExplain the mathematical basis for saying: encrypting a message using an rsa public\nkey is very simple computationally, while decrypting a communication without the\nprivate key is very hard computationally.\n",
    "4.\nExplain how in rsa message encoding differs from message verification.\n\n",
    "CHAPTER 7.",
    "INTRODUCTION TO CRYPTOGRAPHY\n87\n5.\nExplain how one could be justified in saying that Diﬀie and Hellman’s proposal in 1976\nwas “revolutionary.”\n7.4 Exercises\n1.\n",
    "Encode IXLOVEXMATH using the cryptosystem in Example 7.1.\n2.\nDecode ZLOOA WKLVA EHARQ WKHA ILQDO, which was encoded using the cryptosystem\nin Example 7.1.\n",
    "3.\nAssuming that monoalphabetic code was used to encode the following secret message,\nwhat was the original message?\nAPHUO EGEHP PEXOV FKEUH CKVUE CHKVE APHUO\nEGEHU EXOVL EXDKT VGEFT EHFKE UHCKF TZEXO\nVEZDT TVKUE XOVKV ENOHK ZFTEH TEHKQ LEROF\nPVEHP",
    "PEXOV ERYKP GERYT GVKEG XDRTE RGAGA\n",
    "What is the significance of this message in the history of cryptography?\n4.\n",
    "What is the total number of possible monoalphabetic cryptosystems?",
    "How secure are\nsuch cryptosystems?\n",
    "5.\nProve that a 2×2 matrix A with entries in Z26 is invertible if and only if gcd(det(A), 26) =\n1.\n6.\n",
    "Given the matrix\nA =\n\u00123\n4\n2\n3\n\u0013\n,\nuse the encryption function f(p)",
    "= Ap + b to encode the message CRYPTOLOGY, where\nb = (2, 5)t.",
    "What is the decoding function?\n7.\nEncrypt each of the following rsa messages x so that x is divided into blocks of integers\nof length 2; that is, if x = 142528, encode 14, 25, and 28 separately.\n",
    "(a) n = 3551, E = 629, x = 31\n(b) n = 2257, E = 47, x = 23\n(c) n = 120979, E = 13251, x = 142371\n(d) n",
    "= 45629, E = 781, x = 231561\n8.\n",
    "Compute the decoding key D for each of the encoding keys in Exercise 7.4.7.\n",
    "9.\nDecrypt each of the following rsa messages y.\n(a) n = 3551, D = 1997, y = 2791\n(b) n = 5893, D = 81, y = 34\n(c) n = 120979, D = 27331, y = 112135\n(d) n = 79403, D = 671, y = 129381\n10.",
    "For each of the following encryption keys (n, E) in the rsa cryptosystem, compute D.\n(a) (n, E) = (451, 231)\n(b) (n, E) = (3053, 1921)\n(c) (n, E) = (37986733, 12371)\n\nCHAPTER 7.",
    "INTRODUCTION TO CRYPTOGRAPHY\n88\n(d) (n, E) = (16394854313, 34578451)\n11.",
    "Encrypted messages are often divided into blocks of n letters.",
    "A message such as THE\nWORLD WONDERS WHY might be encrypted as JIW OCFRJ LPOEVYQ IOC but sent as JIW\nOCF RJL POE VYQ IOC.",
    "What are the advantages of using blocks of n letters?\n12.",
    "Find integers n, E, and X such that\nXE ≡X\n(mod n).\n",
    "Is this a potential problem in the rsa cryptosystem?\n13.",
    "Every person in the class should construct an rsa cryptosystem using primes that are\n10 to 15 digits long.",
    "Hand in (n, E) and an encoded message.",
    "Keep D secret.",
    "See if\nyou can break one another’s codes.\n",
    "7.5 Additional Exercises: Primality and Factoring\n",
    "In the rsa cryptosystem it is important to be able to find large prime numbers easily.",
    "Also,\nthis cryptosystem is not secure if we can factor a composite number that is the product\nof two large primes.",
    "The solutions to both of these problems are quite easy.",
    "To find out\nif a number n is prime or to factor n, we can use trial division.",
    "We simply divide n by\nd = 2, 3, . . .",
    ", √n.",
    "Either a factorization will be obtained, or n is prime if no d divides n.\n",
    "The problem is that such a computation is prohibitively time-consuming if n is very large.\n",
    "1.\nA better algorithm for factoring odd positive integers is Fermat’s factorization algo-\nrithm.\n",
    "(a) Let n = ab be an odd composite number.",
    "Prove that n can be written as the\ndifference of two perfect squares:\nn = x2 −y2 = (x −y)(x + y).\n",
    "Consequently, a positive odd integer can be factored exactly when we can find\nintegers x and y such that n = x2 −y2.\n",
    "(b) Write a program to implement the following factorization algorithm based on the\nobservation in part (a).",
    "The expression ceiling(sqrt(n)) means the smallest\ninteger greater than or equal to the square root of n. Write another program to\ndo factorization using trial division and compare the speed of the two algorithms.\n",
    "Which algorithm is faster and why?\n",
    "x := ceiling(sqrt(n))\n",
    "y := 1\n1 : while x^2 - y^2 > n do\ny := y + 1\nif x^2 - y^2 < n then\nx := x + 1\ny := 1\ngoto 1\nelse if x^2 - y^2 = 0",
    "then\na := x - y\nb :=",
    "x + y\nwrite n = a * b\n\nCHAPTER 7.",
    "INTRODUCTION TO CRYPTOGRAPHY\n89\n2.\nPrimality Testing.",
    "Recall Fermat’s Little Theorem from Chapter 6.",
    "Let p be prime\nwith gcd(a, p)",
    "= 1.",
    "Then ap−1 ≡1 (mod p).",
    "We can use Fermat’s Little Theorem as a\nscreening test for primes.",
    "For example, 15 cannot be prime since\n215−1 ≡214 ≡4\n(mod 15).\n",
    "However, 17 is a potential prime since\n217−1 ≡216 ≡1\n(mod 17).\n",
    "We say that an odd composite number n is a pseudoprime if\n2n−1 ≡1\n(mod n).\n",
    "Which of the following numbers are primes and which are pseudoprimes?\n(a) 342\n(b) 811\n(c) 601\n(d) 561\n(e) 771\n(f) 631\n3.\nLet n be an odd composite number and b be a positive integer such that gcd(b, n) = 1.\n",
    "If bn−1 ≡1 (mod n), then n is a pseudoprime base b. Show that 341 is a pseudoprime\nbase 2 but not a pseudoprime base 3.\n4.\nWrite a program to determine all primes less than 2000 using trial division.",
    "Write a\nsecond program that will determine all numbers less than 2000 that are either primes\nor pseudoprimes.",
    "Compare the speed of the two programs.",
    "How many pseudoprimes\nare there below 2000?\n",
    "There exist composite numbers that are pseudoprimes for all bases to which they are\nrelatively prime.",
    "These numbers are called Carmichael numbers.",
    "The first Carmichael\nnumber is 561 = 3 · 11 · 17.",
    "In 1992, Alford, Granville, and Pomerance proved that\nthere are an infinite number of Carmichael numbers",
    "[4].",
    "However, Carmichael numbers\nare very rare.",
    "There are only 2163 Carmichael numbers less than 25 × 109.",
    "For more\nsophisticated primality tests, see [1], [6], or [7].\n7.6 References and Suggested Readings\n[1]\nBressoud, D. M. Factorization and Primality Testing.",
    "Springer-Verlag, New York,\n1989.\n",
    "[2]\nDiﬀie, W. and Hellman, M. E. “New Directions in Cryptography,” IEEE Trans.",
    "In-\nform.",
    "Theory 22 (1976), 644–54.\n",
    "[3]\nGardner, M. “Mathematical games: A new kind of cipher that would take millions of\nyears to break,” Scientific American 237 (1977), 120–24.\n",
    "[4]\nGranville, A. “Primality Testing and Carmichael Numbers,” Notices of the American\nMathematical Society 39 (1992), 696–700.\n",
    "[5]\nHellman, M. E. “The Mathematics of Public Key Cryptography,” Scientific American\n241 (1979), 130–39.\n",
    "[6]\nKoblitz, N. A Course in Number Theory and Cryptography.",
    "2nd ed.",
    "Springer, New\nYork, 1994.\n",
    "[7]\nPomerance, C., ed.",
    "“Cryptology and Computational Number Theory”, Proceedings\nof Symposia in Applied Mathematics 42 (1990) American Mathematical Society, Prov-\nidence, RI.\n\n",
    "CHAPTER 7.",
    "INTRODUCTION TO CRYPTOGRAPHY\n90\n[8]\nRivest, R. L., Shamir, A., and Adleman, L., “A Method for Obtaining Signatures and\nPublic-key Cryptosystems,” Comm.",
    "ACM 21 (1978), 120–26.\n\n",
    "8\nAlgebraic Coding Theory\nCoding theory is an application of algebra that has become increasingly important over the\nlast several decades.",
    "When we transmit data, we are concerned about sending a message over\na channel that could be affected by “noise.”",
    "We wish to be able to encode and decode the\ninformation in a manner that will allow the detection, and possibly the correction, of errors\ncaused by noise.",
    "This situation arises in many areas of communications, including radio,\ntelephone, television, computer communications, and digital media technology.",
    "Probability,\ncombinatorics, group theory, linear algebra, and polynomial rings over finite fields all play\nimportant roles in coding theory.\n",
    "8.1 Error-Detecting and Correcting Codes\nLet us examine a simple model of a communications system for transmitting and receiving\ncoded messages (Figure 8.1).\n",
    "91\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n92\nm-digit message\nEncoder\nn-digit code word\nTransmitter\nNoise\nReceiver\nn-digit received word\nDecoder\nm-digit received message or error\nFigure 8.1 Encoding and decoding messages\nUncoded messages may be composed of letters or characters, but typically they consist\nof binary m-tuples.",
    "These messages are encoded into codewords, consisting of binary n-\ntuples, by a device called an encoder.",
    "The message is transmitted and then decoded.",
    "We\nwill consider the occurrence of errors during transmission.",
    "An error occurs if there is a\nchange in one or more bits in the codeword.",
    "A decoding scheme is a method that either\nconverts an arbitrarily received n-tuple into a meaningful decoded message or gives an error\nmessage for that n-tuple.",
    "If the received message is a codeword (one of the special n-tuples\nallowed to be transmitted), then the decoded message must be the unique message that\nwas encoded into the codeword.",
    "For received non-codewords, the decoding scheme will give\nan error indication, or, if we are more clever, will actually try to correct the error and\nreconstruct the original message.",
    "Our goal is to transmit error-free messages as cheaply\nand quickly as possible.\n",
    "Example 8.2 One possible coding scheme would be to send a message several times and to\ncompare the received copies with one another.",
    "Suppose that the message to be encoded is\na binary n-tuple (x1, x2, . . .",
    ", xn).",
    "The message is encoded into a binary 3n-tuple by simply\nrepeating the message three times:\n(x1, x2, . . .",
    ", xn) 7→(x1, x2, . . .",
    ", xn, x1, x2, . . .",
    ", xn, x1, x2, . . .",
    ", xn).\n",
    "To decode the message, we choose as the ith digit the one that appears in the ith place\nin at least two of the three transmissions.",
    "For example, if the original message is (0110),\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n93\nthen the transmitted message will be (0110 0110 0110).",
    "If there is a transmission error in\nthe fifth digit, then the received codeword will be (0110 1110 0110), which will be correctly\ndecoded as (0110).6 This triple-repetition method will automatically detect and correct all\nsingle errors, but it is slow and ineﬀicient: to send a message consisting of n bits, 2n extra\nbits are required, and we can only detect and correct single errors.",
    "We will see that it is\npossible to find an encoding scheme that will encode a message of n bits into m bits with\nm much smaller than 3n.\n",
    "□\nExample 8.3 Even parity, a commonly used coding scheme, is much more eﬀicient than the\nsimple repetition scheme.",
    "The ascii (American Standard Code for Information Interchange)\ncoding system uses binary 8-tuples, yielding 28 = 256 possible 8-tuples.",
    "However, only seven\nbits are needed since there are only 27 = 128 ascii characters.",
    "What can or should be done\nwith the extra bit?",
    "Using the full eight bits, we can detect single transmission errors.",
    "For\nexample, the ascii codes for A, B, and C are\nA = 6510 = 010000012,\nB = 6610 = 010000102,\nC = 6710 = 010000112.\n",
    "Notice that the leftmost bit is always set to 0; that is, the 128 ascii characters have codes\n000000002 = 010,\n...\n011111112 = 12710.\n",
    "The bit can be used for error checking on the other seven bits.",
    "It is set to either 0 or 1\nso that the total number of 1 bits in the representation of a character is even.",
    "Using even\nparity, the codes for A, B, and C now become\nA = 010000012,\nB = 010000102,\nC = 110000112.\n",
    "Suppose an A is sent and a transmission error in the sixth bit is caused by noise over the\ncommunication channel so that (0100 0101) is received.",
    "We know an error has occurred since\nthe received word has an odd number of 1s, and we can now request that the codeword be\ntransmitted again.",
    "When used for error checking, the leftmost bit is called a parity check\nbit.\n",
    "By far the most common error-detecting codes used in computers are based on the\naddition of a parity bit.",
    "Typically, a computer stores information in m-tuples called words.\n",
    "Common word lengths are 8, 16, and 32 bits.",
    "One bit in the word is set aside as the parity\ncheck bit, and is not used to store information.",
    "This bit is set to either 0 or 1, depending\non the number of 1s in the word.\n",
    "Adding a parity check bit allows the detection of all single errors because changing a\nsingle bit either increases or decreases the number of 1s by one, and in either case the parity\nhas been changed from even to odd, so the new word is not a codeword.",
    "(We could also\nconstruct an error detection scheme based on odd parity; that is, we could set the parity\ncheck bit so that a codeword always has an odd number of 1s.)\n",
    "□\nThe even parity system is easy to implement, but has two drawbacks.",
    "First, multiple\n7We will adopt the convention that bits are numbered left to right in binary n-tuples.\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n94\nerrors are not detectable.",
    "Suppose an A is sent and the first and seventh bits are changed\nfrom 0 to 1.",
    "The received word is a codeword, but will be decoded into a C instead of an A.\nSecond, we do not have the ability to correct errors.",
    "If the 8-tuple (1001 1000) is received,\nwe know that an error has occurred, but we have no idea which bit has been changed.",
    "We\nwill now investigate a coding scheme that will not only allow us to detect transmission errors\nbut will actually correct the errors.\n",
    "Example 8.4 Suppose that our original message is either a 0 or a 1, and that 0 encodes\nto (000) and 1 encodes to (111).",
    "If only a single error occurs during transmission, we can\ndetect and correct the error.",
    "For example, if a (101) is received, then the second bit must\nhave been changed from a 1 to a 0.",
    "The originally transmitted codeword must have been\n(111).",
    "This method will detect and correct all single errors.\n",
    "Table 8.5 A repetition code\nTransmitted\nReceived Word\nCodeword\n000\n001\n010\n011\n100\n101\n110\n111\n000\n0\n1\n1\n2\n1\n2\n2\n3\n111\n3\n2\n2\n1\n2\n1\n1\n0\n",
    "In Table 8.5, we present all possible words that might be received for the transmitted\ncodewords (000) and (111).",
    "Table 8.5 also shows the number of bits by which each received\n3-tuple differs from each original codeword.\n",
    "□\nMaximum-Likelihood Decoding\nThe coding scheme presented in Example 8.4 is not a complete solution to the problem\nbecause it does not account for the possibility of multiple errors.",
    "For example, either a\n(000) or a (111) could be sent and a (001) received.",
    "We have no means of deciding from the\nreceived word whether there was a single error in the third bit or two errors, one in the first\nbit and one in the second.",
    "No matter what coding scheme is used, an incorrect message\ncould be received.",
    "We could transmit a (000), have errors in all three bits, and receive\nthe codeword (111).",
    "It is important to make explicit assumptions about the likelihood and\ndistribution of transmission errors so that, in a particular application, it will be known\nwhether a given error detection scheme is appropriate.",
    "We will assume that transmission\nerrors are rare, and, that when they do occur, they occur independently in each bit; that is,\nif p is the probability of an error in one bit and q is the probability of an error in a different\nbit, then the probability of errors occurring in both of these bits at the same time is pq.\n",
    "We will also assume that a received n-tuple is decoded into a codeword that is closest to it;\nthat is, we assume that the receiver uses maximum-likelihood decoding.",
    "7\n7This section requires a knowledge of probability, but can be skipped without loss of continuity.\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n95\n0\n0\n1\n1\np\np\nq\nq\nFigure 8.6 Binary symmetric channel\nA binary symmetric channel is a model that consists of a transmitter capable of sending\na binary signal, either a 0 or a 1, together with a receiver.",
    "Let p be the probability that\nthe signal is correctly received.",
    "Then q = 1 −p is the probability of an incorrect reception.\n",
    "If a 1 is sent, then the probability that a 1 is received is p and the probability that a 0 is\nreceived is q (Figure 8.6).",
    "The probability that no errors occur during the transmission of\na binary codeword of length n is pn.",
    "For example, if p = 0.999 and a message consisting of\n10,000 bits is sent, then the probability of a perfect transmission is\n(0.999)10,000 ≈0.00005.\n",
    "Theorem 8.7",
    "If a binary n-tuple (x1, . . .",
    ", xn) is transmitted across a binary symmetric\nchannel with probability p that no error will occur in each coordinate, then the probability\nthat there are errors in exactly k coordinates is\n\u0012n\nk\n\u0013\nqkpn−k.\n",
    "Proof.",
    "Fix k different coordinates.",
    "We first compute the probability that an error has\noccurred in this fixed set of coordinates.",
    "The probability of an error occurring in a particular\none of these k coordinates is q; the probability that an error will not occur in any of the\nremaining n −k coordinates is p.",
    "The probability of each of these n independent events is\nqkpn−k.",
    "The number of possible error patterns with exactly k errors occurring is equal to\n\u0012n\nk\n\u0013\n=\nn!\nk!(n −k)!,\nthe number of combinations of n things taken k at a time.",
    "Each of these error patterns has\nprobability qkpn−k of occurring; hence, the probability of all of these error patterns is\n\u0012n\nk\n\u0013\nqkpn−k.\n",
    "■\nExample 8.8 Suppose that p = 0.995 and a 500-bit message is sent.",
    "The probability that\nthe message was sent error-free is\npn = (0.995)500 ≈0.082.\n",
    "The probability of exactly one error occurring is\n\u0012n\n1\n\u0013\nqpn−1 = 500(0.005)(0.995)499 ≈0.204.\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n96\n",
    "The probability of exactly two errors is\n\u0012n\n2\n\u0013\nq2pn−2 = 500 · 499\n2\n(0.005)2(0.995)498 ≈0.257.\n",
    "The probability of more than two errors is approximately\n1 −0.082 −0.204 −0.257 = 0.457.\n",
    "□\nBlock Codes\nIf we are to develop eﬀicient error-detecting and error-correcting codes, we will need more\nsophisticated mathematical tools.",
    "Group theory will allow faster methods of encoding and\ndecoding messages.",
    "A code is an (n, m)-block code if the information that is to be coded\ncan be divided into blocks of m binary digits, each of which can be encoded into n binary\ndigits.",
    "More specifically, an (n, m)-block code consists of an encoding function\nE : Zm\n2 →Zn\n2\nand a decoding function\nD :",
    "Zn\n2 →Zm\n2 .\n",
    "A codeword is any element in the image of E.",
    "We also require that E be one-to-one so that\ntwo information blocks will not be encoded into the same codeword.",
    "If our code is to be\nerror-correcting, then D must be onto.\n",
    "Example 8.9 The even-parity coding system developed to detect single errors in ascii\ncharacters is an (8, 7)-block code.",
    "The encoding function is\nE(x7, x6, . . .",
    ", x1) = (x8, x7, . . .",
    ", x1),\n",
    "where x8 = x7 + x6 + · · · + x1 with addition in Z2.\n",
    "□\nLet x = (x1, . . .",
    ", xn) and y = (y1, . . .",
    ", yn) be binary n-tuples.",
    "The Hamming distance or\ndistance, d(x, y), between x and y is the number of bits in which x and y differ.",
    "The distance\nbetween two codewords is the minimum number of transmission errors required to change\none codeword into the other.",
    "The minimum distance for a code, dmin, is the minimum of\nall distances d(x, y), where x and y are distinct codewords.",
    "The weight, w(x), of a binary\ncodeword x is the number of 1s in x.",
    "Clearly, w(x) = d(x, 0), where 0 = (00 · · · 0).\n",
    "Example 8.10",
    "Let x = (10101), y = (11010), and z = (00011) be all of the codewords in\nsome code C. Then we have the following Hamming distances:\nd(x, y) = 4,\nd(x, z) = 3,\nd(y, z) = 3.\n",
    "The minimum distance for this code is 3.",
    "We also have the following weights:\nw(x) = 3,\nw(y) = 3,\nw(z) = 2.\n□\nThe following proposition lists some basic properties about the weight of a codeword\nand the distance between two codewords.",
    "The proof is left as an exercise.\n",
    "Proposition 8.11 Let x, y, and z be binary n-tuples.",
    "Then\n1. w(x) = d(x, 0);\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n97\n2.",
    "d(x, y) ≥0;\n3.",
    "d(x, y) = 0 exactly when x = y;\n4.",
    "d(x, y) = d(y, x);\n5.",
    "d(x, y) ≤d(x, z) + d(z, y).\n",
    "The weights in a particular code are usually much easier to compute than the Hamming\ndistances between all codewords in the code.",
    "If a code is set up carefully, we can use this\nfact to our advantage.\n",
    "Suppose that x = (1101) and y = (1100) are codewords in some code.",
    "If we transmit\n(1101) and an error occurs in the rightmost bit, then (1100) will be received.",
    "Since (1100) is\na codeword, the decoder will decode (1100) as the transmitted message.",
    "This code is clearly\nnot very appropriate for error detection.",
    "The problem is that d(x, y) = 1.",
    "If x = (1100) and\ny = (1010) are codewords, then d(x, y) = 2.",
    "If x is transmitted and a single error occurs,\nthen y can never be received.",
    "Table 8.12 gives the distances between all 4-bit codewords\nin which the first three bits carry information and the fourth is an even parity check bit.\n",
    "We can see that the minimum distance here is 2; hence, the code is suitable as a single\nerror-detecting code.\n",
    "Table 8.12 Distances between 4-bit codewords\n0000\n0011\n0101\n0110\n1001\n1010\n1100\n1111\n0000\n0\n2\n2\n2\n2\n2\n2\n4\n0011\n2\n0\n2\n2\n2\n2\n4\n2\n0101\n2\n2\n0\n2\n2\n4\n2\n2\n0110\n2\n2\n2\n0\n4\n2\n2\n2\n1001\n2\n2\n2\n4\n0\n2\n2\n2\n1010\n2\n2\n4\n2\n2\n0\n2\n2\n1100\n2\n4\n2\n2\n2\n2\n0\n2\n1111\n4\n2\n2\n2\n2\n2\n2\n0\nTo determine exactly what the error-detecting and error-correcting capabilities for a\ncode are, we need to analyze the minimum distance for the code.",
    "Let x and y be codewords.\n",
    "If d(x, y) = 1 and an error occurs where x and y differ, then x is changed to y.",
    "The received\ncodeword is y and no error message is given.",
    "Now suppose d(x, y) = 2.",
    "Then a single error\ncannot change x to y.",
    "Therefore, if dmin = 2, we have the ability to detect single errors.\n",
    "However, suppose that d(x, y) = 2, y is sent, and a noncodeword z is received such that\nd(x, z) = d(y, z) = 1.\nThen the decoder cannot decide between x and y.",
    "Even though we are aware that an error\nhas occurred, we do not know what the error is.\n",
    "Suppose dmin ≥3.",
    "Then the maximum-likelihood decoding scheme corrects all single\nerrors.",
    "Starting with a codeword x, an error in the transmission of a single bit gives y with\nd(x, y) = 1, but d(z, y) ≥2 for any other codeword z ̸= x.",
    "If we do not require the correction\nof errors, then we can detect multiple errors when a code has a minimum distance that is\ngreater than or equal to 3.\n",
    "Theorem 8.13 Let C be a code with dmin = 2n + 1.",
    "Then C can correct any n or fewer\nerrors.",
    "Furthermore, any 2n or fewer errors can be detected in C.\nProof.",
    "Suppose that a codeword x is sent and the word y is received with at most n errors.\n",
    "Then d(x, y) ≤n.",
    "If z is any codeword other than x, then\n2n + 1 ≤d(x, z) ≤d(x, y) + d(y, z) ≤n + d(y, z).\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n98\nHence, d(y, z) ≥n + 1",
    "and y will be correctly decoded as x.\nNow suppose that x is\ntransmitted and y is received and that at least one error has occurred, but not more than\n2n errors.",
    "Then 1 ≤d(x, y) ≤2n.",
    "Since the minimum distance between codewords is 2n+1,\ny cannot be a codeword.",
    "Consequently, the code can detect between 1 and 2n errors.\n",
    "■\nExample 8.14 In Table 8.15, the codewords c1 = (00000), c2 = (00111), c3 = (11100), and\nc4 = (11011) determine a single error-correcting code.\n",
    "Table 8.15 Hamming distances for an error-correcting code\n00000\n00111\n11100\n11011\n00000\n0\n3\n3\n4\n00111\n3\n0\n4\n3\n11100\n3\n4\n0\n3\n11011\n4\n3\n3\n0\n□\nHistorical Note\nModern coding theory began in 1948 with C. Shannon’s paper, “A Mathematical Theory\nof Information”",
    "[7].",
    "This paper offered an example of an algebraic code, and Shannon’s\nTheorem proclaimed exactly how good codes could be expected to be.",
    "Richard Hamming\nbegan working with linear codes at Bell Labs in the late 1940s and early 1950s after becoming\nfrustrated because the programs that he was running could not recover from simple errors\ngenerated by noise.",
    "Coding theory has grown tremendously in the past several decades.\n",
    "The Theory of Error-Correcting Codes, by MacWilliams and Sloane",
    "[5], published in 1977,\nalready contained over 1500 references.",
    "Linear codes (Reed-Muller (32, 6)-block codes) were\nused on NASA’s Mariner space probes.",
    "More recent space probes such as Voyager have used\nwhat are called convolution codes.",
    "Currently, very active research is being done with Goppa\ncodes, which are heavily dependent on algebraic geometry.\n",
    "8.2 Linear Codes\nTo gain more knowledge of a particular code and develop more eﬀicient techniques of encod-\ning, decoding, and error detection, we need to add additional structure to our codes.",
    "One\nway to accomplish this is to require that the code also be a group.",
    "A group code is a code\nthat is also a subgroup of Zn\n2.\nTo check that a code is a group code, we need only verify one thing.",
    "If we add any\ntwo elements in the code, the result must be an n-tuple that is again in the code.",
    "It is not\nnecessary to check that the inverse of the n-tuple is in the code, since every codeword is its\nown inverse, nor is it necessary to check that 0 is a codeword.",
    "For instance,\n(11000101) + (11000101) = (00000000).\n",
    "Example 8.16 Suppose that we have a code that consists of the following 7-tuples:\n(0000000)\n(0001111)\n(0010101)\n(0011010)\n(0100110)\n(0101001)\n(0110011)\n(0111100)\n(1000011)\n(1001100)\n(1010110)\n(1011001)\n(1100101)\n(1101010)\n(1110000)\n(1111111).\n",
    "It is a straightforward though tedious task to verify that this code is also a subgroup of Z7\n2\nand, therefore, a group code.",
    "This code is a single error-detecting and single error-correcting\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n99\ncode, but it is a long and tedious process to compute all of the distances between pairs of\ncodewords to determine that dmin = 3.",
    "It is much easier to see that the minimum weight\nof all the nonzero codewords is 3.",
    "As we will soon see, this is no coincidence.",
    "However, the\nrelationship between weights and distances in a particular code is heavily dependent on the\nfact that the code is a group.\n",
    "□\nLemma 8.17 Let x and y be binary n-tuples.",
    "Then w(x + y) = d(x, y).\n",
    "Proof.",
    "Suppose that x and y are binary n-tuples.",
    "Then the distance between x and y\nis exactly the number of places in which x and y differ.",
    "But x and y differ in a particular\ncoordinate exactly when the sum in the coordinate is 1, since\n1 + 1 = 0\n0",
    "+ 0 = 0\n1 + 0 = 1\n0",
    "+ 1 = 1.\n",
    "Consequently, the weight of the sum must be the distance between the two codewords.\n",
    "■\nTheorem 8.18 Let dmin be the minimum distance for a group code C. Then dmin is the\nminimum weight of all the nonzero codewords in C. That is,\ndmin = min{w(x) : x ̸= 0}.\nProof.",
    "Observe that\ndmin = min{d(x, y) : x ̸= y}\n= min{d(x, y) :",
    "x + y ̸= 0}\n= min{w(x + y) : x + y ̸= 0}\n= min{w(z) : z ̸= 0}.\n",
    "■\nLinear Codes\nFrom Example 8.16, it is now easy to check that the minimum nonzero weight is 3; hence,\nthe code does indeed detect and correct all single errors.",
    "We have now reduced the problem\nof finding “good” codes to that of generating group codes.",
    "One easy way to generate group\ncodes is to employ a bit of matrix theory.\n",
    "Define the inner product of two binary n-tuples to be\nx · y = x1y1",
    "+ · · · + xnyn,\nwhere x = (x1, x2, . .",
    ".",
    ", xn)t and y = (y1, y2, . . .",
    ", yn)t are column vectors.8",
    "For example, if\nx = (011001)t and y = (110101)t, then x · y = 0.",
    "We can also look at an inner product as\nthe product of a row matrix with a column matrix; that is,\nx · y",
    "= xty\n=\n\u0000x1\nx2\n· · ·\nxn\n\u0001\n\n\n\n\n\ny1\ny2\n...\nyn\n\n\n\n\n\n8Since we will be working with matrices",
    ", we will write binary n-tuples as column vectors for the remainder\nof this chapter.\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n100\n= x1y1",
    "+ x2y2",
    "+ · · · + xnyn.\n",
    "Example 8.19 Suppose that the words to be encoded consist of all binary 3-tuples and that\nour encoding scheme is even-parity.",
    "To encode an arbitrary 3-tuple, we add a fourth bit to\nobtain an even number of 1s.",
    "Notice that an arbitrary n-tuple x = (x1, x2, . .",
    ".",
    ", xn)t has an\neven number of 1s exactly when x1 + x2 + · · · + xn = 0; hence, a 4-tuple x = (x1, x2, x3, x4)t\nhas an even number of 1s if x1 + x2 + x3 + x4 = 0, or\nx · 1 = xt1 =\n\u0000x1\nx2\nx3\nx4\n\u0001\n\n\n\n\n\n1\n1\n1\n1\n\n\n\n\n= 0.\n",
    "This example leads us to hope that there is a connection between matrices and coding\ntheory.\n",
    "□\nLet Mm×n(Z2) denote the set of all m × n matrices with entries in Z2.",
    "We do matrix\noperations as usual except that all our addition and multiplication operations occur in Z2.\n",
    "Define the null space of a matrix H ∈Mm×n(Z2) to be the set of all binary n-tuples x such\nthat Hx = 0.",
    "We denote the null space of a matrix H by Null(H).\n",
    "Example 8.20 Suppose that\nH =\n\n\n0\n1\n0\n1\n0\n1\n1\n1\n1\n0\n0\n0\n1\n1\n1\n\n.\n",
    "For a 5-tuple x = (x1, x2, x3, x4, x5)t to be in the null space of H, Hx = 0.",
    "Equivalently,\nthe following system of equations must be satisfied:\nx2 + x4 = 0\nx1",
    "+ x2 + x3 + x4 = 0\nx3 + x4 + x5 = 0.\n",
    "The set of binary 5-tuples satisfying these equations is\n(00000)\n(11110)\n(10101)\n(01011).\n",
    "This code is easily determined to be a group code.\n",
    "□\nTheorem 8.21 Let H be in Mm×n(Z2).",
    "Then the null space of H is a group code.\n",
    "Proof.",
    "Since each element of Zn\n2 is its own inverse, the only thing that really needs to be\nchecked here is closure.",
    "Let x, y ∈Null(H) for some matrix H in Mm×n(Z2).",
    "Then Hx = 0\nand Hy = 0.",
    "So\nH(x + y) = Hx +",
    "Hy = 0 + 0 = 0.\n",
    "Hence, x + y is in the null space of H and therefore must be a codeword.\n",
    "■\nA code is a linear code if it is determined by the null space of some matrix H ∈\nMm×n(Z2).\n",
    "Example 8.22 Let C be the code given by the matrix\nH =\n\n\n0\n0\n0\n1\n1\n1\n0\n1\n1\n0\n1\n1\n1\n0\n1\n0\n0\n1\n\n.\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n101\nSuppose that the 6-tuple x = (010011)t is received.",
    "It is a simple matter of matrix multi-\nplication to determine whether or not x is a codeword.",
    "Since\nHx =\n\n\n0\n1\n1\n\n,\nthe received word is not a codeword.",
    "We must either attempt to correct the word or request\nthat it be transmitted again.\n",
    "□\n8.3 Parity-Check and Generator Matrices\nWe need to find a systematic way of generating linear codes as well as fast methods of\ndecoding.",
    "By examining the properties of a matrix H and by carefully choosing H, it is\npossible to develop very eﬀicient methods of encoding and decoding messages.",
    "To this end,\nwe will introduce standard generator and canonical parity-check matrices.\n",
    "Suppose that H is an m",
    "× n matrix with entries in Z2 and n > m.\n",
    "If the last m\ncolumns of the matrix form the m × m",
    "identity matrix, Im, then the matrix is a canonical\nparity-check matrix.",
    "More specifically, H = (A | Im), where A is the m × (n −m) matrix\n\n\n\n\n\na11\na12\n· · ·\na1,n−m\na21\na22\n· · ·\na2,n−m\n...\n...\n...\n...\nam1\nam2\n· · ·\nam,n−m\n\n\n\n\n\nand Im is the m × m",
    "identity matrix\n\n\n\n\n\n1\n0\n· · ·\n0\n0\n1\n· · ·\n0\n...\n...\n...\n...\n0\n0\n· · ·\n1\n\n\n\n\n.\n",
    "With each canonical parity-check matrix we can associate an n×(n−m) standard generator\nmatrix\nG =\n\u0012In−m\nA\n\u0013\n.\n",
    "Our goal will be to show that an x satisfying",
    "Gx = y exists if and only if Hy = 0.",
    "Given a\nmessage block x to be encoded, the matrix G will allow us to quickly encode it into a linear\ncodeword y.\nExample 8.23 Suppose that we have the following eight words to be encoded:\n(000), (001), (010), . . .",
    ", (111).\n",
    "For\nA =\n\n\n0\n1\n1\n1\n1\n0\n1\n0\n1\n\n,\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n102\nthe associated standard generator and canonical parity-check matrices are\nG =\n\n\n\n\n\n\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n1\n1\n1\n1\n0\n1\n0\n1\n\n\n\n\n\n\n\n\n\nand\nH =\n\n\n0\n1\n1\n1\n0\n0\n1\n1\n0\n0\n1\n0\n1\n0\n1\n0\n0\n1\n\n,\nrespectively.\n",
    "Observe that the rows in H represent the parity checks on certain bit positions in a\n6-tuple.",
    "The 1s in the identity matrix serve as parity checks for the 1s in the same row.",
    "If\nx = (x1, x2, x3, x4, x5, x6), then\n0 = Hx =\n\n\nx2 + x3 + x4\nx1 + x2 + x5\nx1",
    "+ x3 + x6\n\n,\nwhich yields a system of equations:\n",
    "x2 + x3 + x4 = 0\nx1",
    "+ x2 + x5 = 0\nx1 + x3 + x6 = 0.\n",
    "Here x4 serves as a check bit for x2 and x3; x5 is a check bit for x1 and x2; and x6 is a check\nbit for x1 and x3.",
    "The identity matrix keeps x4, x5, and x6 from having to check on each\nother.",
    "Hence, x1, x2, and x3 can be arbitrary but x4, x5, and x6 must be chosen to ensure\nparity.",
    "The null space of H is easily computed to be\n(000000)\n(001101)\n(010110)\n(011011)\n(100011)\n(101110)\n(110101)\n(111000).\n",
    "An even easier way to compute the null space is with the generator matrix G (Table 8.24).\n",
    "□\nTable 8.24",
    "A matrix-generated code\nMessage Word x\nCodeword Gx\n000\n000000\n001\n001101\n010\n010110\n011\n011011\n100\n100011\n101\n101110\n110\n110101\n111\n111000\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n103\n",
    "Theorem 8.25",
    "If H ∈Mm×n(Z2) is a canonical parity-check matrix, then Null(H) consists\nof all x ∈Zn\n2 whose first n −m bits are arbitrary but whose last m bits are determined by\nHx = 0.",
    "Each of the last m bits serves as an even parity check bit for some of the first\nn −m bits.",
    "Hence, H gives rise to an (n, n −m)-block code.\n",
    "We leave the proof of this theorem as an exercise.",
    "In light of the theorem, the first\nn −m bits in x are called information bits and the last m bits are called check bits.",
    "In\nExample 8.23, the first three bits are the information bits and the last three are the check\nbits.\n",
    "Theorem 8.26 Suppose that G is an n × k standard generator matrix.\n",
    "Then C =\n\b\ny :",
    "Gx = y for x ∈Zk\n2\n\t\nis an (n, k)-block code.",
    "More specifically, C is a group code.\n",
    "Proof.",
    "Let Gx1 = y1 and Gx2 = y2 be two codewords.",
    "Then y1 + y2 is in C since\nG(x1 + x2)",
    "= Gx1 + Gx2",
    "= y1 + y2.\n",
    "We must also show that two message blocks cannot be encoded into the same codeword.\n",
    "That is, we must show that if Gx = Gy, then x = y. Suppose that Gx = Gy.",
    "Then\nGx −Gy = G(x −y)",
    "= 0.\n",
    "However, the first k coordinates in G(x −y) are exactly x1 −y1, . . .",
    ", xk −yk, since they are\ndetermined by the identity matrix, Ik, part of G. Hence, G(x −y) = 0 exactly when x = y.\n■\nBefore we can prove the relationship between canonical parity-check matrices and stan-\ndard generating matrices, we need to prove a lemma.\n",
    "Lemma 8.27 Let H = (A | Im) be an m×n canonical parity-check matrix and G =\n\u0010\nIn−m\nA\n\u0011\nbe the corresponding n × (n −m) standard generator matrix.",
    "Then HG = 0.\n",
    "Proof.",
    "Let C = HG.",
    "The ijth entry in C is\ncij =\nn\nX\nk=1\nhikgkj\n=\nn−m\nX\nk=1\nhikgkj +\nn\nX\nk=n−m+1\nhikgkj\n=\nn−m\nX\nk=1\naikδkj +\nn\nX\nk=n−m+1\nδi−(m−n),kakj\n= aij + aij\n= 0,\nwhere\nδij =\n(\n1\ni = j\n0\ni ̸= j\nis the Kronecker delta.\n",
    "■\nTheorem 8.28 Let H = (A | Im) be an m × n canonical parity-check matrix and let\nG =\n\u0010\nIn−m\nA\n\u0011\nbe the n × (n −m) standard generator matrix associated with H. Let C be the\ncode generated by G.",
    "Then y is in C",
    "if and only if Hy = 0.",
    "In particular, C is a linear\ncode with canonical parity-check matrix H.\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n104\nProof.\n",
    "First suppose that y ∈C.",
    "Then",
    "Gx = y for some x ∈Zm\n2 .",
    "By Lemma 8.27,\nHy = HGx = 0.\n",
    "Conversely, suppose that y = (y1, . . .",
    ", yn)t is in the null space of H. We need to find\nan x in Zn−m\n2\nsuch that Gxt = y. Since Hy = 0, the following set of equations must be\nsatisfied:\na11y1 + a12y2 + · · ·",
    "+ a1,n−myn−m",
    "+ yn−m+1 = 0\na21y1 + a22y2 + · · · + a2,n−myn−m + yn−m+2 = 0\n...\n",
    "am1y1 + am2y2",
    "+ · · · + am,n−myn−m",
    "+ yn−m+m = 0.\n",
    "Equivalently, yn−m+1, . . .",
    ", yn are determined by y1, . . .",
    ", yn−m:\nyn−m+1 = a11y1 + a12y2 + · · · + a1,n−myn−m\nyn−m+2 = a21y1 + a22y2 + · · · + a2,n−myn−m\n...\n",
    "yn = am1y1 + am2y2 + · · · + am,n−myn−m.\n",
    "Consequently, we can let xi = yi for i = 1, . . . , n −m.\n",
    "■\nIt would be helpful if we could compute the minimum distance of a linear code directly\nfrom its matrix H in order to determine the error-detecting and error-correcting capabilities\nof the code.",
    "Suppose that\ne1 = (100 · · · 00)t\ne2 = (010 · · · 00)t\n...\n",
    "en = (000 · · · 01)t\nare the n-tuples in Zn\n2 of weight 1.",
    "For an m × n binary matrix H, Hei is exactly the ith\ncolumn of the matrix H.\nExample 8.29 Observe that\n\n\n1\n1\n1\n0\n0\n1\n0\n0\n1\n0\n1\n1\n0\n0\n1\n\n\n\n\n\n\n\n\n\n0\n1\n0\n0\n0\n\n\n\n\n\n\n\n=\n\n\n1\n0\n1\n\n.\n□\nWe state this result in the following proposition and leave the proof as an exercise.\n",
    "Proposition 8.30 Let ei be the binary n-tuple with a 1 in the ith coordinate and 0’s\nelsewhere and suppose that H ∈Mm×n(Z2).",
    "Then Hei is the ith column of the matrix H.\nTheorem 8.31 Let H be an m × n binary matrix.",
    "Then the null space of H is a single\nerror-detecting code if and only if no column of H consists entirely of zeros.\nProof.",
    "Suppose that Null(H) is a single error-detecting code.",
    "Then the minimum distance\nof the code must be at least 2.",
    "Since the null space is a group code, it is suﬀicient to require\nthat the code contain no codewords of less than weight 2 other than the zero codeword.\n",
    "That is, ei must not be a codeword for i = 1, . . .",
    ", n.",
    "Since Hei is the ith column of H, the\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n105\nonly way in which ei could be in the null space of H would be if the ith column were all\nzeros, which is impossible; hence, the code must have the capability to detect at least single\nerrors.\n",
    "Conversely, suppose that no column of H is the zero column.\n",
    "By Proposition 8.30,\nHei ̸= 0.\n",
    "■\nExample 8.32 If we consider the matrices\nH1 =\n\n\n1\n1\n1\n0\n0\n1\n0\n0\n1\n0\n1\n1\n0\n0\n1\n\n\nand\nH2 =\n\n\n1\n1\n1\n0\n0\n1\n0\n0\n0\n0\n1\n1\n0\n0\n1\n\n,\nthen the null space of H1 is a single error-detecting code and the null space of H2 is not.\n",
    "□\nWe can even do better than Theorem 8.31.",
    "This theorem gives us conditions on a matrix\nH that tell us when the minimum weight of the code formed by the null space of H is 2.\n",
    "We can also determine when the minimum distance of a linear code is 3 by examining the\ncorresponding matrix.\n",
    "Example 8.33 If we let\nH =\n\n\n1\n1\n1\n0\n1\n0\n0\n1\n1\n1\n0\n0\n\n\nand want to determine whether or not H is the canonical parity-check matrix for an error-\ncorrecting code, it is necessary to make certain that Null(H) does not contain any 4-tuples\nof weight 2.",
    "That is, (1100), (1010), (1001), (0110), (0101), and (0011) must not be in\nNull(H).",
    "The next theorem states that we can indeed determine that the code generated\nby H is error-correcting by examining the columns of H. Notice in this example that not\nonly does H have no zero columns, but also that no two columns are the same.\n",
    "□\nTheorem 8.34 Let H be a binary matrix.",
    "The null space of H is a single error-correcting\ncode if and only if H does not contain any zero columns and no two columns of H are\nidentical.\n",
    "Proof.\n",
    "The n-tuple ei +",
    "ej has 1s in the ith and jth entries and 0s elsewhere, and\nw(ei + ej) = 2 for i ̸= j.",
    "Since\n0 = H(ei + ej) = Hei + Hej\ncan only occur if the ith and jth columns are identical, the null space of H is a single\nerror-correcting code.\n",
    "■\nSuppose now that we have a canonical parity-check matrix H with three rows.",
    "Then\nwe might ask how many more columns we can add to the matrix and still have a null space\nthat is a single error-detecting and single error-correcting code.",
    "Since each column has three\nentries, there are 23 = 8 possible distinct columns.",
    "We cannot add the columns\n\n\n0\n0\n0\n\n,\n\n\n1\n0\n0\n\n,\n\n\n0\n1\n0\n\n,\n\n\n0\n0\n1\n\n.\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n106\n",
    "So we can add as many as four columns and still maintain a minimum distance of 3.\n",
    "In general, if H is an m×n canonical parity-check matrix, then there are n−m informa-\ntion positions in each codeword.",
    "Each column has m bits, so there are 2m possible distinct\ncolumns.",
    "It is necessary that the columns 0, e1, . . .",
    ", em be excluded, leaving 2m −(1 + m)\nremaining columns for information if we are still to maintain the ability not only to detect\nbut also to correct single errors.\n",
    "8.4 Eﬀicient Decoding\n",
    "We are now at the stage where we are able to generate linear codes that detect and correct\nerrors fairly easily, but it is still a time-consuming process to decode a received n-tuple and\ndetermine which is the closest codeword, because the received n-tuple must be compared to\neach possible codeword to determine the proper decoding.",
    "This can be a serious impediment\nif the code is very large.\n",
    "Example 8.35 Given the binary matrix\nH =\n\n\n1\n1\n1\n0\n0\n0\n1\n0\n1\n0\n1\n0\n0\n0\n1\n\n\nand the 5-tuples x = (11011)t and y = (01011)t, we can compute\nHx =\n\n\n0\n0\n0\n\n\nand\n",
    "Hy =\n\n\n1\n0\n1\n\n.\nHence, x is a codeword and y is not, since x is in the null space and y is not.",
    "Notice that\nHy is identical to the first column of H. In fact, this is where the error occurred.",
    "If we flip\nthe first bit in y from 0 to 1, then we obtain x.\n",
    "□\nIf H is an m × n matrix and x ∈Zn\n2, then we say that the syndrome of x is Hx.",
    "The\nfollowing proposition allows the quick detection and correction of errors.\n",
    "Proposition 8.36 Let the m × n binary matrix H determine a linear code and let x be the\nreceived n-tuple.",
    "Write x as x = c + e, where c is the transmitted codeword and e is the\ntransmission error.",
    "Then the syndrome Hx of the received codeword x is also the syndrome\nof the error e.\nProof.",
    "The proof follows from the fact that\nHx = H(c + e) = Hc +",
    "He = 0",
    "+",
    "He = He.\n",
    "■\nThis proposition tells us that the syndrome of a received word depends solely on the\nerror and not on the transmitted codeword.",
    "The proof of the following theorem follows\nimmediately from Proposition 8.36 and from the fact that He is the ith column of the\nmatrix H.\nTheorem 8.37 Let H ∈Mm×n(Z2) and suppose that the linear code corresponding to H\nis single error-correcting.",
    "Let r be a received n-tuple that was transmitted with at most one\nerror.",
    "If the syndrome of r is 0, then no error has occurred; otherwise, if the syndrome of r\nis equal to some column of H, say the ith column, then the error has occurred in the ith bit.\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n107\nExample 8.38 Consider the matrix\nH =\n\n\n1\n0\n1\n1\n0\n0\n0\n1\n1\n0\n1\n0\n1\n1\n1\n0\n0\n1\n\n\nand suppose that the 6-tuples x = (111110)t, y = (111111)t, and z = (010111)t have been\nreceived.",
    "Then\nHx =\n\n\n1\n1\n1\n\n, Hy =\n\n\n1\n1\n0\n\n, Hz =\n\n\n1\n0\n0\n\n.\nHence, x has an error in the third bit and z has an error in the fourth bit.",
    "The transmitted\ncodewords for x and z must have been (110110) and (010011), respectively.",
    "The syndrome\nof y does not occur in any of the columns of the matrix H, so multiple errors must have\noccurred to produce y.\n□\nCoset Decoding\nWe can use group theory to obtain another way of decoding messages.",
    "A linear code C is\na subgroup of Zn\n2.",
    "Coset or standard decoding uses the cosets of C in Zn\n2 to implement\nmaximum-likelihood decoding.",
    "Suppose that C is an (n, m)-linear code.",
    "A coset of C in Zn\n2\nis written in the form x + C, where x ∈Zn\n2.",
    "By Lagrange’s Theorem (Theorem 6.10), there\nare 2n−m distinct cosets of C in Zn\n2.\nExample 8.39",
    "Let C be the (5, 3)-linear code given by the parity-check matrix\nH =\n\n\n0\n1\n1\n0\n0\n1\n0\n0\n1\n0\n1\n1\n0\n0\n1\n\n",
    ".\n",
    "The code consists of the codewords\n(00000)\n(01101)\n(10011)\n(11110).\n",
    "There are 25−2 = 23 cosets of C in Z5\n2, each with order 22 = 4.",
    "These cosets are listed in\nTable 8.40.\n",
    "□\nTable 8.40 Cosets of C\nCoset\nCoset\nRepresentative\nC\n(00000)(01101)(10011)(11110)\n(10000) + C\n(10000)(11101)(00011)(01110)\n(01000) + C\n(01000)(00101)(11011)(10110)\n(00100)",
    "+ C\n(00100)(01001)(10111)(11010)\n(00010)",
    "+ C\n(00010)(01111)(10001)(11100)\n(00001)",
    "+ C\n(00001)(01100)(10010)(11111)\n(10100)",
    "+ C\n(00111)(01010)(10100)(11001)\n(00110)",
    "+ C\n(00110)(01011)(10101)(11000)\n",
    "Our task is to find out how knowing the cosets might help us to decode a message.\n",
    "Suppose that x was the original codeword sent and that r is the n-tuple received.",
    "If e is\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n108\nthe transmission error, then r = e",
    "+ x or, equivalently, x = e + r.",
    "However, this is exactly\nthe statement that r is an element in the coset e + C.",
    "In maximum-likelihood decoding\nwe expect the error e to be as small as possible; that is, e will have the least weight.",
    "An\nn-tuple of least weight in a coset is called a coset leader.",
    "Once we have determined a coset\nleader for each coset, the decoding process becomes a task of calculating r + e to obtain x.\nExample 8.41 In Table 8.40, notice that we have chosen a representative of the least\npossible weight for each coset.",
    "These representatives are coset leaders.",
    "Now suppose that\nr = (01111) is the received word.",
    "To decode r, we find that it is in the coset (00010)",
    "+ C;\nhence, the originally transmitted codeword must have been (01101) = (01111)",
    "+ (00010).\n",
    "□\nA potential problem with this method of decoding is that we might have to examine every\ncoset for the received codeword.",
    "The following proposition gives a method of implementing\ncoset decoding.",
    "It states that we can associate a syndrome with each coset; hence, we can\nmake a table that designates a coset leader corresponding to each syndrome.",
    "Such a list is\ncalled a decoding table.\n",
    "Table 8.42",
    "Syndromes for each coset\nSyndrome\nCoset Leader\n(000)\n(00000)\n(001)\n(00001)\n(010)\n(00010)\n(011)\n(10000)\n(100)\n(00100)\n(101)\n(01000)\n(110)\n(00110)\n(111)\n(10100)\nProposition 8.43 Let C be an (n, k)-linear code given by the matrix H and suppose that\nx and y are in Zn\n2.",
    "Then x and y are in the same coset of C if and only if Hx = Hy.",
    "That\nis, two n-tuples are in the same coset if and only if their syndromes are the same.\nProof.",
    "Two n-tuples x and y are in the same coset of C exactly when x −y ∈C; however,\nthis is equivalent to H(x −y) = 0 or",
    "Hx = Hy.\n■\nExample 8.44 Table 8.42 is a decoding table for the code C given in Example 8.39.",
    "If\nx = (01111) is received, then its syndrome can be computed to be\nHx =\n\n\n0\n1\n0\n\n.\nExamining the decoding table, we determine that the coset leader is (00010).",
    "It is now easy\nto decode the received codeword.\n",
    "□\nGiven an (n, k)-block code, the question arises of whether or not coset decoding is a\nmanageable scheme.",
    "A decoding table requires a list of cosets and syndromes, one for each\nof the 2n−k cosets of C. Suppose that we have a (32, 24)-block code.",
    "We have a huge\nnumber of codewords, 224, yet there are only 232−24 = 28 = 256 cosets.\n",
    "Sage.\n",
    "Sage has a substantial repertoire of commands for coding theory, including the\nability to build many different families of codes.\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n109\n8.5 Reading Questions\n1.\nSuppose a binary code has minimum distance d",
    "= 6.",
    "How many errors can be detected?\n",
    "How many errors can be corrected?\n2.\nExplain why it is impossible for the 8-bit string with decimal value 5610 to be an\nascii code for a character.",
    "Assume the leftmost bit of the string is being used as a\nparity-check bit.\n",
    "3.\nSuppose we receive the 8-bit string with decimal value 5610 when we are expecting\nascii characters with a parity-check bit in the first bit (leftmost).",
    "We know an error\nhas occurred in transmission.",
    "Give one of the probable guesses for the character which\nwas actually sent (other than ‘8’), under the assumption that any individual bit is\nrarely sent in error.",
    "Explain the logic of your answer.",
    "(You may need to consult a\ntable of ascii values online.)\n",
    "4.\nSuppose a linear code C is created as the null space of the parity-check matrix\nH =\n\n\n0\n1\n0\n1\n0\n1\n1\n1\n1\n0\n0\n0\n1\n1\n1\n\n\nThen x = 11100 is not a codeword.",
    "Describe a computation, and give the result of\nthat computation, which verifies that x is not a codeword of the code C.\n5.\nFor H and x as in the previous question, suppose that x is received as a message.",
    "Give\na maximum likelihood decoding of the received message.\n",
    "8.6 Exercises\n1.\nWhy is the following encoding scheme not acceptable?\nInformation\n0\n1\n2\n3\n4\n5\n6\n7\n8\nCodeword\n000\n001\n010\n011\n101\n110\n111\n000\n001\n2.\nWithout doing any addition, explain why the following set of 4-tuples in Z4\n2 cannot be\na group code.\n",
    "(0110)\n(1001)\n(1010)\n(1100)\n3.\nCompute the Hamming distances between the following pairs of n-tuples.\n",
    "(a) (011010), (011100)\n(b) (11110101), (01010100)\n(c) (00110), (01111)\n(d) (1001), (0111)\n4.\nCompute the weights of the following n-tuples.\n",
    "(a) (011010)\n(b) (11110101)\n(c) (01111)\n(d) (1011)\n5.\nSuppose that a linear code C has a minimum weight of 7.",
    "What are the error-detection\nand error-correction capabilities of C?\n6.\n",
    "In each of the following codes, what is the minimum distance for the code?",
    "What\nis the best situation we might hope for in connection with error detection and error\ncorrection?\n(a) (011010) (011100) (110111) (110000)\n(b) (011100) (011011) (111011) (100011)\n(000000) (010101) (110100) (110011)\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n110\n(c) (000000) (011100) (110101) (110001)\n(d) (0110110) (0111100) (1110000) (1111111)\n(1001001) (1000011) (0001111) (0000000)\n",
    "7.\nCompute the null space of each of the following matrices.",
    "What type of (n, k)-block\ncodes are the null spaces?",
    "Can you find a matrix (not necessarily a standard generator\nmatrix) that generates each code?",
    "Are your generator matrices unique?\n(a)\n\n\n0\n1\n0\n0\n0\n1\n0\n1\n0\n1\n1\n0\n0\n1\n0\n\n\n(b)\n\n\n\n\n\n1\n0\n1\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n1\n0\n1\n1\n0\n0\n0\n1\n\n\n\n\n\n(c)\n\u00121\n0\n0\n1\n1\n0\n1\n0\n1\n1\n\u0013\n(d)\n\n\n\n\n\n0\n0\n0\n1\n1\n1\n1\n0\n1\n1\n0\n0\n1\n1\n1\n0\n1\n0\n1\n0\n1\n0\n1\n1\n0\n0\n1\n1\n\n\n\n\n\n8.\nConstruct a (5, 2)-block code.",
    "Discuss both the error-detection and error-correction\ncapabilities of your code.\n",
    "9.\nLet C be the code obtained from the null space of the matrix\nH =\n\n\n0\n1\n0\n0\n1\n1\n0\n1\n0\n1\n0\n0\n1\n1\n1\n\n.\nDecode the message\n01111\n10101\n01110\n00011\nif possible.\n",
    "10. Suppose that a 1000-bit binary message is transmitted.",
    "Assume that the probability of\na single error is p and that the errors occurring in different bits are independent of one\nanother.",
    "If p = 0.01, what is the probability of more than one error occurring?",
    "What\nis the probability of exactly two errors occurring?",
    "Repeat this problem for p = 0.0001.\n11.",
    "Which matrices are canonical parity-check matrices?",
    "For those matrices that are canon-\nical parity-check matrices, what are the corresponding standard generator matrices?\n",
    "What are the error-detection and error-correction capabilities of the code generated by\neach of these matrices?\n(a)\n\n\n\n\n\n1\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n1\n\n\n\n\n\n(b)\n\n\n\n\n\n0\n1\n1\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n1\n0\n1\n1\n0\n0\n0\n1\n\n\n\n\n\n(c)\n",
    "\u00121\n1\n1\n0\n1\n0\n0\n1\n\u0013\n(d)\n\n\n\n\n\n0\n0\n0\n1\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n1\n0\n1\n0\n0\n1\n0\n0\n1\n1\n0\n0\n0\n1\n\n\n\n\n\n12.",
    "List all possible syndromes for the codes generated by each of the matrices in Exer-\ncise 8.6.11.\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n111\n13.",
    "Let\nH =\n\n\n0\n1\n1\n1\n1\n0\n0\n0\n1\n1\n1\n0\n1\n0\n1\n\n.\nCompute the syndrome caused by each of the following transmission errors.\n",
    "(a) An error in the first bit.\n",
    "(b) An error in the third bit.\n",
    "(c) An error in the last bit.\n",
    "(d) Errors in the third and fourth bits.\n",
    "14.",
    "Let C be the group code in Z3\n2 defined by the codewords (000) and (111).",
    "Compute\nthe cosets of C in Z3\n2.",
    "Why was there no need to specify right or left cosets?",
    "Give the\nsingle transmission error, if any, to which each coset corresponds.\n15.",
    "For each of the following matrices, find the cosets of the corresponding code C. Give\na decoding table for each code if possible.\n",
    "(a)\n\n\n0\n1\n0\n0\n0\n1\n0\n1\n0\n1\n1\n0\n0\n1\n0\n\n\n(b)\n\n\n\n\n\n0\n0\n1\n0\n0\n1\n1\n0\n1\n0\n0\n1\n0\n1\n0\n1\n1\n0\n0\n1\n\n\n\n\n\n(c)\n\u00121\n0\n0\n1\n1\n0\n1\n0\n1\n1\n\u0013\n(d)\n\n\n\n\n\n1\n0\n0\n1\n1\n1\n1\n1\n1\n1\n0\n0\n1\n1\n1\n0\n1\n0\n1\n0\n1\n1\n1\n1\n0\n0\n1\n0\n\n\n\n\n\n16.",
    "Let x, y, and z be binary n-tuples.",
    "Prove each of the following statements.\n",
    "(a) w(x) = d(x, 0)\n(b) d(x, y) = d(x + z, y + z)\n(c) d(x, y) = w(x −y)\n17.",
    "A metric on a set X is a map d : X × X →R satisfying the following conditions.\n",
    "(a) d(x, y) ≥0 for all x, y ∈X;\n(b) d(x, y) = 0 exactly when x = y;\n(c) d(x, y) = d(y, x);\n(d) d(x, y) ≤d(x, z) + d(z, y).\n",
    "In other words, a metric is simply a generalization of the notion of distance.",
    "Prove\nthat Hamming distance is a metric on Zn\n2.",
    "Decoding a message actually reduces to\ndeciding which is the closest codeword in terms of distance.\n",
    "18.",
    "Let C be a linear code.",
    "Show that either the ith coordinates in the codewords of C\nare all zeros or exactly half of them are zeros.\n19.",
    "Let C be a linear code.",
    "Show that either every codeword has even weight or exactly\nhalf of the codewords have even weight.\n20.",
    "Show that the codewords of even weight in a linear code C are also a linear code.\n\n",
    "CHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n112\n21.",
    "If we are to use an error-correcting linear code to transmit the 128 ascii characters,\nwhat size matrix must be used?\n",
    "What size matrix must be used to transmit the\nextended ascii character set of 256 characters?",
    "What if we require only error detection\nin both cases?\n22.",
    "Find the canonical parity-check matrix that gives the even parity check bit code with\nthree information positions.",
    "What is the matrix for seven information positions?",
    "What\nare the corresponding standard generator matrices?\n23.",
    "How many check positions are needed for a single error-correcting code with 20 infor-\nmation positions?",
    "With 32 information positions?\n24.",
    "Let ei be the binary n-tuple with a 1 in the ith coordinate and 0’s elsewhere and\nsuppose that H ∈Mm×n(Z2).",
    "Show that Hei is the ith column of the matrix H.\n25.",
    "Let C be an (n, k)-linear code.",
    "Define the dual or orthogonal code of C to be\nC⊥= {x ∈Zn\n2 : x · y = 0 for all y ∈C}.\n",
    "(a) Find the dual code of the linear code C where C is given by the matrix\n\n\n1\n1\n1\n0\n0\n0\n0\n1\n0\n1\n1\n0\n0\n1\n0\n\n.\n(b) Show that C⊥is an (n, n −k)-linear code.\n",
    "(c) Find the standard generator and parity-check matrices of C and C⊥.\nWhat\nhappens in general?",
    "Prove your conjecture.\n",
    "26.",
    "Let H be an m",
    "× n matrix over Z2, where the ith column is the number i written in\nbinary with m bits.",
    "The null space of such a matrix is called a Hamming code.\n",
    "(a) Show that the matrix\nH =\n\n\n0\n0\n0\n1\n1\n1\n0\n1\n1\n0\n0\n1\n1\n0\n1\n0\n1\n0\n\n\ngenerates a Hamming code.",
    "What are the error-correcting properties of a Ham-\nming code?\n(b) The column corresponding to the syndrome also marks the bit that was in error;\nthat is, the ith column of the matrix is i written as a binary number, and the\nsyndrome immediately tells us which bit is in error.\n",
    "If the received word is\n(101011), compute the syndrome.",
    "In which bit did the error occur in this case,\nand what codeword was originally transmitted?\n(c) Give a binary matrix H for the Hamming code with six information positions and\nfour check positions.",
    "What are the check positions and what are the information\npositions?",
    "Encode the messages (101101) and (001001).",
    "Decode the received\nwords (0010000101) and (0000101100).",
    "What are the possible syndromes for this\ncode?\n(d)",
    "What is the number of check bits and the number of information bits in an (m, n)-\nblock Hamming code?",
    "Give both an upper and a lower bound on the number of\ninformation bits in terms of the number of check bits.",
    "Hamming codes having\nthe maximum possible number of information bits with k check bits are called\n\nCHAPTER 8.",
    "ALGEBRAIC CODING THEORY\n113\nperfect.",
    "Every possible syndrome except 0 occurs as a column.",
    "If the number of\ninformation bits is less than the maximum, then the code is called shortened.",
    "In\nthis case, give an example showing that some syndromes can represent multiple\nerrors.\n",
    "8.7 Programming Exercises\n1.\nWrite a program to implement a (16, 12)-linear code.",
    "Your program should be able to\nencode and decode messages using coset decoding.",
    "Once your program is written, write\na program to simulate a binary symmetric channel with transmission noise.",
    "Compare\nthe results of your simulation with the theoretically predicted error probability.\n",
    "8.8 References and Suggested Readings\n[1]\nBlake, I. F. “Codes and Designs,” Mathematics Magazine 52 (1979), 81–95.\n",
    "[2]\nHill, R. A First Course in Coding Theory.",
    "Oxford University Press, Oxford, 1990.\n",
    "[3]\nLevinson, N. “Coding Theory: A Counterexample to G. H. Hardy’s Conception of\nApplied Mathematics,” American Mathematical Monthly 77 (1970), 249–58.\n",
    "[4]\nLidl, R. and Pilz, G. Applied Abstract Algebra.",
    "2nd ed.",
    "Springer, New York, 1998.\n",
    "[5]\nMacWilliams, F. J. and Sloane, N. J. A.",
    "The Theory of Error-Correcting Codes.",
    "North-\nHolland Mathematical Library, 16, Elsevier, Amsterdam, 1983.\n",
    "[6]\nRoman, S. Coding and Information Theory.",
    "Springer-Verlag, New York, 1992.\n",
    "[7]\nShannon, C. E. “A Mathematical Theory of Communication,” Bell System Technical\nJournal 27 (1948), 379–423, 623–56.\n",
    "[8]\nThompson, T. M. From Error-Correcting Codes through Sphere Packing to Simple\nGroups.",
    "Carus Monograph Series, No. 21.",
    "Mathematical Association of America,\nWashington, DC, 1983.\n",
    "[9]\nvan Lint, J. H. Introduction to Coding Theory.",
    "Springer, New York, 1999.\n\n",
    "9\nIsomorphisms\nMany groups may appear to be different at first glance, but can be shown to be the same\nby a simple renaming of the group elements.",
    "For example, Z4 and the subgroup of the\ncircle group T generated by i can be shown to be the same by demonstrating a one-to-one\ncorrespondence between the elements of the two groups and between the group operations.\n",
    "In such a case we say that the groups are isomorphic.\n",
    "9.1 Definition and Examples\nTwo groups (G, ·) and (H, ◦) are isomorphic if there exists a one-to-one and onto map\nϕ : G →H",
    "such that the group operation is preserved; that is,\nϕ(a · b) = ϕ(a) ◦ϕ(b)\nfor all a and b in G. If G is isomorphic to H, we write G ∼= H.",
    "The map ϕ is called an\nisomorphism.\n",
    "Example 9.1 To show that Z4 ∼= ⟨i⟩, define a map ϕ :",
    "Z4 →⟨i⟩by ϕ(n) = in.",
    "We must\nshow that ϕ is bijective and preserves the group operation.",
    "The map ϕ is one-to-one and\nonto because\nϕ(0) = 1\nϕ(1)",
    "= i\nϕ(2) = −1\nϕ(3)",
    "= −i.\n",
    "Since\nϕ(m + n) = im+n = imin = ϕ(m)ϕ(n),\nthe group operation is preserved.\n",
    "□\nExample 9.2 We can define an isomorphism ϕ from the additive group of real numbers\n(R, +) to the multiplicative group of positive real numbers (R+, ·) with the exponential map;\nthat is,\nϕ(x + y)",
    "= ex+y = exey = ϕ(x)ϕ(y).\n",
    "Of course, we must still show that ϕ is one-to-one and onto, but this can be determined\nusing calculus.\n",
    "□\n114\n\nCHAPTER 9.",
    "ISOMORPHISMS\n115\nExample 9.3",
    "The integers are isomorphic to the subgroup of Q∗consisting of elements of\nthe form 2n.",
    "Define a map ϕ : Z →Q∗by ϕ(n) = 2n.",
    "Then\nϕ(m + n) = 2m+n = 2m2n = ϕ(m)ϕ(n).\n",
    "By definition the map ϕ is onto the subset {2n : n ∈Z} of Q∗. To show that the map is\ninjective, assume that m ̸= n.",
    "If we can show that ϕ(m) ̸= ϕ(n), then we are done.",
    "Suppose\nthat m > n and assume that ϕ(m) = ϕ(n).",
    "Then 2m = 2n or 2m−n = 1, which is impossible\nsince m −n > 0.\n",
    "□\nExample 9.4 The groups Z8 and Z12 cannot be isomorphic since they have different orders;\nhowever, it is true that U(8) ∼= U(12).",
    "We know that\nU(8) = {1, 3, 5, 7}\nU(12) = {1, 5, 7, 11}.\n",
    "An isomorphism ϕ : U(8) →U(12) is then given by\n1 7→1\n3 7→5\n5 7→7\n7 7→11.\n",
    "The map ϕ is not the only possible isomorphism between these two groups.",
    "We could define\nanother isomorphism ψ by ψ(1) = 1, ψ(3)",
    "= 11, ψ(5)",
    "= 5, ψ(7)",
    "= 7.",
    "In fact, both of these\ngroups are isomorphic to Z2 × Z2 (see Example 3.28 in Chapter 3).\n",
    "□\nExample 9.5 Even though S3 and Z6 possess the same number of elements, we would\nsuspect that they are not isomorphic, because Z6 is abelian and S3 is nonabelian.\n",
    "To\ndemonstrate that this is indeed the case, suppose that ϕ : Z6 →S3 is an isomorphism.",
    "Let\na, b",
    "∈S3 be two elements such that ab ̸= ba.",
    "Since ϕ is an isomorphism, there exist elements\nm and n in Z6 such that\nϕ(m) = a\nand\nϕ(n)",
    "= b.\n",
    "However,\nab = ϕ(m)ϕ(n) = ϕ(m + n) = ϕ(n + m)",
    "= ϕ(n)ϕ(m) = ba,\nwhich contradicts the fact that a and b do not commute.\n",
    "□\nTheorem 9.6 Let ϕ : G →H be an isomorphism of two groups.\n",
    "Then the following\nstatements are true.\n",
    "1. ϕ−1 : H →G is an isomorphism.\n",
    "2. |G| = |H|.\n",
    "3.",
    "If G is abelian, then H is abelian.\n",
    "4.",
    "If G is cyclic, then H is cyclic.\n",
    "5.",
    "If G has a subgroup of order n, then H has a subgroup of order n.\nProof.",
    "Assertions (1) and (2) follow from the fact that ϕ is a bijection.",
    "We will prove (3)\nhere and leave the remainder of the theorem to be proved in the exercises.\n",
    "(3) Suppose that h1 and h2 are elements of H. Since ϕ is onto, there exist elements\n\nCHAPTER 9.",
    "ISOMORPHISMS\n116\ng1, g2 ∈G such that ϕ(g1)",
    "= h1 and ϕ(g2)",
    "= h2.",
    "Therefore,\nh1h2 = ϕ(g1)ϕ(g2) = ϕ(g1g2) = ϕ(g2g1) = ϕ(g2)ϕ(g1) = h2h1.\n",
    "■\nWe are now in a position to characterize all cyclic groups.\n",
    "Theorem 9.7 All cyclic groups of infinite order are isomorphic to Z.\nProof.",
    "Let G be a cyclic group with infinite order and suppose that a is a generator of G.\nDefine a map ϕ : Z →G by ϕ : n 7→an.",
    "Then\nϕ(m + n) = am+n = aman = ϕ(m)ϕ(n).\n",
    "To show that ϕ is injective, suppose that m and n are two elements in Z, where m",
    "̸= n.",
    "We\ncan assume that m > n.",
    "We must show that am ̸= an.",
    "Let us suppose the contrary; that\nis, am = an.",
    "In this case am−n = e, where m −n > 0, which contradicts the fact that a\nhas infinite order.",
    "Our map is onto since any element in G can be written as an for some\ninteger n and ϕ(n) = an.\n",
    "■\nTheorem 9.8 If G is a cyclic group of order n, then G is isomorphic to Zn.\nProof.",
    "Let G be a cyclic group of order n generated by a and define a map ϕ :",
    "Zn →G\nby ϕ : k 7→ak, where 0 ≤k < n.\n",
    "The proof that ϕ is an isomorphism is one of the\nend-of-chapter exercises.\n",
    "■\nCorollary 9.9 If G is a group of order p, where p is a prime number, then G is isomorphic\nto Zp.\nProof.",
    "The proof is a direct result of Corollary 6.12.\n■\nThe main goal in group theory is to classify all groups; however, it makes sense to\nconsider two groups to be the same if they are isomorphic.",
    "We state this result in the\nfollowing theorem, whose proof is left as an exercise.\n",
    "Theorem 9.10",
    "The isomorphism of groups determines an equivalence relation on the class\nof all groups.\n",
    "Hence, we can modify our goal of classifying all groups to classifying all groups up to\nisomorphism; that is, we will consider two groups to be the same if they are isomorphic.\n",
    "Cayley’s Theorem\nCayley proved that if G is a group, it is isomorphic to a group of permutations on some set;\nhence, every group is a permutation group.",
    "Cayley’s Theorem is what we call a represen-\ntation theorem.",
    "The aim of representation theory is to find an isomorphism of some group\nG that we wish to study into a group that we know a great deal about, such as a group of\npermutations or matrices.\n",
    "Example 9.11 Consider the group Z3.",
    "The Cayley table for Z3 is as follows.\n",
    "+\n0\n1\n2\n0\n0\n1\n2\n1\n1\n2\n0\n2\n2\n0\n1\nThe addition table of Z3 suggests that it is the same as the permutation group G =\n\nCHAPTER 9.",
    "ISOMORPHISMS\n117\n{(0), (012), (021)}.",
    "The isomorphism here is\n0 7→\n\u00120\n1\n2\n0\n1\n2\n\u0013\n= (0)\n1 7→\n\u00120\n1\n2\n1\n2\n0\n\u0013\n= (0 1 2)\n",
    "2 7→\n\u00120\n1\n2\n2\n0\n1\n\u0013\n= (0 2 1).\n",
    "□\nTheorem 9.12 Cayley.",
    "Every group is isomorphic to a group of permutations.\n",
    "Proof.",
    "Let G be a group.",
    "We must find a group of permutations G that is isomorphic\nto G. For any g ∈G, define a function λg : G →G by λg(a)",
    "= ga.",
    "We claim that λg is a\npermutation of G. To show that λg is one-to-one, suppose that λg(a) = λg(b).",
    "Then\nga = λg(a) = λg(b) = gb.\n",
    "Hence, a = b.",
    "To show that λg is onto, we must prove that for each a ∈G, there is a b such\nthat λg(b) = a. Let b = g−1a.\n",
    "Now we are ready to define our group G. Let\nG = {λg : g ∈G}.\n",
    "We must show that G is a group under composition of functions and find an isomorphism\nbetween G and G. We have closure under composition of functions since\n(λg ◦λh)(a) = λg(ha) = gha = λgh(a).\n",
    "Also,\nλe(a) = ea = a\nand\n(λg−1 ◦λg)(a) = λg−1(ga) = g−1ga = a = λe(a).\n",
    "We can define an isomorphism from G to G by ϕ : g 7→λg.",
    "The group operation is\npreserved since\nϕ(gh)",
    "= λgh = λgλh = ϕ(g)ϕ(h).\n",
    "It is also one-to-one, because if ϕ(g)(a) = ϕ(h)(a), then\nga = λga = λha = ha.\n",
    "Hence, g = h. That ϕ is onto follows from the fact that ϕ(g)",
    "= λg for any λg ∈G.\n■\nThe isomorphism g 7→λg is known as the left regular representation of G.\nHistorical Note\nArthur Cayley was born in England in 1821, though he spent much of the first part of his\nlife in Russia, where his father was a merchant.",
    "Cayley was educated at Cambridge, where\nhe took the first Smith’s Prize in mathematics.",
    "A lawyer for much of his adult life, he\nwrote several papers in his early twenties before entering the legal profession at the age of\n25.",
    "While practicing law he continued his mathematical research, writing more than 300\npapers during this period of his life.",
    "These included some of his best work.",
    "In 1863 he left\n\nCHAPTER 9.",
    "ISOMORPHISMS\n118\nlaw to become a professor at Cambridge.",
    "Cayley wrote more than 900 papers in fields such\nas group theory, geometry, and linear algebra.",
    "His legal knowledge was very valuable to\nCambridge; he participated in the writing of many of the university’s statutes.",
    "Cayley was\nalso one of the people responsible for the admission of women to Cambridge.\n",
    "9.2 Direct Products\nGiven two groups G and H, it is possible to construct a new group from the Cartesian\nproduct of G and H, G × H. Conversely, given a large group, it is sometimes possible to\ndecompose the group; that is, a group is sometimes isomorphic to the direct product of\ntwo smaller groups.",
    "Rather than studying a large group G, it is often easier to study the\ncomponent groups of G.\nExternal Direct Products\nIf (G, ·) and (H, ◦) are groups, then we can make the Cartesian product of G and H into a\nnew group.",
    "As a set, our group is just the ordered pairs (g, h) ∈G ×",
    "H where g ∈G and\nh ∈H.",
    "We can define a binary operation on G × H by\n(g1, h1)(g2, h2) = (g1 · g2, h1 ◦h2);\nthat is, we just multiply elements in the first coordinate as we do in G and elements in the\nsecond coordinate as we do in H. We have specified the particular operations · and ◦in\neach group here for the sake of clarity; we usually just write (g1, h1)(g2, h2) =",
    "(g1g2, h1h2).\n",
    "Proposition 9.13 Let G and H be groups.",
    "The set G × H is a group under the operation\n(g1, h1)(g2, h2)",
    "= (g1g2, h1h2) where g1, g2 ∈G and h1, h2 ∈H.\nProof.",
    "Clearly the binary operation defined above is closed.",
    "If eG and eH are the identities\nof the groups G and H respectively, then (eG, eH) is the identity of G ×",
    "H. The inverse of\n(g, h) ∈G ×",
    "H is (g−1, h−1).",
    "The fact that the operation is associative follows directly from\nthe associativity of G and H.\n■\nExample 9.14 Let R be the group of real numbers under addition.",
    "The Cartesian product\nof R with itself, R×R = R2, is also a group, in which the group operation is just addition in\neach coordinate; that is, (a, b) +",
    "(c, d) = (a + c, b + d).",
    "The identity is (0, 0) and the inverse\nof (a, b) is (−a, −b).\n",
    "□\nExample 9.15 Consider\nZ2 ×",
    "Z2 = {(0, 0), (0, 1), (1, 0), (1, 1)}.\n",
    "Although Z2 × Z2 and Z4 both contain four elements, they are not isomorphic.\n",
    "Every\nelement (a, b) in Z2 ×",
    "Z2 other than the identity has order 2,",
    "since (a, b) + (a, b) = (0, 0);\nhowever, Z4 is cyclic.\n",
    "□\nThe group G × H is called the external direct product of G and H. Notice that there\nis nothing special about the fact that we have used only two groups to build a new group.\n",
    "The direct product\nn\nY\ni=1\nGi = G1 ×",
    "G2 × · · · ×",
    "Gn\nof the groups G1, G2, . .",
    ".",
    ", Gn is defined in exactly the same manner.",
    "If G = G1 = G2 =\n· · · = Gn, we often write Gn instead of G1 ×",
    "G2 × · · · ×",
    "Gn.\n\nCHAPTER 9.",
    "ISOMORPHISMS\n119\nExample 9.16",
    "The group Zn\n2, considered as a set, is just the set of all binary n-tuples.\n",
    "The group operation is the “exclusive or” of two binary n-tuples.",
    "For example,\n(01011101) + (01001011) = (00010110).\n",
    "This group is important in coding theory, in cryptography, and in many areas of computer\nscience.\n",
    "□\nTheorem 9.17 Let (g, h) ∈G × H.",
    "If g and h have finite orders r and s respectively, then\nthe order of (g, h) in G ×",
    "H is the least common multiple of r and s.\nProof.",
    "Suppose that m is the least common multiple of r and s and let n = |(g, h)|.",
    "Then\n(g, h)m = (gm, hm) = (eG, eH)\n(gn, hn) = (g, h)n = (eG, eH).\n",
    "Hence, n must divide m, and n ≤m.",
    "However, by the second equation, both r and s must\ndivide n; therefore, n is a common multiple of r and s. Since m is the least common multiple\nof r and s, m ≤n.",
    "Consequently, m must be equal to n.\n■\nCorollary 9.18 Let (g1, . . .",
    ", gn) ∈Q Gi.",
    "If gi has finite order ri in Gi, then the order of\n(g1, . . .",
    ", gn) in Q Gi is the least common multiple of r1, . . .",
    ", rn.\n",
    "Example 9.19 Let (8, 56) ∈Z12 × Z60.",
    "Since gcd(8, 12) = 4, the order of 8 is 12/4 = 3 in\nZ12.",
    "Similarly, the order of 56 in Z60 is 15.",
    "The least common multiple of 3 and 15 is 15;\nhence, (8, 56) has order 15 in Z12 ×",
    "Z60.\n",
    "□\nExample 9.20",
    "The group Z2 × Z3 consists of the pairs\n(0, 0),\n(0, 1),\n(0, 2),\n(1, 0),\n(1, 1),\n(1, 2).\n",
    "In this case, unlike that of Z2 × Z2 and Z4, it is true that Z2 ×",
    "Z3 ∼= Z6.",
    "We need only show\nthat Z2 × Z3 is cyclic.",
    "It is easy to see that (1, 1) is a generator for Z2 × Z3.\n",
    "□\nThe next theorem tells us exactly when the direct product of two cyclic groups is cyclic.\n",
    "Theorem 9.21",
    "The group Zm ×",
    "Zn is isomorphic to Zmn if and only if gcd(m, n) = 1.\nProof.",
    "We will first show that if Zm ×",
    "Zn ∼= Zmn, then gcd(m, n) = 1.",
    "We will prove the\ncontrapositive; that is, we will show that if gcd(m, n) = d > 1, then Zm×Zn cannot be cyclic.\n",
    "Notice that mn/d is divisible by both m and n; hence, for any element (a, b) ∈Zm ×",
    "Zn,\n(a, b) + (a, b) + · · · + (a, b)\n|\n{z\n}\nmn/d times\n= (0, 0).\n",
    "Therefore, no (a, b) can generate all of Zm ×",
    "Zn.\n",
    "The converse follows directly from Theorem 9.17 since lcm(m, n) = mn if and only if\ngcd(m, n) = 1.\n",
    "■\nCorollary 9.22 Let n1, . .",
    ".",
    ", nk be positive integers.",
    "Then\nk\nY\ni=1\nZni ∼= Zn1···nk\nif and only if gcd(ni, nj) = 1 for i ̸= j.\n",
    "Corollary 9.23 If\nm = pe1\n1 · · · pek\nk ,\n\nCHAPTER 9.",
    "ISOMORPHISMS\n120\nwhere the pis are distinct primes, then\n",
    "Zm ∼= Zpe1\n1 × · · · × Zp\nek\nk .\nProof.",
    "Since the greatest common divisor of pei\ni and pej\nj\nis 1 for i ̸= j, the proof follows\nfrom Corollary 9.22.\n",
    "■\nIn Chapter 13, we will prove that all finite abelian groups are isomorphic to direct\nproducts of the form\nZpe1\n1 × · · · ×",
    "Zp\nek\nk\nwhere p1, . .",
    ".",
    ", pk are (not necessarily distinct) primes.\n",
    "Internal Direct Products\nThe external direct product of two groups builds a large group out of two smaller groups.\n",
    "We would like to be able to reverse this process and conveniently break down a group into\nits direct product components; that is, we would like to be able to say when a group is\nisomorphic to the direct product of two of its subgroups.\n",
    "Let G be a group with subgroups H and K satisfying the following conditions.\n",
    "• G = HK = {hk : h ∈H, k ∈K};\n• H ∩K = {e};\n• hk = kh for all k ∈K and h ∈H.\nThen G is the internal direct product of H and K.\nExample 9.24",
    "The group U(8) is the internal direct product of\nH = {1, 3}\nand\nK = {1, 5}.\n",
    "□\nExample 9.25",
    "The dihedral group D6 is an internal direct product of its two subgroups\nH = {id, r3}\nand\nK = {id, r2, r4, s, r2s, r4s}.\n",
    "It can easily be shown that K ∼= S3; consequently, D6 ∼= Z2 × S3.\n",
    "□\nExample 9.26 Not every group can be written as the internal direct product of two of its\nproper subgroups.",
    "If the group S3 were an internal direct product of its proper subgroups\nH and K, then one of the subgroups, say H, would have to have order 3.",
    "In this case H is\nthe subgroup {(1), (123), (132)}.",
    "The subgroup K must have order 2, but no matter which\nsubgroup we choose for K, the condition that hk = kh will never be satisfied for h ∈H and\nk ∈K.\n□\nTheorem 9.27 Let G be the internal direct product of subgroups H and K. Then G is\nisomorphic to H × K.\nProof.",
    "Since G is an internal direct product, we can write any element g ∈G as g = hk\nfor some h ∈H and some k ∈K. Define a map ϕ :",
    "G →H × K by ϕ(g)",
    "= (h, k).\n",
    "The first problem that we must face is to show that ϕ is a well-defined map; that is, we\nmust show that h and k are uniquely determined by g. Suppose",
    "that g = hk = h′k′.",
    "Then\nh−1h′ = k(k′)−1 is in both H and K, so it must be the identity.",
    "Therefore, h = h′ and\nk = k′, which proves that ϕ is, indeed, well-defined.\n",
    "To show that ϕ preserves the group operation, let g1 = h1k1 and g2 = h2k2 and observe\n\nCHAPTER 9.",
    "ISOMORPHISMS\n121\nthat\nϕ(g1g2) = ϕ(h1k1h2k2)\n= ϕ(h1h2k1k2)\n",
    "= (h1h2, k1k2)\n= (h1, k1)(h2, k2)\n= ϕ(g1)ϕ(g2).\n",
    "We will leave the proof that ϕ is one-to-one and onto as an exercise.\n",
    "■\nExample 9.28",
    "The group Z6 is an internal direct product isomorphic to {0, 2, 4} × {0, 3}.\n",
    "□\nWe can extend the definition of an internal direct product of G to a collection of sub-\ngroups H1, H2, . . .",
    ",",
    "Hn of G, by requiring that\n• G = H1H2 · · ·",
    "Hn = {h1h2 · · · hn : hi ∈Hi};\n•",
    "Hi ∩⟨∪j̸=iHj⟩= {e};\n• hihj = hjhi for all hi ∈Hi and hj ∈Hj.\n",
    "We will leave the proof of the following theorem as an exercise.\n",
    "Theorem 9.29 Let G be the internal direct product of subgroups Hi, where i = 1, 2, . . .",
    ", n.\n",
    "Then G is isomorphic to Q\ni Hi.\nSage.\n",
    "Sage can quickly determine if two permutation groups are isomorphic, even though\nthis should, in theory, be a very diﬀicult computation.\n",
    "9.3 Reading Questions\n1.\nDetermine the order of (1, 2) in Z4 × Z8.\n",
    "2.\nList three properties of a group that are preserved by an isomorphism.\n",
    "3.\nFind a group isomorphic to Z15 that is an external direct product of two non-trivial\ngroups.\n",
    "4.\nExplain why we can now say “the infinite cyclic group”?\n5.\nCompare and contrast external direct products and internal direct products.\n",
    "9.4 Exercises\n1.\nProve that Z ∼= nZ for n ̸= 0.\n2.\nProve that C∗is isomorphic to the subgroup of GL2(R) consisting of matrices of the\nform\n\u0012 a\nb\n−b\na\n\u0013\n.\n",
    "3.\nProve or disprove: U(8) ∼= Z4.\n",
    "4.\nProve that U(8) is isomorphic to the group of matrices\n\u00121\n0\n0\n1\n\u0013\n,\n\u00121\n0\n0\n−1\n\u0013\n,\n\u0012−1\n0\n0\n1\n\u0013\n,\n\u0012−1\n0\n0\n−1\n\u0013\n.\n\n",
    "CHAPTER 9.",
    "ISOMORPHISMS\n122\n5.\nShow that U(5) is isomorphic to U(10), but U(12) is not.\n",
    "6.\nShow that the nth roots of unity are isomorphic to Zn.\n7.\nShow that any cyclic group of order n is isomorphic to Zn.\n8.\n",
    "Prove that Q is not isomorphic to Z.\n9.\nLet G = R \\ {−1} and define a binary operation on G by\na ∗b = a + b + ab.\n",
    "Prove that G is a group under this operation.",
    "Show that (G, ∗) is isomorphic to the\nmultiplicative group of nonzero real numbers.\n10.",
    "Show that the matrices\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n",
    "\n\n\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\n\n\n\n0\n1\n0\n1\n0\n0\n0\n0\n1\n\n\n\n\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\n\n\n\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\n\n\n\n0\n1\n0\n0\n0\n1\n1\n0\n0\n\n\nform a group.",
    "Find an isomorphism of G with a more familiar group of order 6.\n11.",
    "Find five non-isomorphic groups of order 8.\n12.",
    "Prove S4 is not isomorphic to D12.\n",
    "13.",
    "Let ω = cis(2π/n) be a primitive nth root of unity.",
    "Prove that the matrices\nA =\n\u0012ω\n0\n0\nω−1\n\u0013\nand\nB =\n\u00120\n1\n1\n0\n\u0013\ngenerate a multiplicative group isomorphic to Dn.\n14.",
    "Show that the set of all matrices of the form\n\u0012±1\nk\n0\n1\n\u0013\n,\nis a group isomorphic to Dn, where all entries in the matrix are in Zn.\n15.",
    "List all of the elements of Z4 × Z2.\n",
    "16.",
    "Find the order of each of the following elements.\n",
    "(a) (3, 4) in Z4 × Z6\n(b) (6, 15, 4) in Z30 ×",
    "Z45 ×",
    "Z24\n(c) (5, 10, 15) in Z25 ×",
    "Z25 ×",
    "Z25\n(d) (8, 8, 8) in Z10 ×",
    "Z24 ×",
    "Z80\n17.",
    "Prove that D4 cannot be the internal direct product of two of its proper subgroups.\n",
    "18.",
    "Prove that the subgroup of Q∗consisting of elements of the form 2m3n for m, n ∈Z is\nan internal direct product isomorphic to Z × Z.\n19.",
    "Prove that S3 ×Z2 is isomorphic to D6.",
    "Can you make a conjecture about D2n?",
    "Prove\nyour conjecture.\n\n",
    "CHAPTER 9.",
    "ISOMORPHISMS\n123\n20.",
    "Prove or disprove: Every abelian group of order divisible by 3 contains a subgroup of\norder 3.\n21.",
    "Prove or disprove: Every nonabelian group of order divisible by 6 contains a subgroup\nof order 6.\n22.",
    "Let G be a group of order 20.",
    "If G has subgroups H and K of orders 4 and 5 respectively\nsuch that hk = kh for all h ∈H and k ∈K, prove that G is the internal direct product\nof H and K.\n23.",
    "Prove or disprove the following assertion.",
    "Let G, H, and K be groups.",
    "If G × K ∼=\nH × K, then G ∼= H.\n24.",
    "Prove or disprove: There is a noncyclic abelian group of order 51.\n25.",
    "Prove or disprove: There is a noncyclic abelian group of order 52.\n26.",
    "Let ϕ : G →H be a group isomorphism.",
    "Show that ϕ(x) = eH if and only if x = eG,\nwhere eG and eH are the identities of G and H, respectively.\n27.",
    "Let G ∼= H. Show that if G is cyclic, then so is H.\n28.",
    "Prove that any group G of order p, p prime, must be isomorphic to Zp.\n29.",
    "Show that Sn is isomorphic to a subgroup of An+2.\n",
    "30.",
    "Prove that Dn is isomorphic to a subgroup of Sn.\n31.",
    "Let ϕ : G1 →G2 and ψ : G2 →G3 be isomorphisms.",
    "Show that ϕ−1 and ψ ◦ϕ are both\nisomorphisms.",
    "Using these results, show that the isomorphism of groups determines\nan equivalence relation on the class of all groups.\n",
    "32.",
    "Prove U(5) ∼= Z4.",
    "Can you generalize this result for U(p), where p is prime?\n33.",
    "Write out the permutations associated with each element of S3 in the proof of Cayley’s\nTheorem.\n34.",
    "An automorphism of a group G is an isomorphism with itself.",
    "Prove that complex\nconjugation is an automorphism of the additive group of complex numbers; that is,\nshow that the map ϕ(a + bi) = a −bi is an isomorphism from C to C.\n35.",
    "Prove that a + ib 7→a −ib is an automorphism of C∗.\n36.",
    "Prove that A 7→B−1AB is an automorphism of SL2(R) for all B in GL2(R).\n",
    "37.",
    "We will denote the set of all automorphisms of G by Aut(G).",
    "Prove that Aut(G) is a\nsubgroup of SG, the group of permutations of G.\n38.",
    "Find Aut(Z6).\n",
    "39.",
    "Find Aut(Z).\n",
    "40.",
    "Find two nonisomorphic groups G and H such that Aut(G) ∼= Aut(H).\n",
    "41.",
    "Let G be a group and g ∈G. Define a map ig : G →G by ig(x) = gxg−1.",
    "Prove that ig\ndefines an automorphism of G. Such an automorphism is called an inner automorphism.\n",
    "The set of all inner automorphisms is denoted by Inn(G).\n",
    "42.",
    "Prove that Inn(G) is a subgroup of Aut(G).\n",
    "43.",
    "What are the inner automorphisms of the quaternion group Q8?",
    "Is Inn(G) = Aut(G)\nin this case?\n",
    "44.",
    "Let G be a group and g ∈G. Define maps λg : G →G and ρg : G →G by λg(x) = gx\nand ρg(x)",
    "= xg−1.",
    "Show that ig = ρg ◦λg is an automorphism of G. The isomorphism\ng 7→ρg is called the right regular representation of G.\n45.",
    "Let G be the internal direct product of subgroups H and K.\nShow that the map\nϕ : G →H × K defined by ϕ(g)",
    "= (h, k) for g = hk, where h ∈H and k ∈K, is\none-to-one and onto.\n\n",
    "CHAPTER 9.",
    "ISOMORPHISMS\n124\n46.",
    "Let G and H be isomorphic groups.",
    "If G has a subgroup of order n, prove that H must\nalso have a subgroup of order n.\n47.",
    "If G ∼= G and H ∼= H, show that G × H ∼= G × H.\n48.",
    "Prove that G × H is isomorphic to H × G.\n49.",
    "Let n1, . .",
    ".",
    ", nk be positive integers.",
    "Show that\nk\nY\ni=1\nZni ∼= Zn1···nk\nif and only if gcd(ni, nj) = 1 for i ̸= j.\n50.",
    "Prove that A × B is abelian if and only if A and B are abelian.\n51.",
    "If G is the internal direct product of H1, H2, . .",
    ".",
    ", Hn, prove that G is isomorphic to\nQ\ni Hi.\n52.",
    "Let H1 and H2 be subgroups of G1 and G2, respectively.",
    "Prove that H1 ×",
    "H2 is a\nsubgroup of G1 ×",
    "G2.\n",
    "53. Let m, n ∈Z. Prove that ⟨m, n⟩= ⟨d⟩if and only if d = gcd(m, n).\n",
    "54.",
    "Let m, n ∈Z. Prove that ⟨m⟩∩⟨n⟩= ⟨l⟩if and only if l = lcm(m, n).\n",
    "55.",
    "Groups of order 2p.",
    "In this series of exercises we will classify all groups of order 2p,\nwhere p is an odd prime.\n",
    "(a) Assume G is a group of order 2p, where p is an odd prime.",
    "If a ∈G, show that\na must have order 1, 2, p, or 2p.\n",
    "(b) Suppose that G has an element of order 2p.",
    "Prove that G is isomorphic to Z2p.\n",
    "Hence, G is cyclic.\n",
    "(c) Suppose that G does not contain an element of order 2p.",
    "Show that G must\ncontain an element of order p.",
    "Hint: Assume that G does not contain an element\nof order p.\n",
    "(d) Suppose that G does not contain an element of order 2p.",
    "Show that G must\ncontain an element of order 2.\n(e) Let P be a subgroup of G with order p and y ∈G have order 2.",
    "Show that\nyP = Py.\n(f) Suppose that G does not contain an element of order 2p and P = ⟨z⟩is a subgroup\nof order p generated by z.",
    "If y is an element of order 2, then yz = zky for some\n2 ≤k < p.\n(g) Suppose that G does not contain an element of order 2p.",
    "Prove that G is not\nabelian.\n",
    "(h) Suppose that G does not contain an element of order 2p and P = ⟨z⟩is a subgroup\nof order p generated by z and y is an element of order 2.",
    "Show that we can list\nthe elements of G as {ziyj | 0",
    "≤i < p, 0 ≤j < 2}.\n",
    "(i) Suppose that G does not contain an element of order 2p and P = ⟨z⟩is a\nsubgroup of order p generated by z and y is an element of order 2.",
    "Prove that\nthe product (ziyj)(zrys) can be expressed as a uniquely as zmyn for some non\nnegative integers m, n.",
    "Thus, conclude that there is only one possibility for a\nnon-abelian group of order 2p, it must therefore be the one we have seen already,\nthe dihedral group.\n\n",
    "10\nNormal Subgroups and Factor Groups\nIf H is a subgroup of a group G, then right cosets are not always the same as left cosets;\nthat is, it is not always the case that gH",
    "= Hg for all g ∈G.",
    "The subgroups for which this\nproperty holds play a critical role in group theory—they allow for the construction of a new\nclass of groups, called factor or quotient groups.",
    "Factor groups may be studied directly or\nby using homomorphisms, a generalization of isomorphisms.",
    "We will study homomorphisms\nin Chapter 11.\n10.1 Factor Groups and Normal Subgroups\nNormal Subgroups\nA subgroup H of a group G is normal in G if gH",
    "= Hg for all g ∈G. That is, a normal\nsubgroup of a group G is one in which the right and left cosets are precisely the same.\n",
    "Example 10.1 Let G be an abelian group.",
    "Every subgroup H of G is a normal subgroup.\n",
    "Since gh = hg for all g ∈G and h ∈H, it will always be the case that gH",
    "= Hg.\n□\nExample 10.2",
    "Let H be the subgroup of S3 consisting of elements (1) and (12).",
    "Since\n(123)H = {(1 2 3), (1 3)}\nand\nH(1 2 3) = {(1 2 3), (2 3)},\nH cannot be a normal subgroup of S3.",
    "However, the subgroup N, consisting of the permu-\ntations (1), (1 2 3), and (1 3 2), is normal since the cosets of N are\nN = {(1), (1 2 3), (1 3 2)}\n(1 2)N = N(1 2) = {(1 2), (1 3), (2 3)}.\n",
    "□\nThe following theorem is fundamental to our understanding of normal subgroups.\n",
    "Theorem 10.3 Let G be a group and N be a subgroup of G.",
    "Then the following statements\nare equivalent.\n",
    "1.",
    "The subgroup N is normal in G.\n2.",
    "For all g ∈G, gNg−1 ⊂N.\n3.",
    "For all g ∈G, gNg−1 = N.\n125\n\nCHAPTER 10.",
    "NORMAL SUBGROUPS AND FACTOR GROUPS\n126\nProof.",
    "(1) ⇒(2).",
    "Since N is normal in G, gN = Ng for all g ∈G. Hence, for a given\ng ∈G and n ∈N, there exists an n′ in N such that gn = n′g.",
    "Therefore, gng−1 = n′ ∈N\nor gNg−1 ⊂N.\n(2) ⇒(3).",
    "Let g ∈G. Since gNg−1 ⊂N, we need only show N ⊂gNg−1.",
    "For n ∈N,\ng−1ng =",
    "g−1n(g−1)−1 ∈N. Hence, g−1ng = n′ for some n′ ∈N.",
    "Therefore, n = gn′g−1 is\nin gNg−1.\n",
    "(3) ⇒(1).",
    "Suppose that gNg−1 = N for all g ∈G.",
    "Then for any n ∈N there exists an\nn′ ∈N such that gng−1 = n′. Consequently, gn = n′g or gN ⊂Ng.",
    "Similarly, Ng ⊂gN.\n■\nFactor Groups\nIf N is a normal subgroup of a group G, then the cosets of N in G form a group G/N under\nthe operation (aN)(bN) = abN. This group is called the factor or quotient group of G and\n",
    "N.",
    "Our first task is to prove that G/N is indeed a group.\n",
    "Theorem 10.4 Let N be a normal subgroup of a group G.",
    "The cosets of N in G form a\ngroup G/N of order [G : N].\nProof.",
    "The group operation on G/N is (aN)(bN) = abN. This operation must be shown\nto be well-defined; that is, group multiplication must be independent of the choice of coset\nrepresentative.",
    "Let aN = bN and cN = dN. We must show that\n(aN)(cN) = acN = bdN = (bN)(dN).\n",
    "Then a = bn1 and c",
    "= dn2 for some n1 and n2 in N. Hence,\nacN = bn1dn2N\n= bn1dN\n= bn1Nd\n= bNd\n= bdN.\nThe remainder of the theorem is easy: eN = N is the identity and g−1N is the inverse of\ngN. The order of G/N is, of course, the number of cosets of N in G.\n■\nIt is very important to remember that the elements in a factor group are sets of elements\nin the original group.\n",
    "Example 10.5 Consider the normal subgroup of S3, N = {(1), (1 2 3), (1 3 2)}.",
    "The cosets\nof N in S3 are N and (12)N. The factor group S3/N has the following multiplication table.\n",
    "N\n(1 2)N\nN\nN\n(1 2)N\n(1 2)N\n(1 2)N\nN\n",
    "This group is isomorphic to Z2.",
    "At first, multiplying cosets seems both complicated and\nstrange; however, notice that S3/N is a smaller group.",
    "The factor group displays a certain\namount of information about S3.",
    "Actually, N = A3, the group of even permutations, and\n(1 2)N = {(1 2), (1 3), (2 3)} is the set of odd permutations.",
    "The information captured in\nG/N is parity; that is, multiplying two even or two odd permutations results in an even\npermutation, whereas multiplying an odd permutation by an even permutation yields an\nodd permutation.\n",
    "□\n\nCHAPTER 10.",
    "NORMAL SUBGROUPS AND FACTOR GROUPS\n127\nExample 10.6 Consider the normal subgroup 3Z of Z.",
    "The cosets of 3Z in Z are\n0 + 3Z = {. . .",
    ", −3, 0, 3, 6, . . .}\n",
    "1 + 3Z = {. . .",
    ", −2, 1, 4, 7, . . .}\n2 + 3Z = {. . .",
    ", −1, 2, 5, 8, . . .}.\n",
    "The group Z/3Z is given by the Cayley table below.\n",
    "+\n0",
    "+ 3Z\n1 + 3Z\n2 + 3Z\n0",
    "+ 3Z\n0",
    "+ 3Z\n1 + 3Z\n2 + 3Z\n1 + 3Z\n1 + 3Z\n2 + 3Z\n0",
    "+ 3Z\n2 + 3Z\n2 + 3Z\n0",
    "+ 3Z\n1 + 3Z\nIn general, the subgroup nZ of Z is normal.",
    "The cosets of Z/nZ are\nnZ\n1 + nZ\n2 + nZ\n...\n(n −1)",
    "+",
    "nZ.\nThe sum of the cosets k + nZ and l + nZ is k + l + nZ. Notice that we have written our\ncosets additively, because the group operation is integer addition.\n",
    "□\nExample 10.7 Consider the dihedral group Dn, generated by the two elements r and s,\nsatisfying the relations\nrn = id\ns2 = id\nsrs = r−1.\n",
    "The element r actually generates the cyclic subgroup of rotations, Rn, of Dn.",
    "Since srs−1 =\nsrs = r−1 ∈Rn, the group of rotations is a normal subgroup of Dn; therefore, Dn/Rn is a\ngroup.",
    "Since there are exactly two elements in this group, it must be isomorphic to Z2.\n",
    "□\n10.2 The Simplicity of the Alternating Group\nOf special interest are groups with no nontrivial normal subgroups.",
    "Such groups are called\nsimple groups.\n",
    "Of course, we already have a whole class of examples of simple groups, Zp,\nwhere p is prime.",
    "These groups are trivially simple since they have no proper subgroups\nother than the subgroup consisting solely of the identity.",
    "Other examples of simple groups\nare not so easily found.",
    "We can, however, show that the alternating group, An, is simple\nfor n ≥5.",
    "The proof of this result requires several lemmas.\n",
    "Lemma 10.8 The alternating group An is generated by 3-cycles for n ≥3.\nProof.\n",
    "To show that the 3-cycles generate An, we need only show that any pair of\ntranspositions can be written as the product of 3-cycles.",
    "Since (a, b) = (b, a), every pair of\ntranspositions must be one of the following:\n(a, b)(a, b) = id\n(a, b)(c, d) = (a, c, b)(a, c, d)\n\n",
    "CHAPTER 10.",
    "NORMAL SUBGROUPS AND FACTOR GROUPS\n128\n(a, b)(a, c) = (a, c, b).\n",
    "■\nLemma 10.9 Let N be a normal subgroup of An, where n ≥3.",
    "If N contains a 3-cycle,\nthen N = An.\nProof.",
    "We will first show that An is generated by 3-cycles of the specific form (i, j, k),\nwhere i and j are fixed in {1, 2, . . .",
    ", n} and we let k vary.",
    "Every 3-cycle is the product of\n3-cycles of this form, since\n(i, a, j) = (i, j, a)2\n(i, a, b) = (i, j, b)(i, j, a)2\n(j, a, b) = (i, j, b)2(i, j, a)\n(a, b, c) = (i, j, a)2(i, j, c)(i, j, b)2(i, j, a).\n",
    "Now suppose that N is a nontrivial normal subgroup of An for n ≥3 such that N contains\na 3-cycle of the form (i, j, a).",
    "Using the normality of N, we see that\n[(i, j)(a, k)](i, j, a)2[(i, j)(a, k)]−1 = (i, j, k)\nis in N. Hence, N must contain all of the 3-cycles (i, j, k) for 1 ≤k ≤n.",
    "By Lemma 10.8,\nthese 3-cycles generate An; hence, N = An.\n■\nLemma 10.10 For n ≥5, every nontrivial normal subgroup N of An contains a 3-cycle.\nProof.",
    "Let σ be an arbitrary element in a normal subgroup N.",
    "There are several possible\ncycle structures for σ.\n• σ is a 3-cycle.\n",
    "• σ is the product of disjoint cycles, σ = τ(a1, a2, . . .",
    ", ar) ∈N, where r > 3.\n• σ is the product of disjoint cycles, σ = τ(a1, a2, a3)(a4, a5, a6).\n",
    "• σ = τ(a1, a2, a3), where τ is the product of disjoint 2-cycles.\n",
    "• σ = τ(a1, a2)(a3, a4), where τ is the product of an even number of disjoint 2-cycles.\n",
    "If σ is a 3-cycle, then we are done.",
    "If N contains a product of disjoint cycles, σ, and at least\none of these cycles has length greater than 3, say σ = τ(a1, a2, . .",
    ". , ar)",
    ", then\n(a1, a2, a3)σ(a1, a2, a3)−1\nis in N since N is normal; hence,\nσ−1(a1, a2, a3)σ(a1, a2, a3)−1\nis also in N. Since\nσ−1(a1, a2, a3)σ(a1, a2, a3)−1 = σ−1(a1, a2, a3)σ(a1, a3, a2)\n",
    "= (a1, a2, . .",
    ".",
    ", ar)−1τ −1(a1, a2, a3)τ(a1, a2, . .",
    ". , ar)(a1, a3, a2)\n= (a1, ar, ar−1, . .",
    ".",
    ", a2)(a1, a2, a3)(a1, a2, . . . , ar)(a1, a3, a2)\n= (a1, a3, ar),\nN must contain a 3-cycle; hence, N = An.\n\n",
    "CHAPTER 10.",
    "NORMAL SUBGROUPS AND FACTOR GROUPS\n129\nNow suppose that N contains a disjoint product of the form\nσ = τ(a1, a2, a3)(a4, a5, a6).\n",
    "Then\nσ−1(a1, a2, a4)σ(a1, a2, a4)−1 ∈N\nsince\n(a1, a2, a4)σ(a1, a2, a4)−1 ∈N.\nSo\nσ−1(a1, a2, a4)σ(a1, a2, a4)−1 =",
    "[τ(a1, a2, a3)(a4, a5, a6)]−1(a1, a2, a4)τ(a1, a2, a3)(a4, a5, a6)(a1, a2, a4)−1\n= (a4, a6, a5)(a1, a3, a2)τ −1(a1, a2, a4)τ(a1, a2, a3)(a4, a5, a6)(a1, a4, a2)\n= (a4, a6, a5)(a1, a3, a2)(a1, a2, a4)(a1, a2, a3)(a4, a5, a6)(a1, a4, a2)\n= (a1, a4, a2, a6, a3).\n",
    "So N contains a disjoint cycle of length greater than 3, and we can apply the previous case.\n",
    "Suppose N contains a disjoint product of the form σ = τ(a1, a2, a3), where τ is the\nproduct of disjoint 2-cycles.",
    "Since σ ∈N, σ2 ∈N, and\nσ2 = τ(a1, a2, a3)τ(a1, a2, a3)\n= (a1, a3, a2).\n",
    "So N contains a 3-cycle.\n",
    "The only remaining possible case is a disjoint product of the form\nσ = τ(a1, a2)(a3, a4),\nwhere τ is the product of an even number of disjoint 2-cycles.",
    "But\nσ−1(a1, a2, a3)σ(a1, a2, a3)−1\nis in N since (a1, a2, a3)σ(a1, a2, a3)−1 is in N; and so\nσ−1(a1, a2, a3)σ(a1, a2, a3)−1 = τ −1(a1, a2)(a3, a4)(a1, a2, a3)τ(a1, a2)(a3, a4)(a1, a2, a3)−1\n= (a1, a3)(a2, a4).\n",
    "Since n ≥5, we can find b ∈{1, 2, . .",
    ". , n} such that b ̸= a1, a2, a3, a4.",
    "Let µ = (a1, a3, b).\n",
    "Then\nµ−1(a1, a3)(a2, a4)µ(a1, a3)(a2, a4) ∈N\nand\nµ−1(a1, a3)(a2, a4)µ(a1, a3)(a2, a4) = (a1, ba3)(a1, a3)(a2, a4)(a1, a3, b)(a1, a3)(a2, a4)\n= (a1a3b).\n",
    "Therefore, N contains a 3-cycle.",
    "This completes the proof of the lemma.\n",
    "■\nTheorem 10.11 The alternating group, An, is simple for n ≥5.\nProof.",
    "Let N be a normal subgroup of An.",
    "By Lemma 10.10, N contains a 3-cycle.",
    "By\nLemma 10.9, N = An; therefore, An contains no proper nontrivial normal subgroups for\nn ≥5.\n",
    "■\n\nCHAPTER 10.",
    "NORMAL SUBGROUPS AND FACTOR GROUPS\n130\nSage.\n",
    "Sage can easily determine if a subgroup is normal or not.",
    "If so, it can create the\nquotient group.",
    "However, the construction creates a new permuation group, isomorphic to\nthe quotient group, so its utility is limited.\n",
    "Historical Note\nOne of the foremost problems of group theory has been to classify all simple finite groups.\n",
    "This problem is over a century old and has been solved only in the last few decades of\nthe twentieth century.",
    "In a sense, finite simple groups are the building blocks of all finite\ngroups.",
    "The first nonabelian simple groups to be discovered were the alternating groups.\n",
    "Galois was the first to prove that A5 was simple.",
    "Later, mathematicians such as C. Jordan\nand L. E. Dickson found several infinite families of matrix groups that were simple.",
    "Other\nfamilies of simple groups were discovered in the 1950s.",
    "At the turn of the century, William\nBurnside conjectured that all nonabelian simple groups must have even order.",
    "In 1963, W.\nFeit and J. Thompson proved Burnside’s conjecture and published their results in the paper\n“Solvability of Groups of Odd Order,” which appeared in the Pacific Journal of Mathematics.\n",
    "Their proof, running over 250 pages, gave impetus to a program in the 1960s and 1970s\nto classify all finite simple groups.",
    "Daniel Gorenstein was the organizer of this remarkable\neffort.",
    "One of the last simple groups was the “Monster,” discovered by R. Greiss.",
    "The\nMonster, a 196,833 × 196,833 matrix group, is one of the 26 sporadic, or special, simple\ngroups.",
    "These sporadic simple groups are groups that fit into no infinite family of simple\ngroups.",
    "Some of the sporadic groups play an important role in physics.\n",
    "10.3 Reading Questions\n1.\nLet G be the group of symmetries of an equilateral triangle, expressed as permutations\nof the vertices numbered 1, 2, 3.",
    "Let H be the subgroup H = ⟨(1 2)⟩. Build the left\nand right cosets of H in G.\n2.\n",
    "Based on your answer to the previous question, is H normal in G?",
    "Explain why or\nwhy not.\n",
    "3.\n",
    "The subgroup 8Z is normal in Z.",
    "In the factor group Z/8Z perform the computation\n(3 + 8Z)",
    "+ (7 + 8Z).\n",
    "4.\nList two statements about a group G and a subgroup H that are equivalent to “H is\nnormal in G.”\n5.\n",
    "In your own words, what is a factor group?\n10.4 Exercises\n1.\n",
    "For each of the following groups G, determine whether H is a normal subgroup of G.\n",
    "If H is a normal subgroup, write out a Cayley table for the factor group G/H.\n(a) G = S4 and H = A4\n(b) G = A5 and H = {(1), (1 2 3), (1 3 2)}\n(c) G = S4 and H = D4\n(d) G = Q8 and H = {1, −1, I, −I}\n(e) G = Z and H = 5Z\n\nCHAPTER 10.",
    "NORMAL SUBGROUPS AND FACTOR GROUPS\n131\n2.\nFind all the subgroups of D4.",
    "Which subgroups are normal?",
    "What are all the factor\ngroups of D4 up to isomorphism?\n3.\nFind all the subgroups of the quaternion group, Q8.",
    "Which subgroups are normal?\n",
    "What are all the factor groups of Q8 up to isomorphism?\n4.\n",
    "Let T be the group of nonsingular upper triangular 2 × 2 matrices with entries in R;\nthat is, matrices of the form\n\u0012a\nb\n0\nc\n\u0013\n,\nwhere a, b, c ∈R and ac ̸= 0.",
    "Let U consist of matrices of the form\n\u00121\nx\n0\n1\n\u0013\n,\nwhere x ∈R.\n(a) Show that U is a subgroup of T.\n(b) Prove that U is abelian.\n",
    "(c) Prove that U is normal in T.\n(d) Show that T/U is abelian.\n",
    "(e) Is T normal in GL2(R)?\n",
    "5.\nShow that the intersection of two normal subgroups is a normal subgroup.\n",
    "6.\n",
    "If G is abelian, prove that G/H must also be abelian.\n",
    "7.\nProve or disprove: If H is a normal subgroup of G such that H and G/H are abelian,\nthen G is abelian.\n",
    "8.\n",
    "If G is cyclic, prove that G/H must also be cyclic.\n",
    "9.\nProve or disprove: If H and G/H are cyclic, then G is cyclic.\n",
    "10.",
    "Let H be a subgroup of index 2 of a group G. Prove that H must be a normal subgroup\nof G. Conclude that Sn is not simple for n ≥3.\n11.",
    "If a group G has exactly one subgroup H of order k, prove that H is normal in G.\n12.",
    "Define the centralizer of an element g in a group G to be the set\nC(g) = {x ∈G : xg = gx}.\n",
    "Show that C(g) is a subgroup of G.",
    "If g generates a normal subgroup of G, prove that\nC(g) is normal in G.\n13.",
    "Recall that the center of a group G is the set\nZ(G) = {x ∈G :",
    "xg = gx for all g ∈G}.\n",
    "(a) Calculate the center of S3.\n",
    "(b) Calculate the center of GL2(R).\n",
    "(c) Show that the center of any group G is a normal subgroup of G.\n(d) If G/Z(G) is cyclic, show that G is abelian.\n\n",
    "CHAPTER 10.",
    "NORMAL SUBGROUPS AND FACTOR GROUPS\n132\n14.",
    "Let G be a group and let G′ = ⟨aba−1b−1⟩; that is, G′ is the subgroup of all finite prod-\nucts of elements in G of the form aba−1b−1.",
    "The subgroup G′ is called the commutator\nsubgroup of G.\n(a) Show that G′ is a normal subgroup of G.\n(b) Let N be a normal subgroup of G. Prove that G/N is abelian if and only if N\ncontains the commutator subgroup of G.\n\n11\nHomomorphisms\nOne of the basic ideas of algebra is the concept of a homomorphism, a natural generalization\nof an isomorphism.",
    "If we relax the requirement that an isomorphism of groups be bijective,\nwe have a homomorphism.\n",
    "11.1 Group Homomorphisms\nA homomorphism between groups (G, ·) and (H, ◦) is a map ϕ : G →H such that\nϕ(g1 · g2)",
    "= ϕ(g1) ◦ϕ(g2)\nfor g1, g2 ∈G. The range of ϕ in H is called the homomorphic image of ϕ.\n",
    "Two groups are related in the strongest possible way if they are isomorphic; however, a\nweaker relationship may exist between two groups.",
    "For example, the symmetric group Sn\nand the group Z2 are related by the fact that Sn can be divided into even and odd permu-\ntations that exhibit a group structure like that Z2, as shown in the following multiplication\ntable.\n",
    "even\nodd\neven\neven\nodd\nodd\nodd\neven\nWe use homomorphisms to study relationships such as the one we have just described.\n",
    "Example 11.1 Let G be a group and g ∈G. Define a map ϕ : Z →G by ϕ(n) = gn.",
    "Then\nϕ is a group homomorphism, since\nϕ(m + n) = gm+n = gmgn = ϕ(m)ϕ(n).\n",
    "This homomorphism maps Z onto the cyclic subgroup of G generated by g.\n□\nExample 11.2 Let G = GL2(R).",
    "If\nA =\n\u0012a\nb\nc\nd\n\u0013\nis in G, then the determinant is nonzero; that is, det(A) = ad −bc ̸= 0.",
    "Also, for any two\nelements A and B in G, det(AB) = det(A) det(B).",
    "Using the determinant, we can define a\nhomomorphism ϕ : GL2(R)",
    "→R∗by",
    "A 7→det(A).\n",
    "□\n133\n\nCHAPTER 11.",
    "HOMOMORPHISMS\n134\nExample 11.3 Recall that the circle group T consists of all complex numbers z such that\n|z| = 1.",
    "We can define a homomorphism ϕ from the additive group of real numbers R to T\nby ϕ :",
    "θ 7→cos θ",
    "+ i sin θ.",
    "Indeed,\nϕ(α + β) = cos(α + β)",
    "+",
    "i sin(α + β)\n= (cos α cos β −sin α sin β) + i(sin α cos β",
    "+ cos α sin β)\n",
    "= (cos α + i sin α)(cos β",
    "+ i sin β)\n= ϕ(α)ϕ(β).\n",
    "Geometrically, we are simply wrapping the real line around the circle in a group-theoretic\nfashion.\n",
    "□\nThe following proposition lists some basic properties of group homomorphisms.\n",
    "Proposition 11.4 Let ϕ : G1 →G2 be a homomorphism of groups.",
    "Then\n1.",
    "If e is the identity of G1, then ϕ(e) is the identity of G2;\n2.",
    "For any element g ∈G1, ϕ(g−1) =",
    "[ϕ(g)]−1;\n3.",
    "If H1 is a subgroup of G1, then ϕ(H1) is a subgroup of G2;\n4.",
    "If H2 is a subgroup of G2, then ϕ−1(H2)",
    "= {g ∈G1 : ϕ(g) ∈H2} is a subgroup of G1.\n",
    "Furthermore, if H2 is normal in G2, then ϕ−1(H2) is normal in G1.\nProof.",
    "(1) Suppose that e and e′ are the identities of G1 and G2, respectively; then\ne′ϕ(e)",
    "= ϕ(e)",
    "= ϕ(ee)",
    "= ϕ(e)ϕ(e).\n",
    "By cancellation, ϕ(e) = e′.\n(2) This statement follows from the fact that\nϕ(g−1)ϕ(g) = ϕ(g−1g) = ϕ(e)",
    "= e′.\n(3) The set ϕ(H1) is nonempty since the identity of G2 is in ϕ(H1).",
    "Suppose that H1\nis a subgroup of G1 and let x and y be in ϕ(H1).",
    "There exist elements a, b ∈H1 such that\nϕ(a) = x and ϕ(b) = y.",
    "Since\nxy−1 = ϕ(a)[ϕ(b)]−1 = ϕ(ab−1) ∈ϕ(H1),\nϕ(H1) is a subgroup of G2 by Proposition 3.31.\n",
    "(4) Let H2 be a subgroup of G2 and define H1 to be ϕ−1(H2); that is, H1 is the set of\nall g ∈G1 such that ϕ(g) ∈H2.",
    "The identity is in H1 since ϕ(e)",
    "= e′.",
    "If a and b are in H1,\nthen ϕ(ab−1)",
    "= ϕ(a)[ϕ(b)]−1 is in H2 since H2 is a subgroup of G2.",
    "Therefore, ab−1 ∈H1\nand H1 is a subgroup of G1.",
    "If H2 is normal in G2, we must show that g−1hg ∈H1 for\nh ∈H1 and g ∈G1.",
    "But\nϕ(g−1hg)",
    "=",
    "[ϕ(g)]−1ϕ(h)ϕ(g) ∈H2,\nsince H2 is a normal subgroup of G2.",
    "Therefore, g−1hg ∈H1.\n",
    "■\nLet ϕ : G →H be a group homomorphism and suppose that e is the identity of H. By\nProposition 11.4, ϕ−1({e}) is a subgroup of G. This subgroup is called the kernel of ϕ and\nwill be denoted by ker ϕ.",
    "In fact, this subgroup is a normal subgroup of G since the trivial\nsubgroup is normal in H. We state this result in the following theorem, which says that\nwith every homomorphism of groups we can naturally associate a normal subgroup.\n\n",
    "CHAPTER 11.",
    "HOMOMORPHISMS\n135\nTheorem 11.5 Let ϕ : G →H be a group homomorphism.",
    "Then the kernel of ϕ is a\nnormal subgroup of G.\nExample 11.6 Let us examine the homomorphism ϕ : GL2(R) →R∗defined by A 7→\ndet(A).",
    "Since 1 is the identity of R∗, the kernel of this homomorphism is all 2 × 2 matrices\nhaving determinant one.",
    "That is, ker ϕ = SL2(R).\n",
    "□\nExample 11.7 The kernel of the group homomorphism ϕ : R →C∗defined by ϕ(θ)",
    "=\ncos θ + i sin θ is {2πn : n ∈Z}.",
    "Notice that ker ϕ ∼= Z.\n□\nExample 11.8 Suppose that we wish to determine all possible homomorphisms ϕ from Z7\nto Z12.",
    "Since the kernel of ϕ must be a subgroup of Z7, there are only two possible kernels,\n{0} and all of Z7.",
    "The image of a subgroup of Z7 must be a subgroup of Z12.",
    "Hence, there\nis no injective homomorphism; otherwise, Z12 would have a subgroup of order 7, which\nis impossible.",
    "Consequently, the only possible homomorphism from Z7 to Z12 is the one\nmapping all elements to zero.\n",
    "□\nExample 11.9 Let G be a group.",
    "Suppose that g ∈G and ϕ is the homomorphism from Z\nto G given by ϕ(n) = gn.",
    "If the order of g is infinite, then the kernel of this homomorphism\nis {0} since ϕ maps Z onto the cyclic subgroup of G generated by g.",
    "However, if the order\nof g is finite, say n, then the kernel of ϕ is nZ.\n□\n11.2 The Isomorphism Theorems\nAlthough it is not evident at first, factor groups correspond exactly to homomorphic images,\nand we can use factor groups to study homomorphisms.",
    "We already know that with every\ngroup homomorphism ϕ :",
    "G →H we can associate a normal subgroup of G, ker ϕ.",
    "The con-\nverse is also true; that is, every normal subgroup of a group G gives rise to homomorphism\nof groups.\n",
    "Let H be a normal subgroup of G. Define the natural or canonical homomorphism\nϕ : G →G/H\nby\nϕ(g)",
    "= gH.\nThis is indeed a homomorphism, since\nϕ(g1g2) = g1g2H = g1Hg2H = ϕ(g1)ϕ(g2).\n",
    "The kernel of this homomorphism is H. The following theorems describe the relationships\nbetween group homomorphisms, normal subgroups, and factor groups.\n",
    "Theorem 11.10 First Isomorphism Theorem.",
    "If ψ : G →H is a group homomorphism\nwith K = ker ψ, then K is normal in G. Let ϕ : G →G/K be the canonical homomorphism.\n",
    "Then there exists a unique isomorphism η : G/K →ψ(G) such that ψ = ηϕ.\nProof.",
    "We already know that K is normal in G. Define η : G/K →ψ(G) by η(gK) = ψ(g).\n",
    "We first show that η is a well-defined map.",
    "If g1K = g2K, then for some k ∈K, g1k = g2;\nconsequently,\nη(g1K) = ψ(g1)",
    "= ψ(g1)ψ(k) = ψ(g1k) = ψ(g2)",
    "= η(g2K).\n",
    "Thus, η does not depend on the choice of coset representatives and the map η : G/K →ψ(G)\nis uniquely defined since ψ = ηϕ.",
    "We must also show that η is a homomorphism.",
    "Indeed,\nη(g1Kg2K) = η(g1g2K)\n\nCHAPTER 11.",
    "HOMOMORPHISMS\n136\n= ψ(g1g2)\n= ψ(g1)ψ(g2)\n= η(g1K)η(g2K).\n",
    "Clearly, η is onto ψ(G).",
    "To show that η is one-to-one, suppose that η(g1K) = η(g2K).\n",
    "Then ψ(g1) = ψ(g2).",
    "This implies that ψ(g−1\n1 g2) = e, or g−1\n1 g2 is in the kernel of ψ; hence,\ng−1\n1 g2K = K; that is, g1K = g2K.\n■\nMathematicians often use diagrams called commutative diagrams to describe such the-\norems.",
    "The following diagram “commutes” since ψ = ηϕ.\nG\nH\nG/K\nψ\nϕ\nη\nExample 11.11 Let G be a cyclic group with generator g. Define a map ϕ : Z →G by\nn 7→gn.",
    "This map is a surjective homomorphism since\nϕ(m + n) = gm+n = gmgn = ϕ(m)ϕ(n).\n",
    "Clearly ϕ is onto.",
    "If |g| = m, then gm = e. Hence, ker ϕ = mZ and Z/",
    "ker ϕ = Z/mZ ∼= G.\n",
    "On the other hand, if the order of g is infinite, then ker ϕ = 0 and ϕ is an isomorphism of\nG and Z.",
    "Hence, two cyclic groups are isomorphic exactly when they have the same order.\n",
    "Up to isomorphism, the only cyclic groups are Z and Zn.\n□\nTheorem 11.12\nSecond Isomorphism Theorem.",
    "Let H be a subgroup of a group G\n(not necessarily normal in G) and N a normal subgroup of G.",
    "Then HN is a subgroup of\nG, H ∩N is a normal subgroup of H, and\nH/H ∩N ∼= HN/N.\nProof.",
    "We will first show that HN = {hn : h ∈H, n ∈N} is a subgroup of G. Suppose\nthat h1n1, h2n2 ∈HN.",
    "Since N is normal, (h2)−1n1h2 ∈N. So\n(h1n1)(h2n2) = h1h2((h2)−1n1h2)n2\nis in HN.",
    "The inverse of hn ∈HN is in HN since\n(hn)−1 = n−1h−1 = h−1(hn−1h−1).\n",
    "Next, we prove that H ∩N is normal in H.\nLet h ∈H and n ∈H ∩N.\n",
    "Then\nh−1nh ∈H since each element is in H. Also, h−1nh ∈N since N is normal in G; therefore,\nh−1nh ∈H ∩N.\nNow define a map ϕ from H to HN/N by h 7→hN.",
    "The map ϕ is onto, since any coset\nhnN = hN is the image of h in H. We also know that ϕ is a homomorphism",
    "because\nϕ(hh′) = hh′N = hNh′N = ϕ(h)ϕ(h′).\n",
    "By the First Isomorphism Theorem, the image of ϕ is isomorphic to H/ ker ϕ; that is,\nHN/N = ϕ(H) ∼= H/ ker ϕ.\n\nCHAPTER 11.",
    "HOMOMORPHISMS\n137\nSince\nker ϕ",
    "= {h ∈H : h ∈N} = H ∩N,\nHN/N = ϕ(H) ∼= H/H ∩N.\n■\nTheorem 11.13\nCorrespondence Theorem.",
    "Let N be a normal subgroup of a group\nG.",
    "Then H 7→H/N is a one-to-one correspondence between the set of subgroups H of G\ncontaining N and the set of subgroups of G/N. Furthermore, the normal subgroups of G\ncontaining N correspond to normal subgroups of G/N.\nProof.",
    "Let H be a subgroup of G containing N. Since N is normal in H, H/N is a factor\ngroup.",
    "Let aN and bN be elements of H/N. Then (aN)(b−1N) = ab−1N ∈H/N; hence,\nH/N is a subgroup of G/N.\nLet S be a subgroup of G/N. This subgroup is a set of cosets of N.",
    "If H = {g ∈G :\ngN ∈S}, then for h1, h2 ∈H, we have that (h1N)(h2N) =",
    "h1h2N ∈S and h−1\n1 N ∈S.\nTherefore, H must be a subgroup of G. Clearly, H contains N. Therefore, S = H/N.\nConsequently, the map H 7→H/N is onto.\n",
    "Suppose that H1 and H2 are subgroups of G containing N",
    "such that H1/N = H2/N.\nIf h1 ∈H1, then h1N ∈H1/N. Hence, h1N = h2N ⊂H2 for some h2 in H2.",
    "However,\nsince N is contained in H2, we know that h1 ∈H2 or H1 ⊂H2.",
    "Similarly, H2 ⊂H1.",
    "Since\nH1 = H2, the map H 7→H/N is one-to-one.\nSuppose that H is normal in G and N is a subgroup of H.",
    "Then it is easy to verify\nthat the map G/N →G/H defined by gN",
    "7→gH is a homomorphism.",
    "The kernel of this\nhomomorphism is H/N, which proves that H/N is normal in G/N.\nConversely, suppose that H/N is normal in G/N. The homomorphism given by\nG →G/N →G/N\nH/N\nhas kernel H. Hence, H must be normal in G.\n■\nNotice that in the course of the proof of Theorem 11.13, we have also proved the following\ntheorem.\n",
    "Theorem 11.14\nThird Isomorphism Theorem.",
    "Let G be a group and N and H be\nnormal subgroups of G with N ⊂H. Then\nG/H ∼= G/N\nH/N .\n",
    "Example 11.15 By the Third Isomorphism Theorem,\nZ/mZ ∼= (Z/mnZ)/(mZ/mnZ).\n",
    "Since |Z/mnZ| = mn and |Z/mZ| = m, we have |mZ/mnZ| = n.\n□\nSage.\n",
    "Sage can create homomorphisms between groups, which can be used directly as\nfunctions, and then queried for their kernels and images.",
    "So there is great potential for\nexploring the many fundamental relationships between groups, normal subgroups, quotient\ngroups and properties of homomorphisms.\n\n",
    "CHAPTER 11.",
    "HOMOMORPHISMS\n138\n11.3 Reading Questions\n1.\nConsider the function ϕ :",
    "Z10 →Z10 defined by ϕ(x)",
    "= x + x. Prove that ϕ is a group\nhomomorphism.\n",
    "2.\nFor ϕ defined in the previous question, explain why ϕ is not a group isomorphism.\n",
    "3.\nCompare and contrast isomorphisms and homomorphisms.\n",
    "4.\nParaphrase the First Isomorphism Theorem using only words.",
    "No symbols allowed at\nall.\n5.\n",
    "“For every normal subgroup there is a homomorphism, and for every homomorphism\nthere is a normal subgroup.”",
    "Explain the (precise) basis for this (vague) statement.\n",
    "11.4 Exercises\n1.\nProve that det(AB) = det(A) det(B) for A, B ∈GL2(R).",
    "This shows that the deter-\nminant is a homomorphism from GL2(R) to R∗.\n2.\nWhich of the following maps are homomorphisms?",
    "If the map is a homomorphism,\nwhat is the kernel?\n(a) ϕ : R∗→GL2(R) defined by\nϕ(a) =\n\u00121\n0\n0\na\n\u0013\n(b) ϕ : R →GL2(R) defined by\nϕ(a) =\n\u00121\n0\na\n1\n\u0013\n(c) ϕ : GL2(R)",
    "→R defined by\nϕ\n\u0012\u0012a\nb\nc\nd\n\u0013\u0013\n= a + d\n(d) ϕ : GL2(R) →R∗defined by\nϕ\n\u0012\u0012a\nb\nc\nd\n\u0013\u0013\n= ad −bc\n(e) ϕ : M2(R) →R defined by\nϕ\n\u0012\u0012a\nb\nc\nd\n\u0013\u0013\n= b,\nwhere M2(R) is the additive group of 2 × 2 matrices with entries in R.\n3.\n",
    "Let A be an m × n matrix.\n",
    "Show that matrix multiplication, x 7→Ax, defines a\nhomomorphism ϕ :",
    "Rn →Rm.\n",
    "4.\nLet ϕ : Z →Z be given by ϕ(n) = 7n.",
    "Prove that ϕ is a group homomorphism.",
    "Find\nthe kernel and the image of ϕ.\n5.\nDescribe all of the homomorphisms from Z24 to Z18.\n",
    "6.\nDescribe all of the homomorphisms from Z to Z12.\n\n",
    "CHAPTER 11.",
    "HOMOMORPHISMS\n139\n7.\n",
    "In the group Z24, let H = ⟨4⟩and N = ⟨6⟩.\n(a) List the elements in HN (we usually write H + N for these additive groups) and\nH ∩N.\n(b) List the cosets in HN/N, showing the elements in each coset.\n",
    "(c) List the cosets in H/(H ∩N), showing the elements in each coset.\n",
    "(d) Give the correspondence between HN/N and H/(H ∩N) described in the proof\nof the Second Isomorphism Theorem.\n8.\n",
    "If G is an abelian group and n ∈N, show that ϕ : G →G defined by g 7→gn is a group\nhomomorphism.\n",
    "9.\n",
    "If ϕ : G →H is a group homomorphism and G is abelian, prove that ϕ(G) is also\nabelian.\n",
    "10.",
    "If ϕ : G →H is a group homomorphism and G is cyclic, prove that ϕ(G) is also cyclic.\n11.",
    "Show that a homomorphism defined on a cyclic group is completely determined by its\naction on the generator of the group.\n12.",
    "If a group G has exactly one subgroup H of order k, prove that H is normal in G.\n13.",
    "Prove or disprove: Q/Z ∼= Q.\n14.",
    "Let G be a finite group and N a normal subgroup of G.",
    "If H is a subgroup of G/N,\nprove that ϕ−1(H) is a subgroup in G of order |H| · |N|, where ϕ : G →G/N is the\ncanonical homomorphism.\n",
    "15.",
    "Let G1 and G2 be groups, and let H1 and H2 be normal subgroups of G1 and G2 respec-\ntively.",
    "Let ϕ : G1 →G2 be a homomorphism.",
    "Show that ϕ induces a homomorphism\nϕ : (G1/H1) →(G2/H2) if ϕ(H1) ⊂H2.\n16.",
    "If H and K are normal subgroups of G and H ∩K = {e}, prove that G is isomorphic\nto a subgroup of G/H × G/K.\n17.",
    "Let ϕ : G1 →G2 be a surjective group homomorphism.",
    "Let H1 be a normal subgroup\nof G1 and suppose that ϕ(H1) = H2.",
    "Prove or disprove that G1/H1 ∼= G2/H2.\n",
    "18.",
    "Let ϕ : G →H be a group homomorphism.",
    "Show that ϕ is one-to-one if and only if\nϕ−1(e) = {e}.\n19.",
    "Given a homomorphism ϕ : G →H define a relation ∼on G by a ∼b if ϕ(a) = ϕ(b)\nfor a, b ∈G. Show this relation is an equivalence relation and describe the equivalence\nclasses.\n",
    "11.5 Additional Exercises: Automorphisms\n1.\nLet Aut(G) be the set of all automorphisms of G; that is, isomorphisms from G to\nitself.",
    "Prove this set forms a group and is a subgroup of the group of permutations of\nG; that is, Aut(G) ≤SG.\n",
    "2.\nAn inner automorphism of G,\nig : G →G,\nis defined by the map\nig(x)",
    "= gxg−1,\nfor g ∈G. Show that ig ∈Aut(G).\n\n",
    "CHAPTER 11.",
    "HOMOMORPHISMS\n140\n3.\n",
    "The set of all inner automorphisms is denoted by Inn(G).\n",
    "Show that Inn(G) is a\nsubgroup of Aut(G).\n",
    "4.\nFind an automorphism of a group G that is not an inner automorphism.\n",
    "5.\nLet G be a group and ig be an inner automorphism of G, and define a map\nG →Aut(G)\nby\ng 7→ig.\nProve that this map is a homomorphism with image Inn(G) and kernel Z(G).",
    "Use this\nresult to conclude that\nG/Z(G) ∼= Inn(G).\n",
    "6.\nCompute Aut(S3) and Inn(S3).",
    "Do the same thing for D4.\n",
    "7.\nFind all of the homomorphisms ϕ :",
    "Z →Z.",
    "What is Aut(Z)?\n",
    "8.\nFind all of the automorphisms of Z8.",
    "Prove that Aut(Z8) ∼= U(8).\n",
    "9.\nFor k ∈Zn, define a map ϕk :",
    "Zn →Zn by a 7→ka.",
    "Prove that ϕk is a homomorphism.\n",
    "10.",
    "Prove that ϕk is an isomorphism if and only if k is a generator of Zn.\n11.",
    "Show that every automorphism of Zn is of the form ϕk, where k is a generator of Zn.\n12.",
    "Prove that ψ : U(n) →Aut(Zn) is an isomorphism, where ψ : k 7→ϕk.\n\n12\nMatrix Groups and Symmetry\nWhen Felix Klein (1849–1925) accepted a chair at the University of Erlangen, he outlined in\nhis inaugural address a program to classify different geometries.",
    "Central to Klein’s program\nwas the theory of groups: he considered geometry to be the study of properties that are\nleft invariant under transformation groups.",
    "Groups, especially matrix groups, have now\nbecome important in the study of symmetry and have found applications in such disciplines\nas chemistry and physics.",
    "In the first part of this chapter, we will examine some of the\nclassical matrix groups, such as the general linear group, the special linear group, and the\northogonal group.",
    "We will then use these matrix groups to investigate some of the ideas\nbehind geometric symmetry.\n",
    "12.1 Matrix Groups\nSome Facts from Linear Algebra\nBefore we study matrix groups, we must recall some basic facts from linear algebra.",
    "One\nof the most fundamental ideas of linear algebra is that of a linear transformation.",
    "A linear\ntransformation or linear map T :",
    "Rn →Rm is a map that preserves vector addition and\nscalar multiplication; that is, for vectors x and y in Rn and a scalar α ∈R,\nT(x + y) = T(x) + T(y)\nT(αy) = αT(y).\n",
    "An m × n matrix with entries in R represents a linear transformation from Rn to Rm.",
    "If\nwe write vectors x = (x1, . .",
    ".",
    ", xn)t and y = (y1, . . .",
    ", yn)t in Rn as column matrices, then an\nm × n matrix\nA =\n\n\n\n\n\na11\na12\n· · ·\na1n\na21\na22\n· · ·\na2n\n...\n...\n...\n...\nam1\nam2\n· · ·\namn\n\n\n\n\n\nmaps the vectors to Rm linearly by matrix multiplication.",
    "Observe that if α is a real number,\nA(x + y) = Ax +",
    "Ay\nand\nαAx = A(αx),\n141\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n142\nwhere\nx =\n\n\n\n\n\nx1\nx2\n...\n",
    "xn\n\n\n\n\n.\n",
    "We will often abbreviate the matrix A by writing (aij).\n",
    "Conversely, if T :",
    "Rn →Rm is a linear map, we can associate a matrix A with T by\nconsidering what T does to the vectors\ne1 = (1, 0, . .",
    ".",
    ", 0)t\ne2 = (0, 1, . . .",
    ", 0)t\n...\n",
    "en = (0, 0, . . .",
    ", 1)t.\n",
    "We can write any vector x = (x1, . .",
    ".",
    ", xn)t as\nx1e1",
    "+ x2e2",
    "+ · · · + xnen.\n",
    "Consequently, if\nT(e1) = (a11, a21, . . .",
    ", am1)t,\nT(e2) = (a12, a22, . . .",
    ", am2)t,\n...\nT(en) = (a1n, a2n, . . .",
    ", amn)t,\nthen\nT(x) = T(x1e1 + x2e2",
    "+ · · · + xnen)\n= x1T(e1)",
    "+",
    "x2T(e2)",
    "+ · · · + xnT(en)\n=\n n\nX\nk=1\na1kxk, . . .",
    ",\nn\nX\nk=1\namkxk\n!t\n=",
    "Ax.\nExample 12.1 If we let T : R2 →R2 be the map given by\nT(x1, x2)",
    "= (2x1 + 5x2, −4x1 + 3x2),\nthe axioms that T must satisfy to be a linear transformation are easily verified.",
    "The column\nvectors Te1 = (2, −4)t and Te2 = (5, 3)t tell us that T is given by the matrix\nA =\n\u0012 2\n5\n−4\n3\n\u0013\n.\n",
    "□\nSince we are interested in groups of matrices, we need to know which matrices have\nmultiplicative inverses.",
    "Recall that an n × n matrix",
    "A is invertible exactly when there\nexists another matrix A−1 such that AA−1 = A−1A = I, where\n",
    "I =\n\n\n\n\n\n1\n0\n· · ·\n0\n0\n1\n· · ·\n0\n...\n...\n...\n...\n0\n0\n· · ·\n1\n\n\n\n\n\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n143\nis the n × n identity matrix.",
    "From linear algebra we know that A is invertible if and only if\nthe determinant of A is nonzero.",
    "Sometimes an invertible matrix is said to be nonsingular.\n",
    "Example 12.2 If A is the matrix\n\u00122\n1\n5\n3\n\u0013\n,\nthen the inverse of A is\nA−1 =\n\u0012 3\n−1\n−5\n2\n\u0013\n.\n",
    "We are guaranteed that A−1 exists, since det(A) = 2 · 3 −5 · 1 = 1 is nonzero.\n",
    "□\nSome other facts about determinants will also prove useful in the course of this chapter.\n",
    "Let A and B be n × n matrices.",
    "From linear algebra we have the following properties of\ndeterminants.\n",
    "•",
    "The determinant is a homomorphism into the multiplicative group of real numbers;\nthat is, det(AB) = (det A)(det B).\n",
    "•",
    "If A is an invertible matrix, then det(A−1) = 1/ det A.\n• If we define the transpose of a matrix A = (aij) to be At = (aji), then det(At) = det A.\n• Let T be the linear transformation associated with an n × n matrix A.\n",
    "Then T\nmultiplies volumes by a factor of | det A|.\n",
    "In the case of R2, this means that T\nmultiplies areas by | det A|.\n",
    "Linear maps, matrices, and determinants are covered in any elementary linear algebra\ntext; however, if you have not had a course in linear algebra, it is a straightforward process\nto verify these properties directly for 2 × 2 matrices, the case with which we are most\nconcerned.\n",
    "The General and Special Linear Groups\nThe set of all n × n invertible matrices forms a group called the general linear group.\n",
    "We will denote this group by GLn(R).\n",
    "The general linear group has several important\nsubgroups.",
    "The multiplicative properties of the determinant imply that the set of matrices\nwith determinant one is a subgroup of the general linear group.",
    "Stated another way, suppose\nthat det(A) = 1 and det(B) = 1.",
    "Then det(AB) = det(A) det(B) = 1 and det(A−1) =\n1/ det",
    "A = 1.",
    "This subgroup is called the special linear group and is denoted by SLn(R).\n",
    "Example 12.3 Given a 2 × 2 matrix\nA =\n\u0012a\nb\nc\nd\n\u0013\n,\nthe determinant of A is ad −bc.",
    "The group GL2(R) consists of those matrices in which\nad −bc ̸= 0.",
    "The inverse of A is\nA−1 =\n1\nad −bc\n\u0012 d\n−b\n−c\na\n\u0013\n.\n",
    "If A is in SL2(R), then\nA−1 =\n\u0012 d\n−b\n−c\na\n\u0013\n.\n\n",
    "CHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n144\nGeometrically, SL2(R) is the group that preserves the areas of parallelograms.",
    "Let\nA =\n\u00121\n1\n0\n1\n\u0013\nbe in SL2(R).",
    "In Figure 12.4, the unit square corresponding to the vectors x = (1, 0)t\nand y = (0, 1)t is taken by A to the parallelogram with sides (1, 0)t and (1, 1)t; that is,\nAx = (1, 0)t and",
    "Ay = (1, 1)t.",
    "Notice that these two parallelograms have the same area.\n",
    "□\ny\nx\n(1, 0)\n(0, 1)\ny\nx\n(1, 0)\n(1, 1)\nFigure 12.4 SL2(R) acting on the unit square\nThe Orthogonal Group O(n)\nAnother subgroup of GLn(R) is the orthogonal group.",
    "A matrix A is orthogonal if A−1 = At.\n",
    "The orthogonal group\nconsists of the set of all orthogonal matrices.",
    "We write O(n) for\nthe n × n orthogonal group.",
    "We leave as an exercise the proof that O(n) is a subgroup of\nGLn(R).\n",
    "Example 12.5 The following matrices are orthogonal:\n\u00123/5\n−4/5\n4/5\n3/5\n\u0013\n,\n\u0012 1/2\n−\n√\n3/2\n√\n3/2\n1/2\n\u0013\n,\n\n\n−1/\n√\n2\n0\n1/\n√\n2\n1/\n√\n6\n−2/\n√\n6\n1/\n√\n6\n1/\n√\n3\n1/\n√\n3\n1/\n√\n3\n\n.\n□\nThere is a more geometric way of viewing the group O(n).",
    "The orthogonal matrices are\nexactly those matrices that preserve the length of vectors.",
    "We can define the length of a\nvector using the Euclidean inner product, or dot product, of two vectors.",
    "The Euclidean\ninner product of two vectors x = (x1, . . .",
    ", xn)t and y = (y1, . . .",
    ", yn)t is\n⟨x,",
    "y⟩= xty = (x1, x2, . .",
    ".",
    ", xn)\n\n\n\n\n\ny1\ny2\n...\nyn\n\n\n\n\n= x1y1",
    "+ · · · + xnyn.\n",
    "We define the length of a vector x = (x1, . .",
    ".",
    ", xn)t to be\n∥x∥=\np\n⟨x, x⟩=\nq\nx2\n1 + · · · + x2n.\n\n",
    "CHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n145\nAssociated with the notion of the length of a vector is the idea of the distance between two\nvectors.",
    "We define the distance between two vectors x and y to be ∥x −y∥.",
    "We leave as\nan exercise the proof of the following proposition about the properties of Euclidean inner\nproducts.\n",
    "Proposition 12.6 Let x, y, and w be vectors in Rn and α ∈R.",
    "Then\n1. ⟨x, y⟩= ⟨y, x⟩.\n2.",
    "⟨x, y + w⟩= ⟨x, y⟩+ ⟨x, w⟩.\n3.",
    "⟨αx, y⟩= ⟨x, αy⟩= α⟨x, y⟩.\n4. ⟨x, x⟩≥0 with equality",
    "exactly when x = 0.\n",
    "5.",
    "If ⟨x, y⟩= 0 for all x in Rn, then y = 0.\n",
    "Example 12.7",
    "The vector x = (3, 4)t has length\n√\n32 + 42 = 5.",
    "We can also see that the\northogonal matrix\nA =\n\u00123/5\n−4/5\n4/5\n3/5\n\u0013\npreserves the length of this vector.",
    "The vector Ax = (−7/5, 24/5)t also has length 5.\n□\nSince det(AAt) = det(I) = 1 and det(A) = det(At), the determinant of any orthogonal\nmatrix is either 1 or −1.",
    "Consider the column vectors\naj =\n\n\n\n\n\na1j\na2j\n...\nanj\n\n\n\n\n\nof the orthogonal matrix A = (aij).",
    "Since AAt = I, ⟨ar, as⟩= δrs, where\nδrs =\n(\n1\nr = s\n0\nr ̸= s\nis the Kronecker delta.",
    "Accordingly, column vectors of an orthogonal matrix all have length\n1; and the Euclidean inner product of distinct column vectors is zero.",
    "Any set of vectors\nsatisfying these properties is called an orthonormal set.",
    "Conversely, given an n × n matrix\nA whose columns form an orthonormal set, it follows that A−1 = At.\n",
    "We say that a matrix A is distance-preserving, length-preserving, or inner product-\npreserving when ∥Ax −Ay∥=",
    "∥x −y∥, ∥Ax∥= ∥x∥, or ⟨Ax, Ay⟩= ⟨x, y⟩, respectively.",
    "The\nfollowing theorem, which characterizes the orthogonal group, says that these notions are\nthe same.\n",
    "Theorem 12.8 Let A be an n × n matrix.",
    "The following statements are equivalent.\n",
    "1.",
    "The columns of the matrix A form an orthonormal set.\n",
    "2.",
    "A−1 = At.\n",
    "3.",
    "For vectors x and y, ⟨Ax, Ay⟩= ⟨x, y⟩.\n4.",
    "For vectors x and y, ∥Ax −Ay∥=",
    "∥x −y∥.\n5.",
    "For any vector x, ∥Ax∥= ∥x∥.\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n146\nProof.",
    "We have already shown (1) and (2) to be equivalent.\n",
    "(2) ⇒(3).\n",
    "⟨Ax, Ay⟩= (Ax)tAy\n= xtAtAy\n= xty\n= ⟨x, y⟩.\n(3) ⇒(2).",
    "Since\n⟨x, x⟩= ⟨Ax, Ax⟩\n= xtAtAx\n= ⟨x, AtAx⟩,\nwe know that ⟨x, (AtA −I)x⟩= 0 for all x.",
    "Therefore, AtA −I = 0 or A−1 = At.\n",
    "(3) ⇒(4).",
    "If A is inner product-preserving, then A is distance-preserving, since\n∥Ax −Ay∥2 = ∥A(x −y)∥2\n= ⟨A(x −y), A(x −y)⟩\n= ⟨x −y, x −y⟩\n= ∥x −y∥2.\n",
    "(4) ⇒(5).",
    "If A is distance-preserving, then A is length-preserving.",
    "Letting y = 0, we\nhave\n∥Ax∥= ∥Ax −Ay∥=",
    "∥x −y∥= ∥x∥.\n(5) ⇒(3).",
    "We use the following identity to show that length-preserving implies inner\nproduct-preserving:\n⟨x, y⟩= 1\n2\n\u0002\n∥x + y∥2 −∥x∥2 −∥y∥2\u0003\n.\nObserve that\n⟨Ax, Ay⟩= 1\n2\n\u0002\n∥Ax + Ay∥2 −∥Ax∥2",
    "−∥Ay∥2\u0003\n= 1\n2\n\u0002\n∥A(x + y)∥2 −∥Ax∥2 −∥Ay∥2\u0003\n= 1\n2\n\u0002\n∥x + y∥2 −∥x∥2 −∥y∥2\u0003\n= ⟨x, y⟩.\n■\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n147\nx\ny\n(a, b)\n(a, −b)\nx\ny\nθ\n(sin θ, −cos θ)\n(cos θ, sin θ)\nFigure 12.9 O(2) acting on R2\nExample 12.10 Let us examine the orthogonal group on R2 a bit more closely.",
    "An element\nA ∈O(2) is determined by its action on e1 = (1, 0)t and e2 = (0, 1)t.",
    "If Ae1 = (a, b)t, then\na2 +b2 = 1, since the length of a vector must be preserved when it is multiplied by A.",
    "Since\nmultiplication of an element of O(2) preserves length and orthogonality, Ae2 = ±(−b, a)t.\n",
    "If we choose Ae2 = (−b, a)t, then\nA =\n\u0012a\n−b\nb\na\n\u0013\n=\n\u0012cos θ\n−sin θ\nsin θ\ncos θ\n\u0013\n,\nwhere 0 ≤θ < 2π.",
    "The matrix A rotates a vector in R2 counterclockwise about the origin\nby an angle of θ (Figure 12.9).\n",
    "If we choose Ae2 = (b, −a)t, then we obtain the matrix\nB =\n\u0012a\nb\nb\n−a\n\u0013\n=\n\u0012cos θ\nsin θ\nsin θ\n−cos θ\n\u0013\n.\n",
    "Here, det B = −1 and\nB2 =\n\u00121\n0\n0\n1\n\u0013\n.\n",
    "A reflection about the horizontal axis is given by the matrix\nC =\n\u00121\n0\n0\n−1\n\u0013\n,\nand B = AC (see Figure 12.9).",
    "Thus, a reflection about a line ℓis simply a reflection about\nthe horizontal axis followed by a rotation.\n",
    "□\nTwo of the other matrix or matrix-related groups that we will consider are the special\northogonal group and the group of Euclidean motions.",
    "The special orthogonal group, SO(n),\nis just the intersection of O(n) and SLn(R); that is, those elements in O(n) with determinant\none.",
    "The Euclidean group,\nE(n), can be written as ordered pairs (A, x), where A is in\nO(n) and x is in Rn.",
    "We define multiplication by\n(A, x)(B, y) = (AB, Ay + x).\n",
    "The identity of the group is (I, 0); the inverse of (A, x) is (A−1, −A−1x).",
    "In Exercise 12.4.6,\nyou are asked to check that E(n) is indeed a group under this operation.\n\n",
    "CHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n148\nx\ny\nx\nx\ny\nx + y\nFigure 12.11 Translations in R2\n12.2 Symmetry\nAn isometry or rigid motion in Rn is a distance-preserving function f from Rn to Rn.",
    "This\nmeans that f must satisfy\n∥f(x) −f(y)∥= ∥x −y∥\nfor all x, y ∈Rn.",
    "It is not diﬀicult to show that f must be a one-to-one map.",
    "By Theo-\nrem 12.8, any element in O(n) is an isometry on Rn; however, O(n) does not include all\npossible isometries on Rn. Translation by a vector x, Ty(x)",
    "= x + y is also an isometry\n(Figure 12.11); however, T cannot be in O(n) since it is not a linear map.\n",
    "We are mostly interested in isometries in R2.",
    "In fact, the only isometries in R2 are\nrotations and reflections about the origin, translations, and combinations of the two.",
    "For\nexample, a glide reflection is a translation followed by a reflection (Figure 12.12).",
    "In Rn all\nisometries are given in the same manner.",
    "The proof is very easy to generalize.\n",
    "x\ny\nx\nx\ny\nT(x)\nFigure 12.12 Glide reflections\nLemma 12.13 An isometry f that fixes the origin in R2 is a linear transformation.",
    "In\nparticular, f is given by an element in O(2).\n",
    "Proof.",
    "Let f be an isometry in R2 fixing the origin.",
    "We will first show that f preserves\ninner products.",
    "Since f(0) = 0, ∥f(x)∥= ∥x∥; therefore,\n∥x∥2 −2⟨f(x),",
    "f(y)⟩+ ∥y∥2 = ∥f(x)∥2 −2⟨f(x), f(y)⟩+ ∥f(y)∥2\n= ⟨f(x) −f(y), f(x) −f(y)⟩\n= ∥f(x) −f(y)∥2\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n149\n= ∥x −y∥2\n= ⟨x −y, x −y⟩\n= ∥x∥2 −2⟨x, y⟩+ ∥y∥2.\n",
    "Consequently,\n⟨f(x), f(y)⟩= ⟨x, y⟩.\nNow let e1 and e2 be (1, 0)t and (0, 1)t, respectively.",
    "If\nx = (x1, x2) = x1e1",
    "+ x2e2,\nthen\nf(x) = ⟨f(x), f(e1)⟩f(e1) + ⟨f(x), f(e2)⟩f(e2) = x1f(e1)",
    "+ x2f(e2).\n",
    "The linearity of f easily follows.\n",
    "■\nFor any arbitrary isometry, f, Txf will fix the origin for some vector x in R2; hence,\nTxf(y) =",
    "Ay for some matrix A ∈O(2).",
    "Consequently, f(y)",
    "= Ay+x.",
    "Given the isometries\nf(y)",
    "=",
    "Ay + x1\ng(y) = By + x2,\ntheir composition is\nf(g(y))",
    "= f(By + x2)",
    "= ABy + Ax2 + x1.\n",
    "This last computation allows us to identify the group of isometries on R2 with E(2).\n",
    "Theorem 12.14",
    "The group of isometries on R2 is the Euclidean group, E(2).\n",
    "A symmetry group in Rn is a subgroup of the group of isometries on Rn that fixes a\nset of points X ⊂Rn.",
    "It is important to realize that the symmetry group of X depends\nboth on Rn and on X.",
    "For example, the symmetry group of the origin in R1 is Z2, but the\nsymmetry group of the origin in R2 is O(2).\n",
    "Theorem 12.15 The only finite symmetry groups in R2 are Zn and Dn.\nProof.",
    "We simply need to find all of the finite subgroups G of E(2).",
    "Any finite symmetry\ngroup G in R2 must fix the origin and must be a finite subgroup of O(2), since translations\nand glide reflections have infinite order.",
    "By Example 12.10, elements in O(2) are either\nrotations of the form\nRθ =\n\u0012cos θ\n−sin θ\nsin θ\ncos θ\n\u0013\nor reflections of the form\nTϕ =\n\u0012cos ϕ\n−sin ϕ\nsin ϕ\ncos ϕ\n\u0013",
    "\u00121\n0\n0\n−1\n\u0013\n=\n\u0012cos ϕ\nsin ϕ\nsin ϕ\n−cos ϕ\n\u0013\n.\nNotice that det(Rθ) = 1, det(Tϕ) = −1, and T 2\nϕ = I.",
    "We can divide the proof up into two\ncases.",
    "In the first case, all of the elements in G have determinant one.",
    "In the second case,\nthere exists at least one element in G with determinant −1.\n",
    "Case 1.\n",
    "The determinant of every element in G is one.",
    "In this case every element in G must\nbe a rotation.",
    "Since G is finite, there is a smallest angle, say θ0, such that the corresponding\nelement Rθ0 is the smallest rotation in the positive direction.",
    "We claim that Rθ0 generates\nG.",
    "If not, then for some positive integer n there is an angle θ1 between nθ0 and (n + 1)θ0.\n",
    "If so, then (n + 1)θ0 −θ1 corresponds to a rotation smaller than θ0, which contradicts the\nminimality of θ0.\n\n",
    "CHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n150\nCase 2.\n",
    "The group G contains a reflection T.\n",
    "The kernel of the homomorphism ϕ :\nG →{−1, 1} given by A 7→det(A) consists of elements whose determinant is 1.",
    "Therefore,\n|G/ ker ϕ| = 2.",
    "We know that the kernel is cyclic by the first case and is a subgroup of G\nof, say,",
    "order n. Hence, |G| = 2n.",
    "The elements of G are\nRθ, . .",
    ".",
    ", Rn−1\nθ\n, TRθ, . . .",
    ", TRn−1\nθ\n.\n",
    "These elements satisfy the relation\nTRθT = R−1\nθ .\n",
    "Consequently, G must be isomorphic to Dn in this case.\n",
    "■\nThe Wallpaper Groups\nSuppose that we wish to study wallpaper patterns in the plane or crystals in three dimen-\nsions.",
    "Wallpaper patterns are simply repeating patterns in the plane (Figure 12.16).",
    "The\nanalogs of wallpaper patterns in R3 are crystals, which we can think of as repeating pat-\nterns of molecules in three dimensions (Figure 12.17).",
    "The mathematical equivalent of a\nwallpaper or crystal pattern is called a lattice.\n",
    "Figure 12.16",
    "A wallpaper pattern in R2\nFigure 12.17 A crystal structure in R3\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n151\nLet us examine wallpaper patterns in the plane a little more closely.",
    "Suppose that x\nand y are linearly independent vectors in R2; that is, one vector cannot be a scalar multiple\nof the other.",
    "A lattice of x and y is the set of all linear combinations mx + ny, where m\nand n are integers.",
    "The vectors x and y are said to be a basis for the lattice.\n",
    "Notice that a lattice can have several bases.",
    "For example, the vectors (1, 1)t and (2, 0)t\nhave the same lattice as the vectors (−1, 1)t and (−1, −1)t (Figure 12.18).",
    "However, any\nlattice is completely determined by a basis.",
    "Given two bases for the same lattice, say {x1, x2}\nand {y1, y2}, we can write\ny1 = α1x1",
    "+ α2x2\ny2 = β1x1",
    "+ β2x2,\nwhere α1, α2, β1, and β2 are integers.",
    "The matrix corresponding to this transformation is\nU =\n\u0012α1\nα2\nβ1\nβ2\n\u0013\n.\n",
    "If we wish to give x1 and x2 in terms of y1 and y2, we need only calculate U−1; that is,\nU−1\n\u0012y1\ny2\n\u0013\n=\n\u0012x1\nx2\n\u0013\n.\n",
    "Since U has integer entries, U−1 must also have integer entries; hence the determinants of\nboth U and U−1 must be integers.",
    "Because UU−1 = I,\ndet(UU−1) = det(U) det(U−1) = 1;\nconsequently, det(U) = ±1.",
    "A matrix with determinant ±1 and integer entries is called\nunimodular.",
    "For example, the matrix\n\u00123\n1\n5\n2\n\u0013\nis unimodular.",
    "It should be clear that there is a minimum length for vectors in a lattice.\n",
    "(2, 0)\n(1, 1)\n(−1, 1)\n(−1, −1)\nFigure 12.18",
    "A lattice in R2\nWe can classify lattices by studying their symmetry groups.",
    "The symmetry group of\na lattice is the subgroup of E(2) that maps the lattice to itself.",
    "We consider two lattices\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n152\nin R2 to be equivalent if they have the same symmetry group.",
    "Similarly, classification of\ncrystals in R3 is accomplished by associating a symmetry group, called a space group, with\neach type of crystal.",
    "Two lattices are considered different if their space groups are not the\nsame.",
    "The natural question that now arises is how many space groups exist.\n",
    "A space group is composed of two parts: a translation subgroup and a point.\n",
    "The\ntranslation subgroup is an infinite abelian subgroup of the space group made up of the\ntranslational symmetries of the crystal; the point group is a finite group consisting of ro-\ntations and reflections of the crystal about a point.",
    "More specifically, a space group is a\nsubgroup of G ⊂E(2) whose translations are a set of the form {(I, t) : t ∈L}, where L is a\nlattice.",
    "Space groups are, of course, infinite.",
    "Using geometric arguments, we can prove the\nfollowing theorem (see [5] or [6]).\n",
    "Theorem 12.19 Every translation group in R2 is isomorphic to Z × Z.\n",
    "The point group of G is G0 = {A : (A, b) ∈G for some b}.",
    "In particular, G0 must be a\nsubgroup of O(2).",
    "Suppose that x is a vector in a lattice L with space group G, translation\ngroup H, and point group G0.",
    "For any element (A, y) in G,\n(A, y)(I, x)(A, y)−1 = (A, Ax + y)(A−1, −A−1y)\n= (AA−1, −AA−1y + Ax + y)\n= (I, Ax);\nhence, (I, Ax) is in the translation group of G. More specifically, Ax must be in the lattice\nL.",
    "It is important to note that G0 is not usually a subgroup of the space group G; however,\nif T is the translation subgroup of G, then G/T ∼= G0.",
    "The proof of the following theorem\ncan be found in [2], [5], or [6].\n",
    "Theorem 12.20",
    "The point group in the wallpaper groups is isomorphic to Zn or Dn, where\nn = 1, 2, 3, 4, 6.\nTo answer the question of how the point groups and the translation groups can be\ncombined, we must look at the different types of lattices.",
    "Lattices can be classified by the\nstructure of a single lattice cell.",
    "The possible cell shapes are parallelogram, rectangular,\nsquare, rhombic, and hexagonal (Figure 12.21).",
    "The wallpaper groups can now be classified\naccording to the types of reflections that occur in each group: these are ordinarily reflections,\nglide reflections, both, or none.\n\n",
    "CHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n153\nSquare\nRectangular\nRhombic\nParallelogram\nHexagonal\nFigure 12.21 Types of lattices in R2\nTable 12.22",
    "The 17 wallpaper groups\nNotation and\nReflections or\nSpace Groups\nPoint Group\nLattice Type\nGlide Reflections?\np1\nZ1\nparallelogram\nnone\np2\nZ2\nparallelogram\nnone\np3\nZ3\nhexagonal\nnone\np4\nZ4\nsquare\nnone\np6\nZ6\nhexagonal\nnone\npm\nD1\nrectangular\nreflections\npg\nD1\nrectangular\nglide reflections\ncm\nD1\nrhombic\nboth\npmm\nD2\nrectangular\nreflections\npmg\nD2\nrectangular\nglide reflections\npgg\nD2\nrectangular\nboth\nc2mm\nD2\nrhombic\nboth\np3m1, p31m\nD3\nhexagonal\nboth\np4m, p4g\nD4\nsquare\nboth\np6m\nD6\nhexagonal\nboth\nTheorem 12.23",
    "There are exactly 17 wallpaper groups.\n\n",
    "CHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n154\np4m\np4g\nFigure 12.24",
    "The wallpaper groups p4m and p4g\nThe 17 wallpaper groups are listed in Table 12.22.",
    "The groups p3m1 and p31m can\nbe distinguished by whether or not all of their threefold centers lie on the reflection axes:\nthose of p3m1 must, whereas those of p31m may not.",
    "Similarly, the fourfold centers of p4m\nmust lie on the reflection axes whereas those of p4g need not (Figure 12.24).",
    "The complete\nproof of this theorem can be found in several of the references at the end of this chapter,\nincluding [5], [6], [10], and [11].\n",
    "Sage.\n",
    "We have not seen how to use Sage profitably with the material in this chapter.\n",
    "Historical Note\nSymmetry groups have intrigued mathematicians for a long time.",
    "Leonardo da Vinci was\nprobably the first person to know all of the point groups.",
    "At the International Congress of\nMathematicians in 1900, David Hilbert gave a now-famous address outlining 23 problems\nto guide mathematics in the twentieth century.",
    "Hilbert’s eighteenth problem asked whether\nor not crystallographic groups in n dimensions were always finite.",
    "In 1910, L. Bieberbach\nproved that crystallographic groups are finite in every dimension.",
    "Finding out how many\nof these groups there are in each dimension is another matter.",
    "In R3 there are 230 different\nspace groups; in R4 there are 4783.\n",
    "No one has been able to compute the number of\nspace groups for R5 and beyond.",
    "It is interesting to note that the crystallographic groups\nwere found mathematically for R3 before the 230 different types of crystals were actually\ndiscovered in nature.\n",
    "12.3 Reading Questions\n1.\n",
    "What is a nonsingular matrix?",
    "Give an example of a 2 × 2 nonsingular matrix.",
    "How\ndo you know your example is nonsingular?\n",
    "2.\n",
    "What is an isometry in Rn?",
    "Can you give an example of an isometry in R2?\n3.\n",
    "What is an orthonormal set of vectors?\n4.\n",
    "What is the difference between the orthogonal group and the special orthogonal group?\n5.\n",
    "What is a lattice?\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n155\n12.4 Exercises\n1.\nProve the identity\n⟨x, y⟩= 1\n2\n\u0002\n∥x + y∥2 −∥x∥2 −∥y∥2\u0003\n.\n",
    "2.\nShow that O(n) is a group.\n",
    "3.\nProve that the following matrices are orthogonal.",
    "Are any of these matrices in SO(n)?\n(a)\n\u00121/\n√\n2\n−1/\n√\n2\n1/\n√\n2\n1/\n√\n2\n\u0013\n(b)\n\u0012",
    "1/\n√\n5\n2/\n√\n5\n−2/\n√\n5\n1/\n√\n5\n\u0013\n(c)\n\n\n4/5\n0\n3/5\n−3/5\n0\n4/5\n0\n−1\n0\n\n\n(d)\n\n\n1/3\n2/3\n−2/3\n−2/3\n2/3\n1/3\n2/3\n1/3\n2/3\n\n\n4.\nDetermine the symmetry group of each of the figures below.\n",
    "(a)\n(b)\n(c)\n5.\nLet x, y, and w be vectors in Rn and α ∈R. Prove each of the following properties of\ninner products.\n",
    "(a) ⟨x, y⟩= ⟨y, x⟩.\n(b) ⟨x, y + w⟩= ⟨x, y⟩+ ⟨x, w⟩.\n(c) ⟨αx, y⟩= ⟨x, αy⟩= α⟨x, y⟩.\n(d) ⟨x, x⟩≥0 with equality",
    "exactly when x = 0.\n(e) If ⟨x, y⟩= 0 for all x in Rn, then y = 0.\n",
    "6.\nVerify that\nE(n) = {(A, x) : A ∈O(n) and x ∈Rn}\nis a group.\n",
    "7.\nProve that {(2, 1), (1, 1)} and {(12, 5), (7, 3)} are bases for the same lattice.\n",
    "8.\nLet G be a subgroup of E(2) and suppose that T is the translation subgroup of G.\nProve that the point group of G is isomorphic to G/T.\n\nCHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n156\n9.\nLet A ∈SL2(R) and suppose that the vectors x and y form two sides of a parallelo-\ngram in R2.",
    "Prove that the area of this parallelogram is the same as the area of the\nparallelogram with sides Ax and Ay.\n10.",
    "Prove that SO(n) is a normal subgroup of O(n).\n",
    "11.",
    "Show that any isometry f in Rn is a one-to-one map.\n12.",
    "Prove or disprove: an element in E(2) of the form (A, x), where x ̸= 0, has infinite\norder.\n",
    "13. Prove or disprove: There exists an infinite abelian subgroup of O(n).\n",
    "14.",
    "Let x = (x1, x2) be a point on the unit circle in R2; that is, x2\n1 + x2\n2 = 1.",
    "If A ∈O(2),\nshow that Ax is also a point on the unit circle.\n15.",
    "Let G be a group with a subgroup H (not necessarily normal) and",
    "a normal subgroup\nN.",
    "Then G is a semidirect product of N by H if\n• H ∩N = {id};\n• HN = G.\nShow that each of the following is true.\n",
    "(a) S3 is the semidirect product of A3 by H = {(1), (1 2)}.\n",
    "(b) The quaternion group, Q8, cannot be written as a semidirect product.\n",
    "(c) E(2) is the semidirect product of O(2) by H, where H consists of all translations\nin R2.\n",
    "16.",
    "Determine which of the 17 wallpaper groups preserves the symmetry of the pattern in\nFigure 12.16.\n",
    "17.",
    "Determine which of the 17 wallpaper groups preserves the symmetry of the pattern in\nFigure 12.25.\n",
    "Figure 12.25\n18.",
    "Find the rotation group of a dodecahedron.\n19.",
    "For each of the 17 wallpaper groups, draw a wallpaper pattern having that group as a\nsymmetry group.\n\n",
    "CHAPTER 12.",
    "MATRIX GROUPS AND SYMMETRY\n157\n12.5 References and Suggested Readings\n[1]\nCoxeter, H. M. and Moser,",
    "W. O. J. Generators and Relations for Discrete Groups,\n3rd ed.",
    "Springer-Verlag, New York, 1972.\n",
    "[2]\nGrove, L. C. and Benson, C. T. Finite Reflection Groups.",
    "2nd ed.",
    "Springer-Verlag,\nNew York, 1985.\n",
    "[3]\nHiller, H. “Crystallography and Cohomology of Groups,” American Mathematical\nMonthly 93 (1986), 765–79.\n",
    "[4]\nLockwood, E. H. and Macmillan, R. H. Geometric Symmetry.",
    "Cambridge University\nPress, Cambridge, 1978.\n",
    "[5]\nMackiw, G. Applications of Abstract Algebra.",
    "Wiley, New York, 1985.\n",
    "[6]\nMartin, G. Transformation Groups: An Introduction to Symmetry.",
    "Springer-Verlag,\nNew York, 1982.\n",
    "[7]\nMilnor, J. “Hilbert’s Problem 18: On Crystallographic Groups, Fundamental Domains,\nand Sphere Packing,” t Proceedings of Symposia in Pure Mathematics 18, American\nMathematical Society, 1976.\n",
    "[8]\nPhillips, F. C. An Introduction to Crystallography.",
    "4th ed.",
    "Wiley, New York, 1971.\n",
    "[9]\nRose, B. I. and Stafford, R. D. “An Elementary Course in Mathematical Symmetry,”\nAmerican Mathematical Monthly 88 (1980), 54–64.\n",
    "[10] Schattschneider, D. “The Plane Symmetry Groups: Their Recognition and Their\nNotation,” American Mathematical Monthly 85 (1978), 439–50.\n",
    "[11] Schwarzenberger, R. L. “The 17 Plane Symmetry Groups,” Mathematical Gazette 58\n(1974), 123–31.\n",
    "[12] Weyl, H. Symmetry.",
    "Princeton University Press, Princeton, NJ, 1952.\n\n",
    "13\nThe Structure of Groups\nThe ultimate goal of group theory is to classify all groups up to isomorphism; that is, given a\nparticular group, we should be able to match it up with a known group via an isomorphism.\n",
    "For example, we have already proved that any finite cyclic group of order n is isomorphic\nto Zn; hence, we “know” all finite cyclic groups.",
    "It is probably not reasonable to expect\nthat we will ever know all groups; however, we can often classify certain types of groups or\ndistinguish between groups in special cases.\n",
    "In this chapter we will characterize all finite abelian groups.",
    "We shall also investigate\ngroups with sequences of subgroups.",
    "If a group has a sequence of subgroups, say\nG",
    "=",
    "Hn ⊃Hn−1 ⊃· · · ⊃H1 ⊃H0 = {e},\nwhere each subgroup Hi is normal in Hi+1 and each of the factor groups Hi+1/",
    "Hi is abelian,\nthen G is a solvable group.",
    "In addition to allowing us to distinguish between certain classes\nof groups, solvable groups turn out to be central to the study of solutions to polynomial\nequations.\n",
    "13.1 Finite Abelian Groups\nIn our investigation of cyclic groups we found that every group of prime order was isomorphic\nto Zp, where p was a prime number.\n",
    "We also determined that Zmn ∼= Zm ×",
    "Zn when\ngcd(m, n) = 1.",
    "In fact, much more is true.",
    "Every finite abelian group is isomorphic to a\ndirect product of cyclic groups of prime power order; that is, every finite abelian group is\nisomorphic to a group of the type\nZpα1\n1\n× · · · ×",
    "Zpαn\nn ,\nwhere each pk is prime (not necessarily distinct).\n",
    "First, let us examine a slight generalization of finite abelian groups.",
    "Suppose that G\nis a group and let {gi} be a set of elements in G, where i is in some index set I (not\nnecessarily finite).",
    "The smallest subgroup of G containing all of the gi’s is the subgroup of\nG generated by the gi’s.",
    "If this subgroup of G is in fact all of G, then G is generated by\nthe set {gi : i ∈I}.",
    "In this case the gi’s are said to be the generators of G.",
    "If there is a\nfinite set {gi : i ∈I} that generates G, then G is finitely generated.\n",
    "Example 13.1 Obviously, all finite groups are finitely generated.",
    "For example, the group\nS3 is generated by the permutations (1 2) and (1 2 3).",
    "The group Z×Zn is an infinite group\nbut is finitely generated by {(1, 0), (0, 1)}.\n",
    "□\n158\n\nCHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n159\nExample 13.2 Not all groups are finitely generated.",
    "Consider the rational numbers Q\nunder the operation of addition.\n",
    "Suppose that Q is finitely generated with generators\np1/q1, . . .",
    ", pn/qn, where each pi/qi is a fraction expressed in its lowest terms.",
    "Let p be some\nprime that does not divide any of the denominators q1, . . .",
    ", qn.",
    "We claim that 1/p cannot\nbe in the subgroup of Q that is generated by p1/q1, . . .",
    ", pn/qn, since p does not divide the\ndenominator of any element in this subgroup.",
    "This fact is easy to see since the sum of any\ntwo generators is\npi/qi + pj/qj = (piqj + pjqi)/(qiqj).\n",
    "□\nProposition 13.3 Let H be the subgroup of a group G that is generated by {gi ∈G : i ∈I}.\n",
    "Then h ∈H exactly when it is a product of the form\nh = gα1\ni1 · · · gαn\nin ,\nwhere the giks are not necessarily distinct.\nProof.",
    "Let K be the set of all products of the form gα1\ni1 · · · gαn\nin , where the giks are not\nnecessarily distinct.",
    "Certainly K is a subset of H. We need only show that K is a subgroup\nof G.",
    "If this is the case, then K = H, since H is the smallest subgroup containing all the\ngis.\n",
    "Clearly, the set K is closed under the group operation.",
    "Since g0\ni = 1, the identity is in\nK. It remains to show that the inverse of an element g = gk1\ni1 · · · gkn\nin in K must also be in\nK. However,\ng−1 = (gk1\ni1 · · · gkn\nin )−1 = (g−kn\nin\n· · · g−k1\ni1\n).\n",
    "■\nThe reason that powers of a fixed gi may occur several times in the product is that we\nmay have a nonabelian group.",
    "However, if the group is abelian, then the gis need occur\nonly once.",
    "For example, a product such as a−3b5a7 in an abelian group could always be\nsimplified (in this case, to a4b5).\n",
    "Now let us restrict our attention to finite abelian groups.",
    "We can express any finite\nabelian group as a finite direct product of cyclic groups.",
    "More specifically, letting p be\nprime, we define a group G to be a p-group if every element in G has as its order a power\nof p.",
    "For example, both Z2 ×",
    "Z2 and Z4 are 2-groups, whereas Z27 is a 3-group.",
    "We shall\nprove the Fundamental Theorem of Finite Abelian Groups which tells us that every finite\nabelian group is isomorphic to a direct product of cyclic p-groups.\n",
    "Theorem 13.4\nFundamental Theorem of Finite Abelian Groups.\n",
    "Every finite\nabelian group G is isomorphic to a direct product of cyclic groups of the form\nZpα1\n1\n× Zpα2\n2\n× · · · ×",
    "Zpαn\nn\nhere the pi’s are primes (not necessarily distinct).\n",
    "Example 13.5 Suppose that we wish to classify all abelian groups of order 540 = 22 · 33 · 5.\n",
    "The Fundamental Theorem of Finite Abelian Groups tells us that we have the following six\npossibilities.\n",
    "• Z2 × Z2 ×",
    "Z3 ×",
    "Z3 ×",
    "Z3 ×",
    "Z5;\n• Z2 × Z2 ×",
    "Z3 ×",
    "Z9 × Z5;\n• Z2 × Z2 ×",
    "Z27 × Z5;\n• Z4 × Z3 × Z3 ×",
    "Z3 ×",
    "Z5;\n\nCHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n160\n• Z4 × Z3 ×",
    "Z9 × Z5;\n•",
    "Z4 × Z27 × Z5.\n",
    "□\nThe proof of the Fundamental Theorem of Finite Abelian Groups depends on several\nlemmas.\n",
    "Lemma 13.6 Let G be a finite abelian group of order n.",
    "If p is a prime that divides n,\nthen G contains an element of order p.\nProof.",
    "We will prove this lemma by induction.",
    "If n = 1, then there is nothing to show.\n",
    "Now suppose that the lemma is true for all groups of order k, where k < n. Furthermore,\nlet p be a prime that divides n.\n",
    "If G has no proper nontrivial subgroups, then G = ⟨a⟩, where a is any element other\nthan the identity.",
    "By Exercise 4.5.39, the order of G must be prime.",
    "Since p divides n, we\nknow that p = n, and G contains p −1 elements of order p.\n",
    "Now suppose that G contains a nontrivial proper subgroup H. Then 1 < |H| <",
    "n.",
    "If\np | |H|, then H contains an element of order p by induction and the lemma is true.",
    "Suppose\nthat p does not divide the order of H. Since G is abelian, it must be the case that H is a\nnormal subgroup of G, and |G| = |H| · |G/H|.",
    "Consequently, p must divide |G/H|.",
    "Since\n|G/H| < |G| = n, we know that G/H contains an element aH of order p by the induction\nhypothesis.",
    "Thus,\nH = (aH)p = apH,\nand ap ∈H but a /∈H.",
    "If |H| = r, then p and r are relatively prime, and there exist\nintegers s and t",
    "such that sp + tr = 1.",
    "Furthermore, the order of ap must divide r, and\n(ap)r = (ar)p = 1.\n",
    "We claim that ar has order p.",
    "We must show that ar ̸= 1.",
    "Suppose ar = 1.",
    "Then\na = asp+tr\n= aspatr\n= (ap)s(ar)t\n= (ap)s1\n= (ap)s.\n",
    "Since ap ∈H, it must be the case that a = (ap)s ∈H, which is a contradiction.",
    "Therefore,\nar ̸= 1 is an element of order p in G.\n■\nLemma 13.6 is a special case of Cauchy’s Theorem (Theorem 15.1), which states that\nif G is a finite group and p a prime such that p divides the order of G, then G contains a\nsubgroup of order p.",
    "We will prove Cauchy’s Theorem in Chapter 15.\n",
    "Lemma 13.7 A finite abelian group is a p-group if and only if its order is a power of p.\nProof.",
    "If |G| = pn then by Lagrange’s theorem, then the order of any g ∈G must divide\npn, and therefore must be a power of p. Conversely, if |G| is not a power of p, then it has\nsome other prime divisor q, so by Lemma 13.6, G has an element of order q and thus is not\na p-group.\n",
    "■\nLemma 13.8 Let G be a finite abelian group of order n = pα1\n1 · · · pαk\nk , where where p1, . . .",
    ", pk\nare distinct primes and α1, α2, . .",
    ".",
    ", αk are positive integers.",
    "Then G is the internal direct\nproduct of subgroups G1, G2, . . .",
    ", Gk, where Gi is the subgroup of G consisting of all elements\nof order pr\ni for some integer r.\nProof.",
    "Since G is an abelian group, we are guaranteed that Gi is a subgroup of G for\ni = 1, . . .",
    ", k.",
    "Since the identity has order p0\ni = 1, we know that 1 ∈Gi.",
    "If g ∈Gi has order\n\nCHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n161\npr\ni , then g−1 must also have order pr\ni .",
    "Finally, if h ∈Gi has order ps\ni, then\n(gh)pt\ni = gpt\nihpt\ni = 1 · 1 = 1,\nwhere t is the maximum of r and s.\n",
    "We must show that\nG = G1G2 · · · Gk\nand Gi ∩Gj = {1} for i ̸= j.\nSuppose that g1 ∈G1 is in the subgroup generated by\nG2, G3, . . .",
    ", Gk.",
    "Then g1 = g2g3 · · · gk for gi ∈Gi.",
    "Since gi has order pαi, we know that\ngpαi\ni\n= 1 for i = 2, 3, . .",
    ". , k, and g\npα2\n2 ···p\nαk\nk\n1\n= 1.\n",
    "Since the order of g1 is a power of p1\nand gcd(p1, pα2\n2 · · · pαk\nk ) = 1, it must be the case that g1 = 1 and the intersection of G1\nwith any of the subgroups G2, G3, . .",
    ".",
    ", Gk is the identity.",
    "A similar argument shows that\nGi ∩Gj = {1} for i ̸= j.\n",
    "Next, we must show that it possible to write every g ∈G as a product g1 · · · gk, where\ngi ∈Gi.",
    "Since the order of g divides the order of G, we know that\n|g| = pβ1\n1 pβ2\n2 · · · pβk\nk\nfor some integers β1, . . .",
    ", βk.",
    "Letting ai = |g|/pβi\ni , the ai’s are relatively prime; hence, there\nexist integers b1, . . .",
    ", bk such that a1b1",
    "+ · · · + akbk = 1.",
    "Consequently,\ng = ga1b1+···+akbk = ga1b1 · · · gakbk.\n",
    "Since\ng(aibi)pβi\ni = gbi|g| = e,\nit follows that gaibi must be in Gi.\n",
    "Let gi = gaibi.\n",
    "Then g = g1 · · · gk ∈G1G2 · · · Gk.\n",
    "Therefore, G = G1G2 · · · Gk is an internal direct product of subgroups.\n",
    "■\nIf remains for us to determine the possible structure of each pi-group Gi in Lemma 13.8.\n",
    "Lemma 13.9 Let G be a finite abelian p-group and suppose that g ∈G has maximal order.\n",
    "Then G is isomorphic to ⟨g⟩× H for some subgroup H of G.\nProof.",
    "By Lemma 13.7, we may assume that the order of G is pn.",
    "We shall induct on n.\n",
    "If n = 1, then G is cyclic of order p and must be generated by g. Suppose now that the\nstatement of the lemma holds for all integers k with 1 ≤k < n and let g be of maximal\norder in G, say |g| = pm.",
    "Then apm = e for all a ∈G. Now choose h in G such that h /∈⟨g⟩,\nwhere h has the smallest possible order.",
    "Certainly such an h exists; otherwise, G = ⟨g⟩and\nwe are done.",
    "Let H = ⟨h⟩.\nWe claim that ⟨g⟩∩H = {e}.",
    "It suﬀices to show that |H| =",
    "p.",
    "Since |hp| = |h|/p, the\norder of hp is smaller than the order of h and must be in ⟨g⟩by the minimality of h; that\nis, hp = gr for some number r.",
    "Hence,\n(gr)pm−1 = (hp)pm−1 = hpm = e,\nand the order of gr must be less than or equal to pm−1.",
    "Therefore, gr cannot generate ⟨g⟩.\nNotice that p must occur as a factor of r, say r = ps, and hp = gr",
    "= gps.",
    "Define a to be\ng−sh.",
    "Then a cannot be in ⟨g⟩; otherwise, h would also have to be in ⟨g⟩. Also,\n",
    "ap = g−sphp = g−rhp = h−php",
    "=",
    "e.\nWe have now formed an element a with order p such that a /∈⟨g⟩.",
    "Since h was chosen to\nhave the smallest order of all of the elements that are not in ⟨g⟩, |H| = p.\n\nCHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n162\n",
    "Now we will show that the order of gH in the factor group G/H must be the same as\nthe order of g in G.",
    "If |gH| < |g| = pm, then\nH = (gH)pm−1 = gpm−1H;\nhence, gpm−1 must be in ⟨g⟩∩H = {e}, which contradicts the fact that the order of g is pm.\n",
    "Therefore, gH must have maximal order in G/H. By the Correspondence Theorem and our\ninduction hypothesis,\nG/H ∼= ⟨gH⟩× K/H\nfor some subgroup K of G containing H. We claim that ⟨g⟩∩K",
    "= {e}.",
    "If b ∈⟨g⟩∩K, then\nbH ∈⟨gH⟩∩K/H = {H} and b ∈⟨g⟩∩H = {e}.",
    "It follows that G = ⟨g⟩K implies that\nG ∼= ⟨g⟩× K.\n■\nThe proof of the Fundamental Theorem of Finite Abelian Groups follows very quickly\nfrom Lemma 13.9.",
    "Suppose that G is a finite abelian group and let g be an element of\nmaximal order in G.",
    "If ⟨g⟩= G, then we are done; otherwise, G ∼= Z|g| × H for some\nsubgroup H contained in G by the lemma.",
    "Since |H| < |G|, we can apply mathematical\ninduction.\n",
    "We now state the more general theorem for all finitely generated abelian groups.",
    "The\nproof of this theorem can be found in any of the references at the end of this chapter.\n",
    "Theorem 13.10\nThe Fundamental Theorem of Finitely Generated Abelian\nGroups.\n",
    "Every finitely generated abelian group G is isomorphic to a direct product of\ncyclic groups of the form\nZpα1\n1\n× Zpα2\n2\n× · · · ×",
    "Zpαn\nn × Z × · · · × Z,\nwhere the pi’s are primes (not necessarily distinct).\n",
    "13.2 Solvable Groups\nA subnormal series of a group G is a finite sequence of subgroups\nG =",
    "Hn ⊃Hn−1 ⊃· · · ⊃H1 ⊃H0 = {e},\nwhere Hi is a normal subgroup of Hi+1.",
    "If each subgroup Hi is normal in G, then the\nseries is called a normal series.",
    "The length of a subnormal or normal series is the number\nof proper inclusions.\n",
    "Example 13.11 Any series of subgroups of an abelian group is a normal series.",
    "Consider\nthe following series of groups:\nZ ⊃9Z ⊃45Z ⊃180Z ⊃{0},\nZ24 ⊃⟨2⟩⊃⟨6⟩⊃⟨12⟩⊃{0}.\n",
    "□\nExample 13.12 A subnormal series need not be a normal series.",
    "Consider the following\nsubnormal series of the group D4:\nD4 ⊃{(1), (1 2)(3 4), (1 3)(2 4), (1 4)(2 3)} ⊃{(1), (1 2)(3 4)} ⊃{(1)}.\n",
    "The subgroup {(1), (1 2)(3 4)} is not normal in D4; consequently, this series is not a normal\nseries.\n",
    "□\n\nCHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n163\nA subnormal (normal) series {Kj} is a refinement of a subnormal (normal) series {Hi}\nif {Hi} ⊂{Kj}.",
    "That is, each Hi is one of the Kj.\nExample 13.13",
    "The series\nZ ⊃3Z ⊃9Z ⊃45Z ⊃90Z ⊃180Z ⊃{0}\nis a refinement of the series\nZ ⊃9Z ⊃45Z ⊃180Z ⊃{0}.\n",
    "□\nThe best way to study a subnormal or normal series of subgroups, {Hi} of G, is actually\nto study the factor groups Hi+1/Hi.\n",
    "We say that two subnormal (normal) series {Hi}\nand {Kj} of a group G are isomorphic if there is a one-to-one correspondence between the\ncollections of factor groups {Hi+1/Hi} and {Kj+1/Kj}.\n",
    "Example 13.14",
    "The two normal series\nZ60 ⊃⟨3⟩⊃⟨15⟩⊃{0}\nZ60 ⊃⟨4⟩⊃⟨20⟩⊃{0}\nof the group Z60 are isomorphic since\nZ60/⟨3⟩∼= ⟨20⟩/{0} ∼= Z3\n⟨3⟩/⟨15⟩∼= ⟨4⟩/⟨20⟩∼= Z5\n⟨15⟩/{0} ∼= Z60/⟨4⟩∼= Z4.\n",
    "□\nA subnormal series {Hi} of a group G is a composition series if all the factor groups\nare simple; that is, if none of the factor groups of the series contains a normal subgroup.",
    "A\nnormal series {Hi} of G is a principal series if all the factor groups are simple.\n",
    "Example 13.15",
    "The group Z60 has a composition series\nZ60 ⊃⟨3⟩⊃⟨15⟩⊃⟨30⟩⊃{0}\nwith factor groups\nZ60/⟨3⟩∼= Z3\n⟨3⟩/⟨15⟩∼= Z5\n⟨15⟩/⟨30⟩∼= Z2\n⟨30⟩/{0} ∼= Z2.\n",
    "Since Z60 is an abelian group, this series is automatically a principal series.",
    "Notice that a\ncomposition series need not be unique.",
    "The series\nZ60 ⊃⟨2⟩⊃⟨4⟩⊃⟨20⟩⊃{0}\nis also a composition series.\n",
    "□\nExample 13.16 For n ≥5, the series\nSn ⊃An ⊃{(1)}\n\nCHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n164\nis a composition series for Sn since Sn/An ∼= Z2 and An is simple.\n",
    "□\nExample 13.17 Not every group has a composition series or a principal series.",
    "Suppose\nthat\n{0} = H0 ⊂H1 ⊂· · · ⊂Hn−1 ⊂Hn = Z\nis a subnormal series for the integers under addition.",
    "Then H1 must be of the form kZ\nfor some k ∈N.",
    "In this case H1/H0 ∼= kZ is an infinite cyclic group with many nontrivial\nproper normal subgroups.\n",
    "□\nAlthough composition series need not be unique as in the case of Z60, it turns out that\nany two composition series are related.",
    "The factor groups of the two composition series\nfor Z60 are Z2, Z2, Z3, and Z5; that is, the two composition series are isomorphic.",
    "The\nJordan-Hölder Theorem says that this is always the case.\n",
    "Theorem 13.18 Jordan-Hölder.",
    "Any two composition series of G are isomorphic.\n",
    "Proof.",
    "We shall employ mathematical induction on the length of the composition series.\n",
    "If the length of a composition series is 1, then G must be a simple group.",
    "In this case any\ntwo composition series are isomorphic.\n",
    "Suppose now that the theorem is true for all groups having a composition series of length\nk, where 1 ≤k < n. Let\nG",
    "= Hn ⊃Hn−1 ⊃· · · ⊃H1 ⊃H0 = {e}\nG = Km ⊃Km−1 ⊃· · · ⊃K1 ⊃K0 = {e}\nbe two composition series for G. We can form two new subnormal series for G since Hi ∩\nKm−1 is normal in Hi+1 ∩Km−1 and Kj ∩Hn−1 is normal in Kj+1 ∩Hn−1:\n",
    "G = Hn ⊃Hn−1 ⊃Hn−1 ∩Km−1 ⊃· · · ⊃H0 ∩Km−1 = {e}\nG = Km ⊃Km−1 ⊃Km−1 ∩Hn−1 ⊃· · · ⊃K0 ∩Hn−1 = {e}.\n",
    "Since Hi ∩Km−1 is normal in Hi+1 ∩Km−1, the Second Isomorphism Theorem (Theo-\nrem 11.12) implies that\n(Hi+1 ∩Km−1)/(Hi ∩Km−1) = (Hi+1 ∩Km−1)/(Hi ∩(Hi+1 ∩Km−1))\n∼= Hi(Hi+1 ∩Km−1)/Hi,\nwhere Hi is normal in Hi(Hi+1 ∩Km−1).\n",
    "Since {Hi} is a composition series, Hi+1/Hi\nmust be simple; consequently, Hi(Hi+1 ∩Km−1)/Hi is either Hi+1/Hi or Hi/Hi.",
    "That is,\nHi(Hi+1 ∩Km−1) must be either Hi or Hi+1.",
    "Removing any nonproper inclusions from the\nseries\nHn−1 ⊃Hn−1 ∩Km−1 ⊃· · · ⊃H0 ∩Km−1 = {e},\nwe have a composition series for Hn−1.",
    "Our induction hypothesis says that this series must\nbe equivalent to the composition series\nHn−1 ⊃· · · ⊃H1 ⊃H0 = {e}.\n",
    "Hence, the composition series\nG =",
    "Hn ⊃Hn−1 ⊃· · · ⊃H1 ⊃H0 = {e}\nand\nG",
    "= Hn ⊃Hn−1 ⊃Hn−1 ∩Km−1 ⊃· · · ⊃H0 ∩Km−1 = {e}\nare equivalent.",
    "If Hn−1 = Km−1, then the composition series {Hi} and {Kj} are equivalent\nand we are done; otherwise, Hn−1Km−1 is a normal subgroup of G properly containing\n\nCHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n165\nHn−1.",
    "In this case Hn−1Km−1 = G",
    "and we can apply the Second Isomorphism Theorem\nonce again; that is,\nKm−1/(Km−1 ∩Hn−1) ∼= (Hn−1Km−1)/Hn−1 = G/Hn−1.\n",
    "Therefore,\nG = Hn ⊃Hn−1 ⊃Hn−1 ∩Km−1 ⊃· · · ⊃H0 ∩Km−1 = {e}\nand\nG = Km ⊃Km−1 ⊃Km−1 ∩Hn−1 ⊃· · · ⊃K0 ∩Hn−1 = {e}\nare equivalent and the proof of the theorem is complete.\n",
    "■\nA group G is solvable if it has a subnormal series {Hi} such that all of the factor groups\nHi+1/Hi are abelian.",
    "Solvable groups will play a fundamental role when we study Galois\ntheory and the solution of polynomial equations.\n",
    "Example 13.19",
    "The group S4 is solvable since\nS4 ⊃A4 ⊃{(1), (1 2)(3 4), (1 3)(2 4), (1 4)(2 3)} ⊃{(1)}\nhas abelian factor groups; however, for n ≥5 the series\nSn ⊃An ⊃{(1)}\nis a composition series for Sn with a nonabelian factor group.",
    "Therefore, Sn is not a solvable\ngroup for n ≥5.\n□\nSage.\n",
    "Sage is able to create direct products of cyclic groups, though they are realized as\npermutation groups.",
    "This is a situation that should improve.",
    "However, with a classification\nof finite abelian groups, we can describe how to construct in Sage every group of order less\nthan 16.\n13.3 Reading Questions\n1.\n",
    "How many abelian groups are there of order 200 = 2352?\n2.\nHow many abelian groups are there of order 729 = 36?\n3.\nFind a subgroup of order 6 in Z8 × Z3 ×",
    "Z3.\n",
    "4.\nIt can be shown that an abelian group of order 72 contains a subgroup of order 8.\n",
    "What are the possibilities for this subgroup?\n5.\n",
    "What is a principal series of the group G?",
    "Your answer should not use new terms\ndefined in this chapter.\n",
    "13.4 Exercises\n1.\nFind all of the abelian groups of order less than or equal to 40 up to isomorphism.\n",
    "2.\nFind all of the abelian groups of order 200 up to isomorphism.\n",
    "3.\nFind all of the abelian groups of order 720 up to isomorphism.\n\n",
    "CHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n166\n4.\nFind all of the composition series for each of the following groups.\n",
    "(a) Z12\n(b) Z48\n(c)",
    "The quaternions, Q8\n(d) D4\n(e) S3 × Z4\n(f) S4\n(g) Sn, n ≥5\n(h) Q\n5.\nShow that the infinite direct product G = Z2 × Z2 × · · · is not finitely generated.\n",
    "6.\nLet G be an abelian group of order m. If n divides m, prove that G has a subgroup of\norder n.\n7.\n",
    "A group G is a torsion group if every element of G has finite order.",
    "Prove that a\nfinitely generated abelian torsion group must be finite.\n",
    "8.\nLet G, H, and K be finitely generated abelian groups.",
    "Show that if G × H ∼= G × K,\nthen H ∼= K. Give a counterexample to show that this cannot be true in general.\n",
    "9.\nLet G and H be solvable groups.",
    "Show that G ×",
    "H is also solvable.\n",
    "10.",
    "If G has a composition (principal) series and if N is a proper normal subgroup of G,\nshow there exists a composition (principal) series containing N.\n11.",
    "Prove or disprove: Let N be a normal subgroup of G. If N and G/N have composition\nseries, then G must also have a composition series.\n",
    "12.",
    "Let N be a normal subgroup of G. If N and G/N are solvable groups, show that G is\nalso a solvable group.\n13.",
    "Prove that G is a solvable group if and only if G has a series of subgroups\nG = Pn ⊃Pn−1 ⊃· · · ⊃P1 ⊃P0 = {e}\nwhere Pi is normal in Pi+1 and the order of Pi+1/Pi is prime.\n",
    "14.",
    "Let G be a solvable group.",
    "Prove that any subgroup of G is also solvable.\n15.",
    "Let G be a solvable group and N a normal subgroup of G. Prove that G/N is solvable.\n",
    "16.",
    "Prove that Dn is solvable for all integers n.\n17.",
    "Suppose that G has a composition series.",
    "If N is a normal subgroup of G, show that\nN and G/N also have composition series.\n18.",
    "Let G be a cyclic p-group with subgroups H and K. Prove that either H is contained\nin K or K is contained in H.\n19.",
    "Suppose that G is a solvable group with order n ≥2.",
    "Show that G contains a normal\nnontrivial abelian subgroup.\n",
    "20.",
    "Recall that the commutator subgroup G′ of a group G is defined as the subgroup of\nG generated by elements of the form a−1b−1ab for a, b ∈G. We can define a series of\nsubgroups of G by G(0) = G, G(1) = G′, and G(i+1) = (G(i))′.\n(a) Prove that G(i+1) is normal in (G(i))′. The series of subgroups\nG(0) = G ⊃G(1) ⊃G(2) ⊃· · ·\nis called the derived series of G.\n(b) Show that G is solvable if and only if G(n) = {e} for some integer n.\n21.",
    "Suppose that G is a solvable group with order n ≥2.",
    "Show that G contains a normal\nnontrivial abelian factor group.\n\n",
    "CHAPTER 13.",
    "THE STRUCTURE OF GROUPS\n167\n22.",
    "Zassenhaus Lemma.",
    "Let H and K be subgroups of a group G. Suppose also that\nH∗and K∗are normal subgroups of H and K respectively.",
    "Then\n(a) H∗(H ∩K∗) is a normal subgroup of H∗(H ∩K).\n",
    "(b) K∗(H∗∩K) is a normal subgroup of K∗(H ∩K).\n",
    "(c) H∗(H∩K)/H∗(H∩K∗)",
    "∼= K∗(H∩K)/K∗(H∗∩K)",
    "∼= (H∩K)/(H∗∩K)(H∩K∗).\n",
    "23.",
    "Schreier’s Theorem.\nUse the Zassenhaus Lemma to prove that two subnormal\n(normal) series of a group G have isomorphic refinements.\n",
    "24.",
    "Use Schreier’s Theorem to prove the Jordan-Hölder Theorem.\n",
    "13.5 Programming Exercises\n1.\nWrite a program that will compute all possible abelian groups of order n.",
    "What is the\nlargest n for which your program will work?\n13.6 References and Suggested Readings\n",
    "[1]\nHungerford, T. W. Algebra.",
    "Springer, New York, 1974.\n",
    "[2]\nLang, S. Algebra.",
    "3rd ed.",
    "Springer, New York, 2002.\n",
    "[3]\nRotman, J. J. An Introduction to the Theory of Groups.",
    "4th ed.",
    "Springer, New York,\n1995.\n\n",
    "14\nGroup Actions\nGroup actions generalize group multiplication.",
    "If G is a group and X is an arbitrary set, a\ngroup action of an element g ∈G and x ∈X is a product, gx, living in X. Many problems\nin algebra are best be attacked via group actions.",
    "For example, the proofs of the Sylow\ntheorems and of Burnside’s Counting Theorem are most easily understood when they are\nformulated in terms of group actions.\n",
    "14.1 Groups Acting on Sets\nLet X be a set and G be a group.",
    "A (left) action of G on X is a map G × X →X given\nby (g, x) 7→gx, where\n1.",
    "ex = x for all x ∈X;\n2. (g1g2)x = g1(g2x) for all x ∈X and all g1, g2 ∈G.\nUnder these considerations X is called a G-set.",
    "Notice that we are not requiring X to be\nrelated to G in any way.",
    "It is true that every group G acts on every set X by the trivial\naction (g, x) 7→x; however, group actions are more interesting if the set X is somehow\nrelated to the group",
    "G.\nExample 14.1 Let G = GL2(R) and X = R2.",
    "Then G acts on X by left multiplication.",
    "If\nv ∈R2 and I is the identity matrix, then Iv = v. If A and B are 2 × 2 invertible matrices,\nthen (AB)v = A(Bv) since matrix multiplication is associative.\n",
    "□\nExample 14.2 Let G = D4 be the symmetry group of a square.",
    "If X = {1, 2, 3, 4} is the set\nof vertices of the square, then we can consider D4 to consist of the following permutations:\n{(1), (1 3), (2 4), (1 4 3 2), (1 2 3 4), (1 2)(3 4), (1 4)(2 3), (1 3)(2 4)}.\n",
    "The elements of D4 act on X as functions.",
    "The permutation (1 3)(2 4) acts on vertex 1 by\nsending it to vertex 3, on vertex 2 by sending it to vertex 4, and so on.",
    "It is easy to see that\nthe axioms of a group action are satisfied.\n",
    "□\nIn general, if X is any set and G is a subgroup of SX, the group of all permutations\nacting on X, then X is a G-set under the group action\n(σ, x) 7→σ(x)\nfor σ ∈G and x ∈X.\n168\n\nCHAPTER 14.",
    "GROUP ACTIONS\n169\nExample 14.3 If we let X = G, then every group G acts on itself by the left regular\nrepresentation; that is, (g, x) 7→λg(x) = gx, where λg is left multiplication:\ne · x = λex = ex = x\n(gh) ·",
    "x = λghx = λgλhx = λg(hx) = g · (h · x).\n",
    "If H is a subgroup of G, then G is an H-set under left multiplication by elements of H.\n□\nExample 14.4 Let G be a group and suppose that X = G.",
    "If H is a subgroup of G, then\nG is an H-set under conjugation; that is, we can define an action of H on G,\nH × G →G,\nvia\n(h, g) 7→hgh−1\nfor h ∈H and g ∈G. Clearly, the first axiom for a group action holds.",
    "Observing that\n(h1h2, g) = h1h2g(h1h2)−1\n= h1(h2gh−1\n2 )h−1\n1\n= (h1, (h2, g)),\nwe see that the second condition is also satisfied.\n",
    "□\nExample 14.5 Let H be a subgroup of G and LH the set of left cosets of H. The set LH\nis a G-set under the action\n(g, xH) 7→gxH.\nAgain, it is easy to see that the first axiom is true.",
    "Since (gg′)xH = g(g′xH), the second\naxiom is also true.\n",
    "□\nIf G acts on a set X and x, y ∈X, then x is said to be G-equivalent to y if there exists\na g ∈G such that gx = y. We write x ∼G y or x ∼y if two elements are G-equivalent.\n",
    "Proposition 14.6 Let X be a G-set.",
    "Then G-equivalence is an equivalence relation on X.\nProof.",
    "The relation ∼is reflexive since ex = x. Suppose that x ∼y for x, y ∈X.",
    "Then\nthere exists a g such that gx = y.",
    "In this case g−1y = x; hence, y ∼x.",
    "To show that the\nrelation is transitive, suppose that x ∼y and y ∼z.",
    "Then there must exist group elements\ng and h such that gx = y and hy = z.",
    "So z = hy = (hg)x, and x is equivalent to z.\n■\nIf X is a G-set, then each partition of X associated with G-equivalence is called an orbit\nof X under G.",
    "We will denote the orbit that contains an element x of X by Ox.\n",
    "Example 14.7 Let G be the permutation group defined by\nG = {(1), (1 2 3), (1 3 2), (4 5), (1 2 3)(4 5), (1 3 2)(4 5)}\nand X = {1, 2, 3, 4, 5}.",
    "Then X is a G-set.",
    "The orbits are O1 = O2 = O3 = {1, 2, 3} and\nO4 = O5 = {4, 5}.\n",
    "□\nNow suppose that G is a group acting on a set X and let g be an element of G. The\nfixed point set of g in X, denoted by Xg, is the set of all x ∈X",
    "such that gx = x. We can\nalso study the group elements g that fix",
    "a given x ∈X.",
    "This set is more than a subset of\nG, it is a subgroup.",
    "This subgroup is called the stabilizer subgroup or isotropy subgroup\nof x.",
    "We will denote the stabilizer subgroup of x by Gx.\nRemark 14.8",
    "It is important to remember that Xg ⊂X and Gx ⊂G.\n\nCHAPTER 14.",
    "GROUP ACTIONS\n170\nExample 14.9 Let X = {1, 2, 3, 4, 5, 6} and suppose that G is the permutation group given\nby the permutations\n{(1), (1 2)(3 4 5 6), (3 5)(4 6), (1 2)(3 6 5 4)}.\n",
    "Then the fixed point sets of X under the action of G are\nX(1) = X,\nX(3 5)(4 6) = {1, 2},\nX(1 2)(3 4 5 6) = X(1",
    "2)(3 6 5 4) = ∅,\nand the stabilizer subgroups are\nG1 = G2 = {(1), (3 5)(4 6)},\nG3 = G4 = G5 = G6 = {(1)}.\n",
    "It is easily seen that Gx is a subgroup of G for each x ∈X.\n□\nProposition 14.10 Let G be a group acting on a set X and x ∈X. The stabilizer group\nof x, Gx, is a subgroup of G.\nProof.",
    "Clearly, e ∈Gx since the identity fixes every element in the set X. Let g, h ∈Gx.\n",
    "Then gx = x and hx = x.",
    "So (gh)x = g(hx) = gx",
    "= x; hence, the product of two elements\nin Gx is also in Gx.",
    "Finally, if g ∈Gx, then x = ex = (g−1g)x = (g−1)gx = g−1x.",
    "So g−1\nis in Gx.\n",
    "■\nWe will denote the number of elements in the fixed point set of an element g ∈G by\n|Xg| and denote the number of elements in the orbit of x ∈X by |Ox|.",
    "The next theorem\ndemonstrates the relationship between orbits of an element x ∈X and the left cosets of Gx\nin G.\nTheorem 14.11 Let G be a finite group and X a finite G-set.",
    "If x ∈X, then |Ox| = [G :\nGx].\nProof.\n",
    "We know that |G|/|Gx| is the number of left cosets of Gx in G by Lagrange’s\nTheorem (Theorem 6.10).",
    "We will define a bijective map ϕ between the orbit Ox of X and\nthe set of left cosets LGx of Gx in G. Let y ∈Ox.",
    "Then there exists a g in G such that\ngx = y. Define ϕ by ϕ(y) = gGx.",
    "To show that ϕ is one-to-one, assume that ϕ(y1)",
    "= ϕ(y2).\n",
    "Then\nϕ(y1)",
    "= g1Gx = g2Gx = ϕ(y2),\nwhere g1x = y1 and g2x = y2.",
    "Since g1Gx = g2Gx, there exists a g ∈Gx such that g2 = g1g,\ny2 = g2x = g1gx = g1x = y1;\nconsequently, the map ϕ is one-to-one.",
    "Finally, we must show that the map ϕ is onto.",
    "Let\ngGx be a left coset.",
    "If gx = y, then ϕ(y) = gGx.\n",
    "■\n14.2",
    "The Class Equation\nLet X be a finite G-set and XG be the set of fixed points in X; that is,\nXG = {x ∈X :",
    "gx = x for all g ∈G}.\n\n",
    "CHAPTER 14.",
    "GROUP ACTIONS\n171\nSince the orbits of the action partition X,\n|X| = |XG| +\nn\nX\ni=k\n|Oxi|,\nwhere xk, . . .",
    ", xn are representatives from the distinct nontrivial orbits of X.\nNow consider the special case in which G acts on itself by conjugation, (g, x) 7→gxg−1.\n",
    "The center of G,\nZ(G) = {x : xg = gx for all g ∈G},\nis the set of points that are fixed by conjugation.",
    "The nontrivial orbits of the action are\ncalled the conjugacy classes of G. If x1, . .",
    ".",
    ", xk are representatives from each of the nontrivial\nconjugacy classes of G and |Ox1| = n1, . . .",
    ", |Oxk| = nk, then\n|G| = |Z(G)|",
    "+ n1 + · · ·",
    "+ nk.\n",
    "The stabilizer subgroups of each of the xi’s, C(xi) = {g ∈G : gxi = xig}, are called the\ncentralizer subgroups of the xi’s.",
    "From Theorem 14.11, we obtain the class equation:\n|G| =",
    "|Z(G)|",
    "+",
    "[G : C(x1)]",
    "+ · · ·",
    "+",
    "[G : C(xk)].\n",
    "One of the consequences of the class equation is that the order of each conjugacy class must\ndivide the order of G.\nExample 14.12 It is easy to check that the conjugacy classes in S3 are the following:\n{(1)},\n{(1 2 3), (1 3 2)},\n{(1 2), (1 3), (2 3)}.\n",
    "The class equation is 6 = 1 + 2 + 3.\n□\nExample 14.13 The center of D4 is {(1), (1 3)(2 4)}, and the conjugacy classes are\n{(1 3), (2 4)},\n{(1 4 3 2), (1 2 3 4)},\n{(1 2)(3 4), (1 4)(2 3)}.\n",
    "Thus, the class equation for D4 is 8 = 2 + 2 + 2 + 2.\n□\nExample 14.14 For Sn it takes a bit of work to find the conjugacy classes.",
    "We begin with\ncycles.",
    "Suppose that σ = (a1, . . .",
    ", ak) is a cycle and let τ ∈Sn.",
    "By Theorem 6.16,\nτστ −1 = (τ(a1), . . .",
    ", τ(ak)).\n",
    "Consequently, any two cycles of the same length are conjugate.",
    "Now let σ = σ1σ2 · · · σr be\na cycle decomposition, where the length of each cycle",
    "σi is ri.",
    "Then σ is conjugate to every\nother τ ∈Sn whose cycle decomposition has the same lengths.\n",
    "The number of conjugate classes in Sn is the number of ways in which n can be parti-\ntioned into sums of positive integers.",
    "In the case of S3 for example, we can partition the\ninteger 3 into the following three sums:\n3 = 1 + 1 + 1\n3 = 1 + 2\n3 = 3;\ntherefore, there are three conjugacy classes.\n",
    "There are variations to problem of finding\nthe number of such partitions for any positive integer n that are what computer scientists\ncall NP-complete.",
    "This effectively means that the problem cannot be solved for a large n\nbecause the computations would be too time-consuming for even the largest computer.\n",
    "□\n\nCHAPTER 14.",
    "GROUP ACTIONS\n172\nTheorem 14.15 Let G be a group of order pn where p is prime.",
    "Then G has a nontrivial\ncenter.\nProof.",
    "We apply the class equation\n|G| =",
    "|Z(G)|",
    "+ n1 + · · ·",
    "+ nk.\n",
    "Since each ni > 1 and ni | |G|, it follows that p must divide each ni.",
    "Also, p | |G|; hence, p\nmust divide |Z(G)|.",
    "Since the identity is always in the center of G, |Z(G)| ≥1.",
    "Therefore,\n|Z(G)| ≥p, and there exists some g ∈Z(G) such that g ̸= 1.\n",
    "■\nCorollary 14.16 Let G be a group of order p2 where p is prime.",
    "Then G is abelian.\n",
    "Proof.",
    "By Theorem 14.15, |Z(G)|",
    "= p or p2.",
    "Suppose that |Z(G)|",
    "= p.",
    "Then Z(G) and\nG/Z(G) both have order p and must both be cyclic groups.",
    "Choosing a generator aZ(G)\nfor G/Z(G), we can write any element gZ(G) in the quotient group as amZ(G) for some\ninteger m; hence, g = amx for some x in the center of G. Similarly, if hZ(G) ∈G/Z(G),\nthere exists a y in Z(G) such that h = any for some integer n.",
    "Since x and y are in the\ncenter of G, they commute with all other elements of G; therefore,\ngh = amxany = am+nxy = anyamx = hg,\nand G must be abelian.",
    "Hence, |Z(G)| = p2.\n",
    "■\n14.3 Burnside’s Counting Theorem\nSuppose that we wish to color the vertices of a square with two different colors, say black and\nwhite.",
    "We might suspect that there would be 24 = 16 different colorings.",
    "However, some of\nthese colorings are equivalent.",
    "If we color the first vertex black and the remaining vertices\nwhite, it is the same as coloring the second vertex black and the remaining ones white since\nwe could obtain the second coloring simply by rotating the square 90◦(Figure 14.17).\n",
    "B\nW\nW\nW\nW\nB\nW\nW\nW\nW\nB\nW\nW\nW\nW\nB\nFigure 14.17 Equivalent colorings of square\n\nCHAPTER 14.",
    "GROUP ACTIONS\n173\nBurnside’s",
    "Counting Theorem offers a method of computing the number of distinguish-\nable ways in which something can be done.",
    "In addition to its geometric applications, the\ntheorem has interesting applications to areas in switching theory and chemistry.",
    "The proof\nof Burnside’s Counting Theorem depends on the following lemma.\n",
    "Lemma 14.18 Let X be a G-set and suppose that x ∼y.",
    "Then Gx is isomorphic to Gy.\n",
    "In particular, |Gx| = |Gy|.\n",
    "Proof.",
    "Let G act on X by (g, x) 7→g · x.",
    "Since x ∼y, there exists a g ∈G such that\ng · x = y. Let a ∈Gx.",
    "Since\ngag−1 · y = ga · g−1y = ga · x = g · x = y,\nwe can define a map ϕ :",
    "Gx →Gy by ϕ(a) = gag−1.",
    "The map ϕ is a homomorphism since\nϕ(ab) = gabg−1 = gag−1gbg−1 = ϕ(a)ϕ(b).\n",
    "Suppose that ϕ(a) = ϕ(b).",
    "Then gag−1 = gbg−1 or a = b; hence, the map is injective.",
    "To\nshow that ϕ is onto, let b be in Gy; then g−1bg is in Gx since\ng−1bg · x = g−1b · gx = g−1b · y = g−1 · y = x;\nand ϕ(g−1bg)",
    "= b.\n■\nTheorem 14.19\nBurnside.",
    "Let G be a finite group acting on a set X and let k denote\nthe number of orbits of X. Then\nk =\n1\n|G|\nX\ng∈G\n|Xg|.\n",
    "Proof.",
    "We look at all the fixed points x of all the elements in g ∈G; that is, we look at\nall g’s and all x’s such that gx = x.",
    "If viewed in terms of fixed point sets, the number of all\ng’s fixing x’s is\nX\ng∈G\n|Xg|.\n",
    "However, if viewed in terms of the stabilizer subgroups, this number is\nX\nx∈X\n|Gx|;\nhence, P\ng∈G |Xg| = P\nx∈X |Gx|.",
    "By Lemma 14.18,\nX\ny∈Ox\n|Gy| = |Ox| · |Gx|.\n",
    "By Theorem 14.11 and Lagrange’s Theorem, this expression is equal to |G|.",
    "Summing over\nall of the k distinct orbits, we conclude that\nX\ng∈G\n|Xg| =\nX\nx∈X\n|Gx| = k · |G|.\n",
    "■\nExample 14.20 Let X = {1, 2, 3, 4, 5} and suppose that G is the permutation group\nG = {(1), (1 3), (1 3)(2 5), (2 5)}.",
    "The orbits of X are {1, 3}, {2, 5}, and {4}.",
    "The fixed point\n\nCHAPTER 14.",
    "GROUP ACTIONS\n174\nsets are\nX(1) = X\nX(1 3) = {2, 4, 5}\nX(1 3)(2 5) = {4}\nX(2 5) = {1, 3, 4}.\n",
    "Burnside’s",
    "Theorem says that\nk =\n1\n|G|\nX\ng∈G\n|Xg| = 1\n4(5",
    "+ 3 + 1 + 3) = 3.\n□\nA Geometric Example\nBefore we apply Burnside’s Theorem to switching-theory problems, let us examine the\nnumber of ways in which the vertices of a square can be colored black or white.",
    "Notice\nthat we can sometimes obtain equivalent colorings by simply applying a rigid motion to the\nsquare.",
    "For instance, as we have pointed out, if we color one of the vertices black and the\nremaining three white, it does not matter which vertex was colored black since a rotation\nwill give an equivalent coloring.\n",
    "The symmetry group of a square, D4, is given by the following permutations:\n(1)\n(1 3)\n(2 4)\n(1 4 3 2)\n(1 2 3 4)\n(1 2)(3 4)\n(1 4)(2 3)\n(1 3)(2 4)\n",
    "The group G acts on the set of vertices {1, 2, 3, 4} in the usual manner.",
    "We can describe\nthe different colorings by mappings from X into Y = {B, W} where B and W represent\nthe colors black and white, respectively.",
    "Each map f : X →Y describes a way to color\nthe corners of the square.",
    "Every σ ∈D4 induces a permutation eσ of the possible colorings\ngiven by eσ(f)",
    "= f ◦σ for f : X →Y .",
    "For example, suppose that f is defined by\nf(1)",
    "= B\nf(2) = W\nf(3)",
    "= W\nf(4)",
    "= W\nand σ = (12)(34).",
    "Then eσ(f) = f ◦σ sends vertex 2 to B and the remaining vertices to\nW. The set of all such eσ is a permutation group eG on the set of possible colorings.",
    "Let e\nX\ndenote the set of all possible colorings; that is, e\nX is the set of all possible maps from X to\nY .",
    "Now we must compute the number of eG-equivalence classes.\n",
    "1. e\nX(1) = e\nX since the identity fixes every possible coloring.",
    "| e\nX| = 24 = 16.\n2. e\nX(1 2 3 4) consists of all f ∈e\nX such that f is unchanged by the permutation (1 2 3 4).\n",
    "In this case f(1) = f(2) = f(3)",
    "= f(4), so that all values of f must be the same; that\nis, either f(x) = B or f(x) = W for every vertex x of the square.",
    "So | e\nX(1 2 3 4)| = 2.\n3. | e\nX(1 4 3 2)| = 2.\n4.",
    "For e\nX(1 3)(2 4), f(1) = f(3) and f(2) = f(4).",
    "Thus, | e\nX(1 3)(2 4)| = 22 = 4.\n\nCHAPTER 14.",
    "GROUP ACTIONS\n175\n5. | e\nX(1 2)(3 4)| = 4.\n6. | e\nX(1",
    "4)(2 3)| = 4.\n7.",
    "For e\nX(1 3), f(1) = f(3) and the other corners can be of any color; hence, | e\nX(1",
    "3)| =\n23 = 8.\n8.",
    "| e\nX(2 4)| = 8.\n",
    "By Burnside’s Theorem, we can conclude that there are exactly\n1\n8(24",
    "+ 21 + 22 + 21 + 22 + 22 + 23 + 23) = 6\nways to color the vertices of the square.\n",
    "Proposition 14.21 Let G be a permutation group of X and e\nX the set of functions from X\nto Y .",
    "Then G induces a group eG that permutes the elements of e\nX, where eσ ∈eG is defined\nby eσ(f)",
    "= f ◦σ for σ ∈G and f ∈e\nX.",
    "Furthermore, if n is the number of cycles in the\ncycle decomposition of σ, then | e\nXσ| = |Y |n.\n",
    "Proof.",
    "Let σ ∈G and f ∈e\nX.",
    "Since σ permutes the elements of X, f ◦σ must also be in\ne\nX. Suppose that g is another function from X to Y such that eσ(f) = eσ(g).",
    "Then for each\nx ∈X,\nf(σ(x)) = eσ(f)(x) = eσ(g)(x) = g(σ(x)).\n",
    "Since σ is a permutation of X, every element x′ in X is the image of some x in X under σ;\nhence, f and g agree on all elements of X. Therefore, f = g and eσ is injective.",
    "The map\nσ 7→eσ is onto, since the two sets are the same size.\n",
    "Suppose that σ is a permutation of X with cycle decomposition σ = σ1σ2 · · · σn.",
    "Any\nf in e\nXσ must have the same value on each cycle of σ.",
    "Since there are n cycles and |Y |\npossible values for each cycle, | e\nXσ| = |Y |n.\n",
    "■\nExample 14.22 Let X = {1, 2, . . .",
    ", 7} and suppose that Y = {A, B, C}.\n",
    "If g is the\npermutation of X given by (1 3)(2 4 5) = (1 3)(2 4 5)(6)(7), then n = 4.",
    "Any f ∈e\nXg must\nhave the same value on each cycle in g.",
    "There are |Y | = 3 such choices for any value, so\n| e\nXg| = 34 = 81.\n",
    "□\nExample 14.23 Suppose that we wish to color the vertices of a square using four different\ncolors.",
    "By Proposition 14.21, we can immediately decide that there are\n1\n8(44 + 41 + 42 + 41 + 42 + 42 + 43 + 43) = 55\npossible ways.\n",
    "□\nSwitching Functions\n",
    "In switching theory we are concerned with the design of electronic circuits with binary\ninputs and outputs.",
    "The simplest of these circuits is a switching function that has n inputs\nand a single output (Figure 14.24).",
    "Large electronic circuits can often be constructed by\ncombining smaller modules of this kind.",
    "The inherent problem here is that even for a simple\ncircuit a large number of different switching functions can be constructed.",
    "With only four\ninputs and a single output, we can construct 65,536 different switching functions.",
    "However,\nwe can often replace one switching function with another merely by permuting the input\nleads to the circuit (Figure 14.25).\n\n",
    "CHAPTER 14.",
    "GROUP ACTIONS\n176\nx1\nx2...\n",
    "xn\nf\nf(x1, x2, . . .",
    ", xn)\nFigure 14.24 A switching function of n variables\nWe define a switching or Boolean function\nof n variables to be a function from Zn\n2\nto Z2.",
    "Since any switching function can have two possible values for each binary n-tuple\nand there are 2n binary n-tuples, 22n switching functions are possible for n variables.",
    "In\ngeneral, allowing permutations of the inputs greatly reduces the number of different kinds\nof modules that are needed to build a large circuit.\n",
    "a\nb\nf\nf(a, b)\na\nb\nf\nf(b, a) = g(a, b)\nFigure 14.25 Switching functions in two variables\nThe possible switching functions with two input variables a and b are listed in Ta-\nble 14.26.",
    "Two switching functions f and g are equivalent if g can be obtained from f\nby a permutation of the input variables.",
    "For example, g(a, b, c) = f(b, c, a).",
    "In this case\ng ∼f via the permutation (a, c, b).",
    "In the case of switching functions of two variables, the\npermutation (a, b) reduces 16 possible switching functions to 12 equivalent functions since\nf2 ∼f4\nf3 ∼f5\nf10 ∼f12\nf11 ∼f13.\n",
    "Table 14.26 Switching functions in two variables\nInputs\nOutputs\nf0\nf1\nf2\nf3\nf4\nf5\nf6\nf7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n1\n1\n1\n1\n0\n0\n0\n1\n1\n0\n0\n1\n1\n1\n1\n0\n1\n0\n1\n0\n1\n0\n1\nInputs\nOutputs\nf8\nf9\nf10\nf11\nf12\nf13\nf14\nf15\n0\n0\n1\n1\n1\n1\n1\n1\n1\n1\n0\n1\n0\n0\n0\n0\n1\n1\n1\n1\n1\n0\n0\n0\n1\n1\n0\n0\n1\n1\n1\n1\n0\n1\n0\n1\n0\n1\n0\n1\nFor three input variables there are 223 = 256 possible switching functions; in the case\nof four variables there are 224 = 65,536.",
    "The number of equivalence classes is too large to\nreasonably calculate directly.",
    "It is necessary to employ Burnside’s Theorem.\n\n",
    "CHAPTER 14.",
    "GROUP ACTIONS\n177\nConsider a switching function with three possible inputs, a, b, and c.\n",
    "As we have\nmentioned, two switching functions f and g are equivalent if a permutation of the input\nvariables of f gives g.",
    "It is important to notice that a permutation of the switching functions\nis not simply a permutation of the input values {a, b, c}.",
    "A switching function is a set of\noutput values for the inputs a, b, and c, so when we consider equivalent switching functions,\nwe are permuting 23 possible outputs, not just three input values.",
    "For example, each binary\ntriple (a, b, c) has a specific output associated with it.\n",
    "The permutation (acb) changes\noutputs as follows:\n(0, 0, 0) 7→(0, 0, 0)\n(0, 0, 1) 7→(0, 1, 0)\n(0, 1, 0) 7→(1, 0, 0)\n...\n",
    "(1, 1, 0) 7→(1, 0, 1)\n(1, 1, 1) 7→(1, 1, 1).\n",
    "Let X be the set of output values for a switching function in n variables.",
    "Then |X| = 2n.\n",
    "We can enumerate these values as follows:\n(0, . . .",
    ", 0, 1) 7→0\n(0, . .",
    ".",
    ", 1, 0) 7→1\n(0, . . .",
    ", 1, 1) 7→2\n...\n(1, . . .",
    ", 1, 1) 7→2n −1.\n",
    "Now let us consider a circuit with four input variables and a single output.",
    "Suppose that\nwe can permute the leads of any circuit according to the following permutation group:\n(a),\n(a, c),\n(b, d),\n(a, d, c, b),\n(a, b, c, d),\n(a, b)(c, d),\n(a, d)(b, c),\n(a, c)(b, d).\n",
    "The permutations of the four possible input variables induce the permutations of the output\nvalues in Table 14.27.\n",
    "Hence, there are\n1\n8(216 + 2 · 212 + 2 · 26 + 3 · 210) = 9616\npossible switching functions of four variables under this group of permutations.",
    "This number\nwill be even smaller if we consider the full symmetric group on four letters.\n",
    "Table 14.27 Permutations of switching functions in four variables\nGroup\nNumber\nPermutation\nSwitching Function Permutation\nof Cycles\n(a)\n(0)\n16\n(a, c)\n(2, 8)(3, 9)(6, 12)(7, 13)\n12\n(b, d)\n(1, 4)(3, 6)(9, 12)(11, 14)\n12\n(a, d, c, b)\n(1, 2, 4, 8)(3, 6.12, 9)(5, 10)(7, 14, 13, 11)\n6\n(a, b, c, d)\n(1, 8, 4, 2)(3, 9, 12, 6)(5, 10)(7, 11, 13, 14)\n6\n(a, b)(c, d)\n(1, 2)(4, 8)(5, 10)(6, 9)(7, 11)(13, 14)\n10\n(a, d)(b, c)\n(1, 8)(2, 4)(3, 12)(5, 10)(7, 14)(11, 13)\n10\n(a, c)(b, d)\n(1, 4)(2, 8)(3, 12)(6, 9)(7, 13)(11, 14)\n10\n\nCHAPTER 14.",
    "GROUP ACTIONS\n178\nSage.\n",
    "Sage has many commands related to conjugacy, which is a group action.",
    "It also has\ncommands for orbits and stabilizers of permutation groups.",
    "In the supplement, we illustrate\nthe automorphism group of a (combinatorial) graph as another example of a group action\non the vertex set of the graph.\n",
    "Historical Note\nWilliam Burnside was born in London in 1852.",
    "He attended Cambridge University from\n1871 to 1875 and won the Smith’s Prize in his last year.",
    "After his graduation he lectured\nat Cambridge.\n",
    "He was made a member of the Royal Society in 1893.\n",
    "Burnside wrote\napproximately 150 papers on topics in applied mathematics, differential geometry, and\nprobability, but his most famous contributions were in group theory.",
    "Several of Burnside’s\nconjectures have stimulated research to this day.",
    "One such conjecture was that every group\nof odd order is solvable; that is, for a group G of odd order, there exists a sequence of\nsubgroups\nG = Hn ⊃Hn−1 ⊃· · · ⊃H1 ⊃H0 = {e}\nsuch that Hi is normal in Hi+1 and Hi+1/",
    "Hi is abelian.",
    "This conjecture was finally proven\nby W. Feit and J. Thompson in 1963.",
    "Burnside’s",
    "The Theory of Groups of Finite Order,\npublished in 1897, was one of the first books to treat groups in a modern context as opposed\nto permutation groups.",
    "The second edition, published in 1911, is still a classic.\n",
    "14.4 Reading Questions\n1.\nGive an informal description of a group action.\n",
    "2.\nDescribe the class equation.\n",
    "3.\n",
    "What are the groups of order 49?\n4.\n",
    "How many switching functions are there with 5 inputs?",
    "(Give both a simple expression\nand the total number as a single integer.)\n5.\n",
    "The “Historical Note” mentions the proof of Burnside’s Conjecture.",
    "How long was the\nproof?\n14.5 Exercises\n1.\n",
    "Examples 14.1–14.5 in the first section each describe an action of a group G on a set\nX, which will give rise to the equivalence relation defined by G-equivalence.",
    "For each\nexample, compute the equivalence classes of the equivalence relation, the G-equivalence\nclasses.\n",
    "2.\nCompute all Xg and all Gx for each of the following permutation groups.\n",
    "(a) X = {1, 2, 3}, G = S3 = {(1), (1 2), (1 3), (2 3), (1 2 3), (1 3 2)}\n(b) X = {1, 2, 3, 4, 5, 6}, G = {(1), (1 2), (3 4 5), (3 5 4), (1 2)(3 4 5), (1 2)(3 5 4)}\n3.\nCompute the G-equivalence classes of X for each of the G-sets in Exercise 14.5.2.",
    "For\neach x ∈X verify that |G| = |Ox| · |Gx|.\n",
    "4.\nLet G be the additive group of real numbers.",
    "Let the action of θ ∈G on the real plane\nR2 be given by rotating the plane counterclockwise about the origin through θ radians.\n",
    "Let P be a point on the plane other than the origin.\n",
    "(a) Show that R2 is a G-set.\n\n",
    "CHAPTER 14.",
    "GROUP ACTIONS\n179\n(b) Describe geometrically the orbit containing P.\n(c) Find the group GP .\n",
    "5.\nLet G = A4 and suppose that G acts on itself by conjugation; that is, (g, h) 7→ghg−1.\n(a) Determine the conjugacy classes (orbits) of each element of G.\n(b) Determine all of the isotropy subgroups for each element of G.\n6.\nFind the conjugacy classes and the class equation for each of the following groups.\n",
    "(a) S4\n(b) D5\n(c) Z9\n(d) Q8\n7.\nWrite the class equation for S5 and for A5.\n8.\n",
    "If a square remains fixed in the plane, how many different ways can the corners of the\nsquare be colored if three colors are used?\n9.\n",
    "How many ways can the vertices of an equilateral triangle be colored using three\ndifferent colors?\n10.",
    "Find the number of ways a six-sided die can be constructed if each side is marked\ndifferently with 1, . .",
    ".",
    ", 6 dots.\n",
    "11.",
    "Up to a rotation, how many ways can the faces of a cube be colored with three different\ncolors?\n12.",
    "Consider 12 straight wires of equal lengths with their ends soldered together to form\nthe edges of a cube.",
    "Either silver or copper wire can be used for each edge.",
    "How many\ndifferent ways can the cube be constructed?\n13.",
    "Suppose that we color each of the eight corners of a cube.",
    "Using three different colors,\nhow many ways can the corners be colored up to a rotation of the cube?\n14.",
    "Each of the faces of a regular tetrahedron can be painted either red or white.",
    "Up to a\nrotation, how many different ways can the tetrahedron be painted?\n15.",
    "Suppose that the vertices of a regular hexagon are to be colored either red or white.\n",
    "How many ways can this be done up to a symmetry of the hexagon?\n16.",
    "A molecule of benzene is made up of six carbon atoms and six hydrogen atoms, linked\ntogether in a hexagonal shape as in Figure 14.28.\n",
    "(a) How many different compounds can be formed by replacing one or more of the\nhydrogen atoms with a chlorine atom?\n(b) Find the number of different chemical compounds that can be formed by replacing\nthree of the six hydrogen atoms in a benzene ring with a CH3 radical.\n",
    "H\nH\nH\nH\nH\nH\nFigure 14.28",
    "A benzene ring\n\nCHAPTER 14.",
    "GROUP ACTIONS\n180\n17.",
    "How many equivalence classes of switching functions are there if the input variables x1,\nx2, and x3 can be permuted by any permutation in S3?",
    "What if the input variables\nx1, x2, x3, and x4 can be permuted by any permutation in S4?\n18.",
    "How many equivalence classes of switching functions are there if the input variables x1,\nx2, x3, and x4 can be permuted by any permutation in the subgroup of S4 generated\nby the permutation (x1, x2, x3, x4)?\n19.",
    "A striped necktie has 12 bands of color.",
    "Each band can be colored by one of four\npossible colors.",
    "How many possible different-colored neckties are there?\n20.",
    "A group acts faithfully on a G-set X if the identity is the only element of G that leaves\nevery element of X fixed.",
    "Show that G acts faithfully on X if and only if no two\ndistinct elements of G have the same action on each element of X.\n21.",
    "Let p be prime.",
    "Show that the number of different abelian groups of order pn (up to\nisomorphism) is the same as the number of conjugacy classes in Sn.\n22.",
    "Let a ∈G. Show that for any g ∈G, gC(a)g−1 = C(gag−1).\n",
    "23.",
    "Let |G| = pn be a nonabelian group for p prime.",
    "Prove that |Z(G)| < pn−1.\n24.",
    "Let G be a group with order pn where p is prime and X a finite G-set.",
    "If XG = {x ∈\nX : gx",
    "= x for all g ∈G} is the set of elements in X fixed by the group action, then\nprove that |X| ≡|XG| (mod p).\n",
    "25.",
    "If G is a group of order pn, where p is prime and n ≥2, show that G must have a\nproper subgroup of order p.",
    "If n ≥3, is it true that G will have a proper subgroup of\norder p2?\n",
    "14.6 Programming Exercise\n1.\nWrite a program to compute the number of conjugacy classes in Sn.",
    "What is the largest\nn for which your program will work?\n14.7 References and Suggested Reading\n[1]\nDe Bruijin, N. G. “Pólya’s Theory of Counting,” in Applied Combinatorial Mathemat-\nics, Beckenbach, E. F., ed.",
    "Wiley, New York, 1964.\n",
    "[2]\nEidswick, J. A. “Cubelike Puzzles—What Are They and How Do You Solve Them?”\nAmerican Mathematical Monthly 93 (1986), 157–76.\n",
    "[3]\nHarary, F., Palmer, E. M., and Robinson, R. W. “Pólya’s Contributions to Chem-\nical Enumeration,” in Chemical Applications of Graph Theory, Balaban, A. T., ed.\n",
    "Academic Press, London, 1976.\n",
    "[4]\nGårding, L. and Tambour, T. Algebra for Computer Science.",
    "Springer-Verlag, New\nYork, 1988.\n",
    "[5]\nLaufer, H. B. Discrete Mathematics and Applied Modern Algebra.",
    "PWS-Kent, Boston,\n1984.\n",
    "[6]\nPólya, G. and Read, R. C. Combinatorial Enumeration of Groups, Graphs, and Chem-\nical Compounds.",
    "Springer-Verlag, New York, 1985.\n",
    "[7]\nShapiro, L. W. “Finite Groups Acting on Sets with Applications,” Mathematics Mag-\nazine, May–June 1973, 136–47.\n\n15\nThe Sylow Theorems\nWe already know that the converse of Lagrange’s",
    "Theorem is false.\n",
    "If G is a group of\norder m and n divides m, then G does not necessarily possess a subgroup of order n. For\nexample, A4 has order 12 but does not possess a subgroup of order 6.",
    "However, the Sylow\nTheorems do provide a partial converse for Lagrange’s Theorem—in certain cases they\nguarantee us subgroups of specific orders.",
    "These theorems yield a powerful set of tools for\nthe classification of all finite nonabelian groups.\n",
    "15.1 The Sylow Theorems\nWe will use what we have learned about group actions to prove the Sylow Theorems.",
    "Recall\nfor a moment what it means for G to act on itself by conjugation and how conjugacy\nclasses are distributed in the group according to the class equation, discussed in Chapter 14.\n",
    "A group G acts on itself by conjugation via the map (g, x) 7→gxg−1.",
    "Let x1, . .",
    ".",
    ", xk be\nrepresentatives from each of the distinct conjugacy classes of G that consist of more than\none element.",
    "Then the class equation can be written as\n|G| =",
    "|Z(G)| +",
    "[G : C(x1)]",
    "+ · · ·",
    "+",
    "[G : C(xk)],\nwhere Z(G) = {g ∈G :",
    "gx = xg for all x ∈G} is the center of G and C(xi)",
    "= {g ∈G :\ngxi = xig} is the centralizer subgroup of xi.\n",
    "We begin our investigation of the Sylow Theorems by examining subgroups of order p,\nwhere p is prime.",
    "A group G is a p-group if every element in G has as its order a power of\np, where p is a prime number.",
    "A subgroup of a group G is a p-subgroup if it is a p-group.\n",
    "Theorem 15.1\nCauchy.\n",
    "Let G be a finite group and p a prime such that p divides the\norder of G. Then G contains a subgroup of order p.\nProof.",
    "We will use induction on the order of G. If |G| = p, then clearly G itself is the\nrequired subgroup.",
    "We now assume that every group of order k, where p ≤k < n and p\ndivides k, has an element of order p. Assume that |G| = n and p | n and consider the class\nequation of G:\n|G| =",
    "|Z(G)|",
    "+",
    "[G : C(x1)]",
    "+ · · ·",
    "+",
    "[G : C(xk)].\n",
    "We have two cases.\n",
    "Case 1.\nSuppose the order of one of the centralizer subgroups, C(xi), is divisible by p for\nsome i, i = 1, . . .",
    ", k.",
    "In this case, by our induction hypothesis, we are done.",
    "Since C(xi)\nis a proper subgroup of G and p divides |C(xi)|, C(xi) must contain an element of order p.\n",
    "Hence, G must contain an element of order p.\n181\n\nCHAPTER 15.",
    "THE SYLOW THEOREMS\n182\nCase 2.\nSuppose the order of no centralizer subgroup is divisible by p.",
    "Then p divides\n",
    "[G : C(xi)], the order of each conjugacy class in the class equation; hence, p must divide\nthe center of G, Z(G).",
    "Since Z(G) is abelian, it must have a subgroup of order p by the\nFundamental Theorem of Finite Abelian Groups.",
    "Therefore, the center of G contains an\nelement of order p.\n■\nCorollary 15.2 Let G be a finite group.",
    "Then G is a p-group if and only if |G| = pn.\n",
    "Example 15.3 Let us consider the group A5.",
    "We know that |A5| = 60 = 22 · 3 · 5.",
    "By\nCauchy’s Theorem, we are guaranteed that A5 has subgroups of orders 2, 3 and 5.",
    "The\nSylow Theorems will give us even more information about the possible subgroups of A5.\n",
    "□\nWe are now ready to state and prove the first of the Sylow Theorems.",
    "The proof is very\nsimilar to the proof of Cauchy’s Theorem.\n",
    "Theorem 15.4 First Sylow Theorem.",
    "Let G be a finite group and p a prime such that\npr divides |G|.",
    "Then G contains a subgroup of order pr.\nProof.\n",
    "We induct on the order of G once again.",
    "If |G| = p, then we are done.",
    "Now\nsuppose that the order of G is n with n > p and that the theorem is true for all groups of\norder less than n, where p divides n. We shall apply the class equation once again:\n|G| =",
    "|Z(G)|",
    "+",
    "[G : C(x1)]",
    "+ · · ·",
    "+",
    "[G : C(xk)].\n",
    "First suppose that p does not divide [G : C(xi)] for some i. Then pr | |C(xi)|, since pr\ndivides |G| = |C(xi)| ·",
    "[G : C(xi)].",
    "Now we can apply the induction hypothesis to C(xi).\n",
    "Hence, we may assume that p divides [G : C(xi)] for all i.",
    "Since p divides |G|, the class\nequation says that p must divide |Z(G)|; hence, by Cauchy’s Theorem, Z(G) has an element\nof order p, say g. Let N be the group generated by g. Clearly, N is a normal subgroup\nof Z(G) since Z(G) is abelian; therefore, N is normal in G since every element in Z(G)\ncommutes with every element in G. Now consider the factor group G/N of order |G|/p.",
    "By\nthe induction hypothesis, G/N contains a subgroup H of order pr−1.",
    "The inverse image of\nH under the canonical homomorphism ϕ : G →G/N is a subgroup of order pr in G.\n■\nA Sylow p-subgroup P of a group G is a maximal p-subgroup of G. To prove the other\ntwo Sylow Theorems, we need to consider conjugate subgroups as opposed to conjugate\nelements in a group.",
    "For a group G, let S be the collection of all subgroups of G. For any\nsubgroup H, S is a H-set, where H acts on S by conjugation.",
    "That is, we have an action\nH × S →S\ndefined by\nh · K 7→hKh−1\nfor K in S.\n",
    "The set\nN(H) = {g ∈G : gHg−1 = H}\nis a subgroup of G called the the normalizer of H in G. Notice that H is a normal subgroup\nof N(H).",
    "In fact, N(H) is the largest subgroup of G in which H is normal.\n",
    "Lemma 15.5 Let P be a Sylow p-subgroup of a finite group G and let x have as its order\na power of p.",
    "If x−1Px = P, then x ∈P.\nProof.",
    "Certainly x ∈N(P), and the cyclic subgroup, ⟨xP⟩⊂N(P)/P, has as its order a\npower of p.",
    "By the Correspondence Theorem there exists a subgroup H of N(P) containing\nP such that H/P = ⟨xP⟩.",
    "Since |H| = |P| · |⟨xP⟩|, the order of H must be a power of p.\n",
    "However, P is a Sylow p-subgroup contained in H. Since the order of P is the largest power\nof p dividing |G|, H = P. Therefore, H/P is the trivial subgroup and xP = P, or x ∈P.\n\nCHAPTER 15.",
    "THE SYLOW THEOREMS\n183\n■\nLemma 15.6 Let H and K be subgroups of G.",
    "The number of distinct H-conjugates of K\nis [H : N(K) ∩H].\nProof.",
    "We define a bijection between the conjugacy classes of K and the right cosets of\nN(K) ∩H by h−1Kh 7→(N(K) ∩H)h.",
    "To show that this map is a bijection, let h1, h2 ∈H\nand suppose that (N(K) ∩H)h1 = (N(K) ∩H)h2.\n",
    "Then h2h−1\n1\n∈N(K).\n",
    "Therefore,\nK = h2h−1\n1 Kh1h−1\n2\nor h−1\n1 Kh1 = h−1\n2 Kh2, and the map is an injection.\n",
    "It is easy to\nsee that this map is surjective; hence, we have a one-to-one and onto map between the\nH-conjugates of K and the right cosets of N(K) ∩H in H.\n■\nTheorem 15.7 Second Sylow Theorem.",
    "Let G be a finite group and p a prime dividing\n|G|.",
    "Then all Sylow p-subgroups of G are conjugate.",
    "That is, if P1 and P2 are two Sylow\np-subgroups, there exists a g ∈G such that gP1g−1 = P2.\nProof.",
    "Let P be a Sylow p-subgroup of G and suppose that |G| = prm with |P| = pr.",
    "Let\nS = {P = P1, P2, . .",
    ".",
    ", Pk}\nconsist of the distinct conjugates of P in G. By Lemma 15.6, k =",
    "[G : N(P)].",
    "Notice that\n|G| = prm = |N(P)| ·",
    "[G : N(P)]",
    "= |N(P)| · k.\n",
    "Since pr divides |N(P)|, p cannot divide k.\nGiven any other Sylow p-subgroup Q, we must show that Q ∈S.\nConsider the Q-\nconjugacy classes of each Pi.",
    "Clearly, these conjugacy classes partition S. The size of the\npartition containing Pi is",
    "[Q : N(Pi) ∩Q]",
    "by Lemma 15.6, and Lagrange’s Theorem tells us\nthat |Q| =",
    "[Q : N(Pi) ∩Q]|N(Pi) ∩Q|.",
    "Thus, [Q : N(Pi) ∩Q] must be a divisor of |Q| = pr.\n",
    "Hence, the number of conjugates in every equivalence class of the partition is a power of\np.",
    "However, since p does not divide k, one of these equivalence classes must contain only a\nsingle Sylow p-subgroup, say Pj.",
    "In this case, x−1Pjx = Pj for all x ∈Q. By Lemma 15.5,\nPj = Q.\n■\nTheorem 15.8\nThird Sylow Theorem.",
    "Let G be a finite group and let p be a prime\ndividing the order of G.",
    "Then the number of Sylow p-subgroups is congruent to 1 (mod p)\nand divides |G|.\n",
    "Proof.",
    "Let P be a Sylow p-subgroup acting on the set of Sylow p-subgroups,\nS = {P = P1, P2, . . .",
    ", Pk},\nby conjugation.",
    "From the proof of the Second Sylow Theorem, the only P-conjugate of P\nis itself and the order of the other P-conjugacy classes is a power of p.",
    "Each P-conjugacy\nclass contributes a positive power of p toward |S| except the equivalence class {P}.",
    "Since\n|S| is the sum of positive powers of p and 1, |S| ≡1 (mod p).\n",
    "Now suppose that G acts on S by conjugation.",
    "Since all Sylow p-subgroups are conjugate,\nthere can be only one orbit under this action.",
    "For P ∈S,\n|S| = |orbit of P| =",
    "[G : N(P)]\nby Lemma 15.6.",
    "But [G : N(P)] is a divisor of |G|; consequently, the number of Sylow\np-subgroups of a finite group must divide the order of the group.\n",
    "■\n\nCHAPTER 15.",
    "THE SYLOW THEOREMS\n184\nHistorical Note\nPeter Ludvig Mejdell Sylow was born in 1832 in Christiania, Norway (now Oslo).",
    "After\nattending Christiania University, Sylow taught high school.",
    "In 1862 he obtained a temporary\nappointment at Christiania University.",
    "Even though his appointment was relatively brief,\nhe influenced students such as Sophus Lie (1842–1899).",
    "Sylow had a chance at a permanent\nchair in 1869, but failed to obtain the appointment.",
    "In 1872, he published a 10-page paper\npresenting the theorems that now bear his name.",
    "Later Lie and Sylow collaborated on a\nnew edition of Abel’s works.",
    "In 1898, a chair at Christiania University was finally created\nfor Sylow through the efforts of his student and colleague Lie.",
    "Sylow died in 1918.\n",
    "15.2 Examples and Applications\nExample 15.9 Using the Sylow Theorems, we can determine that A5 has subgroups of\norders 2, 3, 4, and 5.",
    "The Sylow p-subgroups of A5 have orders 3, 4, and 5.",
    "The Third\nSylow Theorem tells us exactly how many Sylow p-subgroups A5 has.",
    "Since the number of\nSylow 5-subgroups must divide 60 and also be congruent to 1 (mod 5), there are either one\nor six Sylow 5-subgroups in A5.",
    "All Sylow 5-subgroups are conjugate.",
    "If there were only\na single Sylow 5-subgroup, it would be conjugate to itself; that is, it would be a normal\nsubgroup of A5.",
    "Since A5 has no normal subgroups, this is impossible; hence, we have\ndetermined that there are exactly six distinct Sylow 5-subgroups of A5.\n",
    "□\nThe Sylow Theorems allow us to prove many useful results about finite groups.",
    "By\nusing them, we can often conclude a great deal about groups of a particular order if certain\nhypotheses are satisfied.\n",
    "Theorem 15.10 If p and q are distinct primes with p < q, then every group G of order\npq has a single subgroup of order q",
    "and this subgroup is normal in G. Hence, G cannot be\nsimple.",
    "Furthermore, if q ̸≡1 (mod p), then G is cyclic.\n",
    "Proof.",
    "We know that G contains a subgroup H of order q.",
    "The number of conjugates of\nH divides pq and is equal to 1 + kq for k",
    "= 0, 1, . .",
    "..",
    "However, 1 + q is already too large to\ndivide the order of the group; hence, H can only be conjugate to itself.",
    "That is, H must be\nnormal in G.\n",
    "The group G also has a Sylow p-subgroup, say K. The number of conjugates of K must\ndivide q and be equal to 1 + kp for k = 0, 1, . .",
    "..",
    "Since q is prime, either 1 + kp = q or\n1 + kp = 1.",
    "If 1 + kp = 1, then K is normal in G.",
    "In this case, we can easily show that G\nsatisfies the criteria, given in Chapter 9, for the internal direct product of H and K. Since\nH is isomorphic to Zq and K is isomorphic to Zp, G ∼= Zp ×",
    "Zq ∼= Zpq by Theorem 9.21.\n",
    "■\nExample 15.11 Every group of order 15 is cyclic.",
    "This is true because 15 = 5·3 and 5 ̸≡1\n(mod 3).\n",
    "□\nExample 15.12 Let us classify all of the groups of order 99 = 32 · 11 up to isomorphism.\n",
    "First we will show that every group G of order 99 is abelian.",
    "By the Third Sylow Theorem,\nthere are 1 + 3k Sylow 3-subgroups, each of order 9, for some k = 0, 1, 2, . .",
    "..",
    "Also, 1 + 3k\nmust divide 11; hence, there can only be a single normal Sylow 3-subgroup H in G. Similarly,\nthere are 1+11k Sylow 11-subgroups and 1+11k must divide 9.",
    "Consequently, there is only\none Sylow 11-subgroup K in G. By Corollary 14.16, any group of order p2 is abelian for p\nprime; hence, H is isomorphic either to Z3 ×",
    "Z3 or to Z9.",
    "Since K has order 11, it must\nbe isomorphic to Z11.",
    "Therefore, the only possible groups of order 99 are Z3 × Z3 ×",
    "Z11 or\nZ9 × Z11 up to isomorphism.\n",
    "□\nTo determine all of the groups of order 5 · 7 · 47 = 1645, we need the following theorem.\n\n",
    "CHAPTER 15.",
    "THE SYLOW THEOREMS\n185\nTheorem 15.13 Let G′ = ⟨aba−1b−1 : a, b ∈G⟩be the subgroup consisting of all finite\nproducts of elements of the form aba−1b−1 in a group",
    "G. Then G′ is a normal subgroup of\nG and G/G′ is abelian.\n",
    "The subgroup G′ of G is called the commutator subgroup of G.",
    "We leave the proof of\nthis theorem as an exercise (Exercise 10.4.14 in Chapter 10).\n",
    "Example 15.14 We will now show that every group of order 5·7·47",
    "= 1645 is abelian, and\ncyclic by Theorem 9.21.",
    "By the Third Sylow Theorem, G has only one subgroup H1 of order\n47.",
    "So G/H1 has order 35 and must be abelian by Theorem 15.10.",
    "Hence, the commutator\nsubgroup of G is contained in H which tells us that |G′| is either 1 or 47.",
    "If |G′| = 1, we\nare done.",
    "Suppose that |G′| = 47.",
    "The Third Sylow Theorem tells us that G has only one\nsubgroup of order 5 and one subgroup of order 7.",
    "So there exist normal subgroups H2 and\nH3 in G, where |H2| = 5 and |H3| = 7.",
    "In either case the quotient group is abelian; hence,\nG′ must be a subgroup of Hi, i = 1, 2.",
    "Therefore, the order of G′ is 1, 5, or 7.",
    "However, we\nalready have determined that |G′| = 1 or 47.",
    "So the commutator subgroup of G is trivial,\nand consequently G is abelian.\n",
    "□\nFinite Simple Groups\nGiven a finite group, one can ask whether or not that group has any normal subgroups.\n",
    "Recall that a simple group is one with no proper nontrivial normal subgroups.",
    "As in the\ncase of A5, proving a group to be simple can be a very diﬀicult task; however, the Sylow\nTheorems are useful tools for proving that a group is not simple.",
    "Usually, some sort of\ncounting argument is involved.\n",
    "Example 15.15 Let us show that no group G of order 20 can be simple.",
    "By the Third\nSylow Theorem, G contains one or more Sylow 5-subgroups.",
    "The number of such subgroups\nis congruent to 1 (mod 5) and must also divide 20.",
    "The only possible such number is 1.\n",
    "Since there is only a single Sylow 5-subgroup and all Sylow 5-subgroups are conjugate, this\nsubgroup must be normal.\n",
    "□\nExample 15.16 Let G be a finite group of order pn, n > 1 and p prime.",
    "By Theorem 14.15,\nG has a nontrivial center.",
    "Since the center of any group G is a normal subgroup, G cannot\nbe a simple group.",
    "Therefore, groups of orders 4, 8, 9, 16, 25, 27, 32, 49, 64, and 81 are not\nsimple.",
    "In fact, the groups of order 4, 9, 25, and 49 are abelian by Corollary 14.16.\n",
    "□\nExample 15.17",
    "No group of order 56 = 23 · 7 is simple.",
    "We have seen that if we can show\nthat there is only one Sylow p-subgroup for some prime p dividing 56, then this must be a\nnormal subgroup and we are done.",
    "By the Third Sylow Theorem, there are either one or\neight Sylow 7-subgroups.",
    "If there is only a single Sylow 7-subgroup, then it must be normal.\n",
    "On the other hand, suppose that there are eight Sylow 7-subgroups.",
    "Then each of these\nsubgroups must be cyclic; hence, the intersection of any two of these subgroups contains\nonly the identity of the group.",
    "This leaves 8 · 6 = 48 distinct elements in the group, each\nof order 7.\n",
    "Now let us count Sylow 2-subgroups.\n",
    "There are either one or seven Sylow\n2-subgroups.",
    "Any element of a Sylow 2-subgroup other than the identity must have as its\norder a power of 2; and therefore cannot be one of the 48 elements of order 7 in the Sylow\n7-subgroups.",
    "Since a Sylow 2-subgroup has order 8, there is only enough room for a single\nSylow 2-subgroup in a group of order 56.",
    "If there is only one Sylow 2-subgroup, it must be\nnormal.\n",
    "□\nFor other groups G, it is more diﬀicult to prove that G is not simple.",
    "Suppose G has\norder 48.",
    "In this case the technique that we employed in the last example will not work.\n",
    "We need the following lemma to prove that no group of order 48 is simple.\n\n",
    "CHAPTER 15.",
    "THE SYLOW THEOREMS\n186\nLemma 15.18 Let H and K be finite subgroups of a group G. Then\n|HK| = |H| · |K|\n|H ∩K| .\nProof.",
    "Recall that\nHK = {hk : h ∈H, k ∈K}.\n",
    "Certainly, |HK| ≤|H| · |K| since some element in HK could be written as the product of\ndifferent elements in H and K.",
    "It is quite possible that h1k1 = h2k2 for h1, h2 ∈H and\nk1, k2 ∈K.",
    "If this is the case, let\na = (h1)−1h2 = k1(k2)−1.\n",
    "Notice that a ∈H ∩K, since (h1)−1h2 is in H and k2(k1)−1 is in K; consequently,\nh2 = h1a−1\nk2 = ak1.\n",
    "Conversely, let h = h1b−1 and k = bk1 for b ∈H ∩K.",
    "Then hk = h1k1, where h ∈H\nand k ∈K.",
    "Hence, any element hk ∈HK can be written in the form hiki for hi ∈H and\nki ∈K, as many times as there are elements in H ∩K; that is, |H ∩K| times.",
    "Therefore,\n|HK| = (|H| · |K|)/|H ∩K|.\n",
    "■\nExample 15.19 To demonstrate that a group G of order 48 is not simple, we will show\nthat G contains either a normal subgroup of order 8 or a normal subgroup of order 16.",
    "By\nthe Third Sylow Theorem, G has either one or three Sylow 2-subgroups of order 16.",
    "If there\nis only one subgroup, then it must be a normal subgroup.\n",
    "Suppose that the other case is true, and two of the three Sylow 2-subgroups are H and\n",
    "K.",
    "We claim that |H ∩K| = 8.",
    "If |H ∩K| ≤4, then by Lemma 15.18,\n|HK| ≥16 · 16\n4\n= 64,\nwhich is impossible.",
    "Notice that H ∩K has index two in both of H and K, so is normal in\nboth, and thus H and K are each in the normalizer of H ∩K. Because H is a subgroup of\nN(H ∩K) and because N(H ∩K) has strictly more than 16 elements, |N(H ∩K)| must\nbe a multiple of 16 greater than 1, as well as dividing 48.\n",
    "The only possibility is that\n|N(H ∩K)| = 48.",
    "Hence, N(H ∩K) = G.\n□\nThe following famous conjecture of Burnside was proved in a long and diﬀicult paper\nby Feit and Thompson",
    "[2].\n",
    "Theorem 15.20\nOdd Order Theorem.",
    "Every finite simple group of nonprime order\nmust be of even order.\n",
    "The proof of this theorem laid the groundwork for a program in the 1960s and 1970s\nthat classified all finite simple groups.",
    "The success of this program is one of the outstanding\nachievements of modern mathematics.\n",
    "Sage.\n",
    "Sage will compute a single Sylow p-subgroup for each prime divisor p of the order\nof the group.",
    "Then, with conjugacy, all of the Sylow p-subgroups can be enumerated.",
    "It is\nalso possible to compute the normalizer of a subgroup.\n\n",
    "CHAPTER 15.",
    "THE SYLOW THEOREMS\n187\n15.3 Reading Questions\n1.\n",
    "State Sylow’s First Theorem.\n",
    "2.\n",
    "How many groups are there of order 69?",
    "Why?\n3.\nGive two descriptions, fundamentally different in character, of the normalizer of a\nsubgroup.\n",
    "4.\nSuppose that G is an abelian group.",
    "What is the commutator subgroup of G, and how\ndo you know?\n5.\n",
    "What’s all the fuss about Sylow’s Theorems?\n15.4 Exercises\n1.\n",
    "What are the orders of all Sylow p-subgroups where G has order 18, 24, 54, 72, and\n80?\n",
    "2.\nFind all the Sylow 3-subgroups of S4 and show that they are all conjugate.\n",
    "3.\nShow that every group of order 45 has a normal subgroup of order 9.\n4.\nLet H be a Sylow p-subgroup of G. Prove that H is the only Sylow p-subgroup of G\ncontained in N(H).\n",
    "5.\nProve that no group of order 96 is simple.\n",
    "6.\nProve that no group of order 160 is simple.\n",
    "7.\n",
    "If H is a normal subgroup of a finite group G and |H| = pk for some prime p, show\nthat H is contained in every Sylow p-subgroup of G.\n8.\n",
    "Let G be a group of order p2q2, where p and q are distinct primes such that q ∤p2 −1\nand p ∤q2 −1.",
    "Prove that G must be abelian.",
    "Find a pair of primes for which this is\ntrue.\n",
    "9.\nShow that a group of order 33 has only one Sylow 3-subgroup.\n10.",
    "Let H be a subgroup of a group G. Prove or disprove that the normalizer of H is\nnormal in G.\n11.",
    "Let G be a finite group whose order is divisible by a prime p.",
    "Prove that if there is\nonly one Sylow p-subgroup in G, it must be a normal subgroup of G.\n12.",
    "Let G be a group of order pr, p prime.",
    "Prove that G contains a normal subgroup of\norder pr−1.\n13.",
    "Suppose that G is a finite group of order pnk, where k < p. Show that G must contain\na normal subgroup.\n",
    "14.",
    "Let H be a subgroup of a finite group G. Prove that gN(H)g−1 = N(gHg−1) for any\ng ∈G.\n15.",
    "Prove that a group of order 108 must have a normal subgroup.\n16.",
    "Classify all the groups of order 175 up to isomorphism.\n",
    "17.",
    "Show that every group of order 255 is cyclic.\n18.",
    "Let G have order pe1\n1 · · · pen\nn and suppose that G has n Sylow p-subgroups P1, . . .",
    ", Pn\nwhere |Pi| = pei\ni .",
    "Prove that G is isomorphic to P1 × · · · ×",
    "Pn.\n19.",
    "Let P be a normal Sylow p-subgroup of G.",
    "Prove that every inner automorphism of G\nfixes P.\n20.",
    "What is the smallest possible order of a group G such that G is nonabelian and |G| is\nodd?",
    "Can you find such a group?\n\nCHAPTER 15.",
    "THE SYLOW THEOREMS\n188\n21.",
    "The Frattini Lemma.\n",
    "If H is a normal subgroup of a finite group G and P is\na Sylow p-subgroup of H, for each g ∈G show that there is an h in H such that\ngPg−1 = hPh−1.",
    "Also, show that if N is the normalizer of P, then G = HN.\n22.",
    "Show that if the order of G is pnq, where p and q are primes and p > q, then G contains\na normal subgroup.\n",
    "23.",
    "Prove that the number of distinct conjugates of a subgroup H of a finite group G is\n",
    "[G : N(H)].\n",
    "24.",
    "Prove that a Sylow 2-subgroup of S5 is isomorphic to D4.\n",
    "25.",
    "Another Proof of the Sylow Theorems.\n",
    "(a) Suppose p is prime and p does not divide m. Show that\np ∤\n\u0012pkm\npk\n\u0013\n.\n",
    "(b) Let S denote the set of all pk element subsets of G. Show that p does not divide\n|S|.\n(c) Define an action of G on S by left multiplication, aT = {at : t ∈T} for a ∈G\nand T ∈S.",
    "Prove that this is a group action.\n",
    "(d) Prove p ∤|OT | for some T ∈S.\n(e) Let {T1, . . .",
    ", Tu} be an orbit such that p ∤u and H = {g ∈G : gT1 = T1}.",
    "Prove\nthat H is a subgroup of G and show that |G| = u|H|.\n(f) Show that pk divides |H| and pk ≤|H|.\n",
    "(g) Show that |H| = |OT | ≤pk; conclude that therefore pk = |H|.\n",
    "26.",
    "Let G be a group.",
    "Prove that G′ = ⟨aba−1b−1 : a, b ∈G⟩is a normal subgroup of\nG and G/G′ is abelian.",
    "Find an example to show that {aba−1b−1 : a, b ∈G} is not\nnecessarily a group.\n",
    "15.5 A Project\nThe main objective of finite group theory is to classify all possible finite groups up to\nisomorphism.",
    "This problem is very diﬀicult even if we try to classify the groups of order\nless than or equal to 60.",
    "However, we can break the problem down into several intermediate\nproblems.",
    "This is a challenging project that requires a working knowledge of the group\ntheory you have learned up to this point.",
    "Even if you do not complete it, it will teach you\na great deal about finite groups.",
    "You can use Table 15.21 as a guide.\n\n",
    "CHAPTER 15.",
    "THE SYLOW THEOREMS\n189\nTable 15.21 Numbers of distinct groups G, |G| ≤60\nOrder\nNumber\nOrder\nNumber\nOrder\nNumber\nOrder\nNumber\n1\n?\n16\n14\n31\n1\n46\n2\n2\n?\n17\n1\n32\n51\n47\n1\n3\n?\n18\n?\n33\n1\n48\n52\n4\n?\n19\n?\n34\n?\n49\n?\n5\n?\n20\n5\n35\n1\n50\n5\n6\n?\n21\n?\n36\n14\n51\n?\n7\n?\n22\n2\n37\n1\n52\n?\n8\n?\n23\n1\n38\n?\n53\n?\n9\n?\n24\n?\n39\n2\n54\n15\n10\n?\n25\n2\n40\n14\n55\n2\n11\n?\n26\n2\n41\n1\n56\n?\n12\n5\n27\n5\n42\n?\n57\n2\n13\n?\n28\n?\n43\n1\n58\n?\n14\n?\n29\n1\n44\n4\n59\n1\n15\n1\n30\n4\n45\n?\n60\n13\n1.\nFind all simple groups G ( |G| ≤60).",
    "Do not use the Odd Order Theorem unless you\nare prepared to prove it.\n",
    "2.\nFind the number of distinct groups G, where the order of G is n for n = 1, . . .",
    ", 60.\n3.\nFind the actual groups (up to isomorphism) for each n.\n15.6 References and Suggested Readings\n[1]\nEdwards, H. “A Short History of the Fields Medal,” Mathematical Intelligencer 1\n(1978), 127–29.\n",
    "[2]\nFeit, W. and Thompson, J. G. “Solvability of Groups of Odd Order,” Pacific Journal\nof Mathematics 13 (1963), 775–1029.\n",
    "[3]\nGallian, J. A. “The Search for Finite Simple Groups,” Mathematics Magazine 49\n(1976), 163–79.\n",
    "[4]\nGorenstein, D. “Classifying the Finite Simple Groups,” Bulletin of the American\nMathematical Society 14 (1986), 1–98.\n",
    "[5]\nGorenstein, D. Finite Groups.",
    "AMS Chelsea Publishing, Providence RI, 1968.\n",
    "[6]\nGorenstein, D., Lyons, R., and Solomon, R. The Classification of Finite Simple Groups.\n",
    "American Mathematical Society, Providence RI, 1994.\n\n",
    "16\nRings\nUp to this point we have studied sets with a single binary operation satisfying certain axioms,\nbut we are often more interested in working with sets that have two binary operations.",
    "For\nexample, one of the most natural algebraic structures to study is the integers with the\noperations of addition and multiplication.",
    "These operations are related to one another by\nthe distributive property.\n",
    "If we consider a set with two such related binary operations\nsatisfying certain axioms, we have an algebraic structure called a ring.",
    "In a ring we add\nand multiply elements such as real numbers, complex numbers, matrices, and functions.\n",
    "16.1 Rings\nA nonempty set R is a ring if it has two closed binary operations, addition and multiplication,\nsatisfying the following conditions.\n",
    "1.",
    "a + b = b + a for a, b ∈R.\n2. (a + b)",
    "+",
    "c = a + (b + c) for a, b, c ∈R.\n3.",
    "There is an element 0 in R such that a + 0 = a for all a ∈R.\n4.",
    "For every element a ∈R, there exists an element −a in R such that a + (−a) = 0.\n",
    "5.",
    "(ab)c = a(bc) for a, b, c ∈R.\n6.",
    "For a, b, c ∈R,\na(b + c) = ab + ac\n(a + b)c = ac + bc.\n",
    "This last condition, the distributive axiom, relates the binary operations of addition and\nmultiplication.",
    "Notice that the first four axioms simply require that a ring be an abelian\ngroup under addition, so we could also have defined a ring to be an abelian group (R, +)\ntogether with a second binary operation satisfying the fifth and sixth conditions given above.\n",
    "If there is an element 1 ∈R such that 1 ̸= 0 and 1a = a1 = a for each element a ∈R,\nwe say that R is a ring with unity or identity.",
    "A ring R for which ab",
    "= ba for all a, b in\nR is called a commutative ring.\n",
    "A commutative ring R with identity is called an integral\ndomain if, for every a, b ∈R such that ab = 0, either a = 0 or b = 0.",
    "A division ring\nis a ring R, with an identity, in which every nonzero element in R is a unit; that is, for\neach a ∈R with a ̸= 0, there exists a unique element a−1 such that a−1a = aa−1 = 1.",
    "A\n190\n\nCHAPTER 16.",
    "RINGS\n191\ncommutative division ring is called a field.",
    "The relationship among rings, integral domains,\ndivision rings, and fields is shown in Figure 16.1.\n",
    "Rings\nCommutative\nRings\nRings with\nIdentity\nIntegral\nDomains\nDivision\nRings\nFields\nFigure 16.1 Types of rings\nExample 16.2 As we have mentioned previously, the integers form a ring.",
    "In fact, Z is\nan integral domain.",
    "Certainly if ab = 0 for two integers a and b, either a = 0 or b = 0.\n",
    "However, Z is not a field.",
    "There is no integer that is the multiplicative inverse of 2, since\n1/2 is not an integer.",
    "The only integers with multiplicative inverses are 1 and −1.\n",
    "□\nExample 16.3 Under the ordinary operations of addition and multiplication, all of the\nfamiliar number systems are rings: the rationals, Q; the real numbers, R; and the complex\nnumbers, C. Each of these rings is a field.\n",
    "□\nExample 16.4",
    "We can define the product of two elements a and b in Zn by ab (mod n).\n",
    "For instance, in Z12, 5 · 7 ≡11 (mod 12).",
    "This product makes the abelian group Zn into\na ring.",
    "Certainly Zn is a commutative ring; however, it may fail to be an integral domain.\n",
    "If we consider 3 · 4 ≡0 (mod 12) in Z12, it is easy to see that a product of two nonzero\nelements in the ring can be equal to zero.\n",
    "□\nA nonzero element a in a commutative ring R is called a zero divisor if there is a nonzero\nelement b in R such that ab = 0.",
    "In the previous example, 3 and 4 are zero divisors in Z12.\n",
    "Example 16.5 In calculus the continuous real-valued functions on an interval [a, b] form a\ncommutative ring.",
    "We add or multiply two functions by adding or multiplying the values\nof the functions.",
    "If f(x) = x2 and g(x) = cos x, then (f + g)(x) = f(x) + g(x) = x2 + cos x\nand (fg)(x) = f(x)g(x)",
    "= x2 cos x.\n□\nExample 16.6 The 2×2 matrices with entries in R form a ring under the usual operations\nof matrix addition and multiplication.",
    "This ring is noncommutative, since it is usually the\ncase that AB ̸= BA.",
    "Also, notice that we can have AB = 0 when neither A nor B is zero.\n",
    "□\nExample 16.7 For an example of a noncommutative division ring, let\n1 =\n\u00121\n0\n0\n1\n\u0013\n,\ni =\n\u0012 0\n1\n−1\n0\n\u0013\n,\nj =\n\u00120\ni\ni\n0\n\u0013\n,\nk =\n\u0012i\n0\n0\n−i\n\u0013\n,\nwhere i2 = −1.",
    "These elements satisfy the following relations:\ni2 = j2 = k2 = −1\n\nCHAPTER 16.",
    "RINGS\n192\nij = k\njk",
    "=",
    "i\nki = j\nji = −k\nkj = −i\nik = −j.\n",
    "Let H consist of elements of the form a + bi + cj + dk, where a, b, c, d are real numbers.\n",
    "Equivalently, H can be considered to be the set of all 2 × 2 matrices of the form\n\u0012 α\nβ\n−β\nα\n\u0013\n,\nwhere α = a + di and β = b + ci are complex numbers.\n",
    "We can define addition and\nmultiplication on H either by the usual matrix operations or in terms of the generators 1, i,\nj, and k:\n(a1 + b1i + c1j + d1k)",
    "+ (a2 + b2i + c2j + d2k)\n= (a1 + a2)",
    "+ (b1 + b2)i + (c1 + c2)j + (d1 + d2)k\nand\n(a1 + b1i + c1j",
    "+ d1k)(a2",
    "+ b2i + c2j + d2k) = α",
    "+ βi + γj + δk,\nwhere\n",
    "α = a1a2 −b1b2 −c1c2 −d1d2\nβ",
    "= a1b2",
    "+ a2b1",
    "+ c1d2 −d1c2\n",
    "γ = a1c2 −b1d2",
    "+",
    "c1a2",
    "+ d1b2\nδ = a1d2 + b1c2 −c1b2 + d1a2.\n",
    "Though multiplication looks complicated, it is actually a straightforward computation if\nwe remember that we just add and multiply elements in H like polynomials and keep in\nmind the relationships between the generators i, j, and",
    "k.",
    "The ring H is called the ring of\nquaternions.\n",
    "To show that the quaternions are a division ring, we must be able to find an inverse for\neach nonzero element.",
    "Notice that\n(a + bi + cj + dk)(a −bi −cj −dk) = a2 + b2 + c2 + d2.\n",
    "This element can be zero only if a, b, c, and d are all zero.",
    "So if a + bi + cj + dk ̸= 0,\n(a + bi + cj + dk",
    ")\n\u0012 a −bi −cj −dk\na2 + b2 + c2 + d2\n\u0013\n= 1.\n□\nProposition 16.8 Let R be a ring with a, b ∈R.",
    "Then\n1.",
    "a0 = 0a = 0;\n2. a(−b)",
    "= (−a)b = −ab;\n3. (−a)(−b) = ab.\n\n",
    "CHAPTER 16.",
    "RINGS\n193\nProof.",
    "To prove (1), observe that\na0 = a(0 + 0) = a0 + a0;\nhence, a0 = 0.",
    "Similarly, 0a = 0.",
    "For (2), we have ab + a(−b)",
    "= a(b −b)",
    "=",
    "a0 = 0;\nconsequently, −ab = a(−b).",
    "Similarly, −ab = (−a)b.",
    "Part (3) follows directly from (2) since\n(−a)(−b) = −(a(−b))",
    "= −(−ab) = ab.\n",
    "■\nJust as we have subgroups of groups, we have an analogous class of substructures for\nrings.",
    "A subring S of a ring R is a subset S of R such that S is also a ring under the\ninherited operations from R.\nExample 16.9 The ring nZ is a subring of Z. Notice that even though the original ring\nmay have an identity, we do not require that its subring have an identity.",
    "We have the\nfollowing chain of subrings:\nZ ⊂Q ⊂R ⊂C.\n□\nThe following proposition gives us some easy criteria for determining whether or not\na subset of a ring is indeed a subring.",
    "(We will leave the proof of this proposition as an\nexercise.)\n",
    "Proposition 16.10 Let R be a ring and S a subset of R. Then S is a subring of R",
    "if and\nonly if the following conditions are satisfied.\n",
    "1. S ̸= ∅.\n2.",
    "rs ∈S for all r, s ∈S.\n3.",
    "r −s ∈S for all r, s ∈S.\nExample 16.11 Let R = M2(R) be the ring of 2 × 2 matrices with entries in R. If T is the\nset of upper triangular matrices in R; i.e.,\nT =\n\u001a\u0012a\nb\n0\nc\n\u0013\n: a, b, c ∈R\n\u001b\n,\nthen T is a subring of R. If\nA =\n\u0012a\nb\n0\nc\n\u0013\nand\nB =\n\u0012a′\nb′\n0\nc′\n\u0013\nare in T, then clearly A −B is also in T. Also,\nAB =\n\u0012aa′\nab′ + bc′\n0\ncc′\n\u0013\nis in T.\n□\n16.2 Integral Domains and Fields\nLet us briefly recall some definitions.",
    "If R is a commutative ring and r is a nonzero element\nin R, then r is said to be a zero divisor if there is some nonzero element s ∈R such that\nrs = 0.",
    "A commutative ring with identity is said to be an integral domain if it has no zero\ndivisors.",
    "If an element a in a ring R with identity has a multiplicative inverse, we say that\na is a unit.",
    "If every nonzero element in a ring R is a unit, then R is called a division ring.\n\n",
    "CHAPTER 16.",
    "RINGS\n194\nA commutative division ring is called a field.\n",
    "Example 16.12 If i2 = −1, then the set Z[i] = {m +",
    "ni : m, n ∈Z} forms a ring known\nas the Gaussian integers.\n",
    "It is easily seen that the Gaussian integers are a subring of the\ncomplex numbers since they are closed under addition and multiplication.",
    "Let α = a + bi\nbe a unit in Z[i].",
    "Then α = a −bi is also a unit since if αβ = 1, then αβ = 1.",
    "If β = c + di,\nthen\n1 = αβαβ = (a2 + b2)(c2 + d2).\n",
    "Therefore, a2 + b2 must either be 1 or −1; or, equivalently, a + bi = ±1 or a + bi = ±i.\n",
    "Therefore, units of this ring are ±1 and ±i; hence, the Gaussian integers are not a field.",
    "We\nwill leave it as an exercise to prove that the Gaussian integers are an integral domain.\n",
    "□\nExample 16.13 The set of matrices\nF =\n\u001a\u00121\n0\n0\n1\n\u0013\n,\n\u00121\n1\n1\n0\n\u0013\n,\n\u00120\n1\n1\n1\n\u0013\n,\n\u00120\n0\n0\n0\n\u0013\u001b\nwith entries in Z2 forms a field.\n",
    "□\nExample 16.14",
    "The set Q(\n√\n2 ) = {a+b\n√\n2 : a, b ∈Q} is a field.",
    "The inverse of an element\na + b\n√\n2 in Q(\n√\n2 ) is\na\na2 −2b2 +\n−b\na2 −2b2\n√\n2.\n□\nWe have the following alternative characterization of integral domains.\n",
    "Proposition 16.15 Cancellation Law.",
    "Let D be a commutative ring with identity.",
    "Then\nD is an integral domain if and only if for all nonzero elements a ∈D with ab = ac, we have\nb = c.\nProof.",
    "Let D be an integral domain.",
    "Then D has no zero divisors.",
    "Let ab = ac with\na ̸= 0.",
    "Then a(b −c) = 0.",
    "Hence, b −c = 0 and b = c.\nConversely, let us suppose that cancellation is possible in D. That is, suppose that\nab = ac implies b = c. Let ab = 0.",
    "If a ̸= 0, then ab = a0 or b = 0.",
    "Therefore, a cannot be\na zero divisor.\n",
    "■\nThe following surprising theorem is due to Wedderburn.\n",
    "Theorem 16.16",
    "Every finite integral domain is a field.\n",
    "Proof.",
    "Let D be a finite integral domain and D∗be the set of nonzero elements of D. We\nmust show that every element in D∗has an inverse.",
    "For each a ∈D∗we can define a map\nλa : D∗→D∗by λa(d) = ad.",
    "This map makes sense, because if a ̸= 0 and d ̸= 0, then\nad ̸= 0.",
    "The map λa is one-to-one, since for d1, d2 ∈D∗,\nad1 = λa(d1) = λa(d2)",
    "= ad2\nimplies d1 = d2 by left cancellation.",
    "Since D∗is a finite set, the map λa must also be\nonto; hence, for some d ∈D∗, λa(d) = ad = 1.",
    "Therefore, a has a left inverse.",
    "Since D is\ncommutative, d must also be a right inverse for a. Consequently, D is a field.\n",
    "■\nFor any nonnegative integer n and any element r in a ring R we write r + · · ·",
    "+ r (n\ntimes) as nr.",
    "We define the characteristic of a ring R to be the least positive integer n such\nthat nr = 0 for all r ∈R.",
    "If no such integer exists, then the characteristic of R is defined\nto be 0.",
    "We will denote the characteristic of R by char R.\nExample 16.17 For every prime p, Zp is a field of characteristic p.",
    "By Proposition 3.4,\nevery nonzero element in Zp has an inverse; hence, Zp is a field.",
    "If a is any nonzero element\n\nCHAPTER 16.",
    "RINGS\n195\nin the field, then pa = 0, since the order of any nonzero element in the abelian group Zp is\np.\n□\nLemma 16.18 Let R be a ring with identity.",
    "If 1 has order n, then the characteristic of R\nis n.\nProof.",
    "If 1 has order n, then n is the least positive integer such that n1 = 0.",
    "Thus, for\nall r ∈R,\nnr = n(1r) = (n1)r = 0r = 0.\n",
    "On the other hand, if no positive n exists such that n1 = 0, then the characteristic of R is\nzero.\n",
    "■\nTheorem 16.19 The characteristic of an integral domain is either prime or zero.\nProof.",
    "Let D be an integral domain and suppose that the characteristic of D is n with\nn ̸= 0.",
    "If n is not prime, then n = ab, where 1 < a < n and 1 < b < n. By Lemma 16.18,\nwe need only consider the case n1 = 0.",
    "Since 0 = n1 = (ab)1 = (a1)(b1) and there are no\nzero divisors in D, either a1 = 0 or b1 = 0.",
    "Hence, the characteristic of D must be less than\nn, which is a contradiction.",
    "Therefore, n must be prime.\n",
    "■\n16.3 Ring Homomorphisms and Ideals\nIn the study of groups, a homomorphism is a map that preserves the operation of the\ngroup.",
    "Similarly, a homomorphism between rings preserves the operations of addition and\nmultiplication in the ring.",
    "More specifically, if R and S are rings, then a ring homomorphism\nis a map ϕ :",
    "R →S satisfying\nϕ(a + b) = ϕ(a) + ϕ(b)\nϕ(ab) = ϕ(a)ϕ(b)\nfor all a,",
    "b ∈R.",
    "If ϕ : R →S is a one-to-one and onto homomorphism, then ϕ is called an\nisomorphism of rings.\n",
    "The set of elements that a ring homomorphism maps to 0 plays a fundamental role in\nthe theory of rings.",
    "For any ring homomorphism ϕ : R →S, we define the kernel of a ring\nhomomorphism to be the set\nker ϕ = {r ∈R : ϕ(r)",
    "= 0}.\n",
    "Example 16.20 For any integer n we can define a ring homomorphism ϕ : Z →Zn by\na 7→a (mod n).",
    "This is indeed a ring homomorphism, since\nϕ(a + b) = (a + b)\n(mod n)\n= a\n(mod n) + b\n(mod n)\n= ϕ(a) + ϕ(b)\nand\nϕ(ab) = ab\n(mod n)\n= a\n(mod n) · b\n(mod n)\n= ϕ(a)ϕ(b).\n",
    "The kernel of the homomorphism ϕ is nZ.\n□\nExample 16.21 Let C[a, b] be the ring of continuous real-valued functions on an interval\n[a, b] as in Example 16.5.\n",
    "For a fixed α ∈[a, b], we can define a ring homomorphism\n\nCHAPTER 16.",
    "RINGS\n196\nϕα : C[a, b] →R by ϕα(f) = f(α).",
    "This is a ring homomorphism since\nϕα(f",
    "+ g) = (f + g)(α) = f(α) +",
    "g(α) = ϕα(f)",
    "+ ϕα(g)\nϕα(fg) = (fg)(α) = f(α)g(α) = ϕα(f)ϕα(g).\n",
    "Ring homomorphisms of the type ϕα are called evaluation homomorphisms.\n",
    "□\nIn the next proposition we will examine some fundamental properties of ring homomor-\nphisms.",
    "The proof of the proposition is left as an exercise.\n",
    "Proposition 16.22 Let ϕ :",
    "R →S be a ring homomorphism.\n",
    "1.",
    "If R is a commutative ring, then ϕ(R) is a commutative ring.\n",
    "2. ϕ(0) = 0.\n",
    "3. Let 1R and 1S be the identities for R and S, respectively.",
    "If ϕ is onto, then ϕ(1R) = 1S.\n4.",
    "If R is a field and ϕ(R)",
    "̸= {0}, then ϕ(R) is a field.\n",
    "In group theory we found that normal subgroups play a special role.",
    "These subgroups\nhave nice characteristics that make them more interesting to study than arbitrary subgroups.\n",
    "In ring theory the objects corresponding to normal subgroups are a special class of subrings\ncalled ideals.",
    "An ideal in a ring R is a subring I of R such that if a is in I and r is in R,\nthen both ar and ra are in I; that is, rI ⊂I and Ir ⊂I for all r ∈R.\nExample 16.23",
    "Every ring R has at least two ideals, {0} and R. These ideals are called\nthe trivial ideals.\n",
    "□\nLet R be a ring with identity and suppose that I is an ideal in R such that 1 is in I.\n",
    "Since for any r ∈R, r1 = r ∈I by the definition of an ideal, I = R.\nExample 16.24",
    "If a is any element in a commutative ring R with identity, then the set\n⟨a⟩= {ar : r ∈R}\nis an ideal in R. Certainly, ⟨a⟩is nonempty since both 0 = a0 and a = a1 are in ⟨a⟩. The\nsum of two elements in ⟨a⟩is again in ⟨a⟩since ar + ar′ = a(r + r′).",
    "The inverse of ar is\n−ar = a(−r) ∈⟨a⟩.",
    "Finally, if we multiply an element ar ∈⟨a⟩by an arbitrary element\ns ∈R, we have s(ar) = a(sr).",
    "Therefore, ⟨a⟩satisfies the definition of an ideal.\n",
    "□\nIf R is a commutative ring with identity, then an ideal of the form ⟨a⟩= {ar : r ∈R}\nis called a principal ideal.\n",
    "Theorem 16.25",
    "Every ideal in the ring of integers Z is a principal ideal.\n",
    "Proof.",
    "The zero ideal {0} is a principal ideal since ⟨0⟩= {0}.",
    "If I is any nonzero ideal\nin Z, then I must contain some positive integer m. There exists a least positive integer n\nin I by the Principle of Well-Ordering.",
    "Now let a be any element in I. Using the division\nalgorithm, we know that there exist integers q and r",
    "such that\na = nq + r\nwhere 0",
    "≤r < n.",
    "This equation tells us that r = a −nq ∈I, but r must be 0 since n is the\nleast positive element in I. Therefore, a = nq and I = ⟨n⟩.\n■\nExample 16.26 The set nZ is ideal in the ring of integers.",
    "If na is in nZ and b is in Z,\nthen nab is in nZ as required.",
    "In fact, by Theorem 16.25, these are the only ideals of Z.\n□\nProposition 16.27",
    "The kernel of any ring homomorphism ϕ : R →S is an ideal in R.\n\nCHAPTER 16.",
    "RINGS\n197\nProof.",
    "We know from group theory that ker ϕ is an additive subgroup of R. Suppose",
    "that\nr ∈R and a ∈ker ϕ.",
    "Then we must show that ar and ra are in ker ϕ.",
    "However,\nϕ(ar) = ϕ(a)ϕ(r) = 0ϕ(r)",
    "= 0\nand\nϕ(ra)",
    "= ϕ(r)ϕ(a)",
    "= ϕ(r)0 = 0.\n■\nRemark 16.28 In our definition of an ideal we have required that rI ⊂I and Ir ⊂I for\nall r ∈R.",
    "Such ideals are sometimes referred to as two-sided ideals.",
    "We can also consider\none-sided ideals; that is, we may require only that either rI ⊂I or Ir ⊂I for r ∈R hold\nbut not both.",
    "Such ideals are called left ideals and right ideals, respectively.",
    "Of course, in a\ncommutative ring any ideal must be two-sided.",
    "In this text we will concentrate on two-sided\nideals.\n",
    "Theorem 16.29 Let I be an ideal of R. The factor group R/I is a ring with multiplication\ndefined by\n(r + I)(s + I) = rs + I.\nProof.",
    "We already know that R/I is an abelian group under addition.",
    "Let r",
    "+ I and\ns",
    "+ I be in R/I. We must show that the product (r + I)(s + I) = rs",
    "+ I is independent of\nthe choice of coset; that is, if r′ ∈r +",
    "I and s′ ∈s + I, then r′s′ must be in rs + I.",
    "Since\nr′ ∈r +",
    "I, there exists an element a",
    "in I such that r′ = r + a.",
    "Similarly, there exists a b ∈I\nsuch that s′ = s + b. Notice that\nr′s′ = (r + a)(s + b) = rs",
    "+ as + rb + ab\nand as + rb + ab ∈I since I is an ideal; consequently, r′s′ ∈rs +",
    "I.",
    "We will leave as an\nexercise the verification of the associative law for multiplication and the distributive laws.\n",
    "■\nThe ring R/I in Theorem 16.29 is called the factor or quotient ring.\n",
    "Just as with\ngroup homomorphisms and normal subgroups, there is a relationship between ring homo-\nmorphisms and ideals.\n",
    "Theorem 16.30 Let I be an ideal of R. The map ϕ : R →R/I defined by ϕ(r)",
    "= r",
    "+ I is\na ring homomorphism of R onto R/I with kernel I.\nProof.",
    "Certainly ϕ :",
    "R →R/I is a surjective abelian group homomorphism.",
    "It remains\nto show that ϕ works correctly under ring multiplication.",
    "Let r and s be in R. Then\nϕ(r)ϕ(s)",
    "= (r + I)(s + I) = rs",
    "+",
    "I = ϕ(rs),\nwhich completes the proof of the theorem.\n",
    "■\nThe map ϕ : R →R/I is often called the natural or canonical homomorphism.",
    "In ring\ntheory we have isomorphism theorems relating ideals and ring homomorphisms similar to\nthe isomorphism theorems for groups that relate normal subgroups and homomorphisms in\nChapter 11.",
    "We will prove only the First Isomorphism Theorem for rings in this chapter\nand leave the proofs of the other two theorems as exercises.",
    "All of the proofs are similar to\nthe proofs of the isomorphism theorems for groups.\n",
    "Theorem 16.31 First Isomorphism Theorem.",
    "Let ψ : R →S be a ring homomorphism.\n",
    "Then ker ψ is an ideal of R.",
    "If ϕ : R →R/ ker",
    "ψ is the canonical homomorphism, then there\nexists a unique isomorphism η : R/ ker ψ →ψ(R) such that ψ = ηϕ.\n\nCHAPTER 16.",
    "RINGS\n198\nProof.\n",
    "Let K = ker ψ.",
    "By the First Isomorphism Theorem for groups, there exists a\nwell-defined group homomorphism η : R/K →ψ(R) defined by η(r + K) = ψ(r) for the\nadditive abelian groups R and R/K. To show that this is a ring homomorphism, we need\nonly show that η((r + K)(s + K))",
    "= η(r + K)η(s + K); but\nη((r + K)(s + K))",
    "= η(rs + K)\n= ψ(rs)\n= ψ(r)ψ(s)\n= η(r + K)η(s + K).\n",
    "■\nTheorem 16.32 Second Isomorphism Theorem.",
    "Let I be a subring of a ring R and\nJ an ideal of R. Then I ∩J is an ideal of I and\nI/I ∩J ∼= (I + J)/J.\nTheorem 16.33 Third Isomorphism Theorem.",
    "Let R be a ring and I and J be ideals\nof R where J ⊂I. Then\nR/I ∼= R/J\nI/J .\n",
    "Theorem 16.34\nCorrespondence Theorem.\n",
    "Let I be an ideal of a ring R.\nThen\nS 7→S/I is a one-to-one correspondence between the set of subrings S containing I and the\nset of subrings of R/I. Furthermore, the ideals of R containing I correspond to ideals of\nR/I.\n16.4 Maximal and Prime Ideals\nIn this particular section we are especially interested in certain ideals of commutative rings.\n",
    "These ideals give us special types of factor rings.",
    "More specifically, we would like to char-\nacterize those ideals I of a commutative ring R such that R/I is an integral domain or a\nfield.\n",
    "A proper ideal M of a ring R is a maximal ideal\nof R if the ideal M is not a proper\nsubset of any ideal of R except R itself.",
    "That is, M is a maximal ideal if for any ideal I\nproperly containing M, I = R.",
    "The following theorem completely characterizes maximal\nideals for commutative rings with identity in terms of their corresponding factor rings.\n",
    "Theorem 16.35 Let R be a commutative ring with identity and M an ideal in R. Then\nM is a maximal ideal of R if and only if R/M is a field.\n",
    "Proof.",
    "Let M be a maximal ideal in R. If R is a commutative ring, then R/M must also\nbe a commutative ring.",
    "Clearly, 1 + M acts as an identity for R/M. We must also show\nthat every nonzero element in R/M has an inverse.",
    "If a + M is a nonzero element in R/M,\nthen a /∈M.",
    "Define I to be the set {ra + m : r ∈R and m ∈M}.",
    "We will show that I is\nan ideal in R. The set I is nonempty since 0a + 0 = 0 is in I.",
    "If r1a + m1 and r2a + m2 are\ntwo elements in I, then\n(r1a + m1) −(r2a + m2) = (r1 −r2)a + (m1 −m2)\nis in I. Also, for any r ∈R it is true that rI ⊂I; hence, I is closed under multiplication\nand satisfies the necessary conditions to be an ideal.",
    "Therefore, by Proposition 16.10 and\nthe definition of an ideal, I is an ideal properly containing M. Since M is a maximal ideal,\nI = R; consequently, by the definition of I there must be an m in M and an element b in\n\nCHAPTER 16.",
    "RINGS\n199\nR such that 1 = ab + m.",
    "Therefore,\n1 + M = ab + M = ba + M = (a + M)(b + M).\n",
    "Conversely, suppose that M is an ideal and R/M is a field.",
    "Since R/M is a field, it\nmust contain at least two elements: 0 + M = M and 1 + M.",
    "Hence, M is a proper ideal\nof R. Let I be any ideal properly containing M.",
    "We need to show that I = R. Choose\na in I but not in M. Since a + M is a nonzero element in a field, there exists an element\nb + M in R/M such that (a + M)(b + M) = ab",
    "+",
    "M = 1 +",
    "M. Consequently, there exists\nan element m ∈M such that ab + m",
    "= 1 and 1 is in I. Therefore, r1 = r ∈I for all r ∈R.\nConsequently, I = R.\n■\nExample 16.36 Let pZ be an ideal in Z, where p is prime.",
    "Then pZ is a maximal ideal\nsince Z/pZ ∼= Zp is a field.\n",
    "□\nA proper ideal P in a commutative ring R is called a prime ideal if whenever ab ∈P,\nthen either a ∈P or b ∈P.9\nExample 16.37 It is easy to check that the set P = {0, 2, 4, 6, 8, 10} is an ideal in Z12.\n",
    "This ideal is prime.",
    "In fact, it is a maximal ideal.\n",
    "□\nProposition 16.38 Let R be a commutative ring with identity 1, where 1 ̸= 0.",
    "Then P is\na prime ideal in R if and only if R/P is an integral domain.\n",
    "Proof.",
    "First let us assume that P is an ideal in R and R/P is an integral domain.",
    "Suppose\nthat ab ∈P.",
    "If a+P and b+P are two elements of R/P such that (a+P)(b+P) = 0+P = P,\nthen either a + P = P or b + P =",
    "P. This means that either a is in P or b is in P, which\nshows that P must be prime.\n",
    "Conversely, suppose that P is prime and\n(a + P)(b + P) = ab + P = 0",
    "+ P = P.\nThen ab ∈P.",
    "If a /∈P, then b must be in P by the definition of a prime ideal; hence,\nb + P = 0 + P and R/P is an integral domain.\n",
    "■\nExample 16.39 Every ideal in Z is of the form nZ. The factor ring Z/nZ ∼= Zn is an\nintegral domain only when n is prime.",
    "It is actually a field.",
    "Hence, the nonzero prime ideals\nin Z are the ideals pZ, where p is prime.",
    "This example really justifies the use of the word\n“prime” in our definition of prime ideals.\n",
    "□\nSince every field is an integral domain, we have the following corollary.\n",
    "Corollary 16.40 Every maximal ideal in a commutative ring with identity is also a prime\nideal.\n",
    "Historical Note\nAmalie Emmy Noether, one of the outstanding mathematicians of the twentieth century,\nwas born in Erlangen, Germany in 1882.",
    "She was the daughter of Max Noether (1844–\n1921), a distinguished mathematician at the University of Erlangen.",
    "Together with Paul\nGordon (1837–1912), Emmy Noether’s father strongly influenced her early education.",
    "She\nentered the University of Erlangen at the age of 18.",
    "Although women had been admitted\nto universities in England, France, and Italy for decades, there was great resistance to\ntheir presence at universities in Germany.\n",
    "Noether was one of only two women among\nthe university’s 986 students.",
    "After completing her doctorate under Gordon in 1907, she\ncontinued to do research at Erlangen, occasionally lecturing when her father was ill.\n",
    "9It is possible to define prime ideals in a noncommutative ring.",
    "See [1] or [3].\n\n",
    "CHAPTER 16.",
    "RINGS\n200\nNoether went to Göttingen to study in 1916.",
    "David Hilbert and Felix Klein tried unsuccess-\nfully to secure her an appointment at Göttingen.",
    "Some of the faculty objected to women\nlecturers, saying, “What will our soldiers think when they return to the university and are\nexpected to learn at the feet of a woman?”",
    "Hilbert, annoyed at the question, responded,\n“Meine Herren, I do not see that the sex of a candidate is an argument against her admission\nas a Privatdozent.",
    "After all, the Senate is not a bathhouse.”",
    "At the end of World War I,\nattitudes changed and conditions greatly improved for women.",
    "After Noether passed her\nhabilitation examination in 1919, she was given a title and was paid a small sum for her\nlectures.\n",
    "In 1922, Noether became a Privatdozent at Göttingen.",
    "Over the next 11 years she used\naxiomatic methods to develop an abstract theory of rings and ideals.",
    "Though she was not\ngood at lecturing, Noether was an inspiring teacher.",
    "One of her many students was B. L.\nvan der Waerden, author of the first text treating abstract algebra from a modern point of\nview.",
    "Some of the other mathematicians Noether influenced or closely worked with were\nAlexandroff, Artin, Brauer, Courant, Hasse, Hopf, Pontryagin, von Neumann, and Weyl.\n",
    "One of the high points of her career was an invitation to address the International Congress\nof Mathematicians in Zurich in 1932.",
    "In spite of all the recognition she received from her\ncolleagues, Noether’s abilities were never recognized as they should have been during her\nlifetime.",
    "She was never promoted to full professor by the Prussian academic bureaucracy.\n",
    "In 1933, Noether, who was Jewish, was banned from participation in all academic activities\nin Germany.",
    "She emigrated to the United States, took a position at Bryn Mawr College,\nand became a member of the Institute for Advanced Study at Princeton.",
    "Noether died\nsuddenly on April 14, 1935.",
    "After her death she was eulogized by such notable scientists as\nAlbert Einstein.\n",
    "16.5",
    "An Application to Software Design\n",
    "The Chinese Remainder Theorem is a result from elementary number theory about the\nsolution of systems of simultaneous congruences.",
    "The Chinese mathematician Sun-tsï wrote\nabout the theorem in the first century A.D.",
    "This theorem has some interesting consequences\nin the design of software for parallel processors.\n",
    "Lemma 16.41 Let m and n be positive integers such that gcd(m, n) =",
    "1.",
    "Then for a, b ∈Z\nthe system\nx ≡a\n(mod m)\nx ≡b\n(mod n)\nhas a solution.",
    "If x1 and x2 are two solutions of the system, then x1 ≡x2 (mod mn).\n",
    "Proof.",
    "The equation x ≡a (mod m) has a solution since a+km satisfies the equation for\nall",
    "k ∈Z.",
    "We must show that there exists an integer k1 such that\na + k1m ≡b\n(mod n).\n",
    "This is equivalent to showing that\nk1m",
    "≡(b −a)\n",
    "(mod n)\nhas a solution for k1.",
    "Since m and n are relatively prime, there exist integers s and t such\nthat ms + nt = 1.",
    "Consequently,\n(b −a)ms = (b −a) −(b −a)nt,\n\nCHAPTER 16.",
    "RINGS\n201\nor\n[(b −a)s]m ≡(b −a)\n(mod n).\n",
    "Now let k1 = (b −a)s.\n",
    "To show that any two solutions are congruent modulo mn, let c1 and c2 be two solutions\nof the system.",
    "That is,\nci ≡a\n(mod m)\nci ≡b\n(mod n)\nfor i = 1, 2.",
    "Then\nc2 ≡c1\n(mod m)\nc2 ≡c1\n(mod n).\n",
    "Therefore, both m and n divide c1 −c2.",
    "Consequently, c2 ≡c1 (mod mn).\n",
    "■\nExample 16.42 Let us solve the system\nx ≡3\n(mod 4)\nx ≡4\n(mod 5).\n",
    "Using the Euclidean algorithm, we can find integers s and t such that 4s + 5t = 1.",
    "Two\nsuch integers are s = 4 and t = −3.",
    "Consequently,\nx = a + k1m = 3 + 4k1 = 3 + 4[(5 −4)4] = 19.\n□\nTheorem 16.43 Chinese Remainder Theorem.",
    "Let n1, n2, . .",
    ".",
    ", nk be positive integers\nsuch that gcd(ni, nj) = 1 for i ̸= j.",
    "Then for any integers a1, . . .",
    ", ak, the system\nx ≡a1\n(mod n1)\nx ≡a2\n(mod n2)\n...\n",
    "x ≡ak\n(mod nk)\nhas a solution.",
    "Furthermore, any two solutions of the system are congruent modulo n1n2 · · · nk.\nProof.",
    "We will use mathematical induction on the number of equations in the system.",
    "If\nthere are k = 2 equations, then the theorem is true by Lemma 16.41.",
    "Now suppose that\nthe result is true for a system of k equations or less and that we wish to find a solution of\nx ≡a1\n(mod n1)\nx ≡a2\n(mod n2)\n...\nx ≡ak+1\n(mod nk+1).\n",
    "Considering the first k equations, there exists a solution that is unique modulo n1 · · · nk,\nsay a.",
    "Since n1 · · · nk and nk+1 are relatively prime, the system\nx ≡a\n(mod n1 · · · nk)\nx ≡ak+1\n(mod nk+1)\nhas a solution that is unique modulo n1 . . .",
    "nk+1 by the lemma.\n",
    "■\n\nCHAPTER 16.",
    "RINGS\n202\nExample 16.44 Let us solve the system\nx ≡3\n(mod 4)\nx ≡4\n(mod 5)\nx ≡1\n(mod 9)\nx ≡5\n(mod 7).\n",
    "From Example 16.42 we know that 19 is a solution of the first two congruences and any\nother solution of the system is congruent to 19 (mod 20).",
    "Hence, we can reduce the system\nto a system of three congruences:\nx ≡19\n(mod 20)\nx ≡1\n(mod 9)\nx ≡5\n(mod 7).\n",
    "Solving the next two equations, we can reduce the system to\nx ≡19\n(mod 180)\nx",
    "≡5\n(mod 7).\n",
    "Solving this last system, we find that 19 is a solution for the system that is unique up to\nmodulo 1260.\n",
    "□\nOne interesting application of the Chinese Remainder Theorem in the design of computer\nsoftware is that the theorem allows us to break up a calculation involving large integers into\nseveral less formidable calculations.",
    "A computer will handle integer calculations only up to\na certain size due to the size of its processor chip, which is usually a 32 or 64-bit processor\nchip.",
    "For example, the largest integer available on a computer with a 64-bit processor chip\nis\n263 −1 = 9,223,372,036,854,775,807.\n",
    "Larger processors such as 128 or 256-bit have been proposed or are under development.\n",
    "There is even talk of a 512-bit processor chip.",
    "The largest integer that such a chip could\nstore with be 2511 −1, which would be a 154 digit number.",
    "However, we would need to deal\nwith much larger numbers to break sophisticated encryption schemes.\n",
    "Special software is required for calculations involving larger integers which cannot be\nadded directly by the machine.",
    "By using the Chinese Remainder Theorem we can break\ndown large integer additions and multiplications into calculations that the computer can\nhandle directly.",
    "This is especially useful on parallel processing computers which have the\nability to run several programs concurrently.\n",
    "Most computers have a single central processing unit (CPU) containing one processor\nchip and can only add two numbers at a time.",
    "To add a list of ten numbers, the CPU must\ndo nine additions in sequence.",
    "However, a parallel processing computer has more than one\nCPU.",
    "A computer with 10 CPUs, for example, can perform 10 different additions at the\nsame time.",
    "If we can take a large integer and break it down into parts, sending each part\nto a different CPU, then by performing several additions or multiplications simultaneously\non those parts, we can work with an integer that the computer would not be able to handle\nas a whole.\n",
    "Example 16.45 Suppose that we wish to multiply 2134 by 1531.",
    "We will use the integers\n95, 97, 98, and 99 because they are relatively prime.",
    "We can break down each integer into\n\nCHAPTER 16.",
    "RINGS\n203\nfour parts:\n2134 ≡44\n(mod 95)\n2134 ≡0\n(mod 97)\n2134 ≡76\n(mod 98)\n2134 ≡55\n(mod 99)\nand\n1531 ≡11\n(mod 95)\n1531 ≡76\n(mod 97)\n1531 ≡61\n(mod 98)\n1531 ≡46\n(mod 99).\n",
    "Multiplying the corresponding equations, we obtain\n2134 · 1531 ≡44 ·",
    "11 ≡9\n(mod 95)\n2134 · 1531 ≡0 · 76 ≡0\n(mod 97)\n2134 · 1531 ≡76 · 61 ≡30\n(mod 98)\n2134 · 1531 ≡55 · 46 ≡55\n(mod 99).\n",
    "Each of these four computations can be sent to a different processor if our computer has\nseveral CPUs.",
    "By the above calculation, we know that 2134·1531 is a solution of the system\nx ≡9\n(mod 95)\n",
    "x ≡0\n(mod 97)\nx ≡30\n(mod 98)\nx ≡55\n(mod 99).\n",
    "The Chinese Remainder Theorem tells us that solutions are unique up to modulo 95 · 97 ·\n98 · 99 = 89,403,930.",
    "Solving this system of congruences for x tells us that 2134 · 1531 =\n3,267,154.\n",
    "The conversion of the computation into the four subcomputations will take some com-\nputing time.",
    "In addition, solving the system of congruences can also take considerable time.\n",
    "However, if we have many computations to be performed on a particular set of numbers, it\nmakes sense to transform the problem as we have done above and to perform the necessary\ncalculations simultaneously.\n",
    "□\nSage.\n",
    "Rings are at the heart of Sage’s design, so you will find a wide range of possibil-\nities for computing with rings and fields.",
    "Ideals, quotients, and homomorphisms are all\navailable.\n",
    "16.6 Reading Questions\n1.\n",
    "What is the fundamental difference between groups and rings?\n2.\nGive two characterizations of an integral domain.\n",
    "3.\nProvide two examples of fields, one infinite, one finite.\n",
    "4.\nWho was Emmy Noether?\n\nCHAPTER 16.",
    "RINGS\n204\n5.\nSpeculate on a computer program that might use the Chinese Remainder Theorem to\nspeed up computations with large integers.\n",
    "16.7 Exercises\n1.\nWhich of the following sets are rings with respect to the usual operations of addition\nand multiplication?",
    "If the set is a ring, is it also a field?\n(a) 7Z\n(b) Z18\n(c) Q(\n√\n2 ) = {a + b\n√\n2 : a, b ∈Q}\n(d) Q(\n√\n2,\n√\n3 )",
    "= {a + b\n√\n2 + c\n√\n3 + d\n√\n6 : a, b, c, d ∈Q}\n(e) Z",
    "[\n√\n3 ] = {a + b\n√\n3 : a, b ∈Z}\n(f) R = {a + b\n3√\n3 : a, b ∈Q}\n(g) Z[i]",
    "= {a + bi : a, b ∈Z and i2 = −1}\n(h) Q(\n3√\n3 ) = {a + b\n3√\n3 + c\n3√\n9 : a, b, c ∈Q}\n2.\nLet R be the ring of 2 × 2 matrices of the form\n\u0012a\nb\n0\n0\n\u0013\n,\nwhere a, b ∈R. Show that although R is a ring that has no identity, we can find a\nsubring S of R with an identity.\n",
    "3.\nList or characterize all of the units in each of the following rings.\n",
    "(a) Z10\n(b) Z12\n(c) Z7\n(d) M2(Z), the 2 × 2 matrices with entries in Z\n(e) M2(Z2), the 2 × 2 matrices with entries in Z2\n4.\nFind all of the ideals in each of the following rings.",
    "Which of these ideals are maximal\nand which are prime?\n(a) Z18\n(b) Z25\n(c) M2(R), the 2 × 2 matrices with entries in R\n(d) M2(Z), the 2 × 2 matrices with entries in Z\n(e) Q\n5.\n",
    "For each of the following rings R with ideal I, give an addition table and a multiplication\ntable for R/I.\n(a) R = Z and I = 6Z\n\nCHAPTER 16.",
    "RINGS\n205\n(b) R = Z12 and I = {0, 3, 6, 9}\n6.\nFind all homomorphisms ϕ :",
    "Z/6Z →Z/15Z.\n7.\nProve that R is not isomorphic to C.\n8.\nProve or disprove: The ring Q(\n√\n2 ) = {a + b\n√\n2 : a, b ∈Q} is isomorphic to the ring\nQ(\n√\n3 )",
    "= {a + b\n√\n3 : a, b ∈Q}.\n",
    "9.\n",
    "What is the characteristic of the field formed by the set of matrices\nF =\n\u001a\u00121\n0\n0\n1\n\u0013\n,\n\u00121\n1\n1\n0\n\u0013\n,\n\u00120\n1\n1\n1\n\u0013\n,\n\u00120\n0\n0\n0\n\u0013\u001b\nwith entries in Z2?\n10.",
    "Define a map ϕ : C →M2(R) by\nϕ(a + bi) =\n\u0012 a\nb\n−b\na\n\u0013\n.\n",
    "Show that ϕ is an isomorphism of C with its image in M2(R).\n",
    "11.",
    "Prove that the Gaussian integers, Z[i], are an integral domain.\n12.",
    "Prove that Z[\n√\n3 i] = {a + b\n√\n3",
    "i : a, b ∈Z} is an integral domain.\n",
    "13. Solve each of the following systems of congruences.\n",
    "(a)\nx ≡2\n(mod 5)\nx ≡6\n(mod 11)\n(b)\nx ≡3\n(mod 7)\nx ≡0\n(mod 8)\nx ≡5\n(mod 15)\n(c)\nx ≡2\n(mod 4)\nx ≡4\n(mod 7)\nx ≡7\n(mod 9)\nx",
    "≡5\n(mod 11)\n(d)\nx ≡3\n(mod 5)\nx ≡0\n(mod 8)\nx ≡1\n(mod 11)\nx",
    "≡5\n(mod 13)\n14.",
    "Use the method of parallel computation outlined in the text to calculate 2234 + 4121\nby dividing the calculation into four separate additions modulo 95, 97, 98, and 99.\n15.",
    "Explain why the method of parallel computation outlined in the text fails for 2134·1531\nif we attempt to break the calculation down into two smaller calculations modulo 98\nand 99.\n16.",
    "If R is a field, show that the only two ideals of R are {0} and R itself.\n",
    "17.",
    "Let a be any element in a ring R with identity.",
    "Show that (−1)a = −a.\n",
    "18.",
    "Let ϕ : R →S be a ring homomorphism.",
    "Prove each of the following statements.\n",
    "(a) If R is a commutative ring, then ϕ(R) is a commutative ring.\n",
    "(b) ϕ(0) = 0.\n(c) Let 1R and 1S be the identities for R and S, respectively.",
    "If ϕ is onto, then\nϕ(1R) = 1S.\n(d)",
    "If R is a field and ϕ(R)",
    "̸= 0, then ϕ(R) is a field.\n\n",
    "CHAPTER 16.",
    "RINGS\n206\n19.",
    "Prove that the associative law for multiplication and the distributive laws hold in R/I.\n20.",
    "Prove the Second Isomorphism Theorem for rings: Let I be a subring of a ring R and\nJ an ideal in R. Then I ∩J is an ideal in I and\nI/I ∩J",
    "∼= I + J/J.\n21.",
    "Prove the Third Isomorphism Theorem for rings: Let R be a ring and I and J be ideals\nof R, where J ⊂I. Then\nR/I ∼= R/J\nI/J .\n22.",
    "Prove the Correspondence Theorem: Let I be an ideal of a ring R. Then S →S/",
    "I is\na one-to-one correspondence between the set of subrings S containing I and the set of\nsubrings of R/I. Furthermore, the ideals of R correspond to ideals of R/I.\n23.",
    "Let R be a ring and S a subset of R. Show that S is a subring of R if and only if each\nof the following conditions is satisfied.\n",
    "(a) S ̸= ∅.\n(b) rs ∈S for all r, s ∈S.\n(c) r −s ∈S for all r, s ∈S.\n24.",
    "Let R be a ring with a collection of subrings {Rα}.",
    "Prove that T Rα is a subring of R.\nGive an example to show that the union of two subrings is not necessarily a subring.\n",
    "25.",
    "Let {Iα}α∈A be a collection of ideals in a ring R. Prove that T\nα∈A Iα is also an ideal\nin R. Give an example to show that if I1 and I2 are ideals in R, then I1 ∪I2 may not\nbe an ideal.\n",
    "26.",
    "Let R be an integral domain.",
    "Show that if the only ideals in R are {0} and R itself, R\nmust be a field.\n",
    "27.",
    "Let R be a commutative ring.",
    "An element a in R is nilpotent if an = 0 for some\npositive integer n. Show that the set of all nilpotent elements forms an ideal in R.\n28.",
    "A ring R is a Boolean ring if for every a ∈R, a2 = a. Show that every Boolean ring\nis a commutative ring.\n",
    "29.",
    "Let R be a ring, where a3 = a for all a ∈R.",
    "Prove that R must be a commutative\nring.\n",
    "30.",
    "Let R be a ring with identity 1R and S a subring of R with identity 1S. Prove or\ndisprove that 1R = 1S.\n31.",
    "If we do not require the identity of a ring to be distinct from 0, we will not have a\nvery interesting mathematical structure.",
    "Let R be a ring such that 1 = 0.",
    "Prove that\nR = {0}.\n",
    "32.",
    "Let R be a ring.",
    "Define the center of R to be\nZ(R)",
    "= {a ∈R : ar = ra for all r ∈R}.\n",
    "Prove that Z(R) is a commutative subring of R.\n33.",
    "Let p be prime.",
    "Prove that\nZ(p) = {a/b : a, b ∈Z and gcd(b, p)",
    "= 1}\nis a ring.",
    "The ring Z(p) is called the ring of integers localized at p.\n34.",
    "Prove or disprove: Every finite integral domain is isomorphic to Zp.\n\n",
    "CHAPTER 16.",
    "RINGS\n207\n35.",
    "Let R be a ring with identity.\n",
    "(a) Let u be a unit in R. Define a map iu : R →R by r 7→uru−1.",
    "Prove that iu is an\nautomorphism of R. Such an automorphism of R is called an inner automorphism\nof R. Denote the set of all inner automorphisms of R by Inn(R).\n",
    "(b) Denote the set of all automorphisms of R by Aut(R).",
    "Prove that Inn(R) is a\nnormal subgroup of Aut(R).\n",
    "(c) Let U(R) be the group of units in R.",
    "Prove that the map\nϕ : U(R) →Inn(R)\ndefined by u 7→iu is a homomorphism.",
    "Determine the kernel of ϕ.\n(d) Compute Aut(Z), Inn(Z), and U(Z).\n",
    "36.",
    "Let R and S be arbitrary rings.",
    "Show that their Cartesian product is a ring if we\ndefine addition and multiplication in R × S by\n(a) (r, s) +",
    "(r′, s′) = (r + r′, s + s′)\n(b) (r, s)(r′, s′) = (rr′, ss′)\n37.",
    "An element x in a ring is called an idempotent if x2 = x. Prove that the only idempo-\ntents in an integral domain are 0 and 1.",
    "Find a ring with a idempotent x not equal to\n0 or 1.\n38.",
    "Let gcd(a, n) = d and gcd(b, d) ̸= 1.",
    "Prove that ax ≡b (mod n) does not have a\nsolution.\n39.",
    "The Chinese Remainder Theorem for Rings.",
    "Let R be a ring and I and J be\nideals in R such that I + J = R.\n(a) Show that for any r and s in R, the system of equations\nx ≡r\n(mod I)\nx ≡s\n(mod J)\nhas a solution.\n",
    "(b)",
    "In addition, prove that any two solutions of the system are congruent modulo\nI ∩J.\n(c) Let I and J be ideals in a ring R such that I + J = R. Show that there exists a\nring isomorphism\nR/(I ∩J)",
    "∼= R/I ×",
    "R/J.\n16.8 Programming Exercise\n1.\nWrite a computer program implementing fast addition and multiplication using the\nChinese Remainder Theorem and the method outlined in the text.\n",
    "16.9 References and Suggested Readings\n[1]\nAnderson, F. W. and Fuller, K. R. Rings and Categories of Modules.",
    "2nd ed.",
    "Springer,\nNew York, 1992.\n\n",
    "CHAPTER 16.",
    "RINGS\n208\n[2]\nAtiyah, M. F. and MacDonald, I. G. Introduction to Commutative Algebra.",
    "Westview\nPress, Boulder, CO, 1994.\n",
    "[3]\nHerstein, I. N. Noncommutative Rings.",
    "Mathematical Association of America, Wash-\nington, DC, 1994.\n",
    "[4]\nKaplansky, I. Commutative Rings.\n",
    "Revised edition.\n",
    "University of Chicago Press,\nChicago, 1974.\n",
    "[5]\nKnuth, D. E. The Art of Computer Programming: Semi-Numerical Algorithms, vol.\n2.",
    "3rd ed.",
    "Addison-Wesley Professional, Boston, 1997.\n",
    "[6]\nLidl, R. and Pilz, G. Applied Abstract Algebra.",
    "2nd ed.",
    "Springer, New York, 1998.",
    "A\ngood source for applications.\n",
    "[7]\nMackiw, G. Applications of Abstract Algebra.",
    "Wiley, New York, 1985.\n",
    "[8]\nMcCoy, N. H. Rings and Ideals.\n",
    "Carus Monograph Series, No.\n8.\nMathematical\nAssociation of America, Washington, DC, 1968.\n",
    "[9]\nMcCoy, N. H. The Theory of Rings.",
    "Chelsea, New York, 1972.\n",
    "[10] Zariski, O. and Samuel, P. Commutative Algebra, vols.",
    "I and II.",
    "Springer, New York,\n1975, 1960.\n\n",
    "17\nPolynomials\nMost people are fairly familiar with polynomials by the time they begin to study abstract\nalgebra.",
    "When we examine polynomial expressions such as\np(x)",
    "= x3 −3x",
    "+ 2\nq(x) = 3x2 −6x + 5,\nwe have a pretty good idea of what p(x) + q(x) and p(x)q(x) mean.\n",
    "We just add and\nmultiply polynomials as functions; that is,\n(p + q)(x) = p(x) + q(x)\n= (x3 −3x + 2)",
    "+ (3x2 −6x + 5)\n= x3 + 3x2 −9x + 7\nand\n(pq)(x) = p(x)q(x)\n",
    "= (x3 −3x + 2)(3x2 −6x + 5)\n= 3x5 −6x4 −4x3",
    "+ 24x2 −27x + 10.\n",
    "It is probably no surprise that polynomials form a ring.",
    "In this chapter we shall emphasize\nthe algebraic structure of polynomials by studying polynomial rings.",
    "We can prove many\nresults for polynomial rings that are similar to the theorems we proved for the integers.\n",
    "Analogs of prime numbers, the division algorithm, and the Euclidean algorithm exist for\npolynomials.\n",
    "17.1 Polynomial Rings\nThroughout this chapter we shall assume that R is a commutative ring with identity.",
    "Any\nexpression of the form\nf(x) =\nn\nX\ni=0\naixi = a0 +",
    "a1x",
    "+ a2x2",
    "+ · · ·",
    "+ anxn,\nwhere ai ∈R and an ̸= 0, is called a polynomial over R with indeterminate x.\n",
    "The\nelements a0, a1, . .",
    ".",
    ", an are called the coeﬀicients of f.\n",
    "The coeﬀicient an is called the\nleading coeﬀicient.",
    "A polynomial is called monic if the leading coeﬀicient is 1.",
    "If n is the\n209\n\nCHAPTER 17.",
    "POLYNOMIALS\n210\nlargest nonnegative number for which an ̸= 0, we say that the degree of f is n and write\ndeg f(x)",
    "= n.",
    "If no such n exists—that is, if f = 0 is the zero polynomial—then the degree\nof f is defined to be −∞. We will denote the set of all polynomials with coeﬀicients in a\nring R by R[x].",
    "Two polynomials are equal exactly when their corresponding coeﬀicients\nare equal; that is, if we let\np(x)",
    "= a0 + a1x",
    "+ · ·",
    "· + anxn\nq(x) = b0 + b1x + · · · + bmxm,\nthen p(x) = q(x) if and only if ai = bi for all i ≥0.\n",
    "To show that the set of all polynomials forms a ring, we must first define addition and\nmultiplication.",
    "We define the sum of two polynomials as follows.",
    "Let\np(x)",
    "= a0 + a1x",
    "+ · ·",
    "· + anxn\nq(x) = b0 + b1x + · · · + bmxm.\n",
    "Then the sum of p(x) and q(x) is\np(x) + q(x) = c0 + c1x + · · · + ckxk,\nwhere ci = ai + bi for each i. We define the product of p(x) and q(x) to be\np(x)q(x) = c0 + c1x",
    "+ · · · + cm+nxm+n,\nwhere\nci =\ni\nX\nk=0\nakbi−k = a0bi + a1bi−1 + · · ·",
    "+ ai−1b1 + aib0\nfor each i. Notice that in each case some of the coeﬀicients may be zero.\n",
    "Example 17.1 Suppose that\np(x) = 3 + 0x + 0x2 + 2x3 + 0x4\nand\nq(x) = 2 + 0x",
    "−x2 + 0x3 + 4x4\nare polynomials in Z[x].",
    "If the coeﬀicient of some term in a polynomial is zero, then we\nusually just omit that term.",
    "In this case we would write p(x)",
    "= 3+2x3 and q(x) = 2−x2+4x4.\n",
    "The sum of these two polynomials is\np(x) + q(x)",
    "= 5 −x2 + 2x3 + 4x4.\n",
    "The product,\np(x)q(x) = (3 + 2x3)(2 −x2 + 4x4) = 6 −3x2 + 4x3 + 12x4 −2x5 + 8x7,\ncan be calculated either by determining the cis in the definition or by simply multiplying\npolynomials in the same way as we have always done.\n",
    "□\nExample 17.2 Let\np(x)",
    "= 3 + 3x3\nand\nq(x) = 4 + 4x2 + 4x4\nbe polynomials in Z12[x].",
    "The sum of p(x) and q(x) is 7 + 4x2 + 3x3 + 4x4.",
    "The product of\nthe two polynomials is the zero polynomial.",
    "This example tells us that we can not expect\n\nCHAPTER 17.",
    "POLYNOMIALS\n211\nR[x] to be an integral domain if R is not an integral domain.\n",
    "□\nTheorem 17.3 Let R be a commutative ring with identity.",
    "Then R[x] is a commutative\nring with identity.\n",
    "Proof.\n",
    "Our first task is to show that R[x] is an abelian group under polynomial addi-\ntion.",
    "The zero polynomial, f(x) = 0, is the additive identity.",
    "Given a polynomial p(x) =\nPn\ni=0 aixi, the inverse of p(x) is easily verified to be −p(x)",
    "= Pn\ni=0(−ai)xi = −Pn\ni=0 aixi.\n",
    "Commutativity and associativity follow immediately from the definition of polynomial ad-\ndition and from the fact that addition in R is both commutative and associative.\n",
    "To show that polynomial multiplication is associative, let\np(x)",
    "=\nm\nX\ni=0\naixi,\nq(x) =\nn\nX\ni=0\nbixi,\nr(x) =\np\nX\ni=0\ncixi.\n",
    "Then\n[p(x)q(x)]r(x) =\n\" m\nX\ni=0\naixi\n!  ",
    "n\nX\ni=0\nbixi\n!#  p\nX\ni=0\ncixi\n!\n=\n\n\nm+n\nX\ni=0\n\n\ni\nX\nj=0\najbi−j\n\nxi\n\n\n p\nX\ni=0\ncixi\n!\n=\nm+n+p\nX\ni=0\n\n\ni\nX\nj=0\n j\nX\nk=0\nakbj−k\n!\nci−j\n\nxi\n=\nm+n+p\nX\ni=0\n\n\nX\nj+k+l=i\najbkcl\n\nxi\n=\nm+n+p\nX\ni=0\n\n\ni\nX\nj=0\naj\n i−j\nX\nk=0\nbkci−j−k\n!\nxi\n=\n m\nX\ni=0\naixi\n!",
    "\n\nn+p\nX\ni=0\n\n\ni\nX\nj=0\nbjci−j\n\nxi\n\n\n=\n m\nX\ni=0\naixi\n! \"",
    "n\nX\ni=0\nbixi\n!  ",
    "p\nX\ni=0\ncixi\n!#\n= p(x)[q(x)r(x)]\n",
    "The commutativity and distribution properties of polynomial multiplication are proved in\na similar manner.",
    "We shall leave the proofs of these properties as an exercise.\n",
    "■\nProposition 17.4 Let p(x) and q(x) be polynomials in R[x], where R is an integral domain.\n",
    "Then deg p(x)",
    "+ deg q(x) = deg(p(x)q(x)).",
    "Furthermore, R[x] is an integral domain.\nProof.",
    "Suppose that we have two nonzero polynomials\np(x) = amxm + · · ·",
    "+ a1x + a0\n\nCHAPTER 17.",
    "POLYNOMIALS\n212\nand\nq(x) = bnxn + · · · + b1x + b0\nwith am ̸= 0 and bn ̸= 0.",
    "The degrees of p(x) and q(x) are m and n, respectively.",
    "The\nleading term of p(x)q(x) is ambnxm+n, which cannot be zero since R is an integral domain;\nhence, the degree of p(x)q(x) is m + n, and p(x)q(x)",
    "̸= 0.",
    "Since p(x) ̸= 0 and q(x) ̸= 0\nimply that p(x)q(x) ̸= 0, we know that R[x] must also be an integral domain.\n",
    "■\nWe also want to consider polynomials in two or more variables, such as x2 −3xy + 2y3.\n",
    "Let R be a ring and suppose that we are given two indeterminates x and y. Certainly\nwe can form the ring (R[x])[y].\n",
    "It is straightforward but perhaps tedious to show that\n(R[x])[y] ∼= R([y])[x].",
    "We shall identify these two rings by this isomorphism and simply\nwrite R[x, y].",
    "The ring R[x, y] is called the ring of polynomials in two indeterminates x and\ny with coeﬀicients in R. We can define the ring of polynomials in n indeterminates with\ncoeﬀicients in R similarly.",
    "We shall denote this ring by R[x1, x2, . . .",
    ", xn].\n",
    "Theorem 17.5 Let R be a commutative ring with identity and α ∈R.",
    "Then we have a\nring homomorphism ϕα : R[x]",
    "→R defined by\nϕα(p(x))",
    "= p(α) = anαn + · · ·",
    "+ a1α + a0,\nwhere p(x) = anxn + · · · + a1x + a0.\n",
    "Proof.",
    "Let p(x)",
    "= Pn\ni=0 aixi and q(x)",
    "= Pm\ni=0 bixi.",
    "It is easy to show that ϕα(p(x) +\nq(x))",
    "= ϕα(p(x))",
    "+ ϕα(q(x)).",
    "To show that multiplication is preserved under the map ϕα,\nobserve that\nϕα(p(x))ϕα(q(x))",
    "= p(α)q(α)\n=\n n\nX\ni=0\naiαi\n!  ",
    "m\nX\ni=0\nbiαi\n!\n=\nm+n\nX\ni=0\n \ni\nX\nk=0\nakbi−k\n!\nαi\n= ϕα(p(x)q(x)).\n",
    "■\nThe map ϕα : R[x]",
    "→R is called the evaluation homomorphism at α.\n17.2 The Division Algorithm\nRecall that the division algorithm for integers (Theorem 2.9) says that if a and b are integers\nwith b > 0, then there exist unique integers q and r such that a = bq + r, where 0",
    "≤r < b.\n",
    "The algorithm by which q and r are found is just long division.",
    "A similar theorem exists for\npolynomials.",
    "The division algorithm for polynomials has several important consequences.\n",
    "Since its proof is very similar to the corresponding proof for integers, it is worthwhile to\nreview Theorem 2.9 at this point.\n",
    "Theorem 17.6 Division Algorithm.",
    "Let f(x) and g(x) be polynomials in F[x], where F\nis a field and g(x) is a nonzero polynomial.",
    "Then there exist unique polynomials q(x), r(x) ∈\nF[x] such that\nf(x) = g(x)q(x)",
    "+ r(x),\nwhere either deg r(x) < deg g(x) or r(x) is the zero polynomial.\n\n",
    "CHAPTER 17.",
    "POLYNOMIALS\n213\nProof.",
    "We will first consider the existence of q(x) and r(x).",
    "If f(x) is the zero polynomial,\nthen\n0 = 0 · g(x) + 0;\nhence, both q and r must also be the zero polynomial.",
    "Now suppose that f(x) is not the zero\npolynomial and that deg f(x) = n and deg g(x)",
    "= m.",
    "If m > n, then we can let q(x) = 0\nand r(x) = f(x).",
    "Hence, we may assume that m ≤n and proceed by induction on n.",
    "If\nf(x) = anxn + an−1xn−1 + · · · + a1x + a0\ng(x) = bmxm + bm−1xm−1 + · · · + b1x + b0\nthe polynomial\nf′(x) = f(x) −an\nbm\nxn−mg(x)\nhas degree less than n or is the zero polynomial.",
    "By induction, there exist polynomials q′(x)\nand r(x) such that\nf′(x) = q′(x)g(x)",
    "+ r(x),\nwhere r(x) = 0 or the degree of r(x) is less than the degree of g(x).",
    "Now let\nq(x) = q′(x) + an\nbm\nxn−m.\n",
    "Then\nf(x) = g(x)q(x) + r(x),\nwith r(x) the zero polynomial or deg r(x) < deg g(x).\n",
    "To show that q(x) and r(x) are unique, suppose that there exist two other polynomials\nq1(x) and r1(x) such that f(x) = g(x)q1(x)",
    "+",
    "r1(x) with deg r1(x) <",
    "deg g(x) or r1(x) = 0,\nso that\nf(x) = g(x)q(x)",
    "+ r(x) = g(x)q1(x) + r1(x),\nand\ng(x)[q(x) −q1(x)]",
    "= r1(x) −r(x).\n",
    "If q(x) −q1(x) is not the zero polynomial, then\ndeg(g(x)[q(x) −q1(x)])",
    "= deg(r1(x) −r(x))",
    "≥deg g(x).\n",
    "However, the degrees of both r(x) and r1(x) are strictly less than the degree of g(x); there-\nfore, r(x) = r1(x) and q(x) = q1(x).\n",
    "■\nExample 17.7 The division algorithm merely formalizes long division of polynomials, a\ntask we have been familiar with since high school.",
    "For example, suppose that we divide\nx3 −x2 + 2x −3 by x −2.\n",
    "x2\n+\nx\n+\n4\nx\n−\n2\nx3\n−\nx2\n+\n2x\n−\n3\nx3\n−\n2x2\nx2\n+\n2x\n−\n3\nx2\n−\n2x\n4x\n−\n3\n4x\n−\n8\n5\nHence, x3 −x2 + 2x −3",
    "= (x −2)(x2 + x + 4) + 5.\n□\n\nCHAPTER 17.",
    "POLYNOMIALS\n214\nLet p(x) be a polynomial in F[x] and α ∈F.",
    "We say that α is a zero or root of p(x) if\np(x) is in the kernel of the evaluation homomorphism ϕα.",
    "All we are really saying here is\nthat α is a zero of p(x) if p(α) = 0.\n",
    "Corollary 17.8 Let F be a field.",
    "An element α ∈F is a zero of p(x) ∈F[x] if and only if\nx −α is a factor of p(x) in F[x].\nProof.",
    "Suppose that α ∈F and p(α) = 0.",
    "By the division algorithm, there exist polyno-\nmials q(x) and r(x) such that\np(x)",
    "= (x −α)q(x)",
    "+ r(x)\nand the degree of r(x) must be less than the degree of x −α.",
    "Since the degree of r(x) is\nless than 1, r(x) = a for a ∈F; therefore,\np(x) =",
    "(x −α)q(x)",
    "+ a.\n",
    "But\n0 = p(α) = 0 · q(α)",
    "+ a = a;\nconsequently, p(x)",
    "= (x −α)q(x), and x −α is a factor of p(x).\n",
    "Conversely, suppose that x −α is a factor of p(x); say p(x) = (x −α)q(x).\n",
    "Then\np(α) = 0 · q(α) = 0.\n",
    "■\nCorollary 17.9 Let F be a field.",
    "A nonzero polynomial p(x) of degree n in F[x] can have\nat most n distinct zeros in F.\nProof.",
    "We will use induction on the degree of p(x).",
    "If deg p(x) = 0, then p(x) is a constant\npolynomial and has no zeros.",
    "Let deg p(x)",
    "= 1.",
    "Then p(x) = ax + b for some a and b in F.\n",
    "If α1 and α2 are zeros of p(x), then aα1 + b = aα2 + b or α1 = α2.\n",
    "Now assume that deg p(x) >",
    "1.",
    "If p(x) does not have a zero in F, then we are done.\n",
    "On the other hand, if α is a zero of p(x), then p(x)",
    "= (x −α)q(x) for some q(x) ∈F[x] by\nCorollary 17.8.",
    "The degree of q(x) is n −1 by Proposition 17.4.",
    "Let β be some other zero\nof p(x) that is distinct from α.",
    "Then p(β) = (β −α)q(β) = 0.",
    "Since α ̸= β and F is a field,\nq(β) = 0.",
    "By our induction hypothesis, q(x) can have at most n −1 zeros in F that are\ndistinct from α.",
    "Therefore, p(x) has at most n distinct zeros in F.\n■\nLet F be a field.",
    "A monic polynomial d(x) is a greatest common divisor of polynomials\np(x), q(x) ∈F[x] if d(x) evenly divides both p(x) and q(x); and, if for any other polynomial\nd′(x) dividing both p(x) and q(x), d′(x) | d(x).",
    "We write d(x) = gcd(p(x), q(x)).",
    "Two\npolynomials p(x) and q(x) are relatively prime if gcd(p(x), q(x))",
    "= 1.\n",
    "Proposition 17.10 Let F be a field and suppose that d(x) is a greatest common divisor\nof two polynomials p(x) and q(x) in F[x].",
    "Then there exist polynomials r(x) and s(x) such\nthat\nd(x) = r(x)p(x)",
    "+ s(x)q(x).\n",
    "Furthermore, the greatest common divisor of two polynomials is unique.\n",
    "Proof.",
    "Let d(x) be the monic polynomial of smallest degree in the set\nS = {f(x)p(x) + g(x)q(x) : f(x), g(x) ∈F[x]}.\n",
    "We can write d(x) = r(x)p(x)",
    "+ s(x)q(x) for two polynomials r(x) and s(x) in F[x].",
    "We\nneed to show that d(x) divides both p(x) and q(x).",
    "We shall first show that d(x) divides\np(x).",
    "By the division algorithm, there exist polynomials a(x) and b(x) such that p(x) =\na(x)d(x) + b(x), where b(x) is either the zero polynomial or deg b(x) < deg d(x).",
    "Therefore,\nb(x) = p(x) −a(x)d(x)\n\nCHAPTER 17.",
    "POLYNOMIALS\n215\n= p(x) −a(x)(r(x)p(x)",
    "+ s(x)q(x))\n",
    "= p(x) −a(x)r(x)p(x) −a(x)s(x)q(x)\n= p(x)(1 −a(x)r(x))",
    "+ q(x)(−a(x)s(x))\nis a linear combination of p(x) and q(x) and therefore must be in S. However, b(x) must\nbe the zero polynomial since d(x) was chosen to be of smallest degree; consequently, d(x)\ndivides p(x).",
    "A symmetric argument shows that d(x) must also divide q(x); hence, d(x) is\na common divisor of p(x) and q(x).\n",
    "To show that d(x) is a greatest common divisor of p(x) and q(x), suppose that d′(x)\nis another common divisor of p(x) and q(x).",
    "We will show that d′(x) | d(x).",
    "Since d′(x)\nis a common divisor of p(x) and q(x), there exist polynomials u(x) and v(x) such that\np(x) = u(x)d′(x) and q(x) = v(x)d′(x).",
    "Therefore,\nd(x) = r(x)p(x)",
    "+ s(x)q(x)\n= r(x)u(x)d′(x) + s(x)v(x)d′(x)\n= d′(x)[r(x)u(x)",
    "+ s(x)v(x)].\n",
    "Since d′(x) | d(x), d(x) is a greatest common divisor of p(x) and q(x).\n",
    "Finally, we must show that the greatest common divisor of p(x) and q(x) is unique.\n",
    "Suppose that d′(x) is another greatest common divisor of p(x) and q(x).\n",
    "We have just\nshown that there exist polynomials u(x) and v(x) in F[x] such that d(x) = d′(x)[r(x)u(x)",
    "+\ns(x)v(x)].",
    "Since\ndeg d(x) = deg d′(x) + deg[r(x)u(x) + s(x)v(x)]\nand d(x) and d′(x) are both greatest common divisors, deg d(x) = deg d′(x).",
    "Since d(x) and\nd′(x) are both monic polynomials of the same degree, it must be the case that d(x) = d′(x).\n",
    "■\nNotice the similarity between the proof of Proposition 17.10 and the proof of Theo-\nrem 2.10.\n17.3 Irreducible Polynomials\nA nonconstant polynomial f(x) ∈F[x] is irreducible over a field F if f(x) cannot be\nexpressed as a product of two polynomials g(x) and h(x) in F[x], where the degrees of g(x)\nand h(x) are both smaller than the degree of f(x).",
    "Irreducible polynomials function as the\n“prime numbers” of polynomial rings.\n",
    "Example 17.11 The polynomial x2 −2 ∈Q[x] is irreducible since it cannot be factored\nany further over the rational numbers.",
    "Similarly, x2 +1 is irreducible over the real numbers.\n",
    "□\nExample 17.12 The polynomial p(x) = x3 + x2",
    "+ 2 is irreducible over Z3[x].",
    "Suppose that\nthis polynomial was reducible over Z3[x].",
    "By the division algorithm there would have to be\na factor of the form x −a, where a is some element in Z3[x].",
    "Hence, it would have to be\ntrue that p(a)",
    "= 0.",
    "However,\np(0) = 2\np(1)",
    "= 1\np(2)",
    "= 2.\n",
    "Therefore, p(x) has no zeros in Z3 and must be irreducible.\n",
    "□\n\nCHAPTER 17.",
    "POLYNOMIALS\n216\nLemma 17.13 Let p(x) ∈Q[x].",
    "Then\np(x) = r\ns(a0 + a1x + · · · + anxn),\nwhere r, s, a0, . . .",
    ", an are integers, the ai’s are relatively prime, and r and s are relatively\nprime.\nProof.",
    "Suppose that\np(x) = b0\nc0\n+ b1\nc1\nx + · · · + bn\ncn\nxn,\nwhere the bi’s and the ci’s are integers.",
    "We can rewrite p(x) as\np(x)",
    "=\n1\nc0 · · · cn\n(d0 + d1x + · · · + dnxn),\nwhere d0, . .",
    ".",
    ", dn are integers.",
    "Let d be the greatest common divisor of d0, . . .",
    ", dn.",
    "Then\np(x) =\nd\nc0 · · · cn\n(a0 + a1x + · · · + anxn),\nwhere di = dai and the ai’s are relatively prime.",
    "Reducing d/(c0 · · · cn) to its lowest terms,\nwe can write\np(x)",
    "= r\ns(a0 + a1x + · · ·",
    "+ anxn),\nwhere gcd(r, s) = 1.\n■\nTheorem 17.14 Gauss’s Lemma.",
    "Let p(x) ∈Z[x] be a monic polynomial such that p(x)\n",
    "factors into a product of two polynomials α(x) and β(x) in Q[x], where the degrees of both\nα(x) and β(x) are less than the degree of p(x).",
    "Then p(x) = a(x)b(x), where a(x) and b(x)\nare monic polynomials in Z[x] with deg α(x)",
    "= deg a(x) and deg β(x)",
    "= deg b(x).\n",
    "Proof.",
    "By Lemma 17.13, we can assume that\nα(x) = c1\nd1\n(a0 + a1x",
    "+ · ·",
    "· + amxm)",
    "= c1\nd1\nα1(x)\nβ(x) = c2\nd2\n(b0 + b1x + · · · + bnxn) = c2\nd2\nβ1(x),\nwhere the ai’s are relatively prime and the bi’s are relatively prime.",
    "Consequently,\np(x) = α(x)β(x) = c1c2\nd1d2\nα1(x)β1(x) = c\ndα1(x)β1(x),\nwhere c/d is the product of c1/d1 and c2/d2 expressed in lowest terms.",
    "Hence, dp(x) =\ncα1(x)β1(x).\n",
    "If d = 1, then cambn = 1 since p(x) is a monic polynomial.\n",
    "Hence, either c = 1\nor c = −1.\n",
    "If c = 1, then either am = bn = 1 or am = bn = −1.\n",
    "In the first case\np(x) = α1(x)β1(x), where α1(x) and β1(x) are monic polynomials with deg α(x)",
    "= deg α1(x)\nand deg β(x) = deg β1(x).",
    "In the second case a(x) = −α1(x) and b(x) = −β1(x) are the\ncorrect monic polynomials since p(x) = (−α1(x))(−β1(x))",
    "= a(x)b(x).",
    "The case in which\nc = −1 can be handled similarly.\nNow suppose that d ̸= 1.",
    "Since gcd(c, d) = 1, there exists a prime p such that p | d and\np ∤c.",
    "Also, since the coeﬀicients of α1(x) are relatively prime, there exists a coeﬀicient ai\nsuch that p ∤ai.",
    "Similarly, there exists a coeﬀicient bj of β1(x) such that p ∤bj.",
    "Let α′\n1(x)\nand β′\n1(x) be the polynomials in Zp[x] obtained by reducing the coeﬀicients of α1(x) and\nβ1(x) modulo p.",
    "Since p | d, α′\n1(x)β′\n1(x) = 0 in Zp[x].",
    "However, this is impossible since\nneither α′\n1(x) nor β′\n1(x) is the zero polynomial and Zp[x] is an integral domain.",
    "Therefore,\nd = 1 and the theorem is proven.\n",
    "■\n\nCHAPTER 17.",
    "POLYNOMIALS\n217\nCorollary 17.15 Let p(x) = xn + an−1xn−1 + · · · + a0 be a polynomial with coeﬀicients in\nZ and a0 ̸= 0.",
    "If p(x) has a zero in Q, then p(x) also has a zero α in Z.",
    "Furthermore, α\ndivides a0.\nProof.",
    "Let p(x) have a zero a ∈Q. Then p(x) must have a linear factor x−a.",
    "By Gauss’s\nLemma, p(x) has a factorization with a linear factor in Z[x].",
    "Hence, for some α ∈Z\np(x) = (x −α)(xn−1 + · · · −a0/α).\n",
    "Thus a0/α ∈Z and so α | a0.\n",
    "■\nExample 17.16 Let p(x) = x4−2x3+x+1.",
    "We shall show that p(x) is irreducible over Q[x].\n",
    "Assume that p(x) is reducible.",
    "Then either p(x) has a linear factor, say p(x)",
    "= (x −α)q(x),\nwhere q(x) is a polynomial of degree three, or p(x) has two quadratic factors.\n",
    "If p(x) has a linear factor in Q[x], then it has a zero in Z. By Corollary 17.15, any zero\nmust divide 1 and therefore must be ±1; however, p(1) = 1 and p(−1)",
    "= 3.",
    "Consequently,\nwe have eliminated the possibility that p(x) has any linear factors.\n",
    "Therefore, if p(x) is reducible it must factor into two quadratic polynomials, say\np(x) = (x2 + ax + b)(x2 + cx + d)\n= x4 + (a + c)x3 + (ac + b + d)x2 + (ad + bc)x + bd,\nwhere each factor is in Z[x] by Gauss’s Lemma.",
    "Hence,\na + c = −2\nac + b + d = 0\nad + bc = 1\nbd = 1.\n",
    "Since bd = 1, either b = d = 1 or b = d = −1.",
    "In either case b = d and so\nad + bc = b(a + c) = 1.\n",
    "Since a+c = −2, we know that −2b = 1.",
    "This is impossible since b is an integer.",
    "Therefore,\np(x) must be irreducible over Q.\n□\nTheorem 17.17 Eisenstein’s Criterion.",
    "Let p be a prime and suppose that\nf(x) = anxn + · · ·",
    "+ a0 ∈Z[x].\n",
    "If p | ai for i = 0, 1, . .",
    ". , n −1, but p ∤an and p2 ∤a0, then f(x) is irreducible over Q.\nProof.",
    "By Gauss’s Lemma, we need only show that f(x) does not factor into polynomials\nof lower degree in Z[x].",
    "Let\nf(x) = (brxr + · · · + b0)(csxs + · · · + c0)\nbe a factorization in Z[x], with br and cs not equal to zero and r, s < n. Since p2 does not\ndivide a0 = b0c0, either b0 or c0 is not divisible by p. Suppose that p ∤b0 and p | c0.",
    "Since\np ∤an and an = brcs, neither br nor cs is divisible by p. Let m be the smallest value of k\nsuch that p ∤ck.",
    "Then\nam = b0cm + b1cm−1 + · · ·",
    "+ bmc0\nis not divisible by p, since each term on the right-hand side of the equation is divisible by p\nexcept for b0cm.",
    "Therefore, m = n since ai is divisible by p for m <",
    "n. Hence, f(x) cannot\nbe factored into polynomials of lower degree and therefore must be irreducible.\n",
    "■\n\nCHAPTER 17.",
    "POLYNOMIALS\n218\nExample 17.18",
    "The polynomial\nf(x)",
    "= 16x5 −9x4",
    "+ 3x2 + 6x −21\nis easily seen to be irreducible over Q by Eisenstein’s Criterion if we let p = 3.\n□\nEisenstein’s Criterion is more useful in constructing irreducible polynomials of a certain\ndegree over Q than in determining the irreducibility of an arbitrary polynomial in Q[x]:\ngiven an arbitrary polynomial, it is not very likely that we can apply Eisenstein’s Crite-\nrion.",
    "The real value of Theorem 17.17 is that we now have an easy method of generating\nirreducible polynomials of any degree.\n",
    "Ideals in F[x]\nLet F be a field.",
    "Recall that a principal ideal in F[x] is an ideal ⟨p(x)⟩generated by some\npolynomial p(x); that is,\n⟨p(x)⟩= {p(x)q(x) : q(x) ∈F[x]}.\n",
    "Example 17.19 The polynomial x2 in F[x] generates the ideal ⟨x2⟩consisting of all poly-\nnomials with no constant term or term of degree 1.\n□\nTheorem 17.20 If F is a field, then every ideal in F[x] is a principal ideal.\nProof.",
    "Let I be an ideal of F[x].",
    "If I is the zero ideal, the theorem is easily true.",
    "Suppose\nthat I is a nontrivial ideal in F[x], and let p(x) ∈I be a nonzero element of minimal degree.\n",
    "If deg p(x) = 0, then p(x) is a nonzero constant and 1 must be in I. Since 1 generates all of\nF[x], ⟨1⟩= I = F[x] and I is again a principal ideal.\n",
    "Now assume that deg p(x) ≥1 and let f(x) be any element in I.\n",
    "By the division\nalgorithm there exist q(x) and r(x) in F[x] such that f(x) = p(x)q(x)+r(x) and deg r(x) <\ndeg p(x).",
    "Since f(x), p(x) ∈I",
    "and I is an ideal, r(x) = f(x)−p(x)q(x) is also in I.",
    "However,\nsince we chose p(x) to be of minimal degree, r(x) must be the zero polynomial.",
    "Since we\ncan write any element f(x) in I as p(x)q(x) for some q(x) ∈F[x], it must be the case that\nI = ⟨p(x)⟩.\n■\nExample 17.21 It is not the case that every ideal in the ring F[x, y] is a principal ideal.\n",
    "Consider the ideal of F[x, y] generated by the polynomials x and y.",
    "This is the ideal of\nF[x, y] consisting of all polynomials with no constant term.",
    "Since both x and y are in the\nideal, no single polynomial can generate the entire ideal.\n",
    "□\nTheorem 17.22 Let F be a field and suppose that p(x) ∈F[x].",
    "Then the ideal generated\nby p(x) is maximal if and only if p(x) is irreducible.\nProof.",
    "Suppose that p(x) generates a maximal ideal of F[x].",
    "Then ⟨p(x)⟩is also a prime\nideal of F[x].",
    "Since a maximal ideal must be properly contained inside F[x], p(x) cannot\nbe a constant polynomial.",
    "Let us assume that p(x) factors into two polynomials of lesser\ndegree, say p(x) = f(x)g(x).",
    "Since ⟨p(x)⟩is a prime ideal one of these factors, say f(x), is\nin ⟨p(x)⟩and therefore be a multiple of p(x).",
    "But this would imply that ⟨p(x)⟩⊂⟨f(x)⟩,\nwhich is impossible since ⟨p(x)⟩is maximal.\n",
    "Conversely, suppose that p(x) is irreducible over F[x].",
    "Let I be an ideal in F[x] contain-\ning ⟨p(x)⟩. By Theorem 17.20, I is a principal ideal; hence, I = ⟨f(x)⟩for some f(x) ∈F[x].\n",
    "Since p(x) ∈I, it must be the case that p(x) = f(x)g(x) for some g(x) ∈F[x].",
    "However,\np(x) is irreducible; hence, either f(x) or g(x) is a constant polynomial.",
    "If f(x) is constant,\nthen I = F[x] and we are done.",
    "If g(x) is constant, then f(x) is a constant multiple of I\nand I = ⟨p(x)⟩. Thus, there are no proper ideals of F[x] that properly contain ⟨p(x)⟩.\n■\n\nCHAPTER 17.",
    "POLYNOMIALS\n219\nSage.\n",
    "Polynomial rings are very important for computational approaches to algebra, and\nso Sage makes it very easy to compute with polynomials, over rings, or over fields.",
    "And it\nis trivial to check if a polynomial is irreducible.\n",
    "Historical Note\nThroughout history, the solution of polynomial equations has been a challenging problem.\n",
    "The Babylonians knew how to solve the equation ax2 + bx + c",
    "= 0.",
    "Omar Khayyam (1048–\n1131) devised methods of solving cubic equations through the use of geometric constructions\nand conic sections.",
    "The algebraic solution of the general cubic equation ax3+bx2+cx+d = 0\nwas not discovered until the sixteenth century.",
    "An Italian mathematician, Luca Pacioli (ca.\n1445–1509), wrote in Summa de Arithmetica that the solution of the cubic was impossible.\n",
    "This was taken as a challenge by the rest of the mathematical community.\n",
    "Scipione del Ferro (1465–1526), of the University of Bologna, solved the “depressed cubic,”\nax3 + cx + d",
    "= 0.\n",
    "He kept his solution an absolute secret.\n",
    "This may seem surprising today, when mathe-\nmaticians are usually very eager to publish their results, but in the days of the Italian\nRenaissance secrecy was customary.",
    "Academic appointments were not easy to secure and\ndepended on the ability to prevail in public contests.",
    "Such challenges could be issued at\nany time.",
    "Consequently, any major new discovery was a valuable weapon in such a contest.\n",
    "If an opponent presented a list of problems to be solved, del Ferro could in turn present a\nlist of depressed cubics.",
    "He kept the secret of his discovery throughout his life, passing it\non only on his deathbed to his student Antonio Fior (ca. 1506–?).\n",
    "Although Fior was not the equal of his teacher, he immediately issued a challenge to Niccolo\nFontana (1499–1557).",
    "Fontana was known as Tartaglia (the Stammerer).",
    "As a youth he\nhad suffered a blow from the sword of a French soldier during an attack on his village.",
    "He\nsurvived the savage wound, but his speech was permanently impaired.",
    "Tartaglia sent Fior\na list of 30 various mathematical problems; Fior countered by sending Tartaglia a list of\n30 depressed cubics.",
    "Tartaglia would either solve all 30 of the problems or absolutely fail.\n",
    "After much effort Tartaglia finally succeeded in solving the depressed cubic and defeated\nFior, who faded into obscurity.\n",
    "At this point another mathematician, Gerolamo Cardano (1501–1576), entered the story.\n",
    "Cardano wrote to Tartaglia, begging him for the solution to the depressed cubic.",
    "Tartaglia\nrefused several of his requests, then finally revealed the solution to Cardano after the latter\nswore an oath not to publish the secret or to pass it on to anyone else.",
    "Using the knowledge\nthat he had obtained from Tartaglia, Cardano eventually solved the general cubic\nax3 + bx2 + cx",
    "+ d",
    "= 0.\n",
    "Cardano shared the secret with his student, Ludovico Ferrari (1522–1565), who solved the\ngeneral quartic equation,\nax4 + bx3 + cx2 + dx + e = 0.\n",
    "In 1543, Cardano and Ferrari examined del Ferro’s papers and discovered that he had also\nsolved the depressed cubic.",
    "Cardano felt that this relieved him of his obligation to Tartaglia,\nso he proceeded to publish the solutions in Ars Magna (1545), in which he gave credit to\ndel Ferro for solving the special case of the cubic.",
    "This resulted in a bitter dispute between\nCardano and Tartaglia, who published the story of the oath a year later.\n\n",
    "CHAPTER 17.",
    "POLYNOMIALS\n220\n17.4 Reading Questions\n1.\nSuppose p(x) is a polynomial of degree n with coeﬀicients from any field.",
    "How many\nroots can p(x) have?",
    "How does this generalize your high school algebra experience?\n2.\n",
    "What is the definition of an irreducible polynomial?\n3.\nFind the remainder upon division of 8 x5 −18 x4 + 20 x3 −25 x2 + 20 by 4 x2 −x −2.\n",
    "4.\n",
    "A single theorem in this chapter connects many of the ideas of this chapter to many\nof the ideas of the previous chapter.",
    "State a paraphrased version of this theorem.\n",
    "5.\nEarly in this chapter, we say, “We can prove many results for polynomial rings that\nare similar to the theorems we proved for the integers.”",
    "Write a short essay (or a very\nlong paragraph) justifying this assertion.\n",
    "17.5 Exercises\n1.\nList all of the polynomials of degree 3 or less in Z2[x].\n2.\nCompute each of the following.\n",
    "(a) (5x2 + 3x −4) +",
    "(4x2 −x + 9) in Z12[x]\n(b) (5x2 + 3x −4)(4x2 −x + 9) in Z12[x]\n(c) (7x3 + 3x2 −x) + (6x2 −8x + 4) in Z9[x]\n(d) (3x2 + 2x −4)",
    "+ (4x2 + 2) in Z5[x]\n(e) (3x2 + 2x −4)(4x2",
    "+ 2) in Z5[x]\n(f) (5x2 + 3x −2)2 in Z12[x]\n3.\nUse the division algorithm to find q(x) and r(x) such that a(x) = q(x)b(x) + r(x) with\ndeg r(x) <",
    "deg b(x) for each of the following pairs of polynomials.\n",
    "(a) a(x) = 5x3 + 6x2 −3x + 4 and b(x) = x −2 in Z7[x]\n(b) a(x) = 6x4 −2x3",
    "+ x2 −3x",
    "+ 1 and b(x)",
    "= x2 + x −2 in Z7[x]\n(c) a(x) = 4x5 −x3",
    "+",
    "x2 + 4 and b(x) = x3 −2 in Z5[x]\n(d) a(x) = x5 + x3 −x2 −x and b(x) = x3",
    "+ x in Z2[x]\n4.\nFind the greatest common divisor of each of the following pairs p(x) and q(x) of\npolynomials.",
    "If d(x) = gcd(p(x), q(x)), find two polynomials a(x) and b(x) such that\na(x)p(x)",
    "+ b(x)q(x) = d(x).\n",
    "(a) p(x) = x3−6x2+14x−15 and q(x) = x3−8x2+21x−18, where p(x), q(x) ∈Q[x]\n(b) p(x) = x3 + x2 −x + 1 and q(x)",
    "= x3 + x −1, where p(x), q(x) ∈Z2[x]\n(c) p(x) = x3 + x2",
    "−4x + 4 and q(x) = x3 + 3x −2, where p(x), q(x) ∈Z5[x]\n(d) p(x) = x3 −2x + 4 and q(x)",
    "= 4x3 + x",
    "+ 3, where p(x), q(x) ∈Q[x]\n5.\nFind all of the zeros for each of the following polynomials.\n",
    "(a) 5x3 + 4x2 −x + 9 in Z12[x]\n(b) 3x3 −4x2 −x + 4 in Z5[x]\n(c) 5x4",
    "+",
    "2x2 −3 in Z7[x]\n(d) x3 + x + 1 in Z2[x]\n\nCHAPTER 17.",
    "POLYNOMIALS\n221\n6.\nFind all of the units in Z[x].\n",
    "7.\nFind a unit p(x) in Z4[x] such that deg p(x) >",
    "1.\n8.\n",
    "Which of the following polynomials are irreducible over Q[x]?\n(a) x4 −2x3",
    "+ 2x2 + x + 4\n(b) x4 −5x3 + 3x −2\n(c) 3x5 −4x3 −6x2 + 6\n(d) 5x5 −6x4 −3x2",
    "+ 9x −15\n9.\n",
    "Find all of the irreducible polynomials of degrees 2 and 3 in Z2[x].\n",
    "10.",
    "Give two different factorizations of x2 + x",
    "+ 8 in Z10[x].\n",
    "11.",
    "Prove or disprove: There exists a polynomial p(x) in Z6[x] of degree n with more than\nn distinct zeros.\n",
    "12.",
    "If F is a field, show that F[x1, . . .",
    ", xn] is an integral domain.\n",
    "13.",
    "Show that the division algorithm does not hold for Z[x].",
    "Why does it fail?\n14.",
    "Prove or disprove: xp + a is irreducible for any a ∈Zp, where p is prime.\n",
    "15.",
    "Let f(x) be irreducible in F[x], where F is a field.",
    "If f(x) | p(x)q(x), prove that either\nf(x) | p(x) or f(x) | q(x).\n",
    "16.",
    "Suppose that R and S are isomorphic rings.",
    "Prove that R[x] ∼= S[x].\n17.",
    "Let F be a field and a ∈F. If p(x) ∈F[x], show that p(a) is the remainder obtained\nwhen p(x) is divided by x −a.\n18.",
    "The Rational Root Theorem.",
    "Let\np(x)",
    "= anxn + an−1xn−1 + · · ·",
    "+ a0 ∈Z[x],\nwhere an ̸= 0.",
    "Prove that if p(r/s) = 0, where gcd(r, s) = 1, then r | a0 and s | an.\n19.",
    "Let Q∗be the multiplicative group of positive rational numbers.",
    "Prove that Q∗is\nisomorphic to (Z[x], +).\n",
    "20.",
    "Cyclotomic Polynomials.",
    "The polynomial\nΦn(x)",
    "=",
    "xn −1\nx −1 = xn−1 + xn−2 + · · ·",
    "+ x + 1\nis called the cyclotomic polynomial.",
    "Show that Φp(x) is irreducible over Q for any\nprime p.\n21.",
    "If F is a field, show that there are infinitely many irreducible polynomials in F[x].\n22.",
    "Let R be a commutative ring with identity.",
    "Prove that multiplication is commutative\nin R[x].\n",
    "23.",
    "Let R be a commutative ring with identity.",
    "Prove that multiplication is distributive\nin R[x].\n",
    "24.",
    "Show that xp −x has p distinct zeros in Zp, for any prime p.",
    "Conclude that\nxp −x = x(x −1)(x −2) · · · (x −(p −1)).\n",
    "25.",
    "Let F be a field and f(x)",
    "= a0 + a1x",
    "+ · ·",
    "· + anxn be in F[x].",
    "Define f′(x)",
    "= a1 +\n2a2x + · · · + nanxn−1 to be the derivative of f(x).\n",
    "(a) Prove that\n(f + g)′(x) = f′(x) + g′(x).\n",
    "Conclude that we can define a homomorphism of abelian groups D : F[x] →F[x]\nby D(f(x))",
    "= f′(x).\n\n",
    "CHAPTER 17.",
    "POLYNOMIALS\n222\n(b) Calculate the kernel of D if char F = 0.\n(c) Calculate the kernel of D if char F = p.\n(d) Prove that\n(fg)′(x) = f′(x)g(x)",
    "+ f(x)g′(x).\n",
    "(e) Suppose that we can factor a polynomial f(x) ∈F[x] into linear factors, say\nf(x) = a(x −a1)(x −a2) · · · (x −an).\n",
    "Prove that f(x) has no repeated factors if and only if f(x) and f′(x) are relatively\nprime.\n",
    "26.",
    "Let F be a field.",
    "Show that F[x] is never a field.\n",
    "27.",
    "Let R be an integral domain.",
    "Prove that R[x1, . . .",
    ", xn] is an integral domain.\n",
    "28.",
    "Let R be a commutative ring with identity.",
    "Show that R[x] has a subring R′ isomorphic\nto R.\n29.",
    "Let p(x) and q(x) be polynomials in R[x], where R is a commutative ring with identity.\n",
    "Prove that deg(p(x)",
    "+ q(x))",
    "≤max(deg p(x), deg q(x)).\n",
    "17.6 Additional Exercises: Solving the Cubic and Quartic Equa-\ntions\n1.\nComplete the square to solve the general quadratic equation\nax2 + bx + c",
    "= 0\nto obtain\nx = −b ±\n√\nb2 −4ac\n2a\n.\n",
    "The discriminant of the quadratic equation ∆= b2 −4ac determines the nature of the\nsolutions of the equation.",
    "If ∆> 0, the equation has two distinct real solutions.",
    "If\n∆= 0, the equation has a single repeated real root.",
    "If ∆< 0, there are two distinct\nimaginary solutions.\n",
    "2.\nShow that any cubic equation of the form\nx3 + bx2 + cx + d",
    "= 0\ncan be reduced to the form y3 + py + q = 0 by making the substitution x",
    "= y −b/3.\n",
    "3.\nProve that the cube roots of 1 are given by\nω = −1 + i\n√\n3\n2\nω2 = −1 −i\n√\n3\n2\nω3 = 1.\n4.\nMake the substitution\ny = z −p\n3z\nfor y in the equation y3 + py",
    "+ q = 0",
    "and obtain two solutions A and B for z3.\n\n",
    "CHAPTER 17.",
    "POLYNOMIALS\n223\n5.\nShow that the product of the solutions obtained in (4) is −p3/27, deducing that\n3√\nAB =\n−p/3.\n",
    "6.\nProve that the possible solutions for z in (4) are given by\n3√\nA,\nω\n3√\nA,\nω2 3√\nA,\n3√\nB,\nω\n3√\nB,\nω2 3√\nB\nand use this result to show that the three possible solutions for y are\nωi 3\ns\n−q\n2",
    "+\nr\np3\n27 + q2\n4 + ω2i 3\ns\n−q\n2 −\nr\np3\n27 + q2\n4 ,\nwhere i = 0, 1, 2.\n7.\n",
    "The discriminant of the cubic equation is\n∆= p3\n27 + q2\n4 .\n",
    "Show that y3 + py + q = 0\n(a) has three real roots, at least two of which are equal, if ∆= 0.\n",
    "(b) has one real root and two conjugate imaginary roots if ∆> 0.\n",
    "(c) has three distinct real roots if ∆< 0.\n8.\nSolve the following cubic equations.\n",
    "(a) x3 −4x2 + 11x + 30 = 0\n(b) x3 −3x + 5 = 0\n(c) x3 −3x + 2 = 0\n(d) x3 + x + 3 = 0\n9.\nShow that the general quartic equation\nx4 + ax3 + bx2 + cx + d",
    "= 0\ncan be reduced to\ny4 + py2 +",
    "qy + r = 0\nby using the substitution",
    "x = y −a/4.\n",
    "10.",
    "Show that\n\u0012\ny2",
    "+ 1\n2z\n\u00132\n= (z −p)y2 −qy +\n\u00121\n4z2 −r\n\u0013\n.\n",
    "11.",
    "Show that the right-hand side of Exercise 17.6.10 can be put in the form (my + k)2 if\nand only if\nq2 −4(z −p)\n\u00121\n4z2 −r\n\u0013\n= 0.\n12.",
    "From Exercise 17.6.11 obtain the resolvent cubic equation\nz3 −pz2 −4rz + (4pr −q2) = 0.\n",
    "Solving the resolvent cubic equation, put the equation found in Exercise 17.6.10 in the\n\nCHAPTER 17.",
    "POLYNOMIALS\n224\nform\n\u0012\ny2 + 1\n2z\n\u00132\n= (my + k)2\nto obtain the solution of the quartic equation.\n",
    "13. Use this method to solve the following quartic equations.\n",
    "(a) x4 −x2 −3x + 2 = 0\n(b) x4 + x3 −7x2 −x + 6 = 0\n(c) x4 −2x2 + 4x −3",
    "= 0\n(d) x4 −4x3",
    "+ 3x2 −5x + 2 = 0\n\n18\nIntegral Domains\nOne of the most important rings we study is the ring of integers.",
    "It was our first example of\nan algebraic structure: the first polynomial ring that we examined was Z[x].",
    "We also know\nthat the integers sit naturally inside the field of rational numbers, Q.",
    "The ring of integers\nis the model for all integral domains.",
    "In this chapter we will examine integral domains in\ngeneral, answering questions about the ideal structure of integral domains, polynomial rings\nover integral domains, and whether or not an integral domain can be embedded in a field.\n",
    "18.1 Fields of Fractions\nEvery field is also an integral domain; however, there are many integral domains that are\nnot fields.",
    "For example, the integers Z form an integral domain but not a field.",
    "A question\nthat naturally arises is how we might associate an integral domain with a field.",
    "There is a\nnatural way to construct the rationals Q from the integers: the rationals can be represented\nas formal quotients of two integers.",
    "The rational numbers are certainly a field.",
    "In fact, it\ncan be shown that the rationals are the smallest field that contains the integers.",
    "Given an\nintegral domain D, our question now becomes how to construct a smallest field F containing\nD. We will do this in the same way as we constructed the rationals from the integers.\n",
    "An element p/q ∈Q is the quotient of two integers p and q; however, different pairs of\nintegers can represent the same rational number.",
    "For instance, 1/2 = 2/4 = 3/6.",
    "We know\nthat\n",
    "a\nb = c\nd\nif and only",
    "if ad = bc.",
    "A more formal way of considering this problem is to examine fractions\nin terms of equivalence relations.",
    "We can think of elements in Q as ordered pairs in Z × Z.\n",
    "A quotient p/q can be written as (p, q).",
    "For instance, (3, 7) would represent the fraction\n3/7.",
    "However, there are problems if we consider all possible pairs in Z ×",
    "Z.",
    "There is no\nfraction 5/0 corresponding to the pair (5, 0).",
    "Also, the pairs (3, 6) and (2, 4) both represent\nthe fraction 1/2.",
    "The first problem is easily solved if we require the second coordinate to\nbe nonzero.",
    "The second problem is solved by considering two pairs (a, b) and (c, d) to be\nequivalent if ad = bc.\n",
    "If we use the approach of ordered pairs instead of fractions, then we can study integral\ndomains in general.",
    "Let D be any integral domain and let\nS = {(a, b) : a, b ∈D and b ̸= 0}.\n",
    "Define a relation on S by (a, b) ∼(c, d) if ad = bc.\n",
    "Lemma 18.1 The relation ∼between elements of S is an equivalence relation.\n",
    "225\n\nCHAPTER 18.",
    "INTEGRAL DOMAINS\n226\nProof.",
    "Since D is commutative, ab = ba; hence, ∼is reflexive on D. Now suppose that\n(a, b) ∼(c, d).",
    "Then ad = bc or cb = da.",
    "Therefore, (c, d) ∼(a, b) and the relation is\nsymmetric.",
    "Finally, to show that the relation is transitive, let (a, b) ∼(c, d) and (c, d) ∼\n(e, f).",
    "In this case ad = bc and cf = de. Multiplying both sides of ad = bc by f yields\nafd = adf = bcf = bde = bed.\n",
    "Since D is an integral domain, we can deduce that af = be or (a, b) ∼(e, f).\n",
    "■\nWe will denote the set of equivalence classes on S by FD.\n",
    "We now need to define\nthe operations of addition and multiplication on FD.",
    "Recall how fractions are added and\nmultiplied in Q:\na\nb + c\nd = ad + bc\nbd\n;\na\nb · c\nd = ac\nbd.\n",
    "It seems reasonable to define the operations of addition and multiplication on FD in a\nsimilar manner.",
    "If we denote the equivalence class of (a, b) ∈S by [a, b], then we are led to\ndefine the operations of addition and multiplication on FD by\n[a, b] +",
    "[c, d]",
    "=",
    "[ad + bc, bd]\nand\n[a, b] ·",
    "[c, d] =",
    "[ac, bd],\nrespectively.",
    "The next lemma demonstrates that these operations are independent of the\nchoice of representatives from each equivalence class.\n",
    "Lemma 18.2 The operations of addition and multiplication on FD are well-defined.\n",
    "Proof.\n",
    "We will prove that the operation of addition is well-defined.\n",
    "The proof that\nmultiplication is well-defined is left as an exercise.",
    "Let [a1, b1] =",
    "[a2, b2] and [c1, d1] =",
    "[c2, d2].\n",
    "We must show that\n[a1d1 + b1c1, b1d1] =",
    "[a2d2 + b2c2, b2d2]\nor, equivalently, that\n(a1d1 + b1c1)(b2d2) = (b1d1)(a2d2 + b2c2).\n",
    "Since [a1, b1] =",
    "[a2, b2] and [c1, d1] =",
    "[c2, d2], we know that a1b2",
    "= b1a2",
    "and c1d2 = d1c2.\n",
    "Therefore,\n(a1d1 + b1c1)(b2d2) = a1d1b2d2 + b1c1b2d2\n= a1b2d1d2 + b1b2c1d2\n= b1a2d1d2 + b1b2d1c2\n= (b1d1)(a2d2 + b2c2).\n",
    "■\nLemma 18.3 The set of equivalence classes of S, FD, under the equivalence relation ∼,\ntogether with the operations of addition and multiplication defined by\n[a, b] +",
    "[c, d]",
    "=",
    "[ad + bc, bd]\n[a, b] ·",
    "[c, d] =",
    "[ac, bd],\nis a field.\n\n",
    "CHAPTER 18.",
    "INTEGRAL DOMAINS\n227\nProof.",
    "The additive and multiplicative identities are [0, 1] and [1, 1], respectively.",
    "To show\nthat [0, 1] is the additive identity, observe that\n[a, b] + [0, 1] =",
    "[a1 + b0, b1] =",
    "[a, b].\n",
    "It is easy to show that [1, 1] is the multiplicative identity.",
    "Let [a, b] ∈FD such that a ̸= 0.\n",
    "Then [b, a] is also in FD and [a, b] ·",
    "[b, a] =",
    "[1, 1]; hence, [b, a] is the multiplicative inverse for\n[a, b].",
    "Similarly, [−a, b] is the additive inverse of [a, b].",
    "We leave as exercises the verification\nof the associative and commutative properties of multiplication in FD.",
    "We also leave it to\nthe reader to show that FD is an abelian group under addition.\n",
    "It remains to show that the distributive property holds in FD; however,\n[a, b][e, f] +",
    "[c, d][e, f] =",
    "[ae, bf] +",
    "[ce, df]\n=",
    "[aedf + bfce, bdf2]\n= [aed + bce, bdf]\n=",
    "[ade + bce, bdf]\n= ([a, b] +",
    "[c, d])[e, f]\nand the lemma is proved.\n",
    "■\nThe field FD in Lemma 18.3 is called the field of fractions or field of quotients of the\nintegral domain D.\nTheorem 18.4 Let D be an integral domain.\n",
    "Then D can be embedded in a field of\nfractions FD, where any element in FD can be expressed as the quotient of two elements\nin D. Furthermore, the field of fractions FD is unique in the sense that if E is any field\ncontaining D, then there exists a map ψ : FD",
    "→E giving an isomorphism with a subfield\nof E such that ψ(a) = a for all elements a ∈D, where we identify a with its image in FD.\nProof.",
    "We will first demonstrate that D can be embedded in the field FD.",
    "Define a map\nϕ : D →FD by ϕ(a) =",
    "[a, 1].",
    "Then for a and b in D,\nϕ(a + b) =",
    "[a + b, 1] =",
    "[a, 1] +",
    "[b, 1] = ϕ(a) + ϕ(b)\nand\nϕ(ab) =",
    "[ab, 1] = [a, 1][b, 1] = ϕ(a)ϕ(b);\nhence, ϕ is a homomorphism.",
    "To show that ϕ is one-to-one, suppose that ϕ(a) = ϕ(b).\n",
    "Then [a, 1] =",
    "[b, 1], or a = a1 = 1b = b.",
    "Finally, any element of FD can be expressed as the\nquotient of two elements in D, since\nϕ(a)[ϕ(b)]−1 =",
    "[a, 1][b, 1]−1 =",
    "[a, 1] ·",
    "[1, b] =",
    "[a, b].\nNow let E be a field containing D and define a map ψ : FD",
    "→E by ψ([a, b]) = ab−1.\n",
    "To show that ψ is well-defined, let [a1, b1] =",
    "[a2, b2].",
    "Then a1b2 = b1a2.",
    "Therefore, a1b−1\n1\n=\na2b−1\n2\nand ψ([a1, b1]) = ψ([a2, b2]).\n",
    "If [a, b] and [c, d] are in FD, then\nψ([a, b] +",
    "[c, d]) = ψ([ad + bc, bd])\n= (ad + bc)(bd)−1\n= ab−1 + cd−1\n= ψ([a, b])",
    "+ ψ([c, d])\nand\nψ([a, b] ·",
    "[c, d]) = ψ([ac, bd])\n\nCHAPTER 18.",
    "INTEGRAL DOMAINS\n228\n= (ac)(bd)−1\n= ab−1cd−1\n= ψ([a, b])ψ([c, d]).\n",
    "Therefore, ψ is a homomorphism.\n",
    "To complete the proof of the theorem, we need to show that ψ is one-to-one.",
    "Suppose\nthat ψ([a, b]) = ab−1 = 0.",
    "Then a = 0b = 0",
    "and [a, b] =",
    "[0, b].",
    "Therefore, the kernel of ψ is\nthe zero element [0, b] in FD, and ψ is injective.\n",
    "■\nExample 18.5 Since Q is a field, Q[x] is an integral domain.",
    "The field of fractions of Q[x]\nis the set of all rational expressions p(x)/q(x), where p(x) and q(x) are polynomials over\nthe rationals and q(x) is not the zero polynomial.",
    "We will denote this field by Q(x).\n",
    "□\nWe will leave the proofs of the following corollaries of Theorem 18.4 as exercises.\n",
    "Corollary 18.6 Let F be a field of characteristic zero.",
    "Then F contains a subfield isomor-\nphic to Q.\nCorollary 18.7 Let F be a field of characteristic p.",
    "Then F contains a subfield isomorphic\nto Zp.\n",
    "18.2 Factorization in Integral Domains\nThe building blocks of the integers are the prime numbers.",
    "If F is a field, then irreducible\npolynomials in F[x] play a role that is very similar to that of the prime numbers in the\nring of integers.",
    "Given an arbitrary integral domain, we are led to the following series of\ndefinitions.\n",
    "Let R be a commutative ring with identity, and let a and b be elements in R. We say\nthat a divides b, and write a | b, if there exists an element c ∈R such that b = ac.",
    "A unit\nin R is an element that has a multiplicative inverse.",
    "Two elements a and b in R are said to\nbe associates if there exists a unit u in R such that a = ub.\n",
    "Let D be an integral domain.",
    "A nonzero element p ∈D that is not a unit is said to be\nirreducible provided that whenever p = ab, either a or b is a unit.",
    "Furthermore, p is prime\nif whenever p | ab either p | a or p | b.\n",
    "Example 18.8",
    "It is important to notice that prime and irreducible elements do not always\ncoincide.",
    "Let R be the subring (with identity) of Q[x, y] generated by x2, y2, and xy.",
    "Each\nof these elements is irreducible in R; however, xy is not prime, since xy divides x2y2",
    "but\ndoes not divide either x2 or y2.\n",
    "□\nThe Fundamental Theorem of Arithmetic states that every positive integer n > 1 can\nbe factored into a product of prime numbers p1 · · · pk, where the pi’s are not necessarily\ndistinct.",
    "We also know that such factorizations are unique up to the order of the pi’s.",
    "We\ncan easily extend this result to the integers.",
    "The question arises of whether or not such\nfactorizations are possible in other rings.",
    "Generalizing this definition, we say an integral\ndomain D is a unique factorization domain, or ufd, if D satisfies the following criteria.\n",
    "1. Let a ∈D such that a ̸= 0 and a is not a unit.",
    "Then a can be written as the product\nof irreducible elements in D.\n2.",
    "Let a = p1 · · ·",
    "pr = q1 · · · qs, where the pi’s and the qi’s are irreducible.",
    "Then r = s\nand there is a π ∈Sr such that pi and qπ(j) are associates for j = 1, . .",
    ". , r.\nExample 18.9",
    "The integers are a unique factorization domain by the Fundamental Theo-\nrem of Arithmetic.\n",
    "□\n\nCHAPTER 18.",
    "INTEGRAL DOMAINS\n229\nExample 18.10 Not every integral domain is a unique factorization domain.",
    "The subring\nZ[\n√\n3 i] = {a + b\n√\n3 i} of the complex numbers is an integral domain (Exercise 16.7.12,\nChapter 16).",
    "Let z = a + b\n√\n3 i and define ν : Z",
    "[\n√\n3 i] →N ∪{0} by ν(z)",
    "= |z|2 = a2 + 3b2.\n",
    "It is clear that ν(z) ≥0 with equality when z = 0.",
    "Also, from our knowledge of complex\nnumbers we know that ν(zw) = ν(z)ν(w).",
    "It is easy to show that if ν(z) = 1, then z is a\nunit, and that the only units of Z[\n√\n3 i] are 1 and −1.\n",
    "We claim that 4 has two distinct factorizations into irreducible elements:\n4 = 2 · 2 = (1 −\n√\n3 i)(1 +\n√\n3 i).\n",
    "We must show that each of these factors is an irreducible element in Z[\n√\n3 i].",
    "If 2 is not\nirreducible, then 2 = zw for elements z, w in Z[\n√\n3 i] where ν(z) = ν(w) = 2.",
    "However,\nthere does not exist an element in z in Z[\n√\n3 i] such that ν(z)",
    "= 2 because the equation\na2 + 3b2 = 2 has no integer solutions.",
    "Therefore, 2 must be irreducible.",
    "A similar argument\nshows that both 1−\n√\n3 i and 1+\n√\n3",
    "i are irreducible.",
    "Since 2 is not a unit multiple of either\n1 −\n√\n3 i or 1 +\n√\n3 i, 4 has at least two distinct factorizations into irreducible elements.\n",
    "□\nPrincipal Ideal Domains\nLet R be a commutative ring with identity.\n",
    "Recall that a principal ideal generated by\na ∈R is an ideal of the form ⟨a⟩= {ra : r ∈R}.",
    "An integral domain in which every ideal\nis principal is called a principal ideal domain, or pid.\n",
    "Lemma 18.11 Let D be an integral domain and let a,",
    "b ∈D.",
    "Then\n1. a | b if and only if ⟨b⟩⊂⟨a⟩.\n2. a and b are associates if and only if ⟨b⟩= ⟨a⟩.\n3.",
    "a is a unit in D if and only if ⟨a⟩= D.\nProof.\n",
    "(1) Suppose that a | b.",
    "Then b = ax for some x ∈D.",
    "Hence, for every r in\nD, br = (ax)r = a(xr) and ⟨b⟩⊂⟨a⟩. Conversely, suppose that ⟨b⟩⊂⟨a⟩. Then b ∈⟨a⟩.\nConsequently, b = ax for some x ∈D.",
    "Thus, a | b.\n(2) Since a and b are associates, there exists a unit u such that a = ub.",
    "Therefore, b | a\nand ⟨a⟩⊂⟨b⟩. Similarly, ⟨b⟩⊂⟨a⟩. It follows that ⟨a⟩= ⟨b⟩. Conversely, suppose that\n⟨a⟩= ⟨b⟩. By part (1), a | b and b | a.",
    "Then a = bx and b = ay for some x, y ∈D.",
    "Therefore,\na = bx = ayx.",
    "Since D is an integral domain, xy = 1; that is, x and y are units and a and\nb are associates.\n",
    "(3) An element a ∈D is a unit if and only if a is an associate of 1.",
    "However, a is an\nassociate of 1 if and only if ⟨a⟩= ⟨1⟩= D.\n■\nTheorem 18.12 Let D be a pid and ⟨p⟩be a nonzero ideal in D. Then ⟨p⟩is a maximal\nideal if and only if p is irreducible.\n",
    "Proof.\nSuppose that ⟨p⟩is a maximal ideal.\n",
    "If some element a in D divides p, then\n⟨p⟩⊂⟨a⟩. Since ⟨p⟩is maximal, either D = ⟨a⟩or ⟨p⟩= ⟨a⟩. Consequently, either a and p\nare associates or a is a unit.",
    "Therefore, p is irreducible.\n",
    "Conversely, let p be irreducible.",
    "If ⟨a⟩is an ideal in D such that ⟨p⟩⊂⟨a⟩⊂D, then\na | p.",
    "Since p is irreducible, either a must be a unit or a and p are associates.",
    "Therefore,\neither D = ⟨a⟩or ⟨p⟩= ⟨a⟩. Thus, ⟨p⟩is a maximal ideal.\n",
    "■\nCorollary 18.13 Let D be a pid.",
    "If p is irreducible, then p is prime.\n",
    "Proof.",
    "Let p be irreducible and suppose that p | ab.",
    "Then ⟨ab⟩⊂⟨p⟩.",
    "By Corollary 16.40,\nsince ⟨p⟩is a maximal ideal, ⟨p⟩must also be a prime ideal.",
    "Thus, either a ∈⟨p⟩or b ∈⟨p⟩.\nHence, either p | a or p | b.\n■\n\nCHAPTER 18.",
    "INTEGRAL DOMAINS\n230\nLemma 18.14 Let D be a pid.",
    "Let I1, I2, . . .",
    "be a set of ideals such that I1 ⊂I2 ⊂· · ·.\n",
    "Then there exists an integer N such that",
    "In = IN for all n ≥N.\nProof.",
    "We claim that I = S∞\ni=1 Ii is an ideal of D. Certainly I is not empty, since I1 ⊂I\nand 0",
    "∈I.",
    "If a, b ∈I, then a ∈Ii and b ∈Ij for some i and j in N. Without loss of\ngenerality we can assume that i ≤j.",
    "Hence, a and b are both in Ij and so a −b is also in Ij.\n",
    "Now let r ∈D and a ∈I. Again, we note that a ∈Ii for some positive integer i. Since Ii is\nan ideal, ra ∈Ii and hence must be in I.",
    "Therefore, we have shown that I is an ideal in D.\n",
    "Since D is a principal ideal domain, there exists an element a ∈D that generates I.\n",
    "Since a is in IN for some N ∈N, we know that IN = I = ⟨a⟩. Consequently, In = IN for\nn ≥N.\n■\nAny commutative ring satisfying the condition in Lemma 18.14 is said to satisfy the\nascending chain condition, or ACC.",
    "Such rings are called Noetherian rings, after Emmy\nNoether.\n",
    "Theorem 18.15 Every pid is a ufd.\nProof.",
    "Existence of a factorization.",
    "Let D be a pid and a be a nonzero element in D that\nis not a unit.",
    "If a is irreducible, then we are done.",
    "If not, then there exists a factorization\na = a1b1, where neither a1 nor b1 is a unit.",
    "Hence, ⟨a⟩⊂⟨a1⟩.",
    "By Lemma 18.11, we know\nthat ⟨a⟩̸= ⟨a1⟩; otherwise, a and a1 would be associates and b1 would be a unit, which\nwould contradict our assumption.",
    "Now suppose that a1 = a2b2, where neither a2 nor b2 is a\nunit.",
    "By the same argument as before, ⟨a1⟩⊂⟨a2⟩. We can continue with this construction\nto obtain an ascending chain of ideals\n⟨a⟩⊂⟨a1⟩⊂⟨a2⟩⊂· · · .\n",
    "By Lemma 18.14, there exists a positive integer N such that ⟨an⟩= ⟨aN⟩for all n ≥N.\nConsequently, aN must be irreducible.",
    "We have now shown that a is the product of two\nelements, one of which must be irreducible.\n",
    "Now suppose that a = c1p1, where p1 is irreducible.",
    "If c1 is not a unit, we can repeat\nthe preceding argument to conclude that ⟨a⟩⊂⟨c1⟩.",
    "Either c1 is irreducible or c1 = c2p2,\nwhere p2 is irreducible and c2 is not a unit.",
    "Continuing in this manner, we obtain another\nchain of ideals\n⟨a⟩⊂⟨c1⟩⊂⟨c2⟩⊂· · · .\n",
    "This chain must satisfy the ascending chain condition; therefore,\na = p1p2 · · · pr\nfor irreducible elements p1, . .",
    ".",
    ", pr.\nUniqueness of the factorization.",
    "To show uniqueness, let\na = p1p2 · · · pr = q1q2 · · · qs,\nwhere each pi and each qi is irreducible.",
    "Without loss of generality, we can assume that\nr < s. Since p1 divides q1q2 · · · qs, by Corollary 18.13 it must divide some qi.",
    "By rearranging\nthe qi’s, we can assume that p1 | q1; hence, q1 = u1p1 for some unit u1 in D. Therefore,\na = p1p2 · · · pr = u1p1q2 · · · qs\nor\np2 · · · pr = u1q2 · · · qs.\n",
    "Continuing in this manner, we can arrange the qi’s such that p2 = q2, p3 = q3, . .",
    ".",
    ", pr = qr,\nto obtain\nu1u2 · · · urqr+1 · · · qs = 1.\n",
    "In this case qr+1 · · · qs is a unit, which contradicts the fact that qr+1, . .",
    ".",
    ", qs are irreducibles.\n",
    "Therefore, r = s and the factorization of a is unique.\n",
    "■\n\nCHAPTER 18.",
    "INTEGRAL DOMAINS\n231\nCorollary 18.16 Let F be a field.",
    "Then F[x] is a ufd.\n",
    "Example 18.17",
    "Every pid is a ufd, but it is not the case that every ufd is a pid.",
    "In\nCorollary 18.31, we will prove that Z[x] is a ufd.",
    "However, Z[x] is not a pid.",
    "Let I =\n{5f(x) + xg(x) :",
    "f(x), g(x) ∈Z[x]}.",
    "We can easily show that I is an ideal of Z[x].",
    "Suppose\nthat I = ⟨p(x)⟩. Since 5 ∈I, 5 = f(x)p(x).",
    "In this case p(x)",
    "= p must be a constant.",
    "Since\nx ∈I, x = pg(x); consequently, p = ±1.",
    "However, it follows from this fact that ⟨p(x)⟩= Z[x].\n",
    "But this would mean that 3 is in I. Therefore, we can write 3 = 5f(x)+xg(x) for some f(x)\nand g(x) in Z[x].",
    "Examining the constant term of this polynomial, we see that 3 = 5f(x),\nwhich is impossible.\n",
    "□\nEuclidean Domains\nWe have repeatedly used the division algorithm when proving results about either Z or F[x],\nwhere F is a field.",
    "We should now ask when a division algorithm is available for an integral\ndomain.\n",
    "Let D be an integral domain such that there is a function ν : D \\ {0} →N satisfying\nthe following conditions.\n",
    "1.",
    "If a and b are nonzero elements in D, then ν(a) ≤ν(ab).\n",
    "2. Let a, b ∈D and suppose that b ̸= 0.",
    "Then there exist elements q, r ∈D such that\na = bq + r and either r = 0 or ν(r) < ν(b).\n",
    "Then D is called a Euclidean domain and ν is called a Euclidean valuation.\n",
    "Example 18.18 Absolute value on Z is a Euclidean valuation.\n",
    "□\nExample 18.19 Let F be a field.",
    "Then the degree of a polynomial in F[x] is a Euclidean\nvaluation.\n",
    "□\nExample 18.20 Recall that the Gaussian integers in Example 16.12 of Chapter 16 are\ndefined by\nZ[i]",
    "= {a + bi : a, b ∈Z}.\n",
    "We usually measure the size of a complex number a + bi by its absolute value,.",
    "|a + bi| =\n√\na2 + b2; however,\n√\na2 + b2 may not be an integer.",
    "For our valuation we will let ν(a+bi) =\na2 + b2 to ensure that we have an integer.\n",
    "We claim that ν(a + bi) = a2 + b2 is a Euclidean valuation on Z[i].",
    "Let z, w ∈Z[i].\n",
    "Then ν(zw) = |zw|2 = |z|2|w|2 = ν(z)ν(w).",
    "Since ν(z) ≥1 for every nonzero z ∈Z[i],\nν(z) ≤ν(z)ν(w).\n",
    "Next, we must show that for any z = a + bi and w = c + di in Z[i] with w ̸= 0, there\nexist elements q and r in Z[i] such that z = qw + r with either r = 0 or ν(r) < ν(w).",
    "We\ncan view z and w as elements in Q(i) = {p + qi : p, q ∈Q}, the field of fractions of Z[i].\nObserve that\nzw−1 = (a + bi) c −di\nc2 + d2\n= ac + bd\nc2 + d2 + bc −ad\nc2 + d2 i\n=\n\u0012\nm1 +\nn1\nc2 + d2\n\u0013\n+\n\u0012\nm2 +\nn2\nc2 + d2\n\u0013\n",
    "i\n= (m1 + m2i)",
    "+\n\u0012\nn1\nc2 + d2 +\nn2\nc2 + d2 i\n\u0013\n= (m1 + m2i)",
    "+ (s + ti)\n\nCHAPTER 18.",
    "INTEGRAL DOMAINS\n232\nin Q(i).",
    "In the last steps we are writing the real and imaginary parts as an integer plus a\nproper fraction.",
    "That is, we take the closest integer mi such that the fractional part satisfies\n|ni/(a2 + b2)| ≤1/2.",
    "For example, we write\n9\n8 = 1 + 1\n8\n15\n8 = 2 −1\n8.\n",
    "Thus, s and t are the “fractional parts” of zw−1 = (m1 +m2i)+(s+ti).",
    "We also know that\ns2 + t2 ≤1/4",
    "+",
    "1/4 = 1/2.",
    "Multiplying by w, we have\nz = zw−1w = w(m1",
    "+ m2i)",
    "+ w(s + ti) = qw + r,\nwhere q = m1 +m2i and r = w(s+ti).",
    "Since z and qw are in Z[i], r must be in Z[i].",
    "Finally,\nwe need to show that either r = 0 or ν(r) < ν(w).",
    "However,\nν(r)",
    "= ν(w)ν(s + ti) ≤1\n2ν(w) < ν(w).\n",
    "□\nTheorem 18.21",
    "Every Euclidean domain is a principal ideal domain.\n",
    "Proof.",
    "Let D be a Euclidean domain and let ν be a Euclidean valuation on D. Suppose\nI is a nontrivial ideal in D and choose a nonzero element b ∈I such that ν(b) is minimal\nfor all a ∈I. Since D is a Euclidean domain, there exist elements q and r in D such that\na = bq + r and either r = 0 or ν(r) < ν(b).",
    "But r = a −bq is in I since I is an ideal;\ntherefore, r = 0 by the minimality of b.",
    "It follows that a = bq and I = ⟨b⟩.\n■\nCorollary 18.22 Every Euclidean domain is a unique factorization domain.\n",
    "Factorization in D[x]\nOne of the most important polynomial rings is Z[x].",
    "One of the first questions that come\nto mind about Z[x] is whether or not it is a ufd.",
    "We will prove a more general statement\nhere.",
    "Our first task is to obtain a more general version of Gauss’s Lemma (Theorem 17.14).\n",
    "Let D be a unique factorization domain and suppose that\np(x) = anxn + · · · + a1x + a0\nin D[x].",
    "Then the content of p(x) is the greatest common divisor of a0, . . .",
    ", an.",
    "We say that\np(x) is primitive if gcd(a0, . . .",
    ", an) = 1.\n",
    "Example 18.23 In Z[x] the polynomial p(x) = 5x4 −3x3",
    "+ x −4 is a primitive polynomial\nsince the greatest common divisor of the coeﬀicients is 1; however, the polynomial q(x) =\n4x2 −6x + 8 is not primitive since the content of q(x) is 2.\n□\nTheorem 18.24\nGauss’s Lemma.",
    "Let D be a ufd and let f(x) and g(x) be primitive\npolynomials in D[x].",
    "Then f(x)g(x) is primitive.\n",
    "Proof.",
    "Let f(x)",
    "= Pm\ni=0 aixi and g(x)",
    "= Pn\ni=0 bixi.",
    "Suppose that p is a prime dividing\nthe coeﬀicients of f(x)g(x).",
    "Let r be the smallest integer such that p ∤ar and s be the\nsmallest integer such that p ∤bs.",
    "The coeﬀicient of xr+s in f(x)g(x) is\ncr+s = a0br+s + a1br+s−1 + · · · + ar+s−1b1 + ar+sb0.\n",
    "Since p divides a0, . . . , ar−1 and b0, . .",
    ".",
    ", bs−1, p divides every term of cr+s except for the\nterm arbs.",
    "However, since p | cr+s, either p divides ar or p divides bs.",
    "But this is impossible.\n",
    "■\n\nCHAPTER 18.",
    "INTEGRAL DOMAINS\n233\nLemma 18.25 Let D be a ufd, and let p(x) and q(x) be in D[x].",
    "Then the content of\np(x)q(x) is equal to the product of the contents of p(x) and q(x).\n",
    "Proof.\n",
    "Let p(x) = cp1(x) and q(x) = dq1(x), where c and d are the contents of p(x)\nand q(x), respectively.",
    "Then p1(x) and q1(x) are primitive.",
    "We can now write p(x)q(x)",
    "=\ncdp1(x)q1(x).",
    "Since p1(x)q1(x) is primitive, the content of p(x)q(x) must be cd.\n",
    "■\nLemma 18.26 Let D be a ufd and F its field of fractions.",
    "Suppose that p(x) ∈D[x] and\np(x) = f(x)g(x), where f(x) and g(x) are in F[x].",
    "Then p(x) = f1(x)g1(x), where f1(x)\nand g1(x) are in D[x].",
    "Furthermore, deg f(x) = deg f1(x) and deg g(x) = deg g1(x).\nProof.\n",
    "Let a and b be nonzero elements of D such that af(x), bg(x) are in D[x].",
    "We\ncan find a1, b1 ∈D",
    "such that af(x) = a1f1(x) and bg(x) = b1g1(x), where f1(x) and g1(x)\nare primitive polynomials in D[x].\n",
    "Therefore, abp(x) = (a1f1(x))(b1g1(x)).\n",
    "Since f1(x)\nand g1(x) are primitive polynomials, it must be the case that ab | a1b1",
    "by Gauss’s Lemma.\n",
    "Thus there exists a c ∈D such that p(x) = cf1(x)g1(x).",
    "Clearly, deg f(x) = deg f1(x) and\ndeg g(x) = deg g1(x).\n",
    "■\nThe following corollaries are direct consequences of Lemma 18.26.\n",
    "Corollary 18.27 Let D be a ufd and F its field of fractions.",
    "A primitive polynomial p(x)\nin D[x] is irreducible in F[x] if and only if it is irreducible in D[x].\n",
    "Corollary 18.28 Let D be a ufd and F its field of fractions.",
    "If p(x) is a monic polynomial\nin D[x] with p(x) = f(x)g(x) in F[x], then p(x) = f1(x)g1(x), where f1(x) and g1(x) are in\nD[x].",
    "Furthermore, deg f(x) = deg f1(x) and deg g(x) = deg g1(x).\n",
    "Theorem 18.29",
    "If D is a ufd, then D[x] is a ufd.\nProof.\n",
    "Let p(x) be a nonzero polynomial in D[x].\n",
    "If p(x) is a constant polynomial,\nthen it must have a unique factorization since D is a ufd.\n",
    "Now suppose that p(x) is\na polynomial of positive degree in D[x].\n",
    "Let F be the field of fractions of D, and let\np(x)",
    "= f1(x)f2(x) · · · fn(x) by a factorization of p(x), where each fi(x) is irreducible.",
    "Choose\nai ∈D such that aifi(x) is in D[x].",
    "There exist b1, . .",
    ".",
    ", bn ∈D such that aifi(x) = bigi(x),\nwhere gi(x) is a primitive polynomial in D[x].",
    "By Corollary 18.27, each gi(x) is irreducible\nin D[x].",
    "Consequently, we can write\na1 · · · anp(x) = b1 · · · bng1(x) · · · gn(x).\n",
    "Let b = b1 · · · bn.",
    "Since g1(x) · · · gn(x) is primitive, a1 · · · an divides b.",
    "Therefore, p(x) =\nag1(x) · · · gn(x), where a ∈D.",
    "Since D is a ufd, we can factor a as uc1 · · · ck, where u is a\nunit and each of the ci’s is irreducible in D.\n",
    "We will now show the uniqueness of this factorization.",
    "Let\np(x)",
    "= a1 · · · amf1(x) · · · fn(x)",
    "= b1 · · · brg1(x) · · · gs(x)\nbe two factorizations of p(x), where all of the factors are irreducible in D[x].",
    "By Corol-\nlary 18.27, each of the fi’s",
    "and gi’s is irreducible in F[x].",
    "The ai’s and the bi’s are units\nin F. Since F[x] is a pid, it is a ufd; therefore, n = s. Now rearrange the gi(x)’s",
    "so that\nfi(x) and gi(x) are associates for i = 1, . .",
    ". ,",
    "n.",
    "Then there exist c1, . . .",
    ", cn and d1, . . .",
    ", dn in\nD such that (ci/di)fi(x) = gi(x) or cifi(x) = digi(x).",
    "The polynomials fi(x) and gi(x) are\nprimitive; hence, ci and di are associates in D. Thus, a1 · · · am = ub1 · · · br in D, where u is\na unit in D. Since D is a unique factorization domain, m = s.",
    "Finally, we can reorder the\nbi’s so that ai and bi are associates for each i.",
    "This completes the uniqueness part of the\nproof.\n",
    "■\nThe theorem that we have just proven has several obvious but important corollaries.\n\n",
    "CHAPTER 18.",
    "INTEGRAL DOMAINS\n234\nCorollary 18.30 Let F be a field.",
    "Then F[x] is a ufd.\n",
    "Corollary 18.31 The ring of polynomials over the integers, Z[x], is a ufd.\n",
    "Corollary 18.32 Let D be a ufd.",
    "Then D[x1, . . .",
    ", xn] is a ufd.\nRemark 18.33",
    "It is important to notice that every Euclidean domain is a pid and every\npid is a ufd.",
    "However, as demonstrated by our examples, the converse of each of these\nstatements fails.",
    "There are principal ideal domains that are not Euclidean domains, and\nthere are unique factorization domains that are not principal ideal domains (Z[x]).\n",
    "Sage.\n",
    "Sage supports distinctions between “plain” rings, domains, principal ideal domains\nand fields.\n",
    "Support is often very good for constructions and computations with PID’s,\nbut sometimes problems get significantly harder (computationally) when a ring has less\nstructure that that of a PID.",
    "So be aware when using Sage that some questions may go\nunanswered for rings with less structure.\n",
    "Historical Note\nKarl Friedrich Gauss, born in Brunswick, Germany on April 30, 1777, is considered to be\none of the greatest mathematicians who ever lived.",
    "Gauss was truly a child prodigy.",
    "At\nthe age of three he was able to detect errors in the books of his father’s business.",
    "Gauss\nentered college at the age of 15.",
    "Before the age of 20, Gauss was able to construct a regular\n17-sided polygon with a ruler and compass.",
    "This was the first new construction of a regular\nn-sided polygon since the time of the ancient Greeks.",
    "Gauss succeeded in showing that if\nN = 22n",
    "+ 1 was prime, then it was possible to construct a regular N-sided polygon.\n",
    "Gauss obtained his Ph.D. in 1799 under the direction of Pfaff at the University of Helmstedt.\n",
    "In his dissertation he gave the first complete proof of the Fundamental Theorem of Algebra,\nwhich states that every polynomial with real coeﬀicients can be factored into linear factors\nover the complex numbers.\n",
    "The acceptance of complex numbers was brought about by\nGauss, who was the first person to use the notation of i for √−1.\n",
    "Gauss then turned his attention toward number theory; in 1801, he published his famous\nbook on number theory, Disquisitiones Arithmeticae.",
    "Throughout his life Gauss was in-\ntrigued with this branch of mathematics.",
    "He once wrote, “Mathematics is the queen of the\nsciences, and the theory of numbers is the queen of mathematics.”\n",
    "In 1807, Gauss was appointed director of the Observatory at the University of Göttingen, a\nposition he held until his death.",
    "This position required him to study applications of math-\nematics to the sciences.",
    "He succeeded in making contributions to fields such as astronomy,\nmechanics, optics, geodesy, and magnetism.",
    "Along with Wilhelm Weber, he coinvented the\nfirst practical electric telegraph some years before a better version was invented by Samuel\nF. B. Morse.\n",
    "Gauss was clearly the most prominent mathematician in the world in the early nineteenth\ncentury.",
    "His status naturally made his discoveries subject to intense scrutiny.",
    "Gauss’s cold\nand distant personality many times led him to ignore the work of his contemporaries, making\nhim many enemies.",
    "He did not enjoy teaching very much, and young mathematicians who\nsought him out for encouragement were often rebuffed.",
    "Nevertheless, he had many outstand-\ning students, including Eisenstein, Riemann, Kummer, Dirichlet, and Dedekind.",
    "Gauss also\noffered a great deal of encouragement to Sophie Germain (1776–1831), who overcame the\nmany obstacles facing women in her day to become a very prominent mathematician.",
    "Gauss\ndied at the age of 78 in Göttingen on February 23, 1855.\n\n",
    "CHAPTER 18.",
    "INTEGRAL DOMAINS\n235\n18.3 Reading Questions\n1.\n",
    "Integral domains are an abstraction of which two fundamental rings that we have\nalready studied?\n2.\n",
    "What are the various types of integral domains defined in this section?\n3.\n",
    "The field of fractions of a ring abstracts what idea from basic mathematics?\n4.\nIn the previous chapter we had a theorem about irreducible polynomials generating\nmaximal ideals.",
    "Which theorem in this chapter generalizes this previous result?\n",
    "5.\nDescribe an example which is a ufd, but not a pid.\n18.4 Exercises\n1.\nLet z = a + b\n√\n3 i be in Z[\n√\n3 i].",
    "If a2 + 3b2 = 1, show that z must be a unit.",
    "Show\nthat the only units of Z[\n√\n3 i] are 1 and −1.\n",
    "2.\n",
    "The Gaussian integers, Z[i], are a ufd.",
    "Factor each of the following elements in Z[i]\ninto a product of irreducibles.\n",
    "(a) 5\n(b) 1 + 3i\n(c) 6 + 8i\n(d) 2\n3.\nLet D be an integral domain.\n",
    "(a) Prove that FD is an abelian group under the operation of addition.\n",
    "(b) Show that the operation of multiplication is well-defined in the field of fractions,\nFD.\n",
    "(c) Verify the associative and commutative properties for multiplication in FD.\n",
    "4.\nProve or disprove: Any subring of a field F containing 1 is an integral domain.\n",
    "5.\nProve or disprove: If D is an integral domain, then every prime element in D is also\nirreducible in D.\n6.\n",
    "Let F be a field of characteristic zero.",
    "Prove that F contains a subfield isomorphic to\nQ.\n7.\nLet F be a field.\n",
    "(a) Prove that the field of fractions of F[x], denoted by F(x), is isomorphic to the\nset all rational expressions p(x)/q(x), where q(x) is not the zero polynomial.\n",
    "(b) Let p(x1, . . .",
    ", xn) and q(x1, . . .",
    ", xn) be polynomials in F[x1, . . .",
    ", xn].",
    "Show that\nthe set of all rational expressions p(x1, . . .",
    ", xn)/q(x1, . . .",
    ", xn) is isomorphic to the\nfield of fractions of F[x1, . . .",
    ", xn].",
    "We denote the field of fractions of F[x1, . . .",
    ", xn]\nby F(x1, . . .",
    ", xn).\n",
    "8.\nLet p be prime and denote the field of fractions of Zp[x] by Zp(x).",
    "Prove that Zp(x) is\nan infinite field of characteristic p.\n9.\n",
    "Prove that the field of fractions of the Gaussian integers, Z[i], is\nQ(i)",
    "= {p + qi : p, q ∈Q}.\n",
    "10.",
    "A field F is called a prime field if it has no proper subfields.",
    "If E is a subfield of F\nand E is a prime field, then E is a prime subfield of F.\n(a) Prove that every field contains a unique prime subfield.\n\n",
    "CHAPTER 18.",
    "INTEGRAL DOMAINS\n236\n(b) If F is a field of characteristic 0, prove that the prime subfield of F is isomorphic\nto the field of rational numbers, Q.\n(c)",
    "If F is a field of characteristic p, prove that the prime subfield of F is isomorphic\nto Zp.\n11.",
    "Let Z[\n√\n2 ] = {a + b\n√\n2 : a, b ∈Z}.\n",
    "(a) Prove that Z",
    "[\n√\n2 ] is an integral domain.\n",
    "(b) Find all of the units in Z[\n√\n2 ].\n",
    "(c) Determine the field of fractions of Z[\n√\n2 ].\n",
    "(d) Prove that Z[\n√\n2i] is a Euclidean domain under the Euclidean valuation ν(a +\nb\n√\n2 i) = a2 + 2b2.\n12.",
    "Let D be a ufd.",
    "An element d ∈D is a greatest common divisor of a and b in D if\nd | a and d | b and d is divisible by any other element dividing both a and b.\n(a) If D is a pid and a and b are both nonzero elements of D, prove there exists a\nunique greatest common divisor of a and b up to associates.",
    "That is, if d and d′\nare both greatest common divisors of a and b, then d and d′ are associates.",
    "We\nwrite gcd(a, b) for the greatest common divisor of a and b.\n(b) Let D be a pid and a and b be nonzero elements of D. Prove that there exist\nelements s and t in D such that gcd(a, b) = as + bt.\n13.",
    "Let D be an integral domain.",
    "Define a relation on D by a ∼b if a and b are associates\nin D. Prove that ∼is an equivalence relation on D.\n14.",
    "Let D be a Euclidean domain with Euclidean valuation ν.",
    "If u is a unit in D, show\nthat ν(u)",
    "= ν(1).\n",
    "15.",
    "Let D be a Euclidean domain with Euclidean valuation ν.",
    "If a and b are associates in\nD, prove that ν(a) = ν(b).\n",
    "16.",
    "Show that Z[\n√\n5 i] is not a unique factorization domain.\n17.",
    "Prove or disprove: Every subdomain of a ufd is also a ufd.\n18.",
    "An ideal of a commutative ring R is said to be finitely generated if there exist elements\na1, . . .",
    ", an in R such that every element r in the ideal can be written as a1r1+· · ·",
    "+anrn\nfor some r1, . .",
    ".",
    ", rn in R. Prove that R satisfies the ascending chain condition if and\nonly if every ideal of R is finitely generated.\n",
    "19.",
    "Let D be an integral domain with a descending chain of ideals I1 ⊃I2 ⊃I3 ⊃· · ·.\n",
    "Suppose that there exists an N such that Ik = IN for all k ≥N. A ring satisfying this\ncondition is said to satisfy the descending chain condition, or DCC.",
    "Rings satisfying\nthe DCC are called Artinian rings, after Emil Artin.\n",
    "Show that if D satisfies the\ndescending chain condition, it must satisfy the ascending chain condition.\n",
    "20.",
    "Let R be a commutative ring with identity.",
    "We define a multiplicative subset of R to\nbe a subset S such that 1 ∈S and ab",
    "∈S if a, b ∈S.\n(a) Define a relation ∼on R × S by (a, s) ∼(a′, s′) if there exists an s∗∈S such\nthat s∗(s′a −sa′) = 0.",
    "Show that ∼is an equivalence relation on R × S.\n(b) Let a/s denote the equivalence class of (a, s) ∈R × S and let S−1R be the set of\nall equivalence classes with respect to ∼.",
    "Define the operations of addition and\n\nCHAPTER 18.",
    "INTEGRAL DOMAINS\n237\nmultiplication on S−1R by\na\ns + b\nt = at + bs\nst\na\ns\nb\nt = ab\nst ,\nrespectively.\n",
    "Prove that these operations are well-defined on S−1R and that\nS−1R is a ring with identity under these operations.",
    "The ring S−1R is called the\nring of quotients of R with respect to S.\n(c) Show that the map ψ : R →S−1R defined by ψ(a) = a/1 is a ring homomor-\nphism.\n",
    "(d) If R has no zero divisors and 0 /∈S, show that ψ is one-to-one.\n(e) Prove that P is a prime ideal of R if and only if S = R \\ P is a multiplicative\nsubset of R.\n(f)",
    "If P is a prime ideal of R and S = R \\ P, show that the ring of quotients S−1R\nhas a unique maximal ideal.",
    "Any ring that has a unique maximal ideal is called\na local ring.\n",
    "18.5 References and Suggested Readings\n[1]\nAtiyah, M. F. and MacDonald, I. G. Introduction to Commutative Algebra.",
    "Westview\nPress, Boulder, CO, 1994.\n",
    "[2]\nZariski, O. and Samuel, P. Commutative Algebra, vols.",
    "I and II.",
    "Springer, New York,\n1975, 1960.\n\n19\nLattices and Boolean Algebras\nThe axioms of a ring give structure to the operations of addition and multiplication on a\nset.",
    "However, we can construct algebraic structures, known as lattices and Boolean algebras,\nthat generalize other types of operations.",
    "For example, the important operations on sets\nare inclusion, union, and intersection.",
    "Lattices are generalizations of order relations on\nalgebraic spaces, such as set inclusion in set theory and inequality in the familiar number\nsystems N, Z, Q, and R. Boolean algebras generalize the operations of intersection and\nunion.",
    "Lattices and Boolean algebras have found applications in logic, circuit theory, and\nprobability.\n",
    "19.1 Lattices\nPartially Ordered Sets\nWe begin the study of lattices and Boolean algebras by generalizing the idea of inequality.\n",
    "Recall that a relation on a set X is a subset of X ×X. A relation P on X is called a partial\norder of X if it satisfies the following axioms.\n",
    "1.",
    "The relation is reflexive: (a, a) ∈P for all a ∈X.\n2.",
    "The relation is antisymmetric: if (a, b) ∈P and (b, a) ∈P, then a = b.\n3.",
    "The relation is transitive: if (a, b) ∈P and (b, c) ∈P, then (a, c) ∈P.\nWe will usually write a ⪯b to mean (a, b) ∈P unless some symbol is naturally associated\nwith a particular partial order, such as a ≤b with integers a and b, or A ⊂B with sets A\nand",
    "B. A set X together with a partial order ⪯is called a partially ordered set, or poset.\n",
    "Example 19.1",
    "The set of integers (or rationals or reals) is a poset where a ≤b has the\nusual meaning for two integers a and b in Z.\n□\nExample 19.2 Let X be any set.",
    "We will define the power set of X to be the set of all\nsubsets of X.",
    "We denote the power set of X by P(X).",
    "For example, let X = {a, b, c}.",
    "Then\nP(X) is the set of all subsets of the set {a, b, c}:\n∅\n{a}\n{b}\n{c}\n{a, b}\n{a, c}\n{b, c}\n{a, b, c}.\n",
    "On any power set of a set X, set inclusion, ⊂, is a partial order.",
    "We can represent the order\non {a, b, c} schematically by a diagram such as the one in Figure 19.3.\n□\n238\n\nCHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n239\n{a, b, c}\n{a, b}\n{a, c}\n{b, c}\n{a}\n{b}\n{c}\n∅\nFigure 19.3 Partial order on P({a, b, c})\n",
    "Example 19.4 Let G be a group.",
    "The set of subgroups of G is a poset, where the partial\norder is set inclusion.\n",
    "□\nExample 19.5 There can be more than one partial order on a particular set.",
    "We can form\na partial order on N by a ⪯b if a | b.",
    "The relation is certainly reflexive since a | a for all\na ∈N.",
    "If m | n and n | m, then m = n; hence, the relation is also antisymmetric.",
    "The\nrelation is transitive, because if m | n and n | p, then m | p.\n",
    "□\nExample 19.6 Let X = {1, 2, 3, 4, 6, 8, 12, 24} be the set of divisors of 24 with the partial\norder defined in Example 19.5.",
    "Figure 19.7 shows the partial order on X.\n□\n24\n8\n12\n4\n6\n2\n3\n1\nFigure 19.7 A partial order on the divisors of 24\nLet Y be a subset of a poset X.",
    "An element u in X is an upper bound of Y if a ⪯u for\nevery element a ∈Y .",
    "If u is an upper bound of Y such that u ⪯v for every other upper\nbound v of Y , then u is called a least upper bound or supremum of Y .",
    "An element l in\nX is said to be a lower bound of Y if l ⪯a for all a ∈Y .",
    "If l is a lower bound of Y such\nthat k ⪯l for every other lower bound k of Y , then l is called a greatest lower bound or\ninfimum of Y .\n\n",
    "CHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n240\nExample 19.8 Let Y = {2, 3, 4, 6} be contained in the set X of Example 19.6.",
    "Then Y\nhas upper bounds 12 and 24, with 12 as a least upper bound.",
    "The only lower bound is 1;\nhence, it must be a greatest lower bound.\n",
    "□\nAs it turns out, least upper bounds and greatest lower bounds are unique if they exist.\n",
    "Theorem 19.9 Let Y be a nonempty subset of a poset X.",
    "If Y has a least upper bound,\nthen Y has a unique least upper bound.",
    "If Y has a greatest lower bound, then Y has a unique\ngreatest lower bound.\nProof.",
    "Let u1 and u2 be least upper bounds for Y .",
    "By the definition of the least upper\nbound, u1 ⪯u for all upper bounds u of Y .",
    "In particular, u1 ⪯u2.",
    "Similarly, u2 ⪯u1.\n",
    "Therefore, u1 = u2 by antisymmetry.",
    "A similar argument show that the greatest lower\nbound is unique.\n",
    "■\nOn many posets it is possible to define binary operations by using the greatest lower\nbound and the least upper bound of two elements.",
    "A lattice is a poset L such that every\npair of elements in L has a least upper bound and a greatest lower bound.",
    "The least upper\nbound of a, b ∈L is called the join of a and b and is denoted by a ∨b.",
    "The greatest lower\nbound of a, b ∈L is called the meet of a and b and is denoted by a ∧b.\n",
    "Example 19.10 Let X be a set.",
    "Then the power set of X, P(X), is a lattice.",
    "For two sets\nA and B in P(X), the least upper bound of A and B is A ∪B. Certainly A ∪B is an upper\nbound of A and B, since A ⊂A ∪B and B ⊂A ∪B. If C is some other set containing both\nA and B, then C must contain A ∪B; hence, A ∪B is the least upper bound of A and B.\nSimilarly, the greatest lower bound of A and B is A ∩B.\n□\nExample 19.11 Let G be a group and suppose that X is the set of subgroups of G. Then\nX is a poset ordered by set-theoretic inclusion, ⊂.",
    "The set of subgroups of G is also a lattice.\n",
    "If H and K are subgroups of G, the greatest lower bound of H and K is H ∩K.",
    "The set\nH ∪K may not be a subgroup of G.",
    "We leave it as an exercise to show that the least upper\nbound of H and K is the subgroup generated by H ∪K.\n□\nIn set theory we have certain duality conditions.",
    "For example, by De Morgan’s laws,\nany statement about sets that is true about (A ∪B)′ must also be true about A′ ∩B′.",
    "We\nalso have a duality principle for lattices.\n",
    "Axiom 19.12 Principle of Duality.",
    "Any statement that is true for all lattices remains\ntrue when ⪯is replaced by ⪰and ∨and ∧are interchanged throughout the statement.\n",
    "The following theorem tells us that a lattice is an algebraic structure with two binary\noperations that satisfy certain axioms.\n",
    "Theorem 19.13 If L is a lattice, then the binary operations ∨and",
    "∧satisfy the following\nproperties for a, b, c ∈L.\n1.",
    "Commutative laws: a ∨b = b ∨a and a ∧b = b ∧a.\n",
    "2.",
    "Associative laws: a ∨(b ∨c) = (a ∨b) ∨c and a ∧(b ∧c) = (a ∧b) ∧c.\n",
    "3.",
    "Idempotent laws: a ∨a = a and a ∧a = a.\n4.",
    "Absorption laws: a ∨(a ∧b) = a and a ∧(a ∨b)",
    "= a.\nProof.",
    "By the Principle of Duality, we need only prove the first statement in each part.\n",
    "(1) By definition a ∨b is the least upper bound of {a, b}, and b ∨a is the least upper\nbound of {b, a}; however, {a, b} = {b, a}.\n",
    "(2) We will show that a ∨(b ∨c) and (a ∨b) ∨c are both least upper bounds of {a, b, c}.\n",
    "Let d = a ∨b.",
    "Then c ⪯d ∨c = (a ∨b) ∨c.",
    "We also know that\na ⪯a ∨b = d ⪯d ∨c = (a ∨b) ∨c.\n\n",
    "CHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n241\nA similar argument demonstrates that b ⪯(a ∨b) ∨c.",
    "Therefore, (a ∨b) ∨c is an upper\nbound of {a, b, c}.",
    "We now need to show that (a ∨b) ∨c is the least upper bound of {a, b, c}.\n",
    "Let u be some other upper bound of {a, b, c}.",
    "Then a ⪯u and b ⪯u; hence, d = a ∨b ⪯u.\n",
    "Since c ⪯u, it follows that (a ∨b) ∨c = d ∨c ⪯u.",
    "Therefore, (a ∨b) ∨c must be the least\nupper bound of {a, b, c}.",
    "The argument that shows a ∨(b ∨c) is the least upper bound of\n{a, b, c} is the same.",
    "Consequently, a ∨(b ∨c) = (a ∨b) ∨c.\n",
    "(3) The join of a and a is the least upper bound of {a}; hence, a ∨a = a.\n(4) Let d = a ∧b.",
    "Then a ⪯a ∨d.",
    "On the other hand, d = a ∧b ⪯a, and so a ∨d ⪯a.\n",
    "Therefore, a ∨(a ∧b) = a.\n■\nGiven any arbitrary set L with operations ∨and",
    "∧, satisfying the conditions of the\nprevious theorem, it is natural to ask whether or not this set comes from some lattice.",
    "The\nfollowing theorem says that this is always the case.\n",
    "Theorem 19.14 Let L be a nonempty set with two binary operations ∨and ∧satisfying the\ncommutative, associative, idempotent, and absorption laws.",
    "We can define a partial order\non L by a ⪯b if a ∨b = b.",
    "Furthermore, L is a lattice with respect to ⪯if for all a, b ∈L,\nwe define the least upper bound and greatest lower bound of a and b by a ∨b and a ∧b,\nrespectively.\nProof.",
    "We first show that L is a poset under ⪯. Since a ∨a = a, a ⪯a and ⪯is reflexive.\n",
    "To show that ⪯is antisymmetric, let a ⪯b and b ⪯a.",
    "Then a ∨b = b and b ∨a = a. By\nthe commutative law, b = a ∨b = b ∨a = a.",
    "Finally, we must show that ⪯is transitive.",
    "Let\na ⪯b and b ⪯c.",
    "Then a ∨b = b and b ∨c = c.",
    "Thus,\na ∨c = a ∨(b ∨c) = (a ∨b) ∨c = b ∨c = c,\nor a ⪯c.\n",
    "To show that L is a lattice, we must prove that a∨b and a∧b are, respectively, the least\nupper and greatest lower bounds of a and b.",
    "Since a = (a ∨b) ∧a = a ∧(a ∨b), it follows\nthat a ⪯a ∨b.",
    "Similarly, b ⪯a ∨b.",
    "Therefore, a ∨b is an upper bound for a and b.",
    "Let u\nbe any other upper bound of both a and b.",
    "Then a ⪯u and b ⪯u.",
    "But a ∨b ⪯u since\n(a ∨b) ∨u = a ∨(b ∨u)",
    "= a ∨u = u.\n",
    "The proof that a ∧b is the greatest lower bound of a and b is left as an exercise.\n",
    "■\n19.2 Boolean Algebras\nLet us investigate the example of the power set, P(X), of a set X more closely.",
    "The power\nset is a lattice that is ordered by inclusion.",
    "By the definition of the power set, the largest\nelement in P(X) is X itself and the smallest element is ∅, the empty set.",
    "For any set A in\nP(X), we know that A ∩X = A and A ∪∅= A.",
    "This suggests the following definition for\nlattices.",
    "An element I in a poset X is a largest element if a ⪯I for all a ∈X. An element\nO is a smallest element of X if O ⪯a for all a ∈X.\nLet A be in P(X).",
    "Recall that the complement of A is\nA′ = X \\",
    "A = {x : x ∈X and x /∈A}.\n",
    "We know that A ∪A′ = X and A ∩A′ = ∅. We can generalize this example for lattices.\n",
    "A lattice L with a largest element I and a smallest element O is complemented if for each\na ∈L, there exists an a′",
    "such that a ∨a′ = I and a ∧a′ = O.\n",
    "In a lattice L, the binary operations ∨and",
    "∧satisfy commutative and associative laws;\n\nCHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n242\nhowever, they need not satisfy the distributive law\na ∧(b ∨c) = (a ∧b) ∨(a ∧c);\nhowever, in P(X) the distributive law is satisfied since\nA ∩(B ∪C) = (A ∩B) ∪(A ∩C)\nfor A, B, C ∈P(X).",
    "We will say that a lattice L is distributive if the following distributive\nlaw holds:\na ∧(b ∨c) = (a ∧b) ∨(a ∧c)\nfor all a, b, c ∈L.\nTheorem 19.15",
    "A lattice L is distributive if and only if\na ∨(b ∧c) = (a ∨b) ∧(a ∨c)\nfor all a, b, c ∈L.\nProof.",
    "Let us assume that L is a distributive lattice.\n",
    "a ∨(b ∧c) =",
    "[a ∨(a ∧c)]",
    "∨(b ∧c)\n= a ∨[(a ∧c) ∨(b ∧c)]\n= a ∨[(c ∧a) ∨(c ∧b)]\n= a ∨[c ∧(a ∨b)]\n= a ∨[(a ∨b) ∧c]\n= [(a ∨b) ∧a] ∨[(a ∨b) ∧c]\n= (a ∨b) ∧(a ∨c).\n",
    "The converse follows directly from the Duality Principle.\n",
    "■\nA Boolean algebra is a lattice B with a greatest element I and a smallest element O\nsuch that B is both distributive and complemented.",
    "The power set of X, P(X), is our\nprototype for a Boolean algebra.\n",
    "As it turns out, it is also one of the most important\nBoolean algebras.\n",
    "The following theorem allows us to characterize Boolean algebras in\nterms of the binary relations ∨and ∧without mention of the fact that a Boolean algebra\nis a poset.\n",
    "Theorem 19.16 A set B is a Boolean algebra if and only if there exist binary operations\n∨and ∧on B satisfying the following axioms.\n",
    "1.",
    "a ∨b = b ∨a and a ∧b = b ∧a for a, b ∈B.\n2.",
    "a ∨(b ∨c) = (a ∨b) ∨c and a ∧(b ∧c) = (a ∧b)",
    "∧c for a, b, c ∈B.\n3.",
    "a ∧(b ∨c)",
    "= (a ∧b) ∨(a ∧c) and a ∨(b ∧c) = (a ∨b) ∧(a ∨c) for a, b, c ∈B.\n4.",
    "There exist elements",
    "I and O such that a ∨O = a and a ∧I = a for all a ∈B.\n5.",
    "For every a ∈B there exists an a′ ∈B such that a ∨a′ = I and a ∧a′ = O.\nProof.",
    "Let B be a set satisfying (1)–(5) in the theorem.",
    "One of the idempotent laws is\nsatisfied since\na = a ∨O\n= a ∨(a ∧a′)\n= (a ∨a) ∧(a ∨a′)\n\n",
    "CHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n243\n= (a ∨a) ∧I\n= a ∨a.\n",
    "Observe that\nI ∨b = (b ∨b′)",
    "∨b = (b′ ∨b)",
    "∨b =",
    "b′",
    "∨(b ∨b)",
    "= b′ ∨b = I.\n",
    "Consequently, the first of the two absorption laws holds, since\na ∨(a ∧b) = (a ∧I)",
    "∨(a ∧b)\n",
    "= a ∧(I ∨b)\n= a ∧I\n= a.\n",
    "The other idempotent and absorption laws are proven similarly.",
    "Since B also satisfies (1)–\n(3), the conditions of Theorem 19.14 are met; therefore, B must be a lattice.",
    "Condition (4)\ntells us that B is a distributive lattice.\n",
    "For a ∈B, O ∨a = a; hence,",
    "O ⪯a and O is the smallest element in B. To show that I\nis the largest element in B, we will first show that a ∨b = b is equivalent to a ∧b = a. Since\na ∨I = a for all a ∈B, using the absorption laws we can determine that\na ∨I = (a ∧I) ∨I",
    "= I ∨(I ∧a) =",
    "I\nor a ⪯I for all a in B. Finally, since we know that B is complemented by (5), B must be\na Boolean algebra.\n",
    "Conversely, suppose that B is a Boolean algebra.",
    "Let I and O be the greatest and least\nelements in B, respectively.",
    "If we define a ∨b and a ∧b as least upper and greatest lower\nbounds of {a, b}, then B is a Boolean algebra by Theorem 19.14, Theorem 19.15, and our\nhypothesis.\n",
    "■\nMany other identities hold in Boolean algebras.",
    "Some of these identities are listed in\nthe following theorem.\n",
    "Theorem 19.17 Let B be a Boolean algebra.",
    "Then\n1. a ∨I = I and a ∧O = O for all a ∈B.\n2.",
    "If a ∨b = a ∨c and a ∧b = a ∧c for a, b, c ∈B, then b = c.\n3.",
    "If a ∨b = I and a ∧b = O, then b = a′.\n4.",
    "(a′)′ = a for all a ∈B.\n5.",
    "I′ = O and O′ = I.\n6.",
    "(a ∨b)′ = a′ ∧b′ and (a ∧b)′ = a′ ∨b′ (De Morgan’s Laws).\n",
    "Proof.\n",
    "We will prove only (2).\n",
    "The rest of the identities are left as exercises.\n",
    "For\na ∨b = a ∨c and a ∧b = a ∧c, we have\nb = b ∨(b ∧a)\n= b ∨(a ∧b)\n= b ∨(a ∧c)\n= (b ∨a) ∧(b ∨c)\n= (a ∨b) ∧(b ∨c)\n\n",
    "CHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n244\n= (a ∨c) ∧(b ∨c)\n= (c ∨a) ∧(c ∨b)\n= c ∨(a ∧b)\n= c ∨(a ∧c)\n",
    "= c ∨(c ∧a)\n= c.\n■\nFinite Boolean Algebras\nA Boolean algebra is a finite Boolean algebra if it contains a finite number of elements\nas a set.",
    "Finite Boolean algebras are particularly nice since we can classify them up to\nisomorphism.\n",
    "Let B and C be Boolean algebras.",
    "A bijective map ϕ : B →C is an isomorphism of\nBoolean algebras if\nϕ(a ∨b) = ϕ(a) ∨ϕ(b)\n",
    "ϕ(a ∧b) = ϕ(a) ∧ϕ(b)\nfor all a and b in B.\nWe will show that any finite Boolean algebra is isomorphic to the Boolean algebra\nobtained by taking the power set of some finite set X.",
    "We will need a few lemmas and\ndefinitions before we prove this result.",
    "Let B be a finite Boolean algebra.",
    "An element\na ∈B is an atom of B if a ̸= O and a ∧b = a for all b ∈B with b ̸= O. Equivalently, a is\nan atom of B if there is no b ∈B with b ̸= O distinct from a such that O ⪯b",
    "⪯a.\n",
    "Lemma 19.18 Let B be a finite Boolean algebra.",
    "If b is a element of B with b ̸= O, then\nthere is an atom a in B such that a ⪯b.\nProof.",
    "If b is an atom, let a = b. Otherwise, choose an element b1, not equal to O or b,\nsuch that b1 ⪯b.",
    "We are guaranteed that this is possible since b is not an atom.",
    "If b1 is an\natom, then we are done.",
    "If not, choose b2, not equal to O or b1, such that b2 ⪯b1.",
    "Again,\nif b2 is an atom, let a = b2.",
    "Continuing this process, we can obtain a chain\nO ⪯· · ·",
    "⪯b3 ⪯b2 ⪯b1 ⪯b.\n",
    "Since B is a finite Boolean algebra, this chain must be finite.",
    "That is, for some k, bk is an\natom.",
    "Let a = bk.\n",
    "■\nLemma 19.19 Let a and b be atoms in a finite Boolean algebra B such that a ̸= b.",
    "Then\na ∧b = O.\nProof.",
    "Since a ∧b is the greatest lower bound of a and b, we know that a ∧b ⪯a.",
    "Hence,\neither a ∧b = a or a ∧b = O. However, if a ∧b = a, then either a ⪯b or a = O.",
    "In either\ncase we have a contradiction because a and b are both atoms; therefore, a ∧b = O.\n■\nLemma 19.20 Let B be a Boolean algebra and a,",
    "b ∈B.",
    "The following statements are\nequivalent.\n",
    "1. a ⪯b.\n",
    "2. a ∧b′ = O.\n3.",
    "a′ ∨b = I.\n\nCHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n245\nProof.",
    "(1) ⇒(2).",
    "If a ⪯b, then a ∨b = b.",
    "Therefore,\na ∧b′ = a ∧(a ∨b)′\n= a ∧(a′ ∧b′)\n= (a ∧a′) ∧b′\n= O ∧b′\n= O.\n(2) ⇒(3).",
    "If a ∧b′ = O, then a′ ∨b = (a ∧b′)′ = O′ = I.\n(3) ⇒(1).",
    "If a′ ∨b = I, then\na = a ∧(a′ ∨b)\n= (a ∧a′) ∨(a ∧b)\n= O ∨(a ∧b)\n= a ∧b.\n",
    "Thus, a ⪯b.\n",
    "■\nLemma 19.21 Let B be a Boolean algebra and b and c be elements in B such that b ̸⪯c.\n",
    "Then there exists an atom a ∈B such that a ⪯b and a ̸⪯c.\nProof.",
    "By Lemma 19.20, b ∧c′ ̸= O. Hence, there exists an atom a such that a ⪯b ∧c′.\nConsequently, a ⪯b and a ̸⪯c.\n",
    "■\nLemma 19.22 Let b ∈B and a1, . .",
    ".",
    ", an be the atoms of B such that ai ⪯b.\n",
    "Then\nb = a1 ∨· · · ∨an.",
    "Furthermore, if a, a1, . . . , an are atoms of B such that a ⪯b, ai ⪯b, and\nb = a ∨a1 ∨· · · ∨an, then a = ai for some i = 1, . . .",
    ", n.\nProof.",
    "Let b1 = a1 ∨· · · ∨an.",
    "Since ai ⪯b for each i, we know that b1 ⪯b.",
    "If we can show\nthat b ⪯b1, then the lemma is true by antisymmetry.",
    "Assume b ̸⪯b1.",
    "Then there exists\nan atom a such that a ⪯b and a ̸⪯b1.",
    "Since a is an atom and a ⪯b, we can deduce that\na = ai for some ai.",
    "However, this is impossible since a ⪯b1.",
    "Therefore, b ⪯b1.\n",
    "Now suppose that b = a1 ∨· · · ∨an.",
    "If a is an atom less than b,\na = a ∧b = a ∧(a1 ∨· · · ∨an) = (a ∧a1) ∨· · ·",
    "∨(a ∧an).\n",
    "But each term is O or a with a ∧ai occurring for only one ai.",
    "Hence, by Lemma 19.19,\na = ai for some i.\n■\nTheorem 19.23 Let B be a finite Boolean algebra.",
    "Then there exists a set X such that B\nis isomorphic to P(X).\n",
    "Proof.",
    "We will show that B is isomorphic to P(X), where X is the set of atoms of B. Let\na ∈B. By Lemma 19.22, we can write a uniquely as a = a1 ∨· · · ∨an for a1, . . .",
    ", an ∈X.\nConsequently, we can define a map ϕ : B →P(X) by\nϕ(a) = ϕ(a1 ∨· · · ∨an) = {a1, . . .",
    ", an}.\n",
    "Clearly, ϕ is onto.\n",
    "Now let a = a1 ∨· · · ∨an and b = b1 ∨· · · ∨bm be elements in B, where each ai and each\nbi is an atom.",
    "If ϕ(a) = ϕ(b), then {a1, . .",
    ".",
    ", an} = {b1, . . .",
    ", bm} and",
    "a = b. Consequently, ϕ\nis injective.\n",
    "The join of a and b is preserved by ϕ since\nϕ(a ∨b) = ϕ(a1 ∨· · · ∨an ∨b1 ∨· · · ∨bm)\n= {a1, . . .",
    ", an, b1, . . .",
    ", bm}\n\nCHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n246\n= {a1, . .",
    ".",
    ", an} ∪{b1, . . .",
    ", bm}\n= ϕ(a1 ∨· · · ∨an) ∪ϕ(b1 ∧· · · ∨bm)\n= ϕ(a) ∪ϕ(b).\n",
    "Similarly, ϕ(a ∧b) = ϕ(a) ∩ϕ(b).\n",
    "■\nWe leave the proof of the following corollary as an exercise.\n",
    "Corollary 19.24",
    "The order of any finite Boolean algebra must be 2n for some positive\ninteger n.\n19.3 The Algebra of Electrical Circuits\nThe usefulness of Boolean algebras has become increasingly apparent over the past several\ndecades with the development of the modern computer.",
    "The circuit design of computer\nchips can be expressed in terms of Boolean algebras.",
    "In this section we will develop the\nBoolean algebra of electrical circuits and switches; however, these results can easily be\ngeneralized to the design of integrated computer circuitry.\n",
    "A switch is a device, located at some point in an electrical circuit, that controls the flow\nof current through the circuit.",
    "Each switch has two possible states: it can be open, and\nnot allow the passage of current through the circuit, or a it can be closed, and allow the\npassage of current.",
    "These states are mutually exclusive.",
    "We require that every switch be\nin one state or the other—a switch cannot be open and closed at the same time.",
    "Also, if\none switch is always in the same state as another, we will denote both by the same letter;\nthat is, two switches that are both labeled with the same letter a will always be open at\nthe same time and closed at the same time.\n",
    "Given two switches, we can construct two fundamental types of circuits.",
    "Two switches\na and b are in series if they make up a circuit of the type that is illustrated in Figure 19.25.\n",
    "Current can pass between the terminals A and B in a series circuit only if both of the\nswitches a and b are closed.",
    "We will denote this combination of switches by a ∧b.",
    "Two\nswitches a and b are in parallel if they form a circuit of the type that appears in Figure 19.26.\n",
    "In the case of a parallel circuit, current can pass between A and B if either one of the switches\nis closed.",
    "We denote a parallel combination of circuits a and b by a ∨b.\n",
    "A\na\nb\nB\nFigure 19.25 a ∧b\nA\na\nB\nb\nFigure 19.26 a ∨b\n",
    "We can build more complicated electrical circuits out of series and parallel circuits by\nreplacing any switch in the circuit with one of these two fundamental types of circuits.\n",
    "Circuits constructed in this manner are called series-parallel circuits.\n",
    "We will consider two circuits equivalent if they act the same.",
    "That is, if we set the\nswitches in equivalent circuits exactly the same we will obtain the same result.",
    "For example,\n\nCHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n247\nin a series circuit a∧b is exactly the same as b∧a.",
    "Notice that this is exactly the commutative\nlaw for Boolean algebras.",
    "In fact, the set of all series-parallel circuits forms a Boolean algebra\nunder the operations of ∨and",
    "∧.",
    "We can use diagrams to verify the different axioms of\na Boolean algebra.",
    "The distributive law, a ∧(b ∨c) = (a ∧b) ∨(a ∧c), is illustrated in\nFigure 19.27.",
    "If a is a switch, then a′ is the switch that is always open when a is closed and\nalways closed when a is open.",
    "A circuit that is always closed is I in our algebra; a circuit\nthat is always open is O.",
    "The laws for a ∧a′ = O and a ∨a′ = I are shown in Figure 19.28\nand Figure 19.29, respectively.\na\nb\nc\na\na\nb\nc\nFigure 19.27 a ∧(b ∨c) = (a ∧b) ∨(a ∧c)\na\na′\nFigure 19.28 a ∧a′ = O\na\na′\nFigure 19.29 a ∨a′",
    "= I\nExample 19.30",
    "Every Boolean expression represents a switching circuit.",
    "For example,\ngiven the expression (a ∨b) ∧(a ∨b′) ∧(a ∨b), we can construct the circuit in Figure 19.33.\n",
    "□\nTheorem 19.31 The set of all circuits is a Boolean algebra.\n",
    "We leave as an exercise the proof of this theorem for the Boolean algebra axioms not\nyet verified.",
    "We can now apply the techniques of Boolean algebras to switching theory.\n",
    "Example 19.32 Given a complex circuit, we can now apply the techniques of Boolean\nalgebra to reduce it to a simpler one.",
    "Consider the circuit in Figure 19.33.",
    "Since\n(a ∨b) ∧(a ∨b′) ∧(a ∨b) = (a ∨b) ∧(a ∨b) ∧(a ∨b′)\n= (a ∨b) ∧(a ∨b′)\n= a ∨(b ∧b′)\n= a ∨O\n= a,\nwe can replace the more complicated circuit with a circuit containing the single switch a\nand achieve the same function.\n",
    "□\n\nCHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n248\na\nb\na\nb′\na\nb\nFigure 19.33 (a ∨b) ∧(a ∨b′) ∧(a ∨b)\nSage.\n",
    "Sage has a full suite of functionality for both posets and lattices, all as part of its ex-\ncellent support for combinatorics.",
    "There is little in this chapter that cannot be investigated\nwith Sage.\n",
    "Historical Note\nGeorge Boole (1815–1864) was the first person to study lattices.",
    "In 1847, he published The\nInvestigation of the Laws of Thought, a book in which he used lattices to formalize logic\nand the calculus of propositions.",
    "Boole believed that mathematics was the study of form\nrather than of content; that is, he was not so much concerned with what he was calculating\nas with how he was calculating it.",
    "Boole’s work was carried on by his friend Augustus De\nMorgan (1806–1871).",
    "De Morgan observed that the principle of duality often held in set\ntheory, as is illustrated by De Morgan’s laws for set theory.",
    "He believed, as did Boole, that\nmathematics was the study of symbols and abstract operations.\n",
    "Set theory and logic were further advanced by such mathematicians as Alfred North White-\nhead (1861–1947), Bertrand Russell (1872–1970), and David Hilbert (1862–1943).",
    "In Prin-\ncipia Mathematica, Whitehead and Russell attempted to show the connection between math-\nematics and logic by the deduction of the natural number system from the rules of formal\nlogic.",
    "If the natural numbers could be determined from logic itself, then so could much\nof the rest of existing mathematics.",
    "Hilbert attempted to build up mathematics by using\nsymbolic logic in a way that would prove the consistency of mathematics.",
    "His approach\nwas dealt a mortal blow by Kurt Gödel (1906–1978), who proved that there will always\nbe “undecidable” problems in any suﬀiciently rich axiomatic system; that is, that in any\nmathematical system of any consequence, there will always be statements that can never\nbe proven either true or false.\n",
    "As often occurs, this basic research in pure mathematics later became indispensable in a\nwide variety of applications.",
    "Boolean algebras and logic have become essential in the design\nof the large-scale integrated circuitry found on today’s computer chips.",
    "Sociologists have\nused lattices and Boolean algebras to model social hierarchies; biologists have used them to\ndescribe biosystems.\n",
    "19.4 Reading Questions\n1.\nDescribe succinctly what a poset is.\n",
    "Do not just list the defining properties, but\ngive a description that another student of algebra who has never seen a poset might\nunderstand.",
    "For example, part of your answer might include what type of common\nalgebraic topics a poset generalizes, and your answer should be short on symbols.\n",
    "2.\n",
    "How does a lattice differ from a poset?\n",
    "Answer this in the spirit of the previous\nquestion.\n",
    "3.\n",
    "How does a Boolean algebra differ from a lattice?",
    "Again, answer this in the spirit of\nthe previous two questions.\n\n",
    "CHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n249\n4.\nGive two (perhaps related) reasons why any discussion of finite Boolean algebras might\ncenter on the example of the power set of a finite set.\n",
    "5.\nDescribe a major innovation of the middle twentieth century made possible by Boolean\nalgebra.\n",
    "19.5 Exercises\n1.\nDraw the lattice diagram for the power set of X = {a, b, c, d} with the set inclusion\nrelation, ⊂.\n2.\nDraw the diagram for the set of positive integers that are divisors of 30.",
    "Is this poset\na Boolean algebra?\n3.\nDraw a diagram of the lattice of subgroups of Z12.\n",
    "4.\nLet B be the set of positive integers that are divisors of 210.",
    "Define an order on B\nby a ⪯b",
    "if a | b. Prove that B is a Boolean algebra.",
    "Find a set X such that B is\nisomorphic to P(X).\n",
    "5.\nProve or disprove: Z is a poset under the relation a ⪯b if a | b.\n6.\n",
    "Draw the switching circuit for each of the following Boolean expressions.\n",
    "(a) (a ∨b ∨a′) ∧a\n(b) (a ∨b)′ ∧(a ∨b)\n(c) a ∨(a ∧b)\n(d) (c ∨a ∨b)",
    "∧c′ ∧(a ∨b)′\n7.\nDraw a circuit that will be closed exactly when only one of three switches a, b, and c\nare closed.\n",
    "8.\nProve or disprove that the two circuits shown are equivalent.\n",
    "a\nb\nc\na′\nb\na\nc′\na\na\nb\nc′\n9.\n",
    "Let X be a finite set containing n elements.",
    "Prove that |P(X)| = 2n.",
    "Conclude that\nthe order of any finite Boolean algebra must be 2n for some n ∈N.\n10.",
    "For each of the following circuits, write a Boolean expression.",
    "If the circuit can be\nreplaced by one with fewer switches, give the Boolean expression and draw a diagram\nfor the new circuit.\n\n",
    "CHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n250\na′\na\nb\nb′\na\na\nb\na′\nb\na′\nb\na\nb\nc\na′\nb′\nc\na\nb′\nc′\n11.",
    "Prove or disprove: The set of all nonzero integers is a lattice, where a ⪯b is defined\nby a | b.\n12.",
    "Let L be a nonempty set with two binary operations ∨and ∧satisfying the commuta-\ntive, associative, idempotent, and absorption laws.",
    "We can define a partial order on L,\nas in Theorem 19.14, by a ⪯b if a ∨b = b. Prove that the greatest lower bound of a\nand b is a ∧b.\n13.",
    "Let G be a group and X be the set of subgroups of G ordered by set-theoretic inclusion.\n",
    "If H and K are subgroups of G, show that the least upper bound of H and K is the\nsubgroup generated by H ∪K.\n14.",
    "Let R be a ring and suppose that X is the set of ideals of R. Show that X is a poset\nordered by set-theoretic inclusion, ⊂. Define the meet of two ideals I and J in X by\nI ∩J and the join of I and J by I + J. Prove that the set of ideals of R is a lattice\nunder these operations.\n",
    "15.",
    "Let B be a Boolean algebra.",
    "Prove each of the following identities.\n(a) a ∨I = I and a ∧O = O for all a ∈B.\n(b) If a ∨b = I and a ∧b = O, then b = a′.\n(c) (a′)′ = a for all a ∈B.\n(d) I′ = O and O′ = I.\n(e) (a ∨b)′ = a′ ∧b′ and (a ∧b)′ = a′ ∨b′ (De Morgan’s laws).\n",
    "16.",
    "By drawing the appropriate diagrams, complete the proof of Theorem 19.31 to show\nthat the switching functions form a Boolean algebra.\n",
    "17.",
    "Let B be a Boolean algebra.",
    "Define binary operations + and · on B by\na + b = (a ∧b′) ∨(a′ ∧b)\na · b = a ∧b.\n",
    "Prove that B is a commutative ring under these operations satisfying a2 = a for all\n\nCHAPTER 19.",
    "LATTICES AND BOOLEAN ALGEBRAS\n251\na ∈B.\n18.",
    "Let X be a poset such that for every a and b in X, either a ⪯b or b ⪯a.",
    "Then X is\nsaid to be a totally ordered set.\n",
    "(a) Is a | b a total order on N?\n(b) Prove that N, Z, Q, and R are totally ordered sets under the usual ordering ≤.\n19.",
    "Let X and Y be posets.",
    "A map ϕ : X →Y is order-preserving if a ⪯b implies that\nϕ(a) ⪯ϕ(b).",
    "Let L and M be lattices.",
    "A map ψ : L →M is a lattice homomorphism\nif ψ(a ∨b) = ψ(a) ∨ψ(b) and ψ(a ∧b) = ψ(a) ∧ψ(b).",
    "Show that every lattice homo-\nmorphism is order-preserving, but that it is not the case that every order-preserving\nhomomorphism is a lattice homomorphism.\n20.",
    "Let B be a Boolean algebra.",
    "Prove that a = b if and only if (a ∧b′) ∨(a′ ∧b) = O for\na, b ∈B.\n21.",
    "Let B be a Boolean algebra.",
    "Prove that a = O",
    "if and only if (a ∧b′) ∨(a′ ∧b) = b for\nall b ∈B.\n22.",
    "Let L and M be lattices.",
    "Define an order relation on L × M by (a, b) ⪯(c, d) if a ⪯c\nand b ⪯d.",
    "Show that L ×",
    "M is a lattice under this partial order.\n",
    "19.6 Programming Exercises\n1.\nA Boolean\nor switching function on n variables\nis a map f : {O, I}n →{0, I}.",
    "A\nBoolean polynomial is a special type of Boolean function: it is any type of Boolean\nexpression formed from a finite combination of variables x1, . . .",
    ", xn together with O\nand I, using the operations ∨, ∧, and ′. The values of the functions are defined in\nTable 19.34.",
    "Write a program to evaluate Boolean polynomials.\n",
    "Table 19.34 Boolean polynomials\nx\ny\nx′\nx ∨y\nx ∧y\n0\n0\n1\n0\n0\n0\n1\n1\n1\n0\n1\n0\n0\n1\n0\n1\n1\n0\n1\n1\n19.7 References and Suggested Readings\n[1]\nDonnellan, T. Lattice Theory .",
    "Pergamon Press, Oxford, 1968.\n",
    "[2]\nHalmos, P. R. “The Basic Concepts of Algebraic Logic,” American Mathematical\nMonthly 53 (1956), 363–87.\n",
    "[3]\nHohn, F. “Some Mathematical Aspects of Switching,” American Mathematical Monthly\n62 (1955), 75–90.\n",
    "[4]\nHohn, F. Applied Boolean Algebra.",
    "2nd ed.",
    "Macmillan, New York, 1966.\n",
    "[5]\nLidl, R. and Pilz, G. Applied Abstract Algebra.",
    "2nd ed.",
    "Springer, New York, 1998.\n",
    "[6]\nWhitesitt, J. Boolean Algebra and Its Applications.",
    "Dover, Mineola, NY, 2010.\n\n",
    "20\nVector Spaces\nIn a physical system a quantity can often be described with a single number.",
    "For example,\nwe need to know only a single number to describe temperature, mass, or volume.",
    "However,\nfor some quantities, such as location, we need several numbers.",
    "To give the location of\na point in space, we need x, y, and z coordinates.",
    "Temperature distribution over a solid\nobject requires four numbers: three to identify each point within the object and a fourth\nto describe the temperature at that point.",
    "Often n-tuples of numbers, or vectors, also have\ncertain algebraic properties, such as addition or scalar multiplication.\n",
    "In this chapter we will examine mathematical structures called vector spaces.",
    "As with\ngroups and rings, it is desirable to give a simple list of axioms that must be satisfied to\nmake a set of vectors a structure worth studying.\n",
    "20.1 Definitions and Examples\nA vector space V over a field F is an abelian group with a scalar product α·v or αv defined\nfor all α ∈F and all v ∈V satisfying the following axioms.\n",
    "• α(βv) = (αβ)v;\n• (α + β)v = αv + βv;\n• α(u + v) = αu + αv;\n• 1v = v;\nwhere α, β ∈F and u, v ∈V .\n",
    "The elements of V are called vectors; the elements of F are called scalars.",
    "It is important\nto notice that in most cases two vectors cannot be multiplied.",
    "In general, it is only possible\nto multiply a vector with a scalar.",
    "To differentiate between the scalar zero and the vector\nzero, we will write them as 0 and 0, respectively.\n",
    "Let us examine several examples of vector spaces.",
    "Some of them will be quite familiar;\nothers will seem less so.\n",
    "Example 20.1",
    "The n-tuples of real numbers, denoted by Rn, form a vector space over R.\nGiven vectors u = (u1, . .",
    ". , un) and v = (v1, . .",
    ". , vn) in Rn and α in R, we can define vector\naddition by\nu + v = (u1, . . .",
    ", un) + (v1, . .",
    ". , vn) = (u1 + v1, . .",
    ".",
    ", un + vn)\nand scalar multiplication by\nαu = α(u1, . . .",
    ", un) = (αu1, . . .",
    ", αun).\n",
    "252\n\nCHAPTER 20.",
    "VECTOR SPACES\n253\n□\nExample 20.2",
    "If F is a field, then F[x] is a vector space over F. The vectors in F[x]\nare simply polynomials, and vector addition is just polynomial addition.",
    "If α ∈F and\np(x) ∈F[x], then scalar multiplication is defined by αp(x).\n",
    "□\nExample 20.3",
    "The set of all continuous real-valued functions on a closed interval [a, b] is a\nvector space over R. If f(x) and g(x) are continuous on [a, b], then (f + g)(x) is defined to\nbe f(x)+g(x).",
    "Scalar multiplication is defined by (αf)(x) = αf(x) for α ∈R.",
    "For example,\nif f(x) = sin x and g(x) = x2, then (2f + 5g)(x)",
    "= 2 sin x",
    "+ 5x2.\n",
    "□\nExample 20.4 Let V = Q(\n√\n2 ) = {a + b\n√\n2 : a, b ∈Q}.",
    "Then V is a vector space over Q.\n",
    "If u = a + b\n√\n2 and v = c + d\n√\n2, then u + v = (a + c) + (b + d)\n√\n2 is again in V .",
    "Also,\nfor α ∈Q, αv is in V .",
    "We will leave it as an exercise to verify that all of the vector space\naxioms hold for V .\n",
    "□\nProposition 20.5 Let V be a vector space over F. Then each of the following statements\nis true.\n",
    "1. 0v = 0 for all v ∈V .\n",
    "2. α0 = 0 for all α ∈F.\n3.",
    "If αv = 0, then either α = 0 or v = 0.\n",
    "4. (−1)v = −v for all v ∈V .\n",
    "5. −(αv) = (−α)v = α(−v) for all α ∈F and all v ∈V .\n",
    "Proof.",
    "To prove (1), observe that\n0v = (0 + 0)v = 0v + 0v;\nconsequently, 0 + 0v = 0v + 0v.",
    "Since V is an abelian group, 0 = 0v.\n",
    "The proof of (2) is almost identical to the proof of (1).",
    "For (3), we are done if α = 0.\n",
    "Suppose that α ̸= 0.",
    "Multiplying both sides of αv = 0 by 1/α, we have v = 0.\n",
    "To show (4), observe that\nv + (−1)v = 1v + (−1)v = (1 −1)v = 0v = 0,\nand so −v = (−1)v.",
    "We will leave the proof of (5) as an exercise.\n",
    "■\n20.2 Subspaces\nJust as groups have subgroups and rings have subrings, vector spaces also have substructures.\n",
    "Let V be a vector space over a field F, and W a subset of V .",
    "Then W is a subspace of V if\nit is closed under vector addition and scalar multiplication; that is, if u, v ∈W and α ∈F,\nit will always be the case that u + v and αv are also in W.\nExample 20.6 Let W be the subspace of R3 defined by W = {(x1, 2x1 + x2, x1 −x2) :\nx1, x2 ∈R}.",
    "We claim that W is a subspace of R3.",
    "Since\nα(x1, 2x1 + x2, x1 −x2) = (αx1, α(2x1 + x2), α(x1 −x2))\n",
    "= (αx1, 2(αx1) + αx2, αx1 −αx2),\nW is closed under scalar multiplication.",
    "To show that W is closed under vector addition,\n\nCHAPTER 20.",
    "VECTOR SPACES\n254\nlet u = (x1, 2x1 + x2, x1 −x2) and v = (y1, 2y1 + y2, y1 −y2) be vectors in W. Then\nu + v = (x1 + y1, 2(x1 + y1)",
    "+",
    "(x2 + y2), (x1 + y1) −(x2 + y2)).\n",
    "□\nExample 20.7 Let W be the subset of polynomials of F[x] with no odd-power terms.",
    "If\np(x) and q(x) have no odd-power terms, then neither will p(x) + q(x).",
    "Also, αp(x) ∈W for\nα ∈F and p(x) ∈W.\n□\nLet V be any vector space over a field F and suppose that v1, v2, . .",
    ".",
    ", vn are vectors in\nV and α1, α2, . .",
    ".",
    ", αn are scalars in F. Any vector w in V of the form\nw =\nn\nX\ni=1\nαivi = α1v1",
    "+ α2v2",
    "+ · · · + αnvn\nis called a linear combination of the vectors v1, v2, . .",
    ".",
    ", vn.\n",
    "The spanning set of vectors\nv1, v2, . .",
    ".",
    ", vn is the set of vectors obtained from all possible linear combinations of v1, v2, . .",
    ".",
    ", vn.\n",
    "If W is the spanning set of v1, v2, . .",
    ".",
    ", vn, then we say that W is spanned by v1, v2, . . .",
    ", vn.\n",
    "Proposition 20.8 Let S = {v1, v2, . . .",
    ", vn} be vectors in a vector space V .",
    "Then the span\nof S is a subspace of V .\nProof.",
    "Let u and v be in S.",
    "We can write both of these vectors as linear combinations of\nthe vi’s:\nu = α1v1",
    "+ α2v2",
    "+ · · · + αnvn\nv = β1v1 + β2v2",
    "+ · · ·",
    "+ βnvn.\n",
    "Then\nu + v = (α1 + β1)v1 + (α2 + β2)v2 + · · · + (αn + βn)vn\nis a linear combination of the vi’s.",
    "For α ∈F,\nαu = (αα1)v1 + (αα2)v2 + · · · + (ααn)vn\nis in the span of S.\n■\n20.3 Linear Independence\nLet S = {v1, v2, . .",
    ". , vn} be a set of vectors in a vector space V .\n",
    "If there exist scalars\nα1, α2 . . .",
    "αn ∈F such that not all of the αi’s are zero and\nα1v1",
    "+ α2v2",
    "+ · · ·",
    "+ αnvn = 0,\nthen S is said to be linearly dependent.",
    "If the set S is not linearly dependent, then it is\nsaid to be linearly independent.",
    "More specifically, S is a linearly independent set if\nα1v1",
    "+ α2v2",
    "+ · · · + αnvn = 0\nimplies that\nα1 = α2 = · · · = αn = 0\nfor any set of scalars {α1, α2 . . .",
    "αn}.\n",
    "Proposition 20.9 Let {v1, v2, . . .",
    ", vn} be a set of linearly independent vectors in a vector\n\nCHAPTER 20.",
    "VECTOR SPACES\n255\nspace.",
    "Suppose that\nv =",
    "α1v1",
    "+",
    "α2v2",
    "+ · · · + αnvn = β1v1 + β2v2",
    "+ · · ·",
    "+ βnvn.\n",
    "Then α1 = β1, α2 = β2, . . . ,",
    "αn = βn.\nProof.",
    "If\nv = α1v1 + α2v2 + · · · + αnvn = β1v1 + β2v2 + · · · + βnvn,\nthen\n(α1 −β1)v1 +",
    "(α2 −β2)v2 + · · · + (αn −βn)vn = 0.\n",
    "Since v1, . . .",
    ", vn are linearly independent, αi −βi = 0 for i = 1, . . .",
    ", n.\n■\nThe definition of linear dependence makes more sense if we consider the following propo-\nsition.\n",
    "Proposition 20.10",
    "A set {v1, v2, . . .",
    ", vn} of vectors in a vector space V is linearly dependent\nif and only if one of the vi’s is a linear combination of the rest.\n",
    "Proof.",
    "Suppose that {v1, v2, . . .",
    ", vn} is a set of linearly dependent vectors.",
    "Then there\nexist scalars α1, . .",
    ".",
    ", αn such that\nα1v1",
    "+ α2v2",
    "+ · · ·",
    "+ αnvn = 0,\nwith at least one of the αi’s not equal to zero.",
    "Suppose that αk ̸= 0.",
    "Then\nvk = −α1\nαk\nv1 −· · · −αk−1\nαk\nvk−1 −αk+1\nαk\nvk+1 −· · · −αn\nαk\nvn.\n",
    "Conversely, suppose that\nvk = β1v1 + · ·",
    "· + βk−1vk−1 + βk+1vk+1 + · · · + βnvn.\n",
    "Then\nβ1v1 + · · · + βk−1vk−1 −vk + βk+1vk+1 + · · ·",
    "+ βnvn = 0.\n■\nThe following proposition is a consequence of the fact that any system of homogeneous\nlinear equations with more unknowns than equations will have a nontrivial solution.",
    "We\nleave the details of the proof for the end-of-chapter exercises.\n",
    "Proposition 20.11 Suppose that a vector space V is spanned by n vectors.",
    "If m > n, then\nany set of m vectors in V must be linearly dependent.\n",
    "A set {e1, e2, . . .",
    ", en} of vectors in a vector space V is called a basis for V if {e1, e2, . . .",
    ", en}\nis a linearly independent set that spans V .\n",
    "Example 20.12 The vectors e1 = (1, 0, 0), e2 = (0, 1, 0), and e3 = (0, 0, 1) form a basis\nfor R3.",
    "The set certainly spans R3, since any arbitrary vector (x1, x2, x3) in R3 can be\nwritten as x1e1",
    "+ x2e2",
    "+ x3e3.",
    "Also, none of the vectors e1, e2, e3 can be written as a linear\ncombination of the other two; hence, they are linearly independent.",
    "The vectors e1, e2, e3\nare not the only basis of R3: the set {(3, 2, 1), (3, 2, 0), (1, 1, 1)} is also a basis for R3.\n",
    "□\nExample 20.13 Let Q(\n√\n2 ) = {a+b\n√\n2 : a, b ∈Q}.",
    "The sets {1,\n√\n2 } and {1+\n√\n2, 1−\n√\n2 }\nare both bases of Q(\n√\n2 ).\n",
    "□\nFrom the last two examples it should be clear that a given vector space has several bases.\n",
    "In fact, there are an infinite number of bases for both of these examples.",
    "In general, there\nis no unique basis for a vector space.",
    "However, every basis of R3 consists of exactly three\n\nCHAPTER 20.",
    "VECTOR SPACES\n256\nvectors, and every basis of Q(\n√\n2 ) consists of exactly two vectors.",
    "This is a consequence of\nthe next proposition.\n",
    "Proposition 20.14 Let {e1, e2, . . .",
    ", em} and {f1, f2, . .",
    ".",
    ", fn} be two bases for a vector space\nV .",
    "Then m = n.\nProof.\n",
    "Since {e1, e2, . . .",
    ", em} is a basis, it is a linearly independent set.\n",
    "By Proposi-\ntion 20.11, n ≤m.",
    "Similarly, {f1, f2, . .",
    ".",
    ", fn} is a linearly independent set, and the last\nproposition implies that m ≤n.",
    "Consequently, m = n.\n■\nIf {e1, e2, . . .",
    ", en} is a basis for a vector space V , then we say that the dimension of V is\nn and we write dim V =",
    "n. We will leave the proof of the following theorem as an exercise.\n",
    "Theorem 20.15 Let V be a vector space of dimension n.\n1.",
    "If S = {v1, . .",
    ".",
    ", vn} is a set of linearly independent vectors for V , then S is a basis for\nV .\n",
    "2.",
    "If S = {v1, . .",
    ". , vn} spans V , then S is a basis for V .\n",
    "3.",
    "If S = {v1, . .",
    ".",
    ", vk} is a set of linearly independent vectors for V with k < n, then\nthere exist vectors vk+1, . .",
    ".",
    ", vn such that\n{v1, . . .",
    ", vk, vk+1, . . .",
    ", vn}\nis a basis for V .\n",
    "Sage.\n",
    "Many of Sage’s computations, in a wide variety of algebraic settings, come from\nsolving problems in linear algebra.",
    "So you will find a wealth of linear algebra functionality.\n",
    "Further, you can use structures such as finite fields to find vector spaces in new settings.\n",
    "20.4 Reading Questions\n1.\n",
    "Why do the axioms of a vector space appear to only have four conditions, rather than\nthe ten you may have seen the first time you saw an axiomatic definition?\n2.\n",
    "The set V = Q(\n√\n11) = {a + b\n√\n11 | a, b ∈Q} is a vector space.",
    "Carefully define the\noperations on this set that will make this possible.",
    "Describe the subspace spanned by\nS = {u}, where u = 3 + 2\n7\n√\n11 ∈V .\n",
    "3.\nWrite a long paragraph, or a short essay, on the importance of linear independence in\nlinear algebra.\n",
    "4.\nWrite a long paragraph, or a short essay, on the importance of spanning sets in linear\nalgebra.\n",
    "5.\n“Linear algebra is all about linear combinations.”",
    "Explain why you might say this.\n",
    "20.5 Exercises\n1.\n",
    "If F is a field, show that F[x] is a vector space over F, where the vectors in F[x]\nare polynomials.",
    "Vector addition is polynomial addition, and scalar multiplication is\ndefined by αp(x) for α ∈F.\n2.\nProve that Q(\n√\n2 ) is a vector space.\n",
    "3.\nLet Q(\n√\n2,\n√\n3 ) be the field generated by elements of the form a + b\n√\n2 + c\n√\n3 + d\n√\n6,\nwhere a, b, c, d are in Q. Prove that Q(\n√\n2,\n√\n3 ) is a vector space of dimension 4 over\n\nCHAPTER 20.",
    "VECTOR SPACES\n257\nQ. Find a basis for Q(\n√\n2,\n√\n3 ).\n",
    "4.\nProve that the complex numbers are a vector space of dimension 2 over R.\n5.\nProve that the set Pn of all polynomials of degree less than n form a subspace of the\nvector space F[x].",
    "Find a basis for Pn and compute the dimension of Pn.\n6.\nLet F be a field and denote the set of n-tuples of F by F n.\n",
    "Given vectors u =\n(u1, . . . , un) and v = (v1, . .",
    ". , vn) in F n and α in F, define vector addition by\nu + v = (u1, . .",
    ". , un) +",
    "(v1, . .",
    ". , vn) = (u1 + v1, . .",
    ".",
    ", un + vn)\nand scalar multiplication by\nαu = α(u1, . . .",
    ", un) = (αu1, . . .",
    ", αun).\n",
    "Prove that F n is a vector space of dimension n under these operations.\n",
    "7.\nWhich of the following sets are subspaces of R3?",
    "If the set is indeed a subspace, find\na basis for the subspace and compute its dimension.\n",
    "(a) {(x1, x2, x3) :",
    "3x1 −2x2",
    "+ x3 = 0}\n(b) {(x1, x2, x3) :",
    "3x1 + 4x3 = 0, 2x1 −x2 + x3 = 0}\n(c) {(x1, x2, x3) :",
    "x1 −2x2 + 2x3 = 2}\n(d) {(x1, x2, x3) :",
    "3x1 −2x2\n2 = 0}\n8.\nShow that the set of all possible solutions (x, y, z) ∈R3 of the equations\nAx +",
    "By + Cz = 0\nDx +",
    "Ey +",
    "Cz = 0\nform a subspace of R3.\n9.\n",
    "Let W be the subset of continuous functions on [0, 1] such that f(0)",
    "= 0.",
    "Prove that\nW is a subspace of C[0, 1].\n10.",
    "Let V be a vector space over F. Prove that −(αv) = (−α)v = α(−v) for all α ∈F\nand all v ∈V .\n",
    "11.",
    "Let V be a vector space of dimension n. Prove each of the following statements.\n",
    "(a) If S = {v1, . . .",
    ", vn} is a set of linearly independent vectors for V , then S is a basis\nfor V .\n",
    "(b) If S = {v1, . . .",
    ", vn} spans V , then S is a basis for V .\n",
    "(c) If S = {v1, . . .",
    ", vk} is a set of linearly independent vectors for V with k < n, then\nthere exist vectors vk+1, . .",
    ".",
    ", vn such that\n{v1, . . .",
    ", vk, vk+1, . . .",
    ", vn}\nis a basis for V .\n12.",
    "Prove that any set of vectors containing 0 is linearly dependent.\n",
    "13.",
    "Let V be a vector space.",
    "Show that {0} is a subspace of V of dimension zero.\n14.",
    "If a vector space V is spanned by n vectors, show that any set of m vectors in V must\nbe linearly dependent for m > n.\n\nCHAPTER 20.",
    "VECTOR SPACES\n258\n15.",
    "Linear Transformations.",
    "Let V and W be vector spaces over a field F, of dimensions\nm and n, respectively.",
    "If T : V →W is a map satisfying\nT(u",
    "+ v) = T(u)",
    "+",
    "T(v)\nT(αv) = αT(v)\nfor all α ∈F and all u, v ∈V , then T is called a linear transformation from V into W.\n(a) Prove that the kernel of T, ker(T) = {v ∈V : T(v) = 0}, is a subspace of V .\n",
    "The kernel of T is sometimes called the null space of T.\n(b) Prove that the range or range space of T, R(V )",
    "= {w ∈W : T(v) = w for some v ∈\nV }, is a subspace of W.\n(c) Show that T : V →W is injective if and only if ker(T) = {0}.\n",
    "(d) Let {v1, . .",
    ".",
    ", vk} be a basis for the null space of T. We can extend this basis to be\na basis {v1, . .",
    ".",
    ", vk, vk+1, . . .",
    ", vm} of V .",
    "Why?",
    "Prove that {T(vk+1), . . .",
    ", T(vm)}\nis a basis for the range of T. Conclude that the range of T has dimension m −k.\n(e) Let dim V = dim W. Show that a linear transformation T : V →W is injective\nif and only if it is surjective.\n",
    "16.",
    "Let V and W be finite dimensional vector spaces of dimension n over a field F. Suppose\nthat T : V →W is a vector space isomorphism.",
    "If {v1, . .",
    ".",
    ", vn} is a basis of V , show\nthat {T(v1), . .",
    ".",
    ", T(vn)} is a basis of W. Conclude that any vector space over a field F\nof dimension n is isomorphic to F n.\n17.",
    "Direct Sums.",
    "Let U and V be subspaces of a vector space",
    "W.",
    "The sum of U and V ,\ndenoted U + V , is defined to be the set of all vectors of the form u + v, where u ∈U\nand v ∈V .\n",
    "(a) Prove that U + V and U ∩V are subspaces of W.\n(b) If U + V = W and U ∩V",
    "= 0, then W is said to be the direct sum.",
    "In this case,\nwe write W = U ⊕V .",
    "Show that every element w ∈W can be written uniquely\nas w = u + v, where u ∈U and v ∈V .\n",
    "(c) Let U be a subspace of dimension k of a vector space W of dimension",
    "n. Prove\nthat there exists a subspace V of dimension n −k such that W = U ⊕V .",
    "Is the\nsubspace V unique?\n(d)",
    "If U and V are arbitrary subspaces of a vector space W, show that\ndim(U + V ) = dim U + dim V −dim(U ∩V ).\n",
    "18.",
    "Dual Spaces.",
    "Let V and W be finite dimensional vector spaces over a field",
    "F.\n(a) Show that the set of all linear transformations from V into W, denoted by\nHom(V, W), is a vector space over F, where we define vector addition as fol-\nlows:\n(S + T)(v)",
    "= S(v) + T(v)\n(αS)(v) = αS(v),\nwhere S, T ∈Hom(V, W), α ∈F, and v ∈V .\n",
    "(b) Let V be an F-vector space.",
    "Define the dual space of V to be V ∗= Hom(V, F).\n",
    "Elements in the dual space of V are called linear functionals.",
    "Let v1, . .",
    ".",
    ", vn be\n\nCHAPTER 20.",
    "VECTOR SPACES\n259\nan ordered basis for V .",
    "If v = α1v1 + · · · + αnvn is any vector in V , define a\nlinear functional ϕi :",
    "V →F by ϕi(v)",
    "= αi.",
    "Show that the ϕi’s form a basis for\nV ∗.",
    "This basis is called the dual basis of v1, . .",
    ".",
    ", vn (or simply the dual basis if\nthe context makes the meaning clear).\n",
    "(c) Consider the basis {(3, 1), (2, −2)} for R2.",
    "What is the dual basis for (R2)∗?\n(d) Let V be a vector space of dimension n over a field F and let V ∗∗be the dual\nspace of V ∗. Show that each element v ∈V gives rise to an element λv in V ∗∗\nand that the map v 7→λv is an isomorphism of V with V ∗∗.\n20.6 References and Suggested Readings\n[1]\nBeezer, R. A First Course in Linear Algebra .",
    "Available online at linear.ups.edu.\n",
    "2004–2014.\n[2]\nBretscher, O. Linear Algebra with Applications.",
    "4th ed.",
    "Pearson, Upper Saddle River,\nNJ, 2009.\n",
    "[3]\nCurtis, C. W. Linear Algebra: An Introductory Approach.",
    "4th ed.",
    "Springer, New\nYork, 1984.\n",
    "[4]\nHoffman, K. and Kunze, R. Linear Algebra.",
    "2nd ed.",
    "Prentice-Hall, Englewood Cliffs,\nNJ, 1971.\n",
    "[5]\nJohnson, L. W., Riess, R. D., and Arnold, J. T. Introduction to Linear Algebra.",
    "6th\ned.",
    "Pearson, Upper Saddle River, NJ, 2011.\n",
    "[6]\nLeon, S. J. Linear Algebra with Applications.",
    "8th ed.",
    "Pearson, Upper Saddle River,\nNJ, 2010.\n\n21\nFields\n",
    "It is natural to ask whether or not some field F is contained in a larger field.",
    "We think of\nthe rational numbers, which reside inside the real numbers, while in turn, the real numbers\nlive inside the complex numbers.",
    "We can also study the fields between Q and R and inquire\nas to the nature of these fields.\n",
    "More specifically if we are given a field F and a polynomial p(x) ∈F[x], we can ask\nwhether or not we can find a field E containing F such that p(x) factors into linear factors\nover E[x].",
    "For example, if we consider the polynomial\np(x) = x4 −5x2 + 6\nin Q[x], then p(x) factors as (x2 −2)(x2 −3).",
    "However, both of these factors are irreducible\nin Q[x].",
    "If we wish to find a zero of p(x), we must go to a larger field.",
    "Certainly the field\nof real numbers will work, since\np(x)",
    "= (x −\n√\n2)(x +\n√\n2)(x −\n√\n3)(x +\n√\n3).\n",
    "It is possible to find a smaller field in which p(x) has a zero, namely\nQ(\n√\n2) = {a + b\n√\n2 : a, b ∈Q}.\n",
    "We wish to be able to compute and study such fields for arbitrary polynomials over a field\nF.\n",
    "21.1",
    "Extension Fields\nA field E is an extension field of a field F if F is a subfield of E. The field F is called the\nbase field.",
    "We write F ⊂E.\nExample 21.1 For example, let\nF = Q(\n√\n2 ) = {a + b\n√\n2 : a, b ∈Q}\nand let E = Q(\n√\n2+\n√\n3 ) be the smallest field containing both Q and\n√\n2+\n√\n3.",
    "Both E and\nF are extension fields of the rational numbers.",
    "We claim that E is an extension field of F. To\nsee this, we need only show that\n√\n2 is in E. Since\n√\n2+\n√\n3 is in E, 1/(\n√\n2+\n√\n3 ) =\n√\n3−\n√\n2\nmust also be in E. Taking linear combinations of\n√\n2 +\n√\n3 and\n√\n3 −\n√\n2, we find that\n√\n2\nand\n√\n3 must both be in E.\n□\n260\n\nCHAPTER 21.",
    "FIELDS\n261\nExample 21.2 Let p(x)",
    "= x2",
    "+ x + 1 ∈Z2[x].",
    "Since neither 0 nor 1 is a root of this\npolynomial, we know that p(x) is irreducible over Z2.",
    "We will construct a field extension\nof Z2 containing an element α such that p(α)",
    "= 0.",
    "By Theorem 17.22, the ideal ⟨p(x)⟩\ngenerated by p(x) is maximal; hence, Z2[x]/⟨p(x)⟩is a field.\n",
    "Let f(x)",
    "+",
    "⟨p(x)⟩be an\narbitrary element of Z2[x]/⟨p(x)⟩. By the division algorithm,\nf(x)",
    "= (x2 + x",
    "+ 1)q(x)",
    "+ r(x),\nwhere the degree of r(x) is less than the degree of x2",
    "+ x",
    "+ 1.",
    "Therefore,\nf(x)",
    "+ ⟨x2 +",
    "x + 1⟩= r(x)",
    "+ ⟨x2 +",
    "x + 1⟩.\nThe only possibilities for r(x) are then 0, 1, x, and 1+x.",
    "Consequently, E = Z2[x]/⟨x2+x+1⟩\nis a field with four elements and must be a field extension of Z2, containing a zero α of p(x).\n",
    "The field Z2(α) consists of elements\n0",
    "+ 0α = 0\n1 + 0α = 1\n0 + 1α = α\n1 + 1α = 1 + α.\nNotice that α2 + α + 1 = 0; hence, if we compute (1 + α)2,\n(1 + α)(1 + α) = 1 + α +",
    "α",
    "+ (α)2 = α.\n",
    "Other calculations are accomplished in a similar manner.",
    "We summarize these computations\nin the following tables, which tell us how to add and multiply elements in E.\n□\n+\n0\n1\nα\n1 + α\n0\n0\n1\nα\n1 + α\n1\n1\n0\n1 + α\nα\nα\nα\n1 + α\n0\n1\n1 + α\n1 + α\nα\n1\n0\nFigure 21.3 Addition Table for Z2(α)\n·\n0\n1\nα\n1 + α\n0\n0\n0\n0\n0\n1\n0\n1\nα\n1 + α\nα\n0\nα\n1 + α\n1\n1 + α\n0\n1 + α\n1\nα\nFigure 21.4 Multiplication Table for Z2(α)\n",
    "The following theorem, due to Kronecker, is so important and so basic to our under-\nstanding of fields that it is often known as the Fundamental Theorem of Field Theory.\n",
    "Theorem 21.5 Let F be a field and let p(x) be a nonconstant polynomial in F[x].",
    "Then\nthere exists an extension field E of F and an element α ∈E such that p(α) = 0.\nProof.\n",
    "To prove this theorem, we will employ the method that we used to construct\nExample 21.2.",
    "Clearly, we can assume that p(x) is an irreducible polynomial.",
    "We wish to\nfind an extension field E of F containing an element α such that p(α) = 0.",
    "The ideal ⟨p(x)⟩\ngenerated by p(x) is a maximal ideal in F[x] by Theorem 17.22; hence, F[x]/⟨p(x)⟩is a field.\n\n",
    "CHAPTER 21.",
    "FIELDS\n262\n",
    "We claim that E = F[x]/⟨p(x)⟩is the desired field.\n",
    "We first show that E is a field extension of F.\n",
    "We can define a homomorphism of\ncommutative rings by the map ψ : F →F[x]/⟨p(x)⟩, where ψ(a) = a + ⟨p(x)⟩for a ∈F. It\nis easy to check that ψ is indeed a ring homomorphism.",
    "Observe that\nψ(a) + ψ(b) = (a + ⟨p(x)⟩)",
    "+ (b + ⟨p(x)⟩)",
    "= (a + b) + ⟨p(x)⟩= ψ(a + b)\nand\nψ(a)ψ(b) = (a + ⟨p(x)⟩)(b + ⟨p(x)⟩) = ab + ⟨p(x)⟩= ψ(ab).\n",
    "To prove that ψ is one-to-one, assume that\na + ⟨p(x)⟩= ψ(a) = ψ(b) = b + ⟨p(x)⟩.\nThen a−b is a multiple of p(x), since it lives in the ideal",
    "⟨p(x)⟩. Since p(x) is a nonconstant\npolynomial, the only possibility is that a −b = 0.",
    "Consequently, a = b and ψ is injective.\n",
    "Since ψ is one-to-one, we can identify F with the subfield {a + ⟨p(x)⟩: a ∈F} of E and\nview E as an extension field of F.\n",
    "It remains for us to prove that p(x) has a zero α ∈E. Set α = x + ⟨p(x)⟩. Then α is in\nE.",
    "If p(x) = a0 + a1x + · · · + anxn, then\np(α)",
    "= a0 + a1(x + ⟨p(x)⟩)",
    "+ · · ·",
    "+ an(x",
    "+ ⟨p(x)⟩)n\n= a0 + (a1x + ⟨p(x)⟩)",
    "+ · · · + (anxn + ⟨p(x)⟩)\n= a0 + a1x + · · · + anxn + ⟨p(x)⟩\n= 0 + ⟨p(x)⟩.\nTherefore, we have found an element α ∈E = F[x]/⟨p(x)⟩such that α is a zero of p(x).\n",
    "■\nExample 21.6 Let p(x) = x5 + x4 + 1 ∈Z2[x].",
    "Then p(x) has irreducible factors",
    "x2 + x + 1\nand x3 + x + 1.",
    "For a field extension E of Z2 such that p(x) has a root in E, we can let E\nbe either Z2[x]/⟨x2",
    "+ x + 1⟩or Z2[x]/⟨x3",
    "+ x + 1⟩. We will leave it as an exercise to show\nthat Z2[x]/⟨x3",
    "+ x + 1⟩is a field with 23 = 8 elements.\n",
    "□\nAlgebraic Elements\nAn element α in an extension field E over F is algebraic over F if f(α)",
    "= 0 for some nonzero\npolynomial f(x) ∈F[x].",
    "An element in E that is not algebraic over F is transcendental\nover F. An extension field E of a field F is an algebraic extension of F if every element in\nE is algebraic over F. If E is a field extension of F and α1, . .",
    ".",
    ", αn are contained in E, we\ndenote the smallest field containing F and α1, . . .",
    ", αn by F(α1, . .",
    ". , αn).",
    "If E = F(α) for\nsome α ∈E, then E is a simple extension of F.\nExample 21.7 Both\n√\n2 and i are algebraic over Q since they are zeros of the polynomials\nx2−2 and x2+1, respectively.",
    "Clearly π and e are algebraic over the real numbers; however,\nit is a nontrivial fact that they are transcendental over Q. Numbers in R that are algebraic\nover Q are in fact quite rare.",
    "Almost all real numbers are transcendental over Q.10(In",
    "many\ncases we do not know whether or not a particular number is transcendental; for example, it\nis still not known whether π + e is transcendental or algebraic.)\n□\nA complex number that is algebraic over Q is an algebraic number.",
    "A transcendental\nnumber is an element of C that is transcendental over Q.\n11The probability that a real number chosen at random from the interval [0, 1] will be transcendental over\nthe rational numbers is one.\n\n",
    "CHAPTER 21.",
    "FIELDS\n263\nExample 21.8",
    "We will show that\np\n2",
    "+\n√\n3 is algebraic over Q. If α =\np\n2 +\n√\n3, then\nα2 = 2 +\n√\n3.",
    "Hence, α2 −2 =\n√\n3 and (α2 −2)2 = 3.",
    "Since α4 −4α2 + 1 = 0, it must be\ntrue that α is a zero of the polynomial x4 −4x2 + 1 ∈Q[x].\n",
    "□\nIt is very easy to give an example of an extension field E over a field F, where E contains\nan element transcendental over F.\n",
    "The following theorem characterizes transcendental\nextensions.\n",
    "Theorem 21.9 Let E be an extension field of F and α ∈E.",
    "Then α is transcendental over\nF if and only if F(α) is isomorphic to F(x), the field of fractions of F[x].\nProof.",
    "Let ϕα : F[x] →E be the evaluation homomorphism for α.",
    "Then α is transcenden-\ntal over F if and only if ϕα(p(x))",
    "= p(α) ̸= 0 for all nonconstant polynomials p(x) ∈F[x].\n",
    "This is true if and only if ker ϕα = {0}; that is, it is true exactly when ϕα is one-to-one.\n",
    "Hence, E must contain a copy of F[x].",
    "The smallest field containing F[x] is the field of\nfractions F(x).",
    "By Theorem 18.4, E must contain a copy of this field.\n",
    "■\nWe have a more interesting situation in the case of algebraic extensions.\n",
    "Theorem 21.10 Let E be an extension field of a field F and α ∈E with α algebraic over\nF.",
    "Then there is a unique irreducible monic polynomial p(x) ∈F[x] of smallest degree such\nthat p(α)",
    "= 0.",
    "If f(x) is another polynomial in F[x] such that f(α)",
    "= 0, then p(x) divides\nf(x).\n",
    "Proof.\n",
    "Let ϕα : F[x] →E be the evaluation homomorphism.\n",
    "The kernel of ϕα is a\nprincipal ideal generated by some p(x) ∈F[x] with deg p(x) ≥1.",
    "We know that such a\npolynomial exists, since F[x] is a principal ideal domain and α is algebraic.",
    "The ideal ⟨p(x)⟩\nconsists exactly of those elements of F[x] having α as a zero.",
    "If f(α) = 0 and f(x) is not\nthe zero polynomial, then f(x) ∈⟨p(x)⟩and p(x) divides f(x).",
    "So p(x) is a polynomial of\nminimal degree having α as a zero.",
    "Any other polynomial of the same degree having α as\na zero must have the form βp(x) for some β ∈F.\nSuppose now that p(x)",
    "= r(x)s(x) is a factorization of p(x) into polynomials of lower\ndegree.",
    "Since p(α) = 0, r(α)s(α) = 0; consequently, either r(α) = 0 or s(α)",
    "= 0, which\ncontradicts the fact that p is of minimal degree.",
    "Therefore, p(x) must be irreducible.\n",
    "■\nLet E be an extension field of F and α ∈E be algebraic over F. The unique monic\npolynomial p(x) of the last theorem is called the minimal polynomial for α over F. The\ndegree of p(x) is the degree of α over F.\nExample 21.11 Let f(x)",
    "= x2 −2 and g(x)",
    "= x4 −4x2",
    "+ 1.",
    "These polynomials are the\nminimal polynomials of\n√\n2 and\np\n2",
    "+\n√\n3, respectively.\n□\nProposition 21.12 Let E be a field extension of F and α ∈E be algebraic over F. Then\nF(α) ∼= F[x]/⟨p(x)⟩, where p(x) is the minimal polynomial of α over F.\nProof.",
    "Let ϕα : F[x] →E be the evaluation homomorphism.",
    "The kernel of this map is\n⟨p(x)⟩, where p(x) is the minimal polynomial of α.",
    "By the First Isomorphism Theorem for\nrings, the image of ϕα in E is isomorphic to F(α) since it contains both F and α.\n■\nTheorem 21.13 Let E = F(α) be a simple extension of F, where α ∈E is algebraic over\nF. Suppose that the degree of α over F is n.",
    "Then every element β ∈E can be expressed\nuniquely in the form\nβ = b0 + b1α + · · · + bn−1αn−1\nfor bi ∈F.\nProof.",
    "Since ϕα(F[x]) ∼= F(α), every element in E = F(α) must be of the form ϕα(f(x))",
    "=\nf(α), where f(α) is a polynomial in α with coeﬀicients in F. Let\np(x)",
    "= xn + an−1xn−1 + · · · + a0\n\nCHAPTER 21.",
    "FIELDS\n264\nbe the minimal polynomial of α.",
    "Then p(α) = 0; hence,\nαn = −an−1αn−1 −· · · −a0.\n",
    "Similarly,\nαn+1 = ααn\n= −an−1αn −an−2αn−1 −· · · −a0α\n= −an−1(−an−1αn−1 −· · · −a0) −an−2αn−1 −· · · −a0α.\n",
    "Continuing in this manner, we can express every monomial αm, m ≥n, as a linear combi-\nnation of powers of α that are less than n. Hence, any β ∈F(α) can be written as\nβ = b0 + b1α + · · · + bn−1αn−1.\n",
    "To show uniqueness, suppose that\nβ = b0 + b1α + · · · + bn−1αn−1 = c0 + c1α + · · · + cn−1αn−1\nfor bi and ci in F. Then\ng(x) = (b0 −c0) +",
    "(b1 −c1)x + · · ·",
    "+ (bn−1 −cn−1)xn−1\nis in F[x] and g(α) = 0.\n",
    "Since the degree of g(x) is less than the degree of p(x), the\nirreducible polynomial of α, g(x) must be the zero polynomial.",
    "Consequently,\nb0 −c0 = b1 −c1 = · · · = bn−1 −cn−1 = 0,\nor bi = ci for i = 0, 1, . .",
    ". , n −1.",
    "Therefore, we have shown uniqueness.\n",
    "■\nExample 21.14 Since x2 + 1 is irreducible over R, ⟨x2 + 1⟩is a maximal ideal in R[x].",
    "So\nE = R[x]/⟨x2+1⟩is a field extension of R that contains a root of x2+1.",
    "Let α = x+⟨x2+1⟩.\nWe can identify E with the complex numbers.",
    "By Proposition 21.12, E is isomorphic to\nR(α) = {a + bα : a, b ∈R}.",
    "We know that α2 = −1 in E, since\nα2 + 1 = (x + ⟨x2 +",
    "1⟩)2 + (1 + ⟨x2 + 1⟩)\n",
    "= (x2 + 1) + ⟨x2 + 1⟩\n= 0.\n",
    "Hence, we have an isomorphism of R(α) with C defined by the map that takes a + bα to\na + bi.\n□\nLet E be a field extension of a field F.",
    "If we regard E as a vector space over F, then we\ncan bring the machinery of linear algebra to bear on the problems that we will encounter in\nour study of fields.",
    "The elements in the field E are vectors; the elements in the field F are\nscalars.",
    "We can think of addition in E as adding vectors.",
    "When we multiply an element in\nE by an element of F, we are multiplying a vector by a scalar.",
    "This view of field extensions\nis especially fruitful if a field extension E of F is a finite dimensional vector space over F,\nand Theorem 21.13 states that E = F(α) is finite dimensional vector space over F with\nbasis {1, α, α2, . . .",
    ", αn−1}.\n",
    "If an extension field E of a field F is a finite dimensional vector space over F of dimension\nn, then we say that E is a finite extension of degree n over F. We write\n[E : F] = n.\n\nCHAPTER 21.",
    "FIELDS\n265\nto indicate the dimension of E over F.\nTheorem 21.15 Every finite extension field E of a field F is an algebraic extension.\n",
    "Proof.",
    "Let α ∈E. Since [E : F] = n, the elements\n1, α, . .",
    ".",
    ", αn\ncannot be linearly independent.",
    "Hence, there exist ai ∈F, not all zero, such that\nanαn + an−1αn−1 + · · · + a1α + a0 = 0.\n",
    "Therefore,\np(x) = anxn + · · ·",
    "+ a0 ∈F[x]\nis a nonzero polynomial with p(α)",
    "= 0.\n",
    "■\nRemark 21.16",
    "Theorem 21.15 says that every finite extension of a field F is an algebraic\nextension.",
    "The converse is false, however.",
    "We will leave it as an exercise to show that the\nset of all elements in R that are algebraic over Q forms an infinite field extension of Q.\n",
    "The next theorem is a counting theorem, similar to Lagrange’s Theorem in group theory.\n",
    "Theorem 21.17 will prove to be an extremely useful tool in our investigation of finite field\nextensions.\n",
    "Theorem 21.17",
    "If E is a finite extension of F and K is a finite extension of E, then K\nis a finite extension of F and\n",
    "[K : F] =",
    "[K : E][E : F].\nProof.",
    "Let {α1, . . .",
    ", αn} be a basis for E as a vector space over F and {β1, . . .",
    ", βm} be a\nbasis for K as a vector space over E.",
    "We claim that {αiβj} is a basis for K over F. We will\nfirst show that these vectors span K. Let u ∈K. Then u = Pm\nj=1 bjβj and bj = Pn\ni=1 aijαi,\nwhere bj ∈E and aij ∈F.",
    "Then\nu =\nm\nX\nj=1\n n\nX\ni=1\naijαi\n!\n",
    "βj =\nX\ni,j\naij(αiβj).\n",
    "So the mn vectors αiβj must span K over F.\n",
    "We must show that {αiβj} are linearly independent.\n",
    "Recall that a set of vectors\nv1, v2, . .",
    ".",
    ", vn in a vector space V are linearly independent if\nc1v1 + c2v2 + · · ·",
    "+ cnvn = 0\nimplies that\nc1 = c2 = · · · = cn = 0.\n",
    "Let\nu =\nX\ni,j\ncij(αiβj) = 0\nfor cij ∈F. We need to prove that all of the cij’s are zero.",
    "We can rewrite u as\nm\nX\nj=1\n n\nX\ni=1\ncijαi\n!\n",
    "βj = 0,\nwhere P\ni cijαi ∈E.",
    "Since the βj’s are linearly independent over E, it must be the case\nthat\nn\nX\ni=1\ncijαi = 0\n\nCHAPTER 21.",
    "FIELDS\n266\nfor all j.",
    "However, the αj are also linearly independent over F. Therefore, cij = 0 for all i\nand j, which completes the proof.\n",
    "■\nThe following corollary is easily proved using mathematical induction.\n",
    "Corollary 21.18 If Fi is a field for i = 1, . .",
    ".",
    ", k and Fi+1 is a finite extension of Fi, then\nFk is a finite extension of F1 and\n",
    "[Fk : F1]",
    "=",
    "[Fk : Fk−1] · · ·",
    "[F2 : F1].\n",
    "Corollary 21.19 Let E be an extension field of F. If α ∈E is algebraic over F with\nminimal polynomial p(x) and β ∈F(α) with minimal polynomial q(x), then deg q(x) divides\ndeg p(x).\n",
    "Proof.",
    "We know that deg p(x)",
    "=",
    "[F(α) : F] and deg q(x) =",
    "[F(β) : F].",
    "Since F ⊂F(β) ⊂\nF(α),\n[F(α) : F] =",
    "[F(α) : F(β)][F(β) : F].\n■\nExample 21.20 Let us determine an extension field of Q containing\n√\n3 +\n√\n5.",
    "It is easy\nto determine that the minimal polynomial of\n√\n3 +\n√\n5 is x4 −16x2",
    "+",
    "4.",
    "It follows that\n[Q(\n√\n3 +\n√\n5 ) : Q] = 4.\n",
    "We know that {1,\n√\n3 } is a basis for Q(\n√\n3 ) over Q.\nHence,\n√\n3 +\n√\n5 cannot be in\nQ(\n√\n3 ).\n",
    "It follows that\n√\n5 cannot be in Q(\n√\n3 ) either.\n",
    "Therefore, {1,\n√\n5 } is a basis\nfor Q(\n√\n3,\n√\n5 ) = (Q(\n√\n3 ))",
    "(\n√\n5 ) over Q(\n√\n3 ) and {1,\n√\n3,\n√\n5,\n√\n3\n√\n5 =\n√\n15 } is a basis for\nQ(\n√\n3,\n√\n5 ) = Q(\n√\n3 +\n√\n5 ) over Q.\n",
    "This example shows that it is possible that some\nextension F(α1, . .",
    ".",
    ", αn) is actually a simple extension of F even though n > 1.\n□\nExample 21.21 Let us compute a basis for Q(\n3√\n5,\n√\n5 i), where\n√\n5 is the positive square\nroot of 5 and\n3√\n5 is the real cube root of 5.",
    "We know that\n√\n5 i /∈Q(\n3√\n5 ), so\n[Q(\n3√\n5,\n√\n5 i) : Q(\n3√\n5 )]",
    "= 2.\n",
    "It is easy to determine that {1,\n√\n5i } is a basis for Q(\n3√\n5,\n√\n5 i) over Q(\n3√\n5 ).",
    "We also know\nthat {1,\n3√\n5, (\n3√\n5 )2} is a basis for Q(\n3√\n5 ) over Q. Hence, a basis for Q(\n3√\n5,\n√\n5 i) over Q is\n{1,\n√\n5 i,\n3√\n5, (\n3√\n5 )2, (\n6√\n5 )5i, (\n6√\n5 )7i = 5\n6√\n5 i or\n6√\n5 i}.\n",
    "Notice that\n6√\n5 i is a zero of x6 + 5.",
    "We can show that this polynomial is irreducible over\nQ using Eisenstein’s Criterion, where we let p = 5.",
    "Consequently,\nQ ⊂Q(\n6√\n5 i) ⊂Q(\n3√\n5,\n√\n5 i).\n",
    "But it must be the case that Q(\n6√\n5 i) = Q(\n3√\n5,\n√\n5 i), since the degree of both of these\nextensions is 6.\n□\nTheorem 21.22 Let E be a field extension of F.\n",
    "Then the following statements are\nequivalent.\n",
    "1. E is a finite extension of F.\n2.",
    "There exists a finite number of algebraic elements α1, . .",
    ". , αn ∈E such that E =\nF(α1, . .",
    ". , αn).\n",
    "3.",
    "There exists a sequence of fields\nE = F(α1, . .",
    ". , αn) ⊃F(α1, . .",
    ". , αn−1) ⊃· · · ⊃F(α1) ⊃F,\n\nCHAPTER 21.",
    "FIELDS\n267\nwhere each field F(α1, . . .",
    ", αi) is algebraic over F(α1, . . .",
    ", αi−1).\n",
    "Proof.",
    "(1) ⇒(2).",
    "Let E be a finite algebraic extension of F. Then E is a finite dimensional\nvector space over F and there exists a basis consisting of elements α1, . .",
    ".",
    ", αn in E such that\nE = F(α1, . . .",
    ", αn).",
    "Each αi is algebraic over F by Theorem 21.15.\n",
    "(2) ⇒(3).",
    "Suppose that E = F(α1, . . .",
    ", αn), where every αi is algebraic over F. Then\nE = F(α1, . .",
    ". , αn) ⊃F(α1, . .",
    ". , αn−1) ⊃· · · ⊃F(α1) ⊃F,\nwhere each field F(α1, . .",
    ".",
    ", αi) is algebraic over F(α1, . . .",
    ", αi−1).\n",
    "(3) ⇒(1).",
    "Let\nE = F(α1, . .",
    ". , αn) ⊃F(α1, . .",
    ". , αn−1) ⊃· · · ⊃F(α1) ⊃F,\nwhere each field F(α1, . .",
    ".",
    ", αi) is algebraic over F(α1, . . .",
    ", αi−1).",
    "Since\nF(α1, . . .",
    ", αi) = F(α1, . . .",
    ", αi−1)(αi)\nis simple extension and αi is algebraic over F(α1, . . .",
    ", αi−1), it follows that\n[F(α1, . . .",
    ", αi) : F(α1, . . .",
    ", αi−1)]\nis finite for each i.",
    "Therefore, [E : F] is finite.\n",
    "■\nAlgebraic Closure\nGiven a field F, the question arises as to whether or not we can find a field E such that\nevery polynomial p(x) has a root in E.",
    "This leads us to the following theorem.\n",
    "Theorem 21.23 Let E be an extension field of F.\n",
    "The set of elements in E that are\nalgebraic over F form a field.\nProof.",
    "Let α, β ∈E be algebraic over F. Then F(α, β) is a finite extension of F. Since\nevery element of F(α, β) is algebraic over F, α ± β, αβ, and α/β (β ̸= 0) are all algebraic\nover F. Consequently, the set of elements in E that are algebraic over F form a field.\n",
    "■\nCorollary 21.24 The set of all algebraic numbers forms a field; that is, the set of all\ncomplex numbers that are algebraic over Q makes up a field.\n",
    "Let E be a field extension of a field F. We define the algebraic closure of a field F in\nE to be the field consisting of all elements in E that are algebraic over F. A field F is\nalgebraically closed if every nonconstant polynomial in F[x] has a root in F.\nTheorem 21.25",
    "A field F is algebraically closed if and only if every nonconstant polynomial\nin F[x] factors into linear factors over F[x].\n",
    "Proof.",
    "Let F be an algebraically closed field.",
    "If p(x) ∈F[x] is a nonconstant polynomial,\nthen p(x) has a zero in F, say α.\n",
    "Therefore, x −α must be a factor of p(x) and so\np(x) = (x −α)q1(x), where deg q1(x) = deg p(x) −1.",
    "Continue this process with q1(x) to\nfind a factorization\np(x)",
    "= (x −α)(x −β)q2(x),\nwhere deg q2(x) = deg p(x) −2.",
    "The process must eventually stop since the degree of p(x)\nis finite.\n",
    "Conversely, suppose that every nonconstant polynomial p(x) in F[x] factors into linear\nfactors.",
    "Let ax −b be such a factor.",
    "Then p(b/a) = 0.",
    "Consequently, F is algebraically\nclosed.\n",
    "■\nCorollary 21.26 An algebraically closed field F has no proper algebraic extension E.\n\nCHAPTER 21.",
    "FIELDS\n268\nProof.\n",
    "Let E be an algebraic extension of F; then F ⊂E. For α ∈E, the minimal\npolynomial of α is x −α.",
    "Therefore, α ∈F and F = E.\n■\nTheorem 21.27 Every field F has a unique algebraic closure.\n",
    "It is a nontrivial fact that every field has a unique algebraic closure.",
    "The proof is not\nextremely diﬀicult, but requires some rather sophisticated set theory.",
    "We refer the reader\nto [3], [4], or [8] for a proof of this result.\n",
    "We now state the Fundamental Theorem of Algebra, first proven by Gauss at the age\nof 22 in his doctoral thesis.",
    "This theorem states that every polynomial with coeﬀicients in\nthe complex numbers has a root in the complex numbers.",
    "The proof of this theorem will\nbe given in Chapter 23.\n",
    "Theorem 21.28 Fundamental Theorem of Algebra.",
    "The field of complex numbers is\nalgebraically closed.\n",
    "21.2 Splitting Fields\nLet F be a field and p(x) be a nonconstant polynomial in F[x].",
    "We already know that we\ncan find a field extension of F that contains a root of p(x).",
    "However, we would like to know\nwhether an extension E of F containing all of the roots of p(x) exists.",
    "In other words, can\nwe find a field extension of F such that p(x) factors into a product of linear polynomials?\n",
    "What is the “smallest” extension containing all the roots of p(x)?\n",
    "Let F be a field and p(x)",
    "= a0 + a1x",
    "+ · ·",
    "· + anxn be a nonconstant polynomial in F[x].\n",
    "An extension field E of F is a splitting field of p(x) if there exist elements α1, . .",
    ".",
    ", αn in E\nsuch that E = F(α1, . . .",
    ", αn) and\np(x)",
    "= (x −α1)(x −α2) · · · (x −αn).\n",
    "A polynomial p(x) ∈F[x] splits in E if it is the product of linear factors in E[x].\n",
    "Example 21.29 Let p(x) = x4 + 2x2 −8 be in Q[x].",
    "Then p(x) has irreducible factors\nx2 −2 and x2 + 4.",
    "Therefore, the field Q(\n√\n2, i) is a splitting field for p(x).\n",
    "□\nExample 21.30 Let p(x) =",
    "x3 −3 be in Q[x].",
    "Then p(x) has a root in the field Q(\n3√\n3 ).\n",
    "However, this field is not a splitting field for p(x) since the complex cube roots of 3,\n−\n3√\n3 ± (\n6√\n3 )5i\n2\n,\nare not in Q(\n3√\n3 ).\n",
    "□\nTheorem 21.31 Let p(x) ∈F[x] be a nonconstant polynomial.",
    "Then there exists a splitting\nfield E for p(x).\n",
    "Proof.",
    "We will use mathematical induction on the degree of p(x).",
    "If deg p(x) = 1, then\np(x) is a linear polynomial and E = F. Assume that the theorem is true for all polynomials\nof degree k with 1 ≤k < n and let deg p(x)",
    "= n.",
    "We can assume that p(x) is irreducible;\notherwise, by our induction hypothesis, we are done.",
    "By Theorem 21.5, there exists a field\nK such that p(x) has a zero α1 in K. Hence, p(x)",
    "= (x −α1)q(x), where q(x) ∈K[x].\n",
    "Since deg q(x) = n −1, there exists a splitting field E ⊃K of q(x) that contains the zeros\nα2, . .",
    ". , αn of p(x) by our induction hypothesis.",
    "Consequently,\nE = K(α2, . . .",
    ", αn) = F(α1, . . .",
    ", αn)\nis a splitting field of p(x).\n",
    "■\n\nCHAPTER 21.",
    "FIELDS\n269\nThe question of uniqueness now arises for splitting fields.",
    "This question is answered in\nthe aﬀirmative.",
    "Given two splitting fields K and L of a polynomial p(x) ∈F[x], there exists\na field isomorphism ϕ : K",
    "→L that preserves F.",
    "In order to prove this result, we must first\nprove a lemma.\n",
    "Lemma 21.32 Let ϕ : E →F be an isomorphism of fields.",
    "Let K be an extension field\nof E and α ∈K be algebraic over E with minimal polynomial p(x).\n",
    "Suppose that L is\nan extension field of F such that β is root of the polynomial in F[x] obtained from p(x)\nunder the image of ϕ. Then ϕ extends to a unique isomorphism ϕ : E(α) →F(β) such that\nϕ(α) = β and ϕ agrees with ϕ on E.\nProof.",
    "If p(x) has degree n, then by Theorem 21.13 we can write any element in E(α)\nas a linear combination of 1, α, . .",
    ".",
    ", αn−1.",
    "Therefore, the isomorphism that we are seeking\nmust be\nϕ(a0 +",
    "a1α + · · ·",
    "+ an−1αn−1) = ϕ(a0)",
    "+",
    "ϕ(a1)β + · · ·",
    "+ ϕ(an−1)βn−1,\nwhere\na0 + a1α + · · · + an−1αn−1\nis an element in E(α).\n",
    "The fact that ϕ is an isomorphism could be checked by direct\ncomputation; however, it is easier to observe that ϕ is a composition of maps that we\nalready know to be isomorphisms.\n",
    "We can extend ϕ to be an isomorphism from E[x] to F[x], which we will also denote by\nϕ, by letting\nϕ(a0 +",
    "a1x + · · · + anxn) = ϕ(a0)",
    "+",
    "ϕ(a1)x + · · · + ϕ(an)xn.\n",
    "This extension agrees with the original isomorphism ϕ : E →F, since constant polynomials\nget mapped to constant polynomials.",
    "By assumption, ϕ(p(x))",
    "= q(x); hence, ϕ maps ⟨p(x)⟩\nonto ⟨q(x)⟩.",
    "Consequently, we have an isomorphism ψ : E[x]/⟨p(x)⟩→F[x]/⟨q(x)⟩. By\nProposition 21.12, we have isomorphisms σ : E[x]/⟨p(x)⟩→E(α) and τ :",
    "F[x]/⟨q(x)⟩→\nF(β), defined by evaluation at α and β, respectively.",
    "Therefore, ϕ = τψσ−1 is the required\nisomorphism (see Figure 21.33).\n",
    "E[x]/⟨p(x)⟩\nψ\n−−−−→F[x]/⟨q(x)⟩\nyσ\nyτ\nE(α)\nϕ\n−−−−→\nF(β)\ny\ny\nE\nϕ\n−−−−→\nF\nFigure 21.33\n",
    "We leave the proof of uniqueness as a exercise.\n",
    "■\nTheorem 21.34 Let ϕ : E →F be an isomorphism of fields and let p(x) be a nonconstant\npolynomial in E[x] and q(x) the corresponding polynomial in F[x] under the isomorphism.\n",
    "If K is a splitting field of p(x) and L is a splitting field of q(x), then ϕ extends to an\nisomorphism ψ : K →L.\nProof.",
    "We will use mathematical induction on the degree of p(x).",
    "We can assume that\np(x) is irreducible over E. Therefore, q(x) is also irreducible over F. If deg p(x)",
    "= 1, then\nby the definition of a splitting field, K = E and L = F and there is nothing to prove.\n\n",
    "CHAPTER 21.",
    "FIELDS\n270\nAssume that the theorem holds for all polynomials of degree less than n. Since K is a\nsplitting field of p(x), all of the roots of p(x) are in K. Choose one of these roots, say α, such\nthat E ⊂E(α)",
    "⊂K. Similarly, we can find a root β of q(x) in L such that F ⊂F(β) ⊂L.\nBy Lemma 21.32, there exists an isomorphism ϕ : E(α) →F(β) such that ϕ(α) = β and ϕ\nagrees with ϕ on E (see Figure 21.35).\n",
    "K\nψ\n−−−−→\nL\nyσ\nyτ\nE(α)\nϕ\n−−−−→F(β)\ny\ny\nE\nϕ\n−−−−→\nF\nFigure 21.35\nNow write p(x)",
    "= (x −α)f(x) and q(x) = (x −β)g(x), where the degrees of f(x) and\ng(x) are less than the degrees of p(x) and q(x), respectively.",
    "The field extension K is a\nsplitting field for f(x) over E(α), and L is a splitting field for g(x) over F(β).",
    "By our\ninduction hypothesis there exists an isomorphism ψ : K →L such that ψ agrees with ϕ on\nE(α).",
    "Hence, there exists an isomorphism ψ : K →L such that ψ agrees with ϕ on E.\n■\nCorollary 21.36 Let p(x) be a polynomial in F[x].",
    "Then there exists a splitting field K of\np(x) that is unique up to isomorphism.\n",
    "21.3 Geometric Constructions\n",
    "In ancient Greece, three classic problems were posed.",
    "These problems are geometric in\nnature and involve straightedge-and-compass constructions from what is now high school\ngeometry; that is, we are allowed to use only a straightedge and compass to solve them.\n",
    "The problems can be stated as follows.\n",
    "1.",
    "Given an arbitrary angle, can one trisect the angle into three equal subangles using\nonly a straightedge and compass?\n2.",
    "Given an arbitrary circle, can one construct a square with the same area using only a\nstraightedge and compass?\n3.",
    "Given a cube, can one construct the edge of another cube having twice the volume of\nthe original?",
    "Again, we are only allowed to use a straightedge and compass to do the\nconstruction.\n",
    "After puzzling mathematicians for over two thousand years, each of these constructions was\nfinally shown to be impossible.",
    "We will use the theory of fields to provide a proof that the\nsolutions do not exist.",
    "It is quite remarkable that the long-sought solution to each of these\nthree geometric problems came from abstract algebra.\n",
    "First, let us determine more specifically what we mean by a straightedge and compass,\nand also examine the nature of these problems in a bit more depth.\n",
    "To begin with, a\nstraightedge is not a ruler.",
    "We cannot measure arbitrary lengths with a straightedge.",
    "It is\nmerely a tool for drawing a line through two points.",
    "The statement that the trisection of\nan arbitrary angle is impossible means that there is at least one angle that is impossible to\ntrisect with a straightedge-and-compass construction.",
    "Certainly it is possible to trisect an\nangle in special cases.",
    "We can construct a 30◦angle; hence, it is possible to trisect a 90◦\n\nCHAPTER 21.",
    "FIELDS\n271\nangle.",
    "However, we will show that it is impossible to construct a 20◦angle.",
    "Therefore, we\ncannot trisect a 60◦angle.\n",
    "Constructible Numbers\nA real number α is constructible if we can construct a line segment of length |α| in a finite\nnumber of steps from a segment of unit length by using a straightedge and compass.\n",
    "Theorem 21.37 The set of all constructible real numbers forms a subfield F of the field of\nreal numbers.\nProof.",
    "Let α and β be constructible numbers.",
    "We must show that α + β, α −β, αβ, and\nα/β (β ̸= 0) are also constructible numbers.",
    "We can assume that both α and β are positive\nwith α > β.",
    "It is quite obvious how to construct α + β and α −β.",
    "To find a line segment\nwith length αβ, we assume that β > 1 and construct the triangle in Figure 21.38 such that\ntriangles △ABC and △ADE are similar.",
    "Since α/1 = x/β, the line segment x has length\nαβ.",
    "A similar construction can be made if β < 1.",
    "We will leave it as an exercise to show\nthat the same triangle can be used to construct α/β for β ̸= 0.\n",
    "■\nA\nB\nC\nD\nE\n1\nα\nβ\nx\nFigure 21.38 Construction of products\nLemma 21.39 If α is a constructible number, then √α is a constructible number.\n",
    "Proof.\n",
    "In Figure 21.40 the triangles △ABD, △BCD, and △ABC are similar; hence,\n1/x = x/α, or x2 = α.\n",
    "■\n\nCHAPTER 21.",
    "FIELDS\n272\nA\nB\nC\nD\nα\n1\nx\nFigure 21.40 Construction of roots\n",
    "By Theorem 21.37, we can locate in the plane any point P = (p, q) that has rational\ncoordinates p and q.",
    "We need to know what other points can be constructed with a compass\nand straightedge from points with rational coordinates.\n",
    "Lemma 21.41 Let F be a subfield of R.\n1.",
    "If a line contains two points in F, then it has the equation ax +",
    "by + c = 0, where a,\nb, and c are in F.\n2.",
    "If a circle has a center at a point with coordinates in F and a radius that is also in F,\nthen it has the equation x2 + y2 + dx",
    "+",
    "ey + f = 0, where d, e, and f are in F.\nProof.",
    "Let (x1, y1) and (x2, y2) be points on a line whose coordinates are in F. If x1 = x2,\nthen the equation of the line through the two points is x −x1 = 0, which has the form\nax + by + c",
    "= 0.",
    "If x1 ̸= x2, then the equation of the line through the two points is given by\ny −y1 =\n\u0012 y2 −y1\nx2 −x1\n\u0013\n(x −x1),\nwhich can also be put into the proper form.\n",
    "To prove the second part of the lemma, suppose that (x1, y1) is the center of a circle of\nradius r. Then the circle has the equation\n(x −x1)2",
    "+ (y −y1)2 −r2 = 0.\n",
    "This equation can easily be put into the appropriate form.\n",
    "■\nStarting with a field of constructible numbers F, we have three possible ways of con-\nstructing additional points in R with a compass and straightedge.\n",
    "1.",
    "To find possible new points in R, we can take the intersection of two lines, each of\nwhich passes through two known points with coordinates in F.\n2.",
    "The intersection of a line that passes through two points that have coordinates in F\nand a circle whose center has coordinates in F with radius of a length in F will give\nnew points in R.\n3.",
    "We can obtain new points in R by intersecting two circles whose centers have coordi-\nnates in F and whose radii are of lengths in F.\n\nCHAPTER 21.",
    "FIELDS\n273\nThe first case gives no new points in R, since the solution of two equations of the form\nax + by + c = 0 having coeﬀicients in F will always be in F.",
    "The third case can be reduced\nto the second case.",
    "Let\nx2 + y2",
    "+ d1x + e1y + f1 = 0\nx2 + y2 +",
    "d2x + e2y + f2 = 0\nbe the equations of two circles, where di, ei, and fi are in F for i = 1, 2.",
    "These circles have\nthe same intersection as the circle\nx2 + y2 +",
    "d1x",
    "+ e1x + f1 = 0\nand the line\n(d1 −d2)x + b(e2 −e1)y + (f2 −f1) = 0.\n",
    "The last equation is that of the chord passing through the intersection points of the two\ncircles.",
    "Hence, the intersection of two circles can be reduced to the case of an intersection\nof a line with a circle.\n",
    "Considering the case of the intersection of a line and a circle, we must determine the\nnature of the solutions of the equations\nax",
    "+ by + c = 0\nx2 + y2 + dx",
    "+",
    "ey + f",
    "= 0.\n",
    "If we eliminate y from these equations, we obtain an equation of the form Ax2+Bx+C = 0,\nwhere A, B, and C are in F. The x coordinate of the intersection points is given by\nx = −B ±\n√\nB2 −4AC\n2A\nand is in F(√α ), where α = B2 −4AC > 0.",
    "We have proven the following lemma.\n",
    "Lemma 21.42 Let F be a field of constructible numbers.",
    "Then the points determined by\nthe intersections of lines and circles in F lie in the field F(√α )",
    "for some α in F.\nTheorem 21.43 A real number α is a constructible number if and only if there exists a\nsequence of fields\nQ = F0 ⊂F1 ⊂· · · ⊂Fk\nsuch that Fi = Fi−1(√αi ) with αi ∈Fi and α ∈Fk.",
    "In particular, there exists an integer\nk > 0 such that [Q(α) : Q] = 2k.\n",
    "Proof.",
    "The existence of the Fi’s and the αi’s is a direct consequence of Lemma 21.42 and\nof the fact that\n[Fk : Q] =",
    "[Fk : Fk−1][Fk−1 : Fk−2] · · ·",
    "[F1 : Q] = 2k.\n",
    "■\nCorollary 21.44 The field of all constructible numbers is an algebraic extension of Q.\nAs we can see by the field of constructible numbers, not every algebraic extension of a\nfield is a finite extension.\nDoubling the Cube and Squaring the Circle\n",
    "We are now ready to investigate the classical problems of doubling the cube and squaring\nthe circle.",
    "We can use the field of constructible numbers to show exactly when a particular\ngeometric construction can be accomplished.\n\n",
    "CHAPTER 21.",
    "FIELDS\n274\nDoubling the cube is impossible.\n",
    "Given the edge of the cube, it is impossible to\nconstruct with a straightedge and compass the edge of the cube that has twice the volume\nof the original cube.",
    "Let the original cube have an edge of length 1 and, therefore, a volume\nof 1.",
    "If we could construct a cube having a volume of 2, then this new cube would have\nan edge of length\n3√\n2.",
    "However,\n3√\n2 is a zero of the irreducible polynomial x3 −2 over Q;\nhence,\n[Q(\n3√\n2 ) : Q] = 3\nThis is impossible, since 3 is not a power of 2.\nSquaring the circle.\n",
    "Suppose that we have a circle of radius 1.",
    "The area of the circle\nis π; therefore, we must be able to construct a square with side √π.",
    "This is impossible\nsince π and consequently √π are both transcendental.",
    "Therefore, using a straightedge and\ncompass, it is not possible to construct a square with the same area as the circle.\n",
    "Trisecting an Angle\nTrisecting an arbitrary angle is impossible.",
    "We will show that it is impossible to construct\na 20◦angle.",
    "Consequently, a 60◦angle cannot be trisected.",
    "We first need to calculate the\ntriple-angle formula for the cosine:\ncos 3θ = cos(2θ + θ)\n= cos 2θ cos",
    "θ −sin 2θ sin θ\n= (2 cos2 θ −1) cos θ −2 sin2 θ cos θ\n= (2 cos2 θ −1) cos θ −2(1 −cos2 θ) cos θ\n= 4 cos3 θ −3 cos θ.\n",
    "The angle θ can be constructed if and only if α = cos θ is constructible.",
    "Let θ = 20◦.",
    "Then\ncos 3θ = cos 60◦= 1/2.",
    "By the triple-angle formula for the cosine,\n4α3 −3α",
    "= 1\n2.\n",
    "Therefore, α is a zero of 8x3 −6x −1.",
    "This polynomial has no factors in Z[x], and hence\nis irreducible over Q[x].",
    "Thus, [Q(α) : Q] = 3.",
    "Consequently, α cannot be a constructible\nnumber.\n",
    "Sage.\n",
    "Extensions of the field of rational numbers are a central object of study in number\ntheory, so with Sage’s roots in this discipline, it is no surprise that there is extensive support\nfor fields and for extensions of the rationals.",
    "Sage also contains an implementation of the\nentire field of algebraic numbers, with exact representations.\n",
    "Historical Note\nAlgebraic number theory uses the tools of algebra to solve problems in number theory.\n",
    "Modern algebraic number theory began with Pierre de Fermat (1601–1665).",
    "Certainly we\ncan find many positive integers that satisfy the equation x2 + y2 = z2; Fermat conjectured\nthat the equation xn",
    "+ yn",
    "= zn has no positive integer solutions for n ≥3.",
    "He stated in the\nmargin of his copy of the Latin translation of Diophantus’ Arithmetica that he had found a\nmarvelous proof of this theorem, but that the margin of the book was too narrow to contain\nit.",
    "Building on work of other mathematicians, it was Andrew Wiles who finally succeeded\nin proving Fermat’s Last Theorem in the 1990s.",
    "Wiles’s achievement was reported on the\nfront page of the New York Times.\n\n",
    "CHAPTER 21.",
    "FIELDS\n275\nAttempts to prove Fermat’s Last Theorem have led to important contributions to algebraic\nnumber theory by such notable mathematicians as Leonhard Euler (1707–1783).",
    "Significant\nadvances in the understanding of Fermat’s Last Theorem were made by Ernst Kummer\n(1810–1893).",
    "Kummer’s student, Leopold Kronecker (1823–1891), became one of the leading\nalgebraists of the nineteenth century.",
    "Kronecker’s theory of ideals and his study of algebraic\nnumber theory added much to the understanding of fields.\n",
    "David Hilbert (1862–1943) and Hermann Minkowski (1864–1909) were among the mathe-\nmaticians who led the way in this subject at the beginning of the twentieth century.",
    "Hilbert\nand Minkowski were both mathematicians at Göttingen University in Germany.",
    "Göttingen\nwas truly one the most important centers of mathematical research during the last two cen-\nturies.",
    "The large number of exceptional mathematicians who studied there included Gauss,\nDirichlet, Riemann, Dedekind, Noether, and Weyl.\n",
    "André Weil answered questions in number theory using algebraic geometry, a field of math-\nematics that studies geometry by studying commutative rings.",
    "From about 1955 to 1970,\nAlexander Grothendieck dominated the field of algebraic geometry.",
    "Pierre Deligne, a stu-\ndent of Grothendieck, solved several of Weil’s number-theoretic conjectures.",
    "One of the\nmost recent contributions to algebra and number theory is Gerd Falting’s proof of the\nMordell-Weil conjecture.",
    "This conjecture of Mordell and Weil essentially says that certain\npolynomials p(x, y) in Z[x, y] have only a finite number of integral solutions.\n",
    "21.4 Reading Questions\n1.\n",
    "What does it mean for an extension field E of a field F to be a simple extension of F?\n2.\n",
    "What is the definition of a minimal polynomial of an element α ∈E, where E is an\nextension of F, and α is algebraic over F?\n3.\n",
    "Describe how linear algebra enters into this chapter.",
    "What critical result relies on a\nproof that is almost entirely linear algebra?\n4.\n",
    "What is the definition of an algebraically closed field?\n5.\n",
    "What is a splitting field of a polynomial p(x) ∈F[x]?\n",
    "21.5 Exercises\n1.\nShow that each of the following numbers is algebraic over Q by finding the minimal\npolynomial of the number over Q.\n(a)\nq\n1/3 +\n√\n7\n(b)\n√\n3 +\n3√\n5\n(c)\n√\n3 +\n√\n2 i\n(d) cos θ",
    "+ i sin θ for θ = 2π/n with n ∈N\n(e)\nq\n3√\n2 −i\n2.\nFind a basis for each of the following field extensions.",
    "What is the degree of each\nextension?\n(a) Q(\n√\n3,\n√\n6 ) over Q\n(b) Q(\n3√\n2,\n3√\n3 ) over Q\n\nCHAPTER 21.",
    "FIELDS\n276\n(c) Q(\n√\n2, i) over Q\n(d) Q(\n√\n3,\n√\n5,\n√\n7 ) over Q\n(e) Q(\n√\n2,\n3√\n2 ) over Q\n(f) Q(\n√\n8 ) over Q(\n√\n2 )\n(g) Q(i,\n√\n2 + i,\n√\n3 + i) over Q\n(h) Q(\n√\n2 +\n√\n5 ) over Q(\n√\n5 )\n(i) Q(\n√\n2,\n√\n6 +\n√\n10 ) over Q(\n√\n3 +\n√\n5 )\n3.\nFind the splitting field for each of the following polynomials.\n",
    "(a) x4 −10x2",
    "+ 21 over Q\n(b) x4",
    "+ 1 over Q\n(c) x3 + 2x +",
    "2 over Z3\n(d) x3 −3 over Q\n4.\nConsider the field extension Q(\n4√\n3, i) over Q.\n(a) Find a basis for the field extension Q(\n4√\n3, i) over Q. Conclude that [Q(\n4√\n3, i) :\nQ] = 8.\n(b) Find all subfields F of Q(\n4√\n3, i) such that",
    "[F : Q] = 2.\n(c) Find all subfields F of Q(\n4√\n3, i) such that [F : Q] = 4.\n5.\nShow that Z2[x]/⟨x3",
    "+ x + 1⟩is a field with eight elements.",
    "Construct a multiplication\ntable for the multiplicative group of the field.\n",
    "6.\nShow that the regular 9-gon is not constructible with a straightedge and compass, but\nthat the regular 20-gon is constructible.\n",
    "7.\nProve that the cosine of one degree (cos 1◦) is algebraic over Q but not constructible.\n8.\nCan a cube be constructed with three times the volume of a given cube?\n9.\nProve that Q(\n√\n3,\n4√\n3,\n8√\n3, . . .)",
    "is an algebraic extension of Q but not a finite extension.\n",
    "10. Prove or disprove: π is algebraic over Q(π3).\n",
    "11.",
    "Let p(x) be a nonconstant polynomial of degree n in F[x].",
    "Prove that there exists a\nsplitting field E for p(x) such that [E : F] ≤n!.\n",
    "12. Prove or disprove: Q(\n√\n2 ) ∼= Q(\n√\n3 ).\n",
    "13.",
    "Prove that the fields Q(\n4√\n3 ) and Q(\n4√\n3 i) are isomorphic but not equal.\n14.",
    "Let K be an algebraic extension of E, and E an algebraic extension of F. Prove that\nK is algebraic over F.",
    "[Caution: Do not assume that the extensions are finite.]\n15.",
    "Prove or disprove: Z[x]/⟨x3 −2⟩is a field.\n",
    "16.",
    "Let F be a field of characteristic p.",
    "Prove that p(x)",
    "= xp −a either is irreducible over\nF or splits in F.\n17.",
    "Let E be the algebraic closure of a field F. Prove that every polynomial p(x) in F[x]\nsplits in E.\n18.",
    "If every irreducible polynomial p(x) in F[x] is linear, show that F is an algebraically\nclosed field.\n",
    "19.",
    "Prove that if α and β are constructible numbers such that β ̸= 0, then so is α/β.\n20.",
    "Show that the set of all elements in R that are algebraic over Q form a field extension\nof Q that is not finite.\n\n",
    "CHAPTER 21.",
    "FIELDS\n277\n21.",
    "Let E be an algebraic extension of a field F, and let σ be an automorphism of E leaving\nF fixed.",
    "Let α ∈E. Show that σ induces a permutation of the set of all zeros of the\nminimal polynomial of α that are in E.\n22.",
    "Show that Q(\n√\n3,\n√\n7 ) = Q(\n√\n3 +\n√\n7 ).",
    "Extend your proof to show that Q(√a,\n√\nb ) =\nQ(√a",
    "+\n√\nb ), where a ̸= b and neither a nor b is a perfect square.\n",
    "23.",
    "Let E be a finite extension of a field F.",
    "If [E : F] = 2, show that E is a splitting field\nof F for some polynomial f(x) ∈F[x].\n24.",
    "Prove or disprove: Given a polynomial p(x) in Z6[x], it is possible to construct a ring\nR such that p(x) has a root in R.\n25.",
    "Let E be a field extension of F and α ∈E. Determine",
    "[F(α) : F(α3)].\n",
    "26.",
    "Let α, β be transcendental over Q. Prove that either αβ or α+β is also transcendental.\n",
    "27.",
    "Let E be an extension field of F and α ∈E be transcendental over F. Prove that\nevery element in F(α) that is not in F is also transcendental over F.\n28.",
    "Let α be a root of an irreducible monic polynomial p(x) ∈F[x], with deg p = n. Prove\nthat [F(α) : F] = n.\n21.6 References and Suggested Readings\n[1]\nDean, R. A. Elements of Abstract Algebra .",
    "Wiley, New York, 1966.\n",
    "[2]\nDudley, U. A Budget of Trisections.",
    "Springer-Verlag, New York, 1987.",
    "An interesting\nand entertaining account of how not to trisect an angle.\n",
    "[3]\nFraleigh, J. B. A First Course in Abstract Algebra.",
    "7th ed.",
    "Pearson, Upper Saddle\nRiver, NJ, 2003.\n",
    "[4]\nKaplansky, I. Fields and Rings, 2nd ed.",
    "University of Chicago Press, Chicago, 1972.\n",
    "[5]\nKlein, F. Famous Problems of Elementary Geometry.",
    "Chelsea, New York, 1955.\n",
    "[6]\nMartin, G. Geometric Constructions.",
    "Springer, New York, 1998.\n",
    "[7]\nH. Pollard and H. G. Diamond.",
    "Theory of Algebraic Numbers, Dover, Mineola, NY,\n2010.\n",
    "[8]\nWalker, E. A. Introduction to Abstract Algebra.\n",
    "Random House, New York, 1987.\n",
    "This work contains a proof showing that every field has an algebraic closure.\n\n",
    "22\nFinite Fields\nFinite fields appear in many applications of algebra, including coding theory and cryptog-\nraphy.",
    "We already know one finite field, Zp, where p is prime.",
    "In this chapter we will show\nthat a unique finite field of order pn exists for every prime p, where n is a positive integer.\n",
    "Finite fields are also called Galois fields in honor of Évariste Galois, who was one of the first\nmathematicians to investigate them.\n",
    "22.1 Structure of a Finite Field\nRecall that a field F has characteristic p if p is the smallest positive integer such that for\nevery nonzero element α in F, we have pα = 0.\n",
    "If no such integer exists, then F has\ncharacteristic 0.",
    "From Theorem 16.19 we know that p must be prime.",
    "Suppose that F is a\nfinite field with n elements.",
    "Then nα = 0 for all α in F. Consequently, the characteristic of\nF must be p, where p is a prime dividing n.",
    "This discussion is summarized in the following\nproposition.\n",
    "Proposition 22.1",
    "If F is a finite field, then the characteristic of F is p, where p is prime.\n",
    "Throughout this chapter we will assume that p is a prime number unless otherwise\nstated.\n",
    "Proposition 22.2",
    "If F is a finite field of characteristic p, then the order of F is pn for\nsome n ∈N.\nProof.",
    "Let ϕ : Z →F be the ring homomorphism defined by ϕ(n) =",
    "n ·",
    "1.",
    "Since the\ncharacteristic of F is p, the kernel of ϕ must be pZ and the image of ϕ must be a subfield\nof F isomorphic to Zp.",
    "We will denote this subfield by K. Since F is a finite field, it\nmust be a finite extension of K and, therefore, an algebraic extension of K. Suppose that\n[F : K] = n is the dimension of F, where F is a K vector space.",
    "There must exist elements\nα1, . . .",
    ", αn ∈F such that any element α in F can be written uniquely in the form\nα = a1α1 + · · · + anαn,\nwhere the ai’s are in K.\nSince there are p elements in K, there are pn possible linear\ncombinations of the αi’s.",
    "Therefore, the order of F must be pn.\n■\nLemma 22.3\nFreshman’s Dream.\n",
    "Let p be prime and D be an integral domain of\ncharacteristic p.",
    "Then\napn + bpn = (a + b)pn\nfor all positive integers n.\n278\n\nCHAPTER 22.",
    "FINITE FIELDS\n279\nProof.",
    "We will prove this lemma using mathematical induction on n.",
    "We can use the\nbinomial formula (see Chapter 2, Example 2.4) to verify the case for n = 1; that is,\n(a + b)p =\np\nX\nk=0\n\u0012p\nk\n\u0013\nakbp−k.\n",
    "If 0 < k < p, then\n\u0012p\nk\n\u0013\n=\np!\nk!(p −k)!\nmust be divisible by p, since p cannot divide k!(p −k)!.",
    "Note that D is an integral domain\nof characteristic p, so all but the first and last terms in the sum must be zero.",
    "Therefore,\n(a + b)p = ap + bp.\nNow suppose that the result holds for all k, where 1 ≤k ≤n.\n",
    "By the induction\nhypothesis,\n(a + b)pn+1 = ((a + b)p)pn = (ap + bp)pn = (ap)pn + (bp)pn = apn+1 + bpn+1.\n",
    "Therefore, the lemma is true for n + 1 and the proof is complete.\n",
    "■\nLet F be a field.",
    "A polynomial f(x) ∈F[x] of degree n is separable if it has n distinct\nroots in the splitting field of f(x); that is, f(x) is separable when it factors into distinct\nlinear factors over the splitting field of f.",
    "An extension E of F is a separable extension of\nF if every element in E is the root of a separable polynomial in F[x].\n",
    "Example 22.4",
    "The polynomial x2−2 is separable over Q since it factors as (x−\n√\n2 )(x+\n√\n2 ).\n",
    "In fact, Q(\n√\n2 ) is a separable extension of Q. Let α = a + b\n√\n2 be any element in Q(\n√\n2 ).\n",
    "If b = 0, then α is a root of x −a.",
    "If b ̸= 0, then α is the root of the separable polynomial\nx2 −2ax + a2 −2b2 = (x −(a + b\n√\n2 ))",
    "(x −(a −b\n√\n2 )).\n",
    "□\nFortunately, we have an easy test to determine the separability of any polynomial.",
    "Let\nf(x)",
    "= a0 + a1x",
    "+ · ·",
    "· + anxn\nbe any polynomial in F[x].",
    "Define the derivative of f(x) to be\nf′(x) = a1 + 2a2x + · · ·",
    "+ nanxn−1.\n",
    "Lemma 22.5 Let F be a field and f(x) ∈F[x].",
    "Then f(x) is separable if and only if f(x)\nand f′(x) are relatively prime.\n",
    "Proof.\n",
    "Let f(x) be separable.\n",
    "Then f(x) factors over some extension field of F as\nf(x)",
    "= (x −α1)(x −α2) · · · (x −αn), where αi ̸= αj for i ̸= j.",
    "Taking the derivative of f(x),\nwe see that\nf′(x) = (x −α2) · · · (x −αn)\n",
    "+ (x −α1)(x −α3) · · · (x −αn)\n+ · · · + (x −α1) · · · (x −αn−1).\n",
    "Hence, f(x) and f′(x) can have no common factors.\n",
    "To prove the converse, we will show that the contrapositive of the statement is true.\n",
    "Suppose that f(x) =",
    "(x −α)kg(x), where k > 1.",
    "Differentiating, we have\nf′(x) = k(x −α)k−1g(x)",
    "+ (",
    "x −α)kg′(x).\n",
    "Therefore, f(x) and f′(x) have a common factor.\n",
    "■\n\nCHAPTER 22.",
    "FINITE FIELDS\n280\nTheorem 22.6",
    "For every prime p and every positive integer n, there exists a finite field F\nwith pn elements.",
    "Furthermore, any field of order pn is isomorphic to the splitting field of\nxpn −x over Zp.\nProof.",
    "Let f(x)",
    "= xpn −x and let F be the splitting field of f(x).",
    "Then by Lemma 22.5,\nf(x) has pn distinct zeros in F, since f′(x) = pnxpn−1 −1 = −1 is relatively prime to\nf(x).",
    "We claim that the roots of f(x) form a subfield of F. Certainly 0 and 1 are zeros\nof f(x).",
    "If α and β are zeros of f(x), then α + β and αβ are also zeros of f(x), since\nαpn +βpn = (α+β)pn and αpnβpn = (αβ)pn.",
    "We also need to show that the additive inverse\nand the multiplicative inverse of each root of f(x) are roots of f(x).",
    "For any zero α of f(x),\nwe know that −α is also a zero of f(x), since\nf(−α) = (−α)pn −(−α) = −αpn",
    "+ α = −(αpn −α)",
    "= 0,\nprovided p is odd.",
    "If p = 2, then\nf(−α) = (−α)2n −(−α)",
    "= α + α = 0.\n",
    "If α ̸= 0, then (α−1)pn = (αpn)−1 = α−1.",
    "Since the zeros of f(x) form a subfield of F and\nf(x) splits in this subfield, the subfield must be all of F.\nLet E be any other field of order pn.",
    "To show that E is isomorphic to F, we must show\nthat every element in E is a root of f(x).",
    "Certainly 0 is a root of f(x).",
    "Let α be a nonzero\nelement of E. The order of the multiplicative group of nonzero elements of E is pn −1;\nhence, αpn−1 = 1 or αpn −α = 0.",
    "Since E contains pn elements, E must be a splitting field\nof f(x); however, by Corollary 21.36, the splitting field of any polynomial is unique up to\nisomorphism.\n",
    "■\nThe unique finite field with pn elements is called the Galois field of order pn.",
    "We will\ndenote this field by GF(pn).\n",
    "Theorem 22.7",
    "Every subfield of the Galois field GF(pn) has pm elements, where m divides\nn. Conversely, if m | n for m > 0, then there exists a unique subfield of GF(pn) isomorphic\nto GF(pm).\n",
    "Proof.",
    "Let F be a subfield of E = GF(pn).",
    "Then F must be a field extension of K that\ncontains pm elements, where K is isomorphic to Zp.",
    "Then m | n, since [E :",
    "K] =",
    "[E : F][F :\nK].\n",
    "To prove the converse, suppose that m | n for some m > 0.",
    "Then pm −1 divides pn −1.\n",
    "Consequently, xpm−1 −1 divides xpn−1 −1.",
    "Therefore, xpm −x must divide xpn −x, and\nevery zero of xpm −x is also a zero of xpn −x.",
    "Thus, GF(pn) contains, as a subfield, a\nsplitting field of xpm −x, which must be isomorphic to GF(pm).\n",
    "■\nExample 22.8 The lattice of subfields of GF(p24) is given in Figure 22.9.\n□\n\nCHAPTER 22.",
    "FINITE FIELDS\n281\nGF(p24)\nGF(p8)\nGF(p12)\nGF(p4)\nGF(p6)\nGF(p2)\nGF(p3)\nGF(p)\nFigure 22.9 Subfields of GF(p24)\n",
    "With each field F we have a multiplicative group of nonzero elements of F which we\nwill denote by F ∗.",
    "The multiplicative group of any finite field is cyclic.",
    "This result follows\nfrom the more general result that we will prove in the next theorem.\n",
    "Theorem 22.10 If G is a finite subgroup of F ∗, the multiplicative group of nonzero elements\nof a field F, then G is cyclic.\n",
    "Proof.",
    "Let G be a finite subgroup of F ∗of order n. By the Fundamental Theorem of\nFinite Abelian Groups (Theorem 13.4),\nG ∼= Zpe1\n1 × · · · ×",
    "Zp\nek\nk ,\nwhere n = pe1\n1 · · · pek\nk and the p1, . .",
    ".",
    ", pk are (not necessarily distinct) primes.",
    "Let m be the\nleast common multiple of pe1\n1 , . . .",
    ", pek\nk .",
    "Then G contains an element of order m. Since every\nα in G satisfies xr −1 for some r dividing m, α must also be a root of xm −1.",
    "Since xm −1\nhas at most m roots in F, n ≤m.",
    "On the other hand, we know that m ≤|G|; therefore,\nm = n.",
    "Thus, G contains an element of order n and must be cyclic.\n",
    "■\nCorollary 22.11 The multiplicative group of all nonzero elements of a finite field is cyclic.\n",
    "Corollary 22.12 Every finite extension E of a finite field F is a simple extension of F.\nProof.\n",
    "Let α be a generator for the cyclic group E∗of nonzero elements of E. Then\nE = F(α).\n",
    "■\nExample 22.13 The finite field GF(24) is isomorphic to the field Z2/⟨1+x+x4⟩.",
    "Therefore,\nthe elements of GF(24) can be taken to be\n{a0 + a1α + a2α2",
    "+ a3α3 : ai ∈Z2 and 1 + α + α4 = 0}.\n",
    "Remembering that 1",
    "+ α + α4 = 0, we add and multiply elements of GF(24) exactly as we\nadd and multiply polynomials.",
    "The multiplicative group of GF(24) is isomorphic to Z15\nwith generator α:\nα1 = α\nα6 = α2 + α3\nα11 = α + α2 + α3\nα2 = α2\nα7 = 1 + α + α3\nα12 = 1",
    "+ α + α2 + α3\nα3 = α3\nα8 = 1 + α2\nα13 = 1 + α2 + α3\n\nCHAPTER 22.",
    "FINITE FIELDS\n282\nα4 = 1 + α\nα9 = α + α3\nα14 = 1 + α3\nα5 = α + α2\nα10 = 1 +",
    "α + α2\nα15 = 1.\n□\n22.2 Polynomial Codes\nWith knowledge of polynomial rings and finite fields, it is now possible to derive more\nsophisticated codes than those of Chapter 8.",
    "First let us recall that an (n, k)-block code\nconsists of a one-to-one encoding function E : Zk\n2 →Zn\n2 and a decoding function D :",
    "Zn\n2 →\nZk\n2.",
    "The code is error-correcting if D is onto.",
    "A code is a linear code if it is the null space\nof a matrix H ∈Mk×n(Z2).\n",
    "We are interested in a class of codes known as cyclic codes.",
    "Let ϕ : Zk\n2 →Zn\n2 be a binary\n(n, k)-block code.",
    "Then ϕ is a cyclic code if for every codeword (a1, a2, . .",
    ". , an), the cyclically\nshifted n-tuple (an, a1, a2, . .",
    ". , an−1) is also a codeword.",
    "Cyclic codes are particularly easy\nto implement on a computer using shift registers [2, 3].\n",
    "Example 22.14 Consider the (6, 3)-linear codes generated by the two matrices\nG1 =\n\n\n\n\n\n\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n\n\n\n\n\n\n\nand\nG2 =\n\n\n\n\n\n\n\n\n\n1\n0\n0\n1\n1\n0\n1\n1\n1\n1\n1\n1\n0\n1\n1\n0\n0\n1\n\n\n\n\n\n\n\n\n\n.\n",
    "Messages in the first code are encoded as follows:\n(000)\n7→\n(000000)\n(100)\n7→\n(100100)\n(001)\n7→\n(001001)\n(101)\n7→\n(101101)\n(010)\n7→\n(010010)\n(110)\n7→\n(110110)\n(011)\n7→\n(011011)\n(111)\n7→\n(111111).\n",
    "It is easy to see that the codewords form a cyclic code.",
    "In the second code, 3-tuples are\nencoded in the following manner:\n(000)\n7→\n(000000)\n(100)\n7→\n(111100)\n(001)\n7→\n(001111)\n(101)\n7→\n(110011)\n(010)\n7→\n(011110)\n(110)\n7→\n(100010)\n(011)\n7→\n(010001)\n(111)\n7→\n(101101).\n",
    "This code cannot be cyclic, since (101101) is a codeword but (011011) is not a codeword.\n",
    "□\nPolynomial Codes\nWe would like to find an easy method of obtaining cyclic linear codes.",
    "To accomplish this, we\ncan use our knowledge of finite fields and polynomial rings over Z2.",
    "Any binary n-tuple can\nbe interpreted as a polynomial in Z2[x].",
    "Stated another way, the n-tuple (a0, a1, . .",
    ". , an−1)\ncorresponds to the polynomial\nf(x)",
    "= a0 + a1x",
    "+ · · · + an−1xn−1,\n\nCHAPTER 22.",
    "FINITE FIELDS\n283\nwhere the degree of f(x) is at most n −1.",
    "For example, the polynomial corresponding to\nthe 5-tuple (10011) is\n1 + 0x + 0x2 + 1x3 + 1x4 = 1 + x3 + x4.\n",
    "Conversely, with any polynomial f(x) ∈Z2[x] with deg f(x) <",
    "n we can associate a binary\nn-tuple.",
    "The polynomial x + x2 + x4 corresponds to the 5-tuple (01101).\n",
    "Let us fix a nonconstant polynomial g(x) in Z2[x] of degree n −k.",
    "We can define an\n(n, k)-code C in the following manner.",
    "If (a0, . . .",
    ", ak−1) is a k-tuple to be encoded, then\nf(x) =",
    "a0",
    "+",
    "a1x + · · · + ak−1xk−1 is the corresponding polynomial in Z2[x].",
    "To encode f(x),\nwe multiply by g(x).",
    "The codewords in C are all those polynomials in Z2[x] of degree less\nthan n that are divisible by g(x).",
    "Codes obtained in this manner are called polynomial\ncodes.\n",
    "Example 22.15 If we let g(x) = 1+x3, we can define a (6, 3)-code C as follows.",
    "To encode\na 3-tuple (a0, a1, a2), we multiply the corresponding polynomial f(x)",
    "= a0 +",
    "a1x",
    "+ a2x2 by\n1 + x3.",
    "We are defining a map ϕ : Z3\n2 →Z6\n2 by ϕ : f(x) 7→g(x)f(x).",
    "It is easy to check that\nthis map is a group homomorphism.",
    "In fact, if we regard Zn\n2 as a vector space over Z2, ϕ is\na linear transformation of vector spaces (see Exercise 20.5.15, Chapter 20).",
    "Let us compute\nthe kernel of ϕ. Observe that ϕ(a0, a1, a2) = (000000) exactly when\n0 + 0x + 0x2",
    "+ 0x3 + 0x4 + 0x5 = (1 + x3)(a0 +",
    "a1x",
    "+ a2x2)\n",
    "= a0 +",
    "a1x",
    "+ a2x2",
    "+ a0x3",
    "+ a1x4 + a2x5.\n",
    "Since the polynomials over a field form an integral domain, a0 +",
    "a1x",
    "+ a2x2 must be the\nzero polynomial.",
    "Therefore, ker ϕ = {(000)} and ϕ is one-to-one.\n",
    "To calculate a generator matrix for C, we merely need to examine the way the polyno-\nmials 1, x, and x2 are encoded:\n(1 + x3) ·",
    "1 = 1 + x3\n(1 + x3)x = x + x4\n(1 + x3)x2 = x2 + x5.\n",
    "We obtain the code corresponding to the generator matrix G1 in Example 22.14.\n",
    "The\nparity-check matrix for this code is\nH =\n\n\n1\n0\n0\n1\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n1\n0\n0\n1\n\n.\n",
    "Since the smallest weight of any nonzero codeword is 2, this code has the ability to detect\nall single errors.\n",
    "□\nRings of polynomials have a great deal of structure; therefore, our immediate goal\nis to establish a link between polynomial codes and ring theory.\n",
    "Recall that xn −1 =\n(x −1)(xn−1 + · · ·",
    "+ x + 1).",
    "The factor ring\nRn = Z2[x]/⟨xn −1⟩\ncan be considered to be the ring of polynomials of the form\nf(t)",
    "= a0 + a1t + · · ·",
    "+ an−1tn−1\n\nCHAPTER 22.",
    "FINITE FIELDS\n284\nthat satisfy the condition tn",
    "= 1.",
    "It is an easy exercise to show that Zn\n2 and Rn are isomor-\nphic as vector spaces.",
    "We will often identify elements in Zn\n2 with elements in Z[x]/⟨xn −1⟩.\nIn this manner we can interpret a linear code as a subset of Z[x]/⟨xn −1⟩.\nThe additional ring structure on polynomial codes is very powerful in describing cyclic\ncodes.\n",
    "A cyclic shift of an n-tuple can be described by polynomial multiplication.\n",
    "If\nf(t) = a0 + a1t + · · · + an−1tn−1 is a code polynomial in Rn, then\ntf(t) = an−1 + a0t + · · · + an−2tn−1\nis the cyclically shifted word obtained from multiplying f(t) by t.",
    "The following theorem\ngives a beautiful classification of cyclic codes in terms of the ideals of Rn.\n",
    "Theorem 22.16",
    "A linear code C in Zn\n2 is cyclic if and only if it is an ideal in Rn =\nZ[x]/⟨xn −1⟩.\nProof.",
    "Let C be a linear cyclic code and suppose that f(t) is in C. Then tf(t) must also\nbe in C. Consequently, tkf(t) is in C for all k ∈N.",
    "Since C is a linear code, any linear\ncombination of the codewords f(t), tf(t), t2f(t), . .",
    ".",
    ", tn−1f(t) is also a codeword; therefore,\nfor every polynomial p(t), p(t)f(t) is in C. Hence, C is an ideal.\n",
    "Conversely, let C be an ideal in Z2[x]/⟨xn + 1⟩. Suppose that f(t) = a0 + a1t + · · · +\nan−1tn−1 is a codeword in C. Then tf(t) is a codeword in C; that is, (a1, . . .",
    ", an−1, a0) is\nin C.\n■\nTheorem 22.16 tells us that knowing the ideals of Rn is equivalent to knowing the linear\ncyclic codes in Zn\n2.",
    "Fortunately, the ideals in Rn are easy to describe.",
    "The natural ring\nhomomorphism ϕ : Z2[x] →Rn defined by ϕ[f(x)] = f(t) is a surjective homomorphism.\n",
    "The kernel of ϕ is the ideal generated by xn −1.",
    "By Theorem 16.34, every ideal C in Rn is\nof the form ϕ(I), where I is an ideal in Z2[x] that contains ⟨xn −1⟩. By Theorem 17.20, we\nknow that every ideal I in Z2[x] is a principal ideal, since Z2 is a field.",
    "Therefore, I = ⟨g(x)⟩\nfor some unique monic polynomial in Z2[x].",
    "Since ⟨xn −1⟩is contained in I, it must be the\ncase that g(x) divides xn −1.",
    "Consequently, every ideal C in Rn is of the form\nC = ⟨g(t)⟩= {f(t)g(t) : f(t) ∈Rn and g(x) | (xn −1) in Z2[x]}.\n",
    "The unique monic polynomial of the smallest degree that generates C is called the minimal\ngenerator polynomial of C.\nExample 22.17",
    "If we factor x7 −1 into irreducible components, we have\nx7 −1 = (1 + x)(1",
    "+ x + x3)(1 + x2 + x3).\n",
    "We see that g(t) = (1 + t + t3) generates an ideal C in R7.",
    "This code is a (7, 4)-block code.\n",
    "As in Example 22.15, it is easy to calculate a generator matrix by examining what g(t) does\nto the polynomials 1, t, t2, and t3.",
    "A generator matrix for C is\nG =\n\n\n\n\n\n\n\n\n\n\n\n1\n0\n0\n0\n1\n1\n0\n0\n0\n1\n1\n0\n1\n0\n1\n1\n0\n1\n0\n1\n0\n0\n1\n0\n0\n0\n0\n1\n\n\n\n\n\n\n\n\n\n\n\n.\n",
    "□\n\nCHAPTER 22.",
    "FINITE FIELDS\n285\n",
    "In general, we can determine a generator matrix for an (n, k)-code C by the manner in\nwhich the elements tk are encoded.",
    "Let xn −1 = g(x)h(x) in Z2[x].",
    "If g(x) = g0 + g1x +\n· · · + gn−kxn−k and h(x) = h0 + h1x + · · · + hkxk, then the n × k matrix\nG =\n\n\n\n\n\n\n\n\n\n\n\n\n\ng0\n0\n· · ·\n0\ng1\ng0\n· · ·\n0\n...\n...\n...\n...\ngn−k\ngn−k−1\n· · ·\ng0\n0\ngn−k\n· · ·\ng1\n...\n...\n...\n...\n0\n0\n· · ·\ngn−k\n\n\n\n\n\n\n\n\n\n\n\n\n\nis a generator matrix for the code C with generator polynomial g(t).",
    "The parity-check\nmatrix for C is the (n −k)",
    "× n matrix\nH =\n\n\n\n\n\n0\n· · ·\n0\n0\nhk\n· · ·\nh0\n0\n· · ·\n0\nhk\n· · ·\nh0\n0\n· · ·\n· · ·\n· · ·\n· · ·\n· · ·\n· · ·\n· · ·\nhk\n· · ·\nh0\n0\n0\n· · ·\n0\n\n\n\n\n.\nWe will leave the details of the proof of the following proposition as an exercise.\n",
    "Proposition 22.18 Let C = ⟨g(t)⟩be a cyclic code in Rn and suppose that xn−1 = g(x)h(x).\n",
    "Then G and H are generator and parity-check matrices for C, respectively.",
    "Furthermore,\nHG = 0.\nExample 22.19 In Example 22.17,\nx7 −1 = g(x)h(x) = (1 + x + x3)(1 + x + x2 + x4).\n",
    "Therefore, a parity-check matrix for this code is\nH =\n\n\n0\n0\n1\n0\n1\n1\n1\n0\n1\n0\n1\n1\n1\n0\n1\n0\n1\n1\n1\n0\n0\n\n.\n□\nTo determine the error-detecting and error-correcting capabilities of a cyclic code, we\nneed to know something about determinants.",
    "If α1, . .",
    ".",
    ", αn are elements in a field F, then\nthe n × n matrix\n\n\n\n\n\n\n\n\n1\n1\n· · ·\n1\nα1\nα2\n· · ·\nαn\nα2\n1\nα2\n2\n· · ·\nα2\nn\n...\n...\n...\n...\nαn−1\n1\nαn−1\n2\n· · ·\nαn−1\nn\n\n\n\n\n\n\n\n\nis called the Vandermonde matrix.\n",
    "The determinant of this matrix is called the Van-\ndermonde determinant.\n",
    "We will need the following lemma in our investigation of cyclic\ncodes.\n\n",
    "CHAPTER 22.",
    "FINITE FIELDS\n286\nLemma 22.20 Let α1, . .",
    ".",
    ", αn be elements in a field F with n ≥2.",
    "Then\ndet\n\n\n\n\n\n\n\n\n1\n1\n· · ·\n1\nα1\nα2\n· · ·\nαn\nα2\n1\nα2\n2\n· · ·\nα2\nn\n...\n...\n...\n...\n",
    "αn−1\n1\nαn−1\n2\n· · ·\nαn−1\nn\n\n",
    "\n\n\n\n\n\n\n=\nY\n1≤j<i≤n\n(αi −αj).\n",
    "In particular, if the αi’s are distinct, then the determinant is nonzero.\n",
    "Proof.",
    "We will induct on n. If n = 2, then the determinant is α2 −α1.",
    "Let us assume the\nresult for n −1 and consider the polynomial p(x) defined by\np(x)",
    "= det\n\n\n\n\n\n\n\n\n1\n1\n· · ·\n1\n1\nα1\nα2\n· · ·\nαn−1\nx\nα2\n1\nα2\n2\n· · ·\nα2\nn−1\nx2\n...\n...\n...\n...\n...\n",
    "αn−1\n1\nαn−1\n2\n· · ·\nαn−1\nn−1\nxn−1\n\n",
    "\n\n\n\n\n\n\n.\n",
    "Expanding this determinant by cofactors on the last column, we see that p(x) is a polynomial\nof at most degree n−1.",
    "Moreover, the roots of p(x) are α1, . . .",
    ", αn−1, since the substitution\nof any one of these elements in the last column will produce a column identical to the last\ncolumn in the matrix.",
    "Remember that the determinant of a matrix is zero if it has two\nidentical columns.",
    "Therefore,\np(x)",
    "= (x −α1)(x −α2) · · · (x −αn−1)β,\nwhere\nβ = (−1)n+n det\n\n\n\n\n\n\n\n\n1\n1\n· · ·\n1\nα1\nα2\n· · ·\nαn−1\nα2\n1\nα2\n2\n· · ·\nα2\nn−1\n...\n...\n...\n...\nαn−2\n1\nαn−2\n2\n· · ·\nαn−2\nn−1\n\n\n\n\n\n\n\n\n.\n",
    "By our induction hypothesis,\nβ = (−1)n+n\nY\n1≤j<i≤n−1\n(αi −αj).\n",
    "If we let x = αn, the result now follows immediately.\n",
    "■\nThe following theorem gives us an estimate on the error detection and correction capa-\nbilities for a particular generator polynomial.\n",
    "Theorem 22.21 Let C = ⟨g(t)⟩be a cyclic code in Rn and suppose that ω is a primitive\nnth root of unity over Z2.",
    "If s consecutive powers of ω are roots of g(x), then the minimum\ndistance of C is at least s + 1.\nProof.",
    "Suppose that\ng(ωr) = g(ωr+1) = · · · = g(ωr+s−1) = 0.\n",
    "Let f(x) be some polynomial in C with s or fewer nonzero coeﬀicients.",
    "We can assume that\nf(x) = ai0xi0 + ai1xi1 + · · · + ais−1xis−1\n\nCHAPTER 22.",
    "FINITE FIELDS\n287\nbe some polynomial in C. It will suﬀice to show that all of the ai’s must be 0.",
    "Since\ng(ωr) = g(ωr+1) = · · · = g(ωr+s−1) = 0\nand g(x) divides f(x),\nf(ωr) = f(ωr+1) = · · · = f(ωr+s−1)",
    "= 0.\n",
    "Equivalently, we have the following system of equations:\nai0(ωr)i0 + ai1(ωr)i1 + · · · + ais−1(ωr)is−1 = 0\nai0(ωr+1)i0 + ai1(ωr+1)i2 + · · · + ais−1(ωr+1)is−1 = 0\n...\nai0(ωr+s−1)i0 + ai1(ωr+s−1)i1 + · · · + ais−1(ωr+s−1)is−1 = 0.\n",
    "Therefore, (ai0, ai1, . . . , ais−1) is a solution to the homogeneous system of linear equations\n(ωi0)rx0 + (ωi1)rx1 + · · · + (ωis−1)rxn−1 = 0\n(ωi0)r+1x0 + (ωi1)r+1x1 + · · · + (ωis−1)r+1xn−1 = 0\n...\n(ωi0)r+s−1x0 + (ωi1)r+s−1x1 + · · · + (ωis−1)r+s−1xn−1 = 0.\n",
    "However, this system has a unique solution, since the determinant of the matrix\n\n\n\n\n\n(ωi0)r\n(ωi1)r\n· · ·\n(ωis−1)r\n(ωi0)r+1\n(ωi1)r+1\n· · ·\n(ωis−1)r+1\n...\n...\n...\n...\n(ωi0)r+s−1\n(ωi1)r+s−1\n· · ·\n(ωis−1)r+s−1\n\n\n\n\n\ncan be shown to be nonzero using Lemma 22.20 and the basic properties of determinants\n(Exercise).",
    "Therefore, this solution must be ai0 = ai1 = · · · = ais−1 = 0.\n■\nBCH Codes\nSome of the most important codes, discovered independently by A. Hocquenghem in 1959\nand by R. C. Bose and D. V. Ray-Chaudhuri in 1960, are bch codes.\n",
    "The European\nand transatlantic communication systems both use bch codes.",
    "Information words to be\nencoded are of length 231, and a polynomial of degree 24 is used to generate the code.\n",
    "Since 231 + 24 = 255 = 28 −1, we are dealing with a (255, 231)-block code.",
    "This bch code\nwill detect six errors and has a failure rate of 1 in 16 million.",
    "One advantage of bch codes\nis that eﬀicient error correction algorithms exist for them.\n",
    "The idea behind bch codes is to choose a generator polynomial of smallest degree that\nhas the largest error detection and error correction capabilities.",
    "Let d = 2r + 1 for some\nr ≥0.",
    "Suppose that ω is a primitive nth root of unity over Z2, and let mi(x) be the minimal\npolynomial over Z2 of ωi.",
    "If\ng(x) = lcm[m1(x), m2(x), . .",
    ". , m2r(x)],\nthen the cyclic code ⟨g(t)⟩in Rn is called the bch code of length n and distance d. By\nTheorem 22.21, the minimum distance of C is at least d.\n\nCHAPTER 22.",
    "FINITE FIELDS\n288\nTheorem 22.22 Let C = ⟨g(t)⟩be a cyclic code in Rn.\n",
    "The following statements are\nequivalent.\n",
    "1.",
    "The code C is a bch code whose minimum distance is at least d.\n2.",
    "A code polynomial f(t) is in C if and only if f(ωi) = 0 for 1 ≤i < d.\n3.",
    "The matrix\nH =\n\n\n\n\n\n\n\n\n1\nω\nω2\n· · ·\nωn−1\n1\nω2\nω4\n· · ·\nω(n−1)(2)\n1\nω3\nω6\n· · ·\nω(n−1)(3)\n...\n...\n...\n...\n...\n1\nω2r\nω4r\n· · ·\nω(n−1)(2r)\n\n\n\n\n\n\n\n\nis a parity-check matrix for C.\nProof.",
    "(1) ⇒(2).",
    "If f(t) is in C, then g(x) | f(x) in Z2[x].",
    "Hence, for i = 1, . . .",
    ", 2r,\nf(ωi) = 0 since g(ωi) = 0.",
    "Conversely, suppose that f(ωi) = 0 for 1 ≤i ≤d.",
    "Then f(x) is\ndivisible by each mi(x), since mi(x) is the minimal polynomial of ωi.",
    "Therefore, g(x) | f(x)\nby the definition of g(x).",
    "Consequently, f(x) is a codeword.\n",
    "(2) ⇒(3).",
    "Let f(t)",
    "= a0 + a1t + · · · + an−1vtn−1 be in Rn.",
    "The corresponding n-tuple\nin Zn\n2 is x = (a0a1 · · · an−1)t.",
    "By (2),\nHx =\n\n\n\n\n\na0 + a1ω + · · · + an−1ωn−1\na0 + a1ω2 + · · · + an−1(ω2)n−1\n...\na0 + a1ω2r + · · · + an−1(ω2r)n−1\n\n\n\n\n=\n\n\n\n\n\nf(ω)\nf(ω2)\n...\nf(ω2r)\n\n\n\n\n= 0\nexactly when f(t) is in C. Thus, H is a parity-check matrix for C.\n(3) ⇒(1).",
    "By (3), a code polynomial f(t) = a0+a1t+· · ·+an−1tn−1 is in C exactly when\nf(ωi) = 0 for i = 1, . . .",
    ", 2r.",
    "The smallest such polynomial is g(t) = lcm[m1(t), . . .",
    ", m2r(t)].\n",
    "Therefore, C = ⟨g(t)⟩.\n■\nExample 22.23",
    "It is easy to verify that x15 −1 ∈Z2[x] has a factorization\nx15 −1 = (x + 1)(x2",
    "+ x + 1)(x4",
    "+",
    "x + 1)(x4 + x3 + 1)(x4 + x3 + x2",
    "+ x",
    "+ 1),\nwhere each of the factors is an irreducible polynomial.",
    "Let ω be a root of 1 + x + x4.",
    "The\nGalois field GF(24) is\n{a0 + a1ω + a2ω2",
    "+ a3ω3 : ai ∈Z2 and 1 + ω + ω4 = 0}.\n",
    "By Example 22.8, ω is a primitive 15th root of unity.",
    "The minimal polynomial of ω is\nm1(x) = 1 + x + x4.",
    "It is easy to see that ω2 and ω4 are also roots of m1(x).",
    "The minimal\npolynomial of ω3 is m2(x)",
    "= 1",
    "+ x + x2 + x3 + x4.",
    "Therefore,\ng(x) = m1(x)m2(x) = 1 + x4 + x6 + x7 + x8\nhas roots ω, ω2, ω3, ω4.",
    "Since both m1(x) and m2(x) divide x15 −1, the bch code is a\n(15, 7)-code.",
    "If x15 −1 = g(x)h(x), then h(x) = 1 + x4 + x6 + x7; therefore, a parity-check\n\nCHAPTER 22.",
    "FINITE FIELDS\n289\nmatrix for this code is\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n\n\n\n\n\n\n.\n",
    "□\nSage.\n",
    "Finite fields are important in a variety of applied disciplines, such as cryptography\nand coding theory (see introductions to these topics in other chapters).",
    "Sage has excellent\nsupport for finite fields allowing for a wide variety of computations.\n",
    "22.3 Reading Questions\n1.\n",
    "When is a field extension separable?\n2.\nWhat are the possible orders for subfields of a finite field?\n3.\n",
    "What is the structure of the non-zero elements of a finite field?\n4.\nProvide a characterization of finite fields using the concept of a splitting field.\n",
    "5.\n",
    "Why is a theorem in this chapter titled “The Freshman’s Dream?”\n22.4 Exercises\n1.\nCalculate each of the following.\n",
    "(a)",
    "[GF(36) : GF(33)]\n(b)",
    "[GF(128) : GF(16)]\n(c)",
    "[GF(625) : GF(25)]\n(d)",
    "[GF(p12) : GF(p2)]\n2.\n",
    "Calculate [GF(pm) : GF(pn)], where n | m.\n3.\n",
    "What is the lattice of subfields for GF(p30)?\n4.\n",
    "Let α be a zero of x3 + x2",
    "+ 1 over Z2.",
    "Construct a finite field of order 8.",
    "Show that\nx3 + x2",
    "+ 1 splits in Z2(α).\n",
    "5.\nConstruct a finite field of order 27.\n6.\nProve or disprove: Q∗is cyclic.\n",
    "7.\nFactor each of the following polynomials in Z2[x].\n(a) x5 −1\n(b) x6 + x5 + x4 + x3 + x2",
    "+",
    "x",
    "+ 1\n(c) x9 −1\n(d) x4 + x3 + x2",
    "+ x",
    "+ 1\n8.\nProve or disprove:",
    "Z2[x]/⟨x3",
    "+ x + 1⟩∼= Z2[x]/⟨x3 +",
    "x2 + 1⟩.\n9.\nDetermine the number of cyclic codes of length n for n = 6, 7, 8, 10.\n10.",
    "Prove that the ideal ⟨t +",
    "1⟩in Rn is the code in Zn\n2 consisting of all words of even\nparity.\n11.",
    "Construct all bch codes of\n(a) length 7.\n(b) length 15.\n\n",
    "CHAPTER 22.",
    "FINITE FIELDS\n290\n12.",
    "Prove or disprove: There exists a finite field that is algebraically closed.\n",
    "13.",
    "Let p be prime.",
    "Prove that the field of rational functions Zp(x) is an infinite field of\ncharacteristic p.\n14.",
    "Let D be an integral domain of characteristic p.",
    "Prove that (a −b)pn = apn −bpn for\nall a, b ∈D.\n15.",
    "Show that every element in a finite field can be written as the sum of two squares.\n",
    "16.",
    "Let E and F be subfields of a finite field K.",
    "If E is isomorphic to F, show that E = F.\n17.",
    "Let F ⊂E ⊂K be fields.",
    "If K is a separable extension of F, show that K is also\nseparable extension of E.\n18.",
    "Let E be an extension of a finite field F, where F has q elements.",
    "Let α ∈E be\nalgebraic over F of degree n. Prove that F(α) has qn elements.\n",
    "19.",
    "Show that every finite extension of a finite field F is simple; that is, if E is a finite\nextension of a finite field F, prove that there exists an α ∈E such that E = F(α).\n",
    "20. Show that for every n there exists an irreducible polynomial of degree n in Zp[x].\n21.",
    "Prove that the Frobenius map Φ : GF(pn) →GF(pn) given by Φ : α 7→αp is an\nautomorphism of order n.\n22.",
    "Show that every element in GF(pn) can be written in the form ap for some unique\na ∈GF(pn).\n",
    "23.",
    "Let E and F be subfields of GF(pn).",
    "If |E| = pr and |F| = ps, what is the order of\nE ∩F?\n24.",
    "Wilson’s Theorem.",
    "Let p be prime.",
    "Prove that (p −1)!",
    "≡−1 (mod p).\n",
    "25.",
    "If g(t) is the minimal generator polynomial for a cyclic code C in Rn, prove that the\nconstant term of g(x) is 1.\n26.",
    "Often it is conceivable that a burst of errors might occur during transmission, as in\nthe case of a power surge.",
    "Such a momentary burst of interference might alter several\nconsecutive bits in a codeword.",
    "Cyclic codes permit the detection of such error bursts.\n",
    "Let C be an (n, k)-cyclic code.",
    "Prove that any error burst up to n −k digits can be\ndetected.\n",
    "27.",
    "Prove that the rings Rn and Zn\n2 are isomorphic as vector spaces.\n",
    "28.",
    "Let C be a code in Rn that is generated by g(t).",
    "If ⟨f(t)⟩is another code in Rn, show\nthat ⟨g(t)⟩⊂⟨f(t)⟩if and only if f(x) divides g(x) in Z2[x].\n",
    "29.",
    "Let C = ⟨g(t)⟩be a cyclic code in Rn and suppose that xn −1 = g(x)h(x), where\ng(x) = g0 + g1x + · · · + gn−kxn−k and h(x) = h0 + h1x + · · · + hkxk.",
    "Define G to be\nthe n × k matrix\nG =\n\n\n\n\n\n\n\n\n\n\n\n\n\ng0\n0\n· · ·\n0\ng1\ng0\n· · ·\n0\n...\n...\n...\n...\ngn−k\ngn−k−1\n· · ·\ng0\n0\ngn−k\n· · ·\ng1\n...\n...\n...\n...\n0\n0\n· · ·\ngn−k\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCHAPTER 22.",
    "FINITE FIELDS\n291\nand H to be the (n −k) × n matrix\nH =\n\n\n\n\n\n0\n· · ·\n0\n0\nhk\n· · ·\nh0\n0\n· · ·\n0\nhk\n· · ·\nh0\n0\n· · ·\n· · ·\n· · ·\n· · ·\n· · ·\n· · ·\n· · ·\nhk\n· · ·\nh0\n0\n0\n· · ·\n0\n\n\n\n\n.\n(a) Prove that G is a generator matrix for C.\n(b) Prove that H is a parity-check matrix for C.\n(c) Show that HG = 0.\n22.5 Additional Exercises: Error Correction for BCH Codes\nbch codes have very attractive error correction algorithms.",
    "Let C be a bch code in Rn,\nand suppose that a code polynomial c(t) = c0 + c1t + · · · + cn−1tn−1 is transmitted.",
    "Let\nw(t)",
    "= w0 + w1t + · · · wn−1tn−1 be the polynomial in Rn that is received.",
    "If errors have\noccurred in bits a1, . .",
    ".",
    ", ak, then w(t) = c(t) + e(t), where e(t) = ta1 + ta2 + · · ·",
    "+ tak is the\nerror polynomial.",
    "The decoder must determine the integers ai and then recover c(t) from\nw(t) by flipping the aith bit.",
    "From w(t)",
    "we can compute w(ωi) = si for i = 1, . .",
    ".",
    ", 2r, where\nω is a primitive nth root of unity over Z2.",
    "We say the syndrome of w(t) is s1, . . .",
    ", s2r.\n",
    "1.\nShow that w(t) is a code polynomial if and only if si = 0 for all i.\n2.\nShow that\nsi = w(ωi) = e(ωi) = ωia1 + ωia2 + · · · + ωiak\nfor i = 1, . . .",
    ", 2r.",
    "The error-locator polynomial is defined to be\ns(x)",
    "= (x + ωa1)(x + ωa2) · · · (x + ωak).\n",
    "3.\nRecall the (15, 7)-block bch code in Example 22.19.",
    "By Theorem 8.13, this code is\ncapable of correcting two errors.",
    "Suppose that these errors occur in bits a1 and a2.\n",
    "The error-locator polynomial is s(x)",
    "= (x + ωa1)(x + ωa2).",
    "Show that\ns(x)",
    "= x2 + s1x +\n\u0012\ns2\n1 + s3\ns1\n\u0013\n.\n",
    "4.\nLet w(t)",
    "= 1 + t2 + t4 + t5 + t7 + t12 + t13.",
    "Determine what the originally transmitted\ncode polynomial was.\n",
    "22.6 References and Suggested Readings\n[1]\nChilds, L. A Concrete Introduction to Higher Algebra.",
    "2nd ed.",
    "Springer-Verlag, New\nYork, 1995.\n",
    "[2]\nGåding, L. and Tambour, T. Algebra for Computer Science.",
    "Springer-Verlag, New\nYork, 1988.\n",
    "[3]\nLidl, R. and Pilz, G. Applied Abstract Algebra.",
    "2nd ed.",
    "Springer, New York, 1998.\n",
    "An excellent presentation of finite fields and their applications.\n",
    "[4]\nMackiw, G. Applications of Abstract Algebra.",
    "Wiley, New York, 1985.\n",
    "[5]\nRoman, S. Coding and Information Theory.",
    "Springer-Verlag, New York, 1992.\n\n",
    "CHAPTER 22.",
    "FINITE FIELDS\n292\n",
    "[6]\nvan Lint, J. H. Introduction to Coding Theory.",
    "Springer, New York, 1999.\n\n",
    "23\nGalois Theory\nA classic problem of algebra is to find the solutions of a polynomial equation.",
    "The solution\nto the quadratic equation was known in antiquity.",
    "Italian mathematicians found general\nsolutions to the general cubic and quartic equations in the sixteenth century; however,\nattempts to solve the general fifth-degree, or quintic, polynomial were repulsed for the next\nthree hundred years.",
    "Certainly, equations such as x5 −1 = 0 or x6 −x3 −6 = 0 could be\nsolved, but no solution like the quadratic formula was found for the general quintic,\nax5 + bx4",
    "+ cx3",
    "+ dx2 + ex + f = 0.\n",
    "Finally, at the beginning of the nineteenth century, Ruﬀini and Abel both found quintics\nthat could not be solved with any formula.",
    "It was Galois, however, who provided the full\nexplanation by showing which polynomials could and could not be solved by formulas.",
    "He\ndiscovered the connection between groups and field extensions.",
    "Galois theory demonstrates\nthe strong interdependence of group and field theory, and has had far-reaching implications\nbeyond its original purpose.\n",
    "In this chapter we will prove the Fundamental Theorem of Galois Theory.",
    "This result\nwill be used to establish the insolvability of the quintic and to prove the Fundamental\nTheorem of Algebra.\n",
    "23.1 Field Automorphisms\nOur first task is to establish a link between group theory and field theory by examining\nautomorphisms of fields.\n",
    "Proposition 23.1",
    "The set of all automorphisms of a field F is a group under composition\nof functions.\n",
    "Proof.\n",
    "If σ and τ are automorphisms of F, then so are στ and σ−1.",
    "The identity is\ncertainly an automorphism; hence, the set of all automorphisms of a field F is indeed a\ngroup.\n",
    "■\nProposition 23.2 Let E be a field extension of F. Then the set of all automorphisms of\nE that fix F elementwise is a group; that is, the set of all automorphisms σ : E →E such\nthat σ(α)",
    "= α for all α ∈F is a group.\n",
    "Proof.",
    "We need only show that the set of automorphisms of E that fix F elementwise is\na subgroup of the group of all automorphisms of E. Let σ and τ be two automorphisms\nof E such that σ(α)",
    "= α and τ(α)",
    "= α for all α ∈F. Then στ(α) = σ(α)",
    "= α and\nσ−1(α) = α.",
    "Since the identity fixes every element of E, the set of automorphisms of E\nthat leave elements of F fixed is a subgroup of the entire group of automorphisms of E.\n■\n293\n\nCHAPTER 23.",
    "GALOIS THEORY\n294\nLet E be a field extension of F. We will denote the full group of automorphisms of E\nby Aut(E).",
    "We define the Galois group of E over F to be the group of automorphisms of\nE that fix F elementwise; that is,\nG(E/F) = {σ ∈Aut(E) : σ(α)",
    "= α for all α ∈F}.\n",
    "If f(x) is a polynomial in F[x] and E is the splitting field of f(x) over F, then we define\nthe Galois group of f(x) to be G(E/F).\n",
    "Example 23.3 Complex conjugation, defined by σ : a + bi 7→a −bi, is an automorphism\nof the complex numbers.",
    "Since\nσ(a) = σ(a + 0i) = a −0i = a,\nthe automorphism defined by complex conjugation must be in G(C/R).\n",
    "□\nExample 23.4 Consider the fields Q ⊂Q(\n√\n5 ) ⊂Q(\n√\n3,\n√\n5 ).",
    "Then for a, b ∈Q(\n√\n5 ),\nσ(a + b\n√\n3 ) = a −b\n√\n3\nis an automorphism of Q(\n√\n3,\n√\n5 ) leaving Q(\n√\n5 ) fixed.",
    "Similarly,\nτ(a + b\n√\n5 ) = a −b\n√\n5\nis an automorphism of Q(\n√\n3,\n√\n5 ) leaving Q(\n√\n3 ) fixed.",
    "The automorphism µ = στ moves\nboth\n√\n3 and\n√\n5.",
    "It will soon be clear that {id, σ, τ, µ} is the Galois group of Q(\n√\n3,\n√\n5 )\nover Q. The following table shows that this group is isomorphic to Z2 × Z2.\n",
    "id\nσ\nτ\nµ\nid\nid\nσ\nτ\nµ\nσ\nσ\nid\nµ\nτ\nτ\nτ\nµ\nid\nσ\nµ\nµ\nτ\nσ\nid\nWe may also regard the field Q(\n√\n3,\n√\n5 ) as a vector space over Q that has basis {1,\n√\n3,\n√\n5,\n√\n15 }.\n",
    "It is no coincidence that |G(Q(\n√\n3,\n√\n5 )/Q)|",
    "= [Q(\n√\n3,\n√\n5 ) : Q)]",
    "= 4.\n□\nProposition 23.5 Let E be a field extension of F and f(x) be a polynomial in F[x].",
    "Then\nany automorphism in G(E/F) defines a permutation of the roots of f(x) that lie in E.\nProof.",
    "Let\nf(x)",
    "= a0 +",
    "a1x",
    "+ a2x2",
    "+ · · · + anxn\nand suppose that α ∈E is a zero of f(x).",
    "Then for σ ∈G(E/F),\n0 = σ(0)\n= σ(f(α))\n= σ(a0 + a1α + a2α2 + · · · + anαn)\n= a0 + a1σ(α) +",
    "a2[σ(α)]2 + · · · + an[σ(α)]n;\ntherefore, σ(α) is also a zero of f(x).\n",
    "■\nLet E be an algebraic extension of a field F. Two elements α, β ∈E are conjugate over\nF if they have the same minimal polynomial.",
    "For example, in the field Q(\n√\n2 ) the elements\n√\n2 and −\n√\n2 are conjugate over Q since they are both roots of the irreducible polynomial\nx2 −2.\n\n",
    "CHAPTER 23.",
    "GALOIS THEORY\n295\n",
    "A converse of the last proposition exists.",
    "The proof follows directly from Lemma 21.32.\nProposition 23.6",
    "If α and β are conjugate over F, there exists an isomorphism σ : F(α) →\nF(β) such that σ is the identity when restricted to F.\nTheorem 23.7 Let f(x) be a polynomial in F[x] and suppose that E is the splitting field\nfor f(x) over F. If f(x) has no repeated roots, then\n|G(E/F)| =",
    "[E : F].\nProof.",
    "We will use mathematical induction on [E : F].",
    "If [E : F] = 1, then E = F and\nthere is nothing to show.",
    "If [E : F] > 1, let f(x) = p(x)q(x), where p(x) is irreducible of\ndegree d.",
    "We may assume that d > 1; otherwise, f(x) splits over F and [E : F] = 1.",
    "Let α\nbe a root of p(x).",
    "If ϕ : F(α) →E is any injective homomorphism, then ϕ(α) = β is a root\nof p(x), and ϕ : F(α) →F(β) is a field automorphism.",
    "Since f(x) has no repeated roots,\np(x) has exactly d roots β ∈E.",
    "By Proposition 23.5, there are exactly d isomorphisms\nϕ : F(α) →F(βi) that fix F, one for each root β1, . .",
    ".",
    ", βd of p(x) (see Figure 23.8).\n",
    "E\nψ\n−−−−→\nE\ny\ny\nF(α)\nϕ\n−−−−→F(β)\ny\ny\nF\nidentity\n−−−−−→\nF\nFigure 23.8\nSince E is a splitting field of f(x) over F, it is also a splitting field over F(α).",
    "Similarly,\nE is a splitting field of f(x) over F(β).",
    "Since [E : F(α)]",
    "=",
    "[E : F]/d, induction shows that\neach of the d isomorphisms ϕ has exactly",
    "[E : F]/d extensions, ψ : E →E, and we have\nconstructed [E : F] isomorphisms that fix F. Finally, suppose that σ is any automorphism\nfixing F. Then σ restricted to F(α) is ϕ for some ϕ : F(α) →F(β).\n",
    "■\nCorollary 23.9 Let F be a finite field with a finite extension E such that",
    "[E : F] = k.\nThen G(E/F) is cyclic of order k.\nProof.",
    "Let p be the characteristic of E and F and assume that the orders of E and F are\npm and pn, respectively.",
    "Then nk = m. We can also assume that E is the splitting field of\nxpm −x over a subfield of order p.",
    "Therefore, E must also be the splitting field of xpm −x\nover F. Applying Theorem 23.7, we find that |G(E/F)| = k.\nTo prove that G(E/F) is cyclic, we must find a generator for G(E/F).",
    "Let σ : E →E\nbe defined by σ(α)",
    "= αpn.",
    "We claim that σ is the element in G(E/F) that we are seeking.\n",
    "We first need to show that σ is in Aut(E).",
    "If α and β are in E,\nσ(α + β) = (α + β)pn = αpn + βpn = σ(α)",
    "+ σ(β)\nby Lemma 22.3.",
    "Also, it is easy to show that σ(αβ) = σ(α)σ(β).",
    "Since σ is a nonzero\nhomomorphism of fields, it must be injective.",
    "It must also be onto, since E is a finite field.\n",
    "We know that σ must be in G(E/F), since F is the splitting field of xpn −x over the base\nfield of order p.",
    "This means that σ leaves every element in F fixed.",
    "Finally, we must show\nthat the order of σ is k.",
    "By Theorem 23.7, we know that\nσk(α)",
    "= αpnk = αpm = α\nis the identity of G(E/F).",
    "However, σr cannot be the identity for 1 ≤r < k; otherwise,\nxpnr −x would have pm roots, which is impossible.\n",
    "■\n\nCHAPTER 23.",
    "GALOIS THEORY\n296\nExample 23.10",
    "We can now confirm that the Galois group of Q(\n√\n3,\n√\n5 ) over Q in Exam-\nple 23.4 is indeed isomorphic to Z2 ×Z2.",
    "Certainly the group H = {id, σ, τ, µ} is a subgroup\nof G(Q(\n√\n3,\n√\n5 )/Q); however, H must be all of G(Q(\n√\n3,\n√\n5 )/Q), since\n|H| =",
    "[Q(\n√\n3,\n√\n5 ) : Q] = |G(Q(\n√\n3,\n√\n5 )/Q)|",
    "= 4.\n□\nExample 23.11 Let us compute the Galois group of\nf(x)",
    "= x4 + x3 + x2",
    "+ x",
    "+ 1\nover Q.",
    "We know that f(x) is irreducible by Exercise 17.5.20 in Chapter 17.",
    "Furthermore,\nsince (x −1)f(x) = x5 −1, we can use DeMoivre’s Theorem to determine that the roots of\nf(x) are ωi, where i = 1, . . .",
    ", 4 and\nω = cos(2π/5)",
    "+ i sin(2π/5).\n",
    "Hence, the splitting field of f(x) must be Q(ω).",
    "We can define automorphisms σi of Q(ω) by\nσi(ω)",
    "= ωi for i = 1, . . .",
    ", 4.",
    "It is easy to check that these are indeed distinct automorphisms\nin G(Q(ω)/Q).",
    "Since\n[Q(ω) : Q] = |G(Q(ω)/Q)| = 4,\nthe σi’s must be all of G(Q(ω)/Q).",
    "Therefore, G(Q(ω)/Q) ∼= Z4 since ω is a generator for\nthe Galois group.\n",
    "□\nSeparable Extensions\nMany of the results that we have just proven depend on the fact that a polynomial f(x) in\nF[x] has no repeated roots in its splitting field.",
    "It is evident that we need to know exactly\nwhen a polynomial factors into distinct linear factors in its splitting field.",
    "Let E be the\nsplitting field of a polynomial f(x) in F[x].",
    "Suppose that f(x) factors over E as\nf(x)",
    "= (x −α1)n1(x −α2)n2 · · · (x −αr)nr =\nr\nY\ni=1\n(x −αi)ni.\n",
    "We define the multiplicity of a root αi of f(x) to be ni.",
    "A root with multiplicity 1 is called\na simple root.",
    "Recall that a polynomial f(x) ∈F[x] of degree n is separable if it has n\ndistinct roots in its splitting field E. Equivalently, f(x) is separable if it factors into distinct\nlinear factors over E[x].",
    "An extension E of F is a separable extension of F if every element\nin E is the root of a separable polynomial in F[x].",
    "Also recall that f(x) is separable if and\nonly if gcd(f(x), f′(x))",
    "= 1 (Lemma 22.5).\n",
    "Proposition 23.12 Let f(x) be an irreducible polynomial over F.",
    "If the characteristic of\nF is 0, then f(x) is separable.",
    "If the characteristic of F is p and f(x) ̸= g(xp) for some\ng(x) in F[x], then f(x) is also separable.\nProof.",
    "First assume that char F = 0.",
    "Since deg f′(x) < deg f(x) and f(x) is irreducible,\nthe only way gcd(f(x), f′(x))",
    "̸= 1 is if f′(x) is the zero polynomial; however, this is impos-\nsible in a field of characteristic zero.",
    "If char F = p, then f′(x) can be the zero polynomial if\nevery coeﬀicient of f′(x) is a multiple of p.",
    "This can happen only if we have a polynomial\nof the form f(x)",
    "= a0 + a1xp + a2x2p + · · ·",
    "+ anxnp.\n",
    "■\nCertainly extensions of a field F of the form F(α) are some of the easiest to study and\nunderstand.",
    "Given a field extension E of F, the obvious question to ask is when it is possible\n\nCHAPTER 23.",
    "GALOIS THEORY\n297\nto find an element α ∈E such that E = F(α).",
    "In this case, α is called a primitive element.\n",
    "We already know that primitive elements exist for certain extensions.",
    "For example,\nQ(\n√\n3,\n√\n5 ) = Q(\n√\n3 +\n√\n5 )\nand\nQ(\n3√\n5,\n√\n5 i) = Q(\n6√\n5 i).\n",
    "Corollary 22.12 tells us that there exists a primitive element for any finite extension of a\nfinite field.",
    "The next theorem tells us that we can often find a primitive element.\n",
    "Theorem 23.13\nPrimitive Element Theorem.",
    "Let E be a finite separable extension\nof a field F. Then there exists an α ∈E such that E = F(α).\n",
    "Proof.",
    "We already know that there is no problem if F is a finite field.",
    "Suppose that E\nis a finite extension of an infinite field.",
    "We will prove the result for F(α, β).",
    "The general\ncase easily follows when we use mathematical induction.",
    "Let f(x) and g(x) be the minimal\npolynomials of α and β, respectively.",
    "Let K be the field in which both f(x) and g(x) split.\n",
    "Suppose that f(x) has zeros α = α1, . . .",
    ", αn in K and g(x) has zeros β = β1, . . .",
    ", βm in K.\nAll of these zeros have multiplicity 1, since E is separable over F. Since F is infinite, we\ncan find an a in F such that\na ̸= αi −α\nβ −βj\nfor all i and j with j ̸= 1.",
    "Therefore, a(β −βj) ̸= αi −α.",
    "Let γ = α + aβ.",
    "Then\nγ = α + aβ ̸= αi + aβj;\nhence, γ −aβj ̸= αi for all i, j with j ̸= 1.",
    "Define h(x) ∈F(γ)[x] by h(x) = f(γ −ax).\n",
    "Then h(β) = f(α) = 0.",
    "However, h(βj) ̸= 0 for j ̸= 1.",
    "Hence, h(x) and g(x) have a single\ncommon factor in F(γ)[x]; that is, the minimal polynomial of β over F(γ) must be linear,\nsince β is the only zero common to both g(x) and h(x).",
    "So β ∈F(γ) and α = γ −aβ is in\nF(γ).",
    "Hence, F(α, β) = F(γ).\n",
    "■\n23.2",
    "The Fundamental Theorem\nThe goal of this section is to prove the Fundamental Theorem of Galois Theory.\n",
    "This\ntheorem explains the connection between the subgroups of G(E/F) and the intermediate\nfields between E and F.\nProposition 23.14 Let {σi : i ∈I} be a collection of automorphisms of a field F. Then\nF{σi} = {a ∈F : σi(a) = a for all σi}\nis a subfield of F.\nProof.",
    "Let σi(a) = a and σi(b)",
    "= b.",
    "Then\nσi(a ± b) = σi(a) ± σi(b) = a ± b\nand\nσi(ab)",
    "= σi(a)σi(b) = ab.\n",
    "If a ̸= 0, then σi(a−1) =",
    "[σi(a)]−1 = a−1.",
    "Finally, σi(0) = 0 and σi(1) = 1 since σi is an\nautomorphism.\n",
    "■\nCorollary 23.15 Let F be a field and let G be a subgroup of Aut(F).",
    "Then\nFG = {α ∈F : σ(α)",
    "= α for all σ ∈G}\n\nCHAPTER 23.",
    "GALOIS THEORY\n298\nis a subfield of F.\n",
    "The subfield F{σi} of F is called the fixed field of {σi}.",
    "The field fixed by a subgroup G\nof Aut(F) will be denoted by FG.\n",
    "Example 23.16 Let σ : Q(\n√\n3,\n√\n5 ) →Q(\n√\n3,\n√\n5 ) be the automorphism that maps\n√\n3 to\n−\n√\n3.",
    "Then Q(\n√\n5 ) is the subfield of Q(\n√\n3,\n√\n5 ) left fixed by σ.\n□\nProposition 23.17 Let E be a splitting field over F of a separable polynomial.\n",
    "Then\nEG(E/F) = F.\nProof.",
    "Let G = G(E/F).",
    "Clearly, F ⊂EG ⊂E. Also, E must be a splitting field of EG\nand G(E/F) = G(E/EG).",
    "By Theorem 23.7,\n|G| = [E : EG] =",
    "[E : F].\n",
    "Therefore, [EG : F] = 1.",
    "Consequently, EG = F.\n■\nA large number of mathematicians first learned Galois theory from Emil Artin’s mono-\ngraph on the subject [1].",
    "The very clever proof of the following lemma is due to Artin.\n",
    "Lemma 23.18 Let G be a finite group of automorphisms of E and let F = EG.",
    "Then\n[E : F] ≤|G|.\nProof.",
    "Let |G| = n.",
    "We must show that any set of n + 1 elements α1, . . .",
    ", αn+1 in E is\nlinearly dependent over F; that is, we need to find elements ai ∈F, not all zero, such that\na1α1 + a2α2 + · · · + an+1αn+1 = 0.\n",
    "Suppose that σ1 = id, σ2, . .",
    ".",
    ", σn are the automorphisms in G. The homogeneous system of\nlinear equations\nσ1(α1)x1",
    "+ σ1(α2)x2",
    "+ · · · + σ1(αn+1)xn+1 = 0\nσ2(α1)x1",
    "+",
    "σ2(α2)x2 + · · · + σ2(αn+1)xn+1",
    "= 0\n...\n",
    "σn(α1)x1 + σn(α2)x2 + · · · + σn(αn+1)xn+1 = 0\nhas more unknowns than equations.",
    "From linear algebra we know that this system has a\nnontrivial solution, say xi = ai for i = 1, 2, . .",
    ".",
    ", n + 1.",
    "Since σ1 is the identity, the first\nequation translates to\na1α1",
    "+ a2α2",
    "+ · · · + an+1αn+1 = 0.\n",
    "The problem is that some of the ai’s may be in E but not in F. We must show that this is\nimpossible.\n",
    "Suppose that at least one of the ai’s is in E but not in F. By rearranging the αi’s we\nmay assume that a1 is nonzero.",
    "Since any nonzero multiple of a solution is also a solution,\nwe can also assume that a1 = 1.",
    "Of all possible solutions fitting this description, we choose\nthe one with the smallest number of nonzero terms.",
    "Again, by rearranging α2, . . .",
    ", αn+1 if\nnecessary, we can assume that a2 is in E but not in F. Since F is the subfield of E that\nis fixed elementwise by G, there exists a σi in G such that σi(a2) ̸= a2.",
    "Applying σi to\neach equation in the system, we end up with the same homogeneous system, since G is a\ngroup.",
    "Therefore, x1 = σi(a1) = 1, x2 = σi(a2), . .",
    "., xn+1 = σi(an+1) is also a solution of\nthe original system.",
    "We know that a linear combination of two solutions of a homogeneous\nsystem is also a solution; consequently,\nx1 = 1 −1 = 0\nx2 = a2 −σi(a2)\n\nCHAPTER 23.",
    "GALOIS THEORY\n299\n...\n",
    "xn+1 = an+1 −σi(an+1)\nmust be another solution of the system.",
    "This is a nontrivial solution because σi(a2) ̸= a2,\nand has fewer nonzero entries than our original solution.",
    "This is a contradiction, since the\nnumber of nonzero solutions to our original solution was assumed to be minimal.",
    "We can\ntherefore conclude that a1, . . .",
    ", an+1 ∈F.\n■\nLet E be an algebraic extension of F.",
    "If every irreducible polynomial in F[x] with a\nroot in E has all of its roots in E, then E is called a normal extension of F; that is, every\nirreducible polynomial in F[x] containing a root in E is the product of linear factors in\nE[x].\n",
    "Theorem 23.19 Let E be a field extension of F.\n",
    "Then the following statements are\nequivalent.\n",
    "1. E is a finite, normal, separable extension of F.\n2.",
    "E is a splitting field over F of a separable polynomial.\n",
    "3. F = EG for some finite group G of automorphisms of E.\nProof.",
    "(1) ⇒(2).",
    "Let E be a finite, normal, separable extension of F. By the Primitive\nElement Theorem, we can find an α in E such that E = F(α).",
    "Let f(x) be the minimal\npolynomial of α over F. The field E must contain all of the roots of f(x) since it is a normal\nextension F; hence, E is a splitting field for f(x).\n",
    "(2) ⇒(3).",
    "Let E be the splitting field over F of a separable polynomial.",
    "By Proposi-\ntion 23.17, EG(E/F) = F. Since |G(E/F)| =",
    "[E : F], this is a finite group.\n",
    "(3) ⇒(1).",
    "Let F = EG for some finite group of automorphisms G of E.",
    "Since [E : F] ≤\n|G|, E is a finite extension of F. To show that E is a finite, normal extension of F, let\nf(x) ∈F[x] be an irreducible monic polynomial that has a root α in E.",
    "We must show that\nf(x) is the product of distinct linear factors in E[x].",
    "By Proposition 23.5, automorphisms in\nG permute the roots of f(x) lying in E. Hence, if we let G act on α, we can obtain distinct\nroots α1 = α, α2, . . .",
    ", αn in E. Let g(x) = Qn\ni=1(x −αi).",
    "Then g(x) is separable over F\nand g(α) = 0.",
    "Any automorphism σ in G permutes the factors of g(x) since it permutes\nthese roots; hence, when σ acts on g(x), it must fix the coeﬀicients of g(x).",
    "Therefore,\nthe coeﬀicients of g(x) must be in F. Since deg g(x) ≤deg f(x) and f(x) is the minimal\npolynomial of α, f(x) = g(x).\n",
    "■\nCorollary 23.20 Let K be a field extension of F such that F = KG for some finite group\nof automorphisms G of K. Then G = G(K/F).\n",
    "Proof.",
    "Since F = KG, G is a subgroup of G(K/F).",
    "Hence,\n[K : F] ≤|G| ≤|G(K/F)| =",
    "[K : F].\n",
    "It follows that G = G(K/F), since they must have the same order.\n",
    "■\nBefore we determine the exact correspondence between field extensions and automor-\nphisms of fields, let us return to a familiar example.\n",
    "Example 23.21",
    "In Example 23.4 we examined the automorphisms of Q(\n√\n3,\n√\n5 ) fixing Q.\nFigure 23.22 compares the lattice of field extensions of Q with the lattice of subgroups of\nG(Q(\n√\n3,\n√\n5 )/Q).",
    "The Fundamental Theorem of Galois Theory tells us what the relation-\nship is between the two lattices.\n",
    "□\n\nCHAPTER 23.",
    "GALOIS THEORY\n300\n{id, σ, τ, µ}\n{id, σ}\n{id, τ}\n{id, µ}\n{id}\nQ(\n√\n3,\n√\n5 )\nQ(\n√\n3 )\nQ(\n√\n5 )\nQ(\n√\n15 )\nQ\nFigure 23.22 G(Q(\n√\n3,\n√\n5 )/Q)\n",
    "We are now ready to state and prove the Fundamental Theorem of Galois Theory.\n",
    "Theorem 23.23\nFundamental Theorem of Galois Theory.",
    "Let F be a finite field\nor a field of characteristic zero.",
    "If E is a finite normal extension of F with Galois group\nG(E/F), then the following statements are true.\n",
    "1.",
    "The map K 7→G(E/K) is a bijection of subfields K of E containing F with the\nsubgroups of G(E/F).\n",
    "2.",
    "If F ⊂K ⊂E, then\n",
    "[E : K] = |G(E/K)| and [K : F] =",
    "[G(E/F) : G(E/K)].\n",
    "3.",
    "F ⊂K ⊂L ⊂E if and only if {id} ⊂G(E/L) ⊂G(E/K) ⊂G(E/F).\n",
    "4. K is a normal extension of F if and only if G(E/K) is a normal subgroup of G(E/F).\n",
    "In this case\nG(K/F) ∼= G(E/F)/G(E/K).\n",
    "Proof.\n",
    "(1) Suppose that G(E/K) = G(E/L) = G. Both K and L are fixed fields of\nG; hence, K = L and the map defined by K 7→G(E/K) is one-to-one.",
    "To show that\nthe map is onto, let G be a subgroup of G(E/F) and K be the field fixed by G. Then\nF ⊂K ⊂E; consequently, E is a normal extension of K. Thus, G(E/K) = G and the map\nK 7→G(E/K) is a bijection.\n",
    "(2) By Theorem Theorem 23.7, |G(E/K)| =",
    "[E : K]; therefore,\n|G(E/F)| =",
    "[G(E/F) : G(E/K)] · |G(E/K)| =",
    "[E : F] =",
    "[E : K][K : F].\n",
    "Thus, [K : F] = [G(E/F) : G(E/K)].\n",
    "Statement (3) is illustrated in Figure 23.24.",
    "We leave the proof of this property as an\nexercise.\n",
    "(4) This part takes a little more work.",
    "Let K be a normal extension of F. If σ is in\nG(E/F) and τ is in G(E/K), we need to show that σ−1τσ is in G(E/K); that is, we need\nto show that σ−1τσ(α) = α for all α ∈K. Suppose that f(x) is the minimal polynomial of\nα over F. Then σ(α) is also a root of f(x) lying in K, since K is a normal extension of F.\nHence, τ(σ(α))",
    "= σ(α) or σ−1τσ(α) = α.\n",
    "Conversely, let G(E/K) be a normal subgroup of G(E/F).\n",
    "We need to show that\nF = KG(K/F).",
    "Let τ ∈G(E/K).",
    "For all σ ∈G(E/F) there exists a τ ∈G(E/K) such that\nτσ = στ.",
    "Consequently, for all α ∈K\nτ(σ(α))",
    "= σ(τ(α))",
    "= σ(α);\n\nCHAPTER 23.",
    "GALOIS THEORY\n301\nhence, σ(α) must be in the fixed field of G(E/K).",
    "Let σ be the restriction of σ to K. Then\nσ is an automorphism of K fixing F, since σ(α) ∈K for all α ∈K; hence, σ ∈G(K/F).\n",
    "Next, we will show that the fixed field of G(K/F) is F. Let β be an element in K that\nis fixed by all automorphisms in G(K/F).",
    "In particular, σ(β) = β for all σ ∈G(E/F).\n",
    "Therefore, β belongs to the fixed field F of G(E/F).\n",
    "Finally, we must show that when K is a normal extension of F,\nG(K/F) ∼= G(E/F)/G(E/K).\n",
    "For σ ∈G(E/F), let σK be the automorphism of K obtained by restricting σ to K. Since K\nis a normal extension, the argument in the preceding paragraph shows that σK ∈G(K/F).\n",
    "Consequently, we have a map ϕ : G(E/F) →G(K/F) defined by σ 7→σK.",
    "This map is a\ngroup homomorphism since\nϕ(στ) = (στ)K = σKτK = ϕ(σ)ϕ(τ).\n",
    "The kernel of ϕ is G(E/K).",
    "By (2),\n|G(E/F)|/|G(E/K)| =",
    "[K : F] = |G(K/F)|.\n",
    "Hence, the image of ϕ is G(K/F) and ϕ is onto.",
    "Applying the First Isomorphism Theorem,\nwe have\nG(K/F) ∼= G(E/F)/G(E/K).\n",
    "■\nE −−−−→\n{id}\nx\ny\nL −−−−→G(E/L)\nx\ny\nK −−−−→G(E/K)\nx\ny\nF −−−−→G(E/F)\nFigure 23.24 Subgroups of G(E/F) and subfields of E\nExample 23.25",
    "In this example we will illustrate the Fundamental Theorem of Galois\nTheory by determining the lattice of subgroups of the Galois group of f(x)",
    "= x4 −2.",
    "We\nwill compare this lattice to the lattice of field extensions of Q that are contained in the\nsplitting field of x4 −2.",
    "The splitting field of f(x) is Q(\n4√\n2, i).",
    "To see this, notice that f(x)\nfactors as (x2 +\n√\n2 )(x2 −\n√\n2 ); hence, the roots of f(x) are ±\n4√\n2 and ±\n4√\n2 i. We first adjoin\nthe root\n4√\n2 to Q and then adjoin the root i of x2 + 1 to Q(\n4√\n2 ).",
    "The splitting field of f(x)\nis then Q(\n4√\n2 )(i) = Q(\n4√\n2, i).\n",
    "Since [Q(\n4√\n2 ) : Q] = 4 and i is not in Q(\n4√\n2 ), it must be the case that [Q(\n4√\n2, i) :\nQ(\n4√\n2 )]",
    "= 2.",
    "Hence, [Q(\n4√\n2, i) : Q] = 8.",
    "The set\n{1,\n4√\n2, (\n4√\n2 )2, (\n4√\n2 )3, i, i\n4√\n2, i(\n4√\n2 )2, i(\n4√\n2 )3}\nis a basis of Q(\n4√\n2, i) over Q.",
    "The lattice of field extensions of Q contained in Q(\n4√\n2, i) is\nillustrated in Figure 23.26(a).\n",
    "The Galois group G of f(x) must be of order 8.",
    "Let σ be the automorphism defined by\n\nCHAPTER 23.",
    "GALOIS THEORY\n302\nσ(\n4√\n2 )",
    "= i\n4√\n2 and σ(i)",
    "= i, and τ be the automorphism defined by complex conjugation;\nthat is, τ(i) = −i.",
    "Then G has an element of order 4 and an element of order 2.",
    "It is easy\nto verify by direct computation that the elements of G are {id, σ, σ2, σ3, τ, στ, σ2τ, σ3τ}\nand that the relations τ 2 = id, σ4 = id, and τστ = σ−1 are satisfied; hence, G must be\nisomorphic to D4.",
    "The lattice of subgroups of G is illustrated in Figure 23.26(b).\n",
    "□\nQ(\n4√\n2, i)\nQ(\n4√\n2 )\nQ(\n4√\n2 i)\nQ(\n√\n2, i)\nQ((1 + i)\n",
    "4√\n2 ) Q((1 −i)\n4√\n2 )\nQ(\n√\n2 )\nQ(i)\nQ(\n√\n2 i)\nQ\n(a)\nD4\n{id, σ2, τ, σ2τ} {id, σ, σ2, σ3}{id, σ2, στ, σ3τ}\n{id, τ}\n{id, σ2τ}\n{id, σ2}\n{id, στ}\n{id, σ3τ}\n{id}\n(b)\nFigure 23.26 Galois group of x4 −2\nHistorical Note\nSolutions for the cubic and quartic equations were discovered in the 1500s.",
    "Attempts to\nfind solutions for the quintic equations puzzled some of history’s best mathematicians.",
    "In\n1798, P. Ruﬀini submitted a paper that claimed no such solution could be found; however,\nthe paper was not well received.",
    "In 1826, Niels Henrik Abel (1802–1829) finally offered the\nfirst correct proof that quintics are not always solvable by radicals.\n",
    "Abel inspired the work of Évariste Galois.",
    "Born in 1811, Galois began to display extraor-\ndinary mathematical talent at the age of 14.",
    "He applied for entrance to the École Poly-\ntechnique several times; however, he had great diﬀiculty meeting the formal entrance re-\n\nCHAPTER 23.",
    "GALOIS THEORY\n303\nquirements, and the examiners failed to recognize his mathematical genius.",
    "He was finally\naccepted at the École Normale in 1829.\n",
    "Galois worked to develop a theory of solvability for polynomials.",
    "In 1829, at the age of\n17, Galois presented two papers on the solution of algebraic equations to the Académie des\nSciences de Paris.",
    "These papers were sent to Cauchy, who subsequently lost them.",
    "A third\npaper was submitted to Fourier, who died before he could read the paper.",
    "Another paper\nwas presented, but was not published until 1846.\n",
    "Galois’ democratic sympathies led him into the Revolution of 1830.",
    "He was expelled from\nschool and sent to prison for his part in the turmoil.",
    "After his release in 1832, he was drawn\ninto a duel possibly over a love affair.",
    "Certain that he would be killed, he spent the evening\nbefore his death outlining his work and his basic ideas for research in a long letter to his\nfriend Chevalier.",
    "He was indeed dead the next day, at the age of 20.\n23.3 Applications\nSolvability by Radicals\nThroughout this section we shall assume that all fields have characteristic zero to ensure\nthat irreducible polynomials do not have multiple roots.",
    "The immediate goal of this section\nis to determine when the roots of a polynomial f(x) can be computed with a finite number of\noperations on the coeﬀicients of f(x).",
    "The allowable operations are addition, subtraction,\nmultiplication, division, and the extraction of nth roots.\n",
    "Certainly the solution to the\nquadratic equation, ax2 + bx + c",
    "= 0, illustrates this process:\nx = −b ±\n√\nb2 −4ac\n2a\n.\n",
    "The only one of these operations that might demand a larger field is the taking of nth roots.\n",
    "We are led to the following definition.\n",
    "An extension field E of a field F is an extension by radicals if there exists a chain of\nsubfields\nF = F0 ⊂F1 ⊂F2 ⊂· · · ⊂Fr = E\nsuch for i = 1, 2, . .",
    ".",
    ", r, we have Fi = Fi−1(αi) and αni\ni\n∈Fi−1 for some positive integer ni.\n",
    "A polynomial f(x) is solvable by radicals over F if the splitting field K of f(x) over F is\ncontained in an extension of F by radicals.",
    "Our goal is to arrive at criteria that will tell\nus whether or not a polynomial f(x) is solvable by radicals by examining the Galois group\nf(x).\n",
    "The easiest polynomial to solve by radicals is one of the form xn −a.",
    "As we discussed\nin Chapter 4, the roots of xn −1 are called the nth roots of unity.",
    "These roots are a finite\nsubgroup of the splitting field of xn −1.",
    "By Corollary 22.11, the nth roots of unity form a\ncyclic group.",
    "Any generator of this group is called a primitive nth root of unity.\n",
    "Example 23.27",
    "The polynomial xn −1 is solvable by radicals over Q.",
    "The roots of this\npolynomial are 1, ω, ω2, . .",
    ". , ωn−1, where\nω = cos\n\u00122π\nn\n\u0013\n+ i sin\n\u00122π\nn\n\u0013\n.\n",
    "The splitting field of xn −1 over Q is Q(ω).\n",
    "□\nWe shall prove that a polynomial is solvable by radicals if its Galois group is solvable.\n",
    "Recall that a subnormal series of a group G is a finite sequence of subgroups\nG =",
    "Hn ⊃Hn−1 ⊃· · · ⊃H1 ⊃H0 = {e},\n\nCHAPTER 23.",
    "GALOIS THEORY\n304\nwhere Hi is normal in Hi+1.",
    "A group G is solvable if it has a subnormal series {Hi} such\n",
    "that all of the factor groups Hi+1/",
    "Hi are abelian.",
    "For example, if we examine the series\n{id} ⊂A3 ⊂S3, we see that S3 is solvable.",
    "On the other hand, S5 is not solvable, by\nTheorem 10.11.\n",
    "Lemma 23.28 Let F be a field of characteristic zero and E be the splitting field of xn −a\nover F with a ∈F. Then G(E/F) is a solvable group.\n",
    "Proof.",
    "The roots of xn −a are\nn√a, ω n√a, . .",
    ". , ωn−1 n√a, where ω is a primitive nth root\nof unity.",
    "Suppose that F contains all of its nth roots of unity.",
    "If ζ is one of the roots of\nxn −a, then distinct roots of xn −a are ζ, ωζ, . .",
    ". , ωn−1ζ, and E = F(ζ).",
    "Since G(E/F)\npermutes the roots xn −a, the elements in G(E/F) must be determined by their action on\nthese roots.",
    "Let σ and τ be in G(E/F) and suppose that σ(ζ) = ωiζ and τ(ζ) = ωjζ.",
    "If F\ncontains the roots of unity, then\nστ(ζ) = σ(ωjζ) = ωjσ(ζ) = ωi+jζ = ωiτ(ζ) = τ(ωiζ) = τσ(ζ).\n",
    "Therefore, στ = τσ and G(E/F) is abelian, and G(E/F) must be solvable.\n",
    "Now suppose that F does not contain a primitive nth root of unity.",
    "Let ω be a generator\nof the cyclic group of the nth roots of unity.",
    "Let α be a zero of xn −a.",
    "Since α and ωα\nare both in the splitting field of xn −a, ω = (ωα)/α is also in E. Let K = F(ω).",
    "Then\nF ⊂K ⊂E.\nSince K is the splitting field of xn −1, K is a normal extension of F.\nTherefore, any automorphism σ in G(F(ω)/F) is determined by σ(ω).",
    "It must be the case\nthat σ(ω) = ωi for some integer i since all of the zeros of xn−1 are powers of ω.",
    "If τ(ω) = ωj\nis in G(F(ω)/F), then\nστ(ω) = σ(ωj) =",
    "[σ(ω)]j = ωij =",
    "[τ(ω)]i = τ(ωi) = τσ(ω).\n",
    "Therefore, G(F(ω)/F) is abelian.",
    "By the Fundamental Theorem of Galois Theory the series\n{id} ⊂G(E/F(ω))",
    "⊂G(E/F)\nis a normal series.",
    "By our previous argument, G(E/F(ω)) is abelian.",
    "Since\nG(E/F)/G(E/F(ω)) ∼= G(F(ω)/F)\nis also abelian, G(E/F) is solvable.\n",
    "■\nLemma 23.29 Let F be a field of characteristic zero and let\nF = F0 ⊂F1 ⊂F2 ⊂· · · ⊂Fr = E\na radical extension of F. Then there exists a normal radical extension\nF = K0 ⊂K1 ⊂K2 ⊂· · · ⊂Kr = K\nsuch that K that contains E and Ki is a normal extension of Ki−1.\nProof.",
    "Since E is a radical extension of F, there exists a chain of subfields\nF = F0 ⊂F1 ⊂F2 ⊂· · · ⊂Fr = E\nsuch for i = 1, 2, . .",
    ".",
    ", r, we have Fi = Fi−1(αi) and αni\ni\n∈Fi−1 for some positive integer ni.\n",
    "We will build a normal radical extension of F,\nF = K0 ⊂K1 ⊂K2 ⊂· · · ⊂Kr = K\n\nCHAPTER 23.",
    "GALOIS THEORY\n305\nsuch that K ⊇E. Define K1 for be the splitting field of xn1 −αn1\n1 .",
    "The roots of this\npolynomial are α1, α1ω, α1ω2, . . .",
    ", α1ωn1−1, where ω is a primitive n1th root of unity.",
    "If F\ncontains all of its n1 roots of unity, then K1 = F(α1).",
    "On the other hand, suppose that\nF does not contain a primitive n1th root of unity.",
    "If β is a root of xn1 −αn1\n1 , then all of\nthe roots of xn1 −αn1\n1\nmust be β, ωβ, . . .",
    ", ωn1−1, where ω is a primitive n1th root of unity.\n",
    "In this case, K1 = F(ωβ).",
    "Thus, K1 is a normal radical extension of F containing F1.\n",
    "Continuing in this manner, we obtain\nF = K0 ⊂K1 ⊂K2 ⊂· · ·",
    "⊂Kr = K\nsuch that Ki is a normal extension of Ki−1 and Ki ⊇Fi for i = 1, 2, . .",
    ". , r.\n■\nWe will now prove the main theorem about solvability by radicals.\n",
    "Theorem 23.30 Let f(x) be in F[x], where char F = 0.",
    "If f(x) is solvable by radicals,\nthen the Galois group of f(x) over F is solvable.\nProof.\n",
    "Since f(x) is solvable by radicals there exists an extension E of F by radicals\nF = F0 ⊂F1 ⊂· · ·",
    "⊂Fn = E. By Lemma 23.29, we can assume that E is a splitting field\nf(x) and Fi is normal over Fi−1.",
    "By the Fundamental Theorem of Galois Theory, G(E/Fi)\nis a normal subgroup of G(E/Fi−1).",
    "Therefore, we have a subnormal series of subgroups of\nG(E/F):\n{id} ⊂G(E/Fn−1) ⊂· · · ⊂G(E/F1)",
    "⊂G(E/F).\n",
    "Again by the Fundamental Theorem of Galois Theory, we know that\nG(E/Fi−1)/G(E/Fi) ∼= G(Fi/Fi−1).\n",
    "By Lemma 23.28, G(Fi/Fi−1) is solvable; hence, G(E/F) is also solvable.\n",
    "■\nThe converse of Theorem 23.30 is also true.",
    "For a proof, see any of the references at the\nend of this chapter.\n",
    "Insolvability of the Quintic\nWe are now in a position to find a fifth-degree polynomial that is not solvable by radicals.\n",
    "We merely need to find a polynomial whose Galois group is S5.",
    "We begin by proving a\nlemma.\n",
    "Lemma 23.31 If p is prime, then any subgroup of Sp that contains a transposition and a\ncycle of length p must be all of Sp.\nProof.",
    "Let G be a subgroup of Sp that contains a transposition σ and τ",
    "a cycle of length\n",
    "p.",
    "We may assume that σ = (1 2).",
    "The order of τ is p and τ n must be a cycle of length p for\n1 ≤n < p.",
    "Therefore, we may assume that µ = τ n = (1, 2, i3, . . .",
    ", ip) for some n, where 1 ≤\nn < p (see Exercise 5.4.13 in Chapter 5).",
    "Noting that (1 2)(1, 2, i3, . .",
    ".",
    ", ip) = (2, i3, . . .",
    ", ip)\nand (2, i3, . .",
    ".",
    ", ip)k(1 2)(2, i3, . .",
    ".",
    ", ip)−k = (1 ik), we can obtain all the transpositions of the\nform (1n) for 1 ≤n <",
    "p.",
    "However, these transpositions generate all transpositions in Sp,\nsince (1 j)(1 i)(1 j) = (i j).",
    "The transpositions generate Sp.\n■\n\nCHAPTER 23.",
    "GALOIS THEORY\n306\n-3\n-2\n-1\n1\n2\n3\nx\n-60\n-40\n-20\n20\n40\n60\ny\nf(x)",
    "=x5 −6x3",
    "−27x−3\nFigure 23.32",
    "The graph of f(x) = x5 −6x3",
    "−27x −3\nExample 23.33 We will show that f(x) = x5−6x3−27x−3 ∈Q[x] is not solvable.",
    "We claim\nthat the Galois group of f(x) over Q is S5.",
    "By Eisenstein’s Criterion, f(x) is irreducible\nand, therefore, must be separable.",
    "The derivative of f(x) is f′(x) = 5x4 −18x2 −27; hence,\nsetting f′(x) = 0 and solving, we find that the only real roots of f′(x) are\nx = ±\ns\n6\n√\n6 + 9\n5\n.\n",
    "Therefore, f(x) can have at most one maximum and one minimum.",
    "It is easy to show that\nf(x) changes sign between −3 and −2, between −2 and 0, and once again between 0 and\n4 (Figure 23.32).",
    "Therefore, f(x) has exactly three distinct real roots.",
    "The remaining two\nroots of f(x) must be complex conjugates.",
    "Let K be the splitting field of f(x).",
    "Since f(x)\nhas five distinct roots in K and every automorphism of K fixing Q is determined by the\nway it permutes the roots of f(x), we know that G(K/Q) is a subgroup of S5.",
    "Since f is\nirreducible, there is an element in σ ∈G(K/Q) such that σ(a) = b for two roots a and b\nof f(x).",
    "The automorphism of C that takes a + bi 7→a −bi leaves the real roots fixed and\ninterchanges the complex roots; consequently, G(K/Q) contains a transposition.",
    "If α is one\nof the real roots of f(x), then [Q(α) : Q] = 5 by Exercise 21.5.28.",
    "Since Q(α) is a subfield\nof K, it must be the case that [K : Q] is divisible by 5.",
    "Since [K : Q] = |G(K/Q)| and\nG(K/Q) ⊂S5, we know that G(K/Q) contains a cycle of length 5.",
    "By Lemma 23.31, S5 is\ngenerated by a transposition and an element of order 5; therefore, G(K/Q) must be all of\n\nCHAPTER 23.",
    "GALOIS THEORY\n307\nS5.",
    "By Theorem 10.11, S5 is not solvable.",
    "Consequently, f(x) cannot be solved by radicals.\n",
    "□\nThe Fundamental Theorem of Algebra\nIt seems fitting that the last theorem that we will state and prove is the Fundamental\nTheorem of Algebra.",
    "This theorem was first proven by Gauss in his doctoral thesis.",
    "Prior\nto Gauss’s proof, mathematicians suspected that there might exist polynomials over the real\nand complex numbers having no solutions.",
    "The Fundamental Theorem of Algebra states\nthat every polynomial over the complex numbers factors into distinct linear factors.\n",
    "Theorem 23.34 Fundamental Theorem of Algebra.",
    "The field of complex numbers is\nalgebraically closed; that is, every polynomial in C[x] has a root in C.\nProof.",
    "Suppose that E is a proper finite field extension of the complex numbers.",
    "Since\nany finite extension of a field of characteristic zero is a simple extension, there exists an\nα ∈E such that",
    "E = C(α) with α the root of an irreducible polynomial f(x) in C[x].",
    "The\nsplitting field L of f(x) is a finite normal separable extension of C that contains E. We\nmust show that it is impossible for L to be a proper extension of C.\nSuppose that L is a proper extension of C. Since L is the splitting field of f(x)",
    "= (x2+1)\nover R, L is a finite normal separable extension of R. Let K be the fixed field of a Sylow\n2-subgroup G of G(L/R).",
    "Then L ⊃K ⊃R and |G(L/K)| =",
    "[L : K].",
    "Since [L : R] =",
    "[L :\nK][K : R], we know that [K : R] must be odd.",
    "Consequently, K = R(β) with β having a\nminimal polynomial f(x) of odd degree.",
    "Therefore, K = R.\nWe now know that G(L/R) must be a 2-group.",
    "It follows that G(L/C) is a 2-group.",
    "We\nhave assumed that L ̸= C; therefore, |G(L/C)| ≥2.",
    "By the first Sylow Theorem and the\nFundamental Theorem of Galois Theory, there exists a subgroup G of G(L/C) of index 2\nand a field E fixed elementwise by G.",
    "Then [E : C] = 2 and there exists an element γ ∈E\nwith minimal polynomial x2 + bx + c in C[x].",
    "This polynomial has roots (−b ±\n√\nb2 −4c )/2\n",
    "that are in C, since b2 −4c is in C.",
    "This is impossible; hence, L = C.\n■\nAlthough our proof was strictly algebraic, we were forced to rely on results from cal-\nculus.",
    "It is necessary to assume the completeness axiom from analysis to show that every\npolynomial of odd degree has a real root and that every positive real number has a square\nroot.",
    "It seems that there is no possible way to avoid this diﬀiculty and formulate a purely\nalgebraic argument.",
    "It is somewhat amazing that there are several elegant proofs of the\nFundamental Theorem of Algebra that use complex analysis.",
    "It is also interesting to note\nthat we can obtain a proof of such an important theorem from two very different fields of\nmathematics.\n",
    "Sage.\n",
    "Fields, field extensions, roots of polynomials, and group theory —",
    "Sage has it all,\nand so it is possible to carefully study very complicated examples from Galois Theory with\nSage.\n",
    "23.4 Reading Questions\n1.\n",
    "What is the Galois group of a field extension?\n2.\n",
    "When are two elements of a field extension conjugate?",
    "(In other words, what is the\ndefinition?)\n",
    "3.\nSummarize the nature and importance of the Fundamental Theorem of Galois Theory.\n",
    "Capture the essence of the result without getting bogged down in too many details.\n\n",
    "CHAPTER 23.",
    "GALOIS THEORY\n308\n4.\n",
    "Why are “solvable” groups so named?",
    "Paraphrasing the relevant theorem would be a\ngood answer.\n",
    "5.\nArgue the following statement, both pro and con.",
    "Which side wins the debate?\nEverything we have done in this entire course has been in preparation for\nthis chapter.\n",
    "23.5 Exercises\n1.\nCompute each of the following Galois groups.\n",
    "Which of these field extensions are\nnormal field extensions?",
    "If the extension is not normal, find a normal extension of Q\nin which the extension field is contained.\n",
    "(a) G(Q(\n√\n30 )/Q)\n(b) G(Q(\n4√\n5 )/Q)\n(c) G(Q(\n√\n2,\n√\n3,\n√\n5 )/Q)\n(d) G(Q(\n√\n2,\n3√\n2, i)/Q)\n(e) G(Q(\n√\n6, i)/Q)\n2.\nDetermine the separability of each of the following polynomials.\n",
    "(a) x3 + 2x2 −x −2 over Q\n(b) x4 + 2x2",
    "+ 1 over Q\n(c) x4",
    "+ x2",
    "+ 1 over Z3\n(d) x3 + x2",
    "+ 1 over Z2\n3.\nGive the order and describe a generator of the Galois group of GF(729) over GF(9).\n",
    "4.\nDetermine the Galois groups of each of the following polynomials in Q[x]; hence, de-\ntermine the solvability by radicals of each of the polynomials.\n",
    "(a) x5 −12x2",
    "+ 2\n(b) x5 −4x4 + 2x + 2\n(c) x3 −5\n(d) x4 −x2 −6\n(e) x5 + 1\n(f) (x2 −2)(x2 + 2)\n(g) x8 −1\n(h) x8 + 1\n(i) x4 −3x2",
    "−10\n5.\nFind a primitive element in the splitting field of each of the following polynomials in\nQ[x].\n(a) x4 −1\n(b) x4 −8x2",
    "+ 15\n(c) x4 −2x2",
    "−15\n(d) x3 −2\n6.\nProve that the Galois group of an irreducible quadratic polynomial is isomorphic to\nZ2.\n",
    "7.\nProve that the Galois group of an irreducible cubic polynomial is isomorphic to S3 or\nZ3.\n",
    "8.\nLet F ⊂K ⊂E be fields.",
    "If E is a normal extension of F, show that E must also be\na normal extension of K.\n9.\nLet G be the Galois group of a polynomial of degree",
    "n. Prove that |G| divides n!.\n",
    "10.",
    "Let F ⊂E. If f(x) is solvable over F, show that f(x) is also solvable over E.\n11.",
    "Construct a polynomial f(x) in Q[x] of degree 7 that is not solvable by radicals.\n12.",
    "Let p be prime.",
    "Prove that there exists a polynomial f(x) ∈Q[x] of degree p with\nGalois group isomorphic to Sp.",
    "Conclude that for each prime p with p ≥5 there exists\na polynomial of degree p that is not solvable by radicals.\n",
    "13.",
    "Let p be a prime and Zp(t) be the field of rational functions over Zp.\n",
    "Prove that\nf(x)",
    "= xp −t is an irreducible polynomial in Zp(t)[x].",
    "Show that f(x) is not separable.\n\n",
    "CHAPTER 23.",
    "GALOIS THEORY\n309\n14.",
    "Let E be an extension field of F. Suppose that K and L are two intermediate fields.\n",
    "If there exists an element σ ∈G(E/F) such that σ(K) = L, then K and L are said\nto be conjugate fields.",
    "Prove that K and L are conjugate if and only if G(E/K) and\nG(E/L) are conjugate subgroups of G(E/F).\n",
    "15.",
    "Let σ ∈Aut(R).",
    "If a is a positive real number, show that σ(a) > 0.\n16.",
    "Let K be the splitting field of x3 + x2 + 1 ∈Z2[x].",
    "Prove or disprove that K is an\nextension by radicals.\n",
    "17.",
    "Let F be a field such that char(F) ̸= 2.\n",
    "Prove that the splitting field of f(x) =\nax2 + bx",
    "+ c is F(√α ), where α = b2 −4ac.\n",
    "18. Prove or disprove: Two different subgroups of a Galois group will have different fixed\nfields.\n",
    "19.",
    "Let K be the splitting field of a polynomial over F. If E is a field extension of F\ncontained in K and [E : F] = 2, then E is the splitting field of some polynomial in\nF[x].\n20.",
    "We know that the cyclotomic polynomial\nΦp(x) = xp −1\nx −1 = xp−1 + xp−2 + · · ·",
    "+ x",
    "+ 1\nis irreducible over Q for every prime p. Let ω be a zero of Φp(x), and consider the field\nQ(ω).\n",
    "(a) Show that ω, ω2, . .",
    ".",
    ", ωp−1 are distinct zeros of Φp(x), and conclude that they are\nall the zeros of Φp(x).\n",
    "(b) Show that G(Q(ω)/Q) is abelian of order p −1.\n",
    "(c) Show that the fixed field of G(Q(ω)/Q) is Q.\n21.",
    "Let F be a finite field or a field of characteristic zero.\n",
    "Let E be a finite normal\nextension of F with Galois group G(E/F).",
    "Prove that F ⊂K ⊂L ⊂E if and only if\n{id} ⊂G(E/L) ⊂G(E/K) ⊂G(E/F).\n",
    "22.",
    "Let F be a field of characteristic zero and let f(x) ∈F[x] be a separable polynomial\nof degree n.",
    "If E is the splitting field of f(x), let α1, . .",
    ".",
    ", αn be the roots of f(x) in E.\nLet ∆= Q\ni<j(αi −αj).",
    "We define the discriminant of f(x) to be ∆2.\n(a) If f(x) = x2 + bx + c, show that ∆2 = b2 −4c.\n(b) If f(x) = x3 + px + q, show that ∆2 = −4p3 −27q2.\n(c) Prove that ∆2 is in F.\n(d)",
    "If σ ∈G(E/F) is a transposition of two roots of f(x), show that σ(∆) = −∆.\n(e) If σ ∈G(E/F) is an even permutation of the roots of f(x), show that σ(∆) = ∆.\n(f) Prove that G(E/F) is isomorphic to a subgroup of An if and only if ∆∈F.\n(g) Determine the Galois groups of x3 + 2x −4 and x3 + x −3.\n23.6 References and Suggested Readings\n[1]\nArtin, E. Theory:",
    "Lectures Delivered at the University of Notre Dame (Notre Dame\nMathematical Lectures, Number 2).",
    "Dover, Mineola, NY, 1997.\n\n",
    "CHAPTER 23.",
    "GALOIS THEORY\n310\n[2]\nEdwards, H. M. Galois Theory.",
    "Springer-Verlag, New York, 1984.\n",
    "[3]\nFraleigh, J. B. A First Course in Abstract Algebra.",
    "7th ed.",
    "Pearson, Upper Saddle\nRiver, NJ, 2003.\n",
    "[4]\nGaal, L. Classical Galois Theory with Examples.\n",
    "American Mathematical Society,\nProvidence, 1979.\n",
    "[5]\nGarling, D. J. H. A Course in Galois Theory.",
    "Cambridge University Press, Cambridge,\n1986.\n",
    "[6]\nKaplansky, I. Fields and Rings.",
    "2nd ed.",
    "University of Chicago Press, Chicago, 1972.\n",
    "[7]\nRothman, T. “The Short Life of Évariste Galois,” Scientific American, April 1982,\n136–49.\n\n",
    "A\nGNU Free Documentation License\nVersion 1.3, 3 November 2008\nCopyright © 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc.",
    "<www.fsf.org>\nEveryone is permitted to copy and distribute verbatim copies of this license document,\nbut changing it is not allowed.\n0. PREAMBLE.\n",
    "The purpose of this License is to make a manual, textbook, or other\nfunctional and useful document “free” in the sense of freedom: to assure everyone the effec-\ntive freedom to copy and redistribute it, with or without modifying it, either commercially\nor noncommercially.",
    "Secondarily, this License preserves for the author and publisher a way\nto get credit for their work, while not being considered responsible for modifications made\nby others.\n",
    "This License is a kind of “copyleft”, which means that derivative works of the document\nmust themselves be free in the same sense.",
    "It complements the GNU General Public License,\nwhich is a copyleft license designed for free software.\n",
    "We have designed this License in order to use it for manuals for free software, because free\nsoftware needs free documentation: a free program should come with manuals providing the\nsame freedoms that the software does.",
    "But this License is not limited to software manuals;\nit can be used for any textual work, regardless of subject matter or whether it is published\nas a printed book.\n",
    "We recommend this License principally for works whose purpose is\ninstruction or reference.\n",
    "1. APPLICABILITY AND DEFINITIONS.\n",
    "This License applies to any manual or\nother work, in any medium, that contains a notice placed by the copyright holder saying\nit can be distributed under the terms of this License.",
    "Such a notice grants a world-wide,\nroyalty-free license, unlimited in duration, to use that work under the conditions stated\nherein.",
    "The “Document”, below, refers to any such manual or work.",
    "Any member of the\npublic is a licensee, and is addressed as “you”.",
    "You accept the license if you copy, modify\nor distribute the work in a way requiring permission under copyright law.\n",
    "A “Modified Version” of the Document means any work containing the Document or a\nportion of it, either copied verbatim, or with modifications and/or translated into another\nlanguage.\n",
    "A “Secondary Section” is a named appendix or a front-matter section of the Document\nthat deals exclusively with the relationship of the publishers or authors of the Document\nto the Document’s overall subject (or to related matters) and contains nothing that could\nfall directly within that overall subject.",
    "(Thus, if the Document is in part a textbook of\nmathematics, a Secondary Section may not explain any mathematics.)",
    "The relationship\n311\n\nAPPENDIX A. GNU FREE DOCUMENTATION LICENSE\n312\ncould be a matter of historical connection with the subject or with related matters, or of\nlegal, commercial, philosophical, ethical or political position regarding them.\n",
    "The “Invariant Sections” are certain Secondary Sections whose titles are designated, as\nbeing those of Invariant Sections, in the notice that says that the Document is released\nunder this License.",
    "If a section does not fit the above definition of Secondary then it is not\nallowed to be designated as Invariant.",
    "The Document may contain zero Invariant Sections.\n",
    "If the Document does not identify any Invariant Sections then there are none.\n",
    "The “Cover Texts” are certain short passages of text that are listed, as Front-Cover\nTexts or Back-Cover Texts, in the notice that says that the Document is released under this\nLicense.",
    "A Front-Cover Text may be at most 5 words, and a Back-Cover Text may be at\nmost 25 words.\n",
    "A “Transparent” copy of the Document means a machine-readable copy, represented in\na format whose specification is available to the general public, that is suitable for revising\nthe document straightforwardly with generic text editors or (for images composed of pixels)\ngeneric paint programs or (for drawings) some widely available drawing editor, and that is\nsuitable for input to text formatters or for automatic translation to a variety of formats\nsuitable for input to text formatters.",
    "A copy made in an otherwise Transparent file format\nwhose markup, or absence of markup, has been arranged to thwart or discourage subsequent\nmodification by readers is not Transparent.",
    "An image format is not Transparent if used for\nany substantial amount of text.",
    "A copy that is not “Transparent” is called “Opaque”.\n",
    "Examples of suitable formats for Transparent copies include plain ASCII without markup,\nTexinfo input format, LaTeX input format, SGML or XML using a publicly available DTD,\nand standard-conforming simple HTML, PostScript or PDF designed for human modifica-\ntion.",
    "Examples of transparent image formats include PNG, XCF and JPG.",
    "Opaque formats\ninclude proprietary formats that can be read and edited only by proprietary word proces-\nsors, SGML or XML for which the DTD and/or processing tools are not generally available,\nand the machine-generated HTML, PostScript or PDF produced by some word processors\nfor output purposes only.\n",
    "The “Title Page” means, for a printed book, the title page itself, plus such following\npages as are needed to hold, legibly, the material this License requires to appear in the title\npage.",
    "For works in formats which do not have any title page as such, “Title Page” means\nthe text near the most prominent appearance of the work’s title, preceding the beginning\nof the body of the text.\n",
    "The “publisher” means any person or entity that distributes copies of the Document to\nthe public.\n",
    "A section “Entitled XYZ” means a named subunit of the Document whose title either\nis precisely XYZ or contains XYZ in parentheses following text that translates XYZ in\nanother language.",
    "(Here XYZ stands for a specific section name mentioned below, such\nas “Acknowledgements”, “Dedications”, “Endorsements”, or “History”.)",
    "To “Preserve the\nTitle” of such a section when you modify the Document means that it remains a section\n“Entitled XYZ” according to this definition.\n",
    "The Document may include Warranty Disclaimers next to the notice which states that\nthis License applies to the Document.",
    "These Warranty Disclaimers are considered to be\nincluded by reference in this License, but only as regards disclaiming warranties: any other\nimplication that these Warranty Disclaimers may have is void and has no effect on the\nmeaning of this License.\n",
    "2.\nVERBATIM COPYING.\n",
    "You may copy and distribute the Document in any\nmedium, either commercially or noncommercially, provided that this License, the copyright\nnotices, and the license notice saying this License applies to the Document are reproduced\n\nAPPENDIX A. GNU FREE DOCUMENTATION LICENSE\n313\nin all copies, and that you add no other conditions whatsoever to those of this License.",
    "You\nmay not use technical measures to obstruct or control the reading or further copying of\nthe copies you make or distribute.",
    "However, you may accept compensation in exchange for\ncopies.",
    "If you distribute a large enough number of copies you must also follow the conditions\nin section 3.\n",
    "You may also lend copies, under the same conditions stated above, and you may publicly\ndisplay copies.\n",
    "3.\nCOPYING IN QUANTITY.\n",
    "If you publish printed copies (or copies in media\nthat commonly have printed covers) of the Document, numbering more than 100, and the\nDocument’s license notice requires Cover Texts, you must enclose the copies in covers that\ncarry, clearly and legibly, all these Cover Texts: Front-Cover Texts on the front cover, and\nBack-Cover Texts on the back cover.",
    "Both covers must also clearly and legibly identify you\nas the publisher of these copies.",
    "The front cover must present the full title with all words\nof the title equally prominent and visible.",
    "You may add other material on the covers in\naddition.",
    "Copying with changes limited to the covers, as long as they preserve the title of\nthe Document and satisfy these conditions, can be treated as verbatim copying in other\nrespects.\n",
    "If the required texts for either cover are too voluminous to fit legibly, you should put\nthe first ones listed (as many as fit reasonably) on the actual cover, and continue the rest\nonto adjacent pages.\n",
    "If you publish or distribute Opaque copies of the Document numbering more than 100,\nyou must either include a machine-readable Transparent copy along with each Opaque copy,\nor state in or with each Opaque copy a computer-network location from which the general\nnetwork-using public has access to download using public-standard network protocols a\ncomplete Transparent copy of the Document, free of added material.",
    "If you use the latter\noption, you must take reasonably prudent steps, when you begin distribution of Opaque\ncopies in quantity, to ensure that this Transparent copy will remain thus accessible at the\nstated location until at least one year after the last time you distribute an Opaque copy\n(directly or through your agents or retailers) of that edition to the public.\n",
    "It is requested, but not required, that you contact the authors of the Document well\nbefore redistributing any large number of copies, to give them a chance to provide you with\nan updated version of the Document.\n",
    "4. MODIFICATIONS.\n",
    "You may copy and distribute a Modified Version of the Docu-\nment under the conditions of sections 2 and 3 above, provided that you release the Modified\nVersion under precisely this License, with the Modified Version filling the role of the Doc-\nument, thus licensing distribution and modification of the Modified Version to whoever\npossesses a copy of it.",
    "In addition, you must do these things in the Modified Version:\nA. Use in the Title Page (and on the covers, if any) a title distinct from that of the\nDocument, and from those of previous versions (which should, if there were any, be\nlisted in the History section of the Document).\n",
    "You may use the same title as a\nprevious version if the original publisher of that version gives permission.\n",
    "B. List on the Title Page, as authors, one or more persons or entities responsible for\nauthorship of the modifications in the Modified Version, together with at least five\nof the principal authors of the Document (all of its principal authors, if it has fewer\nthan five), unless they release you from this requirement.\n",
    "C. State on the Title page the name of the publisher of the Modified Version, as the\npublisher.\n\n",
    "APPENDIX A. GNU FREE DOCUMENTATION LICENSE\n314\nD. Preserve all the copyright notices of the Document.\n",
    "E. Add an appropriate copyright notice for your modifications adjacent to the other\ncopyright notices.\n",
    "F. Include, immediately after the copyright notices, a license notice giving the public\npermission to use the Modified Version under the terms of this License, in the form\nshown in the Addendum below.\n",
    "G. Preserve in that license notice the full lists of Invariant Sections and required Cover\nTexts given in the Document’s license notice.\n",
    "H. Include an unaltered copy of this License.\n",
    "I. Preserve the section Entitled “History”, Preserve its Title, and add to it an item\nstating at least the title, year, new authors, and publisher of the Modified Version as\ngiven on the Title Page.",
    "If there is no section Entitled “History” in the Document,\ncreate one stating the title, year, authors, and publisher of the Document as given\non its Title Page, then add an item describing the Modified Version as stated in the\nprevious sentence.\n",
    "J. Preserve the network location, if any, given in the Document for public access to a\nTransparent copy of the Document, and likewise the network locations given in the\nDocument for previous versions it was based on.",
    "These may be placed in the “History”\nsection.",
    "You may omit a network location for a work that was published at least four\nyears before the Document itself, or if the original publisher of the version it refers to\ngives permission.\n",
    "K.",
    "For any section Entitled “Acknowledgements” or “Dedications”, Preserve the Title\nof the section, and preserve in the section all the substance and tone of each of the\ncontributor acknowledgements and/or dedications given therein.\n",
    "L. Preserve all the Invariant Sections of the Document, unaltered in their text and in\ntheir titles.",
    "Section numbers or the equivalent are not considered part of the section\ntitles.\n",
    "M. Delete any section Entitled “Endorsements”.",
    "Such a section may not be included in\nthe Modified Version.\n",
    "N. Do not retitle any existing section to be Entitled “Endorsements” or to conflict in title\nwith any Invariant Section.\n",
    "O. Preserve any Warranty Disclaimers.\n",
    "If the Modified Version includes new front-matter sections or appendices that qualify as\nSecondary Sections and contain no material copied from the Document, you may at your\noption designate some or all of these sections as invariant.",
    "To do this, add their titles to\nthe list of Invariant Sections in the Modified Version’s license notice.",
    "These titles must be\ndistinct from any other section titles.\n",
    "You may add a section Entitled “Endorsements”, provided it contains nothing but en-\ndorsements of your Modified Version by various parties — for example, statements of peer\nreview or that the text has been approved by an organization as the authoritative definition\nof a standard.\n",
    "You may add a passage of up to five words as a Front-Cover Text, and a passage of up\nto 25 words as a Back-Cover Text, to the end of the list of Cover Texts in the Modified\n\nAPPENDIX A. GNU FREE DOCUMENTATION LICENSE\n315\nVersion.",
    "Only one passage of Front-Cover Text and one of Back-Cover Text may be added\nby (or through arrangements made by) any one entity.",
    "If the Document already includes\na cover text for the same cover, previously added by you or by arrangement made by the\nsame entity you are acting on behalf of, you may not add another; but you may replace the\nold one, on explicit permission from the previous publisher that added the old one.\n",
    "The author(s) and publisher(s) of the Document do not by this License give permission\nto use their names for publicity for or to assert or imply endorsement of any Modified\nVersion.\n",
    "5.",
    "COMBINING DOCUMENTS.\n",
    "You may combine the Document with other docu-\nments released under this License, under the terms defined in section 4 above for modified\nversions, provided that you include in the combination all of the Invariant Sections of all of\nthe original documents, unmodified, and list them all as Invariant Sections of your combined\nwork in its license notice, and that you preserve all their Warranty Disclaimers.\n",
    "The combined work need only contain one copy of this License, and multiple identical\nInvariant Sections may be replaced with a single copy.\n",
    "If there are multiple Invariant\nSections with the same name but different contents, make the title of each such section\nunique by adding at the end of it, in parentheses, the name of the original author or\npublisher of that section if known, or else a unique number.",
    "Make the same adjustment to\nthe section titles in the list of Invariant Sections in the license notice of the combined work.\n",
    "In the combination, you must combine any sections Entitled “History” in the various\noriginal documents, forming one section Entitled “History”; likewise combine any sections\nEntitled “Acknowledgements”, and any sections Entitled “Dedications”.",
    "You must delete\nall sections Entitled “Endorsements”.\n",
    "6.\nCOLLECTIONS OF DOCUMENTS.\n",
    "You may make a collection consisting of\nthe Document and other documents released under this License, and replace the individual\ncopies of this License in the various documents with a single copy that is included in the\ncollection, provided that you follow the rules of this License for verbatim copying of each\nof the documents in all other respects.\n",
    "You may extract a single document from such a collection, and distribute it individually\nunder this License, provided you insert a copy of this License into the extracted document,\nand follow this License in all other respects regarding verbatim copying of that document.\n",
    "7.\nAGGREGATION WITH INDEPENDENT WORKS.\n",
    "A compilation of the\nDocument or its derivatives with other separate and independent documents or works, in or\non a volume of a storage or distribution medium, is called an “aggregate” if the copyright\nresulting from the compilation is not used to limit the legal rights of the compilation’s users\nbeyond what the individual works permit.",
    "When the Document is included in an aggregate,\nthis License does not apply to the other works in the aggregate which are not themselves\nderivative works of the Document.\n",
    "If the Cover Text requirement of section 3 is applicable to these copies of the Document,\nthen if the Document is less than one half of the entire aggregate, the Document’s Cover\nTexts may be placed on covers that bracket the Document within the aggregate, or the\nelectronic equivalent of covers if the Document is in electronic form.",
    "Otherwise they must\nappear on printed covers that bracket the whole aggregate.\n",
    "8.\nTRANSLATION.\n",
    "Translation is considered a kind of modification, so you may\ndistribute translations of the Document under the terms of section 4.",
    "Replacing Invariant\nSections with translations requires special permission from their copyright holders, but\n\nAPPENDIX A. GNU FREE DOCUMENTATION LICENSE\n316\nyou may include translations of some or all Invariant Sections in addition to the original\nversions of these Invariant Sections.",
    "You may include a translation of this License, and all\nthe license notices in the Document, and any Warranty Disclaimers, provided that you also\ninclude the original English version of this License and the original versions of those notices\nand disclaimers.",
    "In case of a disagreement between the translation and the original version\nof this License or a notice or disclaimer, the original version will prevail.\n",
    "If a section in the Document is Entitled “Acknowledgements”, “Dedications”, or “His-\ntory”, the requirement (section 4) to Preserve its Title (section 1) will typically require\nchanging the actual title.\n",
    "9.",
    "TERMINATION.\n",
    "You may not copy, modify, sublicense, or distribute the Document\nexcept as expressly provided under this License.",
    "Any attempt otherwise to copy, modify,\nsublicense, or distribute it is void, and will automatically terminate your rights under this\nLicense.\n",
    "However, if you cease all violation of this License, then your license from a particular\ncopyright holder is reinstated (a) provisionally, unless and until the copyright holder explic-\nitly and finally terminates your license, and (b) permanently, if the copyright holder fails to\nnotify you of the violation by some reasonable means prior to 60 days after the cessation.\n",
    "Moreover, your license from a particular copyright holder is reinstated permanently if\nthe copyright holder notifies you of the violation by some reasonable means, this is the first\ntime you have received notice of violation of this License (for any work) from that copyright\nholder, and you cure the violation prior to 30 days after your receipt of the notice.\n",
    "Termination of your rights under this section does not terminate the licenses of parties\nwho have received copies or rights from you under this License.",
    "If your rights have been\nterminated and not permanently reinstated, receipt of a copy of some or all of the same\nmaterial does not give you any rights to use it.\n",
    "10.",
    "FUTURE REVISIONS OF THIS LICENSE.\n",
    "The Free Software Foundation\nmay publish new, revised versions of the GNU Free Documentation License from time to\ntime.",
    "Such new versions will be similar in spirit to the present version, but may differ in\ndetail to address new problems or concerns.",
    "See www.gnu.org/copyleft.\n",
    "Each version of the License is given a distinguishing version number.",
    "If the Document\nspecifies that a particular numbered version of this License “or any later version” applies\nto it, you have the option of following the terms and conditions either of that specified\nversion or of any later version that has been published (not as a draft) by the Free Software\nFoundation.",
    "If the Document does not specify a version number of this License, you may\nchoose any version ever published (not as a draft) by the Free Software Foundation.",
    "If the\nDocument specifies that a proxy can decide which future versions of this License can be\nused, that proxy’s public statement of acceptance of a version permanently authorizes you\nto choose that version for the Document.\n",
    "11.",
    "RELICENSING.\n",
    "“Massive Multiauthor Collaboration Site” (or “MMC Site”) means\nany World Wide Web server that publishes copyrightable works and also provides promi-\nnent facilities for anybody to edit those works.",
    "A public wiki that anybody can edit is an\nexample of such a server.",
    "A “Massive Multiauthor Collaboration” (or “MMC”) contained\nin the site means any set of copyrightable works thus published on the MMC site.\n",
    "“CC-BY-SA” means the Creative Commons Attribution-Share Alike 3.0 license pub-\nlished by Creative Commons Corporation, a not-for-profit corporation with a principal\nplace of business in San Francisco, California, as well as future copyleft versions of that\nlicense published by that same organization.\n\n",
    "APPENDIX A. GNU FREE DOCUMENTATION LICENSE\n317\n“Incorporate” means to publish or republish a Document, in whole or in part, as part\nof another Document.\n",
    "An MMC is “eligible for relicensing” if it is licensed under this License, and if all works\nthat were first published under this License somewhere other than this MMC, and subse-\nquently incorporated in whole or in part into the MMC, (1) had no cover texts or invariant\nsections, and (2) were thus incorporated prior to November 1, 2008.\n",
    "The operator of an MMC Site may republish an MMC contained in the site under CC-\nBY-SA on the same site at any time before August 1, 2009, provided the MMC is eligible\nfor relicensing.\n",
    "ADDENDUM: How to use this License for your documents.\n",
    "To use this License\nin a document you have written, include a copy of the License in the document and put the\nfollowing copyright and license notices just after the title page:\nCopyright (C)\nYEAR\nYOUR NAME.\n",
    "Permission is granted to copy, distribute and/or modify this document\nunder the terms of the GNU Free Documentation License, Version 1.3\nor any later version published by the Free Software Foundation;\nwith no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.\n",
    "A copy of the license is included in the section entitled \"GNU\nFree Documentation License\".\n",
    "If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts, replace the “with…\nTexts.”",
    "line with this:\nwith the Invariant Sections being LIST THEIR TITLES, with the\nFront-Cover Texts being LIST, and with the Back-Cover Texts being LIST.\n",
    "If you have Invariant Sections without Cover Texts, or some other combination of the three,\nmerge those two alternatives to suit the situation.\n",
    "If your document contains nontrivial examples of program code, we recommend releasing\nthese examples in parallel under your choice of free software license, such as the GNU\nGeneral Public License, to permit their use in free software.\n\n",
    "B\nHints and Answers to Selected Exercises\n1 · Preliminaries\n1.4 ·",
    "Exercises\n1.4.1.\nHint.\n",
    "(a) A ∩B = {2}; (b) B ∩C = {5}.\n",
    "1.4.2.\n",
    "Hint.\n",
    "(a) A×B = {(a, 1), (a, 2), (a, 3), (b, 1), (b, 2), (b, 3), (c, 1), (c, 2), (c, 3)}; (d) A×D = ∅.\n1.4.6.\n",
    "Hint.\nObserve that x ∈A ∪B if and only if x ∈A or x ∈B. Equivalently, x ∈B or\nx ∈A, which is the same as x ∈B ∪A. Therefore, A ∪B = B ∪A.\n1.4.10.\n",
    "Hint.\n",
    "(A∩B)∪(A\\B)∪(B\\A) = (A∩B)∪(A∩B′)∪(B∩A′) =",
    "[A∩(B∪B′)]∪(B∩A′) =\nA ∪(B ∩A′) = (A ∪B) ∩(A ∪A′) = A ∪B.\n1.4.14.\n",
    "Hint.\n",
    "A\\(B∪C)",
    "= A∩(B∪C)′ = (A∩A)∩(B′∩C′) = (A∩B′)∩(A∩C′) = (A\\B)∩(A\\C).\n",
    "1.4.17.\n",
    "Hint.\n",
    "(a) Not a map since f(2/3) is undefined; (b) this is a map; (c) not a map, since\nf(1/2) = 3/4 but f(2/4) = 3/8; (d) this is a map.\n1.4.18.\nHint.\n",
    "(a) f is one-to-one but not onto. f(R) = {x ∈R : x > 0}.",
    "(c) f is neither one-to-one\nnor onto. f(R)",
    "= {",
    "x : −1 ≤x ≤1}.\n",
    "1.4.20.\n",
    "Hint.\n",
    "(a) f(n)",
    "= n + 1.\n",
    "1.4.22.\n",
    "Hint.\n",
    "(a) Let x, y ∈A.\nThen g(f(x))",
    "= (g ◦f)(x) = (g ◦f)(y) = g(f(y)).\n",
    "Thus,\nf(x) = f(y) and x = y, so g ◦f is one-to-one.",
    "(b) Let c ∈C, then c = (g ◦f)(x) = g(f(x))\nfor some x ∈A. Since f(x) ∈B, g is onto.\n",
    "1.4.23.\n",
    "Hint.\nf−1(x)",
    "= (x + 1)/(x −1).\n",
    "1.4.24.\n",
    "Hint.\n",
    "(a) Let y ∈f(A1 ∪A2).",
    "Then there exists an x ∈A1 ∪A2 such that f(x)",
    "= y.\n318\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n319\nHence, y ∈f(A1) or f(A2).",
    "Therefore, y ∈f(A1) ∪f(A2).",
    "Consequently, f(A1 ∪A2) ⊂\nf(A1) ∪f(A2).",
    "Conversely, if y ∈f(A1) ∪f(A2), then y ∈f(A1) or f(A2).",
    "Hence, there\nexists an x in A1 or A2 such that f(x) = y.",
    "Thus, there exists an x ∈A1 ∪A2 such that\nf(x)",
    "= y. Therefore, f(A1) ∪f(A2) ⊂f(A1 ∪A2), and f(A1 ∪A2) = f(A1) ∪f(A2).\n",
    "1.4.25.\n",
    "Hint.\n",
    "(a) The relation fails to be symmetric.",
    "(b) The relation is not reflexive, since 0 is\nnot equivalent to itself.",
    "(c)",
    "The relation is not transitive.\n",
    "1.4.28.\n",
    "Hint.\n",
    "Let X = N ∪{\n√\n2 } and define x ∼y if x + y ∈N.\n2 ·",
    "The Integers\n2.4 ·",
    "Exercises\n2.4.1.\n",
    "Hint.\n",
    "The base case, S(1) :",
    "[1(1 + 1)(2(1)",
    "+ 1)]/6 = 1 = 12 is true.",
    "Assume that S(k) :\n",
    "12 + 22 + · · · + k2 =",
    "[k(k + 1)(2k +",
    "1)]/6 is true.",
    "Then\n12 + 22 + · · · + k2 + (k + 1)2 =",
    "[k(k + 1)(2k +",
    "1)]/6 + (k + 1)2\n=",
    "[(k + 1)((k",
    "+ 1) + 1)(2(k",
    "+ 1) + 1)]/6,\nand so S(k",
    "+ 1) is true.",
    "Thus, S(n) is true for all positive integers n.\n2.4.3.\nHint.\n",
    "The base case, S(4) : 4! = 24 > 16 = 24 is true.",
    "Assume S(k) :",
    "k! >",
    "2k is true.\n",
    "Then (k + 1)!",
    "= k!(k + 1) > 2k · 2 = 2k+1, so S(k",
    "+ 1) is true.",
    "Thus, S(n) is true for all\npositive integers n.\n2.4.8.\nHint.\n",
    "Follow the proof in Example 2.4.\n",
    "2.4.11.\n",
    "Hint.\n",
    "The base case, S(0) : (1+x)0−1 = 0 ≥0 = 0·x is true.",
    "Assume S(k) : (1+x)k−1 ≥\nkx is true.",
    "Then\n(1 + x)k+1 −1 = (1 + x)(1 + x)k −1\n= (1 + x)k + x(1 + x)k −1\n≥kx + x(1 + x)k\n≥kx + x\n= (k + 1)x,\nso S(k",
    "+ 1) is true.",
    "Therefore, S(n) is true for all positive integers n.\n2.4.17.",
    "Fibonacci Numbers.\n",
    "Hint.\n",
    "For (a) and (b) use mathematical induction.",
    "(c) Show that f1 = 1, f2 = 1, and\nfn+2 = fn+1 + fn.",
    "(e) Use part (b) and Exercise 2.4.16.\n",
    "2.4.19.\n",
    "Hint.\nUse the Fundamental Theorem of Arithmetic.\n",
    "2.4.23.\n",
    "Hint.\nUse the Principle of Well-Ordering and the division algorithm.\n\n",
    "APPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n320\n2.4.27.\nHint.\n",
    "Since gcd(a, b) = 1, there exist integers r and s such that ar + bs = 1.\n",
    "Thus,\nacr + bcs = c.\n2.4.29.\n",
    "Hint.\n",
    "Every prime must be of the form 2, 3, 6n + 1, or 6n + 5.",
    "Suppose there are only\nfinitely many primes of the form 6k",
    "+ 5.\n",
    "3 ·",
    "Groups\n3.5 · Exercises\n3.5.1.\n",
    "Hint.\n",
    "(a) 3",
    "+ 7Z = {. . .",
    ", −4, 3, 10, . . .}; (c) 18 + 26Z; (e) 5",
    "+ 6Z.\n3.5.2.\nHint.\n",
    "(a) Not a group; (c) a group.\n",
    "3.5.6.\nHint.\n·\n1\n5\n7\n11\n1\n1\n5\n7\n11\n5\n5\n1\n11\n7\n7\n7\n11\n1\n5\n11\n11\n7\n5\n1\n3.5.8.\n",
    "Hint.\nPick two matrices.",
    "Almost any pair will work.\n",
    "3.5.15.\nHint.\n",
    "There is a nonabelian group containing six elements.\n",
    "3.5.16.\n",
    "Hint.\n",
    "Look at the symmetry group of an equilateral triangle or a square.\n",
    "3.5.17.\n",
    "Hint.\n",
    "The are five different groups of order 8.\n3.5.18.\nHint.\n",
    "Let\nσ =\n\u0012 1\n2\n· · ·\nn\na1\na2\n· · ·\nan\n\u0013\nbe in Sn.",
    "All of the ais must be distinct.",
    "There are n ways to choose a1, n −1 ways to\nchoose a2, . .",
    "., 2 ways to choose an−1, and only one way to choose an.",
    "Therefore, we can\nform σ in n(n −1) · · · 2 · 1 = n! ways.\n3.5.25.\nHint.\n",
    "(aba−1)n = (aba−1)(aba−1) · · · (aba−1)\n= ab(aa−1)b(aa−1)b · · · b(aa−1)ba−1\n= abna−1.\n3.5.31.\n",
    "Hint.\n",
    "Since abab = (ab)2 = e = a2b2 = aabb, we know that ba = ab.\n\n",
    "APPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n321\n3.5.35.\n",
    "Hint.\n",
    "H1 = {id}, H2 = {id, ρ1, ρ2}, H3 = {id, µ1}, H4 = {id, µ2}, H5 = {id, µ3}, S3.\n",
    "3.5.41.\n",
    "Hint.\n",
    "The identity of G is 1 = 1+0\n√\n2.",
    "Since (a+b\n√\n2 )(c+d\n√\n2 ) = (ac+2bd)+(ad+bc)\n√\n2,\nG is closed under multiplication.",
    "Finally, (a + b\n√\n2 )−1 = a/(a2 −2b2) −b\n√\n2/(a2 −2b2).\n",
    "3.5.46.\n",
    "Hint.\n",
    "Look at S3.\n",
    "3.5.49.\n",
    "Hint.\n",
    "ba",
    "= a4b = a3ab = ab\n4 · Cyclic Groups\n4.5 · Exercises\n4.5.1.\n",
    "Hint.\n",
    "(a) False; (c) false; (e) true.\n",
    "4.5.2.\nHint.\n",
    "(a) 12; (c) infinite; (e) 10.\n4.5.3.\n",
    "Hint.\n",
    "(a) 7Z = {. . .",
    ", −7, 0, 7, 14, . . .}; (b) {0, 3, 6, 9, 12, 15, 18, 21}; (c) {0}, {0, 6}, {0, 4, 8},\n{0, 3, 6, 9}, {0, 2, 4, 6, 8, 10}; (g) {1, 3, 7, 9}; (j) {1, −1, i, −i}.\n",
    "4.5.4.\nHint.\n",
    "(a)\n\u00121\n0\n0\n1\n\u0013\n,\n\u0012−1\n0\n0\n−1\n\u0013\n,\n\u00120\n−1\n1\n0\n\u0013\n,\n\u0012 0\n1\n−1\n0\n\u0013\n.\n",
    "(c)\n\u00121\n0\n0\n1\n\u0013\n,\n\u00121\n−1\n1\n0\n\u0013\n,\n\u0012−1\n1\n−1\n0\n\u0013\n,\n\u0012 0\n1\n−1\n1\n\u0013\n,\n\u00120\n−1\n1\n−1\n\u0013\n,\n\u0012−1\n0\n0\n−1\n\u0013\n.\n4.5.10.\n",
    "Hint.\n",
    "(a) 0; (b) 1, −1.\n",
    "4.5.11.\n",
    "Hint.\n1, 2, 3, 4, 6, 8, 12, 24.\n4.5.15.\n",
    "Hint.\n",
    "(a) −3",
    "+",
    "3i; (c) 43 −18i; (e) i\n4.5.16.\n",
    "Hint.\n",
    "(a)\n√\n3 + i; (c) −3.\n",
    "4.5.17.\n",
    "Hint.\n",
    "(a)\n√\n2 cis(7π/4); (c) 2\n√\n2 cis(π/4); (e) 3 cis(3π/2).\n",
    "4.5.18.\n",
    "Hint.\n",
    "(a) (1 −i)/2; (c) 16(i",
    "−\n√\n3 ); (e) −1/4.\n",
    "4.5.22.\n",
    "Hint.\n",
    "(a) 292; (c) 1523.\n\n",
    "APPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n322\n4.5.27.\nHint.\n",
    "|⟨g⟩∩⟨h⟩| = 1.\n",
    "4.5.31.\n",
    "Hint.\n",
    "The identity element in any group has finite order.",
    "Let g, h ∈G have orders m and\nn, respectively.",
    "Since (g−1)m = e and (gh)mn = e, the elements of finite order in G form a\nsubgroup of G.\n4.5.37.\nHint.\n",
    "If g is an element distinct from the identity in G, g must generate G; otherwise, ⟨g⟩\nis a nontrivial proper subgroup of G.\n5 · Permutation Groups\n5.4 · Exercises\n5.4.1.\nHint.\n",
    "(a) (1 2 4 5 3); (c) (1 3)(2 5).\n",
    "5.4.2.\n",
    "Hint.\n",
    "(a) (1 3 5)(2 4); (c) (1 4)(2 3); (e) (1 3 2 4); (g) (1 3 4)(2 5); (n) (1 7 3 5 2).\n",
    "5.4.3.\nHint.\n",
    "(a) (1 6)(1 5)(1 3)(1 4); (c) (1 6)(1 4)(1 2).\n",
    "5.4.4.\nHint.\n",
    "(a1, a2, . . .",
    ", an)−1 = (a1, an, an−1, . . .",
    ", a2)\n5.4.5.\n",
    "Hint.\n",
    "(a) {(1 3), (1 3)(2 4), (1 3 2), (1 3 4), (1 3 2 4), (1 3 4 2)} is not a subgroup.\n",
    "5.4.8.\n",
    "Hint.\n",
    "(1 2 3 4 5)(6 7 8).\n",
    "5.4.11.\n",
    "Hint.\n",
    "Permutations of the form\n(1), (a1, a2)(a3, a4), (a1, a2, a3), (a1, a2, a3, a4, a5)\nare possible for A5.\n",
    "5.4.17.\n",
    "Hint.\n",
    "Calculate (1 2 3)(1 2) and (1 2)(1 2 3).\n",
    "5.4.25.\n",
    "Hint.\nConsider the cases (a, b)(b, c) and (a, b)(c, d).\n",
    "5.4.29.\n",
    "Hint.\n",
    "Show that the center of Dn consists of the identity if n is odd and consists of the\nidentity and a 180◦rotation if n is even.\n",
    "5.4.30.\n",
    "Hint.\n",
    "For (a), show that στσ−1(σ(ai))",
    "= σ(ai+1).\n",
    "6 · Cosets and Lagrange’s Theorem\n6.5 · Exercises\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n323\n6.5.1.\n",
    "Hint.\n",
    "The order of g and the order h must both divide the order of G.\n6.5.2.\nHint.\n",
    "The possible orders must divide 60.\n6.5.3.\nHint.\n",
    "This is true for every proper nontrivial subgroup.\n",
    "6.5.4.\nHint.\n",
    "False.\n",
    "6.5.5.\nHint.\n",
    "(a) ⟨8⟩, 1 + ⟨8⟩, 2 + ⟨8⟩, 3 + ⟨8⟩, 4 + ⟨8⟩, 5 + ⟨8⟩, 6 + ⟨8⟩, and 7 + ⟨8⟩; (c) 3Z, 1 + 3Z,\nand 2 + 3Z.\n6.5.7.\nHint.\n",
    "4ϕ(15)",
    "≡48 ≡1 (mod 15).\n",
    "6.5.12.\n",
    "Hint.\n",
    "Let g1 ∈gH. Show that g1 ∈Hg and thus gH ⊂Hg.\n",
    "6.5.19.\n",
    "Hint.\nShow that g(H ∩K)",
    "= gH ∩gK.\n6.5.22.\n",
    "Hint.\n",
    "If gcd(m, n) = 1, then ϕ(mn) = ϕ(m)ϕ(n) (Exercise 2.4.26 in Chapter 2).\n",
    "7 · Introduction to Cryptography\n7.4 · Exercises\n7.4.1.\n",
    "Hint.\n",
    "LAORYHAPDWK\n7.4.3.\nHint.\n",
    "Hint: V = E, E = X (also used for spaces and punctuation), K = R.\n7.4.4.\n",
    "Hint.\n",
    "26! −1\n7.4.7.\nHint.\n",
    "(a) 2791; (c) 11213525032442.\n",
    "7.4.9.\n",
    "Hint.\n",
    "(a) 31 (c) 14.\n",
    "7.4.10.\n",
    "Hint.\n",
    "(a) n = 11 · 41; (c) n = 8779 · 4327.\n",
    "8 · Algebraic Coding Theory\n8.6 ·",
    "Exercises\n8.6.2.\n",
    "Hint.\n",
    "This cannot be a group code since (0000) /∈C.\n8.6.3.\nHint.\n",
    "(a) 2; (c) 2.\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n324\n8.6.4.\n",
    "Hint.\n",
    "(a) 3; (c) 4.\n8.6.6.\n",
    "Hint.\n",
    "(a) dmin = 2; (c) dmin = 1.\n",
    "8.6.7.\n",
    "Hint.\n",
    "(a) (00000), (00101), (10011), (10110)\nG =\n\n\n\n\n\n\n\n0\n1\n0\n0\n1\n0\n0\n1\n1\n1\n\n\n\n\n\n\n\n(b) (000000), (010111), (101101), (111010)\nG =\n\n\n\n\n\n\n\n\n\n1\n0\n0\n1\n1\n0\n1\n1\n0\n1\n1\n1\n\n\n\n\n\n\n\n\n\n8.6.9.\nHint.\n",
    "Multiple errors occur in one of the received words.\n",
    "8.6.11.\n",
    "Hint.\n",
    "(a) A canonical parity-check matrix with standard generator matrix\nG =\n\n\n\n\n\n\n\n1\n1\n0\n0\n1\n\n\n\n\n\n\n\n.\n",
    "(c) A canonical parity-check matrix with standard generator matrix\nG =\n\n\n\n\n\n1\n0\n0\n1\n1\n1\n1\n0\n\n",
    "\n\n\n.\n8.6.12.\nHint.\n",
    "(a) All possible syndromes occur.\n",
    "8.6.15.\n",
    "Hint.\n",
    "(a) C, (10000)+C, (01000)+C, (00100)+C, (00010)+C, (11000)+C, (01100)+C,\n(01010)+C. A decoding table does not exist for C since this is only a single error-detecting\ncode.\n\n",
    "APPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n325\n8.6.19.\n",
    "Hint.\n",
    "Let x ∈C have odd weight and define a map from the set of odd codewords to the\nset of even codewords by",
    "y 7→x",
    "+ y. Show that this map is a bijection.\n",
    "8.6.23.\n",
    "Hint.\n",
    "For 20 information positions, at least 6 check bits are needed to ensure an error-\ncorrecting code.\n",
    "9 ·",
    "Isomorphisms\n9.4 · Exercises\n9.4.1.\n",
    "Hint.\n",
    "Every infinite cyclic group is isomorphic to Z by Theorem 9.7.\n9.4.2.\n",
    "Hint.\n",
    "Define ϕ : C∗→GL2(R) by\nϕ(a + bi) =\n\u0012 a\nb\n−b\na\n\u0013\n.\n",
    "9.4.3.\n",
    "Hint.\n",
    "False.\n9.4.6.\n",
    "Hint.\n",
    "Define a map from Zn into the nth roots of unity by k 7→cis(2kπ/n).\n",
    "9.4.8.\n",
    "Hint.\nAssume that Q is cyclic and try to find a generator.\n9.4.11.\n",
    "Hint.\n",
    "There are two nonabelian and three abelian groups that are not isomorphic.\n",
    "9.4.16.\n",
    "Hint.\n",
    "(a) 12; (c) 5.\n9.4.19.\n",
    "Hint.\n",
    "Draw the picture.\n9.4.20.\nHint.\n",
    "True.\n9.4.25.\n",
    "Hint.\n",
    "True.\n",
    "9.4.27.\nHint.\n",
    "Let a be a generator for G. If ϕ : G →H is an isomorphism, show that ϕ(a) is a\ngenerator for H.\n9.4.38.\nHint.\n",
    "Any automorphism of Z6 must send 1 to another generator of Z6.\n",
    "9.4.45.\n",
    "Hint.\n",
    "To show that ϕ is one-to-one, let g1 = h1k1 and g2 = h2k2 and consider ϕ(g1)",
    "=\nϕ(g2).\n",
    "10 · Normal Subgroups and Factor Groups\n10.4 · Exercises\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n326\n10.4.1.\n",
    "Hint.\n",
    "(a)\nA4\n(1 2)A4\nA4\nA4\n(1 2)A4\n(1 2)A4\n(1 2)A4\nA4\n(c) D4 is not normal in S4.\n10.4.8.\nHint.\n",
    "If a ∈G is a generator for G, then aH is a generator for G/H.\n10.4.11.\nHint.\n",
    "For any g ∈G, show that the map ig : G →G defined by ig : x 7→gxg−1 is an\nisomorphism of G with itself.",
    "Then consider ig(H).\n",
    "10.4.12.\nHint.\nSuppose that ⟨g⟩is normal in G and let y be an arbitrary element of G.",
    "If x ∈C(g),\nwe must show that yxy−1 is also in C(g).",
    "Show that (yxy−1)g = g(yxy−1).\n",
    "10.4.14.\nHint.\n",
    "(a) Let g ∈G and",
    "h ∈G′. If h = aba−1b−1, then\nghg−1 = gaba−1b−1g−1\n= (gag−1)(gbg−1)(ga−1g−1)(gb−1g−1)\n= (gag−1)(gbg−1)(gag−1)−1(gbg−1)−1.\n",
    "We also need to show that if h = h1 · · · hn with hi = aibia−1\ni b−1\ni , then ghg−1 is a product of el-\nements of the same type.",
    "However, ghg−1 = gh1 · · · hng−1 = (gh1g−1)(gh2g−1) · · · (ghng−1).\n",
    "11 · Homomorphisms\n11.4 ·",
    "Exercises\n11.4.2.\n",
    "Hint.\n",
    "(a) is a homomorphism with kernel {1}; (c) is not a homomorphism.\n11.4.4.\n",
    "Hint.\n",
    "Since ϕ(m + n) = 7(m + n) = 7m + 7n = ϕ(m) + ϕ(n), ϕ is a homomorphism.\n",
    "11.4.5.\n",
    "Hint.\n",
    "For any homomorphism ϕ : Z24 →Z18, the kernel of ϕ must be a subgroup of Z24\nand the image of ϕ must be a subgroup of Z18.",
    "Now use the fact that a generator must map\nto a generator.\n11.4.9.\nHint.\n",
    "Let a, b ∈G. Then ϕ(a)ϕ(b)",
    "= ϕ(ab) = ϕ(ba)",
    "= ϕ(b)ϕ(a).\n",
    "11.4.17.\nHint.\nFind a counterexample.\n12 ·",
    "Matrix Groups and Symmetry\n12.4 ·",
    "Exercises\n12.4.1.\n",
    "Hint.\n1\n2\n\u0002\n∥x + y∥2 + ∥x∥2 −∥y∥2\u0003\n= 1\n2\n\u0002\n⟨x + y, x + y⟩−∥x∥2 −∥y∥2\u0003\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n327\n= 1\n2\n\u0002\n∥x∥2 + 2⟨x, y⟩+ ∥y∥2 −∥x∥2 −∥y∥2\u0003\n= ⟨x, y⟩.\n12.4.3.\nHint.\n",
    "(a) is in SO(2); (c) is not in O(3).\n",
    "12.4.5.\n",
    "Hint.\n",
    "(a) ⟨x, y⟩= ⟨y, x⟩.\n12.4.7.\n",
    "Hint.\nUse the unimodular matrix\n\u00125\n2\n2\n1\n\u0013\n.\n12.4.10.\nHint.\n",
    "Show that the kernel of the map det : O(n) →R∗is SO(n).\n",
    "12.4.13.\nHint.\n",
    "True.\n",
    "12.4.17.\nHint.\n",
    "p6m\n13 ·",
    "The Structure of Groups\n13.4 ·",
    "Exercises\n13.4.1.\n",
    "Hint.\n",
    "There are three possible groups.\n13.4.4.\n",
    "Hint.\n",
    "(a) {0} ⊂⟨6⟩⊂⟨3⟩⊂Z12; (e) {(1)}×{0} ⊂{(1), (1 2 3), (1 3 2)}×{0} ⊂S3 ×{0} ⊂\nS3 × ⟨2⟩⊂S3 ×",
    "Z4.\n",
    "13.4.7.\n",
    "Hint.\nUse the Fundamental Theorem of Finitely Generated Abelian Groups.\n",
    "13.4.12.\nHint.\n",
    "If N and G/N are solvable, then they have solvable series\nN = Nn ⊃Nn−1 ⊃· · · ⊃N1 ⊃N0 = {e}\nG/N = Gn/N ⊃Gn−1/N ⊃· · · G1/N ⊃G0/N = {N}.\n",
    "13.4.16.\nHint.\n",
    "Use the fact that Dn has a cyclic subgroup of index 2.\n13.4.21.\nHint.\n",
    "G/G′ is abelian.\n",
    "14 ·",
    "Group Actions\n14.5 ·",
    "Exercises\n14.5.1.\n",
    "Hint.\n",
    "Example 14.1: 0, R2 \\ {0}.",
    "Example 14.2: X = {1, 2, 3, 4}.\n",
    "14.5.2.\n",
    "Hint.\n",
    "(a) X(1) = {1, 2, 3}, X(1 2) = {3}, X(1 3) = {2}, X(2 3) = {1}, X(1 2 3) = X(1 3 2) = ∅.\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n328\nG1 = {(1), (2 3)}, G2 = {(1), (1 3)}, G3 = {(1), (1 2)}.\n",
    "14.5.3.\n",
    "Hint.\n",
    "(a) O1 = O2 = O3 = {1, 2, 3}.\n",
    "14.5.6.\n",
    "Hint.\n",
    "The conjugacy classes for S4 are\nO(1)",
    "= {(1)},\nO(12) = {(1 2), (1 3), (1 4), (2 3), (2 4), (3 4)},\nO(1 2)(3 4) = {(1 2)(3 4), (1 3)(2 4), (1 4)(2 3)},\nO(123)",
    "= {(1 2 3), (1 3 2), (1 2 4), (1 4 2), (1 3 4), (1 4 3), (2 3 4), (2 4 3)},\nO(1234) = {(1 2 3 4), (1 2 4 3), (1 3 2 4), (1 3 4 2), (1 4 2 3), (1 4 3 2)}.\n",
    "The class equation is 1 + 3 + 6 + 6 + 8 = 24.\n14.5.8.\n",
    "Hint.\n",
    "(34 + 31 + 32 + 31 + 32 + 32 + 33 + 33)/8 = 21.\n",
    "14.5.11.\n",
    "Hint.\n",
    "The group of rigid motions of the cube can be described by the allowable permuta-\ntions of the six faces and is isomorphic to S4.",
    "There are the identity cycle, 6 permutations\nwith the structure (abcd) that correspond to the quarter turns, 3 permutations with the\nstructure (ab)(cd) that correspond to the half turns, 6 permutations with the structure\n(ab)(cd)(ef) that correspond to rotating the cube about the centers of opposite edges, and\n8 permutations with the structure (abc)(def) that correspond to rotating the cube about\nopposite vertices.\n",
    "14.5.15.\n",
    "Hint.\n",
    "(1 · 26 + 3 · 24 + 4 · 23",
    "+ 2 · 22 + 2 · 21)/12",
    "= 13.\n",
    "14.5.17.\nHint.\n",
    "(1 · 28 + 3 · 26 + 2 · 24)/6 = 80.\n",
    "14.5.22.\n",
    "Hint.\n",
    "Use the fact that x ∈gC(a)g−1",
    "if and only if g−1xg ∈C(a).\n",
    "15 ·",
    "The Sylow Theorems\n15.4 ·",
    "Exercises\n15.4.1.\n",
    "Hint.\n",
    "If |G| = 18 = 2 · 32, then the order of a Sylow 2-subgroup is 2, and the order of a\nSylow 3-subgroup is 9.\n15.4.2.\n",
    "Hint.\n",
    "The four Sylow 3-subgroups of S4 are P1 = {(1), (1 2 3), (1 3 2)}, P2 = {(1), (1 2 4), (1 4 2)},\nP3 = {(1), (1 3 4), (1 4 3)}, P4 = {(1), (2 3 4), (2 4 3)}.\n",
    "15.4.5.\n",
    "Hint.\n",
    "Since |G| = 96 = 25 · 3, G has either one or three Sylow 2-subgroups by the Third\nSylow Theorem.",
    "If there is only one subgroup, we are done.",
    "If there are three Sylow 2-\nsubgroups, let H and K be two of them.",
    "Therefore, |H ∩K| ≥16; otherwise, HK would\nhave (32 · 32)/8 = 128 elements, which is impossible.",
    "Thus, H ∩K is normal in both H and\nK since it has index 2 in both groups.\n\n",
    "APPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n329\n15.4.8.\n",
    "Hint.\n",
    "Show that G has a normal Sylow p-subgroup of order p2 and a normal Sylow q-\nsubgroup of order q2.\n",
    "15.4.10.\nHint.\n",
    "False.\n",
    "15.4.17.\nHint.\n",
    "If G is abelian, then G is cyclic, since |G| = 3 · 5 · 17.",
    "Now look at Example 15.14.\n",
    "15.4.23.\n",
    "Hint.\n",
    "Define a mapping between the right cosets of N(H) in G and the conjugates of H\nin G by N(H)g 7→g−1Hg.",
    "Prove that this map is a bijection.\n",
    "15.4.26.\nHint.\n",
    "Let aG′, bG′ ∈G/G′.",
    "Then (aG′)(bG′) =",
    "abG′ =",
    "ab(b−1a−1ba)G′ = (abb−1a−1)baG′ =\nbaG′.\n16 ·",
    "Rings\n16.7 ·",
    "Exercises\n16.7.1.\n",
    "Hint.\n",
    "(a) 7Z is a ring but not a field; (c) Q(\n√\n2 ) is a field; (f) R is not a ring.\n",
    "16.7.3.\n",
    "Hint.\n",
    "(a) {1, 3, 7, 9}; (c) {1, 2, 3, 4, 5, 6}; (e)\n\u001a\u00121\n0\n0\n1\n\u0013\n,\n\u00121\n1\n0\n1\n\u0013\n,\n\u00121\n0\n1\n1\n\u0013\n,\n\u00120\n1\n1\n0\n\u0013\n,\n\u00121\n1\n1\n0\n\u0013\n,\n\u00120\n1\n1\n1\n\u0013\n,\n\u001b\n.\n",
    "16.7.4.\n",
    "Hint.\n",
    "(a) {0}, {0, 9}, {0, 6, 12}, {0, 3, 6, 9, 12, 15}, {0, 2, 4, 6, 8, 10, 12, 14, 16}; (c) there are\nno nontrivial ideals.\n",
    "16.7.7.\n",
    "Hint.\nAssume there is an isomorphism ϕ :",
    "C →R with ϕ(i)",
    "= a.\n16.7.8.\n",
    "Hint.\n",
    "False.",
    "Assume there is an isomorphism ϕ : Q(\n√\n2 ) →Q(\n√\n3 ) such that ϕ(\n√\n2 ) = a.\n16.7.13.\nHint.\n",
    "(a) x ≡17 (mod 55); (c) x",
    "≡214 (mod 2772).\n",
    "16.7.16.\n",
    "Hint.\n",
    "If I ̸= {0}, show that 1 ∈I.\n16.7.18.\nHint.\n(a) ϕ(a)ϕ(b) = ϕ(ab) = ϕ(ba) = ϕ(b)ϕ(a).\n",
    "16.7.26.\n",
    "Hint.\n",
    "Let a ∈R with a ̸= 0.",
    "Then the principal ideal generated by a is R. Thus, there\nexists a b ∈R such that ab = 1.\n",
    "16.7.28.\n",
    "Hint.\n",
    "Compute (a + b)2 and (−ab)2.\n\n",
    "APPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n330\n16.7.33.\nHint.\nLet a/b, c/d ∈Z(p).",
    "Then a/b + c/d = (ad + bc)/bd and (a/b) · (c/d) = (ac)/(bd) are\nboth in Z(p), since gcd(bd, p) = 1.\n",
    "16.7.37.\n",
    "Hint.\nSuppose that x2 = x and x ̸= 0.",
    "Since R is an integral domain, x = 1.",
    "To find a\nnontrivial idempotent, look in M2(R).\n",
    "17 · Polynomials\n17.5 ·",
    "Exercises\n17.5.2.\n",
    "Hint.\n",
    "(a) 9x2 + 2x + 5; (b) 8x4 + 7x3 + 2x2 + 7x.\n",
    "17.5.3.\n",
    "Hint.\n",
    "(a) 5x3 + 6x2 −3x + 4 = (5x2 + 2x + 1)(x −2)",
    "+ 6; (c) 4x5 −x3",
    "+ x2 + 4 =\n(4x2 + 4)(x3 + 3) + 4x2",
    "+ 2.\n",
    "17.5.5.\n",
    "Hint.\n",
    "(a) No zeros in Z12; (c) 3, 4.\n17.5.7.\n",
    "Hint.\n",
    "Look at (2x + 1).\n",
    "17.5.8.\n",
    "Hint.\n",
    "(a) Reducible; (c) irreducible.\n",
    "17.5.10.\n",
    "Hint.\n",
    "One factorization is x2 +",
    "x",
    "+ 8 = (x + 2)(x + 9).\n",
    "17.5.13.\nHint.\n",
    "The integers Z do not form a field.\n",
    "17.5.14.\nHint.\n",
    "False.\n",
    "17.5.16.\nHint.\n",
    "Let ϕ : R →S be an isomorphism.",
    "Define ϕ : R[x]",
    "→S[x] by ϕ(a0 +",
    "a1x + · · · +\nanxn) = ϕ(a0)",
    "+",
    "ϕ(a1)x + · · · + ϕ(an)xn.\n17.5.20.",
    "Cyclotomic Polynomials.\n",
    "Hint.\n",
    "The polynomial\nΦn(x)",
    "=",
    "xn −1\nx −1 = xn−1 + xn−2 + · · ·",
    "+ x + 1\nis called the cyclotomic polynomial.",
    "Show that Φp(x) is irreducible over Q for any prime p.\n17.5.26.\n",
    "Hint.\nFind a nontrivial proper ideal in F[x].\n",
    "18 · Integral Domains\n18.4 ·",
    "Exercises\n18.4.1.\n",
    "Hint.\n",
    "Note that z−1 = 1/(a + b\n√\n3 i) = (a −b\n√\n3 i)/(a2 + 3b2) is in Z",
    "[\n√\n3 i] if and only if\na2 + 3b2 = 1.",
    "The only integer solutions to the equation are a = ±1, b = 0.\n\n",
    "APPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n331\n18.4.2.\n",
    "Hint.\n",
    "(a) 5 = −i(1 + 2i)(2 + i); (c) 6 + 8i = −i(1 +",
    "i)2(2 + i)2.\n18.4.4.\n",
    "Hint.\n",
    "True.\n",
    "18.4.9.\n",
    "Hint.\n",
    "Let z = a + bi and w = c + di ̸= 0 be in Z[i].",
    "Prove that z/w ∈Q(i).\n",
    "18.4.15.\n",
    "Hint.\n",
    "Let a = ub with u a unit.",
    "Then ν(b) ≤ν(ub) ≤ν(a).",
    "Similarly, ν(a) ≤ν(b).\n",
    "18.4.16.\n",
    "Hint.\n",
    "Show that 21 can be factored in two different ways.\n19 · Lattices and Boolean Algebras\n19.5 ·",
    "Exercises\n19.5.2.\n",
    "Hint.\n",
    "30\n10\n15\n2\n5\n3\n1\n19.5.4.\nHint.\n",
    "What are the atoms of B?\n19.5.5.\nHint.\n",
    "False.\n",
    "19.5.6.\n",
    "Hint.\n",
    "(a) (a ∨b ∨a′) ∧a\na′\nb\na\na\n(c) a ∨(a ∧b)\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n332\na\na\nb\n19.5.8.\n",
    "Hint.\n",
    "Not equivalent.\n",
    "19.5.10.\nHint.\n",
    "(a) a′",
    "∧[(a ∧b′)",
    "∨b] = a ∧(a ∨b).\n",
    "19.5.14.\n",
    "Hint.\n",
    "Let I, J be ideals in R. We need to show that I + J = {r + s : r ∈I and s ∈J}\nis the smallest ideal in R containing both I and J.\n",
    "If r1, r2 ∈I and s1, s2 ∈J, then\n(r1+s1)+(r2+s2) = (r1+r2)+(s1+s2) is in I +J. For a ∈R, a(r1+s1)",
    "= ar1+as1 ∈I +J;\nhence, I + J is an ideal in R.\n19.5.18.\nHint.\n",
    "(a) No.\n19.5.20.\n",
    "Hint.\n",
    "(⇒).\n",
    "a = b ⇒(a ∧b′) ∨(a′ ∧b)",
    "= (a ∧a′) ∨(a′ ∧a)",
    "= O ∨O = O.\n(⇐).\n",
    "(a∧b′)∨(a′∧b)",
    "=",
    "O ⇒a∨b = (a∨a)∨b = a∨(a∨b) = a∨[I∧(a∨b)]",
    "= a∨[(a∨a′)∧(a∨b)]",
    "=\n[a ∨(a ∧b′)]",
    "∨[a ∨(a′ ∧b)]",
    "= a ∨[(a ∧b′) ∨(a′ ∧b)]",
    "= a ∨0 = a.",
    "A symmetric argument\nshows",
    "that a ∨b = b.\n20 · Vector Spaces\n20.5 · Exercises\n20.5.3.\nHint.\nQ(\n√\n2,\n√\n3 ) has basis {1,\n√\n2,\n√\n3,\n√\n6 } over Q.\n20.5.5.\nHint.\n",
    "The set {1, x, x2, . . .",
    ", xn−1} is a basis for Pn.\n20.5.7.\n",
    "Hint.\n",
    "(a) Subspace of dimension 2 with basis {(1, 0, −3), (0, 1, 2)}; (d) not a subspace\n20.5.10.\n",
    "Hint.\n",
    "Since 0 = α0 = α(−v + v) = α(−v) + αv, it follows that −αv = α(−v).\n",
    "20.5.12.\nHint.\n",
    "Let v0 = 0, v1, . .",
    ".",
    ", vn ∈V and α0 ̸= 0, α1, . . .",
    ", αn ∈F.",
    "Then α0v0 + · · · + αnvn = 0.\n",
    "20.5.15.",
    "Linear Transformations.\n",
    "Hint.\n",
    "(a) Let u, v ∈ker(T) and α ∈F. Then\nT(u",
    "+ v) = T(u)",
    "+ T(v) = 0\nT(αv) = αT(v) = α0 = 0.\n",
    "Hence, u + v, αv ∈ker(T), and ker(T) is a subspace of V .\n",
    "(c)",
    "The statement that T(u) = T(v) is equivalent to T(u −v)",
    "= T(u) −T(v) = 0, which\nis true if and only if u −v = 0 or u = v.\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n333\n20.5.17.",
    "Direct Sums.\n",
    "Hint.\n",
    "(a) Let u, u′ ∈U and v, v′ ∈V .",
    "Then\n(u + v) + (u′ + v′)",
    "= (u + u′) + (v + v′) ∈U",
    "+ V\nα(u + v) = αu + αv ∈U + V .\n",
    "21 ·",
    "Fields\n21.5 ·",
    "Exercises\n21.5.1.\n",
    "Hint.\n",
    "(a) x4 −(2/3)x2 −62/9; (c) x4 −2x2",
    "+ 25.\n",
    "21.5.2.\n",
    "Hint.\n",
    "(a) {1,\n√\n2,\n√\n3,\n√\n6 }; (c) {1, i,\n√\n2,\n√\n2 i}; (e) {1, 21/6, 21/3, 21/2, 22/3, 25/6}.\n21.5.3.\n",
    "Hint.\n",
    "(a) Q(\n√\n3,\n√\n7 ).\n",
    "21.5.5.\n",
    "Hint.\n",
    "Use the fact that the elements of Z2[x]/⟨x3",
    "+ x",
    "+ 1⟩are 0, 1, α, 1 + α, α2, 1 + α2,\nα + α2, 1 + α",
    "+ α2 and the fact that α3 + α + 1 = 0.\n21.5.8.\n",
    "Hint.\n",
    "False.\n",
    "21.5.14.\nHint.\nSuppose that E is algebraic over F and K is algebraic over E. Let α ∈K. It\nsuﬀices to show that α is algebraic over some finite extension of F. Since α is algebraic over\nE, it must be the zero of some polynomial p(x) = β0 + β1x + · · ·",
    "+ βnxn in E[x].",
    "Hence α\nis algebraic over F(β0, . .",
    ". , βn).\n",
    "21.5.22.\nHint.\n",
    "Since {1,\n√\n3,\n√\n7,\n√\n21 } is a basis for Q(\n√\n3,\n√\n7 ) over Q, Q(\n√\n3,\n√\n7 ) ⊃Q(\n√\n3+\n√\n7 ).\n",
    "Since [Q(\n√\n3,\n√\n7 ) : Q] = 4, [Q(\n√\n3 +\n√\n7 ) : Q] = 2 or 4.",
    "Since the degree of the minimal\npolynomial of\n√\n3 +\n√\n7 is 4, Q(\n√\n3,\n√\n7 ) = Q(\n√\n3",
    "+\n√\n7 ).\n",
    "21.5.27.\nHint.\nLet β ∈F(α) not in F. Then β = p(α)/q(α), where p and q are polynomials in α\nwith q(α) ̸= 0 and coeﬀicients in F. If β is algebraic over F, then there exists a polynomial\nf(x) ∈F[x] such that f(β)",
    "= 0.",
    "Let f(x)",
    "= a0 + a1x",
    "+ · · · + anxn.",
    "Then\n0 = f(β)",
    "= f\n\u0012p(α)\n",
    "q(α)\n\u0013\n= a0 + a1\n\u0012p(α)\nq(α)\n\u0013\n+ · · · + an\n\u0012p(α)\nq(α)\n\u0013n\n.\n",
    "Now multiply both sides by q(α)n to show that there is a polynomial in F[x] that has α as\na zero.\n",
    "21.5.28.\n",
    "Hint.\n",
    "See the comments following Theorem 21.13.\n",
    "22 · Finite Fields\n22.4 ·",
    "Exercises\n22.4.1.\n",
    "Hint.\nMake sure that you have a field extension.\n\n",
    "APPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n334\n22.4.4.\nHint.\n",
    "There are eight elements in Z2(α).",
    "Exhibit two more zeros of x3 +x2",
    "+1 other than\nα in these eight elements.\n",
    "22.4.5.\n",
    "Hint.\nFind an irreducible polynomial p(x) in Z3[x] of degree 3 and show that Z3[x]/⟨p(x)⟩\nhas 27 elements.\n",
    "22.4.7.\n",
    "Hint.\n",
    "(a) x5 −1 = (x+1)(x4 +x3 +x2 +x+1); (c) x9 −1 = (x+1)(x2 +x+1)(x6 +x3 +1).\n",
    "22.4.8.\n",
    "Hint.\n",
    "True.\n",
    "22.4.11.\nHint.\n",
    "(a) Use the fact that x7 −1 = (x + 1)(x3",
    "+ x + 1)(x3",
    "+ x2 + 1).\n",
    "22.4.12.\nHint.\n",
    "False.\n",
    "22.4.17.\nHint.\n",
    "If p(x) ∈F[x], then p(x) ∈E[x].\n",
    "22.4.18.\nHint.\n",
    "Since α is algebraic over F of degree n, we can write any element β ∈F(α)\nuniquely as β = a0 + a1α + · · ·",
    "+ an−1αn−1 with ai ∈F. There are qn possible n-tuples\n(a0, a1, . . .",
    ", an−1).\n",
    "22.4.24.",
    "Wilson’s Theorem.\n",
    "Hint.\n",
    "Factor xp−1 −1 over Zp.\n23 · Galois Theory\n23.5 ·",
    "Exercises\n23.5.1.\n",
    "Hint.\n",
    "(a) Z2; (c) Z2 ×",
    "Z2 × Z2.\n",
    "23.5.2.\n",
    "Hint.\n",
    "(a) Separable over Q since x3 +2x2 −x−2 = (x−1)(x+1)(x+2); (c) not separable\nover Z3 since x4 + x2 + 1 = (x + 1)2(x + 2)2.\n23.5.3.\n",
    "Hint.\n",
    "If\n[GF(729) : GF(9)]",
    "=",
    "[GF(729) : GF(3)]/[GF(9) : GF(3)]",
    "= 6/2 = 3,\nthen G(GF(729)/ GF(9))",
    "∼= Z3.",
    "A generator for G(GF(729)/ GF(9)) is σ, where σ36(α) =\nα36 = α729 for α ∈GF(729).\n",
    "23.5.4.\nHint.\n",
    "(a) S5; (c) S3; (g) see Example 23.11.\n",
    "23.5.5.\n",
    "Hint.\n",
    "(a) Q(i)\n",
    "23.5.7.\n",
    "Hint.\n",
    "Let E be the splitting field of a cubic polynomial in F[x].",
    "Show that [E : F] is less\nthan or equal to 6 and is divisible by 3.",
    "Since G(E/F) is a subgroup of S3 whose order is\n\nAPPENDIX B. HINTS AND ANSWERS TO SELECTED EXERCISES\n335\ndivisible by 3, conclude that this group must be isomorphic to Z3 or S3.\n23.5.9.\nHint.\n",
    "G is a subgroup of Sn.\n23.5.16.\nHint.\n",
    "True.\n",
    "23.5.20.\nHint.\n",
    "(a) Clearly ω, ω2, . . .",
    ", ωp−1 are distinct since ω ̸= 1 or 0.",
    "To show that ωi is a zero of Φp,\ncalculate Φp(ωi).\n",
    "(b) The conjugates of ω are ω, ω2, . .",
    ".",
    ", ωp−1.",
    "Define a map ϕi : Q(ω) →Q(ωi) by\nϕi(a0",
    "+ a1ω + · · · + ap−2ωp−2) =",
    "a0 + a1ωi + · · · + cp−2(ωi)p−2,\nwhere ai ∈Q.",
    "Prove that ϕi is an isomorphism of fields.",
    "Show that ϕ2 generates\nG(Q(ω)/Q).\n",
    "(c) Show that {ω, ω2, . .",
    ".",
    ", ωp−1} is a basis for Q(ω) over Q, and consider which linear\ncombinations of ω, ω2, . . .",
    ", ωp−1 are left fixed by all elements of G(Q(ω)/Q).\n\n",
    "C\nNotation\nThe following table defines the notation used in this book.",
    "Page numbers or references refer\nto the first appearance of each symbol.\n",
    "Symbol\nDescription\nPage\na ∈A\na is in the set A\n3\nN\nthe natural numbers\n4\nZ\nthe integers\n4\nQ\nthe rational numbers\n4\nR\nthe real numbers\n4\nC\nthe complex numbers\n4\nA ⊂B\nA is a subset of B\n4\n∅\nthe empty set\n4\nA ∪B\nthe union of sets A and B\n4\n",
    "A ∩B\nthe intersection of sets A and B\n4\nA′\ncomplement of the set A\n4\nA \\ B\ndifference between sets A and B\n4\nA × B\nCartesian product of sets A and B\n6\nAn\nA × · · · ×",
    "A (n times)\n6\nid\nidentity mapping\n9\nf−1\ninverse of the function f\n9\na ≡b (mod n)\na is congruent to b modulo n\n13\nn!\nn factorial\n18\n\u0000n\nk\n\u0001\nbinomial coeﬀicient n!/(k!(n −k)!)\n18\na | b\na divides b\n20\ngcd(a, b)\ngreatest common divisor of a and b\n20\nP(X)\npower set of X\n24\nlcm(m, n)\nthe least common multiple of m and n\n25\nZn\nthe integers modulo n\n28\nU(n)\ngroup of units in Zn\n35\nMn(R)\nthe n × n matrices with entries in R\n35\ndet A\nthe determinant of A\n35\nGLn(R)\nthe general linear group\n35\nQ8\nthe group of quaternions\n36\n(Continued on next page)\n336\n\nAPPENDIX C. NOTATION\n337\nSymbol\nDescription\nPage\nC∗\nthe multiplicative group of complex numbers\n36\n|G|\nthe order of a group\n36\nR∗\nthe multiplicative group of real numbers\n38\nQ∗\nthe multiplicative group of rational numbers\n38\nSLn(R)\nthe special linear group\n38\nZ(G)\nthe center of a group\n43\n⟨a⟩\ncyclic group generated by a\n46\n|a|\nthe order of an element a\n47\ncis θ\ncos θ + i sin θ\n51\nT\nthe circle group\n52\nSn\nthe symmetric group on n letters\n59\n(a1, a2, . . .",
    ", ak)\ncycle of length k\n61\nAn\nthe alternating group on n letters\n64\nDn\nthe dihedral group\n65\n",
    "[G : H]\nindex of a subgroup H in a group G\n75\nLH\nthe set of left cosets of a subgroup H in a group G\n75\nRH\nthe set of right cosets of a subgroup H in a group G\n75\na ∤b\na does not divide b\n78\nd(x, y)\nHamming distance between x and y\n96\ndmin\nthe minimum distance of a code\n96\nw(x)\nthe weight of x\n96\nMm×n(Z2)\nthe set of m × n matrices with entries in Z2\n100\nNull(H)\nnull space of a matrix H\n100\nδij\nKronecker delta\n103\nG ∼= H\nG is isomorphic to a group H\n114\nAut(G)\nautomorphism group of a group G\n123\nig\nig(x)",
    "= gxg−1\n123\nInn(G)\ninner automorphism group of a group G\n123\nρg\nright regular representation\n123\nG/N\nfactor group of G mod N\n126\nG′\ncommutator subgroup of G\n132\nker ϕ\nkernel of ϕ\n134\n(aij)\nmatrix\n142\nO(n)\northogonal group\n144\n∥x∥\nlength of a vector x\n144\nSO(n)\nspecial orthogonal group\n147\nE(n)\nEuclidean group\n147\nOx\norbit of x\n169\nXg\nfixed point set of g\n169\nGx\nisotropy subgroup of x\n169\nN(H)\nnormalizer of s subgroup H\n182\nH\nthe ring of quaternions\n192\nZ[i]\nthe Gaussian integers\n194\nchar R\ncharacteristic of a ring R\n194\n(Continued on next page)\n\nAPPENDIX C. NOTATION\n338\nSymbol\nDescription\nPage\nZ(p)\nring of integers localized at p\n206\ndeg f(x)\ndegree of a polynomial\n210\nR[x]\nring of polynomials over a ring R\n210\nR[x1, x2, . . .",
    ", xn]\nring of polynomials in n indeterminants\n212\nϕα\nevaluation homomorphism at α\n212\nQ(x)\nfield of rational functions over Q\n228\nν(a)\n",
    "Euclidean valuation of a\n231\nF(x)\nfield of rational functions in x\n235\nF(x1, . . .",
    ", xn)\nfield of rational functions in x1, . . .",
    ", xn\n235\n",
    "a ⪯b\na is less than b\n238\na ∨b\njoin of a and b\n240\na ∧b\nmeet of a and b\n240\nI\nlargest element in a lattice\n241\nO\nsmallest element in a lattice\n241\na′\ncomplement of a in a lattice\n241\ndim V\ndimension of a vector space V\n256\nU ⊕V\ndirect sum of vector spaces U and V\n258\nHom(V, W)\nset of all linear transformations from U into V\n258\nV ∗\ndual of a vector space V\n258\nF(α1, . .",
    ".",
    ", αn)\nsmallest field containing F and α1, . .",
    ".",
    ", αn\n262\n",
    "[E : F]\ndimension of a field extension of E over F\n265\nGF(pn)\nGalois field of order pn\n280\nF ∗\nmultiplicative group of a field F\n281\nG(E/F)\nGalois group of E over F\n294\nF{σi}\nfield fixed by the automorphism σi\n297\nFG\nfield fixed by the automorphism group G\n297\n∆2\ndiscriminant of a polynomial\n309\n\nIndex\nG-equivalent, 169\nG-set, 168\nnth root of unity, 52, 303\nrsa cryptosystem, 84\nAbel, Niels Henrik, 302\nAbelian group, 34\nAckermann’s function, 26\nAdleman, L., 84\nAlgebraic closure, 267\nAlgebraic extension, 262\nAlgebraic number, 262\nAlgorithm\ndivision, 212\nEuclidean, 22\nAscending chain condition, 230\nAssociate elements, 228\nAtom, 244\nAutomorphism\ninner, 139\nBasis of a lattice, 151\nBieberbach, L., 154\nBinary operation, 33\nBinary symmetric channel, 95\nBoole, George, 248\nBoolean algebra\natom in a, 244\ndefinition of, 242\nfinite, 244\nisomorphism, 244\nBoolean function, 176, 251\nBurnside’s Counting Theorem, 173\nBurnside, William, 37, 130, 178\nCancellation law\nfor groups, 37\nfor integral domains, 194\nCardano, Gerolamo, 219\nCarmichael numbers, 89\nCauchy’s Theorem, 181\nCauchy, Augustin-Louis, 65\nCayley table, 34\nCayley’s Theorem, 117\nCayley, Arthur, 117\nCentralizer\nof a subgroup, 171\nCharacteristic of a ring, 194\nChinese Remainder Theorem\nfor integers, 201\nCipher, 81\nCiphertext, 81\nCircuit\nparallel, 246\nseries, 246\nseries-parallel, 246\nClass equation, 171\nCode\nbch, 287\ncyclic, 282\ngroup, 98\nlinear, 100\nminimum distance of, 96\npolynomial, 283\nCommutative diagrams, 136\nCommutative rings, 190\nComposite integer, 22\nComposition series, 163\nCongruence modulo n, 13\nConjugacy classes, 171\nConjugate elements, 294\nConjugate, complex, 49\nConjugation, 169\n339\n\nINDEX\n340\nConstructible number, 271\nCorrespondence Theorem\nfor groups, 137\nfor rings, 198\nCoset\nleader, 108\nleft, 74\nrepresentative, 74\nright, 74\nCoset decoding, 107\nCryptanalysis, 82\nCryptosystem\nrsa, 84\naﬀine, 83\ndefinition of, 81\nmonoalphabetic, 82\npolyalphabetic, 83\nprivate key, 81\npublic key, 81\nsingle key, 81\nCycle\ndefinition of, 61\ndisjoint, 61\nDe Morgan’s laws\nfor Boolean algebras, 243\nfor sets, 5\nDe Morgan, Augustus, 248\nDecoding table, 108\nDeligne, Pierre, 275\nDeMoivre’s Theorem, 51\nDerivative, 279\nDeterminant, Vandermonde, 285\nDickson, L. E., 130\nDiﬀie, W., 83\nDirect product of groups\nexternal, 118\ninternal, 120\nDiscriminant\nof the cubic equation, 223\nof the quadratic equation, 222\nDivision algorithm\nfor integers, 20\nfor polynomials, 212\nDivision ring, 190\nDomain\nEuclidean, 231\nprincipal ideal, 229\nunique factorization, 228\nDoubling the cube, 274\nEisenstein’s Criterion, 217\nElement\nassociate, 228\nidentity, 34\ninverse, 34\nirreducible, 228\norder of, 47\nprime, 228\nprimitive, 297\ntranscendental, 262\nEquivalence class, 12\nEquivalence relation, 11\nEuclidean algorithm, 22\nEuclidean domain, 231\nEuclidean group, 147\nEuclidean inner product, 144\nEuclidean valuation, 231\nEuler ϕ-function, 77\nEuler, Leonhard, 78, 275\nExtension\nalgebraic, 262\nfield, 260\nfinite, 264\nnormal, 299\nradical, 303\nseparable, 279, 296\nsimple, 262\nExternal direct product, 118\nFaltings, Gerd, 275\nFeit, W., 130, 178\nFermat’s factorizationalgorithm, 88\nFermat’s Little Theorem, 78\nFermat, Pierre de, 77, 274\nFerrari, Ludovico, 219\nFerro, Scipione del, 219\nField, 191\nalgebraically closed, 267\nbase, 260\nextension, 260\nfixed, 298\nGalois, 280\nof fractions, 227\nof quotients, 227\nsplitting, 268\nFinitely generated group, 158\nFior, Antonio, 219\nFirst Isomorphism Theorem\nfor groups, 135\nfor rings, 197\nFixed point set, 169\n\nINDEX\n341\nFreshman’s Dream, 278\nFunction\nbijective, 7\nBoolean, 176, 251\ncomposition of, 7\ndefinition of, 6\ndomain of, 6\nidentity, 9\ninjective, 7\ninvertible, 9\none-to-one, 7\nonto, 7\nrange of, 6\nsurjective, 7\nswitching, 176, 251\nFundamental Theorem\nof Algebra, 268, 307\nof Arithmetic, 22\nof Finite Abelian Groups, 159\nFundamental Theorem of Galois Theory,\n300\nGalois field, 280\nGalois group, 294\nGalois, Évariste, 37, 302\nGauss’s Lemma, 232\nGauss, Karl Friedrich, 234\nGaussian integers, 194\nGenerator of a cyclic subgroup, 46\nGenerators for a group, 158\nGlide reflection, 148\nGorenstein, Daniel, 130\nGreatest common divisor\nof two integers, 20\nof two polynomials, 214\nGreatest lower bound, 239\nGreiss, R., 130\nGrothendieck, Alexander, 275\nGroup\np-group, 159, 181\nabelian, 34\naction, 168\nalternating, 64\ncenter of, 171\ncircle, 52\ncommutative, 34\ncyclic, 46\ndefinition of, 33\ndihedral, 65\nEuclidean, 147\nfactor, 126\nfinite, 36\nfinitely generated, 158\nGalois, 294\ngeneral linear, 35, 143\ngenerators of, 158\nhomomorphism of, 133\ninfinite, 36\nisomorphic, 114\nisomorphism of, 114\nnonabelian, 34\nnoncommutative, 34\nof units, 35\norder of, 36\northogonal, 144\npermutation, 60\npoint, 152\nquaternion, 36\nquotient, 126\nsimple, 127, 130\nsolvable, 165\nspace, 152\nspecial linear, 38, 143\nspecial orthogonal, 147\nsymmetric, 59\nsymmetry, 149\nGödel, Kurt, 248\nHamming distance, 96\nHamming, R., 98\nHellman, M., 83\nHilbert, David, 154, 200, 248, 275\nHomomorphic image, 133\nHomomorphism\ncanonical, 135, 197\nevaluation, 196, 212\nkernel of a group, 134\nkernel of a ring, 195\nnatural, 135, 197\nof groups, 133\nring, 195\nIdeal\ndefinition of, 196\nmaximal, 198\none-sided, 197\nprime, 199\nprincipal, 196\ntrivial, 196\ntwo-sided, 197\nIndeterminate, 209\nIndex of a subgroup, 75\n\nINDEX\n342\nInduction\nfirst principle of, 17\nsecond principle of, 19\nInfimum, 239\nInner product, 99\nIntegral domain, 190\nInternal direct product, 120\nInternational standard book number, 44\nIrreducible element, 228\nIrreducible polynomial, 215\nIsometry, 148\nIsomorphism\nof Boolean algebras, 244\nof groups, 114\nring, 195\nJoin, 240\nJordan, C., 130\nJordan-Hölder Theorem, 164\nKernel\nof a group homomorphism, 134\nof a ring homomorphism, 195\nKey\ndefinition of, 81\nprivate, 81\npublic, 81\nsingle, 81\nKlein, Felix, 37, 141, 200\nKronecker delta, 103, 145\nKronecker, Leopold, 275\nKummer, Ernst, 275\nLagrange’s Theorem, 76\nLagrange, Joseph-Louis, 37, 65, 78\nLaplace, Pierre-Simon, 65\nLattice\ncompleted, 241\ndefinition of, 240\ndistributive, 242\nLattice of points, 151\nLattices, Principle of Duality for, 240\nLeast upper bound, 239\nLeft regular representation, 117\nLie, Sophus, 37, 184\nLinear combination, 254\nLinear dependence, 254\nLinear independence, 254\nLinear map, 141\nLinear transformation\ndefinition of, 9, 141\nLower bound, 239\nMapping, see Function\nMatrix\ndistance-preserving, 145\ngenerator, 101\ninner product-preserving, 145\ninvertible, 142\nlength-preserving, 145\nnonsingular, 143\nnull space of, 100\northogonal, 144\nparity-check, 101\nsimilar, 12\nunimodular, 151\nMatrix, Vandermonde, 285\nMaximal ideal, 198\nMaximum-likelihood decoding, 94\nMeet, 240\nMinimal generator polynomial, 284\nMinimal polynomial, 263\nMinkowski, Hermann, 275\nMonic polynomial, 209\nMordell-Weil conjecture, 275\nMultiplicity of a root, 296\nNoether, A. Emmy, 199\nNoether, Max, 199\nNormal extension, 299\nNormal series of a group, 162\nNormal subgroup, 125\nNormalizer, 182\nNull space\nof a matrix, 100\nOdd Order Theorem, 186\nOrbit, 169\nOrthogonal group, 144\nOrthogonal matrix, 144\nOrthonormal set, 145\nPartial order, 238\nPartially ordered set, 238\nPartitions, 12\nPermutation\ncycle structure of, 79\ndefinition of, 9, 59\neven, 64\nodd, 64\nPermutation group, 60\nPlaintext, 81\nPolynomial\n\nINDEX\n343\ncode, 283\ncontent of, 232\ndefinition of, 209\ndegree of, 210\nerror, 291\nerror-locator, 291\ngreatest common divisor of, 214\nin n indeterminates, 212\nirreducible, 215\nleading coeﬀicient of, 209\nminimal, 263\nminimal generator, 284\nmonic, 209\nprimitive, 232\nroot of, 214\nseparable, 296\nzero of, 214\nPolynomial separable, 279\nPoset\ndefinition of, 238\nlargest element in, 241\nsmallest element in, 241\nPower set, 238\nPrime element, 228\nPrime ideal, 199\nPrime integer, 22\nPrimitive nth root of unity, 52, 303\nPrimitive element, 297\nPrimitive Element Theorem, 297\nPrimitive polynomial, 232\nPrincipal ideal, 196\nPrincipal ideal domain (pid), 229\nPrincipal series, 163\nPseudoprime, 89\nQuaternions, 36, 192\nResolvent cubic equation, 223\nRigid motion, 31, 148\nRing\ncharacteristic of, 194\ncommutative, 190\ndefinition of, 190\ndivision, 190\nfactor, 197\nhomomorphism, 195\nisomorphism, 195\nNoetherian, 230\nquotient, 197\nwith identity, 190\nwith unity, 190\nRivest, R., 84\nRuﬀini, P., 302\nRussell, Bertrand, 248\nScalar product, 252\nSecond Isomorphism Theorem\nfor groups, 136\nfor rings, 198\nShamir, A., 84\nShannon, C., 98\nSieve of Eratosthenes, 26\nSimple extension, 262\nSimple group, 127\nSimple root, 296\nSolvability by radicals, 303\nSpanning set, 254\nSplitting field, 268\nSquaring the circle is impossible, 274\nStandard decoding, 107\nSubgroup\np-subgroup, 181\ncentralizer, 171\ncommutator, 185\ncyclic, 46\ndefinition of, 38\nindex of, 75\nisotropy, 169\nnormal, 125\nnormalizer of, 182\nproper, 38\nstabilizer, 169\nSylowp-subgroup, 182\ntranslation, 152\ntrivial, 38\nSubnormal series of a group, 162\nSubring, 193\nSupremum, 239\nSwitch\nclosed, 246\ndefinition of, 246\nopen, 246\nSwitching function, 176, 251\nSylow p-subgroup, 182\nSylow, Ludvig, 184\nSyndrome of a code, 106, 291\nTartaglia, 219\nThird Isomorphism Theorem\nfor groups, 137\nfor rings, 198\nThompson, J., 130, 178\n\nINDEX\n344\nTranscendental element, 262\nTranscendental number, 262\nTransposition, 63\nTrisection of an angle, 274\nUnique factorization domain (ufd), 228\nUnit, 190, 228\nUniversal Product Code, 43\nUpper bound, 239\nVandermonde determinant, 285\nVandermonde matrix, 285\nVector space\nbasis of, 255\ndefinition of, 252\ndimension of, 256\nsubspace of, 253\nWeight of a codeword, 96\nWeil, André, 275\nWell-defined map, 7\nWell-ordered set, 19\nWhitehead, Alfred North, 248\nZero\nmultiplicity of, 296\nof a polynomial, 214\nZero divisor, 191\n\nColophon\n",
    "This book was authored and produced with PreTeXt11.\n",
    "12pretextbook.org\n\n",
    "Discrete Mathematics\nAn Open Introduction, 4th Edition\n\nDiscrete\nMathematics\nAn Open Introduction\nOscar Levin\n4th Edition\n\nOscar Levin\nSchool of Mathematical Science\nUniversity of Northern Colorado\nGreeley, Co 80639\noscar.levin@unco.edu\nhttp://math.oscarlevin.com/\n© 2013-2024 by Oscar Levin\n",
    "This work is licensed under the Creative Commons Attribution-ShareAlike 4.0\nInternational License.",
    "To view a copy of this license, visit\nhttp://creativecommons.org/licenses/by-sa/4.0/.\n4th Edition\n",
    "A current version can always be found for free at\nhttp://discrete.openmathbooks.org/\nCover image: Tiling with Fibonacci and Pascal.\n\n\n",
    "For Madeline and Teagan\n\n\nAcknowledgements\n",
    "This book would not exist if not for “Discrete and Combinatorial Mathematics,” by\nRichard Grassl and Tabitha Mingus.",
    "It is the book I learned discrete math out of,\nand that I taught with the semester before I began writing this text.",
    "I wanted to\nmaintain the inquiry-based feel of their book but update, expand, and rearrange\nsome of the material.",
    "Some of the best exposition and exercises here were graciously\ndonated from this source.\n",
    "Thanks go to the graduate students who have co-taught the Discrete Mathematics\ncourse with me over the years, including Evan Czysz, Alees Lee, and Sarah Sparks,\nwho helped develop new activities and exercises that have been incorporated into\nthis text.",
    "Michelle Morgan provided copy-editing support, and Jennifer Zakotnik-\nGutierrez helped code many of the interactive exercises in the online version of the\nbook.",
    "Thanks also to Katie Morrison, Nate Eldredge, and Richard Grassl (again) for\ntheir suggestions after using parts of this text in their classes.\n",
    "The online version of the book is written in PreTeXt and hosted on Runestone\nAcademy thanks to the tremendous development work of Rob Beezer, Brad Miller,\nDavid Farmer, and Alex Jordan along with the rest of the participants of the\npretext-support group1.\n",
    "Finally, a thank you to the numerous students who have pointed out typos and\nmade suggestions over the years, and a thanks in advance to those who will do so in\nthe future.\n",
    "1groups.google.com/g/pretext-support\nvii\n\n\nPreface\n",
    "This text aims to introduce select topics in discrete mathematics at a level appropriate\nfor first- or second-year undergraduate math and computer science majors, especially\nthose who intend to teach middle and high school mathematics.",
    "The book began\nas a set of notes for the Discrete Mathematics course at the University of Northern\nColorado.",
    "This course serves both as a survey of the topics in discrete math and as\nthe “bridge” course for math majors, as UNC does not offer a separate “introduction\nto proofs” course.",
    "As this course has evolved to support our computer science\nmajor, so has the text.",
    "The current version of the book is intended to support\ninquiry-based teaching for understanding that is so crucial for future teachers,\nwhile also providing the necessary mathematical foundation and application-based\nmotivation for computer science students.",
    "While teaching the course in Spring\n2024 using an early version of this edition, I was pleasantly surprised by how many\nstudents reported that they, for the first time, saw how useful math could be in the\n“real world.”",
    "I hope that this experience can be replicated in other classes using this\ntext.\n",
    "This book is intended to be used in a class taught using problem-oriented or\ninquiry-based methods.",
    "Each section begins with a preview of the content that\nincludes an open-ended Investigate!",
    "motivating question, as well as a structured\npreview activity.",
    "The preview activities are carefully scaffolded to provide an\nentry-point to the section’s topic and to prime students to engage deeply in the\nmaterial.",
    "Depending on the pace of the class, I have found success assigning only\nthe section preview before class, using the preview activity as in-class group work,\nor assigning the entire section to be read before class (each section concludes with a\nsmall set of reading questions that can be assigned to encourage students to actually\nread).",
    "For those readers using this book for self-study, the organization of the\nsections will hopefully mimic the style of a rich inquiry-based classroom.\n",
    "The topics covered in this text were chosen to match the needs of the students I\nteach at UNC.",
    "The main areas of study are logic and proof, graph theory, combina-\ntorics, and sequences.",
    "Induction is covered at the end of the chapter on sequences.\n",
    "Discrete structures are introduced “as needed”, but a more thorough treatment of\nsets and functions is included as a separate chapter, which can be studied indepen-\ndent of the other content.",
    "The final chapter covers two additional topics: generating\nfunctions and number theory.\n",
    "While I believe this selection and order of topics is optimal, you should feel free\nto skip around to what interests you.",
    "There are occasionally examples and exercises\nthat rely on earlier material, but I have tried to keep these to a minimum, and they\nusually can either be skipped or understood without too much additional study.",
    "If\nyou are an instructor, you can also create a custom version by editing the PreTeXt\nsource to fit your needs.\n",
    "ix\n\nx\nImprovements to the 4th Edition.\n",
    "Many of the sections have been rewritten to\nimprove the clarity of the exposition.\n",
    "• Nearly 300 new exercises, bringing the total to more than 750.",
    "These are better\ndivided into preview activity questions, reading questions, practice problems,\nand additional exercises.",
    "Most of the new exercises are interactive for the\nonline version.\n",
    "• New sections on probability, relations, and discrete structures and their proofs.\n",
    "Some other sections have been split up to make it more likely that a single\nclass period can be devoted to a single topic.\n",
    "• Improved presentation for the counting chapter with a focus on considering\nsets of outcomes more than following rules.\n",
    "•",
    "The Investigate!",
    "activities of the 3rd Edition have been split into two types:\nInvestigate!",
    "questions and Preview Activities.",
    "The former are open-ended\nquestions designed to engage you with the topic soon to be discussed.",
    "The\nlatter are structured preview activities that you should be able to completely\nanswer before reading the section.\n",
    "The previous editions (3rd Edition, released in 2019, 2nd Edition, released in\n2016, and the Fall 2015 Edition) will still be available for instructors who wish to use\nthose versions due to familiarity.\n",
    "I plan to continue improving the book.",
    "Some of this will happen in real-time\nby updating the online versions to include new content (numbering will remain\nconsistent).",
    "Thus I encourage you to send along any suggestions and comments as\nyou have them.\n",
    "Oscar Levin, Ph.D.\nUniversity of Northern Colorado, 2024\n\nHow to Use This Book\nIn addition to expository text, this book has a few features designed to encourage\nyou to interact with the mathematics.\n",
    "Investigate!",
    "questions.\n",
    "Sprinkled throughout the sections (usually at the very\nbeginning of a topic) you will find open-ended questions designed to engage you\nwith the topic soon to be discussed.",
    "You really should spend some time thinking\nabout, or even working through, these problems before reading the section.",
    "However,\ndon’t worry if you cannot find a satisfying solution right away.",
    "The goal is to pique\nyour interest, so you will read what is next looking for answers.\n",
    "Preview Activities.\n",
    "Most sections include a structured preview activity.",
    "These\ncontain leading questions that you should be able to completely answer before\nreading the section.",
    "The idea is that the questions prime you to engage meaningfully\nwith the new content ahead.",
    "If you are using the online version, most of these\nquestions will provide you with immediate feedback so you can be confident moving\nforward.\n",
    "Examples.\n",
    "I have tried to include the “correct” number of examples.",
    "For those\nexamples that include problems, full solutions are included.",
    "Before reading the\nsolution, try to at least have an understanding of what the problem is asking.",
    "Unlike\nsome textbooks, the examples are not meant to be all-inclusive for problems you\nwill see in the exercises.",
    "They should not be used as a blueprint for solving other\nproblems.",
    "Instead, use the examples to deepen your understanding of the concepts\nand techniques discussed in each section.",
    "Then use this understanding to solve the\nexercises at the end of each section.\nExercises.\n",
    "You get good at math through practice.",
    "Each section concludes with\npractice problems meant to solidify concepts and basic skills presented in that\nsection; the online version provides immediate feedback on these problems.",
    "There\nare then additional exercises that are more challenging and open-ended.",
    "These\nmight be assigned as written homework or used in class as group work.",
    "Some of the\nadditional exercises have hints or solutions in the back of the book, but use these\nas little as possible.",
    "Struggle is good for you.",
    "At the end of each chapter, a larger\ncollection of similar exercises is included (as a sort of “chapter review”) which might\nbridge the material of different sections in that chapter.\n",
    "Interactive Online Version.\n",
    "For those of you reading this in print or as a PDF, I\nencourage you to also check out the interactive online version.",
    "Many of the preview\nactivities and exercises are interactive and can give you immediate feedback.",
    "Some of\nxi\n\nxii\nthese have randomized components, allowing you to practice many similar versions\nof the same problems until you master the topic.\n",
    "Hints and solutions to examples are also hidden away behind an extra click to\nencourage you to think about the problem before reading the solution.",
    "There is a\ngood search feature available as well, and the index has expandable links to see the\ncontent without jumping to the page immediately.",
    "There is also a python scratch\npad (the pencil icon) so you can try out some code if you feel so inclined.\n",
    "Additional interactivity is planned.",
    "These “bonus” features will be added on a\nrolling basis, so keep an eye out!\n",
    "You can view the interactive version for free at discrete.openmathbooks.org or by\nscanning the QR code below.\n\n",
    "Contents\nAcknowledgements\nvii\nPreface\nix\nHow to Use This Book\nxi\n0 Introduction and Preliminaries\n1\n0.1\n",
    "What is Discrete Mathematics?\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "1\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "4\n0.2\nDiscrete Structures .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "5\n0.2.1\nIntroduction.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "5\n0.2.2\nSets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "5\n0.2.3\nFunctions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "6\n0.2.4\nSequences.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "8\n0.2.5\nRelations .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "9\n0.2.6\nGraphs .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "10\n0.2.7\nEven More Structures .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "10\n0.2.8\nReading Questions .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "11\n1 Logic and Proofs\n13\n1.1\nMathematical Statements.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "13\n1.1.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "14\n1.1.2\nAtomic and Molecular Statements .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "17\n1.1.3\nQuantifiers and Predicates .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "22\n1.1.4\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "25\n1.1.5\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "26\n1.1.6\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "28\n1.2\nImplications .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "30\n1.2.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "30\n1.2.2\nUnderstanding the Truth Table\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "32\n1.2.3\nRelated Statements .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n35\n1.2.4\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "40\n1.2.5\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "40\n1.2.6\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n42\n1.3\nRules of Logic .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n44\n1.3.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "44\n1.3.2\nTruth Tables .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "46\n1.3.3\nLogical Equivalence.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "48\nxiii\n\nxiv\nContents\n1.3.4\nEquivalence for Quantified Statements .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n",
    "51\n1.3.5\nDeductions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "55\n1.3.6\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "57\n1.3.7\nPractice Problems.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "57\n1.3.8\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "58\n1.4\nProofs .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "62\n1.4.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "62\n1.4.2\nDirect Proof .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    ".\n.\n",
    "64\n1.4.3\nProof by Contrapositive .\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "69\n1.4.4\nProof by Contradiction\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "71\n1.4.5\nSummary of Proof Styles .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "74\n1.4.6\nReading Questions .\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "76\n1.4.7\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "77\n1.4.8\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n79\n1.5\nProofs about Discrete Structures .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n83\n1.5.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n83\n1.5.2\nProofs about Sets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n85\n1.5.3\nProofs about Functions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "87\n1.5.4\nProofs about Relations.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "89\n1.5.5\nProofs about Graphs\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "90\n1.5.6\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    ".\n.\n",
    "92\n1.5.7\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "92\n1.5.8\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n94\n1.6\nChapter Summary\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "96\nChapter Review .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "97\n2 Graph Theory\n99\n2.1\nProblems and Definitions.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "99\n2.1.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n100\n2.1.2\nWhat is a Graph? .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "102\n2.1.3\nReading Questions .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "111\n2.1.4\nPractice Problems.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n111\n2.1.5\nAdditional Exercises\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "113\n2.2\nTrees .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "117\n2.2.1\nSection Preview\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "117\n2.2.2\nProperties of Trees .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "119\n2.2.3\nSpanning Trees.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "122\n2.2.4\nRooted Trees\n.\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "123\n2.2.5\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "125\n2.2.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "125\n2.2.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "126\n\nContents\nxv\n2.3\nPlanar Graphs .\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "129\n2.3.1\nSection Preview\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "129\n2.3.2\nEuler’s Formula for Planar Graphs .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "131\n2.3.3\nNon-planar Graphs .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "132\n2.3.4\nPolyhedra.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n134\n2.3.5\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n137\n2.3.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n137\n2.3.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "138\n2.4\nEuler Trails and Circuits .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "141\n2.4.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "141\n2.4.2\nConditions for Euler Trails .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "143\n2.4.3\nHamilton Paths\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "144\n2.4.4\nReading Questions .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "145\n2.4.5\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n146\n2.4.6\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "147\n2.5\nColoring\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "150\n2.5.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "150\n2.5.2\nColoring Vertices .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "152\n2.5.3\nColoring Edges\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "157\n2.5.4\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "158\n2.5.5\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "158\n2.5.6\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n159\n2.6\nRelations and Graphs .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n163\n2.6.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "163\n2.6.2\nRelations Generally .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "165\n2.6.3\nProperties of Relations.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "170\n2.6.4\nEquivalence Relations .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "172\n2.6.5\nEquivalence Classes and Partitions .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "174\n2.6.6\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "177\n2.6.7\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n177\n2.6.8\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n179\n2.7\nMatching in Bipartite Graphs .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "181\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "183\n2.8\nChapter Summary\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "186\nChapter Review .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "186\n3 Counting\n191\n3.1\nPascal’s Arithmetical Triangle .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "191\n3.1.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n192\n3.1.2\nLattice Paths.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "195\n3.1.3\nBit Strings.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "197\n3.1.4\nSubsets and Pizzas .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "199\n3.1.5\nAlgebra? .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "201\n3.1.6\nReading Questions .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "202\n\nxvi\nContents\n3.1.7\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "203\n3.1.8\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n204\n3.2\nCombining Outcomes .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n205\n3.2.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n205\n3.2.2\nWhat are Outcomes? .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "206\n3.2.3\nThe Sum and Product Principles .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "207\n3.2.4\nCombining Principles .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "213\n3.2.5\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "215\n3.2.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "215\n3.2.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "217\n3.3\nNon-Disjoint Outcomes\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "218\n3.3.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "218\n3.3.2\nCounting with Venn Diagrams\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "219\n3.3.3\nThe Principle of Inclusion/Exclusion .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "222\n3.3.4\nOverlaps and the Product Principle\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "225\n3.3.5\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "226\n3.3.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "227\n3.3.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n228\n3.4\nCombinations and Permutations .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n230\n3.4.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n230\n3.4.2\nCounting Sequences\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "232\n3.4.3\nCounting Sets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "234\n3.4.4\nThe Quotient Principle.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n239\n3.4.5\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "241\n3.4.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "241\n3.4.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "243\n3.5\nCounting Multisets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "244\n3.5.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "244\n3.5.2\nHave Some Cookies .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "246\n3.5.3\nRepresenting Multisets with Bit Strings .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "249\n3.5.4\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "252\n3.5.5\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "253\n3.5.6\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "254\n3.6\nCombinatorial Proofs .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "256\n3.6.1\nSection Preview\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "256\n3.6.2\nPatterns in Pascal’s Triangle.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "258\n3.6.3\nMore Proofs .\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "262\n3.6.4\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "267\n3.6.5\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "267\n3.6.6\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "268\n3.7\nApplications to Probability .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "273\n3.7.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "273\n3.7.2\nComputing Probabilities .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "275\n3.7.3\nProbability Rules .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "278\n3.7.4\nConditional Probability .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "283\n\nContents\nxvii\n3.7.5\nReading Questions .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "285\n3.7.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "286\n3.7.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "288\n3.8\nAdvanced Counting Using PIE\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "290\n3.8.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "290\n3.8.2\nPIE for Multisets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "291\n3.8.3\nCounting Derangements .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "295\n3.8.4\nCounting Functions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "296\n3.8.5\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "302\n3.8.6\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n304\n3.9\nChapter Summary\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "305\nChapter Review .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "306\n4 Sequences\n311\n4.1\nDescribing Sequences .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "311\n4.1.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "311\n4.1.2\nSequences and Formulas .\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "313\n4.1.3\nPartial Sums and Differences .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "319\n4.1.4\nSequences in python\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "322\n4.1.5\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "323\n4.1.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "323\n4.1.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "324\n4.2\nRate of Growth.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n327\n4.2.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n327\n4.2.2\nArithmetic Sequences .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "328\n4.2.3\nGeometric Sequences .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "330\n4.2.4\nBeyond Arithmetic and Geometric Sequences\n.\n.\n",
    ".\n.\n.\n.\n.\n",
    "332\n4.2.5\nReading Questions .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "334\n4.2.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "334\n4.2.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "335\n4.3\nPolynomial Sequences .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n338\n4.3.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "338\n4.3.2\nSumming Arithmetic Sequences: Reverse and Add\n.\n.\n",
    ".\n.\n.\n",
    "340\n4.3.3\nHigher Degree Polynomials.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "342\n4.3.4\nSolving Systems of Equations with Technology .\n.\n",
    ".\n.\n.\n.\n.\n",
    "347\n4.3.5\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "348\n4.3.6\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "349\n4.3.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n350\n4.4\nExponential Sequences.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "353\n4.4.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "353\n4.4.2\nSumming Geometric Sequences: Multiply, Shift, and Subtract .\n",
    "354\n4.4.3\nThe Characteristic Root Technique .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "356\n4.4.4\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "359\n4.4.5\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "360\n\nxviii\nContents\n4.4.6\nAdditional Exercises\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "360\n4.5\nProof by Induction .\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "363\n4.5.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "363\n4.5.2\nRecursive Reasoning\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "364\n4.5.3\nFormalizing Proofs .\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "364\n4.5.4\nExamples .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "366\n4.5.5\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "369\n4.5.6\nPractice Problems.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "370\n4.5.7\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n373\n4.6\nStrong Induction .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n377\n4.6.1\nSection Preview\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "377\n4.6.2\nDivide and Conquer\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "379\n4.6.3\nReading Questions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "381\n4.6.4\nPractice Problems.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n381\n4.6.5\nAdditional Exercises\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "382\n4.7\nChapter Summary\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "385\nChapter Review .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "386\n5 Discrete Structures Revisited\n389\n5.1\nSets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n389\n5.1.1\nNotation .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n389\n5.1.2\nRelationships between Sets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "393\n5.1.3\nOperations on Sets .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "395\n5.1.4\nVenn Diagrams\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "398\n5.1.5\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "399\n5.2\nFunctions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "403\n5.2.1\nDescribing Functions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "404\n5.2.2\nSurjections, Injections, and Bĳections .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "409\n5.2.3\nImage and Inverse Image.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "411\n5.2.4\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "414\n6 Additional Topics\n421\n6.1\nGenerating Functions .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "421\n6.1.1\nBuilding Generating Functions\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "422\n6.1.2\nDifferencing .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n424\n6.1.3\nMultiplication and Partial Sums .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "427\n6.1.4\nSolving Recurrence Relations with Generating Functions .\n",
    ".\n.\n",
    "428\n6.1.5\nExercises .\n.\n.\n",
    ".\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "429\n6.2\nIntroduction to Number Theory .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "432\n6.2.1\nDivisibility .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "432\n6.2.2\nRemainder Classes .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "435\n6.2.3\nProperties of Congruence\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "437\n6.2.4\nSolving Congruences .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n441\n6.2.5\nSolving Linear Diophantine Equations\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "443\n\nContents\nxix\n6.2.6\nExercises .\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n",
    "447\nAppendices\nA Selected Hints\n449\nB Selected Solutions\n459\nC List of Symbols\n517\nBack Matter\nIndex\n519\n\n\nChapter 0\nIntroduction and Preliminaries\nWelcome to Discrete Mathematics.",
    "If this is your first time encountering the subject,\nyou will probably find discrete mathematics quite different from other math subjects.\n",
    "You might not even know what discrete math is!",
    "Hopefully this short introduction\nwill shed some light on what the subject is about and what you can expect as you\nmove forward in your studies.\n",
    "0.1\nWhat is Discrete Mathematics?\ndis·crete / dis’krët.\n",
    "Adjective: Individually separate and distinct.\n",
    "Synonyms: separate - detached - distinct - abstract.\n",
    "Defining discrete mathematics is hard because defining mathematics is hard.",
    "What is\nmathematics?",
    "The study of numbers?",
    "In part yes, but you also study functions and\nlines and triangles and parallelepipeds and vectors and . . . .",
    "Or perhaps you want\nto say that mathematics is a collection of tools that allow you to solve problems.\n",
    "What sort of problems?",
    "Well, those that involve numbers, functions, lines, triangles,\n. . . .",
    "Whatever your conception of what mathematics is, try applying the concept of\n“discrete” to it, as defined above.",
    "Some math fundamentally deals with stuff that is\nindividually separate and distinct.\n",
    "In an algebra or calculus class, you might have found a particular set of numbers\n(perhaps they constitute the range of a function).",
    "You would represent this set as an\ninterval: [0, ∞) is the range of 𝑓(𝑥) = 𝑥2 since the set of outputs of the function are\nall real numbers 0 and greater.",
    "This set of numbers is NOT discrete.",
    "The numbers in\nthe set are not separated by much at all.",
    "In fact, take any two numbers in the set and\nthere are infinitely many more between them that are also in the set.\n",
    "Discrete math could still ask about the range of a function, but the set would\nnot be an interval.",
    "Consider the function that gives the number of children of\neach person reading this.",
    "What is the range?",
    "I’m guessing it is something like\n{0, 1, 2, 3, 4}.",
    "Maybe 5 or 6 is in there too.1",
    "But certainly nobody reading this has\n1.32419 children.",
    "This output set is discrete because the elements are separate.",
    "The\ninputs to the function also form a discrete set because each input is an individual\nperson.\n",
    "There are many discrete mathematical objects besides sets of numbers; we will\nintroduce some of these in Section 0.2.",
    "Studying these discrete structures is the main\n1Even larger natural numbers for old ladies who live in shoes.\n",
    "1\n\n2\n0.",
    "Introduction and Preliminaries\nfocus of discrete mathematics and this book.",
    "However, the reason we want to study\nthese structures is because they provide a way to model “real-world” problems.2\nTo get a feel for the subject, let’s consider the types of problems you solve in\ndiscrete math.",
    "Here are a few simple examples:\nInvestigate!\n",
    "Note: Throughout the book you will see Investigate!",
    "activities like this one.",
    "Answer\nthe questions in these as best you can to give yourself a feel for what is coming next.\n",
    "1.",
    "The most popular mathematician in the world is throwing a party for\nall of his friends.",
    "To kick things off, they decide that everyone should\nshake hands.",
    "Assuming all 10 people at the party each shake hands\nwith every other person (but not themselves, obviously) exactly once,\nhow many handshakes take place?\n",
    "2.",
    "At the warm-up event for Oscar’s All-Star Hot Dog Eating Contest, Al\nate one hot dog.",
    "Bob then showed him up by eating three hot dogs.\n",
    "Not to be outdone, Carl ate five.",
    "This continued with each contestant\neating two more hot dogs than the previous contestant.",
    "How many\nhot dogs did Zeno (the 26th and final contestant) eat?",
    "How many hot\ndogs were eaten in total?\n3.",
    "After excavating for weeks, you finally arrive at the burial chamber.\n",
    "The room is empty except for two large chests.",
    "On each is carved a\nmessage (strangely in English):\nExactly one of these\nchests contains a treasure,\nwhile the other is filled with\ndeadly immortal scorpions.\n",
    "For either chest, if the\nchest’s message is true, then\nthe chest contains treasure.\n",
    "The problem is, you don’t know whether the messages are true or\nfalse.",
    "What do you do?\n",
    "4.",
    "Back in the days of yore, five small towns decided they wanted to\nbuild roads directly connecting each pair of towns.",
    "While the towns\nhad plenty of money to build roads as long and as winding as they\nwished, it was very important that the roads not intersect with each\nother (as stop signs had not yet been invented).",
    "Also, tunnels and\nbridges were not allowed, for moral reasons.",
    "Is it possible for each of\nthese towns to build a road to each of the four other towns without\ncreating any intersections?\n2Many of the problems discussed in this book are admittedly contrived and clearly fictional, but\nhopefully you will see how these toy problems can be generalized to actually represent problems that\npeople would care about in reality.\n\n0.1.",
    "What is Discrete Mathematics?\n3\nAs you consider the problems above, don’t worry if it is not obvious to you\nwhat the solutions are.",
    "We are more interested here in what sort of information we\nneed to be able to answer the questions.",
    "How can we represent the situation using\nindividually separate and distinct objects?",
    "Don’t read on until you have thought\nabout at least this for each of the questions.\n",
    "Ready?",
    "Here are some things you might have thought about:\n1.",
    "The people at the party are individuals.",
    "We can consider the set of people.",
    "We\ncan also consider sets of pairs of people, since it takes exactly two people to\nshake hands.",
    "So the question is really, how many pairs can you make using\nelements from a 10-element set?\n",
    "For example, if there were three people at the party, conveniently named 1, 2,\nand 3, then the pairs would be (1, 2), (1, 3), and (2, 3).",
    "Or should we include\n(2, 1), (3, 1), and (3, 2) as well?\n2.",
    "To count the number of hot dogs eaten, either by an individual or in total,\nwe could use a sequence of integers (whole numbers).",
    "The 𝑛th term in the\nsequence might represent the number of hot dogs eaten by the 𝑛th contestant.\n",
    "We can consider a second sequence, also of integers, that gives the total number\nof hot dogs eaten by the first 𝑛contestants combined.\n",
    "The solution to the problem will then be the value of the 26th term in the\nsequence.",
    "To help us find this, we could consider the rate of growth of the\nsequences, as well as how these two sequences relate to each other.\n",
    "3. Logic questions also belong under the discrete math umbrella: Each statement\ncan have a value of True or False (and there is nothing in-between).",
    "To answer\nquestions like that of the chests of scorpions, we must understand the structure\nof the statements, and how the truth values of the parts of the statements\ninteract to determine the truth value of the whole statement.\n",
    "4.",
    "The last question is about a discrete structure called a graph, not to be confused\nwith a graph of a function or set of points.",
    "We can use a graph to represent\nwhich elements of a set (or towns) are related to each other (or connected by\na road).",
    "In this case, the question becomes, can we draw a graph with five\nvertices (towns) and ten edges (roads) such that no two edges intersect?\n",
    "The four problems above illustrate the four main topics of this book: combina-\ntorics (the theory of ways things combine; in particular, how to count these ways),\nsequences, symbolic logic, and graph theory.",
    "However, there are other topics\nthat are also considered part of discrete mathematics, including computer science,\nabstract algebra, number theory, game theory, probability, and geometry (some of\nthese, particularly the last two, have both discrete and non-discrete variants).\n",
    "Ultimately the best way to learn what discrete math is about is to do it.",
    "Let’s get\nstarted!",
    "Before we can begin answering more complicated (and fun) problems, we\nwill consider a very brief overview of the types of discrete structures we will be\nusing.\n\n4\n0.",
    "Introduction and Preliminaries\nReading Questions\nEach section of the book will end with a small number of Reading Questions like\nthe ones below.",
    "These are designed to help you reflect on what you have read.",
    "In\nparticular, the final reading question asks you to ask a question of your own.",
    "Thinking\nabout what you don’t yet know is a wonderful way to further your understanding of\nwhat you do.\n",
    "1.\n",
    "Right now, how would you describe what discrete mathematics is about, if\nyou were telling your friends about the class you are in?",
    "Write one or two\nsentences.\n",
    "2.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n\n",
    "0.2\nDiscrete Structures\n0.2.1\nIntroduction\nInvestigate!\n",
    "A double-six domino set consists of tiles containing pairs of numbers, each\nfrom 0 to 6.",
    "How many tiles are in a double-six domino set?",
    "How many\ndominoes are in a double-nine domino set?",
    "How many dominoes are in a\ndouble-𝑛domino set?\n",
    "Try it 0.2.1\nSpend a few minutes thinking about the questions above.",
    "Then write 2-3\nsentences describing your thoughts.",
    "You do not need to find a complete\nsolution, but you should describe what you could try and what you think you\nmight need to do to find a solution.\n",
    "We are taking a problem-solving approach to discrete mathematics: We will\nconsider a large variety of questions that have a discrete feel to them, and consider\nhow to answer those questions (and prove that our answers are correct).",
    "This is not\nthe only way to study discrete math.",
    "Another approach would be to study the tools\nused to solve the problems.",
    "If we were art students, we could study paintbrushes\nand easels and the composition of paint, which would be interesting for sure, but I\nthink it is more enjoyable to actually paint those happy little trees.\n",
    "That said, understanding your tools does help you use them, so in this section,\nwe will consider some basic tools used in discrete mathematics.",
    "We will come back\nto these throughout our studies and understand them better as we need to.\n",
    "The tools in our subject are called discrete structures.",
    "They are the mathematical\nobjects that we use to represent parts of the problems we are solving.",
    "“Structure”\nis a good word here, since these “things” have fairly rigid constraints that make\nthem what they are, just like an apartment building is going to have different\ncharacteristics than an airplane hangar or a suspension bridge (these are types of\nphysical structures, not mathematical structures, just to be overly clear and destroy\nthe metaphor).\n",
    "The structures we will use most in discrete math are sets, functions, sequences,\nrelations, and graphs.",
    "We now briefly preview each of these.",
    "As we progress\nthrough our studies, each will be explored in more detail.\n",
    "0.2.2\nSets\nA set is an unordered collection of elements.",
    "This is fairly vague, but unless we\nwant to spend a whole book trying to understand sets more precisely, it will be\ngood enough for us.",
    "It is possible to define all of mathematics using just sets (even\n5\n\n6\n0.",
    "Introduction and Preliminaries\nnumbers can be thought of as sets themselves), but this is also not what we will do.\n",
    "Rather, we want to be able to talk about collections of numbers and other objects,\nand we will collect them in something we call a set.\n",
    "We can describe sets by saying exactly what elements are members of the set.",
    "We\ncould specify this membership in words (e.g., Let 𝐴be the set of all natural numbers\nless than 10), or by explicitly listing all the elements (e.g., 𝐴= {3, 5, 7}), or using\nsomething called set comprehension (also called set builder notation).",
    "An example\nof this is 𝐴= {𝑥∈ℕ: 𝑥< 10}.",
    "We would read that as “𝐴is the set of natural\nnumbers that satisfy the property that they are less than 10.”",
    "More precisely, the ℕ\nsymbol represents the natural numbers, which is itself a set: ℕ= {0, 1, 2, 3, . . .}",
    "(this\nshows another way to describe a set).",
    "The ∈symbol means “is an element of”.",
    "The :\nis read “such that” and tells us that what comes next is the condition that must be\ntrue of the set’s elements.\n",
    "By the way...",
    "In this book, we define the natural numbers to be the whole\nnumbers starting with 0.",
    "Not every book includes 0 in this set.",
    "It largely\ndepends on what area of mathematics you study.\n",
    "Since there are multiple ways to describe the same set, we should be careful\nabout what it means for sets to be the same or different.",
    "A set is determined by its\nmembership, so all four of the following describe exactly the same set:\n1.",
    "{1, 2, 3, 4}.\n",
    "2. {1, 2, 1 + 1, 1 + 2, 2 + 2}.",
    "(How many numbers belong to this set?",
    "It’s not 5.)\n",
    "3. {2, 4, 1, 3}.",
    "(All that matters is what elements are in the collection, not what\norder they were written down in.)\n",
    "4. {𝑥∈ℕ: 𝑥< 5 and 𝑥≥1}.\n",
    "There are lots of things you can do with sets, which we will consider in more\ndetail as we need to.",
    "We will see that it is often helpful to build new sets from\nones we already have (by taking the union or intersection of sets, for example), to\ncompare sets (asking if one set is a subset of another), and to find the number of\nelements of a set (called its cardinality).",
    "We might also want to match up elements\nof one set with another: To do this, we might use a function, which we will discuss\nnext.",
    "Awesomely, we can also use sets themselves to describe functions.",
    "Let’s check\nit out.\n",
    "0.2.3\nFunctions\n",
    "One way to define a function is as a rule that assigns each input exactly one output.\n",
    "The output is called the image of the input.",
    "Functions also come equipped with a\ndomain, the set of all inputs, and a codomain, the set of all allowable outputs.",
    "You\nmight also speak of the range of the function, which is the set of all actual outputs,\nor put another way, the set of all images of elements from the domain.\n\n",
    "0.2.",
    "Discrete Structures\n7\nWe write 𝑓: 𝑋→𝑌to describe a function with name 𝑓, domain 𝑋and codomain\n𝑌.",
    "This does not tell us which function 𝑓is though.",
    "To define the function, we must\ndescribe the rule.",
    "Often this is done with a formula (for example, 𝑓(𝑥) = 𝑥2 says\nthat each element of the domain is mapped to its square), or in words (like how we\njust described the squaring function).",
    "We could also define a function with a table\nor a graph.\n",
    "The key thing that makes a rule a function is that there is exactly one output for\neach input.",
    "That is, the rule must be a good rule.",
    "What output do we assign to the\ninput 7?",
    "There can only be one answer for any particular function.\n",
    "Since a function maps one set (the domain) to another set (the codomain), there\nis an obvious connection between sets and functions.",
    "There is another connection\nworth considering though: The graph of a function is often described as a set of\npoints.",
    "Here is an example.\n",
    "Example 0.2.2\nConsider the function 𝑓: {1, 2, 3} →{2, 4, 6} defined by 𝑓(𝑥) =",
    "2𝑥.",
    "If we\nwanted to plot a graph of this function, we would draw the points (1, 2), (2, 4),\nand (3, 6) (but we would not connect these points with lines, since we are\nstudying discrete math; the domain only contains three elements, not the\ninfinitely many between them).\n",
    "So associated with the function is the set of points {(1, 2), (2, 4), (3, 6)}.",
    "In\nfact, this set of points is associated exactly with this (and only this) function.\n",
    "So we can think of this set of points as the function itself.\n",
    "Of course, we are using a mathematical object here: an ordered pair.",
    "This is not\na set (since sets are unordered).",
    "How should we talk about ordered things?",
    "We will\ntake this question up in the next section.\n",
    "There is one more important consideration about how we define a function with\na rule.",
    "A closed formula is one in which each output is given by an explicit rule\nbased solely on its input.",
    "This is what most of us think of as a formula.",
    "For example,\n𝑓(𝑛) = 3𝑛+ 1 is a closed formula, since to find 𝑓(5) (say) we take the input 5 and do\nsomething to it:",
    "Multiply it by 5 and then add 1.\n",
    "What else could a formula possibly be?",
    "A recursive definition of a function tells\nus how to compute the output for a given input based on other outputs of the function.\n",
    "For example, we might insist that 𝑓(𝑛) = 2 · 𝑓(𝑛−1).",
    "If we also specify an initial\ncondition that 𝑓(0) = 3, then we can find 𝑓(1) = 2 · 3 = 6, and then 𝑓(2) = 2 · 6 = 12,\nand so on.",
    "What is 𝑓(5) here?",
    "The only way to answer that is to find 𝑓(4), which\nmeans we need to find 𝑓(3), which we could do, since we have computed 𝑓(2).\n",
    "Recursive definitions of functions might be less useful for finding a particular\noutput, but they are often easier to specify for a particular application.",
    "We will\nexplore this phenomenon more when we study sequences.",
    "Speaking of which...\n\n8\n0.",
    "Introduction and Preliminaries\n0.2.4\nSequences\nSometimes we are interested not just in a collection of numbers, but in what order\nthose numbers appear.",
    "In such cases, we cannot use sets, since they do not distinguish\nbetween the order of their elements.",
    "Instead, we consider sequences.\n",
    "We will consider both finite and infinite sequences.",
    "A finite sequence may be\nsomething as simple as (1, 2, 3); that is a sequence with 3 elements, in that particular\norder.",
    "We might also call this an ordered triple, the same way that (7, 3) is an\nordered pair.",
    "In general, we could call this an 𝑛-tuple if it has 𝑛elements (we assume\nthat tuples are ordered).\n",
    "The key difference between the sequence (1, 2, 3) and the set {1, 2, 3} is that we\n“care” about the order.",
    "That is, the sequence (1, 2, 3) is different from the sequence\n(2, 3, 1), while the set {1, 2, 3} is identical to {2, 3, 1}.\n",
    "We will often use sequences as a counting tool.",
    "For example, a very simple\ncounting question is, “How many wheels do 100 cars have?”",
    "Instead of answering\njust this one question, we could generalize and ask how many wheels 𝑛cars have,\nand get a sequence of answers.",
    "This yields the infinite sequence (4, 8, 12, . . .).",
    "The\norder these multiples of 4 appear in is important, since each number in the sequence\ncorresponds to a specific version of the question.\n",
    "It is fine to think of a sequence of numbers as an ordered list.",
    "We can refer to the\nterms simply as\n𝑎0, 𝑎1, 𝑎2, . . .\nand might refer to the entire sequence as (𝑎𝑛)𝑛≥0 or (𝑎𝑛)𝑛∈ℕ.\nIf we want to be a little more precise and more abstract, we can think of a sequence\nas a function.",
    "The domain is the natural numbers or some subset of consecutive\nnatural numbers (like {1, 2, 3, 4}).",
    "The codomain is some set.",
    "We think of the domain\nas the positions in the sequence, and the image of those inputs as the terms in the\nsequence.\n",
    "For example, we might consider the Fibonacci sequence ( 𝑓𝑛)𝑛≥1, which starts\n1, 1, 2, 3, 5, 8, . .",
    "..",
    "What is the 4th term in the sequence?",
    "We might say 𝑓4 = 3 (this is\nassuming the first 1 is the first term and not the 0th term).",
    "Note that there can only\nbe one 4th term.",
    "There can only be one 𝑛-th term for any particular value of 𝑛. So\nfor any input (the position of the term), there is only one output (the term).",
    "It would\nbe perfectly reasonable to write 𝑓(4)",
    "= 3, and that really does look like a function.\n",
    "But we like to use subscripts.\n",
    "We can also describe the terms in a sequence using a table.",
    "We might write\nsomething like the following:\n𝑛\n1\n2\n3\n4\n...\n𝑎𝑛\n1\n3\n6\n10\n...\n",
    "This looks exactly like how you would represent a function, even though this table\ndescribes the sequence of triangular numbers (we will see why they are called this\nlater).\n",
    "Since sequences are functions, we can use any of the techniques to describe\nfunctions to describe sequences.",
    "In particular, we might give a closed formula for a\n\n0.2.",
    "Discrete Structures\n9\nsequence by explicitly giving the function for the 𝑛-th term.",
    "For example,\n𝑎𝑛= 𝑛(𝑛+ 1)\n2\n.\n",
    "Alternatively, we could define a sequence recursively by saying how to get from\none term to the next.",
    "This is especially useful for the Fibonacci sequence:\n𝑓𝑛= 𝑓𝑛−1 + 𝑓𝑛−2; 𝑓1 = 1, 𝑓2 = 1.\n",
    "Much of our effort in understanding sequences will go into taking a recursive\ndefinition and finding a closed formula for the sequence.",
    "We will study this, and\neverything else sequence related in Chapter 4.\n0.2.5\nRelations\nHow are the numbers 2 and 6 related?",
    "Oh, I know: 2 < 6.",
    "Also, 6 is a multiple of 2.\n",
    "The two numbers are also both even.",
    "And here is another fact: They are not equal.\n",
    "All four of these are examples of relations: less than, multiple of, both even, not\nequal.",
    "And there are many more (infinitely many) relations for pairs of numbers.\n",
    "The examples above are all binary relations in that they relate two elements.\n",
    "You could also consider relations between more than two elements.",
    "For example,\nwe could consider the relation “Pythagorean triple” on three numbers that holds\nprecisely if they are the side lengths of a right triangle.",
    "So the relation is true of the\ntriple (3, 4, 5), but not of (4, 5, 6) (since 32 + 42 = 52, but 42 + 52 ≠62).\n",
    "Notice that we can talk about a pair or triple satisfying a relation.",
    "We might say\nthat a pair belongs to the relation.",
    "The careful and formal way to define a relation is\nas a set of ordered pairs (or triples, etc.).",
    "Consider the (infinite) set of all ordered\npairs (𝑎, 𝑏) such that 𝑎< 𝑏. Every element of this set contains numbers for which\nthe relation “less than” is true, and every pair of numbers for which the relation is\ntrue is a pair in the set.",
    "So we can say that this set of pairs is the relation.\n",
    "Relations can have some standard properties, and deciding whether a particular\nrelation has a given property can often help us understand the relation better.",
    "The\nless-than relation is, for example, irreflexive because there are no elements that are\nless than themselves.",
    "It is also antisymmetric since there are no distinct numbers 𝑎\nand 𝑏such that 𝑎< 𝑏and 𝑏< 𝑎.",
    "It is also transitive since if 𝑎< 𝑏and 𝑏<",
    "𝑐then it\nmust follow that 𝑎< 𝑐.",
    "These are just a few examples of relation properties though.\n",
    "Why would we care about these properties?",
    "It turns out that some groups of\nproperties happen together frequently, and for such collections of properties, we\ncan prove general results about the relations that satisfy them.",
    "So if we can prove\nthat a given relation is reflexive, symmetric, and transitive (whatever those mean),\nthen we know the relation is an equivalence relation, and therefore we know it\nhas a bunch of other properties.",
    "A large portion of discrete mathematics is about\nstudying particular types of relations.",
    "One of my favorites is a relation that gives us\na graph.\n\n",
    "10\n0.",
    "Introduction and Preliminaries\n0.2.6\nGraphs\nConsider the set 𝑉= {1, 2, 3, 4, 5, 6}.",
    "Which pairs of numbers from that set add\nup to 7?",
    "We could have {1, 6} or {2, 5} or {3, 4}.",
    "We can picture the set and the\ninteresting (unordered) pairs (i.e., two-element subsets) as a picture called a graph:\n1\n6\n2\n5\n3\n4\nOn the other hand, we might want to consider pairs of numbers whose sum is\neven.",
    "Then, we would get the following picture.\n",
    "1\n5\n2\n6\n3\n4\nWe call these discrete structures graphs.",
    "A graph is a type of relation, one that is\nsymmetric (if 𝑎is related to 𝑏, then 𝑏is related to 𝑎) and irreflexive (no element is\nrelated to itself).\n",
    "However, we mostly think of graphs as the drawings of dots and lines, or more\nprecisely as a set of vertices together with a set of edges, where each edge is a\ntwo-element subset of the vertices.",
    "Notice that even here, we are using the structure\nset to define the structure graph.\n",
    "Graphs show up in all sorts of real-world applications: In a class, some students\nare friends with each other, so take the students to be the vertices and the edges to be\nthe friendships.",
    "In geography, some countries share a border, so take the countries\nto be the vertices and connect a pair of vertices with an edge if the countries share a\nborder.",
    "Perhaps you are planning a trip and want to fly from Denver to Paris.",
    "Is\nthere a direct flight, or must you stop in Newark?",
    "That is, does the graph of flights\nhave an edge between Denver and Paris or only between Denver and Newark and\nbetween Newark and Paris?",
    "When your Amazon driver delivers packages to 10\nhouses in your neighborhood, how does her app know in which order to deliver the\npackages?",
    "Graph theory!\n",
    "The study of graphs is a subject in its own right, in which many mathematicians\nhold doctorate degrees and write hundreds of papers each year.",
    "We will scratch the\nsurface of this fascinating subject in Chapter 2\n0.2.7\nEven More Structures\nOur list of structures could go on and on, but we will stop here.",
    "We will spend just\na little time looking at multisets, which are just like sets except that they can have\nrepeated elements.",
    "Since this is not a geometry class, we will not consider finite\n\n0.2.",
    "Discrete Structures\n11\ngeometries, or designs (which are somewhere between graphs and geometries).\n",
    "Discrete structures are useful in computer science, but we will stop short of studying\nlinked lists or red-black trees.",
    "Although abstract algebra is a fascinating subject,\nwe will not get to groups or rings or metroids or POSets or Boolean algebras or ....\n",
    "These are examples of sets on which we define additional operations and study the\nalgebraic structure of how the sets and operations interact.\n",
    "The point is, discrete mathematics is awesome, and you can spend multiple\nlifetimes studying it.",
    "So what are we waiting for?",
    "Let’s dive in and solve some\nproblems.\n",
    "0.2.8\nReading Questions\n1.\nThink back to the domino problem at the beginning of this section.",
    "We asked\nhow many dominoes are in a double-six domino set.",
    "Is this really a set, in our\nmathematical sense?",
    "What discrete structure would you use to represent each\ndomino individually?\n",
    "2.\nA double-zero domino set would contain only one domino (both sides showing\n0).",
    "A double-one set would contain this plus the dominoes (1, 0) and (1, 1).",
    "We\ncan continue in this way, creating a sequence of domino sets.",
    "Find the next\nthree terms of the sequence.\n1, 3,\n,\n,\n, ...\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n\n\n",
    "Chapter 1\nLogic and Proofs\nLogic is the study of consequence.",
    "Given a few mathematical statements or facts, we\nwould like to be able to draw some conclusions.",
    "For example, if I told you that a\nparticular real-valued function was continuous on the interval [0, 1], and 𝑓(0) = −1\nand 𝑓(1) = 5, can we conclude that there is some point between [0, 1] where the\ngraph of the function crosses the 𝑥-axis?",
    "Yes, we can, thanks to the Intermediate\nValue Theorem from calculus.",
    "Can we conclude that there is exactly one point?\n",
    "No.",
    "Whenever we find an “answer” in math, we really have a (perhaps hidden)\nargument.\n",
    "Mathematics is really about establishing general statements (like the Intermediate\nValue Theorem).",
    "This is done via an argument called a proof.",
    "We start with some\ngiven conditions, the premises of our argument, and from these, we find a consequence\nof interest, our conclusion.\n",
    "The problem is, as you no doubt know from arguing with friends, not all\narguments are good arguments.",
    "A bad argument is one in which the conclusion does\nnot follow from the premises; i.e., the conclusion is not a consequence of the premises.\n",
    "Logic is the study of what makes an argument good or bad.",
    "In other words, logic\naims to determine in which cases a conclusion is, or is not, a consequence of a set of\npremises.\n",
    "We will start in Section 1.1 by considering statements, the building blocks of\narguments.",
    "Understanding what counts as a statement and what form statements\ncan take is the first step in understanding arguments.",
    "We will take a closer look at\nhow statements can be combined in Section 1.2.",
    "Then we will see what mathematical\ntools we can develop to better analyze these statements and how they interact in\nSection 1.3.",
    "Finally, we will put all of this together in Section 1.4 and Section 1.5 to\nsee how we can use these tools to construct arguments and prove statements.\n1.1\nMathematical Statements\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Identify the logical structure of statements to determine their truth\nvalue in terms of the truth values of their parts.\n",
    "2. Identify the use of quantifiers in a statement, and determine the truth\nvalue of the statement based on those quantifiers.\n",
    "3.",
    "Translate between statements in natural language and logical symbols.\n13\n\n14\n1.",
    "Logic and Proofs\n1.1.1\nSection Preview\nInvestigate!\n",
    "While walking through a fictional forest, you encounter three trolls guarding\na bridge.",
    "Each is either a knight, who always tells the truth, or a knave, who\nalways lies.",
    "The trolls will not let you pass until you correctly identify each\nas either a knight or a knave.",
    "Each troll makes a single statement:\nTroll 1: If I am a knave, then there are exactly two knights here.\n",
    "Troll 2: Troll 1 is lying.\n",
    "Troll 3: Either we are all knaves, or at least one of us is a knight.\n",
    "Which troll is which?\n",
    "Try it 1.1.1\nSpend a few minutes thinking about the Investigate problem above.",
    "What\ncould you conclude if you knew Troll 1 really was a knave (i.e., their statement\nwas false)?",
    "Share your initial thoughts on this.\n",
    "In order to do mathematics, we must be able to talk and write about mathematics.\n",
    "Perhaps your experience with mathematics so far has mostly involved finding\nnumerical answers to problems.",
    "As we embark towards more advanced and abstract\nmathematics, writing will play a more prominent role in the mathematical process.\n",
    "In fact, the primary goal of mathematics, as an academic discipline in its own\nright, is to establish general mathematical truths.",
    "How can we know whether these\nfacts, perhaps called theorems or propositions, are true?",
    "We construct valid arguments,\ncalled proofs, which establish the truth of the statements.",
    "Here, an argument is not\nthe sort of thing you have with your Mom when you disagree about what to have\nfor dinner.",
    "Rather, we have a technical definition of the term.\n",
    "Definition 1.1.2 Argument.\n",
    "An argument is a sequence of statements, the last of which is called the\nconclusion and the rest of which are called premises.\n",
    "An argument is said to be valid provided the conclusion must be true\nwhenever the premises are all true.",
    "An argument is invalid if it is not valid;\nthat is, all the premises can be true, and the conclusion could still be false.\n",
    "An argument is sound provided it is valid and all the premises are true.",
    "A\nproof of a statement is a sound argument whose conclusion is the statement.\n\n1.1.",
    "Mathematical Statements\n15\nBy the way...",
    "Our definitions of argument, valid argument, and sound\nargument are the same ones used in philosophy, the other primary academic\ndiscipline concerned with logic and reasoning.\n",
    "To determine whether we have a proof of a statement, we must decide both\nwhether every premise is true, and whether the argument is valid: whether the\nconclusion follows from the premises.",
    "How can we do this?\n",
    "Example 1.1.3\nConsider the following two arguments:\nIf Edith eats her vegetables, then she can have a cookie.\n",
    "Edith eats her vegetables.\n",
    "∴\nEdith gets a cookie.\n",
    "Florence must eat her vegetables to get a cookie.\n",
    "Florence eats her vegetables.\n",
    "∴\nFlorence gets a cookie.\n",
    "(The symbol “∴” means “therefore”)\n",
    "Are these arguments valid?\nSolution.\n",
    "Do you agree that the first argument is valid but the second\nargument is not?",
    "We will soon develop a better understanding of the logic\ninvolved in this analysis, but if your intuition agrees with this assessment,\nthen you are in good shape.\n",
    "Notice the two arguments look almost identical.",
    "Edith and Florence both\neat their vegetables.",
    "In both cases, there is a connection between the eating of\nvegetables and cookies.",
    "Yet we claim that it is valid to conclude that Edith gets\na cookie, but not that Florence does.",
    "The difference must be in the connection\nbetween eating vegetables and getting cookies.",
    "We need to be skilled at\nreading and comprehending these sentences.",
    "Do the two sentences mean the\nsame thing?\n",
    "Unfortunately, in everyday language we are often sloppy, and you might\nbe tempted to say they are equivalent.",
    "But notice that just because Florence\nmust eat her vegetables, we have not claimed that doing so would be enough\n(she might also need to clean her room, for example).",
    "In everyday (non-\nmathematical) practice, you might be tempted to say this “other direction” is\nimplied.",
    "In mathematics, we never get that luxury.\n",
    "Remark 1.1.4",
    "The arguments in the example above illustrate another important\npoint: Even if you don’t care about the advancement of human knowledge in\n\n16\n1.",
    "Logic and Proofs\nthe field of mathematics, becoming skilled at analyzing arguments is useful.\n",
    "And even if you don’t want to give your grandmother a cookie.",
    "If you are using\nmathematics to solve problems in some other discipline, it is still necessary to\ndemonstrate that your solution is correct.",
    "You better have a good argument\nthat it is!\n",
    "Since arguments are built up of statements, we must agree on what counts as a\nstatement.\n",
    "Definition 1.1.5\nA statement is a declarative sentence that is either true or false.\n",
    "If the sentences in an argument could not be true or false, there would be no way\nto determine whether the argument was valid, since validity describes a relationship\nbetween the truth values of the premises and conclusions.\n",
    "The goal of this section is to explore the different “shapes” a statement can take.\n",
    "We will see that more complicated statements can be built up from simpler ones,\nin ways that entirely determine their truth value based on the truth values of their\nparts.\n",
    "Preview Activity\nBefore reading on to the main content of the section, complete this preview activity\nto start thinking about the types of questions this section will address.\n1.\nWhich of the following sentences should count as statements?",
    "That is, for\nwhich of the sentences below could you potentially claim the sentence was either\ntrue or false?",
    "Select all that apply.\n",
    "A.",
    "The sum of the first 100 positive integers.\n",
    "B.",
    "What is the sum of the first 100 positive integers?\n",
    "C. The sum of the first 100 positive integers is 5050.\n",
    "D. Is the sum of the first 100 positive integers 5050?\n",
    "E. The sum of the first 100 positive integers is 17.\n",
    "2.\nYou and your roommate are arguing, and they make the audacious claim that\npineapple is good both on pizza and in smoothies.",
    "Which of the following are\nreasonable responses to this claim, from a logical point of view?\n",
    "A.",
    "The statement is false because even though pineapple is good in smoothies,\nit is NOT good on pizza.\n",
    "B.",
    "The statement is false because while pineapple is good on pizza and\npineapple is good in smoothies, a pizza smoothie is never good.\n\n1.1.",
    "Mathematical Statements\n17\nC.",
    "The statement is half true because regardless of what you think about\npineapple on pizza, we can all agree at least that pineapple is good in\nsmoothies.\n",
    "D.",
    "The statement is false because everyone who likes pineapple on pizza\ndoes NOT like pineapple in smoothies.\n",
    "3.\n",
    "Your roommate now makes an even more outrageous claim: If a superhero\nmovie is part of the Marvel Cinematic Universe, then it is good.",
    "Which of the\nfollowing are reasonable responses to this claim, from a logical point of view?\n",
    "A.",
    "This is false because there are good superhero movies, like Wonder\nWoman and Dark Knight, that are based on DC Comics, and so not part\nof the Marvel Cinematic Universe.\n",
    "B.",
    "The statement is false because there is at least one superhero movie that\nis part of the Marvel Cinematic Universe that is also not good.\n",
    "C.",
    "The statement is false because, for example, Green Lantern is neither\nMarvel nor good.\n",
    "D.",
    "The statement is true because more than half of the Marvel movies are\ngood.\n",
    "4.\nYour roommate just won’t let up with their outrageous claims.",
    "Now they claim\nthat either every troll is a knave, or there is at least one troll that is a knight.\n",
    "What can you say to this?\nA.",
    "Yes, this is true because every troll is either a knight or a knave.",
    "If it is\nnot the case that all trolls are knaves, then there must be some troll that is\na knight.\n",
    "B.",
    "This is false because some trolls are knights and some other trolls are\nknaves.\n",
    "C.",
    "The statement is false because there is no way to verify which of the two\noptions is the case.\n",
    "D.",
    "The statement is false because no troll could say that all trolls are knaves,\nsince knaves always lie.\n",
    "1.1.2\nAtomic and Molecular Statements\nA statement is any declarative sentence which is either true or false.",
    "A statement\nis atomic if it cannot be divided into smaller statements, otherwise it is called\nmolecular.\n\n",
    "18\n1.",
    "Logic and Proofs\nExample 1.1.6\n",
    "These are statements (in fact, atomic statements):\n• Telephone numbers in the USA have 10 digits.\n",
    "•",
    "The moon is made of cheese.\n",
    "• 42 is a perfect square.\n",
    "• Every even number greater than 2 can be expressed as the sum of two\nprimes.\n",
    "• 3 + 7 = 12\nAnd these are not statements:\n• Would you like some cake?\n•",
    "The sum of two squares.\n",
    "• 1 + 3 + 5 + 7 + · · · +",
    "2𝑛+ 1.\n• Go to your room!\n",
    "• 3 + 𝑥= 12\n",
    "The reason the sentence “3 + 𝑥= 12” is not a statement is that it contains a\nvariable.",
    "Depending on what 𝑥is, the sentence is either true or false, but right now\nit is neither.",
    "One way to make the sentence into a statement is to specify the value of\nthe variable in some way.",
    "This could be done by setting a specific substitution, for\nexample, “3 + 𝑥= 12 where 𝑥= 9,” which is a true statement.",
    "Or you could capture\nthe free variable by quantifying over it, as in, “For all values of 𝑥, 3 + 𝑥= 12,” which\nis false.",
    "We will discuss quantifiers in more detail in the subsection Quantifiers and\nPredicates below.\n",
    "You can build more complicated (molecular) statements out of simpler (atomic\nor molecular) ones using logical connectives.",
    "For example, this is a molecular\nstatement:\nTelephone numbers in the USA have 10 digits, and 42 is a perfect square.\n",
    "Note that we can break this down into two smaller statements.",
    "The two shorter\nstatements are connected by an “and.”",
    "We will consider 5 connectives: “and” (Sam\nis a man, and Chris is a woman), “or” (Sam is a man, or Chris is a woman), “if. . .",
    ",\nthen. . . ”",
    "(if Sam is a man, then Chris is a woman), “if and only if” (Sam is a man\nif and only if Chris is a woman), and “not” (Sam is not a man).",
    "The first four are\ncalled binary connectives (because they connect two statements) while “not” is an\nexample of a unary connective (since it applies to a single statement).\n",
    "These molecular statements are, of course, still statements, so they must be either\ntrue or false.",
    "The crucial observation here is that which truth value the molecular\n\n1.1.",
    "Mathematical Statements\n19\nstatement achieves is completely determined by the type of connective and the truth\nvalues of the parts.",
    "We do not need to know what the parts actually say or whether\nthey have some material connection to each other, only whether those parts are true\nor false.\n",
    "To analyze logical connectives, it is enough to consider propositional variables\n(sometimes called sentential variables), usually capital letters in the middle of the\nalphabet: 𝑃, 𝑄, 𝑅, 𝑆, . .",
    "..",
    "We think of these as standing in for (usually atomic)\nstatements, but there are only two values the variables can achieve: true or false.1\nWe also have symbols for the logical connectives: ∧, ∨, →, ↔, ¬.\nDefinition 1.1.7 Logical Connectives.\n",
    "We define the following logical connectives.\n",
    "•",
    "𝑃∧𝑄is read “𝑃and 𝑄,” and is called a conjunction.\n",
    "• 𝑃∨𝑄is read “𝑃or 𝑄,” and is called a disjunction.\n",
    "• 𝑃→𝑄is read “if 𝑃then 𝑄,” and is called an implication or conditional.\n",
    "• 𝑃↔𝑄is read “𝑃if and only if 𝑄,” and is called a biconditional.\n",
    "• ¬𝑃is read “not 𝑃,” and is called a negation.\n",
    "The truth value of a statement is determined by the truth value(s) of its part(s),\ndepending on the connectives:\nDefinition 1.1.8 Truth Conditions for Connectives.\n",
    "The truth conditions for the logical connectives are defined as follows.\n",
    "•",
    "𝑃∧𝑄is true when both 𝑃and 𝑄are true.\n",
    "• 𝑃∨𝑄is true when 𝑃or 𝑄or both are true.\n• 𝑃→𝑄is true when 𝑃is false or 𝑄is true (or both).\n• 𝑃↔𝑄is true when 𝑃and 𝑄are both true, or both false.\n",
    "• ¬𝑃is true when 𝑃is false.\n",
    "Each of the above definitions can be represented in a table, called a truth table.\n",
    "We simply list what the truth value of the statement is for each possible combination\nof truth values of the parts.\n",
    "1In computer programming, we should call such variables Boolean variables.\n\n",
    "20\n1. Logic and Proofs\n𝑃\n𝑄\n𝑃∧𝑄\nT\nT\nT\nT\nF\nF\nF\nT\nF\nF\nF\nF\n𝑃\n𝑄\n𝑃∨𝑄\nT\nT\nT\nT\nF\nT\nF\nT\nT\nF\nF\nF\n𝑃\n𝑄\n𝑃→𝑄\nT\nT\nT\nT\nF\nF\nF\nT\nT\nF\nF\nT\n𝑃\n𝑄\n𝑃↔𝑄\nT\nT\nT\nT\nF\nF\nF\nT\nF\nF\nF\nT\n𝑃\n¬𝑃\nT\nF\nF\nT\nFigure 1.1.9 Truth tables for logical connectives.\n",
    "For example, we can use the truth table for 𝑃→𝑄to decide whether the\nstatement, “If 5 is even, then 6 is even,” is true or false.",
    "Here 𝑃is the statement “5 is\neven,” and 𝑄is the statement “6 is even.”",
    "Since 5 is not even, the statement 𝑃is false.\n",
    "Since 6 is even, the statement 𝑄is true.",
    "The truth table tells us that the statement\n𝑃→𝑄is true when 𝑃is false and 𝑄is true (the 3rd row).",
    "So the statement, “If 5 is\neven, then 6 is even,” is true.",
    "(If you don’t like that the statement is true, hold on to\nthat thought, and we will hopefully resolve it soon.)\nNote that for us, or is the inclusive or (and not the sometimes used exclusive or)\nmeaning that 𝑃∨𝑄is in fact true when both 𝑃and 𝑄are true.",
    "As for the other\nconnectives, “and” behaves as you would expect, as does negation.",
    "The biconditional\n(if and only if) might seem a little strange, but you should think of this as saying the\ntwo parts of the statements are equivalent in that they have the same truth value.\n",
    "This leaves only the implication 𝑃→𝑄which has a slightly different meaning\nin mathematics than in ordinary usage.",
    "However, implications are so common and\nuseful in mathematics that we must develop a level of fluency with their use which\nwarrants a whole section (Section 1.2).\n",
    "Example 1.1.10\nUsing the truth conditions for the logical connectives, determine which\nstatements below are true and which are false.\n",
    "1. 17 is prime, and 17 is odd.\n",
    "2. 17 is prime, and 18 is prime.\n",
    "3. 17 is prime, or 18 is prime.\n",
    "4. 17 is prime, or 19 is prime.\n",
    "5.",
    "If 17 is prime, then 19 is prime.\n",
    "6.",
    "If 18 is prime, then my favorite number is 17.\n7. 17 is prime if and only if 19 is prime.\n",
    "8. 17 is not prime if and only if 19 is not prime.\n\n1.1.",
    "Mathematical Statements\n21\nSolution.\n",
    "First, let’s agree on some facts: 17 really is prime and odd, 18 is\nnot either, and 19 is prime.\n",
    "1.",
    "True.",
    "Both parts of the conjunction are true, so the entire statement is\ntrue.\n",
    "2. False.",
    "The first part is true, but the second part is false, so the entire\nstatement is false.\n",
    "3.",
    "True.",
    "The first part is true, so the entire statement is true.",
    "As soon as\nwe see one true statement in a disjunction, we can stop checking and\ndeclare the entire statement true.\n",
    "4. True.",
    "Since we use the inclusive or, the statement is true when both\nparts are true.\n",
    "5.",
    "True.",
    "Don’t be worried that there isn’t a good reason that 17 being\nprime causes 19 to be prime.",
    "That is not what we mean by a conditional\nstatement.",
    "Since the “then” part is true, we know that the statement\noverall is true.\n",
    "6.",
    "True.",
    "The “if” part of the statement is false.",
    "That’s all we need.",
    "I bet\nyou don’t even know what my favorite number is, and you don’t need\nto.",
    "The statement is true.\n",
    "7.",
    "True.",
    "Do both parts have the same truth value?",
    "Yes, since they are both\ntrue.",
    "So the entire statement is true.\n",
    "8.",
    "True as well.",
    "Now both parts are false (since both are the negation of a\ntrue statement), so the entire statement is true.\n",
    "The way we define logical connectives and their truth value is very precise and\ntechnical.",
    "Often, language is not.",
    "Part of learning how to communicate mathematics\nis learning the cultural norms of mathematical language and how to translate\nstatements in ordinary language into these technical statements.",
    "This will get easier\nwith practice, so make sure you are talking to lots of people about the math you are\nstudying.\n",
    "Here are a few examples of how ordinary language might be difficult to translate.\n",
    "Example 1.1.11\nIdentify the logical structure of each of the following statements.\n",
    "1. 4 and 5 are both prime.\n",
    "2.",
    "Only one of 4 or 5 is prime.\n",
    "3.",
    "You must attend every day and do the homework to pass this class.\n\n",
    "22\n1.",
    "Logic and Proofs\n4.",
    "Every number is even or odd.\n",
    "Solution.\n",
    "1.",
    "Do you agree this is the same statement as “4 is prime, and 5 is prime”?\n",
    "Notice that it would not make sense to write this as 𝑃∧𝑄where 𝑃is\n“4” and 𝑄is “5 is prime”.",
    "But if we let 𝑃be the statement, “4 is prime,”\nthen both parts of the conjunction are statements.\n",
    "2.",
    "Again, we can’t just put what is on one side of the “or” as a statement.\n",
    "But if we let 𝑃be “4 is prime” and 𝑄be “5 is prime,”, then we can write\nthis as (𝑃∨𝑄) ∧¬(𝑃∧𝑄).",
    "That is, either 4 is prime or 5 is prime, and it\nis not the case that both 4 is prime and 5 is prime.\n",
    "3.",
    "Here is another way you could phrase the same statement: If you pass\nthe class, then it must be the case that you attended every day and that\nyou did the homework.",
    "If we agree that this is just a clearer way to\nstate the original statement, then we could illustrate its structure as\n𝑃→(𝑄∧𝑅).\n",
    "4. Notice that this is not the same as saying, “Every number is even, or\nevery number is odd.”",
    "Of course, saying, “3 is even or odd,” is the same\nas saying, “3 is even, or 3 is odd.”",
    "Language is confusing!\n",
    "We don’t yet have the logical technology to translate this statement as\nanything more than 𝑃, where 𝑃is the statement, “Every number is even\nor odd.”",
    "Luckily, that technology is available, starting... now!\n1.1.3\nQuantifiers and Predicates\nDid you know that all mammals have hair?",
    "That every integer is even or odd?",
    "That\nsome odd numbers are not prime?\n",
    "Our goal is to explore how to write statements such as these in mathematical\nnotation to highlight the logical structure of the statements.\n",
    "This will require considering a new sort of basic sentence called a predicate,\nwhich is like a statement, but contains a free variable.",
    "When you replace that\nvariable with a constant of some sort, then the sentence becomes a statement proper.\n",
    "Think of a predicate as making a claim about the values that are substituted for the\n“placeholder” variable(s).\n",
    "A predicate can be made into a (true or false) statement by evaluating it at some\nconstant(s), or we can claim that some or all possible constants would make the\nresulting statement true or false.",
    "This is done using quantifiers.\n\n",
    "1.1.",
    "Mathematical Statements\n23\nDefinition 1.1.12 Quantifiers.\n",
    "The universal quantifier is written ∀and is read, “for all.”",
    "The existential\nquantifier is written ∃and is read, “there exists” or “for some.”\n",
    "We usually write predicates similar to how you write a function, although with\ncapital letters.",
    "For example, we might use the predicate 𝑃(𝑥) to represent “𝑥is\nprime”.",
    "We can then say that 𝑃(7) is true (since 7 is prime) and that 𝑃(8) is false.\n",
    "Or using quantifiers, we can (falsely) claim that all numbers are prime by writing\n∀𝑥𝑃(𝑥) or (truthfully) claim that there is at least one prime number, by writing\n∃𝑥𝑃(𝑥).\n",
    "Example 1.1.13\nTranslate the statement, “Every number is even or odd,” into symbols.\n",
    "Solution.\n",
    "Before we even start using symbols, it is helpful to rephrase this\nin a way that captures the logical structure of the statement.",
    "What is the claim\nsaying?",
    "Given any number, it will either be the case that the number is even,\nor that the number is odd.",
    "In particular, we are not claiming that either all\nnumbers are even or all numbers are odd.\n",
    "Let’s use 𝐸(𝑥) to say that 𝑥is even, and 𝑂(𝑥) to say that 𝑥is odd.",
    "Then we\ncan write,\n𝐸(𝑥) ∨𝑂(𝑥)\nto say that 𝑥is even or 𝑥is odd.",
    "Which 𝑥is that true for (according to the\nclaim)?",
    "All of them.",
    "So we write the statement as,\n∀𝑥(𝑂(𝑥) ∨𝐸(𝑥)).\n",
    "We added some parentheses to emphasize that the scope of the universal\nquantifier includes both predicates.\n",
    "Note that if we incorrectly interpreted the statement as claiming that\neither all numbers are even or all numbers are odd, we could write that as\n∀𝑥𝑂(𝑥) ∨∀𝑥𝐸(𝑥).",
    "This is not the same!\n",
    "Just like we did for propositional logic and the logical connectives, we should\ndecide what it means for a quantified predicate to be true or false.",
    "We say ∀𝑥𝑃(𝑥)\nis true if 𝑃(𝑎) is true no matter what constant 𝑎we substitute for 𝑥. And similarly,\n∃𝑥𝑃(𝑥) is true if there is at least one value 𝑎for which 𝑃(𝑎) is true.\n",
    "However, we must be careful here.",
    "Consider the statement\n∀𝑥∃𝑦(𝑦< 𝑥).\n",
    "You would read this, “For every 𝑥there is some 𝑦such",
    "that 𝑦is less than 𝑥.” Note\nthat < is a predicate with two free variables; we have chosen to write it with the\nsymbol between the variables instead of the funky-looking 𝐿(𝑦, 𝑥) or <(𝑦, 𝑥).\n\n",
    "24\n1.",
    "Logic and Proofs\nIs this statement true?",
    "The answer depends on our domain of discourse.",
    "When\nwe say “for all” 𝑥, do we mean all positive integers or all real numbers or all elephants\nor...?",
    "Usually, this information is implied by the context of the statement.",
    "In discrete\nmathematics, we almost always quantify over the natural numbers, 0, 1, 2, . .",
    "., so let’s\ntake that for our domain of discourse here.\n",
    "For the statement to be true, we need, no matter what natural number we select,\nfor there to be some natural number that is strictly smaller.",
    "Perhaps we could let\n𝑦be 𝑥−1?",
    "But here is the problem: what if 𝑥= 0?",
    "Then 𝑦= −1, and that is not\na number!",
    "(in our domain of discourse).",
    "Thus we see that the statement is false\nbecause there is a number less than or equal to all other numbers.",
    "In symbols,\n∃𝑥∀𝑦(𝑦≥𝑥).\n",
    "We will explore some rules for working with quantifiers and other connectives\nin Section 1.3.",
    "For now, we will focus on translating between informal statements\nin ordinary language and the more precise language of logic.",
    "There is no perfect\nalgorithm for doing this translation, but here are a few useful rules of thumb.\n",
    "Every blank is blank.\n",
    "Any statement of the form, “Every 𝑃-thing is a 𝑄-thing” can be written as\n∀𝑥(𝑃(𝑥) →𝑄(𝑥)).\n",
    "Example: all mammals have hair, becomes ∀𝑥(𝑀(𝑥) →𝐻(𝑥)), where\n𝑀(𝑥) means 𝑥is a mammal, and 𝐻(𝑥) means 𝑥has hair.\n",
    "To make sense of this, think about what we mean by statements like these in\nterms of sets.",
    "We claim that the set of mammals is contained in, or is a subset of, the\nset of hairy things.",
    "What we mean by “𝐴is a subset of 𝐵” is precisely that every\nelement of 𝑥is an element of 𝑦.",
    "This can also be expressed by saying that “if 𝑥is an\nelement of 𝐴, then 𝑥is also an element of 𝐵.”\nSome blanks are blank.\n",
    "Any statement of the form, “Some 𝑃-things are 𝑄-things,” can be written\nas\n∃𝑥(𝑃(𝑥) ∧𝑄(𝑥)).\n",
    "Example: Some cats can swim, becomes ∃𝑥(𝐶(𝑥) ∧𝑆(𝑥)), where 𝐶(𝑥)\nmeans 𝑥is a cat, and 𝑆(𝑥) means 𝑥can swim.\n",
    "Again, it is helpful to think of how to express such statements in terms of sets.\n",
    "To say that some cats can swim is to say that there are things that belong both to the\nset of cats and to the set of swimming things.",
    "Such animals belong to the intersection\nof these two sets, which you can describe as belonging to the first set and the second\nset.",
    "Existential statements of this form claim that the intersection of the two sets is\nnot empty.\n\n",
    "1.1.",
    "Mathematical Statements\n25\nImplicit Quantifiers.\n",
    "It is always a good idea to be precise in mathematics.",
    "Some-\ntimes though, we can relax a bit, as long as we all agree on a convention.",
    "An example\nof such a convention is to assume that sentences containing predicates with free\nvariables are intended as statements, where the variables are universally quantified.\n",
    "For example, do you believe that if a shape is a square, then it is a rectangle?",
    "But\nhow can that be true if it is not a statement?",
    "To be a little more precise, we have two\npredicates: 𝑆(𝑥) for “𝑥is a square” and 𝑅(𝑥) for “𝑥is a rectangle”.",
    "The sentence we\nare looking at is\n𝑆(𝑥) →𝑅(𝑥).\n",
    "This is neither true nor false, as it is not a statement.",
    "But come on!",
    "We all know that\nwe meant to consider the statement,\n∀𝑥(𝑆(𝑥) →𝑅(𝑥)),\nand this is what our convention tells us to consider.",
    "We call the resulting statement\nthe universal generalization of the original sentence.\n",
    "Definition 1.1.14\nGiven a sentence with free variables, the universal generalization of that\nsentence is the statement obtained by adding enough universal quantifiers to\nthe beginning of the sentence so that all free variables become bound.\n",
    "Similarly, we will often be a bit sloppy about the distinction between a predicate\nand a statement.",
    "For example, we might write, let 𝑃(𝑛) be the statement, “𝑛is prime,”\nwhich is technically incorrect.",
    "It is implicit that we mean that we are defining 𝑃(𝑛)\nto be a predicate, which for each 𝑛becomes the statement, 𝑛is prime.\n",
    "1.1.4\nReading Questions\n1.\nMatch each statement in symbols with its type of statement.\n",
    "𝑃∧𝑄\nIf 𝑃, then 𝑄, (implication)\n𝑃→𝑄\n𝑃or 𝑄(disjunction)\n",
    "𝑃∨𝑄\n𝑃and 𝑄(conjunction)\n¬𝑃\nNot 𝑃(negation)\n2.\nConsider the sentence, “If 𝑥> 3, then 𝑥is even.”\nWhich of the following statements are true about the sentence?",
    "Select all\nthat apply.\n",
    "A.",
    "The sentence is a false statement since it has a free variable.\n",
    "B. The universal generalization of the sentence is a statement.\n",
    "C. If you substitute 10 for 𝑥, the resulting statement is true.\n",
    "D. The sentence becomes a true statement no matter what natural number\nyou substitute for 𝑥.\n\n26\n1.",
    "Logic and Proofs\n3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "1.1.5\nPractice Problems\n1.\n",
    "For each sentence below, decide whether it is an atomic statement, a molecular\nstatement, or not a statement at all.\n",
    "(a) Some say the end is near, and some say we’ll see Armageddon soon.\n",
    "(b) Mom’s coming ’round to put it back the way it ought to be.\n",
    "(c) Learn to swim.\n",
    "2.\nClassify each of the sentences below as an atomic statement, a molecular\nstatement, or not a statement at all.",
    "If the statement is molecular, say what kind\nit is (conjuction, disjunction, conditional, biconditional, negation).\n",
    "(a) Everybody can be fooled sometimes.\n",
    "(b)",
    "Every natural number greater than 1 is either prime or composite.\n",
    "(c) Go to your room!\n",
    "(d)",
    "The Broncos will win the Super Bowl, or I’ll eat my hat.\n",
    "(e) This shirt is not black.\n",
    "3.\nDetermine whether each molecular statement below is true or false, or whether\nit is impossible to determine.",
    "Assume you do not know what my favorite\nnumber is (but you do know which numbers are prime).\n",
    "(a) If 4 is my favorite number, then 4 + 1 is my favorite number.\n",
    "(b) 8 is my favorite number, and 3 is not prime.\n",
    "(c) 4 is my favorite number, or 4 is prime.\n",
    "(d) If 4 is prime, then 2 · 4 is prime.\n",
    "(e) If 3 is prime, then 3 is my favorite number.\n",
    "(f) 8 is my favorite number, and 4 is not prime.\n4.\nLet 𝑃(𝑥, 𝑦) be the predicate, “person 𝑥can be fooled at time 𝑦.”\nMatch each statement with its representation in symbols.\n",
    "Some people can be fooled all of the time.\n",
    "∀𝑦∃𝑥𝑃(𝑥, 𝑦)\nEveryone can be fooled sometimes.\n",
    "∃𝑦∀𝑥𝑃(𝑥, 𝑦)\n",
    "It is always true that some people can be fooled.\n",
    "∀𝑥∃𝑦𝑃(𝑥, 𝑦)\n",
    "Sometimes everyone can be fooled.\n",
    "∃𝑥∀𝑦𝑃(𝑥, 𝑦)\n\n1.1.",
    "Mathematical Statements\n27\n5.\n",
    "Your friend believes that you cannot fool everyone at the same time.",
    "What is\nanother way of saying this, and how would you write that in symbols (using\n𝑃(𝑥, 𝑦) to say you can fool 𝑥at time 𝑦).\n",
    "A. Someone is never fooled.",
    "∃𝑥∀𝑦¬𝑃(𝑥, 𝑦)\nB. Everyone is never fooled.",
    "∀𝑥∀𝑦¬𝑃(𝑥, 𝑦)\nC. Someone is not fooled sometimes.",
    "∃𝑥∃𝑦¬𝑃(𝑥, 𝑦)\nD. Everyone is not fooled sometimes.",
    "∀𝑥∃𝑦¬𝑃(𝑥, 𝑦)\n6.\n",
    "Regardless of your beliefs of how many people can be fooled at various times,\nwhat could you conclude if we reinterpret 𝑃(𝑥, 𝑦) to mean 𝑥< 𝑦and only\nquantify over the natural numbers (so ∀𝑥means “For all natural numbers,”\nand ∃𝑥means “There exists a natural number”)?",
    "Select all of the following\nthat apply.\n",
    "A. ∀𝑥∃𝑦𝑃(𝑥, 𝑦) is true.\n",
    "B. ∃𝑥∀𝑦𝑃(𝑥, 𝑦) is true.\n",
    "C. ∀𝑦∃𝑥𝑃(𝑥, 𝑦) is true.\n",
    "D. ∃𝑦∀𝑥𝑃(𝑥, 𝑦) is true.\n",
    "E. No matter what 𝑃(𝑥, 𝑦) means, we can conclude that ∀𝑥∃𝑦𝑃(𝑥, 𝑦) and\n∃𝑦∀𝑥are NOT logically equivalent\n7.\nLet 𝑃(𝑥) be the predicate, “17𝑥+ 1 is even.”\n(a) Is 𝑃(15) true or false?\n(b) What, if anything, can you conclude about ∃𝑥𝑃(𝑥) from the truth value\nof 𝑃(15)?\n",
    "(c)",
    "What, if anything, can you conclude about ∀𝑥𝑃(𝑥) from the truth value\nof 𝑃(15)?\n",
    "8.\nLet 𝑃(𝑥) be the predicate, “18𝑥+ 1 is even.”\n(a) Is 𝑃(15) true or false?\n(b) What, if anything, can you conclude about ∃𝑥𝑃(𝑥) from the truth value\nof 𝑃(15)?\n",
    "(c)",
    "What, if anything, can you conclude about ∀𝑥𝑃(𝑥) from the truth value\nof 𝑃(15)?\n",
    "9.\nConsider the sentence, ∃𝑥𝑃(𝑥, 𝑦) →∀𝑥𝑃(𝑥, 𝑦).",
    "What can we say about this\nsentence?",
    "Select all that apply.\n",
    "A.",
    "The sentence is a statement because it contains quantifiers.\n\n",
    "28\n1.",
    "Logic and Proofs\n",
    "B.",
    "The sentence is not a statement because 𝑥and 𝑧are free variables.\n",
    "C. The sentence is not a statement because 𝑦is a free variable.\n",
    "D. The universal generalization of the sentence is a statement.\n",
    "10.\nSuppose 𝑃(𝑥, 𝑦) is some binary predicate defined on a very small domain of\ndiscourse: just the integers 1, 2, 3, and 4.",
    "For each of the 16 pairs of these\nnumbers, 𝑃(𝑥, 𝑦) is either true or false, according to the following table (𝑥\nvalues are rows, 𝑦values are columns).\n",
    "1\n2\n3\n4\n1\nT\nF\nF\nF\n2\nF\nT\nT\nF\n3\nT\nT\nT\nT\n4\nF\nF\nF\nF\nFor example, 𝑃(1, 3) is false, as indicated by the F in the first row, third\ncolumn.\n",
    "Use the table to decide whether the following statements are true or false.\n(a) ∀𝑦∃𝑥𝑃(𝑥, 𝑦).\n",
    "(b) ∃𝑥∀𝑦𝑃(𝑥, 𝑦).\n",
    "(c) ∀𝑥∃𝑦𝑃(𝑥, 𝑦).\n",
    "(d) ∃𝑦∀𝑥𝑃(𝑥, 𝑦).\n",
    "1.1.6\nAdditional Exercises\n1.\nSuppose 𝑃and 𝑄are the statements: 𝑃: Jack passed math.",
    "𝑄:",
    "Jill passed\nmath.\n",
    "(a) Translate “Jack and Jill both passed math” into symbols.\n",
    "(b) Translate “If Jack passed math, then Jill did not” into symbols.\n",
    "(c) Translate “𝑃∨𝑄” into English.\n",
    "(d) Translate “¬(𝑃∧𝑄) →𝑄” into English.\n",
    "(e) Suppose you know that if Jack passed math, then so did Jill.",
    "What can\nyou conclude if you know that:\ni. Jill passed math?\nii.",
    "Jill did not pass math?\n2.\nTranslate into symbols.",
    "Use 𝐸(𝑥) for “𝑥is even” and 𝑂(𝑥) for “𝑥is odd.”\n(a)",
    "No number is both even and odd.\n\n1.1.",
    "Mathematical Statements\n29\n(b) One more than any even number is an odd number.\n",
    "(c) There is a prime number that is even.\n",
    "(d) Between any two numbers there is a third number.\n",
    "(e) There is no number between a number and one more than that number.\n",
    "3.\nFor each of the statements below, give a domain of discourse for which the\nstatement is true, and a domain for which the statement is false.\n(a) ∀𝑥∃𝑦(𝑦2 = 𝑥).\n",
    "(b) ∀𝑥∀𝑦(𝑥< 𝑦→∃𝑧(𝑥< 𝑧< 𝑦)).\n",
    "(c) ∃𝑥∀𝑦∀𝑧(𝑦< 𝑧→𝑦≤𝑥≤𝑧).\n\n",
    "1.2\nImplications\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Explain the conditions under which an implication is true.\n",
    "2. Identify statements as equivalent to a given implication or its converse.\n",
    "3. Explain the relationship between the truth values of an implication,\nits converse, and its contrapositive.\n",
    "1.2.1\nSection Preview\nInvestigate!\n",
    "Little Timmy’s",
    "Mom tells him, “If you don’t eat all your broccoli, then you\nwill not get any ice cream.”",
    "Of course, Timmy loves his ice cream, so he\nquickly eats all his broccoli (which actually tastes pretty good).\n",
    "After dinner, when Timmy asks for his ice cream, he is told no!",
    "Does\nTimmy have a right to be upset?",
    "Why or why not?\n",
    "By far, the most important type of statement in mathematics is the implication.\n",
    "It is also the least intuitive of our basic molecular statement types.",
    "Our goal in this\nsection is to become more familiar with this key concept.\n",
    "To see why this sort of statement is so prevalent, consider the Pythagorean Theorem.\n",
    "Despite what social media might claim, the Pythagorean Theorem is not\n𝑎2 + 𝑏2 = 𝑐2.\n",
    "Okay, sure, that has a variable in it, so we must be using the convention to take the\nuniversal generalization,\n∀𝑎, 𝑏, 𝑐∈ℝ\u0000𝑎2 + 𝑏2 = 𝑐2\u0001\n.\n",
    "So 12 + 52 = 22???",
    "Okay, fine.",
    "The equation is true as long as 𝑎and 𝑏are the lengths\nof the legs of a right triangle and 𝑐is the length of the hypotenuse.",
    "In other words:\nIf 𝑎and 𝑏are the lengths of the legs of a right triangle with hypotenuse\nof length 𝑐, then 𝑎2 + 𝑏2 = 𝑐2.\nMath is about making general claims, but a claim is rarely going to be true of\nabsolutely every mathematical object.",
    "The way we restrict our claims to a particular\ntype of object is with an implication: “Take any object you like, if it is of the right\ntype, then this thing is true about it.”\n30\n\n1.2.",
    "Implications\n31\nSimilarly, as we saw in the Quantifiers and Predicates subsection, when we\nmake claims like “Every square is a rectangle,” we really have an implication: “If\nsomething is a square, then it is a rectangle.”\n",
    "Here is a reminder of what we mean by an implication.\n",
    "Definition 1.2.1 Implication.\n",
    "An implication (or conditional) is a molecular statement of the form\n𝑃→𝑄\nwhere 𝑃and 𝑄are statements.",
    "We say that\n• 𝑃is the hypothesis (or antecedent).\n",
    "•",
    "𝑄is the conclusion (or consequent).\n",
    "An implication is true provided 𝑃is false or 𝑄is true (or both), and false\notherwise.",
    "In particular, the only way for 𝑃→𝑄to be false is for 𝑃to be true\nand 𝑄to be false.\n",
    "The definition of truth of an implication can also be represented as a truth table:\n𝑃\n𝑄\n𝑃→𝑄\nT\nT\nT\nT\nF\nF\nF\nT\nT\nF\nF\nT\nFigure 1.2.2",
    "The truth table for 𝑃→𝑄.\nDoes this truth table make sense?",
    "Should we believe it?",
    "Look in particular at\nthe third row: F, T, T, and consider the implication, “If 5 < 3 then 5 + 3 = 8.”",
    "Does\nthat statement feel true?",
    "The truth table says it should be (since 5 < 3 is false, and\n5 + 3 = 8 is true).\n",
    "Much of what we will do in the remainder of this section is convince ourselves\nthat this truth table makes sense.\n",
    "Preview Activity\n1.\nConsider the statement, “If Tommy doesn’t eat his broccoli, then he will not\nget any ice cream.”",
    "Which of the following statements mean the same thing\n(i.e., will be true in the same situations)?",
    "Select all that apply.\n",
    "A.",
    "If Tommy does eat his broccoli, then he will get ice cream.\n",
    "B.",
    "If Tommy gets ice cream, then he ate his broccoli.\n",
    "C. If Tommy doesn’t get ice cream, then he didn’t eat his broccoli.\n\n",
    "32\n1.",
    "Logic and Proofs\nD. Tommy ate his broccoli and still didn’t get any ice cream.\n",
    "2.\nSuppose that your shady uncle offers you the following deal: If you loan him\nyour car, then he will bring you tacos.",
    "In which of the following situations\nwould it be fair to say that your uncle is a liar (i.e., that his statement was false)?\n",
    "Select all that apply.\n",
    "A. You loan him your car.",
    "He brings you tacos.\n",
    "B. You loan him your car.",
    "He never buys you tacos.\n",
    "C. You don’t loan him your car.",
    "He still brings you tacos.\n",
    "D. You don’t loan him your car.",
    "He never brings you tacos.\n",
    "3.\nConsider the sentence, “If 𝑥≥10, then 𝑥2 ≥25.”",
    "This sentence becomes a\nstatement when we replace 𝑥by a value, or “capture” the 𝑥in the scope of a\nquantifier.",
    "Which of the following claims are true (select all that apply)?\n",
    "A.",
    "If we replace 𝑥by 15, then the resulting statement is true.\n",
    "(Note,\n152 = 225.)\n",
    "B.",
    "If we replace 𝑥by 3, then the resulting statement is true.\n",
    "C. If we replace 𝑥by 6, then the resulting statement is true.\n",
    "D. The universal generalization (“for all 𝑥, if 𝑥≥10 the 𝑥2 ≥25”) is true.\n",
    "E. There is a number we could replace 𝑥with that makes the statement\nfalse.\n",
    "4.\nConsider the statement, “If I see a movie, then I eat popcorn” (which happens\nto be true).",
    "Based solely on your intuition of English, which of the following\nstatements mean the same thing?",
    "Select all that apply.\n",
    "A.",
    "If I eat popcorn, then I see a movie.\n",
    "B.",
    "If I don’t eat popcorn, then I don’t see a movie.\n",
    "C. It is necessary that I eat popcorn when I see a movie.\n",
    "D. To see a movie, it is sufficient for me to eat popcorn.\n",
    "E. I only watch a movie if I eat popcorn.\n",
    "1.2.2\nUnderstanding the Truth Table\n",
    "The truth value of the implication is determined by the truth values of its two parts.\n",
    "Our definition of the truth conditions for an implication says that there is only one\nway for an implication to be false: when the hypothesis is true and the conclusion is\nfalse.\n\n",
    "1.2.",
    "Implications\n33\nExample 1.2.3\nConsider the statement:\nIf Bob gets a 90 on the final, then Bob will pass the class.\n",
    "This is definitely an implication: 𝑃is the statement “Bob gets a 90 on the final,”\nand 𝑄is the statement “Bob will pass the class.”\n",
    "Suppose I made that statement to Bob.",
    "In what circumstances would it be\nfair to call me a liar?",
    "What if Bob really did get a 90 on the final, and he did\npass the class?",
    "Then I have not lied; my statement is true.",
    "However, if Bob\ndid get a 90 on the final and did not pass the class, then I lied, making the\nstatement false.",
    "The tricky case is this: What if Bob did not get a 90 on the\nfinal?",
    "Maybe he passes the class, maybe he doesn’t.",
    "Did I lie in either case?",
    "I\nthink not.",
    "In these last two cases, 𝑃was false, and the statement 𝑃→𝑄was\ntrue.",
    "In the first case, 𝑄was true, and so was 𝑃→𝑄. So 𝑃→𝑄is true when\neither 𝑃is false or 𝑄is true.\n",
    "Just to be clear, although we sometimes read 𝑃→𝑄as “𝑃implies 𝑄”, we are\nnot insisting that there is some causal relationship between the statements 𝑃and 𝑄\n(although there might be).",
    "“If 𝑥< 𝑦, then 𝑥+ 1 < 𝑦+ 1,” is a true statement (or at\nleast, its universal generalization is).",
    "We know it is true because we understand how\nthe two parts interact.",
    "If you add 1 to two numbers 𝑥and 𝑦, then their order does\nnot change.",
    "But the statement, “if 1 < 2, then Euclid studied geometry” is also a\ntrue implication.\n",
    "Example 1.2.4\nDecide which of the following statements are true and which are false.",
    "Briefly\nexplain.\n",
    "1.",
    "If 1 = 1, then most horses have 4 legs.\n",
    "2.",
    "If 0 = 1, then 1 = 1.\n3.",
    "If 8 is a prime number, then the 7624th digit of 𝜋is an 8.\n4.",
    "If the 7624th digit of 𝜋is an 8, then 2 + 2 = 4.\nSolution.\n",
    "All four of the statements are true.",
    "Remember, the only way for\nan implication to be false is for the if part to be true and the then part to be\nfalse.\n",
    "1.",
    "Here both the hypothesis and the conclusion are true, so the implication\nis true.",
    "It does not matter that there is no meaningful connection\nbetween the true mathematical fact and the fact about horses.\n\n",
    "34\n1.",
    "Logic and Proofs\n2.",
    "Here the hypothesis is false and the conclusion is true, so the implication\nis true.\n",
    "3.",
    "I have no idea what the 7624th digit of 𝜋is, but this does not matter.\n",
    "Since the hypothesis is false, the implication is automatically true.\n",
    "4.",
    "Regardless of the truth value of the hypothesis, the conclusion is true,\nmaking the implication true.\n",
    "This is a strange example and isn’t really how we use implications anyway.",
    "This\nstrangeness is not just mathematicians being stubborn though.",
    "The truth conditions\nfor implications must be like they are for mathematics to make sense.",
    "Let’s see why.\n",
    "Example 1.2.5\nConsider the statement, “All squares are rectangles,” which can also be\nphrased as, “For all shapes, if the shape is a square, then it is a rectangle.”",
    "Is\nthis statement true or false?",
    "Are we sure?",
    "What about the following three\nshapes?\nSolution.\n",
    "Of course the statement is true.",
    "A square is a 4-sided plane figure\nwith 4 right angles and 4 equal-length sides, while a rectangle is a 4-sided\nplane figure with 4 right angles.\n",
    "However, what we mean when we consider a universal statement like\nthis is that, no matter what we “plug in” for the variable (“the shape” in this\ncase), the resulting statement is true.",
    "When the statement is about a particular\nshape, we have an implication 𝑃→𝑄.",
    "This means it must be true that, if the\nactual shape on the left is a square, then it is a rectangle.",
    "Great.",
    "The shape is a\nsquare (𝑃is true) and is a rectangle (𝑄is true), so yes, the implication is true.\n",
    "Is the implication true of the rectangle in the middle?",
    "Well, that shape\nis not a square (𝑃is false), and it is a rectangle (𝑄is true).",
    "But look, we\nbelieve that all squares are rectangles, so the statement must be true.",
    "Even of\na rectangle.",
    "The only way this works is if “true implies false” is true!\n",
    "Similarly, all squares are rectangles is a true statement, even when we look\nat a triangle.",
    "𝑃is false (the triangle is not a square), and 𝑄is false (the triangle\nis not a rectangle).",
    "Thankfully, we defined implications to be true in this case\nas well.\n",
    "We have given shapes that illustrate lines 1, 3, and 4 of the truth table for\nimplications (Figure 1.2.2).",
    "What shape illustrates line 2?",
    "That would need to\n\n1.2.",
    "Implications\n35\nbe a shape that was a square and was not a rectangle....",
    "Of course we can’t\nfind one, precisely because the statement is true!\n",
    "1.2.3\nRelated Statements\nAn implication is a way of expressing a relationship between two statements.",
    "It is\noften interesting to ask whether there are other relationships between the statements.\n",
    "Here we introduce some common language to address this question.\n",
    "Definition 1.2.6 Converse, Contrapositive, and Inverse.\n",
    "Given an implication 𝑃→𝑄, we say,\n•",
    "The converse is the statement 𝑄→𝑃.\n•",
    "The contrapositive is the statement ¬𝑄→¬𝑃.\n•",
    "The inverse is the statement, ¬𝑃→¬𝑄.\nExample 1.2.7\nConsider the implication, “If you clean your room, then you can go to the\nparty.”",
    "Give the converse, contrapositive, and inverse of this statement\nSolution.\n",
    "The converse is, “If you can go to the party, then you clean your\nroom.”\n",
    "The contrapositive is, “If you can’t go to the party, then you don’t clean\nyour room.”\n",
    "The inverse is, “If you don’t clean your room, then you can’t go to the\nparty.”\n",
    "Symbolically, both the converse and the contrapositive switch the order of the two\nparts of the statement (or alternatively, think about turning the arrow to point in the\nother direction).",
    "The contrapositive and the inverse take the negation of both of the\nstatements.",
    "Notice that if you take the converse (switch the order) and then take the\ncontrapositive of that converse (switch the order back and negate both parts) you get\nthe inverse.",
    "So the inverse is nothing more than the contrapositive of the converse.\n",
    "Or the converse of the contrapositive, which is a fun fact to mention at parties.\n",
    "When considering statements with quantifiers, we ignore the outside quantifiers\nwhen forming the converse, contrapositive, and inverse.\n\n",
    "36\n1.",
    "Logic and Proofs\nQuantifiers and the Converse, Contrapositive, and Inverse.\n",
    "A quantified implication ∀𝑥(𝑃(𝑥) →𝑄(𝑥)) has:\nConverse\n∀𝑥(𝑄(𝑥) →𝑃(𝑥))\n",
    "Contrapositive\n∀𝑥(¬𝑄(𝑥) →¬𝑃(𝑥))\n",
    "Inverse\n∀𝑥(¬𝑃(𝑥) →¬𝑄(𝑥))\n",
    "Note 1.2.8 It is unlikely that we would encounter a statement of the form\n∃𝑥(𝑃(𝑥) →𝑄(𝑥)), since this would be automatically true if there was any\n𝑥that made 𝑃(𝑥) false.",
    "But if we did, the same rules would apply to the\nconverse, contrapositive, and inverse as above: Just ignore the quantifier when\nswapping and/or negating the parts of the implication.\n",
    "For example, “For all shapes, if the shape is a square, then it is a rectangle” (i.e.,\nall squares are rectangles) has the converse, “For all shapes, if the shape is a rectangle,\nthen it is a square” (so all rectangles are squares).\n",
    "Well, that’s not true!",
    "There exist shapes that are rectangles and are NOT squares.\n",
    "Indeed, this is an example of a statement that is true with a false converse.",
    "There are\nlots of examples of this throughout mathematics.",
    "There are also examples of true\nimplications that have true converses.",
    "You just can’t know from the logic.2\nThe contrapositive of “For all shapes, if it is a square, then it is a rectangle” is\n“For all shapes, if the shape is not a rectangle, then it is not a square.”",
    "This is true.",
    "In\nfact, the contrapositive of a true statement is always true!\n",
    "Since the contrapositive of an implication always has the same truth value as its\noriginal implication, it can often be helpful to analyze the contrapositive to decide\nwhether an implication is true.\n",
    "Example 1.2.9\nTrue or false: If you draw any nine playing cards from a regular deck, then\nyou will have at least three cards all of the same suit.",
    "Is the converse true?\nSolution.\n",
    "True.",
    "The original implication is a little hard to analyze because\nthere are so many combinations of nine cards.",
    "But consider the contrapositive:\nif you don’t have at least three cards all of the same suit, then you don’t have\nnine cards.",
    "It is easy to see why this is true.",
    "If you don’t have at least three\ncards in a suit, you can have at most two cards of each of the four suits, for a\ntotal of at most eight cards.\n",
    "2It turns out the Pythagorean Theorem is one such statement.",
    "It is also true that if 𝑎2 + 𝑏2 = 𝑐2,\nthen there is a right triangle with legs of lengths 𝑎and 𝑏and hypotenuse of length 𝑐.",
    "So we could have\nalso written the theorem as a biconditional: “𝑎and 𝑏are the lengths of the legs of a right triangle with\nhypotenuse of length 𝑐if and only if 𝑎2 + 𝑏2 = 𝑐2.”\n\n1.2.",
    "Implications\n37\nThe converse: If you have at least three cards of the same suit, then you\nhave nine cards.",
    "This is false.",
    "You could have three spades and nothing\nelse.",
    "Note that to demonstrate that the converse (an implication) is false, we\nprovided an example where the hypothesis is true (you do have three cards\nof the same suit), but where the conclusion is false (you do not have nine\ncards).",
    "In other words, we find some example that puts us in row 2 of the\nimplication’s truth table.\n",
    "Understanding converses and contrapositives can help understand implications\nand their truth values:\nExample 1.2.10\nSuppose I tell Sue that if she gets a 93% on her final, then she will get an A in\nthe class.",
    "Assuming that what I said is true, what can you conclude in the\nfollowing cases:\n",
    "1.",
    "Sue gets a 93% on her final.\n",
    "2.",
    "Sue gets an A in the class.\n",
    "3.",
    "Sue does not get a 93% on her final.\n",
    "4.",
    "Sue does not get an A in the class.\nSolution.\n",
    "Note first that whenever 𝑃→𝑄and 𝑃are both true statements,\n𝑄must be true as well.",
    "For this problem, take 𝑃to mean “Sue gets a 93% on\nher final” and 𝑄to mean “Sue will get an A in the class.”\n",
    "1.",
    "We have 𝑃→𝑄and 𝑃, so 𝑄follows.",
    "Sue gets an A.\n2.",
    "You cannot conclude anything.",
    "Sue could have gotten the A because\nshe did extra credit, for example.",
    "Notice that we do not know that if\nSue gets an 𝐴, then she gets a 93% on her final.",
    "That is the converse of\nthe original implication, so it might or might not be true.\n",
    "3.",
    "The contrapositive of the converse of 𝑃→𝑄is ¬𝑃→¬𝑄, which states\nthat if Sue does not get a 93% on the final, then she will not get an A in\nthe class.",
    "But this does not follow from the original implication.",
    "Again,\nwe can conclude nothing.",
    "Sue could have done extra credit.\n",
    "4.",
    "What would happen if Sue did not get an A but did get a 93% on the\nfinal?",
    "Then 𝑃would be true, and 𝑄would be false.",
    "This makes the\nimplication 𝑃→𝑄false!",
    "It must be that Sue did not get a 93% on\nthe final.",
    "Notice we now have the implication ¬𝑄→¬𝑃which is the\ncontrapositive of 𝑃→𝑄. Since 𝑃→𝑄is assumed to be true, we know\n¬𝑄→¬𝑃is true as well.\n\n",
    "38\n1.",
    "Logic and Proofs\nAs we said above, an implication is not logically equivalent to its converse, but it\nis possible that both the implication and its converse are true.",
    "In this case, when\nboth 𝑃→𝑄and 𝑄→𝑃are true, we say that 𝑃and 𝑄are equivalent and write\n𝑃↔𝑄. This is the biconditional we mentioned in Section 1.1.\n",
    "You can think of “if and only if” statements as having two parts: an implication\nand its converse.",
    "We might say one is the “if” part, and the other is the “only if”\npart.",
    "We also sometimes say that “if and only if” statements have two directions: a\nforward direction (𝑃→𝑄) and a backward direction (𝑃←𝑄, which is really just\nsloppy notation for 𝑄→𝑃).\n",
    "Let’s think a little about which part is which.",
    "Is 𝑃→𝑄the “if” part or the “only\nif” part?",
    "Consider an example.\n",
    "Example 1.2.11\nSuppose it is true that I sing if and only if I’m in the shower.",
    "We know this\nmeans both that if I sing, then I’m in the shower, and also the converse, that if\nI’m in the shower, then I sing.",
    "Let 𝑃be the statement, “I sing,” and 𝑄be, “I’m\nin the shower.”",
    "So 𝑃→𝑄is the statement “if I sing, then I’m in the shower.”\n",
    "Which part of the if and only if statement is this?\nWhat we are really asking for is the meaning of “I sing if I’m in the shower”\nand “I sing only if I’m in the shower.”",
    "When is the first one (the “if” part)\nfalse?",
    "When I am in the shower but not singing.",
    "That is the same condition\nfor being false as the statement, “If I’m in the shower, then I sing.”",
    "So the “if”\npart is 𝑄→𝑃.",
    "On the other hand, to say, “I sing only if I’m in the shower” is\nequivalent to saying “If I sing, then I’m in the shower,” so the “only if” part is\n𝑃→𝑄.\nIt is not especially important to know which part is the “if” or “only if” part, but\nthis does illustrate something very, very important: There are many ways to state an\nimplication!\n",
    "Example 1.2.12\nRephrase the implication, “If I dream, then I am asleep” in as many ways as\npossible.",
    "Then do the same for the converse.\nSolution.\n",
    "The following are all equivalent to the original implication:\n1.",
    "I am asleep if I dream.\n",
    "2.",
    "I dream only if I am asleep.\n",
    "3.",
    "In order to dream, I must be asleep.\n",
    "4.",
    "To dream, it is necessary that I am asleep.\n",
    "5.",
    "To be asleep, it is sufficient to dream.\n\n",
    "1.2.",
    "Implications\n39\n6.",
    "I am not dreaming unless I am asleep.\n",
    "The following are equivalent to the converse (if I am asleep, then I dream):\n",
    "1.",
    "I dream if I am asleep.\n",
    "2.",
    "I am asleep only if I dream.\n",
    "3.",
    "It is necessary that I dream in order to be asleep.\n",
    "4.",
    "It is sufficient that I be asleep in order to dream.\n",
    "5.",
    "If I don’t dream, then I’m not asleep.\n",
    "Hopefully you agree with the above example.",
    "We include the “necessary and\nsufficient” versions because those are common when discussing mathematics.",
    "Let’s\nagree once and for all what they mean.\n",
    "Definition 1.2.13 Necessary and Sufficient.\n• “𝑃is necessary for 𝑄” means 𝑄→𝑃.\n",
    "•",
    "“𝑃is sufficient for 𝑄” means 𝑃→𝑄.\n• If 𝑃is necessary and sufficient for 𝑄, then 𝑃↔𝑄.\nTo be honest, I have trouble with these if I’m not very careful.",
    "I find it helps to\nkeep a standard example for reference.\n",
    "Example 1.2.14\nIn a regular deck of cards, the red suits are hearts and diamonds.",
    "The black\nsuits are clubs and spades.",
    "Thus it is true that, after picking a card, if my card\nis a spade, then my card is black.\n",
    "Restate this fact using necessary and sufficient phrasing.\n",
    "Solution.\n",
    "For my card to be a spade, it is necessary that it is black.",
    "However,\nit is not sufficient for it to be black to say that I am holding a spade (since I\ncould have a club).\n",
    "I can also say that to have a black card, it is sufficient to have a spade.",
    "It is\nnot necessary that I have a spade.\n",
    "It is helpful to think about the amount of evidence you need.",
    "Is knowing\nthat the card is a spade enough evidence to conclude that it is a black card?\n",
    "Yes, that is sufficient!",
    "Being a spade is a sufficient condition for the card to be\nblack.\n",
    "Thinking about the necessity and sufficiency of conditions can also help when\nwriting proofs and justifying conclusions.",
    "If you want to establish some mathematical\n\n40\n1.",
    "Logic and Proofs\nfact, it is helpful to think what other facts would be enough (be sufficient) to prove\nyour fact.",
    "If you have an assumption, think about what must also be necessary if\nthat hypothesis is true.\n",
    "1.2.4\nReading Questions\n1.\n",
    "It happens to be true that all mammals have hair.",
    "Which of the following are\nalso true?\nA.",
    "Having hair is a necessary condition for being a mammal.\n",
    "B. Having hair is a sufficient condition for being a mammal.\n",
    "C. If an animal doesn’t have hair, then it is not a mammal.\n",
    "D. An animal is a mammal only if it has hair.\n",
    "2.\nGive an example of a true implication (written out in words) that has a false\nconverse.",
    "Explain why your implication is true and why the converse is false.\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "1.2.5\nPractice Problems\n1.\n",
    "In my safe is a sheet of paper with two shapes drawn on it in colored crayon.\n",
    "One is a circle, and the other is a pentagon.",
    "Each shape is drawn in a single\ncolor.",
    "Suppose you believe me when I tell you that, \"If the circle is purple, then\nthe pentagon is orange.\n",
    "What do you therefore know about the truth value of the following state-\nments?\n(a) The circle and the pentagon are both purple.\n",
    "(b) The circle and the pentagon are both orange.\n",
    "(c)",
    "The circle is not purple, or the pentagon is orange.\n",
    "(d) If the pentagon is orange, then the circle is purple.\n",
    "(e) If the pentagon is not orange, then the circle is not purple.\n",
    "2.\nSuppose the statement, \"If the square is yellow, then the circle is purple,\" is true.\n",
    "Assume also that the converse is false.",
    "Classify each statement below as true or\nfalse (if possible).\n",
    "(a) The circle is purple.\n",
    "(b) The square is yellow if and only if the circle is not purple.\n",
    "(c)",
    "The square is yellow.\n\n",
    "1.2.",
    "Implications\n41\n(d)",
    "The square is yellow if and only if the circle is purple.\n",
    "3.\nConsider the statement, \"If you will give me magic beans, then I will give you a\ncow.\"",
    "Decide whether each statement below is the converse, the contrapositive,\nor neither.\n",
    "(a) If I will give you a cow, then you will not give me magic beans.\n",
    "(b) If I will give you a cow, then you will give me magic beans.\n",
    "(c) If you will not give me magic beans, then I will not give you a cow.\n",
    "(d) If you will give me magic beans, then I will not give you a cow.\n(e) You will give me magic beans, and I will not give you a cow.\n",
    "(f)",
    "If I will not give you a cow, then you will not give me magic beans.\n",
    "4.\nYou have discovered an old paper on graph theory that discusses the viscosity\nof a graph (which for all you know, is something completely made up by the\nauthor).",
    "A theorem in the paper claims that “if a graph satisfies condition\n(V), then the graph is viscous.”",
    "Which of the following are equivalent ways of\nstating this claim?",
    "Which are equivalent to the converse of the claim?\n(a) Only viscous graphs satisfy condition (V).\n",
    "(b) For a graph to be viscous, it is necessary that it satisfies condition (V).\n",
    "(c) A graph is viscous only if it satisfies condition (V).\n",
    "(d) Satisfying condition (V) is a necessary condition for a graph to be viscous.\n",
    "(e) A graph is viscous if it satisfies condition (V).\n",
    "5.\nWhich of the following statements are equivalent to the implication, \"if you\nwin the lottery, then you will be rich,\" and which are equivalent to the converse of\nthe implication?\n(a) If you are not rich, then you did not win the lottery.\n",
    "(b) It is sufficient to win the lottery to be rich.\n",
    "(c)",
    "Either you win the lottery, or else you are not rich.\n",
    "(d) If you are rich, you must have won the lottery.\n",
    "(e) You will win the lottery if and only if you are rich.\n\n",
    "42\n1.",
    "Logic and Proofs\n1.2.6\nAdditional Exercises\n1.\nTranslate into English:\n(a) ∀𝑥(𝐸(𝑥) →𝐸(𝑥+ 2)).\n",
    "(b) ∀𝑥∃𝑦(sin(𝑥) = 𝑦).\n",
    "(c) ∀𝑦∃𝑥(sin(𝑥) = 𝑦).\n",
    "(d) ∀𝑥∀𝑦(𝑥3 = 𝑦3 →𝑥= 𝑦).\n",
    "2.\nConsider the statement, “If Oscar eats Chinese food, then he drinks milk.”\n(a) Write the converse of the statement.\n",
    "(b) Write the contrapositive of the statement.\n",
    "(c) Is it possible for the contrapositive to be false?",
    "If it was, what would that\ntell you?\n(d) Suppose the original statement is true, and that Oscar drinks milk.",
    "Can\nyou conclude anything (about his eating Chinese food)?",
    "Explain.\n",
    "(e) Suppose the original statement is true, and that Oscar does not drink milk.\n",
    "Can you conclude anything (about his eating Chinese food)?",
    "Explain.\n",
    "3.\nWrite each of the following statements in the form, “If . . .",
    ", then . . . .”",
    "Careful,\nsome statements may be false (which is fine for the purposes of this question).\n",
    "(a) To lose weight, you must exercise.\n",
    "(b) To lose weight, all you need to do is exercise.\n",
    "(c)",
    "Every American is patriotic.\n",
    "(d) You are patriotic only if you are American.\n",
    "(e) The set of rational numbers is a subset of the real numbers.\n",
    "(f)",
    "A number is prime if it is not even.\n",
    "(g)",
    "Either the Broncos will win the Super Bowl, or they won’t play in the\nSuper Bowl.\n",
    "4.\nConsider the implication, “If you clean your room, then you can watch TV.”\n",
    "Rephrase the implication in as many ways as possible.",
    "Then do the same for\nthe converse.\n",
    "5.\nRecall from calculus, if a function is differentiable at a point 𝑐, then it is\ncontinuous at 𝑐, but that the converse of this statement is not true (for example,\n𝑓(𝑥) = |𝑥| at the point 0).",
    "Restate this fact using “necessary and sufficient”\nlanguage.\n\n",
    "1.2.",
    "Implications\n43\n6.\nConsider the statement, “For all natural numbers 𝑛, if 𝑛is prime, then 𝑛is\nsolitary.”",
    "You do not need to know what solitary means for this problem, just\nthat it is a property that some numbers have and others do not.\n",
    "(a) Write the converse and the contrapositive of the statement, saying which\nis which.",
    "Note: the original statement claims that an implication is true\nfor all 𝑛, and it is that implication that we are taking the converse and\ncontrapositive of.\n(b) Write the negation of the original statement.",
    "What would you need to\nshow to prove that the statement is false?\n(c) Even though you don’t know whether 10 is solitary (in fact, nobody\nknows this), is the statement, “If 10 is prime, then 10 is solitary” true or\nfalse?",
    "Explain.\n",
    "(d) It turns out that 8 is solitary.",
    "Does this tell you anything about the truth\nor falsity of the original statement, its converse or its contrapositive?\nExplain.\n",
    "(e) Assuming that the original statement is true, what can you say about the\nrelationship between the set 𝑃of prime numbers and the set 𝑆of solitary\nnumbers.",
    "Explain.\n\n",
    "1.3\nRules of Logic\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Use truth tables to determine whether two statements are logically\nequivalent.\n",
    "2. Use truth tables to determine whether a deduction rule is valid.\n",
    "3. Use logical equivalence and deduction rules to simplify statements\nand make deductions.\n",
    "1.3.1\nSection Preview\nInvestigate!\n",
    "Holmes always wears one of the two vests he owns: one tweed and one\nmint green.",
    "He always wears either the green vest or red shoes.",
    "Whenever\nhe wears a purple shirt and the green vest, he chooses to not wear a bow tie.\n",
    "He never wears the green vest unless he is also wearing either a purple shirt\nor red shoes.",
    "Whenever he wears red shoes, he also wears a purple shirt.\n",
    "Today, Holmes wore a bow tie.",
    "What else did he wear?\n",
    "Try it 1.3.1\nSpend a few minutes thinking about the Investigate! question above.",
    "Of the six\nstatements in the puzzle, only one is atomic.",
    "Use this atomic statement and\none other statement to deduce a new statement about what Holmes might (or\nmight not) be wearing.",
    "Explain why you think your new statement is true.\n",
    "Hint.\n",
    "The atomic statement is, “Holmes wore a bow tie.”",
    "Only one of the\nmolecular statements has this as one of its atoms.\n",
    "Logic studies the ways statements can interact with each other.",
    "More precisely,\nwe consider the way the logical form statements can interact.",
    "The study of logic does\nnot care about the content of the atomic statements or the meaning of predicates.\n",
    "For example, the claims, “If spiders have six legs, then Sam walks with a limp,” and,\n“If the moon is made of cheese, then cheddar is a type of cheese,” are identical from a\nlogical perspective.",
    "Logic doesn’t care about whether Sam is a spider or the culinary\nmakeup of the moon.",
    "Both statements have the same form: They are implications,\n𝑃→𝑄.\nOf course, in mathematics we often do know some relationship between various\n44\n\n1.3.",
    "Rules of Logic\n45\natomic statements.",
    "For example, we know a relationship between being even and\nbeing a multiple of 10.",
    "That relationship allows us to make claims such as, “If\nthe number I’m thinking of is a multiple of 10, then it is even.”",
    "Suppose I also\ntold you that I am now thinking of a number that is not even.",
    "We can deduce\nthat I am not thinking of a multiple of 10!",
    "Crucially, if we accept the truth of the\nstatements here, we can make this deduction without thinking about the nature of\nnumbers.",
    "It can feel very liberating and provide much-needed clarity when trying\nto understand complicated reasoning if we can separate the content from the logical\nform of arguments.\n",
    "Our goal in this section is to establish some procedures for analyzing how the\ntruth or falsity of statements interact, based on their logical form.",
    "We will see that\nsome molecular statements must be true regardless of whether their atomic parts\nare true or false, while some statements must always be false.",
    "For other statements,\nit can be that two statements are always true or false together, or that whenever one\nstatement is true, another statement must also be true.\n",
    "The main method for establishing these relationships will be truth tables.\n",
    "There is a very clear procedure for constructing and analyzing truth tables, but for\ncomplicated arguments that contain many atomic statements, the truth tables become\nvery large and unwieldy.",
    "We will therefore use truth tables to understand some\nbasic equivalences and deductions that can be applied in a sequence of reasoning to\nconstruct larger arguments.\n",
    "Preview Activity\n1.\nConsider the statement, “Whenever Holmes wears a purple shirt and the green\nvest, he chooses to not wear a bow tie.”",
    "Let 𝑃be the statement, “Holmes wears\na purple shirt,” 𝐺be the statement, “Holmes wears the green vest,” and 𝐵be\nthe statement, “Holmes wears a bow tie.”",
    "Which of the following is the best\ntranslation of the statement into propositional logic?\nA. (𝑃∧𝐺) →¬𝐵\nB. (𝑃∧𝐺)",
    "→𝐵\nC. (𝑃∨𝐺) →¬𝐵\nD. 𝑃∧(𝐺→𝐵)\n2.\nConsider the statement, “Holmes never wears the green vest unless he is also\nwearing either a purple shirt or red shoes.”",
    "With 𝑃and 𝐺as in the previous\nquestion, and 𝑅being the statement, “Holmes wears red shoes,” which of the\nfollowing is the best translation of the statement into propositional logic?\nA. 𝐺→(𝑃∨𝑅)\nB. ¬𝐺→(𝑃∨𝑅)\nC. (𝑃∨𝑅) →𝐺\n\n46\n1.",
    "Logic and Proofs\nD. (𝑃∨𝑅) →¬𝐺\n3.\nConsider the statement, “If you major in math, then you will get a high-paying\njob,” and the statement, “Either you don’t major in math, or you will get a\nhigh-paying job.”",
    "In which of the following cases are both statements true?\nSelect all that apply.\n",
    "A. You major in math and get a high-paying job.\n",
    "B. You major in math and don’t get a high-paying job.\n",
    "C. You don’t major in math and do get a high-paying job.\n",
    "D. You don’t major in math and don’t get a high-paying job.\n",
    "1.3.2\nTruth Tables\nHere’s a question about playing Monopoly:\nIf you get more doubles than any other player, then you will lose, or if\nyou lose, then you must have bought the most properties.\n",
    "True or false?",
    "We will answer this question and won’t need to know anything about\nMonopoly.",
    "Instead, we will look at the logical form of the statement.\n",
    "We need to decide when the statement (𝑃→𝑄) ∨(𝑄→𝑅) is true.",
    "Using the\ndefinitions of the connectives in Definition 1.1.8, we see that for this to be true, either\n𝑃→𝑄must be true or 𝑄→𝑅must be true (or both).",
    "Those are true if either 𝑃is\nfalse or 𝑄is true (in the first case) and 𝑄is false or 𝑅is true (in the second case).\n",
    "So—yeah, it gets a bit messy.",
    "Luckily, we can make a chart to keep track of all the\npossibilities with a truth table.\n",
    "The idea is this: On each row, we list a possible combination of T’s and F’s (Trues\nand Falses) for each of the propositional variables, and then mark down whether the\n(molecular) statement in question is true or false in that case.",
    "We do this for every\npossible combination of T’s and F’s.",
    "Then we can clearly see the cases in which the\nstatement is true or false.",
    "For complicated statements, we will first fill in values\nfor each part of the statement, as a way of breaking up our task into smaller, more\nmanageable pieces.\n",
    "Since the truth value of a statement is completely determined by the truth values\nof its parts and how they are connected, all you need to know is the truth tables for\neach of the logical connectives, which we have already seen in Figure 1.1.9\nThe truth tables we consider here all build off the basic ones, applying the basic\nrules multiple times.\n",
    "Example 1.3.2\nMake a truth table for the statement ¬𝑃∨𝑄.\nSolution.\n",
    "Note that this statement is not ¬(𝑃∨𝑄); the negation belongs to\n𝑃alone.",
    "The main connective here is the ∨, which means we will use that\n\n1.3.",
    "Rules of Logic\n47\ntruth table last.",
    "First, we apply the truth table for ¬, and then apply the truth\ntable for ∨using “inputs” from ¬𝑃and 𝑄.\n",
    "Since there are two variables, there are four possible combinations of T’s\nand F’s.",
    "Putting this all together gives us the following truth table.\n",
    "𝑃\n𝑄\n¬𝑃\n¬𝑃∨𝑄\nT\nT\nF\nT\nT\nF\nF\nF\nF\nT\nT\nT\nF\nF\nT\nT\nWe added a column for ¬𝑃to make filling out the last column easier.",
    "The\nentries in the ¬𝑃column were determined by the entries in the 𝑃column.\n",
    "Then to fill in the final column, look only at the column for 𝑄and the column\nfor ¬𝑃and use the rule for ∨.\n",
    "Now let’s answer our question about Monopoly.\n",
    "Example 1.3.3\nAnalyze the statement, “If you get more doubles than any other player, then\nyou will lose, or if you lose, then you must have bought the most properties,”\nusing truth tables.\n",
    "Solution.\n",
    "Represent the statement in symbols as (𝑃→𝑄)∨(𝑄→𝑅), where\n𝑃is the statement, “You get more doubles than any other player,” 𝑄is the\nstatement, “You will lose,” and 𝑅is the statement, “You must have bought\nthe most properties.”",
    "Now make a truth table.\n",
    "The truth table must contain 8 rows to account for every possible combi-\nnation of truth and falsity among the three statements.",
    "Here is the full truth\ntable:\n𝑃\n𝑄\n𝑅\n𝑃→𝑄\n𝑄→𝑅\n(𝑃→𝑄) ∨(𝑄→𝑅)\nT\nT\nT\nT\nT\nT\nT\nT\nF\nT\nF\nT\nT\nF\nT\nF\nT\nT\nT\nF\nF\nF\nT\nT\nF\nT\nT\nT\nT\nT\nF\nT\nF\nT\nF\nT\nF\nF\nT\nT\nT\nT\nF\nF\nF\nT\nT\nT\nThe first three columns are simply a systematic listing of all possible combi-\nnations of T and F for the three statements (do you see how you would list\nthe 16 possible combinations for four statements?).",
    "The next two columns\n\n48\n1. Logic and Proofs\nare determined by the values of 𝑃, 𝑄, and 𝑅and the definition of implication.\n",
    "Then, the last column is determined by the values in the previous two columns\nand the definition of ∨. It is this final column we care about.\n",
    "Notice that in each of the eight possible cases, the statement in question\nis true.",
    "So our statement about monopoly is true (regardless of how many\nproperties you own, how many doubles you roll, or whether you win or lose).\n",
    "The statement about monopoly is an example of a tautology, a statement that is\nnecessarily true based on its logical form alone.",
    "Tautologies are always true, but they\ndon’t tell us much about the world.",
    "No knowledge about monopoly was required\nto determine that the statement was true, and thus knowing that the statement is\ntrue tells us nothing about monopoly.",
    "It is equally true that “if the moon is made of\ncheese, then Elvis is still alive, or if Elvis is still alive, then unicorns have 5 legs.”\n1.3.3\nLogical Equivalence\nYou might have noticed in Example 1.3.2 that the final column in the truth table for\n¬𝑃∨𝑄is identical to the final column in the truth table for 𝑃→𝑄:\n𝑃\n𝑄\n𝑃→𝑄\n¬𝑃∨𝑄\nT\nT\nT\nT\nT\nF\nF\nF\nF\nT\nT\nT\nF\nF\nT\nT\n",
    "This says that no matter what 𝑃and 𝑄are, the statements ¬𝑃∨𝑄and 𝑃→𝑄\nare either both true or both false.",
    "We therefore say these statements are logically\nequivalent.\n",
    "Definition 1.3.4 Logical Equivalence.\n",
    "Two (molecular) statements 𝑃and 𝑄are logically equivalent provided 𝑃is\ntrue precisely when 𝑄is true.",
    "That is, 𝑃and 𝑄have the same truth value\nunder any assignment of truth values to their atomic parts.\n",
    "We write this as 𝑃≡𝑄.\nTo verify that two statements are logically equivalent, you can make a truth table\nfor each and check whether the columns for the two statements are identical.\n",
    "In Section 1.2 we claimed that whenever an implication is true, so is its contra-\npositive.",
    "We can now make this claim as the following theorem.\n",
    "Theorem 1.3.5\nAn implication is logically equivalent to its contrapositive.",
    "That is,\n𝑃→𝑄≡¬𝑄→¬𝑃.\n\n1.3.",
    "Rules of Logic\n49\nProof.",
    "We simply examine the truth tables.\n",
    "𝑃\n𝑄\n𝑃→𝑄\nT\nT\nT\nT\nF\nF\nF\nT\nT\nF\nF\nT\n𝑃\n𝑄\n¬𝑄\n¬𝑃\n¬𝑄→¬𝑃\nT\nT\nF\nF\nT\nT\nF\nT\nF\nF\nF\nT\nF\nT\nT\nF\nF\nT\nT\nT\n(Note that we have the truth value combinations in the same order in both\ntables, so we can easily see that the final columns are identical.)\n",
    "Recognizing two statements as logically equivalent can be quite helpful.",
    "Rephras-\ning a mathematical statement can often lend insight into what it is saying, or how\nto prove or refute it.",
    "By using truth tables we can systematically verify that two\nstatements are indeed logically equivalent.\n",
    "Example 1.3.6\nAre the statements, “It will not rain or snow,” and, “It will not rain and it will\nnot snow,” logically equivalent?\nSolution.\n",
    "We want to know whether ¬(𝑃∨𝑄) is logically equivalent to\n¬𝑃∧¬𝑄. Make a truth table which includes both statements:\n𝑃\n𝑄\n¬(𝑃∨𝑄)\n",
    "¬𝑃∧¬𝑄\nT\nT\nF\nF\nT\nF\nF\nF\nF\nT\nF\nF\nF\nF\nT\nT\nSince the truth values for the two statements are equal in every row, the two\nstatements are logically equivalent.\n",
    "Notice that this example gives us a way to “distribute” a negation over a\ndisjunction (an “or”).",
    "We have a similar rule for distributing over conjunctions\n(“and”s):\nTheorem 1.3.7 De Morgan’s Laws.\n",
    "The negation of a disjunction or conjunction is logically equivalent to a conjunction\nor disjunction of negations, respectively.",
    "That is,\n¬(𝑃∧𝑄) ≡¬𝑃∨¬𝑄\nand,\n¬(𝑃∨𝑄) ≡¬𝑃∧¬𝑄.\n",
    "This suggests there might be a sort of “algebra” you could apply to statements\n\n50\n1.",
    "Logic and Proofs\n(okay, there is: It is called Boolean algebra) to transform one statement into another.\n",
    "We can start collecting useful examples of logical equivalence and apply them in\nsuccession to a statement, instead of writing out a complicated truth table.\n",
    "De Morgan’s laws do not directly help us with implications, but as we saw above,\nevery implication can be written as a disjunction:\nImplications are Disjunctions.\n",
    "𝑃→𝑄≡¬𝑃∨𝑄.\nExample: “If a number is a multiple of 4, then it is even” is equivalent to,\n“A number is not a multiple of 4, or (else) it is even.”\n",
    "With this and De Morgan’s laws, you can take any statement and simplify it to the\npoint where negations are only being applied to atomic propositions.",
    "Well, except\nthat you could get multiple negations stacked up.",
    "But this can be easily dealt with:\nDouble Negation.\n",
    "¬¬𝑃≡𝑃.\nExample: “It is not the case that 𝑐is not odd” means “𝑐is odd.”\nLet’s see how we can apply the equivalences we have encountered.\n",
    "Example 1.3.8\nProve that the statements ¬(𝑃→𝑄) and 𝑃∧¬𝑄are logically equivalent\nwithout using truth tables.\n",
    "Solution.\n",
    "We want to start with one of the statements and transform it into\nthe other through a sequence of logically equivalent statements.",
    "Start with\n¬(𝑃→𝑄).",
    "We can rewrite the implication as a disjunction, so this is logically\nequivalent to\n¬(¬𝑃∨𝑄).\n",
    "Now apply De Morgan’s law to get\n¬¬𝑃∧¬𝑄.\nFinally, use double negation to arrive at 𝑃∧¬𝑄\nNotice that the above example illustrates that the negation of an implication is\nNOT an implication: It is a conjunction!",
    "We saw this before, in Section 1.1, but it is\nso important and useful, it warrants stating as a theorem.\n\n",
    "1.3.",
    "Rules of Logic\n51\nTheorem 1.3.9 Negation of an Implication.\n",
    "The negation of an implication is a conjunction:\n¬(𝑃→𝑄)",
    "≡𝑃∧¬𝑄.\n",
    "That is, the only way for an implication to be false is for the hypothesis to be true\nAND the conclusion to be false.\n",
    "To verify that two statements are logically equivalent, you can use truth tables or\na sequence of logically equivalent replacements.",
    "The truth table method, although\ncumbersome, has the advantage that it can verify that two statements are NOT\nlogically equivalent.\n",
    "Example 1.3.10\nAre the statements (𝑃∨𝑄) →𝑅and (𝑃→𝑅)∨(𝑄→𝑅) logically equivalent?\nSolution.\n",
    "Note that while we could start rewriting these statements with\nlogically equivalent replacements in the hopes of transforming one into\nanother, we will never be sure that our failure is due to their lack of logical\nequivalence rather than our lack of imagination.",
    "So instead, let’s make a truth\ntable:\n𝑃\n𝑄\n𝑅\n(𝑃∨𝑄) →𝑅\n(𝑃→𝑅) ∨(𝑄→𝑅)\nT\nT\nT\nT\nT\nT\nT\nF\nF\nF\nT\nF\nT\nT\nT\nT\nF\nF\nF\nT\nF\nT\nT\nT\nT\nF\nT\nF\nF\nT\nF\nF\nT\nT\nT\nF\nF\nF\nT\nT\nLook at the fourth (or sixth) row.",
    "In this case, (𝑃→𝑅) ∨(𝑄→𝑅) is true, but\n(𝑃∨𝑄) →𝑅is false.",
    "Therefore the statements are not logically equivalent.\n",
    "While we don’t have logical equivalence, it is the case that whenever\n(𝑃∨𝑄) →𝑅is true, so is (𝑃→𝑅) ∨(𝑄→𝑅).",
    "This tells us that we can deduce\n(𝑃→𝑅) ∨(𝑄→𝑅) from (𝑃∨𝑄) →𝑅, just not the reverse direction.\n",
    "1.3.4\nEquivalence for Quantified Statements\nAll the examples we have looked at so far have only involved propositional logic,\nwhere the basic units of logic are statements that are either true or false.",
    "It is also\npossible to say that two statements involving quantifiers and predicates are logically\nequivalent.\n\n",
    "52\n1.",
    "Logic and Proofs\nSometimes the quantifiers have nothing to do with the equivalence.",
    "For example,\n∀𝑥(𝑃(𝑥) →𝑄(𝑥)) ≡∀𝑥(¬𝑃(𝑥) ∨𝑄(𝑥)).\n",
    "As soon as we replace the 𝑥with a constant, we are left with two statements that are\nlogically equivalent based on their propositional form.\n",
    "Other times, the more interesting times, it is exactly the logic of the quantifiers\nthat makes the statements logically equivalent.",
    "What is especially interesting here is\nthat we cannot use truth tables to verify these equivalences!\n",
    "Instead, we need to reason about the domain of discourse as a set.",
    "For example,\nlet’s consider how negation interacts with quantifiers.\n",
    "Consider the claim that “all odd numbers are prime.”",
    "We might represent this\nsymbolically as ∀𝑥(𝑂(𝑥) →𝑃(𝑥)).",
    "The statement clearly is not true, so what is true\nis that “not all odd numbers are prime” (i.e., ¬∀𝑥(𝑂(𝑥) →𝑃(𝑥))).",
    "How do we know?\n",
    "Easy: 9.",
    "Yes, 9 is odd but not prime.",
    "But is it enough that just one odd number isn’t\nprime?\nTo dispute a universal claim, you just need one single counterexample.",
    "You just\nneed to show there exists a number for which the claim is false.",
    "In our case, we have\nthe equivalence,\n¬∀𝑥(𝑂(𝑥) →𝑃(𝑥)) ≡∃𝑥(𝑂(𝑥) ∧¬𝑃(𝑥)).\n",
    "If we ignore the quantifiers for a minute, we are left with\n¬(𝑂→𝑃) ≡𝑂∧¬𝑃\nwhich is exactly an example of Theorem 1.3.9.",
    "The new, interesting part is that when\nwe negated the universal quantifier, we got an existential quantifier.\n",
    "Negating an existential quantifier results in a universal quantifier.",
    "This makes\nsense.",
    "If there does not exist something with a property, then everything does not\nhave that property.\n",
    "Quantifiers and Negation.\n¬∀𝑥𝑃(𝑥) is equivalent to ∃𝑥¬𝑃(𝑥).\n",
    "¬∃𝑥𝑃(𝑥) is equivalent to ∀𝑥¬𝑃(𝑥).\n",
    "Symbolically, we can pass the negation symbol over a quantifier, but that causes\nthe quantifier to switch type.\n",
    "Another way to see why this makes sense: Universal quantifiers are like (possibly\ninfinite) conjunctions since they claim that the property is true of this thing, and\nthat thing, and the other thing,... all things.",
    "Existential quantifiers are like (possibly\ninfinite) disjunctions: The property is true of at least one thing, maybe this, or that,\nor the other, or....",
    "De Morgan’s laws tell us that when we negate a conjunction, we\nget a disjunction, and when we negate a disjunction, we get a conjunction.",
    "Isn’t it\ngreat when everything works out as it should?\n\n1.3.",
    "Rules of Logic\n53\nExample 1.3.11\nSuppose we claim that there is no smallest number.",
    "We can translate this into\nsymbols as\n¬∃𝑥∀𝑦(𝑥≤𝑦).\n",
    "(“It is not true that there is a number 𝑥such that for all numbers 𝑦, 𝑥is less\nthan or equal to 𝑦.”)\n",
    "However, we know how negation interacts with quantifiers: We can pass a\nnegation over a quantifier by switching the quantifier type (between universal\nand existential).",
    "So the statement above should be logically equivalent to\n∀𝑥∃𝑦(𝑦< 𝑥).\n",
    "Notice that 𝑦< 𝑥is the negation of 𝑥≤𝑦. This reads, “For every number 𝑥\nthere is a number 𝑦which is smaller than 𝑥.”",
    "We see that this is another way\nto make our original claim.\n",
    "It is important to stress that predicate logic extends propositional logic (much\nlike how quantum mechanics extends classical mechanics).",
    "Everything that we\nlearned about logical equivalence and deductions still applies.",
    "However, predicate\nlogic allows us to analyze statements at a higher resolution, digging down into the\nindividual propositions 𝑃, 𝑄, etc.\nTo do this, we need to understand how quantifiers and connectives interact.",
    "We\nhave already seen something about negations and quantifiers.",
    "What about the other\nconnectives?",
    "Let’s look at an example exploring how the universal quantifier and\ndisjunctions can (or cannot) work together.\n",
    "Example 1.3.12\nConsider the two statements,\n∀𝑥(𝑃(𝑥) ∨𝑄(𝑥))\n∀𝑥𝑃(𝑥) ∨∀𝑥𝑄(𝑥).\n",
    "Are these logically equivalent?\nSolution.\n",
    "These statements are NOT logically equivalent.",
    "Intuitively, the\nstatement on the left claims that everything is either a 𝑃-thing or a 𝑄-thing.\n",
    "The statement on the right claims that either everything is a 𝑃-thing or that\neverything is a 𝑄-thing.",
    "These feel different.\n",
    "To be sure, we would like to think of predicates 𝑃(𝑥) and 𝑄(𝑥) and some\ndomain of discourse such that one of the statements is true and the other is\nfalse.",
    "How about we let 𝑃(𝑥) be, “𝑥is even” and 𝑄(𝑥) be, “𝑥is odd.”",
    "Our\ndomain of discourse will be all integers (as that is the set of numbers for\nwhich even and odd make sense).\n",
    "The statement on the left is true!",
    "Every number is either even or odd.",
    "But\n\n54\n1.",
    "Logic and Proofs\nis every number even?",
    "No.",
    "Is every number odd?",
    "No.",
    "So the statement on\nthe right is false (it is a false or false).\n",
    "Interestingly, the statement on the right implies the statement on the left.\n",
    "That is,\n(∀𝑥𝑃(𝑥) ∨∀𝑥𝐸(𝑥))",
    "→∀𝑥(𝑃(𝑥) ∨𝑄(𝑥))\nis always true.\n",
    "This is similar to a tautology, although we reserve that term for necessary\ntruths in propositional logic.",
    "A statement in predicate logic that is necessarily\ntrue gets the more prestigious designation of a law of logic (or sometimes\nlogically valid, but that is less fun).\n",
    "We can also consider how quantifiers interact with each other.\n",
    "Example 1.3.13\nCan you switch the order of quantifiers?",
    "For example, consider the two\nstatements:\n∀𝑥∃𝑦𝑃(𝑥, 𝑦)\nand\n∃𝑦∀𝑥𝑃(𝑥, 𝑦).\n",
    "Are these logically equivalent?\nSolution.\n",
    "These statements are NOT logically equivalent.",
    "To see this, we\nshould provide an interpretation of the predicate 𝑃(𝑥, 𝑦) which makes one of\nthe statements true and the other false.\n",
    "Let 𝑃(𝑥, 𝑦) be the predicate 𝑥< 𝑦.",
    "It is true, in the natural numbers, that\nfor all 𝑥there is some 𝑦greater than that 𝑥(since there are infinitely many\nnumbers).",
    "However, there is no natural number 𝑦which is greater than every\nnumber 𝑥.",
    "Thus it is possible for ∀𝑥∃𝑦𝑃(𝑥, 𝑦) to be true while ∃𝑦∀𝑥𝑃(𝑥, 𝑦) is\nfalse.\n",
    "We cannot do the reverse of this though.",
    "If there is some 𝑦for which every\n𝑥satisfies 𝑃(𝑥, 𝑦), then certainly for every 𝑥there is some 𝑦which satisfies\n𝑃(𝑥, 𝑦).",
    "The first is saying we can find one 𝑦that works for every 𝑥.",
    "The\nsecond allows different 𝑦’s to work for different 𝑥’s, but nothing is preventing\nus from using the same 𝑦that works for every 𝑥. In other words, while we\ndon’t have logical equivalence between the two statements, we do have a valid\ndeduction rule:\n∃𝑦∀𝑥𝑃(𝑥, 𝑦)\n∴\n∀𝑥∃𝑦𝑃(𝑥, 𝑦)\nPut yet another way, this says that the single statement\n∃𝑦∀𝑥𝑃(𝑥, 𝑦) →∀𝑥∃𝑦𝑃(𝑥, 𝑦)\nis always true; it is a law of logic.\n\n",
    "1.3.",
    "Rules of Logic\n55\n1.3.5\nDeductions\nEarlier, we claimed that the following was a valid argument:\nIf Edith eats her vegetables, then she can have a cookie.",
    "Edith ate her\nvegetables.",
    "Therefore Edith gets a cookie.\n",
    "How do we know this is valid?",
    "Let’s look at the form of the statements.",
    "Let 𝑃denote,\n“Edith eats her vegetables” and 𝑄denote, “Edith can have a cookie.”",
    "The logical\nform of the argument is then:\n𝑃→𝑄\n𝑃\n∴\n𝑄\n",
    "This is an example of a deduction rule, an argument form that is always valid.",
    "This\none is a particularly famous rule called modus ponens.",
    "Are you convinced that it is a\nvalid deduction rule?",
    "If not, consider the following truth table:\n𝑃\n𝑄\n𝑃→𝑄\nT\nT\nT\nT\nF\nF\nF\nT\nT\nF\nF\nT\n",
    "This is just the truth table for 𝑃→𝑄, but what matters here is that all the lines in\nthe deduction rule have their own column in the truth table.",
    "Remember that an\nargument is valid provided the conclusion must be true given that the premises are\ntrue.",
    "The premises in this case are 𝑃→𝑄and 𝑃. Which rows of the truth table\ncorrespond to both of these being true?",
    "𝑃is true in the first two rows, and of those,\nonly the first row has 𝑃→𝑄true as well.",
    "And lo-and-behold, in this one case, 𝑄is\nalso true.",
    "So if 𝑃→𝑄and 𝑃are both true, we see that 𝑄must be true as well.\n",
    "Think of deduction rules as a sort of one-way form of logical equivalence.",
    "Two\nstatements are logically equivalent provided that in every row of the truth table in\nwhich the first statement is true, so is the second, and in every row in which the\nsecond statement is true, so is the first.",
    "A deduction only requires the first of these\ntwo parts.\n",
    "Here are a few more examples.\n",
    "Example 1.3.14\nShow that the following is a valid deduction rule.\n",
    "𝑃→𝑄\n¬𝑃→𝑄\n∴\n𝑄\nSolution.\n",
    "We make a truth table which contains all the lines of the argument\n\n56\n1.",
    "Logic and Proofs\nform:\n𝑃\n𝑄\n𝑃→𝑄\n¬𝑃\n¬𝑃→𝑄\nT\nT\nT\nF\nT\nT\nF\nF\nF\nT\nF\nT\nT\nT\nT\nF\nF\nT\nT\nF\n(we include a column for ¬𝑃just as a helping step to get the column for\n¬𝑃→𝑄).\n",
    "Now look at all the rows for which both 𝑃→𝑄and ¬𝑃→𝑄are true.\n",
    "This happens only in rows 1 and 3.",
    "Hey!",
    "In those rows 𝑄is true as well, so\nthe argument form is valid (it is a valid deduction rule).\n",
    "Example 1.3.15\nDecide whether the following is a valid deduction rule.\n",
    "𝑃→𝑅\n𝑄→𝑅\n𝑅\n∴\n𝑃∨𝑄\nSolution.\n",
    "Let’s make a truth table containing all four statements.\n",
    "𝑃\n𝑄\n𝑅\n𝑃→𝑅\n𝑄→𝑅\n𝑃∨𝑄\nT\nT\nT\nT\nT\nT\nT\nT\nF\nF\nF\nT\nT\nF\nT\nT\nT\nT\nT\nF\nF\nF\nT\nT\nF\nT\nT\nT\nT\nT\nF\nT\nF\nT\nF\nT\nF\nF\nT\nT\nT\nF\nF\nF\nF\nT\nT\nF\nLook at the second-to-last row.",
    "Here all three premises of the argument are\ntrue, but the conclusion is false.",
    "Thus this is not a valid deduction rule.\n",
    "While we have the truth table in front of us, look at rows 1, 3, and 5.",
    "These\nare the only rows in which all of the statements 𝑃→𝑅, 𝑄→𝑅, and 𝑃∨𝑄\nare true.",
    "It also happens that 𝑅is true in these rows as well.",
    "Thus we have\ndiscovered a new deduction rule we know is valid:\n𝑃→𝑅\n𝑄→𝑅\n𝑃∨𝑄\n∴\n𝑅\n\n1.3.",
    "Rules of Logic\n57\nQuantifier deductions.\n",
    "There are also deduction rules we could write down for\nquantifiers.",
    "For example:\n∀𝑥𝑃(𝑥)\n",
    "∴\n∃𝑥𝑃(𝑥)\n",
    "If everything is a 𝑃-thing, then there must be something which is a 𝑃-thing.",
    "These\nrules cannot be verified with a truth table, and a full treatment of this sort of predicate\nlogic is beyond the scope of this text.\n",
    "1.3.6\nReading Questions\n1.\nTo check whether two statements are logically equivalent, you can use a truth\ntable.",
    "Explain what you would look for in the truth table to conclude that\nthe two statements are logically equivalent.",
    "What would tell you they are not\nlogically equivalent?\n2.\nTo check whether a deduction rule is valid, you can use a truth table.",
    "Explain\nwhat you would look for in the completed truth table to say that the deduction\nrule is valid, and what would tell you the deduction rule is not valid.\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "1.3.7\nPractice Problems\n1.\nMake a truth table for the statement (𝑃∧𝑄) →(𝑃∨𝑄).\n",
    "2.\nComplete a truth table for the statement ¬𝑄∨(𝑄→𝑃)).",
    "What can you\nconclude about 𝑃and 𝑄if you knew the statement above was false?\n",
    "3.\nConstruct a truth table for the statement 𝑄→(¬𝑃∨𝑅).\n",
    "4.\nDetermine whether the statements 𝑃→(𝑄∨𝑅) and (𝑃→𝑄) ∨(𝑃→𝑅) are\nlogically equivalent by completing a truth table for both statements.\n",
    "5.\nDetermine if the following is a valid deduction rule:\n𝑃→𝑄\n¬𝑄\n∴\n¬𝑃\n6.\n",
    "Determine if the following is a valid deduction rule:\n𝑃→(𝑄∨𝑅)\n¬(𝑃→𝑄)\n",
    "∴\n𝑅\n7.\nDetermine if the following is a valid deduction rule:\n\n58\n1.",
    "Logic and Proofs\n(𝑃∧𝑄) →𝑅\n¬𝑃∨¬𝑄\n∴\n¬𝑅\n8.\n",
    "Determine if the following is a valid deduction rule:\n𝑃→𝑄\n𝑃∧¬𝑄\n∴\n𝑅\n9.\n",
    "Which of the following statements is a law of logic?",
    "That is, which of the\nfollowing are true no matter what your domain of discourse is and no matter\nwhat you interpret the predicates as meaning?",
    "Select all that apply.\n",
    "A. ∀𝑥(𝑃(𝑥) ∨¬𝑃(𝑥)).\n",
    "B. ∃𝑥𝑃(𝑥) →∀𝑥𝑃(𝑥).\n",
    "C. ¬∀𝑥𝑃(𝑥) →∃𝑥𝑃(𝑥).\n",
    "D. ∀𝑥∃𝑦𝑃(𝑥, 𝑦) ↔∃𝑦∀𝑥𝑃(𝑥, 𝑦).\n",
    "1.3.8\nAdditional Exercises\n1.\n",
    "You stumble upon two trolls playing Stratego®.",
    "They tell you:\nTroll 1: If we are cousins, then we are both knaves.\n",
    "Troll 2: We are cousins, or we are both knaves.\n",
    "Could both trolls be knights?",
    "Recall that all trolls are either always-truth-telling\nknights or always-lying knaves.",
    "Explain your answer and how you can use\ntruth tables to find it.\n",
    "2.\n",
    "Next you come upon three trolls, helpfully wearing name tags.",
    "They say:\nPat\nIf either Quinn or I are knights, then so is Ryan.\n",
    "Quinn\nRyan is a knight, and if Pat is a knight, then so am I.\nRyan\nQuinn is a knave, but Pat and I share the same persuasion.\n",
    "Create a truth table that includes all three statements.",
    "Then use the truth\ntable to determine the persuasion of each troll.\n",
    "3.\nConsider the statement about a party, “If it’s your birthday or there will be\ncake, then there will be cake.”\n(a) Translate the above statement into symbols.",
    "Clearly state which statement\nis 𝑃and which is 𝑄.\n(b) Make a truth table for the statement.\n\n1.3.",
    "Rules of Logic\n59\n(c) Assuming the statement is true, what (if anything) can you conclude if\nyou know there will be cake?\n(d)",
    "Assuming the statement is true, what (if anything) can you conclude if\nyou know there will not be cake?\n(e) Suppose you found out that the statement was a lie.",
    "What can you\nconclude?\n4.\nGeoff Poshingten is out at a fancy pizza joint and decides to order a calzone.\n",
    "When the waiter asks what he would like in it, he replies, “I want either\npepperoni or sausage.",
    "Also, if I have sausage, then I must also include quail.\n",
    "Oh, and if I have pepperoni or quail, then I must also have ricotta cheese.”\n(a) Translate Geoff’s order into logical symbols.\n",
    "(b) The waiter knows that Geoff is either a liar or a truth-teller (so either\neverything he says is false, or everything is true).",
    "Which is it?\n(c) What, if anything, can the waiter conclude about the ingredients in\nGeoff’s desired calzone?\n5.\nDetermine whether the following two statements are logically equivalent:\n¬(𝑃→𝑄) and",
    "𝑃∧¬𝑄. Explain how you know you are correct.\n",
    "6.\nSimplify the following statements (so that negation only appears right before\nvariables).\n",
    "(a) ¬(𝑃→¬𝑄).\n",
    "(b) (¬𝑃∨¬𝑄) →¬(¬𝑄∧𝑅).\n",
    "(c) ¬((𝑃→¬𝑄) ∨¬(𝑅∧¬𝑅)).\n",
    "(d)",
    "It is false that if Sam is not a man then Chris is a woman, and that Chris\nis not a woman.\n",
    "7.\nUse De Morgan’s Laws and any other logical equivalence facts you know to\nsimplify the following statements.",
    "Show all your steps.",
    "Your final statements\nshould have negations only appear directly next to the sentence variables or\npredicates (𝑃, 𝑄, 𝐸(𝑥), etc.), and no double negations.",
    "It would be a good idea\nto use only conjunctions, disjunctions, and negations.\n",
    "(a) ¬((¬𝑃∧𝑄) ∨¬(𝑅∨¬𝑆)).\n",
    "(b) ¬((¬𝑃→¬𝑄) ∧(¬𝑄→𝑅))",
    "(careful with the implications).\n",
    "(c) For both parts above, verify your answers are correct using truth tables.\n",
    "That is, use a truth table to check that the given statement and your\nproposed simplification are actually logically equivalent.\n",
    "8.\nConsider the statement, “If a number is triangular or square, then it is not\nprime”\n\n60\n1.",
    "Logic and Proofs\n(a) Make a truth table for the statement (𝑇∨𝑆)",
    "→¬𝑃.\n(b) If you believed the statement was false, what properties would a coun-\nterexample need to possess?",
    "Explain by referencing your truth table.\n",
    "(c) If the statement were true, what could you conclude about the number\n5657, which is definitely prime?",
    "Again, explain using the truth table.\n",
    "9.\nTommy Flanagan was telling you what he ate yesterday afternoon.",
    "He tells\nyou, “I had either popcorn or raisins.",
    "Also, if I had cucumber sandwiches, then\nI had soda.",
    "But I didn’t drink soda or tea.”",
    "Of course, you know that Tommy is\nthe world’s worst liar, and everything he says is false.",
    "What did Tommy eat?\nJustify your answer by writing all of Tommy’s statements using sentence\nvariables (𝑃, 𝑄, 𝑅, 𝑆, 𝑇), taking their negations, and using these to deduce what\nTommy actually ate.\n10.\n",
    "Can you chain implications together?",
    "That is, if 𝑃→𝑄and 𝑄→𝑅, does that\nmeans the 𝑃→𝑅?",
    "Prove that the following is a valid deduction rule:\n𝑃→𝑄\n𝑄→𝑅\n∴\n𝑃→𝑅\n11.\nSuppose 𝑃and 𝑄are (possibly molecular) propositional statements.",
    "Prove\nthat 𝑃and 𝑄are logically equivalent if and only if 𝑃↔𝑄is a tautology.\n12.\nSuppose 𝑃1, 𝑃2, . . .",
    ", 𝑃𝑛and 𝑄are (possibly molecular) propositional statements.\nSuppose further that\n𝑃1\n𝑃2\n...\n",
    "𝑃𝑛\n∴\n𝑄\nis a valid deduction rule.",
    "Prove that the statement\n(𝑃1 ∧𝑃2 ∧· · · ∧𝑃𝑛) →𝑄\nis a tautology.\n",
    "13.\nConsider the statements below.",
    "Translate each into symbols, using the predicate\n𝐹(𝑥, 𝑦) for “person 𝑥can be fooled at time 𝑦.” Decide whether any of the\nstatements are equivalent to each other, or whether any imply any others, in\nthis context or in general.\n",
    "(a) You can fool some people all of the time.\n",
    "(b) You can fool everyone some of the time.\n",
    "(c) You can always fool some people.\n\n1.3.",
    "Rules of Logic\n61\n(d)",
    "Sometimes you can fool everyone.\n",
    "14.\nSuppose 𝑃(𝑥) is some predicate for which the statement ∀𝑥𝑃(𝑥) is true.",
    "Is it also\nthe case that ∃𝑥𝑃(𝑥) is true?",
    "In other words, is the statement ∀𝑥𝑃(𝑥) →∃𝑥𝑃(𝑥)\nalways true?",
    "Is the converse always true?",
    "Assume the domain of discourse is\nnon-empty.\n",
    "15.\n",
    "Simplifying negations will be especially useful when we try to prove a statement\nby considering what would happen if it were false.",
    "For each statement below,\nwrite the negation of the statement as simply as possible.",
    "Don’t just say, “It is\nfalse that . . .",
    "”\n(a) Every number is either even or odd.\n",
    "(b) There is a sequence that is both arithmetic and geometric.\n",
    "(c) For all numbers 𝑛, if 𝑛is prime, then 𝑛+ 3 is not prime.\n",
    "16.\n",
    "We can simplify statements in predicate logic using our rules for passing\nnegations over quantifiers before applying logical equivalence to the “inside”\npropositional part.",
    "Simplify the statements below (so negation appears only\ndirectly next to predicates).\n",
    "(a) ¬∃𝑥∀𝑦(¬𝑂(𝑥) ∨𝐸(𝑦)).\n",
    "(b) ¬∀𝑥¬∀𝑦¬(𝑥< 𝑦∧∃𝑧(𝑥< 𝑧∨𝑦< 𝑧)).\n",
    "(c) There is a number 𝑛for which no other number is less than or equal to 𝑛.\n(d)",
    "It is false that for every number 𝑛there are two other numbers which 𝑛\nis between.\n17.\nSimplify the statements below to the point that negation symbols occur only\ndirectly next to predicates.\n",
    "(a) ¬∀𝑥∀𝑦(𝑥< 𝑦∨𝑦< 𝑥).\n",
    "(b) ¬(∃𝑥𝑃(𝑥) →∀𝑦𝑃(𝑦)).\n\n",
    "1.4\nProofs\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "• Identify the logical structure of, and distinguish between, direct proofs,\na proof by contrapositives, and a proof by contradictions.\n",
    "• Identify flaws in an incorrect proof and determine whether they are\nflaws in logic or mathematical concepts.\n",
    "•",
    "Apply definitions to prove statements using basic proof styles.\n",
    "1.4.1\nSection Preview\nInvestigate!\n",
    "A mini sudoku puzzle is a 4 × 4 grid of squares, divided into four 2 × 2\nboxes.",
    "The goal is to fill each square with a digit from 1 to 4, such that no\ndigit repeats in any row, any column, or any box.\n",
    "Here is a simple mini sudoku puzzle you can try to solve.\n2\n1\n4\n3\nYou might notice that the solution to the above puzzle has its four outside\ncorners all different, and its four middle squares all different.\n",
    "The goal of this Investigate!\nquestion is to prove that this is not a\ncoincidence: Suppose a mini sudoku puzzle has all different numbers in\nits four corners (marked with # below).",
    "Prove that the center four squares\n(marked with ‗ below) must also contain different numbers.\n#\n#\n*\n*\n*\n*\n#\n#\n62\n\n1.4.",
    "Proofs\n63\nTry it 1.4.1\nTry placing numbers into an empty mini sudoku puzzle.",
    "See if you can break\nthe statement we were asked to prove in the Investigate!",
    "activity.",
    "What stops\nyou?",
    "Briefly explain whether you think the statement is true or false, and\nwhy.\n",
    "Anyone who doesn’t believe there is creativity in mathematics clearly has not\ntried to write proofs.",
    "Finding a way to convince the world that a particular statement\nis necessarily true is a mighty undertaking and can often be quite challenging.",
    "There\nis no guaranteed path to success in the search for proofs.",
    "For example, in the summer\nof 1742, a German mathematician by the name of Christian Goldbach wondered\nwhether every even integer greater than 2 could be written as the sum of two primes.\n",
    "Centuries later, we still don’t have a proof of this apparent fact (computers have\nchecked that Goldbach’s conjecture holds for all numbers less than 4 × 1018, but no\nproof that the statement holds for all numbers has been found).\n",
    "Writing proofs is a bit of an art.",
    "Like any art, to be truly great at it, you need\nsome sort of inspiration, as well as some foundational technique.",
    "Just as musicians\ncan learn proper fingering, and painters can learn the proper way to hold a brush,\nwe can look at the proper way to construct arguments.\n",
    "We can view a proof through two distinct but intersecting lenses.",
    "First, we can\nthink about the logical structure of a proof.",
    "Below we will consider three styles\nof proof that vary precisely in their logical structure.",
    "Second, we can look at the\nmathematical content of the proof.",
    "How does the proof illustrate understanding of\nmathematical concepts?",
    "Does it use definitions of mathematical objects correctly?\n",
    "How do the definitions interact with each other?\n",
    "Recall that in Section 1.3 we said that a tautology is a necessarily true statement,\nbut that it doesn’t tell us anything interesting.",
    "Similarly, if a proof relied entirely\non the logical form of the statement it was proving, it wouldn’t tell us anything\ninteresting about mathematics.",
    "Thus all the proofs we consider must involve some\ncombining of mathematical concepts in addition to their logical structure.\n",
    "In this section, we will see examples of how the interaction between logical\nand mathematical structure plays out.",
    "We will think of the logical structure as the\nskeleton or scaffolding of the proof and look at the different shapes this skeleton can\ntake.",
    "We will then see how the mathematical content of the proof fills in the details\nof the skeleton, how it adds meat to the bones.\n",
    "It is often challenging to be careful about proofs when the statements we try to\nprove seem too obvious or familiar.",
    "While we will definitely want to prove simple\nfacts about numbers, like that the sum of two even numbers is even, our familiarity\nwith numbers can make it difficult to take this task seriously.",
    "So instead, we will start\nby proving some facts in what is hopefully a novel setting: mini sudoku puzzles.\n",
    "Preview Activity\nConsider the statement:\n\n64\n1.",
    "Logic and Proofs\nIf 𝑎𝑏is an even number, then 𝑎or 𝑏is even.\n",
    "Which of the proofs below appear to be valid proofs of this statement?",
    "Note: You\ncan assume all the algebra below is correct (because it is).\n",
    "1.\nSuppose 𝑎and 𝑏are odd.",
    "That is, 𝑎= 2𝑘+ 1 and 𝑏= 2𝑚+ 1 for some integers\n𝑘and 𝑚.",
    "Then\n𝑎𝑏= (2𝑘+ 1)(2𝑚+ 1)\n= 4𝑘𝑚+ 2𝑘+",
    "2𝑚+ 1\n= 2(2𝑘𝑚+ 𝑘+ 𝑚)",
    "+",
    "1.\nTherefore 𝑎𝑏is odd.\n",
    "2.\nAssume that 𝑎or 𝑏is even -- say it is 𝑎(the case where 𝑏is even will be\nidentical).",
    "That is, 𝑎= 2𝑘for some integer 𝑘.",
    "Then\n𝑎𝑏= (2𝑘)𝑏\n= 2(𝑘𝑏).\n",
    "Thus 𝑎𝑏is even.\n",
    "3.\nSuppose that 𝑎𝑏is even but 𝑎and 𝑏are both odd.",
    "Namely, 𝑎𝑏= 2𝑛, 𝑎= 2𝑘+ 1\nand 𝑏= 2𝑗+ 1 for some integers 𝑛, 𝑘, and 𝑗. Then\n2𝑛= (2𝑘+ 1)(2𝑗+ 1)\n2𝑛= 4𝑘𝑗+ 2𝑘+ 2𝑗+ 1\n𝑛= 2𝑘𝑗+ 𝑘+ 𝑗+ 1\n2.\n",
    "But since 2𝑘𝑗+ 𝑘+ 𝑗is an integer, this says that the integer 𝑛is equal to a\nnon-integer, which is impossible.\n",
    "4.\nLet 𝑎𝑏be an even number, say 𝑎𝑏= 2𝑛, and 𝑎be an odd number, say 𝑎= 2𝑘+ 1.\n𝑎𝑏= (2𝑘+ 1)𝑏\n2𝑛= 2𝑘𝑏+ 𝑏\n2𝑛−2𝑘𝑏= 𝑏\n2(𝑛−𝑘𝑏) = 𝑏.\n",
    "Therefore 𝑏must be even.\n",
    "1.4.2\nDirect Proof\nThe simplest style of proof is direct proof.",
    "Often all that is required to prove\nsomething is a systematic explanation of what everything means.",
    "You look at\nthe definitions, carefully explain and unpack their meaning, until you see that the\nconclusion is true.\n\n1.4.",
    "Proofs\n65\nTo illustrate the importance of definitions in a proof, let’s give a few careful\ndefinitions about mini sudoku puzzles.\n",
    "Definition 1.4.2 Mini Sudoku Definitions.\n",
    "A mini sudoku puzzle is a partially filled in 4 × 4 grid of squares, divided\ninto four 2 × 2 boxes.",
    "Each square can be empty or contain a digit from 1 to 4.\n",
    "We say that a mini sudoku puzzle is valid provided no digit from 1 to 4\nappears more than once in any row, any column, or any box.\n",
    "A solution to a mini sudoku puzzle is a valid puzzle with no empty\nsquares and every non-empty square of the puzzle unchanged.\n",
    "We say that a mini sudoku puzzle is solvable if there is exactly one\nsolution.\n",
    "First, let’s prove a useful and “obvious” fact about any valid mini sudoku puzzle.\n",
    "Proposition 1.4.3\nAny solution to a mini sudoku puzzle will have each digit from 1 to 4 appear exactly\nonce in each row, in each column, and in each box, appearing a total of four times.\n",
    "That’s obvious, you say!",
    "Isn’t that exactly what a valid puzzle is?",
    "Well, a valid\ncompleted puzzle, which is what we mean by a solution, right?",
    "Okay, not exactly,\nsince valid means that no digit repeats... isn’t that the same thing?\n",
    "Yes!",
    "Exactly!",
    "Saying this is a direct proof.\nProof.",
    "Suppose you have a solution to a mini sudoku puzzle.",
    "That means that\nyou have a 4 × 4 grid with each square filled in with a digit from 1 to 4 that is\nvalid.a Since the puzzle is valid, no digit repeats in any row, any column, or any\nboxb.",
    "Since a row contains four numbers that do not repeat, and there are exactly\nfour possible digits, each of those digits must appear exactly once.",
    "This is true for\nevery row, and for every column, and for every box.\n",
    "For each digit, since it appears exactly once in four different rows, it appears\nexactly four times.",
    "This completes the proof.\n",
    "aDefinition of solution\nbDefinition of valid\nRemark 1.4.4",
    "The proof contained one key mathematical idea besides just\nexplaining definitions: If four distinct numbers are chosen from a set of four\nnumbers, then all four numbers are chosen.",
    "Perhaps you want to also explain\nwhy this is true, or just say it is an example of the pigeonhole principle (we\nwill say what this is soon).",
    "How much you explain depends on who you are\nwriting the proof for.",
    "A little paranoia when writing proofs is healthy.\n",
    "Indeed, in most contexts, we wouldn’t even need to write out any of the\nabove proof.",
    "It would probably be sufficient to say, “Clearly this follows\n\n66\n1.",
    "Logic and Proofs\nfrom the definitions.”",
    "However, we are currently trying to learn how to write\nproofs, and it can be useful to be overly pedantic so we can focus on the proof\nstructure and the importance of applying definitions.\n",
    "Let’s prove something about a particular sudoku puzzle.\n",
    "Example 1.4.5\nProve that for any solution to the mini sudoku puzzle below, if the solution\nhas a 2 in the top-left square (r1c1), then it will contain a 2 in the bottom-right\nsquare (r4c4).\n",
    "1\n3\n1\n3\nSolution.\n",
    "We do not know whether the puzzle is solvable (in fact, it is not),\nalthough note that it is valid right now.",
    "What we want to prove is that if 2 is\nin the top-left square in any particular solution, then that solution contains a 2\nin the bottom-right square.\n",
    "Proof.\n",
    "Let 𝑆be a solution to the puzzle, and assume that 𝑆contains a 2 in\nthe top-left square.",
    "Since 𝑆is a valid puzzle, no digit repeats in any row, any\ncolumn, or any box.",
    "Look first at the top row.",
    "Since the row already contains\n1, 2, and 3, the remaining open square (r1c4) must be a 4.\n",
    "Now look at column 4 (the right-most column).",
    "Since we now know the\ntop-right square is a 4, this column already contains 1, 3, and 4.",
    "So the last\nopen square (r4c4) must be a 2.\n",
    "Thus 𝑆contains a 2 in the bottom-left square, which is what we needed to\nprove.\n",
    "■\nObserve the general form of the argument above.",
    "We were trying to prove an\nimplication 𝑃→𝑄:",
    "If there was a 2 in r1c1, then there was a 2 in r4c4.",
    "We started by\nassuming 𝑃was true.",
    "From that, we deduced something, and from that something\nwe deduced 𝑄.",
    "This is exactly what a direct proof of an implication 𝑃→𝑄looks\nlike (we could have had more steps between the 𝑃and 𝑄as well).\n",
    "Assume 𝑃. Explain, explain, . . .",
    ", explain.",
    "Therefore 𝑄.\n",
    "The one additional consideration we must make is that often we are proving a\ngeneral, universal statement, a statement of the form ∀𝑥(𝑃(𝑥) →𝑄(𝑥)).",
    "To handle\nthe quantifier, we fix an arbitrary instance of 𝑥.",
    "Above, we said, “Let 𝑆be a solution\nto the puzzle.”",
    "Since we made no additional assumptions about 𝑆besides that 𝑃\n\n1.4.",
    "Proofs\n67\nwas true about it, we say that 𝑆was an arbitrary solution.\n",
    "If we wanted to prove that all squares are rectangles, we first realize that this is\nthe same as saying, “For any shape, if the shape is a square, then it is a rectangle.”\n",
    "In symbols, ∀𝑥(𝑆(𝑥) →𝑅(𝑥)).",
    "We will want to assume 𝑃(𝑥) is true and deduce 𝑄(𝑥).\n",
    "Which 𝑥do we use?",
    "An arbitrary one, so our proof can be applied to all possible 𝑥.\nExample 1.4.6\nProve that for any mini sudoku puzzle with three empty squares, if the puzzle\nhas a solution, then the puzzle is solvable.\n",
    "Solution.\n",
    "Is this obvious?",
    "If a puzzle has a solution, then it is solvable,\nright?",
    "Not at all!",
    "Look again at the Mini Sudoku Definitions: Just because\na puzzle has a solution doesn’t mean that it has exactly one solution (i.e., it\nis solvable).",
    "But even if we don’t think this needs a proof, let’s be paranoid\nagain and use this as an excuse to focus on the logical structure of the proof.\n",
    "Notice that we are proving that the claim is true no matter what mini\nsudoku puzzle we start with.",
    "We might start with this puzzle:\n3\n4\n2\n2\n4\n3\n1\n1\n4\n4\n2\n1\n3\nClearly there is only one way to complete the puzzle: The top row has\nonly one open square, so we can only put one digit in it, and then columns 2\nand 3 only have one open square each, so we can fill those uniquely.\n",
    "Looking at a single example can often be helpful when crafting a proof,\nbut proving a general statement with an example is NEVER a correct proof.\n",
    "While there are only around 152.58 billion mini sudoku puzzles (and most\nof those are not valid, fewer have solutions, and even fewer have exactly one\nempty square), we don’t really want to check all possible puzzles.",
    "So instead,\nwe fix an arbitrary valid mini sudoku puzzle.",
    "We assume that it has a solution\nand has exactly three open squares.",
    "From this, we prove that there is only\none possible solution.\n",
    "Proof.\n",
    "Let 𝑃be an arbitrary mini sudoku puzzle.",
    "Assume 𝑃has exactly\nthree empty squares and that 𝑆is a solution.\n",
    "Since 𝑃is arbitrary, we don’t know how the three empty squares are\narranged.",
    "They could all be in different rows, or two could be in the same\nrow, or all three could be in the same row.\n",
    "If all the empty squares are in different rows, then in each row, there\nis exactly one empty square.",
    "The other three squares are filled with three\ndifferent digits (since the puzzle is valid), so there is only one choice to fill the\n\n68\n1.",
    "Logic and Proofs\nempty square.",
    "This number must be the number used in the solution 𝑆.\nNow consider the case where two of the empty squares are in the same\nrow, and the third square is in a different row.",
    "The third empty square’s row\nhas three different digits, so there is only one choice for the last square, and it\nmust agree with 𝑆. Once this is filled in, the other two empty squares must\nbe in two different columns, each of which has three filled-in digits.",
    "In each\nof these columns, the three filled-in digits are different, so there is only one\nchoice for the empty square.",
    "So again, any solution must be exactly 𝑆.\nFinally, if all three empty squares are in the same row, then they are all in\ndifferent columns.",
    "So using the same argument as we did when the empty\nsquares were in different rows, but using columns instead, we see that 𝑆is\nthe only solution.\n",
    "We have considered all possible cases, and in each case, 𝑆is the only\nsolution, so 𝑃is solvable.\n",
    "■\nDirect proof can, of course, be used to prove statements in mathematics too.\n",
    "Example 1.4.7\nProve: For all integers 𝑛, if 𝑛is even, then 𝑛2 is even.\n",
    "Solution.\n",
    "The format of the proof will be this: Let 𝑛be an arbitrary integer.\n",
    "Assume that 𝑛is even.",
    "Explain explain explain.",
    "Therefore 𝑛2 is even.\n",
    "To fill in the details, we explain what it means for 𝑛to be even, and then\nsee what that means for 𝑛2.",
    "The definition that is relevant here is, “An integer\n𝑛is even if there is an integer 𝑘such that 𝑛= 2𝑘.”",
    "Here is a complete proof.\nProof.\n",
    "Let 𝑛be an arbitrary integer.",
    "Suppose 𝑛is even.",
    "Then 𝑛= 2𝑘for\nsome integer 𝑘.",
    "Now 𝑛2 = (2𝑘)2 = 4𝑘2 = 2(2𝑘2).",
    "Since 2𝑘2 is an integer, 𝑛2 is\neven.\n",
    "■\nExample 1.4.8\nProve: For all integers 𝑎, 𝑏, and 𝑐, if 𝑏is a multiple of 𝑎, and 𝑐is a multiple of\n𝑏, then 𝑐is a multiple of 𝑎.\nSolution.\n",
    "Even if we don’t remember exactly what “is a multiple of” means,\nwe can set up a direct proof for this statement.",
    "It will go something like this:\nLet 𝑎, 𝑏, and 𝑐be arbitrary integers.",
    "Assume that 𝑏is a multiple of 𝑎and that\n𝑐is a multiple of 𝑏. Dot dot dot.",
    "Therefore 𝑐is a multiple of 𝑎.\n",
    "How do we connect the dots?",
    "We say what our hypothesis really means\nand why this gives us what the conclusion really means.",
    "This is where we\nneed the definition of 𝑏is a multiple of 𝑎: This means that 𝑏= 𝑘𝑎for some\nintegers 𝑘.",
    "What are we going for?",
    "That 𝑐= 𝑙𝑎, for some integer 𝑙.",
    "Here is the\ncomplete proof.\n\n1.4.",
    "Proofs\n69\nProof.\n",
    "Let 𝑎, 𝑏, and 𝑐be integers.",
    "Assume that 𝑏is a multiple of 𝑎and that 𝑐\nis a multiple of 𝑏.",
    "So there are integers 𝑘and 𝑗such",
    "that 𝑏= 𝑘𝑎and 𝑐= 𝑗𝑏.\nCombining these (through substitution)",
    "we get that\n𝑐= 𝑗(𝑘𝑎) = (𝑗𝑘)𝑎.\nBut 𝑗𝑘is an integer, so this says that 𝑐is a multiple of 𝑎.\n■\n1.4.3\nProof by Contrapositive\nRecall that an implication 𝑃→𝑄is logically equivalent to its contrapositive\n¬𝑄→¬𝑃.",
    "There are plenty of examples of statements that are hard to prove directly,\nbut whose contrapositive can easily be proved using a direct proof.",
    "This is all that\nproof by contrapositive does.",
    "It gives a direct proof of the contrapositive of the\nimplication.",
    "This is enough because the contrapositive is logically equivalent to the\noriginal implication.\n",
    "The skeleton of the proof of 𝑃→𝑄by contrapositive will always look roughly\nlike this:\nAssume ¬𝑄. Explain, explain, . . .",
    "explain.",
    "Therefore ¬𝑃.\nAs before, if there are variables and quantifiers, we set them to be arbitrary elements\nof our domain.\n",
    "Example 1.4.9\nProve that if a mini sudoku puzzle is solvable, then it is valid.\n",
    "Solution.\n",
    "Remember, a puzzle is valid provided no row, column, or box\ncontains a repeated digit.",
    "A puzzle is solvable if there is exactly one solution,\nwhere a solution is a valid puzzle with no empty squares (that doesn’t change\nany previously filled-in square).\n",
    "If we try a direct proof, we would start with an arbitrary puzzle and\nassume it is solvable.",
    "We could then “get” the solution, but would need to\nreason back in time to when the puzzle started.",
    "This seems hard.",
    "Often,\nwhen a proof seems to require breaking things apart, it is easier to try the\ncontrapositive.",
    "That’s what we will do.\nProof.\n",
    "Let 𝑃be an arbitrary mini sudoku puzzle and assume that it is not\nvalid.",
    "This means that in at least one row, or one column, or one box, some\ndigit appears more than once.\n",
    "Now suppose we have filled in the empty squares but not changed any\npreviously filled-in squares.",
    "The original row, column, or box that contained\na duplicate digit will still contain that duplication, so the resulting completed\npuzzle will not be valid.",
    "Thus no solution to 𝑃exists, so 𝑃is not solvable.",
    "■\nWe have proved that if a mini sudoku puzzle is not valid, then it is not\nsolvable, which is the contrapositive of what we wanted to prove and so\n\n70\n1.",
    "Logic and Proofs\nserves as a proof of the original statement.\n",
    "Here are a couple more mathy examples.\n",
    "Example 1.4.10\nIs the statement, “For all integers 𝑛, if 𝑛2 is even, then 𝑛is even,” true?\nSolution.\n",
    "This is the converse of the statement we proved in Example 1.4.7\nabove using a direct proof.",
    "From trying a few examples, this statement\nappears to be true.",
    "So let’s prove it.\n",
    "A direct proof of this statement would require fixing an arbitrary 𝑛and\nassuming that 𝑛2 is even.",
    "But it is not at all clear how this would allow us to\nconclude anything about 𝑛. Just because 𝑛2 = 2𝑘does not in itself suggest\nhow we could write 𝑛as a multiple of 2.\nTry something else: Write the contrapositive of the statement.",
    "We get, for\nall integers 𝑛, if 𝑛is odd, then 𝑛2 is odd.",
    "This looks much more promising.\n",
    "We need a definition of a number being odd.",
    "An integer 𝑛is odd provided\n𝑛= 2𝑘+ 1 for some integer 𝑘.",
    "Our proof will look something like this:\nLet 𝑛be an arbitrary integer.",
    "Suppose that 𝑛is not even.",
    "This means that\n. . . .",
    "In other words . . . .",
    "But this is the same as saying . . . .",
    "Therefore 𝑛2 is not\neven.\n",
    "Now we fill in the details.\nProof.\n",
    "We will prove the contrapositive.",
    "Let 𝑛be an arbitrary integer.\n",
    "Suppose that 𝑛is not even, and thus odd.",
    "Then 𝑛= 2𝑘+ 1 for some integer\n𝑘. Now 𝑛2 = (2𝑘+ 1)2 = 4𝑘2 + 4𝑘+ 1 = 2(2𝑘2 + 2𝑘)",
    "+ 1.",
    "Since 2𝑘2 + 2𝑘is an\ninteger, we see that 𝑛2 is odd and therefore not even.\n",
    "■\nExample 1.4.11\nProve that for all integers 𝑎and 𝑏, if 𝑎+ 𝑏is odd, then 𝑎is odd or 𝑏is odd.\nSolution.\n",
    "The problem with trying a direct proof is that it will be hard to\nseparate 𝑎and 𝑏from knowing something about 𝑎+ 𝑏.",
    "On the other hand, if\nwe know something about 𝑎and 𝑏separately, then combining them might\ngive us information about 𝑎+ 𝑏. The contrapositive of the statement we are\ntrying to prove is: for all integers 𝑎and 𝑏, if 𝑎and 𝑏are even, then 𝑎+ 𝑏is\neven.",
    "Thus our proof will have the following format:\nLet 𝑎and 𝑏be integers.",
    "Assume that 𝑎and 𝑏are both even.",
    "la la la.\n",
    "Therefore 𝑎+ 𝑏is even.\n",
    "Here is a complete proof.\nProof.\n",
    "Let 𝑎and 𝑏be integers.",
    "Assume that 𝑎and 𝑏are even.",
    "Then 𝑎= 2𝑘\nand 𝑏= 2𝑙for some integers 𝑘and 𝑙.",
    "Now 𝑎+ 𝑏= 2𝑘+",
    "2𝑙= 2(𝑘+ 𝑙).",
    "Since\n𝑘+ 𝑙is an integer, we see that 𝑎+ 𝑏is even, completing the proof.\n",
    "■\n\n1.4.",
    "Proofs\n71\nNote that our assumption that 𝑎and 𝑏are even is the negation of 𝑎or 𝑏is\nodd.",
    "We used De Morgan’s law here.\n",
    "Direct proofs and proofs by contrapositive can be used when proving implications.\n",
    "Remember that some statements that are not explicitly written as an implication can\nbe rephrased as one.\n",
    "Example 1.4.12\nConsider the statement, “For every prime number 𝑝, either 𝑝= 2, or 𝑝is odd.”\n",
    "We can rephrase this as, “For every prime number 𝑝, if 𝑝≠2, then 𝑝is odd.”\n",
    "Now try to prove it.\n",
    "Use the following as the definition of a prime number: An integer 𝑝> 1 is\nprime provided it has exactly two factors, namely 1 and 𝑝.\nSolution.\nProof.\n",
    "Let 𝑝be an arbitrary prime number.",
    "Assume 𝑝is not odd.",
    "So 𝑝is\ndivisible by 2.",
    "Since 𝑝is prime, it must have exactly two divisors, and it has\n2 as a divisor, so 𝑝must be divisible by only 1 and 2.",
    "Therefore 𝑝= 2.",
    "This\ncompletes the proof (by contrapositive).\n",
    "■\n1.4.4\nProof by Contradiction\nTake a step back and consider what it would mean if the conclusion of an argument\nwere false.",
    "There are two reasons this could happen.",
    "Either the logic in the argument\nis faulty, or at least one assumption must be false.",
    "A proof by contradiction exploits\nthis second possibility.",
    "We start with a single assumption and construct a valid proof\nthat leads to a false conclusion; the only possibility is that the single assumption was\nfalse.",
    "The false conclusion is the “contradiction,” which just means a necessarily\nfalse statement (technically a statement of the form 𝑃∧¬𝑃).\n",
    "The general form of a proof by contradiction to prove a statement 𝑃is,\nAssume ¬𝑃(that 𝑃is not true).",
    "This means that..., which tells us..., so\nwe can say...",
    "But that is a contradiction, so 𝑃must in fact be true.\n",
    "Note that if we think of this style of argument as a direct proof of something, it is a\ndirect proof of\n¬𝑃→contradiction.\n",
    "So we have a valid proof of this implication.",
    "How can a true implication have a false\nconclusion?",
    "Recall the truth table for an implication (Figure 1.2.2).",
    "The only row\nin which the implication is true but the conclusion is false is row 4, and here the\nhypothesis is also false.",
    "So ¬𝑃is false, which is to say 𝑃is true.\n",
    "Once you start writing proofs by contradiction, it becomes very natural.",
    "Let’s\nsee how with a sudoku proof.\n\n",
    "72\n1.",
    "Logic and Proofs\nExample 1.4.13\nProve that any solution to the mini sudoku puzzle below must contain a 3 in\nthe top-right corner (r1c4).\n",
    "2\n3\n3\n1\nSolution.\n",
    "There are multiple ways we could prove this, which is often the\ncase for proofs by contradiction.",
    "While we would always start with the\nsame initial assumption (the opposite of what we want to prove), where the\ncontradiction is found can vary.\nProof.\n",
    "Let 𝑆be a solution to the puzzle, but assume that 𝑆does not contain a\n3 in the top-right corner.",
    "Then the top row must contain a 3 somewhere else.\n",
    "It cannot be in column 1, since it already has a 3.",
    "It cannot be in column 2,\nsince that square is already filled in (with the 2).",
    "It also cannot be in column\n3, since if it was, there would be no place to put a three in the bottom row.",
    "So\nthere would be no 3 in the top row, contradicting that 𝑆is a solution.\n",
    "Therefore 𝑆must contain a 3 in the top-right corner.\n",
    "■\nExample 1.4.14\nProve that there is no solution to the sudoku puzzle below.\n",
    "4\n1\n4\nSolution.\n",
    "Look at the logical format of this statement:\n¬∃𝑆(𝑆is a solution ).\n",
    "Using the rules for negation of quantifiers, this is the same as\n∀𝑆(𝑆is not a solution).\n",
    "If we were to prove this directly, we would need to consider all possible\nsolutions and show that they are not valid.",
    "That seems quite challenging.\n\n1.4.",
    "Proofs\n73\nOn the other hand, if we try a proof by contradiction, we get to assume\nthe negation of the statement we are asked to prove.",
    "That is, we can assume\nthat there is a solution.",
    "That is a single solution we can reason about.",
    "Much\nmore manageable.\nProof.\n",
    "Suppose, for the sake of contradiction, that there does exist a solution\nto the puzzle.",
    "This solution must have a 4 in the bottom-left box.",
    "But the only\nsquares that can hold a 4 are either in row 4 or column 1 (or both).",
    "In either\ncase, this contradicts that there is a 4 already in column 1 and row 4.\n■\nHere are three examples of proofs by contradiction about numbers:\nExample 1.4.15\nProve that\n√\n2 is irrational.\n",
    "Solution.\n",
    "Proof.\nSuppose not.",
    "Then\n√\n2 is equal to a fraction 𝑎\n𝑏.",
    "Without loss of\ngenerality, assume 𝑎\n𝑏is in lowest terms (otherwise reduce the fraction).",
    "So,\n2 = 𝑎2\n𝑏2\n2𝑏2 = 𝑎2.\n",
    "Thus 𝑎2 is even, and as such 𝑎is even.",
    "So 𝑎= 2𝑘for some integer 𝑘, and\n𝑎2 = 4𝑘2.",
    "We then have,\n2𝑏2 = 4𝑘2\n𝑏2 = 2𝑘2.\n",
    "Thus 𝑏2 is even, and as such 𝑏is even.",
    "Since 𝑎is also even, we see that 𝑎\n𝑏is\nnot in lowest terms, a contradiction.",
    "Thus\n√\n2 is irrational.\n",
    "■\nExample 1.4.16\nProve: There are no integers 𝑥and 𝑦such that 𝑥2 = 4𝑦+ 2.\nSolution.\nProof.\n",
    "We proceed by contradiction.",
    "So suppose there are integers 𝑥and\n𝑦such that 𝑥2 = 4𝑦+ 2 = 2(2𝑦+ 1).",
    "So 𝑥2 is even.",
    "We have seen that this\nimplies that 𝑥is even.",
    "So 𝑥= 2𝑘for some integer 𝑘.",
    "Then 𝑥2 = 4𝑘2.",
    "This in\nturn gives 2𝑘2 = (2𝑦+ 1).",
    "But 2𝑘2 is even, and 2𝑦+ 1 is odd, so these cannot\nbe equal.",
    "Thus we have a contradiction, so there must not be any integers 𝑥\nand 𝑦such that 𝑥2 = 4𝑦+ 2.\n",
    "■\n\n74\n1.",
    "Logic and Proofs\nExample 1.4.17\n",
    "The Pigeonhole Principle: If more than 𝑛pigeons fly into 𝑛pigeonholes,\nthen at least one pigeonhole will contain at least two pigeons.",
    "Prove this!\nSolution.\nProof.\n",
    "Suppose, contrary to stipulation, that each of the pigeonholes contains\nat most one pigeon.",
    "Then at most, there will be 𝑛pigeons.",
    "But we assumed\nthat there are more than 𝑛pigeons, so this is impossible.",
    "Thus there must be\na pigeonhole with more than one pigeon.\n",
    "■\nWhile we phrased this proof as a proof by contradiction, we could have\nalso used a proof by contrapositive since our contradiction was simply the\nnegation of the hypothesis.\n",
    "Sometimes this will happen, in which case\nyou can use either style of proof.",
    "There are examples, however, where the\ncontradiction occurs “far away” from the original statement.\n",
    "1.4.5\nSummary of Proof Styles\nWe have considered three styles of proof: direct proof, proof by contrapositive, and\nproof by contradiction.",
    "It can be challenging to decide which style of proof to use\non a given problem, and no rule will always tell us what to do.",
    "Often, there are\nmultiple ways you can proceed in a proof, which is one reason math is so exciting.\n",
    "A good starting point when writing proofs is to consider what the initial\nassumption would be with each style, and what the conclusion you would be looking\nfor is.",
    "A proof is a little like a kids-menu maze.",
    "There is a START and an EXIT, and\nyour goal is to find your way from one to the other.",
    "Sometimes it helps to work your\nway in from both sides and hopefully meet in the middle.\n",
    "Starts and Ends Proofs.\n",
    "To prove an implication 𝑃→𝑄:\nDirect\nStart: Assume 𝑃.\nEnd: Therefore 𝑄.\nContrapositive\nStart: Assume ¬𝑄.\nEnd:",
    "Therefore ¬𝑃.\nContradiction\nStart: Assume ¬(𝑃→𝑄).\n",
    "End: ...which is a contradiction.\n",
    "You can use a proof by contradiction even if you are not trying to prove an\nimplication, but if the statement is an implication, then assuming ¬(𝑃→𝑄) is really\npowerful.",
    "Remember, the only way for an implication to be false is for 𝑃to be true\nand 𝑄to be false.",
    "So we are actually assuming 𝑃∧¬𝑄.",
    "Aha!",
    "𝑃is what we assume\nin a direct proof.",
    "¬𝑄is what we assume in a proof by contrapositive.",
    "So a proof by\n\n1.4.",
    "Proofs\n75\ncontradiction is like doing the other two proofs at the same time, and meeting in the middle!\n",
    "To illustrate this, let’s prove the fact from the Investigate!",
    "activity.",
    "We will prove\nthat if a mini sudoku puzzle has all different numbers in its corners (marked with 𝑎\nthrough 𝑑below), then the center four squares (marked with ‗ below) must also\ncontain different numbers (in any solution).\n",
    "𝑎\n𝑏\n*\n*\n*\n*\n𝑐\n𝑑\nWe will give three proofs, first a direct proof, then a proof by contrapositive, and\nfinally a proof by contradiction.\nProof.",
    "Let 𝑃be a sudoku puzzle with all different numbers in its corners: 𝑎in the\ntop-left, 𝑏in the top-right, 𝑐in the bottom-left, and 𝑑in the bottom-right.",
    "Let 𝑆be\nany solution to the puzzle.\n",
    "In 𝑆, whatever digit 𝑎is must appear in row 2.",
    "Since 𝑎is already in the top-left\nbox, it cannot appear in columns 1 or 2, so it must appear in columns 3 or 4.",
    "If it is\nin column 3, then 𝑎appears in one of the center squares.",
    "If not, then it is in column\n4.",
    "In this latter case, we ask where 𝑎appears in row 3: It cannot be in column 1 or\n4, so it must be in column 2 or 3, and thus in one of the center squares.\n",
    "The same argument can now be applied to each of the other three outer squares.\n",
    "Thus, in any solution to the puzzle, the center four squares must contain the digits\n𝑎through 𝑑, all different.\n",
    "Now we will prove the same statement by contrapositive.\nProof.",
    "Let 𝑃be a mini sudoku puzzle with numbers in its corners.",
    "Let 𝑆be any\nsolution to the puzzle.",
    "Assume that the center four squares do not contain all\ndifferent numbers in 𝑆. Then there must be some common number, say 𝑛, in two\nof the center squares.\n",
    "Since 𝑛cannot appear twice in a row, it must be that 𝑛is in two center squares\ndiagonally from each other: either in r2c2 and r3c3, or in r2c3 and r3c2.",
    "In either\ncase, where could 𝑛be in rows 1 and 4?",
    "It cannot be in columns 2 or 3, so it must be\nin columns 1 and 4.",
    "This means that 𝑛will be in opposite outer corners, meaning\nthat the digits in the four corners are not all different.\n",
    "Finally, we will prove the same statement by contradiction.\nProof.",
    "Let 𝑃be a mini sudoku puzzle and assume that the four outer corners are\nall different, but in some solution 𝑆, the center four squares are not all different.\n",
    "Suppose 𝑎, the digit in the top-left corner, appears twice in the center four\nsquares.",
    "The only way this can happen is if 𝑎appears in r3c2 and r2c3, as shown\nbelow.\n\n",
    "76\n1.",
    "Logic and Proofs\n𝑎\n𝑏\n*\n𝑎\n𝑎\n*\n𝑐\n𝑑\n",
    "But now, where can the fourth 𝑎in the go in the solution?",
    "It must be in r4c4,\ncontradicting that the four corners are all different.",
    "An analogous argument leads\nto a contradiction for each of the other possible outer corner digits being repeated\nin the center.",
    "Thus, the center four squares must contain all different numbers.\n",
    "1.4.6\nReading Questions\n1.\n",
    "Which of the following would be the best first line of a direct proof if you wanted\nto prove the statement, “For all sets 𝐴of single-digit numbers, if |𝐴| = 6, then\n𝐴contains an even number.",
    "”\nA. Suppose there exists a set 𝐴of single-digit numbers with |𝐴| = 6 but that\ncontains only odd numbers.\n",
    "B. Fix an arbitrary set 𝐴of single-digit numbers, and assume |𝐴|",
    "= 6.\nC. Suppose 𝐴is a set of single-digit numbers with |𝐴| ≠6.\n",
    "D. Let 𝐴be a set of single-digit numbers that contains an even number.\n",
    "E. Let 𝐴be a set of single-digit numbers, and assume that 𝐴does not contain\nany even numbers.\n",
    "2.\nWhich of the following would be the best first line of a proof by contrapositive if\nyou wanted to prove the statement, “For all sets 𝐴of single-digit numbers, if\n|𝐴| = 6, then 𝐴contains an even number.",
    "”\nA. Suppose there exists a set 𝐴of single-digit numbers with |𝐴| = 6 but that\ncontains only odd numbers.\n",
    "B. Fix an arbitrary set 𝐴of single-digit numbers, and assume |𝐴|",
    "= 6.\nC. Suppose 𝐴is a set of single-digit numbers with |𝐴| ≠6.\n",
    "D. Let 𝐴be a set of single-digit numbers that contains an even number.\n",
    "E. Let 𝐴be a set of single-digit numbers, and assume that 𝐴does not contain\nany even numbers.\n",
    "3.\nWhich of the following would be the best first line of a proof by contradiction if\nyou wanted to prove the statement, “For all sets 𝐴of single-digit numbers, if\n|𝐴| = 6, then 𝐴contains an even number.”\n\n1.4.",
    "Proofs\n77\nA. Suppose there exists a set 𝐴of single-digit numbers with |𝐴| = 6 but that\ncontains only odd numbers.\n",
    "B. Fix an arbitrary set 𝐴of single-digit numbers, and assume |𝐴|",
    "= 6.\nC. Suppose 𝐴is a set of single-digit numbers with |𝐴| ≠6.\n",
    "D. Let 𝐴be a set of single-digit numbers that contains an even number.\n",
    "E. Let 𝐴be a set of single-digit numbers, and assume that 𝐴does not contain\nany even numbers.\n",
    "4.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "1.4.7\nPractice Problems\n1.\n",
    "Arrange some of the statements below to form a correct proof of the following\nstatement: “For any integer 𝑛, if 𝑛is even, then 7𝑛is even.”\n• Let 𝑛be an arbitrary integer, and assume 7𝑛is even.\n",
    "• Let 𝑛be an arbitrary integer, and assume 7𝑛is odd.\n",
    "• Since 7 is odd and the product of an odd number and an odd number is\nodd,\n• Since an even number divided by 7 must be odd,\n• 𝑛must be even.\n",
    "• 7𝑛must be odd.\n",
    "• Let 𝑛be an arbitrary integer, and assume 𝑛is even.\n",
    "•",
    "Since the product of any number with an even number is even,\n• 7𝑛must be even.\n",
    "2.\nArrange some of the statements below to form a correct proof of the following\nstatement: “For any integer 𝑛, if 7𝑛is even, then 𝑛is even.”\n• Let 𝑛be an arbitrary integer, and assume 𝑛is even.\n•",
    "Since the 7 is odd and the product of an odd number with an even number\nis even,\n• 7𝑛must be even.\n",
    "• Let 𝑛be an arbitrary integer, and assume 7𝑛is even.\n",
    "•",
    "Since an even number divided by 7 must be even,\n\n78\n1.",
    "Logic and Proofs\n• 𝑛must be even.\n",
    "• Let 𝑛be an arbitrary integer, and assume 𝑛is odd.\n",
    "• Since 7 is odd and the product of an odd number and an odd number is\nodd,\n• 7𝑛must be odd.\n",
    "3.\nConsider the statement, “For any numbers 𝑎and 𝑏, if 𝑎+ 𝑏is odd, then either\n𝑎or 𝑏is odd”.\n",
    "Give a valid proof of the statement using a proof by contrapositive.",
    "Arrange\nsome statements below to complete the proof.\n",
    "• Let 𝑎and 𝑏be integers, and assume that 𝑎+ 𝑏is odd.\n",
    "• Let 𝑎and 𝑏be integers, and assume that if 𝑎+ 𝑏is odd, then either 𝑎or 𝑏\nis odd.\n",
    "• Let 𝑎and 𝑏be integers, and assume both are even.\n",
    "• The sum of two even integers must also be even.\n",
    "•",
    "Therefore 𝑎+ 𝑏is even.\n",
    "• Let 𝑎and 𝑏be integers and assume that 𝑎+ 𝑏is odd but 𝑎and 𝑏are both\neven.\n",
    "• The sum of two odd integers must be even.\n",
    "•",
    "But then 𝑎+ 𝑏is both even and odd, a contradiction.\n",
    "4.\nConsider the same statement, “For any numbers 𝑎and 𝑏, if 𝑎+ 𝑏is odd, then\neither 𝑎or 𝑏is odd.”\n",
    "Give a valid proof of the statement, this time using a proof by contradiction\nusing some of the statements below.\n",
    "• Let 𝑎and 𝑏be integers, and assume that 𝑎+ 𝑏is odd.\n",
    "• Let 𝑎and 𝑏be integers, and assume that if 𝑎+ 𝑏is odd, then either 𝑎or 𝑏\nis odd.\n",
    "• Let 𝑎and 𝑏be integers, and assume both are even.\n",
    "• Let 𝑎and 𝑏be integers, and assume that 𝑎+ 𝑏is odd but 𝑎and 𝑏are both\neven.\n",
    "•",
    "Therefore 𝑎+ 𝑏is even.\n",
    "• The sum of two even integers must also be even.\n",
    "• The sum of two odd integers must be even.\n",
    "•",
    "But then 𝑎+ 𝑏is both even and odd, a contradiction.\n\n",
    "1.4.",
    "Proofs\n79\n5.\nBelow are three statements together with a possible first line of a proof of that\nstatement.",
    "In each case, say whether the first line is the start of a direct proof, a\nproof by contrapositive, or a proof by contradiction.\n",
    "(a) Statement: For every integer 𝑛, the number 7𝑛−1 is divisible by 6.\n",
    "First line: Suppose there were some integer 𝑛for which 7𝑛−1 was not\ndivisible by 6.\n(b) Statement: For any integer 𝑛, if 𝑛is prime, then 𝑛is solitary\nFirst line: Let 𝑛be an integer, and assume 𝑛is not solitary.\n",
    "(c) Statement: If a shape is a pentagon, then its interior angles add up to 480\ndegrees.\n",
    "First line: Consider an arbitrary shape, and assume it is a pentagon.\n",
    "6.\n",
    "What would the first line be for a proof in each style, of the following statement:\n“If a function 𝑓: 𝐴→𝐵is a bĳection, then |𝐴| = |𝐵|.”\n",
    "Assume 𝑓: 𝐴→𝐵is a bĳection\nDirect proof\nAssume |𝐴| ≠|𝐵|\nProof by contradiction\nAssume 𝑓: 𝐴→𝐵is a bĳection and |𝐴| ≠|𝐵|\nProof by contrapositive\n1.4.8\nAdditional Exercises\n1.\n",
    "For a given predicate 𝑃(𝑥), you might believe that the statements ∀𝑥𝑃(𝑥) or\n∃𝑥𝑃(𝑥) are either true or false.",
    "How would you decide if you were correct in\neach case?",
    "You have four choices: You could give an example of an element 𝑛\nin the domain for which 𝑃(𝑛) is true or for which 𝑃(𝑛) is false, or you could\nargue that no matter what 𝑛is, 𝑃(𝑛) is true or is false.\n",
    "(a)",
    "What would you need to do to prove ∀𝑥𝑃(𝑥) is true?\n(b) What would you need to do to prove ∀𝑥𝑃(𝑥) is false?\n(c)",
    "What would you need to do to prove ∃𝑥𝑃(𝑥) is true?\n(d)",
    "What would you need to do to prove ∃𝑥𝑃(𝑥) is false?\n2.\nConsider the statement, “For all integers 𝑎and 𝑏, if 𝑎+ 𝑏is even, then 𝑎and 𝑏\nare even.”\n(a) Write the contrapositive of the statement.\n",
    "(b) Write the converse of the statement.\n",
    "(c) Write the negation of the statement.\n",
    "(d) Is the original statement true or false?",
    "Prove your answer.\n\n",
    "80\n1.",
    "Logic and Proofs\n(e) Is the contrapositive of the original statement true or false?",
    "Prove your\nanswer.\n",
    "(f) Is the converse of the original statement true or false?",
    "Prove your answer.\n",
    "(g) Is the negation of the original statement true or false?",
    "Prove your answer.\n",
    "3.\nFor each of the statements below, say what method of proof you should use to\nprove them.",
    "Then say how the proof starts and how it ends.",
    "Bonus points for\nfilling in the middle.\n",
    "(a) There are no integers 𝑥and 𝑦such that 𝑥is a prime greater than 5 and\n𝑥= 6𝑦+ 3.\n(b) For all integers 𝑛, if 𝑛is a multiple of 3, then 𝑛can be written as the sum\nof consecutive integers.\n",
    "(c) For all integers 𝑎and 𝑏, if 𝑎2 + 𝑏2 is odd, then 𝑎or 𝑏is odd.\n",
    "4.\nConsider the statement, “For all integers 𝑛, if 𝑛is even then 8𝑛is even.”\n(a) Prove the statement.",
    "What sort of proof are you using?\n(b) Is the converse true?",
    "Prove or disprove.\n",
    "5.\n",
    "The game TENZI comes with 40 six-sided dice (each numbered 1 to 6).",
    "Suppose\nyou roll all 40 dice.\n",
    "(a) Prove that there will be at least seven dice that land on the same number.\n",
    "(b) How many dice would you have to roll before you were guaranteed that\nsome four of them would all match or all be different?",
    "Prove your answer.\n",
    "6.\nProve that for all integers 𝑛, it is the case that 𝑛is even if and only if 3𝑛is even.\n",
    "That is, prove both implications: If 𝑛is even, then 3𝑛is even, and if 3𝑛is even,\nthen 𝑛is even.\n",
    "7.\nProve that\n√\n3 is irrational.\n",
    "8.\nConsider the statement, “For all integers 𝑎and 𝑏, if 𝑎is even and 𝑏is a multiple\nof 3, then 𝑎𝑏is a multiple of 6.”\n(a) Prove the statement.",
    "What sort of proof are you using?\n(b) State the converse.",
    "Is it true?",
    "Prove or disprove.\n",
    "9.\nProve the statement, “For all integers 𝑛, if 5𝑛is odd, then 𝑛is odd.”",
    "Clearly\nstate the style of proof you are using.\n",
    "10.\nProve the statement, “For all integers 𝑎, 𝑏, and 𝑐, if 𝑎2 + 𝑏2 = 𝑐2, then 𝑎or 𝑏is\neven.”\n11.\n",
    "Suppose that you would like to prove the following implication:\n",
    "For all numbers 𝑛, if 𝑛is prime then 𝑛is solitary.\n\n",
    "1.4.",
    "Proofs\n81\nWrite out the beginning and end of the argument if you were to prove the\nstatement,\n(a) Directly\n(b) By contrapositive\n(c) By contradiction\nYou do not need to provide the middle parts of the proofs (since you do\nnot know what solitary means).",
    "However, make sure that you give the first\nfew and last few lines of the proofs so that we can see the logical structure you\nwould follow.\n12.\nSuppose you have a collection of rare 5-cent stamps and 8-cent stamps.",
    "You\ndesperately need to mail a letter and, having no other stamps available, decide\nto dip into your collection.",
    "The question is, what amounts of postage can you\nmake?\n",
    "(a) Prove that if you only use an even number of both types of stamps, the\namount of postage you make must be even.\n",
    "(b) Suppose you made an even amount of postage.",
    "Prove that you used an\neven number of at least one of the types of stamps.\n",
    "(c) Suppose you made exactly 72 cents of postage.",
    "Prove that you used at\nleast 6 of at least one type of stamp.\n",
    "13.\nProve: 𝑥= 𝑦if and only if 𝑥𝑦= (𝑥+ 𝑦)2\n4\n.",
    "Note, you will need to prove two\n“directions” here, the “if” and the “only if” part.\n",
    "14.\nProve that log(7) is irrational.\n",
    "15.\nProve that there are no integer solutions to the equation 𝑥2 = 4𝑦+ 3.\n16.\n",
    "Prove that every prime number greater than 3 is either one more or one less\nthan a multiple of 6.\n17.\n",
    "Your “friend” has shown you a “proof” he wrote to show that 1 = 3.",
    "Here is\nthe proof:\nProof.\n",
    "I claim that 1 = 3.",
    "Of course we can do anything to one side of an\nequation as long as we also do it to the other side.",
    "So subtract 2 from both\nsides.",
    "This gives −1 = 1.",
    "Now square both sides, to get 1 = 1.",
    "And we all\nagree this is true.\n",
    "What is going on here?",
    "Is your friend’s argument valid?",
    "Is the argument a\nproof of the claim 1 = 3?",
    "Carefully explain using what we know about logic.\n",
    "18.\n",
    "A standard deck of 52 cards consists of 4 suits (hearts, diamonds, spades, and\nclubs) each containing 13 different values (Ace, 2, 3, . .",
    ".",
    ", 10, J, Q, K).",
    "If you\ndraw some number of cards at random, you might or might not have a pair\n\n82\n1.",
    "Logic and Proofs\n(two cards with the same value) or three cards all of the same suit.",
    "However, if\nyou draw enough cards, you will be guaranteed to have these.",
    "For each of the\nfollowing, find the smallest number of cards you would need to draw to be\nguaranteed having the specified cards.",
    "Prove your answers.\n",
    "(a) Three of a kind (for example, three 7’s).\n",
    "(b) A flush of five cards (for example, five hearts).\n",
    "(c) Three cards that are either all the same suit or all different suits.\n",
    "19.\nSuppose you are at a party with 19 of your closest friends (so including you,\nthere are 20 people there).",
    "Explain why there must be at least two people at the\nparty who are friends with the same number of people at the party.",
    "Assume\nfriendship is always reciprocated.\n",
    "20.\n",
    "Your friend has given you his list of 115 best Doctor Who episodes (in order of\ngreatness).",
    "It turns out that you have seen 60 of them.",
    "Prove that there are at\nleast two episodes you have seen that are exactly four episodes apart on your\nfriend’s list.\n",
    "21.\nSuppose you have an 𝑛×𝑛chessboard, but your dog has eaten one of the corner\nsquares.",
    "You have dominoes that each cover exactly two squares of the board.\n",
    "Can you cover the remaining squares on the board with non-overlapping\ndominoes?",
    "What needs to be true about 𝑛?",
    "Give necessary and sufficient\nconditions (that is, say exactly which values of 𝑛work and which do not work).\n",
    "Prove your answers.\n",
    "22.\n",
    "What if your 𝑛× 𝑛chessboard is missing two opposite corners?",
    "Prove that\nno matter what 𝑛is, you will not be able to cover the remaining squares with\nnon-overlapping dominoes.\n\n1.5\nProofs about Discrete Structures\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "• Read and comprehend definitions related to discrete structures, so\nyou can apply the definitions correctly.\n",
    "• Write proofs about discrete structures.\n",
    "1.5.1\nSection Preview\nInvestigate!\nSuppose there are 15 people at a party.",
    "Most people know each other already,\nbut there are still some people who decide to shake hands.",
    "Is it possible for\neveryone at the party to shake hands with exactly three other people?\n",
    "So far we have seen how the logical form of a statement can inform how to build\nthe scaffolding of a proof.",
    "This can only get us so far though: To flesh out the proof\nskeleton requires an understanding of the mathematical objects and structures the\nproofs are about.",
    "Some of this can come from carefully reading definitions.",
    "Yet there\nis also some less concrete understanding and intuition that comes from working\nwith the objects and structures that can lead to that “ah-ha!” moment of inspiration\nthat suggests how to proceed with a proof.\n",
    "By the way...",
    "Why are we writing proofs?",
    "Besides practice in becoming better\nreasoners, diving into careful proofs about discrete structures is a way to learn\nmore about the structures themselves.",
    "They are a playground for exploring\nmathematics, to help us build intuition for mathematical structures.",
    "So we\nstudy structures to help us write proofs about them, and we write proofs\nabout them to help understand the structures.",
    "Bootstrapping!\n",
    "Another reason to shift our focus toward proofs about discrete structures is that\ndoing so illustrates an important feature of mathematics: abstraction.",
    "We have\nbeen proving particular facts about particular problems.",
    "We might even start to\nnotice similarities between the proofs for some statements.",
    "This might be due to the\nunderlying mathematical structures that the problems are (secretly) about.",
    "If we\nprove the general facts about these structures, then we can apply these “theorems”\nto many different problems.\n",
    "Some discrete structures lend themselves to particular styles of proof and some\n83\n\n84\n1.",
    "Logic and Proofs\n“standard” proof techniques can apply to particular structures.",
    "We will see some of\nthis here, but mostly we take this opportunity to remind ourselves of some of the\nbasic definitions and properties for discrete structures, and use the proofs about\nthem to help understand these better.\n",
    "Preview Activity\nIn this preview activity, we will explore some basic properties of sets and functions.\n",
    "Later in this section, we will write proofs about these ideas.\n",
    "1.\nRemember that a set is just a collection of elements.",
    "Here are two definitions\nabout sets:\na.",
    "A set 𝐴is a subset of a set 𝐵, written 𝐴⊆𝐵, provided every element in 𝐴\nis also an element of",
    "𝐵.\nb.",
    "Given sets 𝐴and 𝐵, the union of 𝐴and 𝐵, written 𝐴∪𝐵, is the set\ncontaining every element that is in 𝐴or 𝐵or both.\n",
    "Let’s build some examples.\n",
    "(a) Let 𝐵= {1, 3, 5, 7, 9}.",
    "Give an example of a set 𝐴containing 3 elements\nthat is a subset of 𝐵.\nWhat is 𝐴∪𝐵for the set 𝐴you gave as an example?\n(b) Give an example of two distinct sets 𝐴and 𝐵such that 𝐴∪𝐵= 𝐵.\n",
    "For the example you gave, is 𝐴⊆𝐵?\n(c) Find examples, if they exist, of sets 𝐴and 𝐵such that 𝐴∪𝐵≠𝐵.\nFor the example you gave, is 𝐴⊆𝐵?\n2.\nWhich of the following are always true?\n",
    "A.",
    "For any sets 𝐴and 𝐵, 𝐴∪𝐵⊆𝐵.\nB.",
    "For any sets 𝐴and 𝐵, 𝐵⊆𝐴∪𝐵.\nC. For any sets 𝐴and 𝐵, if 𝐴⊆𝐵, then 𝐴∪𝐵⊆𝐵.\nD. For any sets 𝐴and 𝐵, if 𝐴∪𝐵= 𝐵, then 𝐴⊆𝐵.\n3.\n",
    "For any function 𝑓: ℕ→ℕand any set 𝐴⊆ℕ, we can define the image of 𝐴\nunder 𝑓to be the set of all outputs of 𝑓when the input is an element of 𝐴. We\nwrite this as 𝑓(𝐴) = { 𝑓(𝑥) : 𝑥∈𝐴}.\n",
    "For the following tasks, let’s explore the function 𝑓: ℕ→ℕdefined by\n𝑓(𝑥) = 𝑥2 −3𝑥+ 8.\n(a) Let 𝐴= {1, 2, 3} and 𝐵= {2, 4, 6}.",
    "Find 𝑓(𝐴) and 𝑓(𝐵).",
    "Then find 𝑓(𝐴) ∪\n𝑓(𝐵).\n\n1.5.",
    "Proofs about Discrete Structures\n85\n(b) Now find 𝐴∪𝐵and 𝑓(𝐴∪𝐵).\n",
    "(c) Give an example, if one exists, of two distinct sets 𝐴and 𝐵such that\n𝐴⊆𝐵and 𝑓(𝐴) ⊆𝑓(𝐵).\n",
    "Give an example, if one exists, of two distinct sets 𝐴and 𝐵such that\n𝐴⊆𝐵but 𝑓(𝐴) ⊈𝑓(𝐵).\n",
    "1.5.2\nProofs about Sets\nRecall that a set is an unordered collection of elements.",
    "We can describe a set by\nlisting these elements, or by specifying a property that all elements in the set satisfy.\n",
    "For example,\n𝐴= {1, 2, 3, 4, 5},\nor\n𝐵= {𝑥∈ℕ: 𝑥< 10}.\n",
    "The second set here is the set of natural numbers (0, 1, 2, . . .)",
    "less than 10.",
    "Notice\nthat every element in 𝐴is also an element of 𝐵. Here is a definition that captures\nthat idea.\n",
    "Definition 1.5.1\nA set 𝐴is a subset of a set 𝐵, written 𝐴⊆𝐵, provided every element of 𝐴is\nalso an element of 𝐵.\nThe set 𝐵is sometimes called a superset of 𝐴.\n",
    "We say 𝐴is a proper subset of 𝐵, written 𝐴⊂𝐵, provided 𝐴⊆𝐵and\n𝐴≠𝐵.",
    "In other words, if every element in 𝐴is an element in 𝐵, and there is\nat least one element in 𝐵that is not in 𝐴.\nExample 1.5.2\nLet 𝐴= {𝑥∈ℕ: 𝑥< 5} and 𝐵= {𝑥∈ℕ: 𝑥2 < 10}.",
    "Is 𝐵⊆𝐴?",
    "Is 𝐵a proper\nsubset of 𝐴?\nSolution.\n",
    "We are asking whether every natural number less than 5 is also a\nnatural number whose square is less than 10.",
    "Okay, we could just write out\nthe elements of the sets: 𝐴= {0, 1, 2, 3, 4} and 𝐵= {0, 1, 2, 3} (since 32 = 9\nand 42 = 16).",
    "So 𝐵⊆𝐴. But 𝐵≠𝐴, so in fact 𝐵⊂𝐴.\nThe sets in the example above were small, and it is easy enough to write down\nthe elements of the sets.",
    "However, we can also prove subset relationships between\nsets if this isn’t practical or even possible (perhaps the sets are infinite).",
    "Let’s look\ncarefully at how we could have reasoned about the example above.\n",
    "We claimed that every element of 𝐵was also an element of 𝐴. Another way\nto say this: For all numbers 𝑛, if 𝑛is an element of 𝐵, then 𝑛is also an element of\n𝐴. Recognizing this as a conditional statement, we can proceed to give a direct,\n\n86\n1.",
    "Logic and Proofs\ncontrapositive, or contradiction proof of the fact.",
    "Here a direct proof would be\nperfectly acceptable.",
    "Let’s try it:\nProof.",
    "Let 𝑛be an element of the set 𝐵. Then 𝑛2 < 10, by the definition of 𝐵. Since\n42 = 16, we must have that 𝑛< 4.",
    "By the definition of 𝐴, and the fact that 4 < 5,\nwe see that 𝑛∈𝐴.\nTo be clear, this proof is way more than we would normally do for this example,\nbut its format should be illuminating.",
    "Proving that one set is a subset of another is\nreally the same as proving an implication!\n",
    "To give an example of how we can apply the definition of “subset” in a more\ngeneral setting, let’s prove a basic fact about subsets.\n",
    "Proposition 1.5.3\nFor any sets 𝐴, 𝐵, and 𝐶, if 𝐴⊆𝐵and 𝐵⊆𝐶, then 𝐴⊆𝐶.\nProof.",
    "We will give a direct proof.",
    "Let 𝐴, 𝐵, and 𝐶be sets, and assume that 𝐴⊆𝐵\nand 𝐵⊆𝐶. We will prove that 𝐴⊆𝐶.\nLet 𝑥be an element of 𝐴. Since 𝐴⊆𝐵, we know that 𝑥∈𝐵.",
    "Since 𝐵⊆𝐶, we\nknow that 𝑥∈𝐶. Therefore, 𝐴⊆𝐶.\nNow let’s prove a fact about numbers: Every multiple of 9100 is also a multiple\nof 13.",
    "We could factor 9100, but here is an easier way.",
    "The set of multiples of 9100 is\na subset of the set of multiples of 91.",
    "And the set of multiples of 91 is a subset of the\nset of multiples of 13.",
    "Now apply the proposition above.\n",
    "The proof of Proposition 1.5.3 is what is sometimes called an element chasing\nproof.",
    "By the definition of subset, 𝐴⊆𝐵means every element of 𝐴is an element of\n𝐵, or equivalently, for all 𝑥, if 𝑥is an element of 𝐴, then 𝑥is an element of 𝐵. One\nway to prove this is to “chase” the element 𝑥from 𝐴to 𝐵.\nExample 1.5.4\nProve that if 𝐴⊆𝐵, then 𝐴∪𝐵⊆𝐵. Recall that 𝐴∪𝐵is the union of sets 𝐴\nand 𝐵, and contains all elements that are in 𝐴or 𝐵or both.\nSolution.\n",
    "We will write a direct proof.",
    "So we will assume that 𝐴⊆𝐵and\nprove that 𝐴∪𝐵⊆𝐵. Our desired conclusion is a statement about subsets, so\nlet’s do an element chasing proof for it.\nProof.\n",
    "Let 𝐴and 𝐵be sets and assume 𝐴⊆𝐵. Now let 𝑥be an element in\n𝐴∪𝐵. This means that 𝑥is an element of 𝐴, or 𝑥is an element of 𝐵, or both.3\nConsider the cases.",
    "If 𝑥is an element of 𝐴, then since 𝐴⊆𝐵, we know\nthat 𝑥is an element of 𝐵. On the other hand, if 𝑥is not an element of 𝐴, then\n𝑥must be an element of 𝐵(since 𝑥is in 𝐴∪𝐵).",
    "In either case, 𝑥is an element\nof 𝐵. Therefore, 𝐴∪𝐵⊆𝐵.\n■\nWe can actually prove a strong statement: 𝐴⊆𝐵if and only if 𝐴∪𝐵= 𝐵.\nYou are asked to do this in the exercises.\n\n1.5.",
    "Proofs about Discrete Structures\n87\n1.5.3\nProofs about Functions\nA function 𝑓: 𝐴→𝐵is a rule that assigns each element of the set 𝐴(the domain)\nto exactly one element of the set 𝐵(the codomain).",
    "It is any rule: There doesn’t\nhave to be a formula or rationale for it; we just need to match up elements from 𝐴\nto elements in 𝐵. For example, we could let 𝐴be the set of students enrolled in a\nparticular Discrete Math course and let 𝐵be the set of months of the year.",
    "Now\ndefine the function 𝑓: 𝐴→𝐵to be the rule that assigns to each student the month\nin which their birthday falls.",
    "Since every student has an assigned month, and no\nmore than one month, this is a function.\n",
    "Here is a definition of a particular type of function.\n",
    "Definition 1.5.5\nA function 𝑓: 𝐴→𝐵is injective (or one-to-one) provided every element in\n𝐵is the image of at most one element in 𝐴. In other words, no element in 𝐵is\nthe output for more than one input from 𝐴.\n",
    "In the example below, we use two-line notation to describe a function.",
    "The top\nrow contains the inputs, and the bottom row lists the corresponding outputs.",
    "So\n𝑓: {1, 2, 3, 4} →{𝑎, 𝑏, 𝑐, 𝑑} might be defined as,\n𝑓=\n\u0012\n1\n2\n3\n4\n𝑎\n𝑏\n𝑐\n𝑑\n\u0013\n,\nwhich means that 𝑓(1) = 𝑎, 𝑓(2)",
    "= 𝑏, 𝑓(3)",
    "= 𝑐, and 𝑓(4)",
    "= 𝑑.\nExample 1.5.6\nLet 𝐴= {1, 2, 3} and 𝐵= {2, 4, 6, 8}.",
    "Consider the functions 𝑓: 𝐴→𝐵and\n𝑔: 𝐴→𝐵defined by,\n𝑓=\n\u0012\n1\n2\n3\n2\n8\n6\n\u0013\n,\n𝑔=\n\u0012\n1\n2\n3\n4\n6\n4\n\u0013\n.\n",
    "Which of these functions is injective?\nSolution.\n",
    "The function 𝑓is injective: Each element of 𝐵is the image of at\nmost one element of 𝐴.",
    "The function 𝑔is not injective: The element 4 in 𝐵is\nthe image of both 1 and 3 in 𝐴.\nConsider the student-to-birth-month function again.",
    "Could this possibly be\ninjective?",
    "Or put another way, must there be two students in the course with the\nsame birth month (which would say the function is not injective)?",
    "The answer seems\nto depend on how many students are in the class.\n",
    "5From the definition of union.\n\n",
    "88\n1.",
    "Logic and Proofs\n",
    "But let’s pause and think about the more general fact about functions we have\nhere.",
    "Let’s prove the following fact.",
    "Recall that |𝐴| denotes the cardinality (size) of\nthe set 𝐴: the number of elements in 𝐴.\nProposition 1.5.7\nSuppose 𝑓: 𝐴→𝐵is a function with 𝐴and 𝐵both finite sets.",
    "If |𝐴| > |𝐵|, then 𝑓\nis not injective.\nProof.",
    "We will give a proof of the contrapositive: If 𝑓is injective, then |𝐴| ≤|𝐵|.\n",
    "Let |𝐵| = 𝑛. Since 𝑓is injective, each element of 𝐵must be the output for at most\none element of 𝐴.",
    "Thus there are at most 𝑛elements in 𝐴that get mapped to 𝐵\nby 𝑓.",
    "But the definition of a function requires that every element of the domain\nis mapped to exactly one element of the codomain, so there must be at most 𝑛\nelements in 𝐴.\nDoes this proof remind you of our pigeonhole-like proofs?",
    "It should, since this\nis precisely (one of) the careful formulations of the pigeonhole principle.",
    "We could\nhave proved the fact about students sharing a birth month, but now we can just\napply the proposition above and be done.",
    "When you apply a theorem or proposition\nto directly prove another result, we call the latter result a corollary.\n",
    "Corollary 1.5.8\nSuppose a class has 25 students.",
    "Then at least two students share the same birth\nmonth.\nProof.",
    "Consider the function that maps each student to their birth month.",
    "Since\nthe domain has 25 elements and the codomain has 12 elements, the function is not\ninjective, by Proposition 1.5.7.",
    "Therefore, at least two students share the same birth\nmonth.\n",
    "Functions always have inputs from a set (called the domain) and outputs in a set\nas well (called the codomain).",
    "This naturally leads to facts to consider about the\ninteraction between sets and functions.\n",
    "Definition 1.5.9\nGiven a function 𝑓: 𝑋→𝑌and a set 𝐴⊆𝑋, we define the image of 𝐴under\n𝑓to be the set 𝑓(𝐴) = { 𝑓(𝑎) ∈𝑌: 𝑎∈𝐴}.",
    "That is, 𝑓(𝐴) is the set of all outputs\nof the function for inputs in 𝐴.\nExample 1.5.10\nLet 𝑓: ℕ→ℕbe defined by 𝑓(𝑛) = 2𝑛. Let 𝐴= {1, 2, 3}.",
    "Find 𝑓(𝐴).\n\n1.5.",
    "Proofs about Discrete Structures\n89\nSolution.\n",
    "Evaluate each element of 𝐴by 𝑓.\n𝑓(1)",
    "= 2;\n𝑓(2)",
    "= 4;\n𝑓(3)",
    "= 6.\n",
    "We want the set of these outputs.",
    "So 𝑓(𝐴) = {2, 4, 6}.\n",
    "Now let’s prove something.\n",
    "Proposition 1.5.11\nLet 𝑓: 𝑋→𝑌be a function, and let 𝐴and 𝐵be subsets of 𝑋. If 𝐴⊆𝐵, then\n𝑓(𝐴) ⊆𝑓(𝐵).\n",
    "Proof.",
    "Let 𝑓, 𝐴, and 𝐵be as in the proposition.",
    "Assume that 𝐴⊆𝐵. Now consider\nan element 𝑦∈𝑓(𝐴).",
    "By definition, this means that there is some 𝑎∈𝐴such that\n𝑓(𝑎) = 𝑦. Since 𝑎∈𝐴and 𝐴⊆𝐵, we have that 𝑎∈𝐵.",
    "Then by definition,\n𝑦= 𝑓(𝑎) ∈𝑓(𝐵).\n",
    "Since 𝑦was an arbitrary element of 𝑓(𝐴), we have proved that 𝑓(𝐴) ⊆𝑓(𝐵).\n",
    "Notice that the proof above is an element chasing proof again.",
    "This makes sense\nas soon as you remember that 𝑓(𝐴) and 𝑓(𝐵) are just the names of sets.",
    "To prove\none set is a subset of another, we chase elements from the subset to the superset.\n",
    "1.5.4\nProofs about Relations\nA relation on a set 𝐴is a set of ordered pairs of elements from 𝐴. We can think of\na relation as a way to describe a type of relationship between elements of 𝐴. For\nexample, we might have a relation on the set of people at a party that describes who\nis friends with whom.",
    "We might have a relation on the set of natural numbers that\ndescribes which pairs of numbers are related by the relation 𝑥< 𝑦.\nRelations permeate all of mathematics, often without us even thinking of them.\n",
    "Whenever we make a statement about two elements of a set, we are implicitly\ndefining a relation.",
    "The statement is true when the pair is in the relation.",
    "For\nexample, the statement, “3 is less than 5,” is true because the pair (3, 5) is in the\nrelation <.",
    "In fact, using the language we developed in the subsection Quantifiers\nand Predicates, we can say that a relation is just a predicate, where the variables\ncome from the same set.\n",
    "Often relations have special symbols like “=” or “≤” or “⊥”.",
    "When we talk about\na general relation, we will either use ∼and write 𝑥∼𝑦, or use a capital letter like 𝑅,\nand write 𝑅(𝑥, 𝑦) or 𝑥𝑅𝑦or even (𝑥, 𝑦) ∈𝑅(these all mean the same thing).\n",
    "When we study relations, we try to identify properties that relations might have.\n",
    "Here is an example of a very common property.\n\n",
    "90\n1. Logic and Proofs\nDefinition 1.5.12\nA relation 𝑅on a set 𝐴is transitive provided for all 𝑥, 𝑦, 𝑧∈𝐴, if 𝑥𝑅𝑦and\n𝑦𝑅𝑧, then 𝑥𝑅𝑧.\nExample 1.5.13\nConsider the relation ∼on the set of students in your Discrete Math course\nthat holds of two students, provided they have some other class together.",
    "Is\nthis relation transitive?\nSolution.\n",
    "No, not necessarily (although for some sets of students it could be).\n",
    "For example, suppose Alice has another class with Bruce, say Introduction to\nProgramming.",
    "Carlos is not in Intro to Programming, but he and Bruce are\nboth in Organic Chemistry.",
    "So then Alice∼Bruce and Bruce∼Carlos, but it\nmight not be the case that Alice∼Carlos (since Alice need not be in Organic\nChemistry with Carlos).\n",
    "Proving that a relation is not transitive takes nothing more than finding a\ncounterexample, which means finding three elements 𝑎, 𝑏, and 𝑐such that 𝑎∼𝑏,\n𝑏∼𝑐, but 𝑎/ 𝑐(remember, the only way for an implication to be false is for the\nhypothesis to be true and the conclusion to be false).\n",
    "Perhaps slightly more interesting would be proof that a relation is transitive.\n",
    "Example 1.5.14\nConsider the set of all students in your Discrete Mathematics class, and define\nthe relation ∼that holds of students 𝑎and 𝑏(so 𝑎∼𝑏is true), provided 𝑎is\ntaller than 𝑏. Prove that this relation is transitive.\nSolution.\n",
    "The definition of transitive is an implication, so we can try a direct\nproof.\nProof.\n",
    "Let 𝑎, 𝑏, and 𝑐be arbitrary students in your Discrete Math course.\n",
    "Assume, 𝑎∼𝑏and 𝑏∼𝑐.",
    "That means that 𝑎is taller than 𝑏, and that 𝑏is taller\nthan 𝑐.",
    "But then surely 𝑎must be even taller than 𝑐than they are taller than 𝑏,\nso we have that 𝑎∼𝑐is true as well.",
    "Thus ∼is transitive on this set.\n",
    "■\n1.5.5\nProofs about Graphs\nWe will spend all of Chapter 2 studying proofs about graphs since this is such a rich\narea of mathematics.",
    "As a preview, here is an example of how graph proofs can go.\n",
    "A graph is a set 𝑉of vertices and a set 𝐸of edges.",
    "The edges are two-element\nsubsets of the vertices, and we can think of them as representing relationships\nbetween the vertices.",
    "Note, this is an abstract definition of a graph using sets, but\nwe often draw graphs using dots for the vertices connected by lines for the edges, as\nthis gives us a nice picture of what is going on.\n\n1.5.",
    "Proofs about Discrete Structures\n91\nSince graphs represent a type of relationship between elements (vertices), we\ncan use graphs to represent many real-world problems.",
    "For example, the vertices of\na graph might represent people at a party.",
    "Each edge can represent a handshake\nbetween two people.",
    "So if we wondered whether it is possible for the 15 people at a\nparty to each shake hands with exactly 3 people there, we are really asking whether\nthere is a graph with 15 vertices where each vertex belongs to 3 edges.",
    "(“Belongs\nto”??",
    "Yes, because an edge is a two-element subset of the vertices, so if an edge\n“touches” or “comes out of” a vertex, that means the vertex belongs to that particular\ntwo-element subset.)\n",
    "Here is a definition related to this idea.\n",
    "Definition 1.5.15\nLet 𝑣be a vertex in a graph 𝐺.",
    "The degree of 𝑣, written 𝑑(𝑣), is the number of\nedges that contain 𝑣, i.e., the number of edges incident to 𝑣.\nExample 1.5.16\nConsider the graph 𝐺with vertices𝑉= {1, 2, 3, 4} and edges 𝐸= {{1, 2}, {1, 3}, {1, 4}, {2, 3}}.\n",
    "What is the degree of each vertex in 𝐺?\nSolution.\n",
    "It might be helpful to picture the graph:\n1\n2\n3\n4\nWe have 𝑑(1) = 3, 𝑑(2)",
    "= 2, 𝑑(3) = 2, and 𝑑(4)",
    "= 1.",
    "You can see this by\ncounting how many edges are incident to each vertex, or by counting how\nmany edges (subsets) each vertex belongs to.\n",
    "So is it possible for 15 people to each shake hands with exactly three people in\ntheir group?",
    "Well, is there a graph with 15 vertices, all of degree 3?",
    "The answer is\nno!\n",
    "One way you can see this is if you ask how many edges such a graph would have.\n",
    "Each vertex is incident to three edges, so counting incidences, we get 15 · 3 = 45.",
    "But\nevery edge is incident to two vertices, so we have counted each edge twice.",
    "So the\nnumber of edges in such a graph would be 45/2",
    "= 22.5.",
    "But the number of edges in\na graph must be a whole number, so there is no such graph.\n",
    "This suggests that we can say something more in general.\n",
    "The following\nproposition is a simple consequence of the Handshake Lemma 2.1.8, which we will\nprove in Section 2.1.",
    "Here we give a complete proof of this particular formulation of\nit.\n\n",
    "92\n1.",
    "Logic and Proofs\nProposition 1.5.17\n",
    "In any graph, the number of vertices with odd degree must be even.\n",
    "Proof.",
    "We will prove this by contradiction.",
    "Suppose there was a graph with an\nodd number of vertices with odd degree.",
    "Consider the sum of the degrees of all\nthe vertices.",
    "The sum for the odd-degree vertices would be odd (since the sum of\nan odd number of odd numbers is odd).",
    "The sum of the even-degree vertices will\nbe even (any sum of even numbers must be even).",
    "The sum of an odd number and\nan even number is odd.",
    "Thus the sum of all the degrees will be odd.\n",
    "However, the number of edges in a graph is half the sum of the degrees (by\nLemma 2.1.8, or simply because each edge contributes one to the count of the\ndegree of two vertices).",
    "Since the number of edges is a whole number, we see\nthat the sum of the degrees must be even.",
    "This contradicts what we found in the\nprevious paragraph.\n",
    "Therefore, in any graph, the number of vertices with odd degree must be even.\n",
    "1.5.6\nReading Questions\n1.\nWhich of the following is the definition of a function 𝑓: 𝐴→𝐵being injective?\n",
    "A.",
    "Every element of 𝐵is the image of at most one element of 𝐴.\nB.",
    "The domain 𝐴is a larger set than the codomain 𝐵.\nC. Every element of 𝐴is sent to at most one element of 𝐵.\nD. The codomain 𝐵is no smaller than the domain 𝐴.\n2.\n",
    "When would you most likely use element chasing as part of a proof?\nA.",
    "When proving that one set is a subset of another.\n",
    "B.",
    "When proving that a function is injective.\nC. When proving that a relation is transitive.\nD.",
    "When proving that a graph has an odd number of edges.\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "1.5.7\nPractice Problems\n1.\nGiven sets 𝐴and 𝐵, the intersection of 𝐴and 𝐵, written 𝐴∩𝐵, is the set of all\nelements that are in both 𝐴and 𝐵.\nSuppose you wanted to prove that if 𝐴∩𝐵= 𝐵then 𝐵⊆𝐴.\nWhich would be a good start to this proof if you used a direct proof?\n\n1.5.",
    "Proofs about Discrete Structures\n93\nA. Let 𝑎be an element of 𝐴∩𝐵.\nB. Let 𝑏be an element of 𝐵.\nC. Let 𝑎be an element of 𝐴.\nD. Suppose there is an element 𝑏in",
    "𝐵that is not in 𝐴.\n2.\n",
    "Suppose you wanted to prove that for all sets",
    "𝐴and 𝐵that 𝐴∩𝐵⊆𝐴. Which\nof the following would be a good start to a proof by contradiction?\nA. Suppose there is an element 𝑎in 𝐴that is not in 𝐴∩𝐵.\nB. Suppose there is an element 𝑎in 𝐴∩𝐵that is not in 𝐴.\nC. Let 𝑎be an element of 𝐴.\nD. Let 𝑎be an element of 𝐴∩𝐵.\n3.\n",
    "Arrange some of the statements below to form a correct proof of the following\nstatement: “For any sets 𝐴and 𝐵, if 𝐵⊆𝐴∩𝐵then 𝐵⊆𝐴.”\n•",
    "Therefore 𝐵⊆𝐴∩𝐵\n• Since 𝐴∩𝐵contains all the elements that are in both 𝐴and 𝐵, 𝑏is an\nelement of 𝐴.\n• Then 𝑏is an element of 𝐴∩𝐵since 𝐵⊆𝐴∩𝐵.\n• Let 𝑏be an element of 𝐴∩𝐵.\n• Suppose 𝐵⊆𝐴.\n• Suppose 𝐵⊆𝐴∩𝐵, and let 𝑏be an element of 𝐵.\n• Then 𝑏is an element of 𝐵since 𝐵⊆𝐴∩𝐵.\n• Therefore 𝐵⊆𝐴.\n• Suppose 𝐴⊆𝐵.\n4.\nProve that for any sets 𝐴and 𝐵, (𝐴∩𝐵) ∪𝐴= 𝐴\nArrange the statements below to form a correct proof.\n",
    "•",
    "So in particular, 𝑥is an element of 𝐴.\n• Second, we will prove that 𝐴⊆(𝐴∩𝐵) ∪𝐴.\n• Let 𝑥be an element of (𝐴∩𝐵) ∪𝐴.\n• Therefore 𝐴⊆(𝐴∩𝐵) ∪𝐴.\n• First we will prove that (𝐴∩𝐵) ∪𝐴⊆𝐴.\n\n94\n1.",
    "Logic and Proofs\n• Therefore (𝐴∩𝐵) ∪𝐴⊆𝐴.\n• Since (𝐴∩𝐵) ∪𝐴⊆𝐴and 𝐴⊆(𝐴∩𝐵) ∪𝐴, we have (𝐴∩𝐵) ∪𝐴= 𝐴.\n• Then 𝑥is an element of (𝐴∩𝐵) ∪𝐴, since 𝑥is in 𝐴or in the other set.\n",
    "• Then 𝑥is an element of 𝐴∩𝐵, or 𝑥is an element of 𝐴.\n• Let 𝑥be an element of 𝐴.\n5.\nLet 𝑓: 𝑋→𝑌be a function and let 𝐵⊆𝑌be a subset of the codomain.",
    "Define\nthe inverse image of 𝐵under 𝑓to be the set 𝑓−1(𝐵) = {𝑥∈𝑋: 𝑓(𝑥) ∈𝐵}.",
    "That\nis, it is all the elements in the domain that are mapped to elements in 𝐵.\nProve that if 𝐵1 ⊆𝐵2 are subsets of the codomain, then 𝑓−1(𝐵1) ⊆𝑓−1(𝐵2).\n",
    "Arrange some of the statements below to form a correct proof.\n",
    "•",
    "Thus 𝐵1 ⊆𝐵2.\n",
    "•",
    "This means that 𝑓(𝑎) is an element of 𝐵1.\n",
    "•",
    "Therefore 𝑏is an element of 𝐵2.\n•",
    "Therefore 𝑓−1(𝐵1) ⊆𝑓−1(𝐵2).\n",
    "• Suppose 𝐵1 ⊆𝐵2.\n",
    "•",
    "Since 𝐵1 ⊆𝐵2, 𝑓(𝑎) is an element of 𝐵2.\n",
    "•",
    "This then means that 𝑎is an element of 𝑓−1(𝐵2).\n",
    "• Let 𝑏be an element of 𝐵1.\n",
    "• Let 𝑎be an element of 𝑓−1(𝐵1).\n",
    "1.5.8\nAdditional Exercises\n1.\nProve that for any two sets 𝐴and 𝐵, 𝐴⊆𝐵if and only if 𝐴∪𝐵= 𝐵.\n2.\n",
    "The intersection of sets 𝐴and 𝐵, denoted 𝐴∩𝐵, is the set of all elements that\nare in both 𝐴and 𝐵.\nProve that for any two sets 𝐴and 𝐵, 𝐴⊆𝐵if and only if 𝐴∩𝐵= 𝐴.\n3.\nProve that for any sets 𝐴, 𝐵, and 𝐶, if 𝐴∪𝐵⊆𝐶, then 𝐴⊆𝐶and 𝐵⊆𝐶.\n4.\nProve that for any sets 𝐴, 𝐵, and 𝐶, if 𝐴⊆𝐶and 𝐵⊆𝐶, then 𝐴∪𝐵⊆𝐶.\n5.\n",
    "The difference of sets 𝐴and 𝐵, written 𝐴\\ 𝐵, is the set of all elements that are\nin 𝐴but not in 𝐵.\nThe empty set, written ∅, is the set that contains no elements.\n",
    "Prove that if 𝐴\\ 𝐵= 𝐴then 𝐴∩𝐵= ∅.\n6.\nProve that if 𝐴\\ 𝐵= 𝐵\\ 𝐴then 𝐴= 𝐵.\n\n1.5.",
    "Proofs about Discrete Structures\n95\n7.\nLet 𝑓: 𝑋→𝑌be a function, and let 𝐴and 𝐵be subsets of 𝑋.\n(a) Prove that 𝑓(𝐴∩𝐵) ⊆𝑓(𝐴) ∩𝑓(𝐵).\n",
    "(b) Find an example of a function and two sets 𝐴and 𝐵such that 𝑓(𝐴∩𝐵) ≠\n𝑓(𝐴) ∩𝑓(𝐵).\n",
    "8.\nLet 𝑓: 𝑋→𝑌be a function, and let 𝐴and 𝐵be subsets of 𝑋.\n(a) Prove that 𝑓(𝐴∪𝐵) ⊆𝑓(𝐴) ∪𝑓(𝐵).\n",
    "(b) Prove that 𝑓(𝐴) ∪𝑓(𝐵) ⊆𝑓(𝐴∪𝐵)\n(c)",
    "What can you conclude from the two proofs above?\n9.\n",
    "Given a function 𝑓: 𝑋→𝑌and a set 𝐵⊆𝑌, we define the inverse image of 𝐵\nunder 𝑓as the set 𝑓−1(𝐵) = {𝑥∈𝑋: 𝑓(𝑥)",
    "∈𝐵.",
    "That is, it is all the elements in\nthe domain that are mapped to elements in 𝐵.\n(a) For 𝑓: ℕ→ℕdefined by 𝑓(𝑛) = 𝑛2, what are each of the following sets?\n(a) 𝑓−1({1, 4, 9})\n(b) 𝑓−1({2, 3, 5, 7})\n(c) 𝑓−1({1, 2, . . .",
    ", 10})\n(b) Prove that for any set 𝐶⊆𝑋, 𝐶⊆𝑓−1( 𝑓(𝐶)).\n",
    "(c) Give an example of a function 𝑓and a set 𝐶such that 𝐶≠𝑓−1( 𝑓(𝐶)).\n",
    "(d) Prove that for any set 𝐷⊆𝑌, 𝑓( 𝑓−1(𝐷))",
    "⊆𝐷.\n(e) Give an example of a function 𝑓and a set 𝐷such that 𝑓( 𝑓−1(𝐷))",
    "≠𝐷.\n10.\n",
    "Let 𝑓: 𝑋→𝑌be a function, and let 𝐴and 𝐵be subsets of 𝑌. Prove that\n𝑓−1(𝐴∩𝐵) = 𝑓−1(𝐴) ∩𝑓−1(𝐵).\n",
    "11.\nLet 𝑓: 𝑋→𝑌be a function, and let 𝐴and 𝐵be subsets of 𝑌. Prove that\n𝑓−1(𝐴∪𝐵) = 𝑓−1(𝐴) ∪𝑓−1(𝐵).\n",
    "12.\n",
    "For each relation below, determine whether it is transitive.",
    "If it is, prove it.",
    "If it\nis not, give a counterexample.\n",
    "(a) The relation “|” (divides) on ℤdefined by 𝑎|𝑏provided 𝑏is a multiple of\n𝑎.\n(b) The relation “≤” (less than or equal to) on ℝ.\n(c)",
    "The relation “⊥” (is perpendicular to) on the set of lines in the plane.\n",
    "(d)",
    "The relation “∼” (is similar to) on the set of triangles in the plane (two\ntriangles are similar if they have the same angles, but are not necessarily\nthe same size).\n\n",
    "1.6\nChapter Summary\nWe have considered logic both as its own sub-discipline of mathematics and as a\nmeans to help us better understand and write proofs.",
    "We noticed that mathematical\nstatements have a particular logical form, and analyzing that form can help make\nsense of the statement.\n",
    "At the most basic level, a statement might combine simpler statements using\nlogical connectives.",
    "We often make use of variables and quantify over those variables.\n",
    "How to resolve the truth or falsity of a statement based on these connectives and\nquantifiers is what logic is all about.",
    "From this, we can decide whether two statements\nare logically equivalent or if one or more statements (logically) imply another.\n",
    "When writing proofs (in any area of mathematics) our goal is to explain why\na mathematical statement is true.",
    "Thus it is vital that our argument implies the\ntruth of the statement.",
    "To be sure of this, we first must know what it means for the\nstatement to be true, as well as ensure that the statements that make up the proof\ncorrectly imply the conclusion.",
    "A firm understanding of logic is required to check\nwhether a proof is correct.\n",
    "There is, however, another reason that understanding logic can be helpful.\n",
    "Understanding the logical structure of a statement often gives clues for how to write\na proof of the statement.\n",
    "This is not to say that writing proofs is always straight-forward.",
    "Consider again\nthe Goldbach conjecture:\n",
    "Every even number greater than 2 can be written as the sum of two\nprimes.\n",
    "We are not going to try to prove the statement here, but we can at least say what a\nproof might look like, based on the logical form of the statement.",
    "Perhaps we should\nwrite the statement to highlight the quantifiers and connectives:\nFor all integers 𝑛, if 𝑛is even and greater than 2, then there exist integers\n𝑝and 𝑞such that 𝑝and 𝑞are prime, and 𝑛= 𝑝+ 𝑞.\n",
    "What would a direct proof look like?",
    "Since the statement starts with a universal\nquantifier, we would start, ``Let 𝑛be an arbitrary integer.\"",
    "The rest of the statement\nis an implication.",
    "In a direct proof we assume the “if” part, so the next line would\nbe, “Assume 𝑛is greater than 2 and is even.”",
    "I have no idea what comes next, but\neventually, we would need to find two prime numbers 𝑝and 𝑞(depending on 𝑛)\nand explain how we know that 𝑛= 𝑝+ 𝑞.\n",
    "Or maybe we try a proof by contradiction.",
    "To do this, we first assume the\nnegation of the statement we want to prove.",
    "What is the negation?",
    "From what we\nhave studied we should be able to see that it is,\nThere is an integer 𝑛such that 𝑛is even and greater than 2, but for all\nintegers 𝑝and 𝑞, either 𝑝or 𝑞is not prime, or 𝑛≠𝑝+ 𝑞.\nCould this statement be true?",
    "A proof by contradiction would start by assuming it\nwas and eventually conclude with a contradiction, proving that our assumption of\n96\n\n1.6.",
    "Chapter Summary\n97\ntruth was incorrect.",
    "And if you can find such a contradiction, you will have proved\none of the most famous open problems in mathematics.",
    "Good luck.\n",
    "Chapter Review\n1.\nComplete a truth table for the statement ¬𝑃→(𝑄∧𝑅).\n",
    "2.\nSuppose you know that the statement “if Peter is not tall, then Quincy is fat\nand Robert is skinny” is false.",
    "What, if anything, can you conclude about Peter\nand Robert if you know that Quincy is indeed fat?",
    "Explain (you may reference\nQuestion 1.6.1).\n",
    "3.\nAre the statements 𝑃→(𝑄∨𝑅) and (𝑃→𝑄) ∨(𝑃→𝑅) logically equivalent?\nExplain your answer.\n",
    "4.\nIs the following a valid deduction rule?",
    "Explain.\n",
    "𝑃→𝑄\n𝑃→𝑅\n∴\n𝑃→(𝑄∧𝑅).\n",
    "5.\nWrite the negation, converse and contrapositive for each of the statements\nbelow.\n",
    "(a) If the power goes off, then the food will spoil.\n",
    "(b) If the door is closed, then the light is off.\n",
    "(c) ∀𝑥(𝑥< 1 →𝑥2 < 1).\n",
    "(d) For all natural numbers 𝑛, if 𝑛is prime, then 𝑛is solitary.\n",
    "(e) For all functions 𝑓, if 𝑓is differentiable, then 𝑓is continuous.\n",
    "(f)",
    "For all integers 𝑎and 𝑏, if 𝑎· 𝑏is even, then 𝑎and 𝑏are even.\n",
    "(g) For every integer 𝑥and every integer 𝑦, there is an integer 𝑛such that if\n𝑥> 0",
    "then 𝑛𝑥> 𝑦.\n(h) For all real numbers 𝑥and 𝑦, if 𝑥𝑦= 0 then 𝑥= 0 or 𝑦= 0.\n",
    "(i) For every student in Math 228, if they do not understand implications,\nthen they will fail the exam.\n",
    "6.\nConsider the statement, “For all integers 𝑛, if 𝑛is even and 𝑛≤7, then 𝑛is\nnegative or 𝑛∈{0, 2, 4, 6}.”\n(a) Is the statement true?",
    "Explain why.\n",
    "(b) Write the negation of the statement.",
    "Is it true?",
    "Explain.\n",
    "(c) State the contrapositive of the statement.",
    "Is it true?",
    "Explain.\n\n",
    "98\n1.",
    "Logic and Proofs\n(d)",
    "State the converse of the statement.",
    "Is it true?",
    "Explain.\n",
    "7.\nConsider the statement: ∀𝑥(∀𝑦(𝑥+ 𝑦= 𝑦) →∀𝑧(𝑥· 𝑧= 0)).\n",
    "(a) Explain what the statement says in words.",
    "Is this statement true?",
    "Be sure\nto state what you are taking the universe of discourse to be.\n",
    "(b) Write the converse of the statement, both in words and in symbols.",
    "Is the\nconverse true?\n(c) Write the contrapositive of the statement, both in words and in symbols.\n",
    "Is the contrapositive true?\n(d) Write the negation of the statement, both in words and in symbols.",
    "Is the\nnegation true?\n8.\nSimplify the following.\n",
    "(a) ¬(¬(𝑃∧¬𝑄) →¬(¬𝑅∨¬(𝑃→𝑅))).\n",
    "(b) ¬∃𝑥¬∀𝑦¬∃𝑧(𝑧= 𝑥+ 𝑦→∃𝑤(𝑥−𝑦= 𝑤)).\n",
    "9.\nConsider the statement, “For all integers 𝑛, if 𝑛is odd, then 7𝑛is odd.”\n(a) Prove the statement.",
    "What sort of proof are you using?\n(b) Prove the converse.",
    "What sort of proof are you using?\n10.\n",
    "Suppose you break your piggy bank and scoop up a handful of 22 coins\n(pennies, nickels, dimes, and quarters).\n",
    "(a) Prove that you must have at least 6 coins of a single denomination.\n",
    "(b) Suppose you have an odd number of pennies.",
    "Prove that you must have\nan odd number of at least one of the other types of coins.\n",
    "(c) How many coins would you need to scoop up to be sure that you either\nhad 4 coins that were all the same or 4 coins that were all different?",
    "Prove\nyour answer.\n",
    "11.\n",
    "You come across four trolls playing bridge.",
    "They declare:\nTroll 1: All trolls here see at least one knave.\n",
    "Troll 2: I see at least one troll that sees only knaves.\n",
    "Troll 3: Some trolls are scared of goats.\n",
    "Troll 4: All trolls are scared of goats.\n",
    "Are there any trolls that are not scared of goats?",
    "Recall, of course, that all trolls\nare either knights (who always tell the truth) or knaves (who always lie).\n\n",
    "Chapter 2\nGraph Theory\nGraph theory has existed as a branch of mathematics for only a short time; the\nfirst book on graph theory was published less than 100 years ago.",
    "While the first\nproblem related to what we now call graph theory dates back to 1735, it has been\nthe advent of computers that has shown the subject’s true utility.",
    "It is a subject with\nsimple beauty and surprising depth.",
    "Many of the main areas of graph theory can\nbe understood with almost no mathematical prerequisites, yet new research in the\nsubject generates hundreds of peer-reviewed research papers each year.\n",
    "In this chapter, we will explore just a few of the ways you can use graphs and\ntheir properties to solve problems that show up in computer science, mathematics,\nand almost every other applied science.\n",
    "2.1\nProblems and Definitions\nObjectives\nAfter completing this section",
    ", you should be able to do the following.\n",
    "1. Use the language of graph theory to describe properties of graphs.\n",
    "2. Utilize multiple representations of graphs.\n",
    "3. Apply the Handshake Lemma to answer questions about graphs and\nproblems they represent.\n",
    "99\n\n100\n2.",
    "Graph Theory\n2.1.1\nSection Preview\nInvestigate!\n",
    "In the time of Euler, in the town of Königsberg in Prussia, there was a river\ncontaining two islands.",
    "The islands were connected to the banks of the river\nby seven bridges (as seen below).",
    "The bridges were very beautiful, and on\ntheir days off, townspeople would spend time walking over the bridges.\n",
    "As time passed, a question arose: Was it possible to plan a walk so that\nyou cross each bridge once and only once?",
    "Euler was able to answer this\nquestion.",
    "Are you?\nGraph Theory is a relatively new area of mathematics, first studied by the super\nfamous mathematician Leonhard Euler in 1735.",
    "Since then it has blossomed into a\npowerful tool used in nearly every branch of science and is currently an active area\nof mathematics research.\n",
    "The problem above, known as the Seven Bridges of Königsberg, is the problem\nthat originally inspired graph theory.",
    "Consider a “different” problem: Below is a\ndrawing of four dots connected by some lines.",
    "Is it possible to trace over each line\nonce and only once (without lifting your pencil, starting and ending on a dot)?\n",
    "There is an obvious connection between these two problems.",
    "Any path in the\ndot and line drawing corresponds exactly to a path over the bridges of Königsberg.\n",
    "Pictures like this dot and line drawing are called graphs (although technically,\nthe picture above is a multigraph).",
    "Graphs are made up of a collection of dots\ncalled vertices and lines connecting those dots called edges.",
    "When two vertices\nare connected by an edge, we say they are adjacent.",
    "The nice thing about looking\nat graphs instead of pictures of rivers, islands, and bridges is that we now have a\nmathematical object to study.",
    "We have distilled the “important” parts of the bridge\n\n2.1.",
    "Problems and Definitions\n101\npicture for the problem.",
    "It does not matter how big the islands are, what the bridges\nare made out of, if the river contains alligators, etc.",
    "All that matters is which land\nmasses are connected to which other land masses, and how many times.",
    "This was\nthe great insight Euler had.\n",
    "We will return to the question of finding paths through graphs in Section 2.4.",
    "In\nthis section, we will explore various ways that graphs can be used to represent, or\nmodel, real-world problems.",
    "Along the way, we will introduce some basic definitions,\nterminology, and notation that will be used in the rest of the chapter.\n",
    "Preview Activity\nTo get a feel for graphs and the types of questions we want to ask about them, let’s\nexplore four examples of graphs.\n",
    "𝐺1:\n𝐺2:\n𝑣6\n𝑣1\n𝑣2\n𝑣5\n𝑣4\n𝑣3\n𝐺3:\n𝐺4:\nvertex\nadjacent to\n𝑎\n𝑏, 𝑐\n𝑏\n𝑎, 𝑓\n𝑐\n𝑎, 𝑑, 𝑒\n𝑑\n𝑐, 𝑒, 𝑓\n𝑒\n𝑐, 𝑑\n𝑓\n𝑏, 𝑑\n©­­­­­­­­\n«\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n1\n0\n0\n1\n0\n0\n0\n1\n0\n1\n0\n0\nª®®®®®®®®\n¬\nThe graph 𝐺3 is presented as an adjacency list where each vertex gets a list of\nwhich other vertices it is adjacent to.",
    "The graph 𝐺4 is presented as an adjacency\nmatrix where the rows and columns correspond to the vertices and the entries are 1\nif the vertices are adjacent and 0 otherwise.",
    "Before answering the questions below, it\nmight be helpful to draw a more traditional representation of these graphs.\n",
    "1.\nFirst, let’s count the number of vertices and edges in each graph.\n",
    "2.\n",
    "We call the number of edges incident to a particular vertex (i.e., the number of\nedges “coming out of” the vertex) the degree of the vertex.",
    "A list of the degrees\nof all the vertices in non-increasing order is called a degree sequence for the\ngraph.",
    "Find the degree sequence for each graph.\n\n102\n2.",
    "Graph Theory\n3.\n",
    "We often care about paths between vertices in a graph.",
    "A graph is connected\nif there is a path between every pair of vertices.",
    "Sometimes there is a path that\nstarts at a vertex and eventually comes back to itself, which is called a cycle.\n",
    "(a) Which of the graphs are connected?\n(b) Which of the graphs contain cycles?\n(c) Graphs that are connected and contain no cycles are called trees.",
    "For\neach graph, how many edges must you remove to turn it into a tree?",
    "(If it\nis already a tree, the answer would be 0.)\n",
    "4.\nFor which of the graphs is it possible to draw the graph in such a way that no\nedges cross?\n5.\n",
    "Suppose we color each vertex of a graph so that adjacent vertices always have\ndifferent colors.",
    "The smallest number of colors needed to do this is called the\nchromatic number of the graph.",
    "Find the chromatic number for each graph.\n",
    "Note: If the graphs represented friendships between people, then the\nchromatic number would tell us the minimum number of groups we would\nneed if we wanted to divide up everyone into groups of people who were not\nyet friends.\n",
    "2.1.2\nWhat is a Graph?\nBefore we start studying graphs, we need to agree upon what a graph is.",
    "While we\nalmost always think of graphs as pictures (dots connected by lines), this is fairly\nambiguous.",
    "Do the lines need to be straight?",
    "Does it matter how long the lines are\nor how large the dots are?",
    "Can there be two lines connecting the same pair of dots?\n",
    "Can one line connect three dots?\n",
    "The way we avoid ambiguities in mathematics is to provide concrete and rigorous\ndefinitions.",
    "Crafting good definitions is not easy, but it is incredibly important.",
    "The\ndefinition is the agreed-upon starting point from which all truths in mathematics\nproceed.",
    "Is there a graph with no edges?",
    "We have to look at the definition to see if\nthis is possible.\n",
    "We want our definition to be precise and unambiguous, but it also must agree\nwith our intuition for the objects we are studying.",
    "It needs to be useful: We could\ndefine a graph to be a six-legged mammal, but that would not let us solve any\nproblems about bridges.",
    "Instead, here is the (now) standard definition of a graph.\n",
    "Definition 2.1.1 Graph.\n",
    "A graph is an ordered pair 𝐺= (𝑉, 𝐸) consisting of a nonempty set 𝑉(called\nthe vertices) and a set 𝐸(called the edges) of two-element subsets of 𝑉.\nStrange.",
    "Nowhere in the definition is there talk of dots or lines.",
    "From the\n\n2.1.",
    "Problems and Definitions\n103\ndefinition, a graph could be\n({𝑎, 𝑏, 𝑐, 𝑑}, {{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑏, 𝑐}, {𝑏, 𝑑}, {𝑐, 𝑑}}).\n",
    "Here we have a graph with four vertices (the letters 𝑎, 𝑏, 𝑐, 𝑑) and five edges (the\npairs {𝑎, 𝑏}, {𝑎, 𝑐}, {𝑏, 𝑐}, {𝑏, 𝑑}, {𝑐, 𝑑})).\n",
    "Looking at sets and sets of 2-element sets is difficult to process.",
    "That is why\nwe often draw a representation of these sets.",
    "We put a dot down for each vertex,\nand connect two dots with a line precisely when those two vertices are one of the\n2-element subsets in our set of edges.",
    "Thus one way to draw the graph described\nabove is this:\n𝑎\n𝑏\n𝑐\n𝑑\n",
    "However we could also have drawn the graph differently.",
    "For example either of\nthese:\n𝑎\n𝑏\n𝑐\n𝑑\n𝑎\n𝑏\n𝑐\n𝑑\nWe should be careful about what it means for two graphs to be “the same.”\n",
    "Actually, given our definition, this is easy: Are the vertex sets equal?",
    "Are the edge\nsets equal?",
    "We know what it means for sets to be equal, and graphs are nothing but\na pair of two special sorts of sets.\n",
    "Example 2.1.2\nAre the graphs below equal?\n",
    "𝐺1 = ({𝑎, 𝑏, 𝑐}, {{𝑎, 𝑏}, {𝑏, 𝑐}});\n𝐺2 = ({𝑎, 𝑏, 𝑐}, {{𝑎, 𝑐}, {𝑐, 𝑏}}).\n",
    "Solution.\n",
    "No.",
    "Here the vertex sets of each graph are equal, which is a\ngood start.",
    "Also, both graphs have two edges.",
    "In the first graph, we have\nedges {𝑎, 𝑏} and {𝑏, 𝑐}, while in the second graph we have edges {𝑎, 𝑐} and\n{𝑐, 𝑏}.",
    "Of course, {𝑏, 𝑐} = {𝑐, 𝑏}, so that is not the problem.",
    "The issue is that\n{𝑎, 𝑏} ≠{𝑎, 𝑐}.",
    "Since the edge sets of the two graphs are not equal (as sets),\nthe graphs are not equal (as graphs).\n",
    "Even if two graphs are not equal, they might be basically the same.",
    "The graphs in\nthe previous example could be drawn like this:\n\n104\n2.",
    "Graph Theory\n𝑎\n𝑏\n𝑐\n𝐺1\n𝑏\n𝑐\n𝑎\n𝐺2\nGraphs that are basically the same (but perhaps not equal) are called isomorphic.\n",
    "We will give a precise definition of this term after a quick example:\nExample 2.1.3\nConsider the graphs:\n𝐺1 = (𝑉1, 𝐸1) where 𝑉1 = {𝑎, 𝑏, 𝑐} and 𝐸1 = {{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑏, 𝑐}};\n𝐺2 = (𝑉2, 𝐸2) where 𝑉2 = {𝑢, 𝑣, 𝑤} and 𝐸2 = {{𝑢, 𝑣}, {𝑢, 𝑤}, {𝑣, 𝑤}}.\n",
    "Are these graphs the same?\nSolution.\n",
    "The two graphs are NOT equal.",
    "It is enough to notice that 𝑉1 ≠𝑉2\nsince 𝑎∈𝑉1 but 𝑎∉𝑉2.",
    "However, both of these graphs consist of three vertices\nwith edges connecting every pair of vertices.",
    "We can draw them as follows:\n𝑎\n𝑏\n𝑐\n𝑢\n𝑣\n𝑤\nClearly we want to say these graphs are basically the same, so while they\nare not equal, they will be isomorphic.",
    "We can rename the vertices of one\ngraph and get the second graph as the result.\n",
    "Intuitively, graphs are isomorphic if they are basically the same, or better yet,\nif they are the same except for the names of the vertices.",
    "To make the concept of\nrenaming vertices precise, we give the following definitions:\nDefinition 2.1.4\nAn isomorphism between two graphs 𝐺1 and 𝐺2 is a bĳection 𝑓: 𝑉1 →𝑉2\nbetween the vertices of the graphs such that {𝑎, 𝑏} is an edge in 𝐺1 if and only\nif { 𝑓(𝑎), 𝑓(𝑏)} is an edge in 𝐺2.\n",
    "Two graphs are isomorphic if there is an isomorphism between them.",
    "In\nthis case we write 𝐺1 \u001b 𝐺2.\n",
    "An isomorphism is simply a function which renames the vertices.",
    "It must be\na bĳection so every vertex gets a new name.",
    "These newly named vertices must be\nconnected by edges precisely when they were connected by edges with their old\nnames.\n\n",
    "2.1.",
    "Problems and Definitions\n105\nExample 2.1.5\nDecide whether the graphs 𝐺1 = (𝑉1, 𝐸1) and 𝐺2 = (𝑉2, 𝐸2) are equal or\nisomorphic.\n",
    "𝑉1 = {𝑎, 𝑏, 𝑐, 𝑑}, 𝐸1 = {{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑎, 𝑑}, {𝑐, 𝑑}}\n𝑉2 = {𝑎, 𝑏, 𝑐, 𝑑}, 𝐸2 = {{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑏, 𝑐}, {𝑐, 𝑑}}\nSolution.\n",
    "The graphs are NOT equal, since {𝑎, 𝑑} ∈𝐸1 but {𝑎, 𝑑} ∉𝐸2.\nHowever, since both graphs contain the same number of vertices and the\nsame number of edges, they might be isomorphic (this is not enough in most\ncases, but it is a good start).\n",
    "We can try to build an isomorphism.",
    "How about we say 𝑓(𝑎) = 𝑏, 𝑓(𝑏) = 𝑐,\n𝑓(𝑐) = 𝑑and 𝑓(𝑑) = 𝑎.",
    "This is definitely a bĳection, but to make sure that the\nfunction is an isomorphism, we must make sure it respects the edge relation.",
    "In\n𝐺1, vertices 𝑎and 𝑏are connected by an edge.",
    "In 𝐺2, 𝑓(𝑎) = 𝑏and 𝑓(𝑏) = 𝑐\nare connected by an edge.",
    "So far, so good, but we must check the other three\nedges.",
    "The edge {𝑎, 𝑐} in 𝐺1 corresponds to { 𝑓(𝑎), 𝑓(𝑐)} = {𝑏, 𝑑}, but here we\nhave a problem.",
    "There is no edge between 𝑏and 𝑑in 𝐺2.",
    "Thus 𝑓is NOT an\nisomorphism.\n",
    "Not all hope is lost, however.",
    "Just because 𝑓is not an isomorphism does\nnot mean that there is no isomorphism at all.",
    "We can try again.",
    "At this point\nit might be helpful to draw the graphs to see how they should match up.\n",
    "𝑎\n𝑏\n𝑐\n𝑑\n𝐺1:\n𝑎\n𝑏\n𝑐\n𝑑\n𝐺2:\nAlternatively, notice that in 𝐺1, the vertex 𝑎is adjacent to every other\nvertex.",
    "In 𝐺2, there is also a vertex with this property: 𝑐.",
    "So build the bĳection\n𝑔: 𝑉1 →𝑉2 by defining 𝑔(𝑎) = 𝑐to start with.",
    "Next, where should we send\n𝑏?",
    "In 𝐺1, the vertex 𝑏is only adjacent to vertex 𝑎.",
    "There is exactly one vertex\nlike this in 𝐺2, namely 𝑑. So let 𝑔(𝑏) = 𝑑. As for the last two, in this example,\nwe have a free choice: let 𝑔(𝑐) = 𝑏and 𝑔(𝑑)",
    "= 𝑎(switching these would be\nfine as well).\n",
    "We should check that this really is an isomorphism.",
    "It is definitely a\nbĳection.",
    "We must make sure that the edges are respected.",
    "The four edges in\n𝐺1 are\n{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑎, 𝑑}, {𝑐, 𝑑}.\n",
    "Under the proposed isomorphism these become\n{𝑔(𝑎), 𝑔(𝑏)}, {𝑔(𝑎), 𝑔(𝑐)}, {𝑔(𝑎), 𝑔(𝑑)}, {𝑔(𝑐), 𝑔(𝑑)}\n{𝑐, 𝑑}, {𝑐, 𝑏}, {𝑐, 𝑎}, {𝑏, 𝑎},\n\n106\n2.",
    "Graph Theory\nwhich are precisely the edges in 𝐺2.",
    "Thus 𝑔is an isomorphism, so 𝐺1 \u001b 𝐺2\nSometimes we will talk about a graph with a special name (like 𝐾𝑛or the Petersen\ngraph) or perhaps draw a graph without any labels.",
    "In this case, we are really\nreferring to all graphs isomorphic to any copy of that particular graph.",
    "A collection\nof isomorphic graphs is often called an isomorphism class.1\nThere are other relationships between graphs that we care about, other than\nequality and being isomorphic.",
    "For example, compare the following pair of graphs:\nThese are definitely not isomorphic, but notice that the graph on the right looks\nlike it might be part of the graph on the left, especially if we draw it like this:\nWe would like to say that the smaller graph is a subgraph of the larger.\n",
    "We should give a careful definition of this.",
    "In fact, there are two reasonable\nnotions for what a subgraph should mean.\n",
    "Definition 2.1.6 Subgraphs.\n",
    "We say that 𝐺′ = (𝑉′, 𝐸′) is a subgraph of 𝐺= (𝑉, 𝐸), and write 𝐺′ ⊆𝐺,\nprovided 𝑉′ ⊆𝑉and 𝐸′ ⊆𝐸.\nWe say that 𝐺′ = (𝑉′, 𝐸′) is an induced subgraph of 𝐺= (𝑉, 𝐸) provided\n𝑉′ ⊆𝑉and every edge in 𝐸whose vertices are still in 𝑉′ is also an edge in 𝐸′.\nNotice that every induced subgraph is also an ordinary subgraph, but not\nconversely.",
    "Think of a subgraph as the result of deleting some vertices and edges\nfrom the larger graph.",
    "For the subgraph to be an induced subgraph, we can still\ndelete vertices, but now we only delete those edges that included the deleted vertices.\n",
    "1This is not unlike geometry, where we might have more than one copy of a particular triangle.\n",
    "There instead of isomorphic we say congruent.\n\n2.1.",
    "Problems and Definitions\n107\nExample 2.1.7\nConsider the graphs:\n𝑎\n𝑏\n𝑐\n𝑒\n𝑑\n𝑓\n𝐺1\n𝑎\n𝑏\n𝑐\n𝑑\n𝐺2\n𝑎\n𝑏\n𝑐\n𝑑\n𝑓\n𝐺3\n𝑎\n𝑏\n𝑐\n𝑑\n𝑓\n𝐺4\nHere both 𝐺2 and 𝐺3 are subgraphs of 𝐺1.",
    "But only 𝐺2 is an induced\nsubgraph.",
    "Every edge in 𝐺1 that connects vertices in 𝐺2 is also an edge in 𝐺2.\n",
    "In 𝐺3, the edge {𝑎, 𝑏} is in 𝐸1 but not 𝐸3, even though vertices 𝑎and 𝑏are in\n𝑉3.\n",
    "The graph 𝐺4 is NOT a subgraph of 𝐺1, even though it looks like all we\ndid is remove vertex 𝑒.",
    "The reason is that in 𝐸4 we have the edge {𝑐, 𝑓}, but\nthis is not an element of 𝐸1, so we don’t have the required 𝐸4 ⊆𝐸1.\n",
    "Back to some basic graph theory definitions.",
    "Notice that all the graphs we have\ndrawn above have the property that no pair of vertices is connected more than once,\nand no vertex is connected to itself.",
    "Graphs like these are sometimes called simple,\nalthough we will just call them graphs.",
    "This is because our definition of a graph\nsays that the edges form a set of 2-element subsets of the vertices.",
    "Remember that it\ndoesn’t make sense to say a set contains an element more than once.",
    "So no pair of\nvertices can be connected by an edge more than once.",
    "Also, since each edge must be\na set containing two vertices, we cannot have a single vertex connected to itself by\nan edge.\n",
    "That said, there are times we want to consider double (or more) edges and single-\nedge loops.",
    "For example, the “graph” we drew for the Bridges of Königsberg problem\nhad double edges because there really are two bridges connecting a particular island\nto the near shore.",
    "We will call these objects multigraphs.",
    "This is a good name: A\nmultiset is a set in which we are allowed to include a single element multiple times.\n",
    "The graphs above are also connected: you can get from any vertex to any other\nvertex by following some path of edges.",
    "A graph that is not connected can be\nthought of as two separate graphs drawn close together.",
    "For example, the following\ngraph is NOT connected because there is no path from 𝑎to 𝑏:\n𝑎\n𝑏\nVertices in a graph do not always have edges between them.",
    "If we add all possible\nedges, then the resulting graph is called complete.",
    "That is, a graph is complete\n\n108\n2.",
    "Graph Theory\nif every pair of vertices is connected by an edge.",
    "Since a graph is determined\ncompletely by which vertices are adjacent to which other vertices, there is only one\ncomplete graph with a given number of vertices.",
    "We give these a special name: 𝐾𝑛\nis the complete graph on 𝑛vertices.\n",
    "Each vertex in 𝐾𝑛is adjacent to 𝑛−1 other vertices.",
    "We call the number of edges\nemanating from a given vertex the degree of that vertex.",
    "So every vertex in 𝐾𝑛has\ndegree 𝑛−1.",
    "How many edges does 𝐾𝑛have?",
    "One might think the answer should\nbe 𝑛(𝑛−1), since we count 𝑛−1 edges 𝑛times (once for each vertex).",
    "However, each\nedge is incident to 2 vertices, so we counted every edge exactly twice.",
    "Thus there\nare 𝑛(𝑛−1)/2 edges in 𝐾𝑛.",
    "Alternatively, we can say there are \u0000𝑛\n2\n\u0001 edges, since to\ndraw an edge we must choose 2 of the 𝑛vertices.\n",
    "In general, if we know the degrees of all the vertices in a graph, we can find the\nnumber of edges.",
    "The sum of the degrees of all vertices will always be twice the\nnumber of edges, since each edge adds to the degree of two vertices.",
    "Notice this\nmeans that the sum of the degrees of all vertices in any graph must be even!\n",
    "This is our first example of a general result about all graphs.",
    "It seems innocent\nenough, but we will use it to prove all sorts of other statements.",
    "So let’s give it a\nname and state it formally.\n",
    "Lemma 2.1.8 Handshake Lemma.\n",
    "In any graph, the sum of the degrees of vertices in the graph is always twice the\nnumber of edges.\n",
    "The handshake lemma2 is sometimes called the degree sum formula, and can be\nwritten symbolically as\nÕ\n𝑣∈𝑉\n𝑑(𝑣)",
    "= 2𝑒.\n",
    "Here we are using the notation 𝑑(𝑣) for the degree of the vertex 𝑣.\nOne use for the lemma is to actually find the number of edges in a graph.",
    "To\ndo this, you must be given the degree sequence for the graph (or be able to find it\nfrom other information).",
    "This is a list of every degree of every vertex in the graph,\ngenerally written in non-increasing order.\n",
    "Example 2.1.9\nHow many vertices and edges must a graph have if its degree sequence is\n(4, 4, 3, 3, 3, 2, 1)?\n",
    "Solution.\n",
    "The number of vertices is easy to find.",
    "It is the number of degrees\nin the sequence: 7. To find the number of edges, we compute the degree sum\n4 + 4 + 3 + 3 + 3 + 2 + 1 = 20,\n2A lemma is a mathematical statement that is primarily of importance in that it is used to establish\nother results.\n\n",
    "2.1.",
    "Problems and Definitions\n109\nso the number of edges is half this: 10.\n",
    "The handshake lemma also tells us what is not possible.\n",
    "Example 2.1.10\nAt a recent math seminar, 9 mathematicians greeted each other by shaking\nhands.",
    "Is it possible that each mathematician shook hands with exactly 7\npeople at the seminar?\nSolution.\n",
    "It seems like this should be possible.",
    "Each mathematician chooses\none person to not shake hands with.",
    "But this cannot happen.",
    "We are asking\nwhether a graph with 9 vertices can have each vertex have degree 7.",
    "If such a\ngraph existed, the sum of the degrees of the vertices would be 9 · 7 = 63.",
    "This\nwould be twice the number of edges (handshakes) resulting in a graph with\n31.5 edges.",
    "That is impossible.",
    "Thus at least one (in fact an odd number) of\nthe mathematicians must have shaken hands with an even number of people\nat the seminar.\n",
    "We can generalize the previous example to get the following proposition.3\nProposition 2.1.11\nIn any graph, the number of vertices with odd degree must be even.\n",
    "Proof.\n",
    "Suppose there were a graph with an odd number of vertices with odd\ndegree.\n",
    "Then the sum of the degrees in the graph would be odd, which is\nimpossible, by the handshake lemma.\n",
    "We will consider further applications of the handshake lemma in the exercises.\n",
    "One final definition: We say a graph is bipartite if the vertices can be divided\ninto two sets, 𝐴and 𝐵, with no two vertices in 𝐴adjacent and no two vertices in 𝐵\nadjacent.",
    "The vertices in 𝐴can be adjacent to some or all of the vertices in 𝐵. If each\nvertex in 𝐴is adjacent to all the vertices in 𝐵, then the graph is a complete bipartite\ngraph, and gets a special name: 𝐾𝑚,𝑛, where |𝐴| = 𝑚and |𝐵| = 𝑛.\nNamed Graphs.\n",
    "Some graphs are used more than others and get special names.\n",
    "𝐾𝑛\nThe complete graph on 𝑛vertices.\n",
    "𝐾𝑚,𝑛\nThe complete bipartite graph with sets of 𝑚and 𝑛vertices.\n",
    "𝐶𝑛\nThe cycle on 𝑛vertices, just one big loop.\n",
    "𝑃𝑛\nThe path on 𝑛+ 1 vertices (so 𝑛edges), just one long path.\n",
    "3A proposition is a general statement in mathematics, similar to a theorem, although generally of\nlesser importance.\n\n110\n2.",
    "Graph Theory\n𝐾5\n𝐾2,3\n𝐶6\n𝑃5\nGraph Theory Definitions.\n",
    "There are a lot of definitions to keep track of in graph\ntheory.",
    "Here is a glossary of the terms we have already used and will soon encounter.\n",
    "Graph\nA collection of vertices, some of which are connected by edges.\n",
    "More precisely, a pair of sets 𝑉and 𝐸, where 𝑉is a set of\nvertices and 𝐸is a set of 2-element subsets of 𝑉.\nAdjacent\nTwo vertices are adjacent if they are connected by an edge.\n",
    "Two edges are adjacent if they share a vertex.\n",
    "Bipartite graph\nA graph for which it is possible to divide the vertices into two\ndisjoint sets such that there are no edges between any two\nvertices in the same set.\n",
    "Complete\nbipartite graph\nA bipartite graph for which every vertex in the first set is\nadjacent to every vertex in the second set.\n",
    "Complete graph\nA graph in which every pair of vertices is adjacent.\n",
    "Connected\nA graph is connected if there is a path from any vertex to any\nother vertex.\n",
    "Chromatic\nnumber\nThe minimum number of colors required in a proper vertex\ncoloring of the graph.\n",
    "Cycle\nA path (see below) that starts and stops at the same vertex,\nbut contains no other repeated vertices.\nDegree of a\nvertex\nThe number of edges incident to a vertex.\n",
    "Euler trail\nA walk which uses each edge exactly once.\n",
    "Euler circuit\nAn Euler trail which starts and stops at the same vertex.\n",
    "Multigraph\nA multigraph is just like a graph but can contain multiple\nedges between two vertices as well as single edge loops (that\nis an edge from a vertex to itself).\n",
    "Path\nA path is a walk that doesn’t repeat any vertices (or edges)\nexcept perhaps the first and last.",
    "If a path starts and ends at\nthe same vertex, it is called a cycle.\n\n",
    "2.1.",
    "Problems and Definitions\n111\nPlanar\nA graph which can be drawn (in the plane) without any edges\ncrossing.\n",
    "Subgraph\nWe say that 𝐻is a subgraph of 𝐺if every vertex and edge\nof 𝐻is also a vertex or edge of 𝐺.",
    "We say 𝐻is an induced\nsubgraph of 𝐺if every vertex of 𝐻is a vertex of 𝐺and each\npair of vertices in 𝐻are adjacent in 𝐻if and only if they are\nadjacent in 𝐺.\nTree\nA connected graph with no cycles.",
    "(If we remove the require-\nment that the graph is connected, the graph is called a forest.)\n",
    "The vertices in a tree with degree 1 are called leaves.\n",
    "Vertex coloring\nAn assignment of colors to each of the vertices of a graph.",
    "A\nvertex coloring is proper if adjacent vertices are always colored\ndifferently.\n",
    "Walk\nA sequence of vertices such that consecutive vertices (in the\nsequence) are adjacent (in the graph).",
    "A walk in which no\nedge is repeated is called a trail, and a trail in which no vertex\nis repeated (except possibly the first and last) is called a path.\n",
    "2.1.3\nReading Questions\n1.\nIs there more than one graph with five vertices and six edges?",
    "Explain what\nthis question even means and how you would answer it.\n",
    "2.\n",
    "If a graph has 10 vertices, each with degree 4, how many edges does it have?\n3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "2.1.4\nPractice Problems\n\n112\n2.",
    "Graph Theory\n1.\nConsider the graph 𝐺below.\n",
    "𝑑\n𝑒\n𝑓\n𝑔\n𝑎\n𝑏\n𝑐\nWhich of the following graphs are isomorphic to 𝐺?",
    "Select all that apply.\n",
    "(a)\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\n(b)\n𝑥\n𝑦\n𝑧\n𝑤\n𝑢\n𝑣\n𝑡\n(c)\n𝑡\n𝑢\n𝑣\n𝑤\n𝑥\n𝑦\n𝑧\n2.\n",
    "Which of the following graphs are isomorphic to each other?\n(a)\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\n(b)\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\n(c)\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\n(d)\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\n3.\n",
    "The graph 𝐺1 has 8 vertices all of degree 6.",
    "How many edges does 𝐺1 have?\n",
    "The graph 𝐺2 has 7 vertices all of degree k, and 7 edges.",
    "What is 𝑘?\n",
    "The graph 𝐺3 has all vertices of degree 4, and 16 edges.",
    "How many vertices\ndoes 𝐺3 have?\n4.\nSuppose a graph with degree sequence (8, 7, 7, 6, 6, 6, 5, 4, 4, 3).",
    "How many\nedges must the graph have?\n5.\n(a) What is the largest 𝑛such that 𝑃𝑛is a subgraph of 𝐾5?\n(b) What is the largest 𝑛such that 𝐶𝑛is a subgraph of 𝐾5?\n(c)",
    "What is the largest 𝑛such that 𝑃𝑛is an induced subgraph of 𝐾5?\n(d) What is the largest 𝑛such that 𝐶𝑛is an induced subgraph of 𝐾5?\n\n2.1.",
    "Problems and Definitions\n113\n2.1.5\nAdditional Exercises\n1.\n",
    "If 10 people each shake hands with each other, how many handshakes took\nplace?",
    "What does this question have to do with graph theory?\n",
    "2.\nAmong a group of 5 people, is it possible for everyone to be friends with\nexactly 2 of the people in the group?",
    "What about 3 of the people in the group?\n3.\nIs it possible for two different (non-isomorphic) graphs to have the same number\nof vertices and the same number of edges?",
    "What if the degrees of the vertices\nin the two graphs are the same (so both graphs have vertices with degrees 1, 2,\n2, 3, and 4, for example)?",
    "Draw two such graphs or explain why not.\n4.\nAre the two graphs below equal?",
    "Are they isomorphic?",
    "If they are isomorphic,\ngive the isomorphism.",
    "If not, explain.\n",
    "Graph 1: 𝑉= {𝑎, 𝑏, 𝑐, 𝑑, 𝑒}, 𝐸= {{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑎, 𝑒}, {𝑏, 𝑑}, {𝑏, 𝑒}, {𝑐, 𝑑}} .\n",
    "Graph 2:\n𝑑\n𝑎\n𝑐\n𝑏\n𝑒\n5.\nConsider the following two graphs:\n𝐺1\n𝑉1 = {𝑎, 𝑏, 𝑐, 𝑑, 𝑒, 𝑓, 𝑔}\n𝐸1 = {{𝑎, 𝑏}, {𝑎, 𝑑}, {𝑏, 𝑐}, {𝑏, 𝑑}, {𝑏, 𝑒}, {𝑏, 𝑓}, {𝑐, 𝑔}, {𝑑, 𝑒},\n{𝑒, 𝑓}, { 𝑓, 𝑔}}.\n𝐺2\n𝑉2 = {𝑣1, 𝑣2, 𝑣3, 𝑣4, 𝑣5, 𝑣6, 𝑣7},\n𝐸2 = {{𝑣1, 𝑣4}, {𝑣1, 𝑣5}, {𝑣1, 𝑣7}, {𝑣2, 𝑣3}, {𝑣2, 𝑣6},\n{𝑣3, 𝑣5}, {𝑣3, 𝑣7}, {𝑣4, 𝑣5}, {𝑣5, 𝑣6}, {𝑣5, 𝑣7}}\n(a) Let 𝑓: 𝐺1 →𝐺2 be a function that takes the vertices of Graph 1 to vertices\nof Graph 2.",
    "The function is given by the following table:\n",
    "𝑥\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\n𝑓(𝑥)\n𝑣4\n𝑣5\n𝑣1\n𝑣6\n𝑣2\n𝑣3\n𝑣7\nDoes 𝑓define an isomorphism between Graph 1 and Graph 2?\n(b) Define a new function 𝑔(with 𝑔≠𝑓) that defines an isomorphism\nbetween Graph 1 and Graph 2.\n(c) Is the graph pictured below isomorphic to Graph 1 and Graph 2?",
    "Explain.\n\n",
    "114\n2.",
    "Graph Theory\n6.\n",
    "What is the largest number of edges possible in a graph with 10 vertices?",
    "What\nis the largest number of edges possible in a bipartite graph with 10 vertices?\n",
    "What is the largest number of edges possible in a tree with 10 vertices?\n7.\nWhich of the graphs below are bipartite?",
    "Justify your answers.\n",
    "8.\nFor which 𝑛≥3 is the graph 𝐶𝑛bipartite?\n9.\n",
    "For each of the following, try to give two different unlabeled graphs with the\ngiven properties, or explain why doing so is impossible.\n",
    "(a) Two different trees with the same number of vertices and the same\nnumber of edges.",
    "A tree is a connected graph with no cycles.\n",
    "(b) Two different graphs with 8 vertices all of degree 2.\n(c) Two different graphs with 5 vertices all of degree 4.\n(d) Two different graphs with 5 vertices all of degree 3.\n10.\nDecide whether the statements below about subgraphs are true or false.",
    "For\nthose that are true, briefly explain why (1 or 2 sentences).",
    "For any that are false,\ngive a counterexample.\n",
    "(a) Any subgraph of a complete graph is also complete.\n",
    "(b) Any induced subgraph of a complete graph is also complete.\n",
    "(c) Any subgraph of a bipartite graph is bipartite.\n",
    "(d) Any subgraph of a tree is a tree.\n",
    "11.\n",
    "We often define graph theory concepts using set theory.",
    "For example, given a\ngraph 𝐺= (𝑉, 𝐸) and a vertex 𝑣∈𝑉, we define\n𝑁(𝑣) = {𝑢∈𝑉: {𝑣, 𝑢} ∈𝐸}.\n",
    "We define 𝑁[𝑣] = 𝑁(𝑣) ∪{𝑣}.",
    "The goal of this problem is to figure out what all\nthis means.\n",
    "(a) Let 𝐺be the graph with vertices 𝑉and edges 𝐸given by\n𝑉= {𝑎, 𝑏, 𝑐, 𝑑, 𝑒, 𝑓}, 𝐸= {{𝑎, 𝑏}, {𝑎, 𝑒}, {𝑏, 𝑐}, {𝑏, 𝑒}, {𝑐, 𝑑}, {𝑐, 𝑓}, {𝑑, 𝑓}, {𝑒, 𝑓}}.\n",
    "Find 𝑁(𝑎), 𝑁[𝑎], 𝑁(𝑐), and 𝑁[𝑐].\n\n2.1.",
    "Problems and Definitions\n115\n(b) What are the largest and smallest possible values for |𝑁(𝑣)| and |𝑁[𝑣]|\n(the sizes of these sets) for the graph in part (a)?",
    "Explain.\n",
    "(c) Give an example of a graph 𝐺= (𝑉, 𝐸) (probably different from the one\nabove) for which 𝑁[𝑣] = 𝑉for some vertex 𝑣∈𝑉. Is there a graph for\nwhich 𝑁[𝑣] = 𝑉for all 𝑣∈𝑉?",
    "Explain.\n",
    "(d) Give an example of a graph 𝐺= (𝑉, 𝐸) for which 𝑁(𝑣) = ∅for some\n𝑣∈𝑉. Is there an example of such a graph for which 𝑁[𝑢] = 𝑉for some\nother 𝑢∈𝑉as well?",
    "Explain.\n",
    "(e) Describe in words what 𝑁(𝑣) and 𝑁[𝑣] mean in general.\n",
    "12.\n",
    "A graph is a way of representing the relationships between elements in a set:\nAn edge between the vertices 𝑥and 𝑦tells us that 𝑥is related to 𝑦(which\nwe can write as 𝑥∼𝑦).",
    "Not all sorts of relationships can be represented by a\ngraph, though.",
    "For each relationship described below, either draw the graph\nor explain why the relationship cannot be represented by a graph.\n(a) The set 𝑉= {1, 2, . .",
    ".",
    ", 9} and the relationship 𝑥∼𝑦when 𝑥−𝑦is a\nnon-zero multiple of 3.\n(b)",
    "The set 𝑉= {1, 2, . . .",
    ", 9} and the relationship 𝑥∼𝑦when 𝑦is a multiple\nof 𝑥.\n(c)",
    "The set 𝑉= {1, 2, . . .",
    ", 9} and the relationship 𝑥∼𝑦when 0 < |𝑥−𝑦| < 3.\n13.\nConsider graphs with 𝑛vertices.\nRemember, graphs do not need to be\nconnected.\n",
    "(a) How many edges must the graph have to guarantee at least one vertex\nhas degree two or more?",
    "Prove your answer.\n",
    "(b) How many edges must the graph have to guarantee all vertices have\ndegree two or more?",
    "Prove your answer.\n",
    "14.\nProve that any graph with at least two vertices must have two vertices of the\nsame degree.\n",
    "15.\nSuppose 𝐺is a connected graph with 𝑛> 1 vertices and 𝑛−1 edges.",
    "Prove\nthat 𝐺has a vertex of degree 1.\n16.\n",
    "Which (if any) of the graphs below are the same?\n",
    "The graphs above are unlabeled.",
    "Usually we think of a graph as having a\n\n116\n2.",
    "Graph Theory\nspecific set of vertices.",
    "Which (if any) of the graphs below are the same?\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑎\n𝑐\n𝑒\n𝑏\n𝑑\n𝑓\n𝑣6\n𝑣1\n𝑣2\n𝑣5\n𝑣4\n𝑣3\nActually, all the graphs above are just drawings of graphs.",
    "A graph is really\nan abstract mathematical object consisting of two sets 𝑉and 𝐸, where 𝐸is a set\nof 2-element subsets of 𝑉. Are the graphs below the same or different?\n",
    "Graph 1:\n𝑉= {𝑎, 𝑏, 𝑐, 𝑑, 𝑒},\n𝐸= {{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑎, 𝑑}, {𝑎, 𝑒}, {𝑏, 𝑐}, {𝑑, 𝑒}} .\n",
    "Graph 2:\n𝑉= {𝑣1, 𝑣2, 𝑣3, 𝑣4, 𝑣5},\n𝐸= {{𝑣1, 𝑣3}, {𝑣1, 𝑣5}, {𝑣2, 𝑣4}, {𝑣2, 𝑣5}, {𝑣3, 𝑣5}, {𝑣4, 𝑣5}}.\n\n",
    "2.2\nTrees\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Prove basic facts about trees.\n",
    "2. Use theorems about trees to solve problems.\n",
    "3. Identify and construct spanning trees.\n",
    "2.2.1\nSection Preview\nInvestigate!\nConsider the graph drawn below.\n",
    "1. Find a subgraph with the smallest number of edges that is still con-\nnected and contains all the vertices.\n",
    "2. Find a subgraph with the largest number of edges that doesn’t contain\nany cycles.\n",
    "3.",
    "What do you notice about the number of edges in your examples\nabove?",
    "Is this a coincidence?\n",
    "One very useful and common approach to studying graph theory is to restrict\nyour focus to graphs of a particular kind.",
    "For example, you could try to really\nunderstand just complete graphs or just bipartite graphs, instead of trying to\nunderstand all graphs in general.",
    "That is what we are going to do now, looking at\ntrees.",
    "Hopefully by the end of this section we will have a better understanding of\nthis class of graph, and also understand why it is important enough to warrant its\nown section.\n",
    "Definition 2.2.1 Trees and Forests.\n",
    "A tree is a connected graph containing no cycles.4\nA forest is a graph containing no cycles.",
    "Note that this means that a\n117\n\n118\n2.",
    "Graph Theory\nconnected forest is a tree.\n",
    "Does the definition above agree with your intuition for what graphs we should\ncall trees?",
    "Try thinking of examples of trees, and make sure they satisfy the definition.\n",
    "One thing to keep in mind is that while the trees we study in graph theory are\nrelated to trees you might see in other subjects, the correspondence is not exact.",
    "For\ninstance, in anthropology, you might study family trees, like the one below,\nMe\nMom\nMaternal\nGrandma\nMaternal\nGrandpa\nDad\nPaternal\nGrandma\nPaternal\nGrandpa\nSo far so good, but while your grandparents are (probably) not blood relatives,\nif we go back far enough, it is likely that they did have some common ancestor.",
    "If\nyou trace the tree back from you to that common ancestor, then down through your\nother grandparent, you would have a cycle, and thus the graph would not be a tree.\n",
    "You might also have seen something called a decision tree (such as the algorithm\nfor deciding whether a series converges or diverges).",
    "Sometimes these too contain\ncycles, as the decision for one node might lead you back to a previous step.\n",
    "Both the examples of trees above also have another feature worth mentioning:\nThere is a clear order to the vertices in the tree.",
    "The definition of a tree does not\ninclude this added structure, although we can impose such a structure by considering\nrooted trees, where we simply designate one vertex as the root.",
    "We will consider\nsuch trees in more detail later in this section.\n",
    "In this section, we will explore some basic properties of trees, which will serve\nas an excellent introduction to writing proofs about graphs.",
    "We will also consider\na special kind of tree, called a spanning tree, which is a tree that includes all the\nvertices of a connected graph.",
    "Finally, we will briefly consider rooted trees.\n",
    "Preview Activity\n1.\nTake out a piece of paper and draw 8 vertices in a circle.\n",
    "4Sometimes this is stated as “a tree is an acyclic connected graph;” “acyclic” is just a fancy word for\n“containing no cycles.”\n\n2.2.",
    "Trees\n119\nWe are going to add edges to this graph following some requirements.\n",
    "(a) First, add the fewest number of edges possible so that the resulting graph\nis connected.",
    "That is, there must be a path between any pair of vertices (a\npath can use more than one edge, of course).\n",
    "How many edges are in the graph you drew?\n(b) Was the resulting graph you found a tree?\n(c) Now start over with an empty graph again.",
    "This time, add the largest\nnumber of edges possible so that the resulting graph contains no cycles.\n",
    "How many edges are in the graph you drew?\n",
    "(d) Was the resulting graph you found a tree?\n2.2.2\nProperties of Trees\nWe wish to really understand trees.",
    "This means we should discover properties of\ntrees: what makes them special and what is special about them.\n",
    "A tree is a connected graph with no cycles.",
    "Is there anything else we can say?\n",
    "It would be nice to have other equivalent conditions for a graph to be a tree.",
    "That\nis, we would like to know whether there are any graph theoretic properties that all\ntrees have, and perhaps even that only trees have.\n",
    "To get a feel for the sorts of things we can say, we will consider three propositions\nabout trees.",
    "These will also illustrate important proof techniques that apply to\ngraphs in general, and happen to be a little easier for trees.\n",
    "Our first proposition gives an alternate definition for a tree.",
    "That is, it gives\nnecessary and sufficient conditions for a graph to be a tree.\n",
    "Proposition 2.2.2\n",
    "A graph 𝑇is a tree if and only if between every pair of distinct vertices of 𝑇there is a\nunique path.\n",
    "Proof.",
    "This is an “if and only if” statement, so we must prove two implications.\n",
    "We start by proving that if 𝑇is a tree, then between every pair of distinct vertices\nthere is a unique path.\n",
    "Assume 𝑇is a tree, and let 𝑢and 𝑣be distinct vertices (if 𝑇only has one vertex,\nthen the conclusion is satisfied automatically).",
    "We must show two things to show\nthat there is a unique path between 𝑢and 𝑣: that there is a path, and that there\nis not more than one path.",
    "The first of these is automatic; since 𝑇is a tree, it is\nconnected, so there is a path between any pair of vertices.\n",
    "To show the path is unique, we suppose there are two paths between 𝑢and 𝑣,\nand get a contradiction.",
    "The two paths might start out the same, but since they are\ndifferent, there is some first vertex 𝑢′ after which the two paths diverge.",
    "However,\nsince the two paths both end at 𝑣, there is some first vertex after 𝑢′ that they have\n\n120\n2.",
    "Graph Theory\nin common, call it 𝑣′. Now consider the two paths from 𝑢′ to 𝑣′. Taken together,\nthese form a cycle, which contradicts our assumption that 𝑇is a tree.\n",
    "Now we consider the converse: If between every pair of distinct vertices of 𝑇\nthere is a unique path, then 𝑇is a tree.",
    "So assume the hypothesis: Between every\npair of distinct vertices of 𝑇there is a unique path.",
    "To prove that 𝑇is a tree, we\nmust show it is connected and contains no cycles.\n",
    "The first half of this is easy: 𝑇is connected, because there is a path between\nevery pair of vertices.",
    "To show that 𝑇has no cycles, we assume it does, for the sake\nof contradiction.",
    "Let 𝑢and 𝑣be two distinct vertices in a cycle of 𝑇. Since we can\nget from 𝑢to 𝑣by going clockwise or counterclockwise around the cycle, there are\ntwo paths from 𝑢and 𝑣, contradicting our assumption.\n",
    "We have established both directions so we have completed the proof.\n",
    "Read the proof above very carefully.",
    "Notice that both directions had two parts:\nthe existence of paths, and the uniqueness of paths (which related to the fact that\nthere were no cycles).",
    "In this case, these two parts were really separate.",
    "In fact, if we\njust considered graphs with no cycles (a forest), then we could still do the parts of\nthe proof that explore the uniqueness of paths between vertices, even if there might\nnot exist paths between vertices.\n",
    "This observation allows us to state the following corollary.5\nCorollary 2.2.3\nA graph 𝐹is a forest if and only if between any pair of vertices in 𝐹there is at most\none path.\n",
    "We do not give a proof of the corollary (it is, after all, supposed to follow directly\nfrom the proposition), but for practice, you are asked to give a careful proof in the\nexercises.",
    "When you do so, try to use proof by contrapositive instead of proof by\ncontradiction.\n",
    "Our second proposition tells us that all trees have leaves: vertices of degree one.\n",
    "Proposition 2.2.4\nAny tree with at least two vertices has at least two vertices of degree one.\nProof.",
    "We give a proof by contradiction.",
    "Let 𝑇be a tree with at least two vertices,\nand suppose, contrary to stipulation, that there are not two vertices of degree one.\n",
    "Let 𝑃be a path in 𝑇of longest possible length.",
    "Let 𝑢and 𝑣be the endpoints of\nthe path.",
    "Since 𝑇does not have two vertices of degree one, at least one of these\nmust have degree two or higher.",
    "Say that it is 𝑢.",
    "We know that 𝑢is adjacent to a\nvertex in the path 𝑃, but now it must also be adjacent to another vertex, call it 𝑢′.\nWhere is 𝑢′?",
    "It cannot be a vertex of 𝑃, because if it was, there would be two\ndistinct paths from 𝑢to 𝑢′: the edge between them, and the first part of 𝑃(up to\n5A corollary is another sort of provable statement, like a proposition or theorem, but one that\nfollows direction from another already established statement, or its proof.\n\n2.2.",
    "Trees\n121\n𝑢′).",
    "But 𝑢′ also cannot be outside of 𝑃, for if it was, there would be a path from 𝑢′\nto 𝑣that was longer than 𝑃, which has the longest possible length.\n",
    "This contradiction proves that there must be at least two vertices of degree one.\n",
    "In fact, we can say a little more: 𝑢and 𝑣must both have degree one.\n",
    "The proposition is quite useful when proving statements about trees, because\nwe often prove statements about trees by induction.",
    "This is a proof technique that\nwe investigate fully in Section 4.5, but for now, all we need to understand is that it is\nuseful to compare a given tree to smaller trees.",
    "To show something is true of a tree\nwith 𝑣vertices, we will assume the thing is true of all trees with 𝑣−1 vertices.",
    "By\nremoving a vertex of degree 1, we get this smaller tree, and then we just need to\nshow that putting the vertex back doesn’t mess us up.\n",
    "Is there a tree with exactly 7 vertices and 7 edges?",
    "Try to draw one.",
    "Could a tree\nwith 7 vertices have only 5 edges?",
    "There is a good reason that these seem impossible\nto draw.\n",
    "Proposition 2.2.5\nLet 𝑇be a tree with 𝑣vertices and 𝑒edges.",
    "Then 𝑒= 𝑣−1.\n",
    "We will prove that this proposition is true for all possible values of 𝑣≥1.",
    "Note\nthat if 𝑣= 1, then the tree must have 0 edges, so yes, 𝑒= 𝑣−1.",
    "We could then look\nat trees with 𝑣= 2 vertices (there is only one, and it has 𝑒= 1 = 𝑣−1 edges) and\nthen all trees with 𝑣= 3 vertices, and then 𝑣= 4, and so on, but that would take\nforever.",
    "Literally!\n",
    "Instead, we will do a version of proof by contradiction called the minimal criminal.\n",
    "We will assume the proposition is not true (just like we would start any proof by\ncontradiction).",
    "This means that there is some smallest tree for which it isn’t true.\n",
    "If this smallest counterexample (i.e., minimal criminal) has 𝑣vertices, then we are\nguaranteed that all trees with 𝑣−1 vertices are not counterexamples.",
    "Let’s see how\nthis works out.\n",
    "Proof.",
    "Suppose, for the sake of contradiction, that the proposition is not true for\nall trees.",
    "Let 𝑇be a tree for which the proposition is not true, with the smallest\nnumber of vertices among all the counterexamples.",
    "Let 𝑣be the number of vertices\nof 𝑇.\n",
    "Since the only tree with one vertex has zero edges, that cannot be our tree 𝑇,\nso we can assume 𝑣≥2.",
    "In particular, we know by Proposition 2.2.4 that 𝑇must\ncontain at least one vertex of degree 1, call it 𝑣0.\n",
    "Let 𝑇′ be the tree resulting from removing 𝑣0 from 𝑇(together with its incident\nedge).",
    "Since we removed a leaf, 𝑇′ is still a tree (the unique paths between pairs of\nvertices in 𝑇′ are the same as the unique paths between them in 𝑇).\n",
    "Now 𝑇′ has 𝑣−1 vertices.",
    "Since 𝑇was the smallest tree for which the proposition\nisn’t true, we know that the proposition is true for 𝑇′.",
    "So 𝑇′ must have one fewer\nedges than vertices; that is, 𝑇′ has 𝑣−2 edges.",
    "But 𝑇has one more edge than 𝑇′,\nso it has 𝑣−1 edges.",
    "This contradicts our assumption that 𝑇does not satisfy the\n\n122\n2.",
    "Graph Theory\nproposition, which completes our proof.\n",
    "2.2.3\nSpanning Trees\nOne of the advantages of trees is that they give us a few simple ways to travel\nthrough the vertices.",
    "If a connected graph is not a tree, then we can still use these\ntraversal algorithms if we identify a subgraph that is a tree.\n",
    "First we should consider if this even makes sense.",
    "Given any connected graph 𝐺,\nwill there always be a subgraph that is a tree?",
    "Well, that is actually too easy: You\ncould just take a single vertex of 𝐺. If we want to use this subgraph to tell us how to\nvisit all vertices, then we want our subgraph to include all of the vertices.",
    "We call\nsuch a tree a spanning tree.\n",
    "Definition 2.2.6\nGiven a connected graph 𝐺, a spanning tree of 𝐺is a subgraph of 𝐺which is\na tree and includes all the vertices of 𝐺.\n",
    "It turns out that every connected graph has one (and usually many).\n",
    "Theorem 2.2.7\nEvery connected graph has a spanning tree.\n",
    "How do we know?",
    "We can give an algorithm for finding a spanning tree!",
    "Start\nwith a connected graph 𝐺.",
    "If there is no cycle, then 𝐺is already a tree and we are\ndone.",
    "If there is a cycle, let 𝑒be any edge in that cycle and consider the new graph\n𝐺1 = 𝐺−𝑒(i.e., the graph you get by deleting 𝑒).",
    "This tree is still connected: Since 𝑒\nbelonged to a cycle, there were at least two paths between its incident vertices.",
    "Now\nrepeat: If 𝐺1 has no cycles, we are done; otherwise define 𝐺2 to be 𝐺1 −𝑒1, where 𝑒1\nis an edge in a cycle in 𝐺1.",
    "Keep going.",
    "This process must eventually stop, since\nthere are only a finite number of edges to remove.",
    "The result will be a tree, and since\nwe never removed any vertex, a spanning tree.\n",
    "This is by no means the only algorithm for finding a spanning tree.",
    "You could\nhave started with the empty graph and added edges that belong to 𝐺, as long as\nadding them would not create a cycle.",
    "You have some choices as to which edges you\nadd first: You could always add an edge adjacent to edges you have already added\n(after the first one, of course), or add them using some other order.",
    "Which spanning\ntree you end up with depends on these choices.\n",
    "Example 2.2.8\nFind two different spanning trees of the graph,\n\n2.2.",
    "Trees\n123\nSolution.\n",
    "Here are two spanning trees.\n",
    "Although we will not consider this in detail, these algorithms are usually applied\nto weighted graphs.",
    "Here every edge has some weight or cost assigned to it.",
    "The goal\nis to find a spanning tree that has the smallest possible combined weight.",
    "Such a\ntree is called a minimum spanning tree.",
    "Finding the minimum spanning tree uses\nbasically the same algorithms as we described above, but when picking an edge to\nadd, you always pick the smallest (or when removing an edge, you always remove\nthe largest).6\n2.2.4\nRooted Trees\nSo far, we have thought of trees only as a particular kind of graph.",
    "However, it is\noften useful to add additional structure to trees to help solve problems.",
    "Data is often\nstructured like a tree.",
    "This book, for example, has a tree structure:",
    "Draw a vertex for\nthe book itself.",
    "Then draw vertices for each chapter, connected to the book vertex.\n",
    "Under each chapter, draw a vertex for each section, connecting it to the chapter it\nbelongs to.",
    "The graph will not have any cycles; it will be a tree, but a tree with a clear\nhierarchy which is not present if we don’t identify the “book vertex” as the “top”.\n",
    "As soon as one vertex of a tree is designated as the root, then every other vertex\non the tree can be characterized by its position relative to the root.",
    "This works\nbecause there is a unique path between any two vertices in a tree.",
    "So from any vertex,\nwe can travel back to the root in exactly one way.",
    "This also allows us to describe how\ndistinct vertices in a rooted tree are related.\n",
    "If two vertices are adjacent, then we say one of them is the parent of the other,\nwhich is called the child of the parent.",
    "Of the two, the parent is the vertex that is\ncloser to the root.",
    "Thus the root of a tree is a parent, but is not the child of any vertex\n(and is unique in this respect: All non-root vertices have exactly one parent).\n",
    "Not surprisingly, the child of a child of a vertex is called the grandchild of\nthe vertex (and it is the grandparent).",
    "More generally, we say that a vertex 𝑣is a\n6",
    "If you add the smallest edge adjacent to edges you have already added, you are doing Prim’s\nalgorithm.",
    "If you add the smallest edge in the entire graph, you are following Kruskal’s algorithm.\n\n",
    "124\n2.",
    "Graph Theory\ndescendent of a vertex 𝑢provided 𝑢is a vertex on the path from 𝑣to the root.",
    "Then\nwe would call 𝑢an ancestor of 𝑣.\nFor most trees (in fact, all except paths with one end the root), there will be pairs\nof vertices neither of which is a descendant of the other.",
    "We might call these cousins\nor siblings.",
    "In fact, vertices 𝑢and 𝑣are called siblings provided they have the same\nparent.",
    "Note that siblings are never adjacent (do you see why?).\n",
    "Example 2.2.9\nConsider the tree below.\n",
    "𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\nℎ\n𝑖\nIf we designate vertex 𝑓as the root, then 𝑒, ℎ, and 𝑖are the children of 𝑓,\nand are siblings of each other.",
    "Among the other things we cay say are that 𝑎\nis a child of 𝑐, and a descendant of 𝑓. The vertex 𝑔is a descendant of 𝑓, in\nfact, is a grandchild of 𝑓. Vertices 𝑔and 𝑑are siblings, since they have the\ncommon parent 𝑒.\n",
    "Notice how this changes if we pick a different vertex for the root.",
    "If 𝑎is\nthe root, then its lone child is 𝑐, which also has only one child, namely 𝑒. We\nwould then have 𝑓the child of 𝑒(instead of the other way around), and 𝑓is\nthe descendant of 𝑎, instead of the ancestor.",
    "𝑓and 𝑔are now siblings.\n",
    "All of this flowery language helps us describe how to navigate through a tree.\n",
    "Traversing a tree, visiting each vertex in some order, is a key step in many algorithms.\n",
    "Even if the tree is not rooted, we can always form a rooted tree by picking any vertex\nas the root.",
    "Here is an example of why doing so can be helpful.\n",
    "Example 2.2.10\nExplain why every tree is a bipartite graph.\nSolution.\n",
    "To show that a graph is bipartite, we must divide the vertices into\ntwo sets, 𝐴and 𝐵, so that no two vertices in the same set are adjacent.",
    "Here is\nan algorithm that does just this.\n",
    "Designate any vertex as the root.",
    "Put this vertex in set 𝐴.",
    "Now put all of\nthe children of the root in set 𝐵. None of these children are adjacent (they are\nsiblings), so we are good so far.",
    "Now put into 𝐴every child of every vertex\nin 𝐵(i.e.",
    ", every grandchild of the root).",
    "Keep going until all vertices have\nbeen assigned one of the sets, alternating between 𝐴and 𝐵every “generation.”\n",
    "That is, a vertex is in set 𝐵if and only if it is the child of a vertex in set 𝐴.\n\n2.2.",
    "Trees\n125\nThe key to how we partitioned the tree in the example was to know which vertex\nto assign to a set next.",
    "We chose to visit all vertices in the same generation before\nany vertices of the next generation.",
    "This is usually called a breadth-first search\n(we say “search” because you often traverse a tree looking for vertices with certain\nproperties).\n",
    "In contrast, we could also have partitioned the tree in a different order.",
    "Start\nwith the root; put it in 𝐴.",
    "Then look for one child of the root to put in 𝐵. Then find a\nchild of that vertex, into 𝐴, and then find its child, into 𝐵, and so on.",
    "When you get\nto a vertex with no children, retreat to its parent, and see if the parent has any other\nchildren.",
    "So we travel as far from the root as fast as possible, then backtrack until we\ncan move forward again.",
    "This is called depth-first search.\n",
    "These algorithmic explanations can serve as a proof that every tree is bipartite,\nalthough care needs to be spent to prove that the algorithms are correct.",
    "Another\napproach to prove that all trees are bipartite, using induction, is requested in the\nexercises.\n",
    "2.2.5\nReading Questions\n1.\nSuppose 𝑇is a tree with 10 vertices.",
    "Which of the following statements must\nbe true about 𝑇?",
    "Select all that apply.\n",
    "A. 𝑇has a unique path between every pair of vertices.\n",
    "B.",
    "If you removed any edge from 𝑇, the resulting graph would be discon-\nnected.\n",
    "C. If you added any edge between two vertices in 𝑇(that were not already\nadjacent), the resulting graph would have a cycle.\n",
    "D. 𝑇has exactly two vertices of degree one.\n",
    "2.\n",
    "If a tree has 20 vertices, how many edges does it have?\n3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "2.2.6\nPractice Problems\n1.\nAre the following statements true or false?\n(a) Every tree is bipartite.\n",
    "(b) Every bipartite graph is a tree.\n",
    "(c) There is a forest with more edges than vertices.\n",
    "(d)",
    "There is a tree with 6 vertices and 6 edges.\n",
    "(e) Every tree with 7 vertices has the same number of edges.\n\n",
    "126\n2.",
    "Graph Theory\n2.\n",
    "A forest contains 30 vertices and 21 edges.",
    "How many connected components\ndoes the graph have?\n",
    "3.\nA connected graph with 22 vertices contains 29 edges.",
    "Without knowing\nwhich particular graph this is, what is the smallest and largest possible number\nof edges you can remove to get a spanning tree?\n",
    "Smallest number of edges to remove:\nLargest number of edges to remove:\n4.\n",
    "The average degree of a tree is 1.992 (that is, if you sum the degrees of vertices\nand divide by the number of vertices, you get 1.992).\n",
    "How many vertices does the tree have?\n5.\n",
    "A tree contains some number of leaves (degree 1 vertices) and four non-leaf\nvertices.",
    "The degrees of the non-leaf vertices are 8, 6, 5, and 3.",
    "How many\nleaves does the tree have?\n",
    "Smallest number of leaves possible:\nLargest number of leaves possible:\n2.2.7\nAdditional Exercises\n1.\n",
    "Which of the following graphs are trees?\n(a) 𝐺\n=\n(𝑉, 𝐸)\nwith\n𝑉\n=\n{𝑎, 𝑏, 𝑐, 𝑑, 𝑒}\nand\n𝐸\n=\n{{𝑎, 𝑏}, {𝑎, 𝑒}, {𝑏, 𝑐}, {𝑐, 𝑑}, {𝑑, 𝑒}}\n(b) 𝐺= (𝑉, 𝐸) with 𝑉= {𝑎, 𝑏, 𝑐, 𝑑, 𝑒} and 𝐸= {{𝑎, 𝑏}, {𝑏, 𝑐}, {𝑐, 𝑑}, {𝑑, 𝑒}}\n(c) 𝐺= (𝑉, 𝐸) with 𝑉= {𝑎, 𝑏, 𝑐, 𝑑, 𝑒} and 𝐸= {{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑎, 𝑑}, {𝑎, 𝑒}}\n(d) 𝐺= (𝑉, 𝐸) with 𝑉= {𝑎, 𝑏, 𝑐, 𝑑, 𝑒} and 𝐸= {{𝑎, 𝑏}, {𝑎, 𝑐}, {𝑑, 𝑒}}\n2.\n",
    "For each degree sequence below, decide whether it must always, must never, or\ncould possibly be a degree sequence for a tree.",
    "Remember, a degree sequence\nlists out the degrees (number of edges incident to the vertex) of all the vertices\nin a graph in non-increasing order.\n(a) (4, 1, 1, 1, 1)\n(b) (3, 3, 2, 1, 1)\n(c) (2, 2, 2, 1, 1)\n(d) (4, 4, 3, 3, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1)\n3.\n",
    "For each degree sequence below, decide whether it must always, must never,\nor could possibly be a degree sequence for a tree.",
    "Justify your answers.\n",
    "(a) (3, 3, 2, 2, 2)\n(b) (3, 2, 2, 1, 1, 1)\n(c) (3, 3, 3, 1, 1, 1)\n\n2.2.",
    "Trees\n127\n(d) (4, 4, 1, 1, 1, 1, 1, 1)\n4.\nSuppose you have a graph with 𝑣vertices and 𝑒edges that satisfies 𝑣= 𝑒+ 1.\n",
    "Must the graph be a tree?",
    "Prove your answer.\n",
    "5.\nProve that any graph (not necessarily a tree) with 𝑣vertices and 𝑒edges that\nsatisfies 𝑣> 𝑒+ 1 will NOT be connected.\n",
    "6.\n",
    "If a graph 𝐺with 𝑣vertices and 𝑒edges is connected and has 𝑣< 𝑒+ 1, must\nit contain a cycle?",
    "Prove your answer.\n",
    "7.\nWe define a forest to be a graph with no cycles.\n",
    "(a) Explain why this is a good name.",
    "That is, explain why a forest is a union\nof trees.\n",
    "(b) Suppose 𝐹is a forest consisting of 𝑚trees and 𝑣vertices.",
    "How many\nedges does 𝐹have?",
    "Explain.\n",
    "(c) Prove that any graph 𝐺with 𝑣vertices and 𝑒edges that satisfies 𝑣< 𝑒+ 1\nmust contain a cycle (i.e., not be a forest).\n",
    "8.\nGive a careful proof of Corollary 2.2.3: A graph is a forest if and only if there\nis at most one path between any pair of vertices.",
    "Use proof by contrapositive\n(and not a proof by contradiction) for both directions.\n9.\nGive a careful minimal criminal proof that every tree is bipartite.\n",
    "10.\nConsider the tree drawn below.\n",
    "𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\nℎ\n𝑖\n(a) Suppose we designate vertex 𝑒as the root.",
    "List the children, parents, and\nsiblings of each vertex.",
    "Does any vertex other than 𝑒have grandchildren?\n(b) Suppose 𝑒is not chosen as the root.",
    "Does our choice of root vertex change\nthe number of children 𝑒has?",
    "The number of grandchildren?",
    "How many\nare there of each?\n(c)",
    "In fact, pick any vertex in the tree and suppose it is not the root.",
    "Explain\nwhy the number of children of that vertex does not depend on which\nother vertex is the root.\n",
    "(d) Does the previous part work for other trees?",
    "Give an example of a\ndifferent tree for which it holds.",
    "Then either prove that it always holds or\ngive an example of a tree for which it doesn’t.\n",
    "11.\n",
    "Let 𝑇be a rooted tree that contains vertices 𝑢, 𝑣, and 𝑤(among others, possibly).\n",
    "Prove that if 𝑤is a descendant of both 𝑢and 𝑣, then 𝑢is a descendant of 𝑣or 𝑣\nis a descendant of 𝑢.\n\n128\n2.",
    "Graph Theory\n12.\n",
    "Unless it is already a tree, a given graph 𝐺will have multiple spanning trees.\n",
    "How similar or different must these be?\n(a) Must all spanning trees of a given graph be isomorphic to each other?\n",
    "Explain why or give a counterexample.\n",
    "(b) Must all spanning trees of a given graph have the same number of edges?\nExplain why or give a counterexample.\n",
    "(c) Must all spanning trees of a graph have the same number of leaves\n(vertices of degree 1)?",
    "Explain why or give a counterexample.\n13.\nFind all spanning trees of the graph below.",
    "How many different spanning\ntrees are there?",
    "How many different spanning trees are there up to isomorphism\n(that is, if you grouped all the spanning trees by which are isomorphic, how\nmany groups would you have)?\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n14.\n",
    "Give an example of a graph that has exactly 7 different spanning trees.",
    "Note, it\nis acceptable for some or all of these spanning trees to be isomorphic.\n",
    "15.\nProve that every connected graph which is not itself a tree must have at least\nthree different (although possibly isomorphic) spanning trees.\n",
    "16.\nConsider edges that must be in every spanning tree of a graph.",
    "Must every\ngraph have such an edge?",
    "Give an example of a graph that has exactly one\nsuch edge.\n\n",
    "2.3\nPlanar Graphs\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1.",
    "Distinguish between planar and non-planar graphs.\n",
    "2. Use Euler’s formula to prove that certain graphs are non-planar.\n3.",
    "Apply Euler’s formula to polyhedra.\n",
    "2.3.1\nSection Preview\nInvestigate!\n",
    "When a connected graph can be drawn without any edges crossing, it is\ncalled planar.",
    "When a planar graph is drawn in this way, it divides the\nplane into regions called faces.\n",
    "1.",
    "Draw, if possible, two different planar graphs with the same number\nof vertices, edges, and faces.\n",
    "2.",
    "Draw, if possible, two different planar graphs with the same number\nof vertices and edges, but a different number of faces.\n",
    "When is it possible to draw a graph so that none of the edges cross?",
    "If this is\npossible, we say the graph is planar (since you can draw it on the plane).\n",
    "Notice that the definition of planar includes the phrase “it is possible to.”",
    "This\nmeans that even if a graph does not look like it is planar, it still might be.",
    "Perhaps\nyou can redraw it in a way in which no edges cross.",
    "For example, this is a planar\ngraph:\nThat is because we can redraw it like this:\n129\n\n130\n2.",
    "Graph Theory\n",
    "The graphs are the same, so if one is planar, the other must be, too.",
    "However, the\noriginal drawing of the graph was not a planar representation of the graph.\n",
    "When a planar graph is drawn without edges crossing, the edges and vertices of\nthe graph divide the plane into regions.",
    "We will call each region a face.",
    "The graph\nabove has 3 faces (yes, we do include the “outside” region as a face).",
    "The number\nof faces does not change no matter how you draw the graph (as long as you do so\nwithout the edges crossing), so it makes sense to ascribe the number of faces as a\nproperty of the planar graph.\n",
    "WARNING",
    ": you can only count faces when the graph is drawn in a planar way.\n",
    "For example, consider these two representations of the same graph:\nIf you try to count faces using the graph on the left, you might say there are 5\nfaces (including the outside).",
    "But drawing the graph with a planar representation\nshows that in fact there are only 4 faces.\n",
    "Preview Activity\n1.\n(a) Draw a connected planar graph with 5 vertices and 5 edges.",
    "How many\nfaces (including the “outside” face) does your graph have?\n(b) Now add a single edge to your graph, between two vertices that are not\nalready adjacent.",
    "Assuming the resulting graph is still planar, list the\nnumber of vertices, edges, and faces it now has.\n",
    "(c) Now add another edge to the graph, this time to a new vertex.",
    "Assuming\nthe resulting graph is still planar, list the number of vertices, edges, and\nfaces it now has.\n",
    "2.\nNow draw at least three more connected, planar graphs, each with at least six\nvertices.",
    "Count the number of vertices 𝑣, edges 𝑒, and faces 𝑓for each graph\nand record your data in the table below.\n\n",
    "2.3.",
    "Planar Graphs\n131\n𝑣\n𝑒\n𝑓\n3.\n",
    "Do you notice any patterns?",
    "What happens to the numbers if you add an edge\nbetween two non-adjacent vertices?",
    "What happens if you add a new vertex\nand connect it to an existing vertex?\nConjecture an expression that involves the number of vertices 𝑣, the number\nof edges 𝑒, and the number of faces 𝑓that remains constant for all connected\nplanar graphs.",
    "What is that constant?\nHint.\n",
    "You might conjecture an expression like 𝑣+𝑒\n𝑓.",
    "But this is not right,\nbecause there is a planar graph for which this would be 5+5\n2\n= 5 and another\nplanar graph for which the expression would be 6+7\n3\n≠5.\n",
    "What sort of expression will stay constant if 𝑣and 𝑒both increase by 1?\nAnd also stay constant if 𝑒and 𝑓both increase by 1?\n4.\n",
    "A cube is made of six squares, each of which shares an edge with each of its\nneighbors.",
    "Vertices of the cube join three of the squares.\n",
    "(a) How many vertices, edges, and faces does a cube have?\n(b) Does this match the relationship you conjectured above?\n2.3.2\nEuler’s Formula for Planar Graphs\nThere is a connection between the number of vertices (𝑣), the number of edges (𝑒),\nand the number of faces ( 𝑓) in any connected planar graph.",
    "This relationship is\ncalled Euler’s formula.\n",
    "Euler’s Formula for Planar Graphs.\n",
    "For any connected planar graph with 𝑣vertices, 𝑒edges, and 𝑓faces, we\nhave\n𝑣−𝑒+ 𝑓= 2.\n",
    "Why is Euler’s formula true?",
    "One way to convince ourselves of its validity is to\ndraw a planar graph step by step.",
    "Start with the graph 𝑃2:\nAny connected graph (besides just a single isolated vertex) must contain this\nsubgraph.",
    "Now we build up to our graph by adding edges and vertices.",
    "Each step\nwill consist of either adding a new vertex connected by a new edge to part of your\ngraph (so creating a new “spike”) or by connecting two vertices already in the graph\n\n132\n2.",
    "Graph Theory\nwith a new edge (completing a circuit).\n",
    "What do these “moves” do?",
    "When adding the spike, the number of edges\nincreases by 1, the number of vertices increases by 1, and the number of faces\nremains the same.",
    "But this means that 𝑣−𝑒+ 𝑓does not change.",
    "Completing a\ncircuit adds one edge, adds one face, and keeps the number of vertices the same.",
    "So\nagain, 𝑣−𝑒+ 𝑓does not change.\n",
    "Since we can build any graph using a combination of these two moves, and doing\nso never changes the quantity 𝑣−𝑒+ 𝑓, that quantity will be the same for all graphs.\n",
    "But notice that our starting graph 𝑃2 has 𝑣= 2, 𝑒= 1, and 𝑓= 1, so 𝑣−𝑒+ 𝑓= 2.\n",
    "The argument we have outlined above is not quite correct, since we made the\nunjustified assumption that all graphs can be built up from 𝑃2 using only the two\nmoves we described.",
    "To avoid this issue, we can use a minimal criminal argument.\n",
    "You are asked to do this in the exercises, but the idea is essentially the same as we\nhave here, except that we start with a minimal connected planar graph that does\nnot satisfy the formula, then remove either an edge or a vertex (and its edge) to get\na smaller connected planar graph that does satisfy the formula.",
    "But just like the\nadding moves we have described above, removing an edge or a vertex does not\nchange the quantity 𝑣−𝑒+ 𝑓.\n2.3.3\nNon-planar Graphs\nInvestigate!\n",
    "For the complete graphs 𝐾𝑛, we would like to be able to say something\nabout the number of vertices, edges, and (if the graph is planar) faces.",
    "Let’s\nfirst consider 𝐾3:\n",
    "1.",
    "How many vertices does 𝐾3 have?",
    "How many edges?\n2.",
    "If 𝐾3 is planar, how many faces should it have?\n",
    "Repeat parts (1) and (2) for 𝐾4, 𝐾5, and 𝐾23.\n",
    "What about complete bipartite graphs?",
    "How many vertices, edges, and\nfaces (if it were planar) does 𝐾7,4 have?",
    "For which values of 𝑚and 𝑛are 𝐾𝑛\nand 𝐾𝑚,𝑛planar?\n",
    "Not all graphs are planar.",
    "If there are too many edges and too few vertices, then\n\n2.3.",
    "Planar Graphs\n133\nsome of the edges will need to intersect.",
    "The smallest graph where this happens is\n𝐾5.\n",
    "If you try to redraw this without edges crossing, you quickly get into trouble.\n",
    "There seems to be one edge too many.",
    "In fact, we can prove that no matter how you\ndraw it, 𝐾5 will always have edges crossing.\n",
    "Theorem 2.3.1\n𝐾5 is not planar.\nProof.",
    "The proof is by contradiction.",
    "So assume that 𝐾5 is planar.",
    "Then the graph\nmust satisfy Euler’s formula for planar graphs.",
    "𝐾5 has 5 vertices and 10 edges, so\nwe get\n5 −10 + 𝑓= 2,\nwhich says that if the graph is drawn without any edges crossing, there would be\n𝑓= 7 faces.\n",
    "Now consider how many edges surround each face.\n",
    "Each face must be\nsurrounded by at least 3 edges.",
    "Let 𝐵be the total number of boundaries around all\nthe faces in the graph.",
    "Thus we have that 3𝑓≤𝐵.",
    "But also 𝐵= 2𝑒, since each edge\nis used as a boundary exactly twice.",
    "Putting this together we get\n3 𝑓≤2𝑒.\nBut this is impossible, since we have already determined that 𝑓= 7 and 𝑒= 10,\nand 21 ̸≤20.",
    "This is a contradiction, so in fact 𝐾5 is not planar.\n",
    "The other simplest graph which is not planar is 𝐾3,3\nProving that 𝐾3,3 is not planar answers the classic houses and utilities puzzle: it\nis not possible to connect each of three houses to each of three utilities without the\nlines crossing.\n",
    "Theorem 2.3.2\n𝐾3,3 is not planar.\n\n134\n2.",
    "Graph Theory\nProof.",
    "Again, we proceed by contradiction.",
    "Suppose 𝐾3,3 were planar.",
    "Then by\nEuler’s formula, there will be 5 faces, since 𝑣= 6, 𝑒= 9, and 6 −9 + 𝑓= 2.\nHow many boundaries surround these 5 faces?",
    "Let 𝐵be this number.",
    "Since\neach edge is used as a boundary twice, we have 𝐵= 2𝑒. Also, 𝐵≥4 𝑓since each\nface is surrounded by 4 or more boundaries.",
    "We know this is true because 𝐾3,3 is\nbipartite, so does not contain any 3-edge cycles.",
    "Thus\n4 𝑓≤2𝑒.\nBut this would say that 20 ≤18, which is clearly false.",
    "Thus 𝐾3,3 is not planar.\n",
    "Note the similarities and differences in these proofs.",
    "Both are proofs by contra-\ndiction, and both start with using Euler’s formula to derive the (supposed) number\nof faces in the graph.",
    "Then we find a relationship between the number of faces and\nthe number of edges based on how many edges surround each face.",
    "This is the only\ndifference.",
    "In the proof for 𝐾5, we got 3𝑓≤2𝑒and for 𝐾3,3 we had 4𝑓≤2𝑒. The\ncoefficient of 𝑓is the key.",
    "It is the smallest number of edges that could surround any\nface.",
    "If some number of edges surround a face, then these edges form a cycle.",
    "So\nthat number is the size of the smallest cycle in the graph.\n",
    "In general, if we let 𝑔be the size of the smallest cycle in a graph (𝑔stands for\ngirth, which is the technical term for this) then for any planar graph we have 𝑔𝑓≤2𝑒.\nWhen this disagrees with Euler’s formula, we know for sure that the graph cannot\nbe planar.\n",
    "2.3.4\nPolyhedra\nInvestigate!\n",
    "A cube is an example of a convex polyhedron.",
    "It contains 6 identical squares\nfor its faces, 8 vertices, and 12 edges.",
    "The cube is a regular polyhedron (also\nknown as a Platonic solid) because each face is an identical regular polygon\nand each vertex joins an equal number of faces.\n",
    "There are exactly four other regular polyhedra: the tetrahedron, octahe-\ndron, dodecahedron, and icosahedron, with 4, 8, 12, and 20 faces respectively.\n",
    "How many vertices and edges do each of these have?\n",
    "Another area of mathematics where you might have heard the terms “vertex,”\n“edge,” and “face” is geometry.",
    "A polyhedron is a geometric solid made up of flat\npolygonal faces joined at edges and vertices.",
    "We are especially interested in convex\npolyhedra, which means that any line segment connecting two points on the interior\nof the polyhedron must be entirely contained inside the polyhedron.7\nNotice that since 8 −12 + 6 = 2, the vertices, edges, and faces of a cube satisfy\nEuler’s formula for planar graphs.",
    "This is not a coincidence.",
    "We can represent a\n7An alternative definition for convex is that the internal angle formed by any two faces must be less\nthan 180 deg.\n\n",
    "2.3.",
    "Planar Graphs\n135\ncube as a planar graph by projecting the vertices and edges onto the plane.",
    "One\nsuch projection looks like this:\nIn fact, every convex polyhedron can be projected onto the plane without edges\ncrossing.",
    "Think of placing the polyhedron inside a sphere, with a light at the center\nof the sphere.",
    "The edges and vertices of the polyhedron cast a shadow onto the\ninterior of the sphere.",
    "You can then cut a hole in the sphere in the middle of one of\nthe projected faces and “stretch” the sphere to lie down flat on the plane.",
    "The face\nthat was punctured becomes the “outside” face of the planar graph.\n",
    "The point is, we can apply what we know about graphs (in particular planar\ngraphs) to convex polyhedra.",
    "Since every convex polyhedron can be represented as\na planar graph, we see that Euler’s formula for planar graphs holds for all convex\npolyhedra as well.",
    "We also can apply the same sort of reasoning we use for graphs\nin other contexts to convex polyhedra.",
    "For example, we know that there is no convex\npolyhedron with 11 vertices all of degree 3, as this would make 33/2 edges.\n",
    "Example 2.3.3\nIs there a convex polyhedron consisting of three triangles and six pentagons?\n",
    "What about three triangles, six pentagons, and five heptagons (7-sided\npolygons)?\n",
    "Solution.\n",
    "How many edges would such polyhedra have?",
    "For the first\nproposed polyhedron, the triangles would contribute a total of 9 edges, and\nthe pentagons would contribute 30.",
    "However, this counts each edge twice\n(as each edge borders exactly two faces), giving 39/2 edges, an impossibility.\n",
    "There is no such polyhedron.\n",
    "The second polyhedron does not have this obstacle.",
    "The extra 35 edges\ncontributed by the heptagons give a total of 74/2 = 37 edges.",
    "So far so good.\n",
    "Now how many vertices does this supposed polyhedron have?",
    "We can use\nEuler’s formula.",
    "There are 14 faces, so we have 𝑣−37 + 14 = 2 or equivalently\n𝑣= 25.",
    "But now use the vertices to count the edges again.",
    "Each vertex must\nhave degree at least three (that is, each vertex joins at least three faces since\nthe interior angle of all the polygons must be less that 180◦), so the sum of the\ndegrees of vertices is at least 75.",
    "Since the sum of the degrees must be exactly\ntwice the number of edges, this says that there are strictly more than 37 edges.\n",
    "Again, there is no such polyhedron.\n",
    "To conclude this application of planar graphs, consider the regular polyhedra.\n\n",
    "136\n2.",
    "Graph Theory\n",
    "We claimed there are only five.",
    "How do we know this is true?",
    "We can prove it using\ngraph theory.\n",
    "Theorem 2.3.4\nThere are exactly five regular polyhedra.\nProof.\n",
    "Recall that all the faces of a regular polyhedron are identical regular\npolygons and that each vertex has the same degree.",
    "Consider four cases, depending\non the type of regular polygon.\n",
    "Case 1: Each face is a triangle.",
    "Let 𝑓be the number of faces.",
    "There are then\n3𝑓/2 edges.",
    "Using Euler’s formula, we have 𝑣−3 𝑓/2 + 𝑓= 2 so 𝑣= 2 + 𝑓/2.\n",
    "Now each vertex has the same degree, say 𝑘.",
    "So the number of edges is also 𝑘𝑣/2.\n",
    "Putting this together gives\n𝑒= 3 𝑓\n2 = 𝑘(2 + 𝑓/2)\n2\n,\nwhich says\n𝑘=\n6𝑓\n4 + 𝑓.\nBoth 𝑘and 𝑓must be positive integers.",
    "Note that\n6𝑓\n4+𝑓is an increasing function\nfor positive 𝑓, bounded above by a horizontal asymptote at 𝑘= 6.",
    "Thus the only\npossible values for 𝑘are 3, 4, and 5.",
    "Each of these is possible.",
    "To get 𝑘= 3, we need\n𝑓= 4 (this is the tetrahedron).",
    "For 𝑘= 4 we take 𝑓= 8 (the octahedron).",
    "For 𝑘= 5\ntake 𝑓= 20 (the icosahedron).",
    "Thus there are exactly three regular polyhedra with\ntriangles for faces.\n",
    "Case 2: Each face is a square.",
    "Now we have 𝑒= 4 𝑓/2 = 2𝑓. Using Euler’s\nformula, we get 𝑣= 2 + 𝑓, and counting edges using the degree 𝑘of each vertex\ngives us\n𝑒= 2 𝑓= 𝑘(2 + 𝑓)\n2\n.\n",
    "Solving for 𝑘gives\n𝑘=\n4 𝑓\n2 + 𝑓=\n8𝑓\n4 + 2 𝑓.\n",
    "This is again an increasing function, but this time the horizontal asymptote is\nat 𝑘= 4, so the only possible value that 𝑘could take is 3.",
    "This produces 6 faces,\nand we have a cube.",
    "There is only one regular polyhedron with square faces.\n",
    "Case 3: Each face is a pentagon.",
    "We perform the same calculation as above,\nthis time getting 𝑒= 5 𝑓/2 so 𝑣= 2 + 3 𝑓/2.",
    "Then\n𝑒= 5𝑓\n2 = 𝑘(2 + 3 𝑓/2)\n2\n,\nso\n𝑘=\n10 𝑓\n4 + 3 𝑓.\n\n2.3.",
    "Planar Graphs\n137\nNow the horizontal asymptote is at 10\n3 .",
    "This is less than 4, so we can only hope\nto have 𝑘= 3.",
    "We can do so by using 12 pentagons, getting the dodecahedron.\n",
    "This is the only regular polyhedron with pentagons as faces.\n",
    "Case 4: Each face is an 𝑛-gon with 𝑛≥6.",
    "Following the same procedure as\nabove, we deduce that\n𝑘=\n2𝑛𝑓\n4 + (𝑛−2) 𝑓,\nwhich will be increasing to a horizontal asymptote of\n2𝑛\n𝑛−2.",
    "When 𝑛= 6, this\nasymptote is at 𝑘= 3.",
    "Any larger value of 𝑛will give an even smaller asymptote.\n",
    "Therefore no regular polyhedra exist with faces larger than pentagons.a\naNotice that you can tile the plane with hexagons.",
    "This is an infinite planar graph; each vertex\nhas degree 3.",
    "These infinitely many hexagons correspond to the limit as 𝑓→∞to make 𝑘= 3.\n",
    "2.3.5\nReading Questions\n1.\nIs the graph shown below planar?",
    "Explain your answer.\n",
    "2.\nSuppose you draw a graph with 10 vertices and 14 edges in such a way that no\nedges cross.",
    "How many faces could your graph have?",
    "Explain your answer(s).\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "2.3.6\nPractice Problems\n1.\nAre the following statements true or false?\n(a) 𝐾7 is planar\n(b) 𝐾6 is not planar\n(c) 𝐾5 is planar\n(d) 𝐾3,3 is planar\n(e) 𝐾4,4 is not planar\n(f) 𝐾4,5 is planar\n(g) 𝐾3,10 is not planar\n(h) 𝐾2,5 is not planar\n\n138\n2.",
    "Graph Theory\n2.\nSuppose 𝐺is a planar connected graph.",
    "It has 15 edges, and 6 faces.",
    "How\nmany vertices does 𝐺have?\n3.\nSuppose a connected graph has 9 vertices, and every vertex has degree 3.\n",
    "a.",
    "How many edges does the graph have?\nb.",
    "If the graph were planar, how many faces would it have?\n4.\nLet’s prove that 𝐾11 is not planar:\n",
    "First, how many vertices and how many edges does 𝐾11 have?\n",
    "If we assume that 𝐾11 were planar, then how many faces would it have?\n",
    "However, since every face is bounded by at least\nedges, and every\nedge borders exactly\nfaces, we can get a bound on the number of faces.\n",
    "What is the largest number of faces possible based on this line of reasoning?\n𝑓≤\n.\n",
    "This is a contradiction, so 𝐾11 is not planar.",
    "QED.\n",
    "5.\nSuppose the graph is planar but not connected, and has 7 components.",
    "Draw\nenough examples to derive a variant of Euler’s formula for this case.\n𝑣−𝑒+ 𝑓=\n.\n",
    "2.3.7\nAdditional Exercises\n1.\nIs it possible for a planar graph to have 6 vertices, 10 edges, and 5 faces?\nExplain.\n",
    "2.\n",
    "The graph 𝐺has 6 vertices with degrees 2, 2, 3, 4, 4, 5.",
    "How many edges does\n𝐺have?",
    "Could 𝐺be planar?",
    "If so, how many faces would it have?",
    "If not,\nexplain.\n",
    "3.\nIs it possible for a connected graph with 7 vertices and 10 edges to be drawn\nso that no edges cross and create 4 faces?",
    "Explain.\n",
    "4.\nIs it possible for a graph with 10 vertices and edges to be a connected planar\ngraph?",
    "Explain.\n",
    "5.\nIs there a connected planar graph with an odd number of faces where every\nvertex has degree 6?",
    "Prove your answer.\n",
    "6.\nI’m thinking of a polyhedron containing 12 faces.",
    "Seven are triangles and four\nare quadrilaterals.",
    "The polyhedron has 11 vertices including those around the\nmystery face.",
    "How many sides does the last face have?\n7.\nConsider some classic polyhedrons.\n",
    "(a) An octahedron is a regular polyhedron made up of 8 equilateral triangles\n(it sort of looks like two pyramids with their bases glued together).",
    "Draw\na planar graph representation of an octahedron.",
    "How many vertices,\nedges, and faces does an octahedron (and your graph) have?\n(b) The traditional design of a soccer ball is a (spherical projection of a)\ntruncated icosahedron.",
    "This consists of 12 regular pentagons and 20\n\n2.3.",
    "Planar Graphs\n139\nregular hexagons.",
    "No two pentagons are adjacent (so the edges of each\npentagon are shared only by hexagons).",
    "How many vertices, edges,\nand faces does a truncated icosahedron have?",
    "Explain how you arrived\nat your answers.",
    "Bonus: draw the planar graph representation of the\ntruncated icosahedron.\n",
    "(c) Your “friend” claims that he has constructed a convex polyhedron out\nof 2 triangles, 2 squares, 6 pentagons, and 5 octagons.",
    "Prove that your\nfriend is lying.",
    "Hint: each vertex of a convex polyhedron must border at\nleast three faces.\n",
    "8.\nProve Euler’s formula using a minimal criminal argument, where minimum\nmeans smallest number of edges\n9.\nProve Euler’s formula using a minimal criminal argument, where minimum\nmeans smallest number of vertices.\n",
    "10.\n",
    "Euler’s formula (𝑣−𝑒+ 𝑓= 2) holds for all connected planar graphs.",
    "What if a\ngraph is not connected?",
    "Suppose a planar graph has two components.",
    "What is\nthe value of 𝑣−𝑒+ 𝑓now?",
    "What if it has 𝑘components?\n11.\nProve that the Petersen graph (below) is not planar.\n12.\nProve that any planar graph with 𝑣vertices and 𝑒edges satisfies 𝑒≤3𝑣−6.\n13.\n",
    "Prove that any planar graph must have a vertex of degree 5 or less.\n",
    "14.\nGive a careful proof that the graph below is not planar.\n15.\nExplain why we cannot use the same sort of proof we did in Exercise 2.3.7.14\nto prove that the graph below is not planar.",
    "Then explain how you know the\ngraph is not planar anyway.\n\n",
    "140\n2.",
    "Graph Theory\n\n2.4\nEuler Trails and Circuits\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Identify whether a graph or multigraph has an Euler trail or circuit.\n",
    "2. Justify why the necessary condition for a graph having an Euler trail\nis necessary.\n",
    "3.",
    "Distinguish between Euler trails and Hamilton paths, and decide\nwhich is more appropriate to use for a given problem.\n",
    "2.4.1\nSection Preview\nInvestigate!\n",
    "A spider is standing on one face of an octahedron (a polyhedron with eight\ntriangular faces).",
    "She wants to crawl along the solid from face to face so that\nshe crosses each edge exactly once.",
    "Is this possible?",
    "If so, how?\n",
    "If we start at a vertex and trace along edges to get to other vertices, we create a\nwalk through the graph.",
    "More precisely, a walk in a graph is a sequence of vertices\nsuch that every vertex in the sequence is adjacent to the vertices before and after it\nin the sequence.",
    "If the walk travels along every edge exactly once, then the walk is\ncalled an Euler trail (or Euler walk or Euler path).",
    "If, in addition, the starting and\nending vertices are the same (so you trace along every edge exactly once and end\nup where you started), then the walk is called an Euler circuit (or Euler tour).",
    "Of\ncourse if a graph is not connected, there is no hope of finding such a trail or circuit.\n",
    "For the rest of this section, assume all the graphs discussed are connected.\n",
    "The bridges of Königsberg problem is really a question about the existence of\nEuler trails.",
    "There will be a route that crosses every bridge exactly once if and only\nif the multigraph below has an Euler trail:\n141\n\n142\n2.",
    "Graph Theory\n",
    "This graph is small enough that we could actually check every possible walk that\ndoes not reuse edges, and in doing so convince ourselves that there is no Euler trail\n(let alone an Euler circuit).",
    "On small graphs that do have an Euler trail, it is usually\nnot difficult to find one.",
    "Our goal is to find a quick way to check whether a graph\nhas an Euler trail or circuit, even if the graph is quite large.\n",
    "Preview Activity\nWhich of the graphs below have an Euler trail?",
    "Which have an Euler circuit?\n𝐺1\n𝐺2\n𝐺3\n𝐺4\n𝐺5\n𝐺6\n1.\nWrite down the degree sequence of the graphs above.\n",
    "What might the connection be between the degree sequence and the\nexistence of an Euler trail or circuit?\n2.\n",
    "One way to write down an Euler trail or circuit is to list the edges in order.",
    "Each\nedge will be a pair of vertices, and to indicate what direction we travel over\n\n2.4.",
    "Euler Trails and Circuits\n143\nthat edge, we can write it as an ordered pair rather than a set.",
    "For example,\nconsider this graph:\na\nb\nc\nd\nThere are two Euler trails we could write:\n(𝑎, 𝑏), (𝑏, 𝑐), (𝑐, 𝑑)\nor\n(𝑑, 𝑐), (𝑐, 𝑏), (𝑏, 𝑎).\n",
    "(a) Write down an Euler trail for the graph below.\n",
    "a\nb\nc\ne\nd\nf\n",
    "For each vertex, write down its degree and the number of times it appears\nin your list of edges.\n",
    "(b) Suppose you have a graph with degree sequence (4, 2, 2, 2, 2) that has an\nEuler trail.",
    "How many times will the name of the degree 4 vertex appear\nin your list of edges?\n",
    "(c) Suppose you have a graph with an Euler trail written as a list of edges.\n",
    "What can you conclude about a vertex that appears exactly 3 times in the\nlist?",
    "Select all the choices that could be true.\n",
    "2.4.2\nConditions for Euler Trails\nOne way to guarantee that a graph does not have an Euler circuit is to include a\n“spike,” a vertex of degree 1.\n",
    "𝑎\nThe vertex 𝑎has degree 1, and if you try to make an Euler circuit, you see that\nyou will get stuck at the vertex.",
    "It is a dead end.",
    "That is, unless you start there.",
    "But\nthen there is no way to return, so there is no hope of finding an Euler circuit.",
    "There\nis however an Euler trail.",
    "It starts at the vertex 𝑎, then loops around the triangle.\n",
    "You will end at the vertex of degree 3.\n",
    "You run into a similar problem whenever you have a vertex of any odd degree.\n",
    "If you start at such a vertex, you will not be able to end there (after traversing every\nedge exactly once).",
    "After using one edge to leave the starting vertex, you will be left\n\n144\n2.",
    "Graph Theory\nwith an even number of edges emanating from the vertex.",
    "Half of these could be\nused for returning to the vertex, the other half for leaving.",
    "So you return, then leave.\n",
    "Return, then leave.",
    "The only way to use up all the edges is to use the last one by\nleaving the vertex.",
    "On the other hand, if you have a vertex with odd degree at which\nyou do not start a trail, then you will eventually get stuck at that vertex.",
    "The trail\nwill use pairs of edges incident to the vertex to arrive and leave again.",
    "Eventually all\nbut one of these edges will be used up, leaving only an edge to arrive by, and none\nto leave again.\n",
    "What all this says is that if a graph has an Euler trail and two vertices with odd\ndegree, then the Euler trail must start at one of the odd-degree vertices and end at\nthe other.",
    "In such a situation, every other vertex must have an even degree since we\nneed an equal number of edges to get to those vertices as to leave them.",
    "How could\nwe have an Euler circuit?",
    "The graph could not have any odd-degree vertex as an\nEuler trail would have to start there or end there, but not both.",
    "Thus for a graph to\nhave an Euler circuit, all vertices must have even degree.\n",
    "The converse is also true: if all the vertices of a graph have even degree, then the\ngraph has an Euler circuit, and if there are exactly two vertices with odd degree,\nthe graph has an Euler trail.",
    "To prove this is a little tricky, but the basic idea is that\nyou will never get stuck because there is an “outbound” edge for every “inbound”\nedge at every vertex.",
    "If you try to make an Euler trail and miss some edges, you will\nalways be able to “splice in” a circuit using the edges you previously missed.\n",
    "Euler Trails and Circuits.\n",
    "•",
    "A graph has an Euler circuit if and only if the degree of every vertex is\neven.\n",
    "•",
    "A graph has an Euler trail if and only if there are at most two vertices\nwith odd degree.\n",
    "Since the bridges of Königsberg graph has all four vertices with odd degree,\nthere is no Euler trail through the graph.",
    "Thus there is no way for the townspeople\nto cross every bridge exactly once.\n",
    "2.4.3\nHamilton Paths\nSuppose you wanted to tour Königsberg in such a way that you visit each land\nmass (the two islands and both banks) exactly once.",
    "This can be done.",
    "In graph\ntheory terms, we are asking whether there is a path that visits every vertex exactly\nonce.",
    "Such a path is called a Hamilton path (or Hamiltonian path).",
    "We could also\nconsider Hamilton cycles, which are Hamilton paths that start and stop at the same\nvertex.\n\n",
    "2.4.",
    "Euler Trails and Circuits\n145\nExample 2.4.1\nDetermine whether the graphs below have a Hamilton path.\n",
    "Solution.\n",
    "The graph on the left has a Hamilton path (many different ones,\nactually), as shown here:\nThe graph on the right does not have a Hamilton path.",
    "You would need\nto visit each of the “outside” vertices, but as soon as you visit one, you get\nstuck.",
    "Note that this graph does not have an Euler trail, although there are\ngraphs with Euler trails but no Hamilton paths.\n",
    "It appears that finding Hamilton paths would be easier because graphs often\nhave more edges than vertices, so there are fewer requirements to be met.",
    "However,\nnobody knows whether this is true.",
    "There is no known simple test for whether a\ngraph has a Hamilton path.",
    "For small graphs this is not a problem, but as the size of\nthe graph grows, it gets harder and harder to check whether there is a Hamilton path.\n",
    "In fact, this is an example of a question which as far as we know is too difficult for\ncomputers to solve in general, as it is an example of a problem that is NP-complete.\n",
    "2.4.4\nReading Questions\n1.\nIs there a graph that has an Euler circuit but not an Euler trail?",
    "Explain your\nanswer.\n",
    "2.\nCan a tree have an Euler tour?",
    "Can a tree have an Euler circuit?",
    "Explain your\nanswers.\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n\n146\n2.",
    "Graph Theory\n2.4.5\nPractice Problems\n1.\nFind an Euler trail in the following graph.\n",
    "𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\n2.\n",
    "Which of the graphs below have an Euler circuit?",
    "If a graph has an Euler\ncircuit, find it.\n",
    "(a)\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\nℎ\n𝑖\n(b)\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\nℎ\n𝑖\n(c)\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\nℎ\n𝑖\n3.\n",
    "Determine which of the following graphs have an Euler circuit or an Euler\ntrail.\n",
    "(a)\n𝑉={𝑎, 𝑏, 𝑐, 𝑑, 𝑒, 𝑓}\n𝐸={𝑎𝑏, 𝑎𝑓, 𝑏𝑐, 𝑐𝑑, 𝑐𝑒, 𝑐𝑓, 𝑑𝑒, 𝑒𝑓}\n(b) The graph given by the adjacency list:\nu\nv,w,y,z\nv\nu,w,x,y\nw\nu,v,x,z\nx\nv,w,y,z\ny\nu,v,x,z\nz\nu,w,x,y\n(c)",
    "The graph given by the adjacency matrix:\n©­­­­­­­­\n«\n0\n1\n1\n0\n0\n1\n1\n0\n1\n1\n0\n0\n1\n1\n0\n0\n1\n0\n0\n1\n0\n0\n1\n1\n0\n0\n1\n1\n0\n1\n1\n0\n0\n1\n1\n0\nª®®®®®®®®\n¬\n\n2.4.",
    "Euler Trails and Circuits\n147\n4.\nAdd an edge to the following graph (between a pair of vertices that are not\nalready adjacent) to make it have an Euler trail.",
    "Then find the Euler trail.\n",
    "𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n2.4.6\nAdditional Exercises\n1.\n",
    "You and your friends want to tour the southwest by car.",
    "You will visit the nine\nstates below, with the following rather odd rule: You must cross each border\nbetween neighboring states exactly once (so, for example, you must cross the\nColorado-Utah border exactly once).",
    "Can you do it?",
    "If so, does it matter where\nyou start your road trip?",
    "What fact about graph theory solves this problem?\n2.\nWhich of the following graphs contain an Euler trail?",
    "Which contain an Euler\ncircuit?\n(a) 𝐾4\n(b) 𝐾5.\n",
    "(c) 𝐾5,7\n(d) 𝐾2,7\n(e) 𝐶7\n(f) 𝑃7\n3.\nEdward A. Mouse has just finished his brand new house.",
    "The floor plan is\nshown below:\n(a) Edward wants to give a tour of his new pad to a lady-mouse friend.",
    "Is it\npossible for them to walk through every doorway exactly once?",
    "If so, in\nwhich rooms must they begin and end the tour?",
    "Explain.\n",
    "(b) Is it possible to tour the house visiting each room exactly once (not\nnecessarily using every doorway)?",
    "Explain.\n",
    "(c) After a few mouse-years, Edward decides to remodel.",
    "He would like to\n\n148\n2.",
    "Graph Theory\nadd some new doors between the rooms he has.",
    "Of course, he cannot\nadd any doors to the exterior of the house.",
    "Is it possible for each room to\nhave an odd number of doors?",
    "Explain.\n",
    "4.\nFor which 𝑛does the graph 𝐾𝑛contain an Euler circuit?",
    "Explain.\n",
    "5.\nFor which 𝑚and 𝑛does the graph 𝐾𝑚,𝑛contain an Euler trail?",
    "An Euler\ncircuit?",
    "Explain.\n",
    "6.\nFor which 𝑛does 𝐾𝑛contain a Hamilton path?",
    "A Hamilton cycle?",
    "Explain.\n",
    "7.\nFor which 𝑚and 𝑛does the graph 𝐾𝑚,𝑛contain a Hamilton path?",
    "A Hamilton\ncycle?",
    "Explain.\n",
    "8.\n",
    "A bridge builder has come to Königsberg and would like to add bridges so\nthat it is possible to travel over every bridge exactly once.",
    "How many bridges\nmust be built?\n9.\n",
    "Below is a graph representing friendships between a group of students (each\nvertex is a student and each edge is a friendship).",
    "Is it possible for the students\nto sit around a round table in such a way that every student sits between two\nfriends?",
    "What does this question have to do with trails?\n10.\n",
    "On the table rest 8 dominoes, as shown below.",
    "If you were to line them up in a\nsingle row, so that any two sides touching had matching numbers, what would\nthe sum of the two end numbers be?\n11.\n",
    "Is there anything we can say about whether a graph has a Hamilton path based\non the degrees of its vertices?\n(a) Suppose a graph has a Hamilton path.",
    "What is the maximum number of\nvertices of degree one the graph can have?",
    "Explain why your answer is\ncorrect.\n",
    "(b) Find a graph that does not have a Hamilton path even though no vertex\nhas degree one.",
    "Explain why your example works.\n\n",
    "2.4.",
    "Euler Trails and Circuits\n149\n12.\nConsider the following graph:\n(a) Find a Hamilton path.",
    "Can your path be extended to a Hamilton cycle?\n(b) Is the graph bipartite?",
    "If so, how many vertices are in each “part”?\n(c) Use your answer to part (b) to prove that the graph has no Hamilton\ncycle.\n",
    "(d) Suppose you have a bipartite graph 𝐺in which one part has at least two\nmore vertices than the other.",
    "Prove that 𝐺does not have a Hamilton path.\n\n",
    "2.5\nColoring\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1.",
    "Determine the chromatic number of a graph.\n",
    "2. Determine the chromatic index of a graph\n3.",
    "Decide whether using the chromatic number or chromatic index is\nmore appropriate to solve particular problems.\n",
    "2.5.1\nSection Preview\nInvestigate!\nMapmakers in the fictional land of Euleria have drawn the borders of the\nvarious dukedoms of the land.",
    "To make the map pretty, they wish to color\neach region.",
    "Adjacent regions must be colored differently, but it is perfectly\nfine to color two distant regions with the same color.",
    "What is the fewest\ncolors the mapmakers can use and still accomplish this task?\n150\n\n2.5.",
    "Coloring\n151\nPerhaps the most famous graph theory problem is how to color maps.\n",
    "Given any map of countries, states, counties, etc., how many colors are\nneeded to color each region on the map so that neighboring regions are\ncolored differently?\n",
    "Actual map makers usually use around seven colors.",
    "For one thing, they require\nwatery regions to be a specific color, and with a lot of colors it is easier to find a\npermissible coloring.",
    "We want to know whether there is a smaller palette that will\nwork for any map.\n",
    "How is this related to graph theory?",
    "Well, if we place a vertex in the center of\neach region (say in the capital of each state) and then connect two vertices if their\nstates share a border, we get a graph.",
    "Coloring regions on the map corresponds\nto coloring the vertices of the graph.",
    "Since neighboring regions cannot be colored\nthe same, our graph cannot have vertices colored the same when those vertices are\nadjacent.\n",
    "In general, given any graph 𝐺, a coloring of the vertices is called (not surprisingly)\na vertex coloring.",
    "If the vertex coloring has the property that adjacent vertices are\ncolored differently, then the coloring is called proper.",
    "Every graph has a proper\nvertex coloring.",
    "For example, you could color every vertex with a different color.\n",
    "But often you can do better.",
    "The smallest number of colors needed to get a proper\nvertex coloring is called the chromatic number of the graph, written 𝜒(𝐺).\n",
    "Our goal in this section is to see how graph coloring can be used to solve some\nproblems and to understand some basic properties of graph coloring.\n",
    "Preview Activity\nFor each graph below:\n• Find a proper vertex coloring using some number of colors.",
    "That is, color\nvertices using any number of colors but in such a way that no pair of adjacent\nvertices have the same color.\n",
    "• Find the fewest number of colors you need to properly color the vertices of the\ngraph.",
    "This is called the chromatic number of the graph.",
    "Think about how\nyou know your answer is correct.\n",
    "• Can you generalize?",
    "Can you conclude anything about the chromatic number\nfor particular sorts of graphs?\n\n152\n2.",
    "Graph Theory\n1.\n2.\n3.\n4.\n5.\n6.\n",
    "2.5.2\nColoring Vertices\nInvestigate!\n",
    "The math department plans to offer 10 classes next semester.",
    "Some classes\ncannot run at the same time (perhaps they are taught by the same professor,\nor are required for seniors).\n\n",
    "2.5.",
    "Coloring\n153\nClass:\nConflicts with:\nA\nD I\nB\nD",
    "I J\nC\nE F I\nD\nA B F\nE\nC H I\nF\nC D I\nG\nJ\nH\nE",
    "I J\nI\nA B C E F H\nJ\nB G H\nHow many different time slots are needed to teach these classes (and which\nshould be taught at the same time)?",
    "More importantly, how could we use\ngraph coloring to answer this question?\n",
    "The best way to get a feel for the chromatic number is to actually try to color\nsome graphs.\n",
    "Example 2.5.1\nFind the chromatic number of the graphs below.\n",
    "Solution.\n",
    "The graph on the left is 𝐾6.",
    "The only way to properly color the\ngraph is to give every vertex a different color (since every vertex is adjacent to\nevery other vertex).",
    "Thus the chromatic number is 6.\n",
    "The middle graph can be properly colored with just 3 colors (Red, Blue,\nand Green).",
    "For example:\nR\nB\nG\nR\nG\nB\n\n154\n2.",
    "Graph Theory\nThere is no way to color it with just two colors, since there are three\nvertices mutually adjacent (i.e., a triangle).",
    "Thus the chromatic number is 3.\n",
    "The graph on the right is just 𝐾2,3.",
    "As with all bipartite graphs, this graph\nhas chromatic number 2: color the vertices on the top row red and the vertices\non the bottom row blue.\n",
    "It appears that there is no limit to how large chromatic numbers can get.",
    "It\nshould not come as a surprise that 𝐾𝑛has chromatic number 𝑛.",
    "So how could\nthere possibly be an answer to the original map coloring question?",
    "If the chromatic\nnumber of a graph can be arbitrarily large, then it seems like there would be no\nupper bound to the number of colors needed for any map.",
    "But there is.\n",
    "The key observation is that while it is true that for any number 𝑛there is a graph\nwith chromatic number 𝑛, only some graphs arrive as representations of maps.",
    "If\nyou convert a map to a graph, the edges between vertices correspond to borders\nbetween the countries.",
    "So you should be able to connect vertices in such a way that\nthe edges do not cross.",
    "In other words, the graphs representing maps are all planar!\n",
    "So the question is, what is the largest chromatic number of any planar graph?\n",
    "The answer is the best-known theorem of graph theory:\nTheorem 2.5.2 The Four Color Theorem.\n",
    "If 𝐺is a planar graph, then the chromatic number of 𝐺is less than or equal to 4.",
    "Thus\nany map can be properly colored with 4 or fewer colors.\n",
    "We will not prove this theorem.",
    "Really.",
    "Even though the theorem is easy to state\nand understand, the proof is not.",
    "In fact, there is currently no “easy” known proof\nof the theorem.",
    "The current best proof still requires powerful computers to check\nan unavoidable set of 633 reducible configurations.",
    "The idea is that every graph must\ncontain one of these reducible configurations (this fact also needs to be checked by a\ncomputer) and that reducible configurations can, in fact, be colored in 4 or fewer\ncolors.\n",
    "Cartography is certainly not the only application of graph coloring.",
    "There are\nplenty of situations in which you might wish to partition the objects in question so\nthat related objects are not in the same set.",
    "For example, you might wish to store\nchemicals safely.",
    "To avoid explosions, certain pairs of chemicals should not be stored\nin the same room.",
    "By coloring a graph (with vertices representing chemicals and\nedges representing potential negative interactions), you can determine the smallest\nnumber of rooms needed to store the chemicals.\n",
    "Here is a further example:\nExample 2.5.3\nRadio stations broadcast their signal at certain frequencies.",
    "However, there\nare a limited number of frequencies to choose from, so nationwide, many\n\n2.5.",
    "Coloring\n155\nstations use the same frequency.",
    "This works because the stations are far\nenough apart that their signals will not interfere; no one radio could pick\nthem up at the same time.\n",
    "Suppose 10 new radio stations are to be set up in a currently unpopulated\n(by radio stations) region.",
    "The radio stations that are close enough to each\nother to cause interference are recorded in the table below.",
    "What is the fewest\nnumber of frequencies the stations could use?\nKQEA\nKQEB\nKQEC\nKQED\nKQEE\nKQEF\nKQEG\nKQEH\nKQEI\nKQEJ\nKQEA\nx\nx\nx\nx\nKQEB\nx\nx\nKQEC\nx\nx\nx\nx\nKQED\nx\nx\nx\nx\nKQEE\nx\nx\nKQEF\nx\nx\nx\nx\nx\nKQEG\nx\nx\nx\nx\nKQEH\nx\nx\nKQEI\nx\nx\nx\nKQEJ\nx\nx\nx\nx\nx\nSolution.\n",
    "Represent the problem as a graph with vertices as the stations\nand edges when two stations are close enough to cause interference.",
    "We are\nlooking for the chromatic number of the graph.",
    "Vertices that are colored\nidentically represent stations that can have the same frequency.\n",
    "This graph has chromatic number 5.",
    "A proper 5-coloring is shown on the\nright.",
    "Notice that the graph contains a copy of the complete graph 𝐾5, so no\nfewer than 5 colors can be used.\n",
    "KQEA\nKQEC\nKQEB\nKQED\nKQEE\nKQEI\nKQEJ\nKQEF\nKQEG\nKQEH\nR\nB\nG\nB\nG\nB\nP\nG\nY\nR\nIn the example above, the chromatic number was 5, but this is not a counterexam-\nple to the Four Color Theorem 2.5.2, since the graph representing the radio stations\nis not planar.",
    "It would be nice to have some quick way to find the chromatic number\nof a (possibly non-planar) graph.",
    "It turns out nobody knows whether an efficient\nalgorithm for computing chromatic numbers exists.\n",
    "While we might not be able to find the exact chromatic number of a graph easily,\nwe can often give a reasonable range for the chromatic number.",
    "In other words, we\ncan give upper and lower bounds for the chromatic number.\n",
    "This is not very difficult: for every graph 𝐺, the chromatic number of 𝐺is at least\n\n156\n2.",
    "Graph Theory\n1 and at most the number of vertices of 𝐺.\nWhat?",
    "You want better bounds on the chromatic number?",
    "Well, you are in luck.\n",
    "A clique in a graph is a set of vertices all of which are pairwise adjacent.",
    "In\nother words, a clique of size 𝑛is just a copy of the complete graph 𝐾𝑛.",
    "We define the\nclique number of a graph to be the largest 𝑛for which the graph contains a clique\nof size 𝑛. Any clique of size 𝑛cannot be colored with fewer than 𝑛colors, so we\nhave a nice lower bound:\nTheorem 2.5.4\nThe chromatic number of a graph 𝐺is at least the clique number of 𝐺.\nThere are times when the chromatic number of 𝐺is equal to the clique number.\n",
    "These graphs have a special name; they are called perfect.",
    "If you know that a graph\nis perfect, then finding the chromatic number is simply a matter of searching for the\nlargest clique.8 However, not all graphs are perfect.\n",
    "For an upper bound, we can improve on “the number of vertices” by looking\nat the degrees of vertices.",
    "Let Δ(𝐺) be the largest degree of any vertex in the\ngraph 𝐺. One reasonable guess for an upper bound on the chromatic number is\n𝜒(𝐺) ≤Δ(𝐺)",
    "+",
    "1.",
    "Why is this reasonable?",
    "Starting with any vertex, it together with\nall of its neighbors can always be colored in Δ(𝐺)",
    "+ 1 colors, since at most we are\ntalking about Δ(𝐺)",
    "+ 1 vertices in this set.",
    "Now fan out!",
    "At any point, if you consider\nan already colored vertex, some of its neighbors might be colored, some might not.\n",
    "But no matter what, that vertex and its neighbors could all be colored distinctly,\nsince there are at most Δ(𝐺) neighbors, plus the one vertex being considered.\n",
    "In fact, there are examples of graphs for which 𝜒(𝐺) = Δ(𝐺)",
    "+",
    "1.",
    "For any 𝑛, the\ncomplete graph 𝐾𝑛has chromatic number 𝑛, but Δ(𝐾𝑛) = 𝑛−1 (since every vertex\nis adjacent to every other vertex).",
    "Additionally, any odd cycle will have chromatic\nnumber 3, but the degree of every vertex in a cycle is 2.",
    "It turns out that these are\nthe only two types of examples where we get equality, a result known as Brooks’\nTheorem.\n",
    "Theorem 2.5.5 Brooks’ Theorem.\n",
    "Any graph 𝐺satisfies 𝜒(𝐺) ≤Δ(𝐺), unless 𝐺is a complete graph or an odd cycle, in\nwhich case 𝜒(𝐺) = Δ(𝐺)",
    "+",
    "1.\n",
    "The proof of this theorem is just complicated enough that we will not present\nit here (although you are asked to prove a special case in the exercises).\n",
    "The\nadventurous reader is encouraged to find a book on graph theory to find suggestions\nfor how to prove the theorem.\n",
    "8There are special classes of graphs that can be proved to be perfect.",
    "One such class is the set of\nchordal graphs, which have the property that every cycle in the graph contains a chord—an edge\nbetween two vertices in the cycle which are not adjacent in the cycle.\n\n",
    "2.5.",
    "Coloring\n157\n2.5.3\nColoring Edges\nThe chromatic number of a graph tells us about coloring vertices, but we could\nalso ask about coloring edges.",
    "Just like with vertex coloring, we might insist that\nadjacent edges must be colored differently.",
    "Here, we are thinking of two edges as\nbeing adjacent if they are incident to the same vertex.",
    "The least number of colors\nrequired to properly color the edges of a graph 𝐺is called the chromatic index of 𝐺,\nwritten 𝜒′(𝐺).\n",
    "Example 2.5.6\nSix friends decide to spend the afternoon playing chess.",
    "Everyone will play\neveryone else once.",
    "They have plenty of chess sets, but nobody wants to play\nmore than one game at a time.",
    "Games will last an hour (thanks to their handy\nchess clocks).",
    "How many hours will the tournament last?\n",
    "Solution.\n",
    "Represent each player with a vertex and put an edge between two\nplayers if they play each other.",
    "In this case, we get the graph 𝐾6:\nWe must color the edges; each color represents a different hour.",
    "Since\ndifferent edges incident to the same vertex will be colored differently, no\nplayer will be playing two different games (edges) at the same time.",
    "Thus we\nneed to know the chromatic index of 𝐾6.\n",
    "Notice that for sure 𝜒′(𝐾6) ≥5, since there is a vertex of degree 5.",
    "It turns\nout, 5 colors is enough (go find such a coloring).",
    "Therefore the friends will\nplay for 5 hours.\n",
    "Interestingly, if one of the friends in the above example left, the remaining 5\nchessletes would still need 5 hours: the chromatic index of 𝐾5 is also 5.\n",
    "In general, what can we say about the chromatic index?",
    "Certainly 𝜒′(𝐺) ≥Δ(𝐺).\n",
    "But how much higher could it be?",
    "Only a little higher.\n",
    "Theorem 2.5.7 Vizing’s Theorem.\n",
    "For any graph 𝐺, the chromatic index 𝜒′(𝐺) is either Δ(𝐺) or Δ(𝐺)",
    "+ 1.\n",
    "At first, this theorem makes it seem like the chromatic index might not be very\ninteresting.",
    "However, deciding which case a graph is in is not always easy.",
    "Graphs\nfor which 𝜒′(𝐺) = Δ(𝐺) are called class 1, while the others are called class 2.",
    "Bipartite\ngraphs always satisfy 𝜒′(𝐺)",
    "= Δ(𝐺), so are class 1 (this was proved by König in 1916,\ndecades before Vizing proved his theorem in 1964).",
    "In 1965 Vizing proved that all\n\n158\n2.",
    "Graph Theory\nplanar graphs with Δ(𝐺)",
    "≥8 are of class 1, but this does not hold for all planar\ngraphs with 2 ≤Δ(𝐺) ≤5.",
    "Vizing conjectured that all planar graphs with Δ(𝐺) = 6\nor Δ(𝐺)",
    "= 7 are class 1; the Δ(𝐺)",
    "= 7 case was proved in 2001 by Sanders and Zhao;\n",
    "the Δ(𝐺) = 6 case is still open.\n",
    "Ramsey Theory.\n",
    "There is another interesting way we might consider coloring\nedges, quite different from what we have discussed so far.",
    "What if we colored\nevery edge of a graph either red or blue?",
    "Can we do so without, say, creating a\nmonochromatic triangle (i.e., an all red or all blue triangle)?",
    "Certainly, for some graphs\nthe answer is yes.",
    "Try doing so for 𝐾4.",
    "What about 𝐾5? 𝐾6?",
    "How far can we go?\n",
    "The problem above is not too difficult and is a fun exercise.",
    "We could extend the\nquestion in a variety of ways.",
    "What if we had three colors?",
    "What if we were trying\nto avoid other graphs?",
    "Surprisingly, very little is known about these questions.",
    "For\nexample, we know that you need to go up to 𝐾17 in order to force a monochromatic\ntriangle using three colors, but nobody knows how big you need to go with more\ncolors.",
    "Similarly, we know that using two colors, 𝐾18 is the smallest graph that forces\na monochromatic copy of 𝐾4, but the best we have to force a monochromatic 𝐾5 is a\nrange, somewhere from 𝐾43 to 𝐾49.",
    "If you are interested in these sorts of questions,\nthis area of graph theory is called Ramsey theory.",
    "Check it out.\n",
    "2.5.4\nReading Questions\n1.\nTrue or false: if a graph contains a vertex of degree 5, then the chromatic\nnumber of the graph is at least 5.",
    "Explain.\n",
    "2.\nIn your own words, explain the difference between chromatic number and\nchromatic index.\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "2.5.5\nPractice Problems\n1.\nEach of the following problems can be solved by finding either the chromatic\nnumber of a graph or the chromatic index of a graph.\n",
    "For each problem, say whether you should find a proper coloring of the\nvertices or of the edges of the graph to solve the problem.",
    "Note: you likely don’t\nhave enough information to actually solve the problem, but this is okay.",
    "Just\nsay in principle whether this is an edge-coloring or vertex-coloring application.\n(a) Professor Snape stores potion ingredients in as few cabinets as possible,\nbut some ingredients can’t be stored in the same cabinet because they\ncould interact dangerously.",
    "How many cabinets are required?\n(b) At a speed dating event, everyone must spend 5 minutes talking to\nanother person before moving on to the next.",
    "How long must the event\nbe?\n\n2.5.",
    "Coloring\n159\n(c) Five students will interview with four companies for internships at a job\nfair.",
    "How many time slots are needed for interviews?\n(d)",
    "The math department wants to schedule common, day-long midterm\nexams over Spring Break, but obviously a student in two classes has to\nhave their exams for those classes on different days (and this is the only\nproblem with this plan).",
    "How many days are needed for exams?\n2.\n",
    "What is the chromatic number of each graph?\n𝑃13\n𝐶4\n𝐶13\n𝐾6,8\n𝐾7\n3.\n",
    "What is the chromatic index of each graph?\n𝑃14\n𝐶12\n",
    "𝐶5\n𝐾4,9\n𝐾8\n4.\n",
    "The following statements are about the chromatic number 𝜒(𝐺) and the\nchromatic index 𝜒′(𝐺) of graphs.",
    "We use Δ(𝐺) for the maximum degree of 𝐺.\nAre the following statements true or false?\n(a) If a graph contains a vertex of degree 6, then the chromatic index of the\ngraph is at least 6.\n(b) 𝜒′(𝐺) ≥Δ(𝐺).\n",
    "(c) The chromatic index of any planar graph is at most 4.\n(d) For any cycle, the chromatic index is equal to the chromatic number.\n",
    "2.5.6\nAdditional Exercises\n1.\n",
    "What is the smallest number of colors you need to properly color the vertices\nof 𝐾4,5?",
    "That is, find the chromatic number of the graph.\n",
    "2.\nDraw a graph with chromatic number 6 (i.e., which requires 6 colors to properly\ncolor the vertices).",
    "Could your graph be planar?",
    "Explain.\n",
    "3.\nFind the chromatic number of each of the following graphs.\n\n",
    "160\n2.",
    "Graph Theory\n4.\n",
    "A group of 10 friends decides to head up to a cabin in the woods (where\nnothing could possibly go wrong).",
    "Unfortunately, a number of these friends\nhave dated each other in the past, and things are still a little awkward.",
    "To get to\nthe cabin, they need to divide up into some number of cars, and no two people\nwho dated should be in the same car.\n",
    "(a) What is the smallest number of cars you need if all the relationships were\nstrictly heterosexual?",
    "Represent an example of such a situation with a\ngraph.",
    "What kind of graph do you get?\n(b) Because a number of these friends dated there are also conflicts between\nfriends of the same gender, listed below.",
    "Now what is the smallest\nnumber of conflict-free cars they could take to the cabin?\n",
    "Friend\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nConflicts\nCFJ\nJ\nAEF\nH\nCFG\nACEGI\nEFI\nD\nAFG\nB\n5.\n",
    "What is the smallest number of colors that can be used to color the vertices of\na cube so that no two adjacent vertices are colored identically?\n",
    "6.\nProve the chromatic number of any tree is two.",
    "Recall, a tree is a connected\ngraph with no cycles.\n",
    "(a) Describe a procedure to color the tree below.\n",
    "(b) The chromatic number of 𝐶𝑛is two when 𝑛is even.",
    "What goes wrong\nwhen 𝑛is odd?\n(c) Prove that your procedure from part (a) always works for any tree.\n\n",
    "2.5.",
    "Coloring\n161\n(d) Now, prove using induction that every tree has chromatic number 2.\n7.\n",
    "The two problems below can be solved using graph coloring.\n",
    "For each\nproblem, represent the situation with a graph, say whether you should be\ncoloring vertices or edges and why, and use the coloring to solve the problem.\n",
    "(a) Your Quidditch league has 5 teams.",
    "You will play a tournament next\nweek in which every team will play every other team once.",
    "Each team\ncan play at most one match each day, but there is plenty of time in the\nday for multiple matches.",
    "What is the fewest number of days over which\nthe tournament can take place?\n(b) Ten members of Math Club are driving to a math conference in a neigh-\nboring state.",
    "However, some of these students have dated in the past, and\nthings are still a little awkward.",
    "Each student lists which other students\nthey refuse to share a car with; these conflicts are recorded in the table\nbelow.",
    "What is the fewest number of cars the club needs to make the trip?\nDo not worry about running out of seats, just avoid the conflicts.\n",
    "Student:\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nConflicts:\nBEJ\nADG\nHJ\nBF\nAI\nDJ\nB\nCI\nEHJ\nACFI\n8.\nProve the 6-color theorem: every planar graph has chromatic number 6 or less.\n",
    "Do not assume the 4-color theorem (whose proof is MUCH harder), but you\nmay assume the fact that every planar graph contains a vertex of degree at\nmost 5.\n9.\n",
    "Not all graphs are perfect.",
    "Give an example of a graph with chromatic number\n4 that does not contain a copy of 𝐾4.",
    "That is, there should be no 4 vertices all\npairwise adjacent.\n",
    "10.\nFind the chromatic number of the graph below and prove you are correct.\n11.\nProve by induction on vertices that any graph 𝐺which contains at least one\nvertex of degree less than Δ(𝐺)",
    "(the maximal degree of all vertices in 𝐺) has\nchromatic number at most Δ(𝐺).\n12.\n",
    "You have a set of magnetic alphabet letters (one of each of the 26 letters in the\nalphabet) that you need to put into boxes.",
    "For obvious reasons, you don’t want\nto put two consecutive letters in the same box.",
    "What is the fewest number of\nboxes you need (assuming the boxes are able to hold as many letters as they\nneed to)?\n\n162\n2.",
    "Graph Theory\n13.\n",
    "Suppose you colored the edges of a graph either red or blue (not requiring\nthat adjacent edges be colored differently).",
    "What must be true of the graph to\nguarantee some vertex is incident to three edges of the same color?",
    "Prove your\nanswer.\n",
    "14.\nProve that if you color every edge of 𝐾6 either red or blue, you are guaranteed\na monochromatic triangle (that is, an all-red or an all-blue triangle).\n\n",
    "2.6\nRelations and Graphs\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Explain the relationship between a graph and a relation.\n",
    "2. Determine whether a relation is reflexive, symmetric, or transitive.\n",
    "3. Use an equivalence relation to partition a set and use a partition to\ndefine an equivalence relation.\n",
    "2.6.1\nSection Preview\nInvestigate!\nConsider the three spinners below.\n",
    "2\n4\n9\n𝐴\n1\n6\n8\n𝐵\n3\n5\n7\n𝐶\nIf you and a friend each pick a different spinner and spin them, we can\nconsider the nine possible outcomes.",
    "For example, between spinners 𝐴and\n𝐵, the outcomes are\n(2, 1), (2, 6), (2, 8), (4, 1), (4, 6), (4, 8), (9, 1), (9, 6), (9, 8).\n",
    "This suggests that spinner 𝐴will win five out of nine times.\n",
    "Compare the other combinations of spinners.",
    "Which spinner is best?\n",
    "In this section, we will explore a generalization of a graph, called a relation.",
    "We\nwill see how a relation can be represented by a graph and how a graph can be used\nto represent a relation.",
    "We will also consider some properties that a relation might\nhave, and how these properties can be used to classify relations into different types.\n163\n\n164\n2.",
    "Graph Theory\nPreview Activity\n",
    "In a given month, some days are more similar than others.",
    "For example, the 3rd\nof the month is more like the 24th than it is like the 15th.",
    "What does this possibly\nmean?",
    "We will explore two ways in which this is true.\n",
    "1.\nWe will say that two numbers between 1 and 31 are related, written 𝑎∼𝑏if\ntheir difference is a multiple of 7.",
    "So for example, 3 ∼24, since 24 −3 = 3 · 7,\nbut 3 / 15 since 15 −3 = 12 which is not a multiple of 7.\n(a) Which of the following are true?",
    "That is, which of the following pairs of\nnumbers are related as we have defined above?\n• 4 ∼14\n• 7 ∼14\n• 10 ∼17\n• 17 ∼24\n• 10 ∼24\n• 20 ∼10\n• 31 ∼3\n• 25 ∼25\n(b) Which of the following statements are true about the ∼relation in this\ncase?\n• 𝑎∼𝑎for every number 𝑎\n• 𝑎/ 𝑎for any number 𝑎\n• For any numbers 𝑎and 𝑏, if 𝑎∼𝑏, then 𝑏∼𝑎\n• For any numbers 𝑎and 𝑏, if 𝑎∼𝑏and 𝑏∼𝑎, then 𝑎= 𝑏\n•",
    "For any numbers 𝑎and 𝑏, if 𝑎∼𝑏and 𝑏∼𝑐, then 𝑎∼𝑐\n(c)",
    "We will write [𝑎] for the set of all numbers related to 𝑎.",
    "For example,\n[7] = {7, 14, 21, 28}.",
    "Find each of the following:\n•",
    "[1] =\n;\n•",
    "[2] =\n;\n•",
    "[3] =\n;\n•",
    "[4] =\n;\n•",
    "[5] =\n;\n•",
    "[6] =\n.\nAre there any numbers that are in more than one of the sets [𝑎] above?\n\n2.6.",
    "Relations and Graphs\n165\n2.\n",
    "When you divide a multiple of 7 by 7, you get a whole number.",
    "If you divide\nanother number by 7, you can either write the result as a decimal or as a\nquotient and a remainder.",
    "For example, 19 ÷ 7 is 2 with a remainder of 5, since\nwe can write 19 = 2 · 7 + 5.",
    "The remainder is also called the modulus.",
    "When\nprogramming in python (and many other languages), the modulus operator is\nwritten as %.",
    "For example, 19 % 7 is 5.",
    "Try this out for a few numbers.\n",
    "(a) Find all the numbers 𝑎between 1 and 31 that are 5 mod 7.",
    "That is, find\nall 𝑎such that a % 7 = 5.\n(b) Since the modulus is a function, each number has exactly one modulus\nwhen divided by 7.",
    "This means that the moduli partition the numbers\nfrom 1 to 31: every number belongs to exactly one of the sets of numbers\nwith a particular modulus.",
    "We have already found the set for modulus 5.\nFind the other sets.\n",
    "• a % 7 = 0:\n;\n• a % 7 = 1:\n;\n• a % 7 = 2:\n;\n• a % 7 = 3:\n;\n• a % 7 = 4:\n;\n• a % 7 = 6:\n.\n",
    "(c) We can use the moduli to define a relation on the numbers from 1 to 31.\n",
    "We will say that 𝑎∼𝑏if a % 7 = b % 7.",
    "In other words, two numbers are\nrelated if they belong to the same set of the partition we found above.\n",
    "Which of the following are true?",
    "That is, which of the following pairs of\nnumbers are related by this modulus relation?\n• 4 ∼14\n• 7 ∼14\n• 10 ∼17\n• 17 ∼24\n• 10 ∼24\n• 20 ∼10\n• 31 ∼3\n• 25 ∼25\n2.6.2\nRelations Generally\nA graph is a way to represent some ways that different objects are related.",
    "We have\nseen how to use graphs to represent which people are friends, or which classes have\ntime conflicts, or which radio stations are too close to have the same frequency.",
    "Not\n\n166\n2.",
    "Graph Theory\nall ways in which things can be related can be represented by a graph, however.",
    "In\nthis section, we will consider the more general concept of a relation and see how\nthose might be related to graphs.\n",
    "Consider the example of the relation between students and classes that holds\nwhen a student is in that class (in a particular semester).",
    "This is a relation between\ntwo different sets (the students and the classes).",
    "If we used a graph to illustrate this\nrelation, the graph would be bipartite, since two students are never related to each\nother, and two classes are never related to each other.\n",
    "A graph is really a set of vertices and a set of edges: 𝐺= (𝑉, 𝐸); each element of\nthe set 𝐸is a two-element subset of𝑉.",
    "If we want to draw attention to the bipartiteness\nof the graph, we can split up 𝑉into its two sets and write 𝐺= ((𝐴, 𝐵), 𝐸).",
    "In this\nnotation, for the graph to be bipartite, we want each edge to be a pair (𝑎, 𝑏) where 𝑎\nis an element of 𝐴and 𝑏is an element of 𝐵. In other words, each edge is an element\nof the Cartesian product of 𝐴and 𝐵, written,\n𝐴× 𝐵= {(𝑎, 𝑏) :",
    "𝑎∈𝐴, 𝑏∈𝐵}.\n",
    "(Another way to say this is that 𝐴× 𝐵is “the set of all ordered pairs of elements\nfrom 𝐴and 𝐵.”)\nNote 2.6.1",
    "There is one subtlety here we should point out: the bipartite\ngraph we have described really has directed edges from 𝐴to 𝐵since we are\nconsidering ordered pairs.",
    "Our definition of a graph has edges as two-element\nsubsets of vertices, and subsets are not ordered.",
    "As long as 𝐴and 𝐵are disjoint\nsets, there is no confusion here, but we see relations in which 𝐴and 𝐵share\nsome elements, but we still care about the order.",
    "More on that soon.\n",
    "This example exactly illustrates what a general binary relation is.",
    "Here is the\ncareful definition.\n",
    "Definition 2.6.2\nA binary relation is a set of ordered pairs.",
    "We say the binary relation is a\nrelation on sets",
    "𝐴and",
    "𝐵provided the ordered pairs are a subset of 𝐴× 𝐵. We\nsay a binary relation is a relation on a set 𝐴provided the ordered pairs are a\nsubset of 𝐴× 𝐴.\nNote that 𝐴× 𝐴is just the set of all ordered pairs where both coordinates are\nelements from 𝐴.\nExample 2.6.3\nConsider a set 𝐴of students and a set 𝐵of classes.",
    "Say 𝐴= {Al, Bob, Cat, Dirk, Eva}\nand 𝐵= {Calculus, Discrete, Statistics}.",
    "Everyone except Dirk is in Calculus,\nBob and Eva are in Discrete, and Al, Cat, and Dirk are in Statistics.\n",
    "We can define a relation 𝑇of “is taking” 𝐴and 𝐵that holds of a student\n\n2.6.",
    "Relations and Graphs\n167\nand class precisely if that student is taking that class.",
    "Write this relation as a\nsubset of 𝐴× 𝐵and draw its bipartite graph.\n",
    "Solution.\n",
    "To write the relation precisely, we just give the set of ordered\npairs:\n𝑇= {(Al, Calculus), (Al, Statistics),\n(Bob, Calculus), (Bob, Discrete)\n(Cat, Calculus), (Cat, Statistics)\n(Dirk, Statistics)\n(Eva, Calculus), (Eva, Discrete)}\n",
    "We can draw this relation as a bipartite graph:\nAl\nBob\nCat\nDirk\nEva\nCalc\nDisc\nStat\nExample 2.6.4\nConsider the relation 𝑀for “is a multiple of” on the set 𝐴= {1, 2, 3, 4, 5, 6}.\n",
    "Write this as a set of ordered pairs.",
    "Does this relation create a graph?\nSolution.\n",
    "First, let’s think about which elements should be related and\nwhich should not.",
    "We know that 6 is a multiple of 2, so the relation is true of\nthe pair (6, 2), but 6 is not a multiple of 4, so the pair (6, 4) does not satisfy the\nrelation.",
    "More precisely, we say that (6, 2) ∈𝑀but (6, 4) ∉𝑀.\nLet’s list all the elements of 𝑀:\n𝑀= {(1, 1), (2, 1), (2, 2), (3, 1), (3, 3), (4, 1), (4, 2), (4, 4),\n(5, 1), (5, 5), (6, 1), (6, 2)(6, 3), (6, 6)}.\n",
    "This relation is not a graph for two reasons: first, elements are related to\nthemselves, and second, the order of elements in the relation is not symmetric\n(6 is related to 2, but 2 is not related to 6, for example).\n",
    "We can, however, still draw something like a graph to illustrate this\nrelation: Since the direction of the relation matters, we will have directed edges.\n",
    "This alone would create a directed graph.",
    "Since vertices can have edges going\nto themselves, we would call the structure a multigraph, so the relation can\nbe thought of as a directed multigraph.\n\n",
    "168\n2.",
    "Graph Theory\n1\n2\n3\n4\n5\n6\nA binary relation 𝑅on sets 𝐴and 𝐵can always be “turned around” to give a\nrelation on sets 𝐵and 𝐴.",
    "That is, 𝑅says how things in 𝐴are related to things in 𝐵;\nthose things in 𝐵are related to things in 𝐴, just in an inverse (backward) way.",
    "We\nwill call this new relation the inverse of 𝑅.\nDefinition 2.6.5\nGiven a binary relation 𝑅, define 𝑅−1 to be the inverse of 𝑅as the set\n𝑅−1 = {(𝑏, 𝑎) : (𝑎, 𝑏) ∈𝑅}.\n",
    "The relation 𝑇from Example 2.6.3 said that a given student was in a particular\nclass.",
    "The inverse relation 𝑇−1 says that a given class has a particular student in\nit.",
    "For example, (Calculus, Al) is an element of 𝑇−1.",
    "Graphically, there won’t be\nany difference in the picture, although we could put the set of classes on top and\nstudents on bottom.\n",
    "The relation 𝑀from Example 2.6.4 gave us that, for example, 6 is a multiple of 2,\nsince (6, 2) ∈𝑀.",
    "For the inverse, we have (2, 6) ∈𝑀−1, which means that 2 is a factor\nof 6.",
    "For this example, we have represented a relation as a directed multigraph.",
    "The\ngraph of the inverse will look exactly the same, but all the arrows will point in the\nopposite direction.\n",
    "Another way to create a new relation is to combine two relations.",
    "Suppose in\naddition to the “is taking” relation from Example 2.6.3, we define a relation “is\ntaught by” that matches up each course with its instructor.",
    "Perhaps Professor X\nteaches Calculus.",
    "In that case, since Al is taking Calculus, and Calculus is taught by\nProfessor X, we can conclude that Al is taking a class with Professor X.\nDefinition 2.6.6\nLet 𝑅be a relation from set 𝐴to 𝐵and 𝑆be a relation from 𝐵to 𝐶. The\ncomposition of 𝑅and 𝑆is\n𝑆◦𝑅= {(𝑎, 𝑐) ∈𝐴× 𝐶: (𝑎, 𝑏)",
    "∈𝑅and (𝑏, 𝑐) ∈𝑆for some 𝑏∈𝐵}\nNote the order in which we wrote the two relations: it’s 𝑆◦𝑅, not 𝑅◦𝑆. The\n\n2.6.",
    "Relations and Graphs\n169\nreason we do this (which might seem backward) is that it agrees with the usual\nnotation for composition of functions.",
    "In fact, functions are nothing but a specific\ntype of relation!\n",
    "Example 2.6.7\nWrite out the relation 𝑃◦𝑇, composing the relations of Example 2.6.3 and 𝑃=\n{(Calculus, Prof X), (Discrete, Prof L), (Statistics, Prof X), (Statistics, Prof S)}.",
    "Note\nthat here we are saying the statistic course is co-taught by professors X and S.\nSolution.\n",
    "The relation we are looking for is a relation between students and\nprofessors.",
    "We can start with each element of 𝑇and extend it by following\nthe course to the professor(s) via 𝑃. So for example, start with Cat, and\nnotice that (Cat, Calculus) ∈𝑇.",
    "Now look at what Calculus is related to via\n𝑃: (Calculus, Prof X) ∈𝑃.",
    "Thus we can push these together to conclude that\n(Cat, Prof X) ∈𝑃◦𝑇.\n",
    "An alternative approach would be to simply consider which pairs of\nstudents and professors are linked by a common class.",
    "Should the pair\n(Al, Prof L) be an element of the composition?",
    "No, because there is no class\nthat is both taken by Al and taught by Professor L. On the other hand, we can\nconclude the (Al, Prof X) ∈𝑃◦𝑇since there is a common course.",
    "In fact, the\ncommon course could be Calculus or Statistics (it doesn’t matter how many\ncommon middle steps there are, as long as there is at least one).\n",
    "Here is the complete relation:\n𝑃◦𝑇= {(Al, Prof X), (Al, Prof S), (Bob, Prof X), (Bob, Prof L),\n(Cat, Prof X), (Cat, Prof S), (Dirk, Prof X), (Dirk, Prof S),\n(Eva, Prof X), (Eva, Prof L)}\nSomething interesting often happens when you compose a relation with its\ninverse.\n",
    "You might have seen something like this for functions in calculus or\nalgebra:\n𝑓(𝑥) = 𝑒𝑥has an inverse function 𝑓−1(𝑥) = ln(𝑥), and we know that\n𝑓( 𝑓−1(𝑥))",
    "= 𝑒ln(𝑥) = 𝑥.",
    "But functions are relations in which every “input” has exactly\none “output”, so perhaps it is not surprising that composing with an inverse just\ngives you the identity function.",
    "When inputs can have multiple outputs, and outputs\ncan have multiple inputs, then we get something more.\n",
    "Example 2.6.8\nDescribe the relation 𝑇−1◦𝑇(using our familiar relation 𝑇from Example 2.6.3).\n",
    "What does this tell us about students and classes?\nSolution.\n",
    "By following the relation, we could start by saying Al is in Calculus,\nand Calculus is taken by Al, so Al is related to Al.",
    "But also , Calculus is taken\nby Bob, so now Al is also related to Bob.",
    "Is Bob related to Al as well?",
    "Yes,\n\n170\n2.",
    "Graph Theory\nsince Bob is taking Calculus and Calculus is taken by Al.\n",
    "The composition is telling us which pairs of students have at least one\nclass in common.",
    "That’s almost all pairs of students, except that Dirk is not\nrelated to Bob or Eva, since they don’t take Statistics, and that is the only class\nhe takes.\n",
    "Instead of writing out the relation (which will almost be all of 𝐴× 𝐴), here\nis the graph representation.\n",
    "Al\nBob\nCat\nDirk\nEva\nWhile we drew a directed multigraph here, the arrows going both ways\nmean that we really could have drawn just a multigraph.\n",
    "2.6.3\nProperties of Relations\nFrom this point on, we will just consider relations on a single set (so from a set to\nitself).",
    "To help understand these relations, let’s consider some basic properties a\nrelation might or might not have.\n",
    "Definition 2.6.9 Reflexive, Symmetric, and Transitive.\n",
    "Ler 𝑅be a relation on the set 𝐴.",
    "We say,\n• 𝑅is reflexive provided (𝑎, 𝑎) ∈𝐴for all 𝑎∈𝐴.\n• 𝑅is symmetric provided, for all 𝑎, 𝑏∈𝐴, if (𝑎, 𝑏) ∈𝑅then (𝑏, 𝑎) ∈𝑅.\n• 𝑅is transitive provided, for all 𝑎, 𝑏, 𝑐∈𝐴, if (𝑎, 𝑏)",
    "∈𝑅and (𝑏, 𝑐) ∈𝑅,\nthen (𝑎, 𝑐) ∈𝑅.\nLet’s examine each of these properties carefully.\n",
    "It will be helpful to consider a few standard examples of relations on sets as we\ngo.",
    "Most relations we consider here will be written using infix notation, just meaning\nthat we put the relation symbol between the two things it is relating.",
    "For example,\nthe less than relation is almost always written as 2 < 6 rather than writing (2, 6) ∈<.\n\n2.6.",
    "Relations and Graphs\n171\nExample 2.6.10 Reflexive and non-reflexive relations.\n",
    "A relation is reflexive when every element is related to itself.",
    "The following\nare reflexive relations:\n•",
    "The “less-than-or-equal-to” relation on any set of numbers.",
    "Is it the case\nthat 3 ≤3?",
    "More importantly, is every number no greater than itself?\n",
    "Since the answer is yes, this relation is reflexive.\n",
    "• The “within 3” relation, that holds of two numbers 𝑎and 𝑏provided\n|𝑎−𝑏| ≤3.",
    "To prove that this is reflexive, we simply note that |𝑎−𝑎| =\n0 ≤3.\n",
    "• The “is a multiple of” relation from Example 2.6.4.",
    "Note that the directed\nmultigraph for this relation had loops at every vertex.\n",
    "However, these relations are not reflexive:\n•",
    "The “sums to zero” relation, that holds on numbers 𝑎and 𝑏if 𝑎+ 𝑏= 0.\nNote that while 0 + 0 = 0, so (0, 0) is an element of the relation, every\nother number is not related to itself.\n",
    "•",
    "Any relation that is described by a graph.",
    "Remember, graphs cannot\nhave edges looping back to a single vertex, so the edge relation on a\ngraph is not reflexive.",
    "(A multigraph could be reflexive or not).\n",
    "If no element is related to itself (such as in the edge relation for a graph), then\nwe call the relation irreflexive.",
    "Of course, some relations are neither reflexive nor\nirreflexive.\n",
    "Checking that a relation is reflexive is relatively easy.",
    "The other two properties\nare phrased as implications, which makes them a little more complex.\n",
    "Example 2.6.11 Symmetric and non-symmetric relations.\n",
    "Essentially, symmetric relations are the ones that work “both ways.”",
    "More\nprecisely, if 𝑎is related to 𝑏, then 𝑏is also related to 𝑎.\n",
    "The following relations are symmetric.\n",
    "•",
    "The “within 3” relation: if |𝑎−𝑏| ≤3 then |𝑏−𝑎| ≤3.\n• The “sums to zero” relation: if 𝑎+ 𝑏= 0, then certainly 𝑏+ 𝑎= 0.\n•",
    "For any graph, the edge relation is symmetric.",
    "Of course, for directed\ngraphs this is usually not true.\n",
    "On the other hand, these relations are not symmetric.\n",
    "• ≤is not symmetric.",
    "All we need to do to prove that a relation is not\n\n172\n2.",
    "Graph Theory\nsymmetric is to find some 𝑎and 𝑏such that 𝑎≤𝑏but 𝑏̸≤𝑎.",
    "Well, 3 ≤4,\nbut 4 ̸≤3.",
    "QED.\n",
    "• The “is a multiple of” relation is not symmetric.",
    "6 is a multiple of 2 but\n2 is not a multiple of 6.\nRelations that are not symmetric could in fact be antisymmetric, meaning the\nonly elements for which both (𝑎, 𝑏) and (𝑏, 𝑎) are in the relation is",
    "when 𝑎= 𝑏. Note\nthat there are relations that are neither symmetric nor antisymmetric.\n",
    "Using the language of inverse relations, a relation is symmetric if and only if the\nrelation is equal to its inverse.\n",
    "Example 2.6.12 Transitive and non-transitive relations.\n",
    "If 𝑎is related to 𝑏, and 𝑏is related to 𝑐, does that mean 𝑎is related to 𝑐?",
    "If this\nis true no matter what 𝑎, 𝑏, and 𝑐are, then we say the relation is transitive.\n",
    "Here are some transitive relations.\n",
    "• ≤. Suppose 𝑎≤𝑏and 𝑏≤𝑐.",
    "Then clearly 𝑎≤𝑐.\n•",
    "The “is a multiple of” relation.",
    "This is a good one to write a proof for:\nSuppose 𝑎is a multiple of 𝑏and that 𝑏is a multiple of 𝑐.",
    "Then 𝑎= 𝑏𝑘for\nsome integer 𝑘and 𝑏= 𝑐𝑗for some integer 𝑗. By substitution, 𝑎= 𝑐𝑗𝑘,\nso 𝑎is a multiple of 𝑐.\n",
    "However, the following relations are not transitive.\n",
    "•",
    "The “within 3” relation is not transitive.",
    "All we need to do is find three\nnumbers that fail to meet the condition.",
    "How about 1, 3, and 5?",
    "Here 1\nis within 3 of 3, and 3 is within 3 of 5, but |1 −5|",
    "= 4 so the relation does\nnot hold of (1, 5).\n",
    "• The “sums to zero” relation is not transitive.",
    "Notice that we never\nclaimed that 𝑎, 𝑏, and 𝑐need to be different numbers.",
    "Let 𝑎= 5, 𝑏= −5,\nand 𝑐= 5.",
    "Then 𝑎+ 𝑏= 0 and 𝑏+ 𝑐= 0, so the relation holds of (𝑎, 𝑏)\nand (𝑏, 𝑐).",
    "But 𝑎+ 𝑐= 10 so the relation does not hold of (𝑎, 𝑐).\n",
    "The edge relation for a graph might or might not be transitive.",
    "What\nwould a graph look like if its edge relation was transitive?\n2.6.4\nEquivalence Relations\nNow we will do something very typical for mathematics: We will look at our most\ncommon types of relations, consider what properties these have, and then classify\nother relations that also have these properties as a specific class of relations.\n",
    "The relation we are all most familiar with is equality.",
    "Which properties of\n\n2.6.",
    "Relations and Graphs\n173\nrelations does the equality relation possess?",
    "Certainly everything is equal to itself,\nso equality is reflexive.",
    "If 𝑎= 𝑏, then 𝑏= 𝑎, so equality is symmetric.",
    "If 𝑎= 𝑏and\n𝑏= 𝑐, then 𝑎= 𝑐, so equality is transitive.\n",
    "What other relations are reflexive, symmetric, and transitive?",
    "Exactly those relations\nthat behave like equality.",
    "We call such relations equivalence relations.\n",
    "Definition 2.6.13 Equivalence Relation.\n",
    "A relation that is reflexive, symmetric, and transitive is called an equivalence\nrelation.\n",
    "Remark 2.6.14\nAnother example of a type of relation that is modeled\nafter a classic relation is a partial order.",
    "This is a relation that is reflexive,\nantisymmetric, and transitive, just like less-than-or-equal-to.",
    "Perhaps you\nnoticed already that the subset relation, written ⊆, feels a lot like ≤. This is\nbecause ⊆is also a partial order.",
    "So is the “is a multiple of” relation we saw\nabove.\n",
    "There are lots of interesting things we can say about partial orders and\nthe sets they partially order, called partially ordered sets or PoSets.",
    "Another\ntime.\n",
    "None of the examples we have considered so far in this section have been\nequivalence relations, but they are ubiquitous in mathematics.",
    "They are so common\nthat it is easy to overlook them as anything worth saying something about at all.\n",
    "Let’s see some examples.\n",
    "Example 2.6.15\nProve that the relation ≡2, which holds of two integers if their difference is\neven, is an equivalence relation.",
    "That is, 𝑎≡2 𝑏if and only if 𝑏−𝑎= 2𝑘for\nsome integer 𝑘.\nSolution.\n",
    "We simply check the three required properties.\n",
    "1. ≡2 is reflexive: for any integer 𝑎, we have 𝑎−𝑎= 0 and 0 = 2𝑘for 𝑘= 0,\nso 𝑎≡2 𝑎.\n2. ≡2 is symmetric: Fix arbitrary integers 𝑎and 𝑏, and assume 𝑎≡2 𝑏. That\nmeans that 𝑏−𝑎= 2𝑘for some integer 𝑘.",
    "What about 𝑎−𝑏?",
    "Well, we\nwill have 𝑎−𝑏= 2(−𝑘), and −𝑘is an integer, so we have 𝑏≡2 𝑎.\n3. ≡2 is transitive:",
    "Fix arbitrary integers 𝑎, 𝑏, and 𝑐and assume 𝑎≡2 𝑏and\n𝑏≡2 𝑐.",
    "This means that 𝑏−𝑎= 2𝑘and 𝑐−𝑏= 2𝑗for some integers 𝑘\nand 𝑗. What about 𝑐−𝑎?",
    "Well,\n𝑐−𝑎= (𝑐−𝑏) + (𝑏−𝑎) = 2𝑘+ 2𝑗= 2(𝑘+ 𝑗).\n",
    "Since 𝑘+ 𝑗is an integer, we see that 𝑎≡2 𝑐as required.\n\n174\n2.",
    "Graph Theory\nExample 2.6.16\nLet’s call two graphs “degree-sequence-equivalent” if they have the same\ndegree sequence.",
    "Is this an equivalence relation?\nSolution.\n",
    "Yes it is.",
    "Clearly every graph has the same degree sequence as\nitself, so the relation is reflexive.",
    "If 𝐺1 has the same degree sequence as 𝐺2,\nthen 𝐺2 has the same degree sequence as 𝐺1, so the relation is transitive.\n",
    "Finally, if 𝐺1 has the same degree sequence as 𝐺2, which has the same degree\nsequence as 𝐺3, then they all have the same degree sequence, so 𝐺1 has the\nsame degree sequence as 𝐺3 (i.e., the relation is transitive).\n",
    "This example is almost too obvious.",
    "That’s because we said that two things are\nrelated if a well-defined property of those things was equal, and equality satisfies the\nproperties of an equivalence relation.",
    "Our next goal is to try to make better sense of\nthis and see that it is exactly what gives us an equivalence relation.\n",
    "2.6.5\nEquivalence Classes and Partitions\nGiven any relation 𝑅, we can look at the set of elements that are related to a particular\nelement.",
    "For the “is taking” relation, we can ask what classes Al is taking (i.e., the\nclasses related to Al).",
    "For the “is a multiple of”, we can ask which numbers 6 a\nmultiple of.",
    "One way to study the relation is to study the sets of things related to\neach element.\n",
    "Definition 2.6.17\nLet 𝑅be a relation on the set 𝐴, and let 𝑎be an element of 𝐴. The relation\nclass of 𝑎, written [𝑎] is the set of all elements 𝑏such that (𝑎, 𝑏) ∈𝑅(the set of\n𝑏that are related to 𝑎by 𝑅).",
    "That is,\n[𝑎] = {𝑏∈𝐴: (𝑎, 𝑏) ∈𝑅}.\n",
    "When 𝑅is an equivalence relation, we call relation classes equivalence\nclasses.\n",
    "Example 2.6.18\nFind the relation classes for the “is a multiple of” relation on the set 𝐴=\n{1, 2, 3, 4, 5, 6}.\nSolution.\n",
    "There will be six relation classes since each element has a relation\nclass.",
    "They are:\n",
    "[1] ={1}\n[2] ={1, 2}\n[3] ={1, 3}\n\n2.6.",
    "Relations and Graphs\n175\n[4] ={1, 2, 4}\n[5] ={1, 5}\n",
    "[6] ={1, 2, 3, 6}.\n",
    "For example, we found [4] by considering all pairs (4, 𝑏) that satisfied the\nrelation: 4 is a multiple of 1, 2, and 4, so those are the possible values of 𝑏that\nwe find.\n",
    "Look back at the directed multigraph for this relation shown in the solution\nto Example 2.6.4.",
    "What are the relation classes?",
    "They are nothing but the\nneighbors of each vertex (where neighbor means you follow the arrows in the\ncorrect direction).\n",
    "Example 2.6.19\nFind the equivalence classes for the ≡2 relation on the integers.\n",
    "Solution.\n",
    "On no!",
    "Our set is infinite, so we will have infinitely many relation\nclasses?",
    "Well, we better get started...\n",
    "What numbers are related to 1?",
    "Remember, we want integers whose\ndifference with 1 is a multiple of 2.",
    "So 3 for sure.",
    "Also 5, and 7, and -1, and -3,\nand... all the odds?",
    "Yes, because the difference of any two odd numbers is\neven.",
    "We can also say that the difference between any two even numbers is\neven, so the equivalence class of 2 will contain all the even numbers.",
    "So far\nwe have:\n",
    "[1] ={. . .",
    ", −3, −1, 1, 3, 5, . . .}\n",
    "[2] ={. . .",
    ", −4, −2, 2, 4, 6, . . .",
    "}\n",
    "Actually, I think we are done.",
    "While [3], [4], [5], and so on are all completely\nvalid equivalence classes, the elements that are related to 3 will be exactly the\nelements related to 1, since 1 ≡2 3.",
    "This is because the relation is transitive!",
    "If\n3 ≡2 𝑏, then we know 1 ≡2 𝑏.\n",
    "So we have exactly two equivalence classes.",
    "Every integer is in exactly one\nof these two equivalence classes, and the equivalence class of any integer is\nexactly the class it belongs to.\nExamine the two examples above carefully.",
    "For the “is a multiple of” relation,\nwhich is NOT an equivalence relation, some elements belong to more than one\n(different) relation class.",
    "But for ≡2, which is an equivalence relation, every element\nis in exactly one equivalence class.",
    "This is no accident.",
    "To make sense of this, we\nwill define a new term.\n\n176\n2.",
    "Graph Theory\nDefinition 2.6.20\nGiven a non-empty set 𝐴, a partition of 𝐴is a set 𝑃of non-empty subsets of\n𝐴such that every element of 𝐴is in exactly one element of 𝑃.\nThat definition has a lot of symbols and sets involved.",
    "It’s really not complicated\nthough: A partition is a way to break up a set into disjoint subsets that cover the\nwhole set.",
    "That the subsets are disjoint means no element is in more than one subset.\n",
    "That the subsets cover the set means every element is in at least one subset.\n",
    "Example 2.6.21\nGive a few different partitions of the set 𝐴= {1, 2, 3, 4, 5}.\nSolution.\n",
    "There are so many choices here!",
    "One choice is:\n𝑃1 = {{1, 2, 3}, {4, 5}}.\n",
    "That’s a partition of 𝐴into two subsets.",
    "Another partition:\n𝑃2 = {{1}, {2}, {3}, {4}, {5}}.\nAnother:\n𝑃3 = {{1, 3, 5}, {2, 4}},\nwhich happens to be a partition into even and odd numbers.",
    "We also have\nthe trivial partition:\n𝑃4 = {{1, 2, 3, 4, 5}}.\n",
    "Note: that is a single set inside the set 𝑃4.\n",
    "It is sometimes a little confusing to think of the elements of a partition as subsets\nsince the partition is a set, and a set of sets can be difficult to talk about.",
    "We\nsometimes call the partition a collection and each of the elements of the partition\nparts or blocks.\n",
    "Now the big idea: For any equivalence relation, the equivalence classes form\na partition, and for any partition, we can define a relation “are in the same subset”\nwhich will be an equivalence relation.",
    "We have already seen that the equivalence\nclasses of ≡2 form a partition.",
    "Let’s go the other direction.\n",
    "Example 2.6.22\nDefine an equivalence relation ∼on the set 𝐴= {1, 2, 3, 4, 5} from the partition\n𝑃= {{1, 4}, {2, 3, 5}}.\n",
    "Solution.\n",
    "Say two elements of 𝐴are equivalent provided they belong to the\nsame element of 𝑃. That is, 1 ∼4 and 4 ∼1, and 2 ∼3, 2 ∼5, 3 ∼5, 3 ∼2,\n\n2.6.",
    "Relations and Graphs\n177\n5 ∼2, and 5 ∼3.",
    "Wait.",
    "We also have 1 ∼1, 2 ∼2, and so on, since every\nnumber is in the same subset as itself.\n",
    "It is clear from looking that this relation is reflexive, symmetric, and\ntransitive, so is an equivalence relation.\n",
    "Theorem 2.6.23\n",
    "Given any equivalence relation 𝑅on a set 𝐴, the equivalence classes form a partition\nof 𝐴.\nGiven any partition 𝑃= {𝐵1, 𝐵2, . . .",
    ", } of a set 𝐴, the relation ≡𝑃defined by\n𝑎≡𝑃𝑏if and only if 𝑎and 𝑏belong to the same block of 𝑃, is an equivalence relation.\n",
    "Further, the equivalence classes for the equivalence relation formed by a partition\nare exactly the original partition, and the equivalence relation built by the partition of\nits equivalence classes is exactly the original equivalence relation.\n",
    "2.6.6\nReading Questions\n1.\nConsider the relation 𝑅defined on the integers that holds of 𝑎and 𝑏precisely\nif 𝑏−𝑎≥4.",
    "So for example, (2, 7) ∈𝑅but (8, 6) ∉𝑅. Which of the following\nproperties of relations does 𝑅have?\nA. 𝑅is reflexive.\n",
    "B. 𝑅is irreflexive.\n",
    "C. 𝑅is symmetric.\n",
    "D. 𝑅is antisymmetric.\n",
    "E. 𝑅is transitive.\n",
    "2.\nNot all graphs have a transitive edge relation.",
    "But do some of them?",
    "If so, give\nan example and explain why it is transitive.",
    "If not, explain why.\n",
    "3.\nAfter reading this section, what questions do you have?",
    "Ask at least one\nquestion about this section that you are curious about.\n",
    "2.6.7\nPractice Problems\n1.\nWhich of the following relations on the integers are reflexive?\n(a) 𝑥∼𝑦if and only if 𝑥+ 𝑦is odd.\n",
    "(b) 𝑥∼𝑦if and only if 𝑥+ 𝑦is positive.\n",
    "(c) 𝑥∼𝑦if and only if 𝑥𝑦≥0.\n",
    "(d) 𝑥∼𝑦if and only if 𝑥𝑦is positive.\n\n",
    "178\n2.",
    "Graph Theory\n(e) 𝑥∼𝑦if and only if 𝑦−𝑥is a multiple of 10.\n2.\n",
    "Which of the following relations on the integers are symmetric?\n(a) 𝑥∼𝑦if and only if 𝑥+ 𝑦is odd.\n",
    "(b) 𝑥∼𝑦if and only if 𝑥+ 𝑦is positive.\n",
    "(c) 𝑥∼𝑦if and only if 𝑥𝑦≥0.\n",
    "(d) 𝑥∼𝑦if and only if 𝑥𝑦is positive.\n",
    "(e) 𝑥∼𝑦if and only if 𝑦−𝑥is a multiple of 10.\n",
    "3.\nWhich of the following relations on the integers are transitive?\n(a) 𝑥∼𝑦if and only if 𝑥+ 𝑦is odd.\n",
    "(b) 𝑥∼𝑦if and only if 𝑥+ 𝑦is positive.\n",
    "(c) 𝑥∼𝑦if and only if 𝑥𝑦≥0.\n",
    "(d) 𝑥∼𝑦if and only if 𝑥𝑦is positive.\n",
    "(e) 𝑥∼𝑦if and only if 𝑦−𝑥is a multiple of 10.\n4.\nDefine relations 𝑅1, . . .",
    ", 𝑅6 on 1, 2, 3, 4 by\n(a) 𝑅1 = {(2, 2), (2, 3), (2, 4), (3, 2), (3, 3), (3, 4)},\n(b) 𝑅2 = {(1, 1), (1, 2), (2, 1), (2, 2), (3, 3), (4, 4)}.\n",
    "(c) 𝑅3 = {(2, 4), (4, 2)}.\n",
    "(d) 𝑅4 = {(1, 2), (2, 3), (3, 4)},\n(e) 𝑅5 = {(1, 1), (2, 2), (3, 3), (4, 4)},\n(f) 𝑅6 = {(1, 3), (1, 4), (2, 3), (2, 4), (3, 1), (3, 4)},\nFor each of the relations, determine whether it is any of reflexive, irreflexive,\nsymmetric, antisymmetric, and transitive.\n5.\n",
    "For each of the following relations on the set of all people, determine whether\nthe relation is any of reflexive, irreflexive, symmetric, anitsymmetric, and\ntransitive.\n",
    "(a) 𝑎∼𝑏if and only if 𝑎is older than 𝑏.\n(b) 𝑎∼𝑏if and only if 𝑎and 𝑏have a common grandparent.\n",
    "(c) 𝑎∼𝑏if and only if 𝑎has the same first name as 𝑏.\n(d) 𝑎∼𝑏if and only if 𝑎and 𝑏were born on the same day.\n\n",
    "2.6.",
    "Relations and Graphs\n179\n6.\n",
    "For the following relations on the set of all integers, determine whether the\nrelation is any of reflexive, irreflexive, symmetric, antisymmetric, and transitive:\n(a) 𝑥∼𝑦if and only if 𝑥+ 𝑦= 0.\n(b) 𝑥∼𝑦if and only if 𝑥−𝑦is an integer.\n",
    "(c) 𝑥∼𝑦if and only if 𝑥= 2𝑦.\n(d) 𝑥∼𝑦if and only if 𝑥𝑦> 1.\n2.6.8\nAdditional Exercises\n1.\nConsider the relation > on the set {1, 2, . . .",
    ", 8}.\n(a) Draw the directed graph of the relation >.\n",
    "(b) Draw the directed graph for the inverse relation >−1.\n",
    "(c) Is the inverse relation of > the same as the relation ≤?",
    "Explain.\n",
    "2.\nTrue or false: for any relation 𝑅on a set 𝐴, the relation 𝑅−1 is symmetric if and\nonly if 𝑅is symmetric.",
    "Justify your answer.\n",
    "3.\nTrue or false: for any relation 𝑅on a set 𝐴, the composition of 𝑅with its\ninverse, 𝑅◦𝑅−1, is always reflexive.",
    "Justify your answer.\n",
    "4.\nFind, if possible, an example of a relation on the set {1, 2, 3, 4} that is reflexive\nand symmetric, but not transitive.",
    "If such a relation exists, draw the directed\nmultigraph of the relation and list the ordered pairs that define it.",
    "Explain\nyour answers.\n",
    "5.\nFind, if possible, an example of a relation on the set {1, 2, 3, 4} that is reflexive\nand transitive, but not symmetric.",
    "If such a relation exists, draw the directed\nmultigraph of the relation and list the ordered pairs that define it.",
    "Explain\nyour answers.\n",
    "6.\nFind, if possible, an example of a relation on the set {1, 2, 3, 4} that is symmetric\nand transitive, but not reflexive.",
    "If such a relation exists, draw the directed\nmultigraph of the relation and list the ordered pairs that define it.",
    "Explain\nyour answers.\n",
    "7.\n",
    "What is wrong with the following argument that any relation that is symmetric\nand transitive must be reflexive?\nSuppose 𝑅is a relation on a set 𝐴that is symmetric and transitive.\n",
    "Since 𝑅is symmetric, if 𝑎𝑅𝑏, then 𝑏𝑅𝑎holds.",
    "Since 𝑅is transitive,\nif 𝑎𝑅𝑏and 𝑏𝑅𝑎, then 𝑎𝑅𝑏holds.",
    "Since this is true for all elements 𝑎,\nwe have that 𝑎𝑅𝑎is true for all 𝑎in 𝐴, so 𝑅is reflexive.\n",
    "8.\nSuppose 𝑅is an equivalence relation on the set 𝐴= {1, 2, . . .",
    ", 6}.",
    "What could\nthe directed multigraph for 𝑅look like?",
    "Give at least two different examples of\n\n180\n2.",
    "Graph Theory\nsuch 𝑅and their graphs to illustrate your answer.\n",
    "9.\nConsider the relation 𝑅on the set 𝐴= {1, 2, 3, 4, 5} defined by 𝑅=\n{(1, 2), (2, 3), (3, 4), (4, 5), (5, 1), (2, 1), (3, 1), (4, 1), (5, 1)}.",
    "Is 𝑅an equivalence\nrelation?",
    "Justify your answer.\n",
    "Regardless of your answer, what do the relation classes",
    "[𝑎] for 𝑎∈𝑅look\nlike?",
    "Can you tell whether 𝑅is an equivalence relation from this information?\n10.\nConsider the “loner” relation on a set of students that describes friendships,\nand holds only between a student and themselves (i.e., nobody is friends with\nanyone other than themselves).",
    "Is this an equivalence relation?",
    "Justify your\nanswer.",
    "If it is an equivalence relation, what do the equivalence classes look\nlike?\n\n2.7\nMatching in Bipartite Graphs\nInvestigate!\n",
    "Given a bipartite graph, a matching is a subset of the edges for which every\nvertex belongs to exactly one of the edges.",
    "Our goal in this activity is to\ndiscover some criteria for when a bipartite graph has a matching.\n",
    "Does the graph below contain a matching?",
    "If so, find one.\n",
    "Not all bipartite graphs have matchings.",
    "Draw as many fundamentally\ndifferent examples of bipartite graphs that do NOT have matchings.",
    "Your\ngoal is to find all the possible obstructions to a graph having a perfect\nmatching.\n",
    "Write down the necessary conditions for a graph to have a\nmatching (that is, fill in the blank:",
    "If a graph has a matching, then\n).\n",
    "Then ask yourself whether these conditions are sufficient (is it true that if\n, then the graph has a matching?).\n",
    "We conclude with one more example of a graph theory problem to illustrate the\nvariety and vastness of the subject.\n",
    "Suppose you have a bipartite graph 𝐺.",
    "This will consist of two sets of vertices 𝐴\nand 𝐵with some edges connecting some vertices of 𝐴to some vertices in 𝐵(but of\ncourse, no edges between two vertices both in 𝐴or both in 𝐵).",
    "A matching of 𝐴is a\nsubset of the edges for which each vertex of 𝐴belongs to exactly one edge of the\nsubset, and no vertex in 𝐵belongs to more than one edge in the subset.",
    "In practice,\nwe will assume that |𝐴| = |𝐵| (the two sets have the same number of vertices), so this\nsays that every vertex in the graph belongs to exactly one edge in the matching.9\nSome context might make this easier to understand.",
    "Think of the vertices in 𝐴as\nrepresenting students in a class, and the vertices in 𝐵as representing presentation\ntopics.",
    "We put an edge from a vertex 𝑎∈𝐴to a vertex 𝑏∈𝐵if student 𝑎would\nlike to present on topic 𝑏.",
    "Of course, some students would want to present on more\nthan one topic, so their vertex would have degree greater than 1.",
    "As the teacher,\nyou want to assign each student their own unique topic.",
    "Thus you want to find a\nmatching of 𝐴: you pick some subset of the edges so that each student gets matched\nup with exactly one topic, and no topic gets matched to two students.10\n9What we are calling a matching is sometimes called a perfect matching or complete matching.",
    "This is\nbecause it is interesting to look at non-perfect matchings as well.",
    "We will call those partial matchings.\n",
    "10The standard example for matchings used to be the marriage problem in which 𝐴consisted of the\n181\n\n182\n2.",
    "Graph Theory\n",
    "The question is: when does a bipartite graph contain a matching of 𝐴?",
    "To begin\nto answer this question, consider what could prevent the graph from containing a\nmatching.",
    "This will not necessarily tell us a condition when the graph does have a\nmatching, but at least it is a start.\n",
    "One way 𝐺could not have a matching is if there is a vertex in 𝐴not adjacent to\nany vertex in 𝐵(so having degree 0).",
    "What else?",
    "What if two students both like the\nsame topic, and no others?",
    "Then after assigning that one topic to the first student,\nthere is nothing left for the second student to like, so it is very much as if the second\nstudent has degree 0.",
    "Or what if three students like only two topics between them?\nAgain, after assigning one student a topic, we reduce this to the previous case of\ntwo students liking only one topic.",
    "We can continue this way with more and more\nstudents.\n",
    "It should be clear at this point that if there is a group of 𝑛students who as a\ngroup like 𝑛−1 or fewer topics, then no matching is possible.",
    "This is true for any\nvalue of 𝑛, and any group of 𝑛students.\n",
    "To make this more graph-theoretic, say you have a set 𝑆⊆𝐴of vertices.",
    "Define\n𝑁(𝑆) to be the set of all the neighbors of vertices in 𝑆. That is, 𝑁(𝑆) contains\nall the vertices (in 𝐵) that are adjacent to at least one of the vertices in 𝑆. (In the\nstudent/topic graph, 𝑁(𝑆) is the set of topics liked by the students of 𝑆.) Our\ndiscussion above can be summarized as follows:\n",
    "Matching Condition.\n",
    "If a bipartite graph 𝐺= {𝐴, 𝐵} has a matching of 𝐴, then\n|𝑁(𝑆)| ≥|𝑆|\nfor all 𝑆⊆𝐴.\nIs the converse true?",
    "Suppose 𝐺satisfies the matching condition |𝑁(𝑆)| ≥|𝑆| for\nall 𝑆⊆𝐴(every set of vertices has at least as many neighbors as vertices in the set).\n",
    "Does that mean that there is a matching?",
    "Surprisingly, yes.",
    "The obvious necessary\ncondition is also sufficient.11 This is a theorem first proved by Philip Hall in 1935.12\nTheorem 2.7.1 Hall’s Marriage Theorem.\n",
    "Let 𝐺be a bipartite graph with sets 𝐴and 𝐵. Then 𝐺has a matching of 𝐴if and only\nif\n|𝑁(𝑆)| ≥|𝑆|\nmen in the town, 𝐵the women, and an edge represented a marriage that was agreeable to both parties.\n",
    "A matching then represented a way for the town elders to marry off everyone in the town, no polygamy\nallowed.",
    "We have chosen a more progressive context for the sake of political correctness.\n",
    "11This happens often in graph theory.",
    "If you can avoid the obvious counterexamples, you often get\nwhat you want.\n",
    "12There is also an infinite version of the theorem, which was proved by Marshal Hall, Jr.",
    "The name\nis a coincidence though as the two Halls are not related.\n\n",
    "2.7.",
    "Matching in Bipartite Graphs\n183\nfor all 𝑆⊆𝐴.\nThere are quite a few different proofs of this theorem – a quick internet search\nwill get you started.\n",
    "In addition to its application to marriage and student presentation topics,\nmatchings have applications all over the place.",
    "We conclude with one such example.\n",
    "Example 2.7.2\nSuppose you deal 52 regular playing cards into 13 piles of 4 cards each.",
    "Prove\nthat you can always select one card from each pile to get one of each of the 13\ncard values Ace, 2, 3, . . .",
    ", 10, Jack, Queen, and King.\n",
    "Solution.\n",
    "Doing this directly would be difficult, but we can use the matching\ncondition to help.",
    "Construct a graph 𝐺with 13 vertices in the set 𝐴, each\nrepresenting one of the 13 card values, and 13 vertices in the set 𝐵, each\nrepresenting one of the 13 piles.",
    "Draw an edge between a vertex 𝑎∈𝐴to\na vertex 𝑏∈𝐵if a card with value 𝑎is in the pile 𝑏. Notice that we are just\nlooking for a matching of 𝐴; each value needs to be found in the piles exactly\nonce.\n",
    "We will have a matching if the matching condition holds.",
    "Given any set\nof card values (a set 𝑆⊆𝐴), we must show that |𝑁(𝑆)| ≥|𝑆|.",
    "That is, the\nnumber of piles that contain those values is at least the number of different\nvalues.",
    "But what if it wasn’t?",
    "Say |𝑆| = 𝑘.",
    "If |𝑁(𝑆)| < 𝑘, then we would have\nfewer than 4𝑘different cards in those piles (since each pile contains 4 cards).\n",
    "But there are 4𝑘cards with the 𝑘different values, so at least one of these cards\nmust be in another pile, a contradiction.",
    "Thus the matching condition holds,\nso there is a matching, as required.\n",
    "Exercises\n1.\nFind a matching of the bipartite graphs below or explain why no matching\nexists.\n",
    "2.\nA bipartite graph that doesn’t have a matching might still have a partial\nmatching.",
    "By this we mean a set of edges for which no vertex belongs to more\nthan one edge (but possibly belongs to none).",
    "Every bipartite graph (with at\nleast one edge) has a partial matching, so we can look for the largest partial\nmatching in a graph.\n",
    "Your “friend” claims that she has found the largest partial matching for the\n\n184\n2.",
    "Graph Theory\ngraph below (her matching is in bold).",
    "She explains that no other edge can be\nadded, because all the edges not used in her partial matching are connected to\nmatched vertices.",
    "Is she correct?\n3.\n",
    "One way you might check to see whether a partial matching is maximal is\nto construct an alternating path.",
    "This is a sequence of adjacent edges, which\nalternate between edges in the matching and edges not in the matching (no\nedge can be used more than once).",
    "If an alternating path starts and stops with\nan edge not in the matching, then it is called an augmenting path.\n",
    "(a) Find the largest possible alternating path for the partial matching of your\nfriend’s graph.",
    "Is it an augmenting path?",
    "How would this help you find\na larger matching?\n(b) Find the largest possible alternating path for the partial matching below.\n",
    "Are there any augmenting paths?",
    "Is the partial matching the largest one\nthat exists in the graph?\n4.\n",
    "The two richest families in Westeros have decided to enter into an alliance by\nmarriage.",
    "The first family has 10 sons, the second has 10 girls.",
    "The ages of the\nkids in the two families match up.",
    "To avoid impropriety, the families insist that\neach child must marry someone either their own age, or someone one position\nyounger or older.",
    "In fact, the graph representing agreeable marriages looks\nlike this:\n\n2.7.",
    "Matching in Bipartite Graphs\n185\nThe question: how many different acceptable marriage arrangements which\nmarry off all 20 children are possible?\n(a) How many marriage arrangements are possible if we insist that there are\nexactly 6 boys who marry girls not their own age?\n(b) Could you generalize the previous answer to arrive at the total number\nof marriage arrangements?\n(c) How do you know you are correct?",
    "Try counting in a different way.",
    "Look\nat smaller family sizes and get a sequence.\n",
    "(d) Can you give a recurrence relation that fits the problem?\n5.\n",
    "We say that a set of vertices 𝐴⊆𝑉is a vertex cover if every edge of the graph\nis incident to a vertex in the cover (so a vertex cover covers the edges).",
    "Since 𝑉\nitself is a vertex cover, every graph has a vertex cover.",
    "The interesting question\nis about finding a minimal vertex cover, one that uses the fewest possible\nnumber of vertices.\n",
    "(a) Suppose you had a matching of a graph.",
    "How can you use that to get a\nminimal vertex cover?",
    "Will your method always work?\n(b) Suppose you had a minimal vertex cover for a graph.",
    "How can you use\nthat to get a partial matching?",
    "Will your method always work?\n(c) What is the relationship between the size of the minimal vertex cover\nand the size of the maximal partial matching in a graph?\n6.\n",
    "For many applications of matchings, it makes sense to use bipartite graphs.\n",
    "You might wonder, however, whether there is a way to find matchings in graphs\nin general.\n",
    "(a) For which 𝑛does the complete graph 𝐾𝑛have a matching?\n(b) Prove that if a graph has a matching, then |𝑉| is even.\n",
    "(c) Is the converse true?",
    "That is, do all graphs with |𝑉| even have a matching?\n(d)",
    "What if we also require the matching condition?",
    "Prove or disprove: If a\ngraph with an even number of vertices satisfies |𝑁(𝑆)| ≥|𝑆| for all 𝑆⊆𝑉,\nthen the graph has a matching.\n\n",
    "2.8\nChapter Summary\nHopefully this chapter has given you some sense of the wide variety of graph theory\ntopics as well as why these studies are interesting.",
    "There are many more interesting\nareas to consider, and the list is increasing all the time; graph theory is an active\narea of mathematical research.\n",
    "One reason graph theory is such a rich area of study is that it deals with such a\nfundamental concept: Any pair of objects can either be related or not related.",
    "What\nthe objects are and what “related” means varies depending on context, and this\nleads to many applications of graph theory to science and other areas of math.",
    "The\nobjects can be countries, and two countries can be related if they share a border.",
    "The\nobjects could be land masses that are related if there is a bridge between them.",
    "The\nobjects could be websites that are related if there is a link from one to the other.",
    "Or\nwe can be completely abstract: The objects are vertices that are related if there is an\nedge between them.\n",
    "What question we ask about the graph depends on the application, but often\nleads to deeper, general and abstract questions worth studying in their own right.\n",
    "Here is a short summary of the types of questions we have considered:\n• Can the graph be drawn in the plane without edges crossing?",
    "If so, how many\nregions does this drawing divide the plane into?\n• Is it possible to color the vertices of the graph so that related vertices have\ndifferent colors using a small number of colors?",
    "How many colors are needed?\n",
    "• Is it possible to trace over every edge of a graph exactly once without lifting\nyour pencil?",
    "What other sorts of “paths” might a graph possess?\n•",
    "Can you find subgraphs with certain properties?",
    "For example, when does a\n(bipartite) graph contain a subgraph in which all vertices are only related to\none other vertex?\n",
    "Not surprisingly, these questions are often related to each other.",
    "For example,\nthe chromatic number of a graph cannot be greater than 4 when the graph is planar.\n",
    "Whether the graph has an Euler trail depends on how many vertices each vertex is\nadjacent to (and whether those numbers are always even or not).",
    "Even the existence\nof matchings in bipartite graphs can be proved using paths.\n",
    "Chapter Review\n1.\n",
    "Which (if any) of the graphs below are the same?",
    "Which are different?",
    "Explain.\n",
    "186\n\n2.8.",
    "Chapter Summary\n187\n2.\n",
    "Which of the graphs in the previous question contain Euler trails or circuits?\nWhich of the graphs are planar?\n",
    "3.\nDraw a graph that has an Euler circuit but is not planar.\n4.\nDraw a graph that does not have an Euler trail and is also not planar.\n",
    "5.\nConsider the graph 𝐺= (𝑉, 𝐸) with 𝑉= {𝑎, 𝑏, 𝑐, 𝑑, 𝑒, 𝑓, 𝑔} and 𝐸=\n{𝑎𝑏, 𝑎𝑐, 𝑎𝑓, 𝑏𝑔, 𝑐𝑑, 𝑐𝑒} (here we are using the shorthand for edges: 𝑎𝑏really\nmeans {𝑎, 𝑏}, for example).\n",
    "(a) Is the graph 𝐺isomorphic to 𝐺′ = (𝑉′, 𝐸′) with 𝑉′ = {𝑡, 𝑢, 𝑣, 𝑤, 𝑥, 𝑦, 𝑧}\nand 𝐸′ = {𝑡𝑧, 𝑢𝑣, 𝑢𝑦, 𝑢𝑧, 𝑣𝑤, 𝑣𝑥}?",
    "If so, give the isomorphism.",
    "If not,\nexplain how you know.\n",
    "(b) Find a graph 𝐺′′ with 7 vertices and 6 edges which is NOT isomorphic to\n𝐺, or explain why this is not possible.\n",
    "(c) Write down the degree sequence for 𝐺. That is, write down the degrees of\nall the vertices, in decreasing order.\n",
    "(d) Find a connected graph 𝐺′′′ with the same degree sequence of 𝐺which\nis NOT isomorphic to 𝐺, or explain why this is not possible.\n",
    "(e) What kind of graph is 𝐺?",
    "Is 𝐺complete?",
    "Bipartite?",
    "A tree?",
    "A cycle?",
    "A\npath?",
    "A wheel?\n(f) Is 𝐺planar?\n(g) What is the chromatic number of 𝐺? Explain.\n",
    "(h) Does 𝐺have an Euler trail or circuit?",
    "Explain.\n",
    "6.\n",
    "If a graph has 10 vertices and 10 edges and contains an Euler circuit, must it be\nplanar?",
    "How many faces would it have?\n7.\nSuppose 𝐺is a graph with 𝑛vertices, each having degree 5.\n(a) For which values of 𝑛does this make sense?\n(b) For which values of 𝑛does the graph have an Euler trail?\n",
    "(c) What is the smallest value of 𝑛for which the graph might be planar?\n(tricky)\n8.\n",
    "At a school dance, 6 girls and 4 boys take turns dancing (as couples) with each\nother.\n",
    "(a) How many couples dance if every girl dances with every boy?\n(b) How many couples dance if everyone dances with everyone else (regard-\nless of gender)?\n",
    "(c) Explain what graphs can be used to represent these situations.\n\n",
    "188\n2.",
    "Graph Theory\n9.\n",
    "Among a group of 𝑛people, is it possible for everyone to be friends with an\nodd number of people in the group?",
    "If so, what can you say about 𝑛?\n10.\n",
    "Your friend has challenged you to create a convex polyhedron containing 9\ntriangles and 6 pentagons.\n",
    "(a) Is it possible to build such a polyhedron using only these shapes?",
    "Explain.\n",
    "(b) You decide to also include one heptagon (seven-sided polygon).",
    "How\nmany vertices does your new convex polyhedron contain?\n(c) Assuming you are successful in building your new 16-faced polyhedron,\ncould every vertex be the joining of the same number of faces?",
    "Could\neach vertex join either 3 or 4 faces?",
    "If so, how many of each type of vertex\nwould there be?\n11.\n",
    "Is there a convex polyhedron that requires 5 colors to properly color the vertices\nof the polyhedron?",
    "Explain.\n12.\n",
    "How many edges does the graph 𝐾𝑛,𝑛have?",
    "For which values of 𝑛does the\ngraph contain an Euler circuit?",
    "For which values of 𝑛is the graph planar?\n13.\n",
    "The graph 𝐺has 6 vertices with degrees 1, 2, 2, 3, 3, 5.",
    "How many edges does\n𝐺have?",
    "If 𝐺was planar, how many faces would it have?",
    "Does 𝐺have an Euler\ntrail?\n14.\n",
    "What is the smallest number of colors you need to properly color the vertices\nof 𝐾7.",
    "Can you say whether 𝐾7 is planar based on your answer?\n15.\n",
    "What is the smallest number of colors you need to properly color the vertices\nof 𝐾3,4?",
    "Can you say whether 𝐾3,4 is planar based on your answer?\n16.\nProve that 𝐾3,4 is not planar.",
    "Do this using Euler’s formula, not just by\nappealing to the fact that 𝐾3,3 is not planar.\n17.\n",
    "A dodecahedron is a regular convex polyhedron made up of 12 regular\npentagons.\n",
    "(a) Suppose you color each pentagon with one of three colors.",
    "Prove that\nthere must be two adjacent pentagons colored identically.\n",
    "(b)",
    "What if you use four colors?\n(c) What if instead of a dodecahedron",
    "you colored the faces of a cube?\n18.\n",
    "Decide whether the following statements are true or false.",
    "Prove your answers.\n",
    "(a) If two graphs 𝐺1 and 𝐺2 have the same chromatic number, then they are\nisomorphic.\n",
    "(b) If two graphs 𝐺1 and 𝐺2 have the same number of vertices and edges and\nhave the same chromatic number, then they are isomorphic.\n",
    "(c) If two graphs are isomorphic, then they have the same chromatic number.\n\n",
    "2.8.",
    "Chapter Summary\n189\n19.\n",
    "If a planar graph 𝐺with 7 vertices divides the plane into 8 regions, how many\nedges must 𝐺have?\n20.\n",
    "Consider the graph below:\n(a) Does the graph have an Euler trail or circuit?",
    "Explain.\n",
    "(b) Is the graph planar?",
    "Explain.\n",
    "(c) Is the graph bipartite?",
    "Complete?",
    "Complete bipartite?\n(d)",
    "What is the chromatic number of the graph?\n21.\n",
    "For each part below, say whether the statement is true or false.",
    "Explain why\nthe true statements are true, and give counterexamples for the false statements.\n",
    "(a) Every bipartite graph is planar.\n",
    "(b) Every bipartite graph has chromatic number 2.\n(c)",
    "Every bipartite graph has an Euler trail.\n",
    "(d)",
    "Every vertex of a bipartite graph has even degree.\n",
    "(e) A graph is bipartite if and only if the sum of the degrees of all the vertices\nis even.\n",
    "22.\nConsider the statement, “If a graph is planar, then it has an Euler trail.”\n(a) Write the converse of the statement.\n",
    "(b) Write the contrapositive of the statement.\n",
    "(c) Write the negation of the statement.\n",
    "(d) Is it possible for the contrapositive to be false?",
    "If it was, what would that\ntell you?\n(e) Is the original statement true or false?",
    "Prove your answer.\n",
    "(f) Is the converse of the statement true or false?",
    "Prove your answer.\n",
    "23.\n",
    "Let 𝐺be a connected graph with 𝑣vertices and 𝑒edges.",
    "Use mathematical\ninduction to prove that if 𝐺contains exactly one cycle (among other edges and\nvertices), then 𝑣= 𝑒.\n",
    "Note: This is asking you to prove a special case of Euler’s formula for planar\ngraphs, so do not use that formula in your proof.\n\n\n",
    "Chapter 3\nCounting\nOne of the first things you learn in mathematics is how to count.",
    "Now we want to\ncount large collections of things quickly and precisely.",
    "For example:\n• In a group of 10 people, if everyone shakes hands with everyone else exactly\nonce, how many handshakes take place?\n",
    "• How many ways can you distribute 10 Girl Scout cookies to 7 Boy Scouts?\n",
    "• How many anagrams are there of “anagram”?\n",
    "Before tackling questions like these, let’s look at the basics of counting.\n",
    "3.1\nPascal’s Arithmetical Triangle\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Use Pascal’s triangle to answer counting questions about lattice paths,\nbit strings, and subsets.\n",
    "2. Explain how Pascal’s triangle is generated and how it relates to\ncounting questions.\n",
    "3. Explain why Pascal’s triangle is related to so many different types of\ncounting problems.\n191\n\n192\n3.",
    "Counting\n3.1.1\nSection Preview\nInvestigate!\n",
    "In chess, a rook can move only in straight lines (not diagonally).",
    "How many\nways can the rook in the top-left corner travel to the bottom-right corner of\nthe board, moving only down and to the right?\nR\n6\n?\nAlso, what does this have to do with counting how many pizzas you can\norder if you use half of the 14 available toppings?\n",
    "Preview Activity\nLet’s find some of the numbers of paths that the rook can take to get to various\nsquares in the chessboard.\n",
    "1.\n",
    "The 6 in the square in the 3rd row and column represents that there are 6\ndifferent paths to that square, even though there are only four squares the rook\nmust move through to get there.",
    "One path is DDRR (down down right right).\n",
    "List all 6 paths.\n",
    "2.\nHow many paths are there to the square in row 4, column 2 (diagonally down\nand to the left of the 6)?",
    "List out all the paths as D/R strings.\n",
    "How many paths is this?",
    "That is, what number goes in that square of the\nchessboard?\n3.\nNow let’s find the paths to the square in row 4, column 3 (directly below the 6).\n",
    "First, list all the paths that end with an R.\nNext, list all the paths that end with a D.\nAre there any other paths?",
    "In total, how many paths are there to this\nsquare?\n\n3.1.",
    "Pascal’s Arithmetical Triangle\n193\n4.\nContinue filling in the chessboard, either counting D/R strings directly or\nusing your observation from the previous task.",
    "What is the number in the\nlower right corner of the chessboard?\n\n194\n3.",
    "Counting\nIn 1653, Blaise Pascal, concerned with questions that would lay the foundation\nof probability theory, collected several facts about a triangular array of numbers in\nhis Treatise on Arithmetical Triangle.",
    "This arrangement of numbers appeared as early\nas the 10th century in China, India, and Persia.",
    "The Chinese and Persian treatment\nof the triangle was in service of what we would now consider algebra: finding\n𝑛th roots, essentially solving polynomial equations.",
    "The numbers in the triangle\nappear as solutions to counting problems in Indian texts: from six tastes, how many\ncombinations of one, or two, or three,... can you make?",
    "European mathematicians\nin the 14th century presented the triangle as a table of figurate numbers (numbers\nthat can be arranged in a geometric shape), which were themselves the centerpiece\nof the work of Pythagoras and his followers.\n",
    "So what is this remarkable triangle that holds the secrets of so many different\nmathematical problems?",
    "Behold, Pascal’s triangle:\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n2\n1\n3\n3\n1\n4\n6\n4\n1\n5\n10\n10\n5\n1\n6\n15\n20\n15\n6\n1\n7\n21\n35\n35\n21\n7\n1\n8\n28\n56\n70\n56\n28\n8\n1\n9\n36\n84\n126\n126\n84\n36\n9\n1\n10\n45\n120\n210\n252\n210\n120\n45\n10\n1\n11\n55\n165\n330\n462\n462\n330\n165\n55\n11\n1\n12\n66\n220\n495\n792\n924\n792\n495\n220\n66\n12\n1\n13\n78\n286\n715\n1287\n1716\n1716\n1287\n715\n286\n78\n13\n1\n14\n91\n364\n1001\n2002\n3003\n3432\n3003\n2002\n1001\n364\n91\n14\n1\n15\n105\n455\n1365\n3003\n5005\n6435\n6435\n5005\n3003\n1365\n455\n105\n15\n1\n16\n120\n560\n1820\n4368\n8008\n11440\n12870\n11440\n8008\n4368\n1820\n560\n120\n16\n1\nFigure 3.1.1 Pascal’s triangle.\n",
    "Spend some time gazing at the beauty of this triangle.",
    "What do you notice?\n",
    "What do you wonder?",
    "Look specifically at the 5th row (we call the 1 on the top row\n0, so row 5 is 1, 5, 10, 10, 5, 1).",
    "How do the numbers in this row relate to the numbers\n\n3.1.",
    "Pascal’s Arithmetical Triangle\n195\nabove them?",
    "Notice that 5 = 1 + 4 and 10 = 4 + 6.",
    "Does this occur anywhere else in\nthe triangle?\n",
    "Indeed, every number in the triangle is the sum of the two numbers above it.",
    "Let’s\ntake this as our definition of Pascal’s triangle.",
    "We can then generate as many rows\nof the triangle as we like.",
    "It is this additive definition that was used in China and\nPersia to find 𝑛th roots, and we will briefly mention this use at the end of this section.\n",
    "However, we are interested in counting questions, so our main goal now is to observe\nhow the numbers of Pascal’s triangle are answers to a variety of counting questions.\n",
    "Here are some apparently different discrete objects we can count: lattice paths,\nbit strings, subsets, and pizzas.",
    "We will give an example of each type of counting\nproblem (and say what these things even are).",
    "As we will see, the numbers in\nPascal’s triangle are the answers to all of these questions.\n",
    "Before we jump in, a little bit of notation.",
    "Let’s give each number in Pascal’s\ntriangle a name, based on its position.",
    "Think of each number as being in a row and\na column: rows are counted down, starting at 0, and columns are counted in from\nthe left, also starting at 0.",
    "The entry in row 𝑛and column 𝑘will be denoted \u0000𝑛\n𝑘\n\u0001.\nFor example, the \u00006\n3\n\u0001\n= 20, since that is the value in row 6, column 3.",
    "For reasons\nthat will become clear soon, we pronounce \u0000𝑛\n𝑘\n\u0001\nas “𝑛choose 𝑘.”",
    "We can rewrite the\ntriangle with these names:\n\u0012\n0\n0\n\u0013\n\u0012\n1\n0\n\u0013\n\u0012\n1\n1\n\u0013\n\u0012\n2\n0\n\u0013\n\u0012\n2\n1\n\u0013\n\u0012\n2\n2\n\u0013\n\u0012\n3\n0\n\u0013\n\u0012\n3\n1\n\u0013\n\u0012\n3\n2\n\u0013\n\u0012\n3\n3\n\u0013\n\u0012\n4\n0\n\u0013\n\u0012\n4\n1\n\u0013\n\u0012\n4\n2\n\u0013\n\u0012\n4\n3\n\u0013\n\u0012\n4\n4\n\u0013\n3.1.2\nLattice Paths\nThe integer lattice is the set of all points in the Cartesian plane for which both the 𝑥\nand 𝑦coordinates are integers.",
    "If you like to draw graphs on graph paper, the lattice\nis the set of all the intersections of the grid lines.\n",
    "A lattice path is one of the shortest possible paths connecting two points on the\nlattice, moving only horizontally and vertically.",
    "For example, here are three possible\nlattice paths from the point (0, 0) to (3, 2):\n\n196\n3.",
    "Counting\n(0,0)\n(3,2)\n(0,0)\n(3,2)\n(0,0)\n(3,2)\nNotice that to ensure the path is the shortest possible, each move must be either\nto the right or up.",
    "Additionally, in this case, no matter what path we take, we must\nmake three steps right and two steps up.",
    "No matter in what order we make these\nsteps, there will always be five steps.",
    "Thus each path has length five.\n",
    "The counting question we will ask is this: how many lattice paths are there\nbetween (0, 0) and (3, 2)?",
    "In this case, drawing all the paths wouldn’t take too long.\n",
    "Or we could list each path as a string of “directions” such as 𝑥𝑥𝑦𝑦𝑥, 𝑦𝑦𝑥𝑥𝑥, or\n𝑥𝑦𝑥𝑥𝑦, which correspond to the three paths drawn above, where an 𝑥means travel\none unit in the 𝑥direction, and similarly for 𝑦.",
    "We would get the following ten\npaths:\n𝑥𝑥𝑥𝑦𝑦\n𝑥𝑥𝑦𝑥𝑦\n𝑥𝑦𝑥𝑥𝑦\n𝑦𝑥𝑥𝑥𝑦\n𝑥𝑥𝑦𝑦𝑥\n𝑥𝑦𝑥𝑦𝑥\n𝑦𝑥𝑥𝑦𝑥\n𝑥𝑦𝑦𝑥𝑥\n𝑦𝑥𝑦𝑥𝑥\n𝑦𝑦𝑥𝑥𝑥.\nWhen the distance between starting and stopping points is larger, we will want to\nfind a more efficient way to count the paths.\n",
    "Let’s take what we learned from the rook paths (which are, gasp, actually lattice\npaths).",
    "Consider the lattice shown below:\n(0,0)\n(3,2)\n𝐵\n𝐴\nAny lattice path from (0,0) to (3,2) must pass through exactly one of 𝐴and 𝐵.\nThe point 𝐴is 4 steps away from (0,0) and two of them are in the 𝑥direction.",
    "The\nlast step is also in the 𝑥direction, so the paths from (0,0) to (3,2) that pass through 𝐴\nare exactly the six strings we listed above that end in an 𝑥. For the paths that pass\nthrough point 𝐵, the last step will be in the 𝑦direction, so the paths from (0,0) to\n(3,2) that pass through 𝐵are exactly the four strings we listed above that end in a 𝑦.\n",
    "So the total number of paths to (3,2) is just 6 + 4.\n",
    "The general observation here is that to find the number of paths that start at (0, 0)\nand end at (𝑚, 𝑛), we can find the number of paths to the point directly to the left of\nthe endpoint, (𝑚−1, 𝑛) and add the number of paths to the point directly below the\nendpoint, (𝑚, 𝑛−1).",
    "This is exactly the same way that Pascal’s triangle is generated!\n",
    "Indeed, if we rotate the lattice appropriately, so the point (0, 0) is at the top of the\n\n3.1.",
    "Pascal’s Arithmetical Triangle\n197\ntriangle and the axes along the sides of the triangle, we see that the numbers in\nPascal’s triangle give us exactly the number of paths to each lattice point.\n",
    "(0,0)\n(3,2)\n𝐵\n𝐴\n1\n1\n1\n1\n1\n1\n1\n2\n1\n3\n3\n1\n4\n6\n4\n1\n5\n10\n10\n5\n1\nTo make this observation helpful for actually finding the number of paths from\nthe origin to a given point, we note that it is the length of the path that determines\nthe row of Pascal’s triangle, and the number of steps in the 𝑦direction that says how\nfar into the triangle we are -- the column of Pascal’s triangle.\n",
    "Example 3.1.2\nHow many lattice paths are there from (0, 0) to (4, 7)?\n",
    "Solution.\n",
    "The length of these paths is 4 + 7 = 11.",
    "Look at the 11th row of\nPascal’s triangle:\n1, 11, 55, 165, 330, 462, 462, 330, 165, 55, 11, 1.\n",
    "Count to the 7th position (remembering that the 1 is in position 0) which\ngives us \u000011\n7\n\u0001\n= 330 different paths.\n",
    "3.1.3\nBit Strings\n“Bit” is short for “binary digit,” so a bit string is a string of binary digits.",
    "The binary\ndigits are simply the numbers 0 and 1.",
    "All of the following are bit strings:\n1001\n0\n1111\n1010101010.\n",
    "The number of bits (0’s or 1’s) in the string is the length of the string; the strings\nabove have lengths 4, 1, 4, and 10 respectively.",
    "We also can ask how many of the bits\nare 1’s.",
    "The number of 1’s in a bit string is the weight of the string; the weights of\nthe above strings are 2, 0, 4, and 5 respectively.\n\n",
    "198\n3.",
    "Counting\nDefinition 3.1.3 Bit Strings.\n",
    "•",
    "An 𝑛-bit string is a bit string of length 𝑛. That is, it is a string containing\n𝑛symbols, each of which is a bit, either 0 or 1.\n",
    "•",
    "The weight of a bit string is the number of 1’s in it.\n",
    "• B𝑛\n𝑘is the set of all 𝑛-bit strings of weight 𝑘.\n",
    "For example, the elements of the set B3\n2 are the bit strings 011, 101, and 110.",
    "Those\nare the only strings containing three bits, exactly two of which are 1’s.\n",
    "The counting questions: How many 5-bit strings have weight 3?",
    "In other words,\nwe are asking for the cardinality |B5\n3|.\n",
    "Let’s just list them and see how many there are.\n11100\n11010\n10110\n01110\n11001\n10101\n01101\n10011\n01011\n00111.\n",
    "Great.",
    "Ten of them.",
    "Actually, I have a confession: I didn’t type all of these from\nscratch.",
    "Instead I just modified the list of 10 lattice paths from (0,0) to (3,2) that we\nfound earlier.",
    "Each 𝑥became a 1 and each 𝑦became a 0.",
    "After all, any lattice path\nwith length 𝑛that requires 𝑘steps in the 𝑥direction can be represented by a string\nof 𝑛symbols of two types, with 𝑘of those symbols being of one type.",
    "Whether\nwe call the two symbols 𝑥and 𝑦or",
    "we call them 1 and 0 will not change how many\nstrings we get.\n",
    "It is not surprising then that the same relationship between Pascal’s triangle and\nlattice paths holds for bit strings.",
    "Look at the 10 strings above.",
    "The first row contains\nall the bit strings of B5\n3 that end in a 0.",
    "Before that ending 0, we have a string in B4\n3,\nsince it must have length 4 and weight 3 (the ending 0 increases the length, but not\nthe weight).",
    "The second row contains all the bit strings of B5\n3 that end in a 1.",
    "Before\nthat ending 1, we have a string in B4\n2, since it must have length 4 and weight 2 (the\nending 1 increases the length and the weight).",
    "So the number of 5-bit strings of\nweight 3 is the sum of the number of 4-bit strings of weight 3 and the number of\n4-bit strings of weight 2.",
    "In symbols:\n|B5\n3| = |B4\n3| + |B4\n2|.\n",
    "Now we have two good reasons to believe that Pascal’s triangle tells us the\nnumber of bit strings of a given weight: There is a one-to-one correspondence\nbetween lattice paths and bit strings, and the same recursive relationship holds for\nbit strings as it does for generating Pascal’s triangle.",
    "So we can now use the triangle\nto count bit strings.\n\n3.1.",
    "Pascal’s Arithmetical Triangle\n199\nExample 3.1.4\nHow many 11-bit strings have weight 5?\nSolution.\n",
    "There will be \u000011\n5\n\u0001\nsuch strings.",
    "From Pascal’s triangle, we see that\n\u000011\n5\n\u0001\n= 462\n3.1.4\nSubsets and Pizzas\nA subset of a set 𝐴is any set all of whose elements are also in 𝐴. Think of starting\nwith the set 𝐴and removing some (or none or all) of its elements: the resulting\nset is a subset of 𝐴. (More information about sets can be found in Section 0.2 and\nSection 5.1.)\n",
    "Suppose we look at the set 𝐴= {1, 2, 3, 4, 5}.",
    "How many subsets of 𝐴contain\nexactly 3 elements?",
    "Let’s list them all:\n{1, 2, 3}\n{1, 2, 4}\n{1, 3, 4}\n{2, 3, 4}\n{1, 2, 5}\n{1, 3, 5}\n{2, 3, 5}\n{1, 4, 5}\n{2, 4, 5}\n{3, 4, 5}.\n",
    "Again, we see there are ten.",
    "In fact, we have listed them in the same order as\nwe listed the ten 5-bit strings of weight 3 and the ten lattice paths from (0,0) to (3,2).\n",
    "Wait, does this even make sense?",
    "In what way is a subset the same as a bit-string?\nThink of each bit in a bit string as representing one of the elements in a set.",
    "The\nset 𝐴has five elements, so we need five bits to represent a subset of 𝐴.",
    "If the bit in\nposition 𝑛is a 0, that means we do not include 𝑛in our subset, while a 1 in that\nposition tells us that 𝑛is in the subset.",
    "Three 1’s means we have said, “yes” to three\nelements.\n",
    "Example 3.1.5\nWhich subsets of {1, 2, 3, 4, 5, 6} correspond to the bit strings below?\n101011\n001000\n111111\n000000\nSolution.\n",
    "Here we are not fixing the weight of the strings, so our subsets\nwill not all have the same size.",
    "Here is the correspondence:\n101011\n{1, 3, 5, 6}\n001000\n{3}\n111111\n{1, 2, 3, 4, 5, 6}\n000000\n∅\nThe last subset is the empty set: the set that contains no elements (we could\nhave also written {}).",
    "This is a subset of every set!\n\n200\n3.",
    "Counting\nRemark 3.1.6 What we have done here is give a bĳection between the set of\n5-bit strings of weight 3 and the set of 3-element subsets of 𝐴. A bĳection is a\nfunction 𝑓: 𝑋→𝑌such that each element of 𝑌is the image of exactly one\nelement from 𝑋. You can prove that if there is a bĳection between two sets,\nthen they have the same number of elements.",
    "This is a common counting\ntechnique we will use in the upcoming sections.\n",
    "This example illustrates that, once again, Pascal’s triangle can give us the answer\nto a counting question.",
    "The number of 𝑘-element subsets of a set with 𝑛elements is\nthe same as the number of 𝑛-bit strings of weight 𝑘, and that is the number in row 𝑛,\ncolumn 𝑘of the triangle: \u0000𝑛\n𝑘\n\u0001\n.\n",
    "Example 3.1.7\nHow many subsets of the set {𝑎, 𝑏, 𝑐, 𝑑, 𝑒, 𝑓, 𝑔} have exactly 4 elements?\nSolution.\n",
    "The set contains 7 elements, so the number of 4-element subsets\nis the same as the number of 7-bit strings of weight 4, namely \u00007\n4\n\u0001\n= 35.\n",
    "At this point I’m sure we are all getting pretty hungry, so let’s get some pizza.\n",
    "But which pizza shall we order?",
    "Let’s not overdo it and just choose three toppings\nfrom the ten available.",
    "How many different pizzas can we order?\n",
    "Aha!",
    "So that’s why we care about counting subsets!!",
    "Each pizza choice is nothing\nmore than a 3-element subset of the set of 10 toppings.",
    "We now know how to count\nthis: \u000010\n3\n\u0001\n= 120 different pizzas.\n",
    "What if we want an Italian soda with dinner?",
    "Let’s say we want to add two\ndifferent flavored syrups from the 13 available.",
    "How many different sodas are\npossible?",
    "This is just the number of 2-element subsets of a set with 13 elements:\n\u000013\n2\n\u0001\n= 78.\n",
    "This is why we pronounce \u0000𝑛\n𝑘\n\u0001\nas “𝑛choose 𝑘”.",
    "It is the number of ways to choose\n𝑘items from a collection of 𝑛items, since choosing 𝑘elements is exactly how you\nbuild a 𝑘-element subset.\n",
    "We can view counting lattice paths as choosing 𝑘out of 𝑛things: Of the 𝑛steps\non the path, we choose 𝑘of them to be in the 𝑥direction.",
    "Bit strings can also be\nthought of in this way: Of the 𝑛bits in the string, we choose 𝑘of them to be 1’s.\n",
    "We can now answer all sorts of real-world counting problems, as long as they are\nreally nothing more than asking for the number of subsets of a set.",
    "Pascal’s triangle\ncontains all these answers.\n",
    "Counting Subsets.\n",
    "The number of 𝑘-element subsets of a set with 𝑛elements is the number\nin row 𝑛, column 𝑘of Pascal’s triangle: \u0000𝑛\n𝑘\n\u0001, which we read as “𝑛choose 𝑘.”\n",
    "This is the number of ways to choose 𝑘items from a collection of 𝑛items.\n\n3.1.",
    "Pascal’s Arithmetical Triangle\n201\n3.1.5\nAlgebra?\n",
    "Earlier we said that one of the original uses for Pascal’s triangle was to solve problems\nin algebra.",
    "What does counting subsets (or bit strings or lattice paths) have to do\nwith algebra?\nSuppose you expand the binomial expression (𝑥+ 1)6 (i.e., multiply the binomial\n𝑥+ 1 by itself six times).",
    "This can be tedious to do by hand, but a computer algebra\nsystem such as SageMath can do this easily.\nexpand ((x+1)^6)\n",
    "x^6",
    "+",
    "6*x^5 +",
    "15*x^4 + 20*x^3",
    "+ 15*x^2",
    "+",
    "6*x + 1\nDo the coefficients look familiar?",
    "Consider the 6th row of Pascal’s triangle:\n1\n6\n15\n20\n15\n6\n1.\n",
    "Why are these the coefficients?\nTry it 3.1.8\nModify the SageMath code above to expand (𝑥+ 1)10.",
    "What is the coefficient\nof 𝑥6?\nTo see why this is more than just a coincidence, let’s look at the expansion of\n(𝑥+ 𝑦)3 and do it very carefully.",
    "We are really multiplying out\n(𝑥+ 𝑦)(𝑥+ 𝑦)(𝑥+ 𝑦).\n",
    "This means we must distribute the binomials, which looks like the following.",
    "(We\nwill use a different typeface for each version of the 𝑥and 𝑦to keep track of where\neverything comes from.)\n",
    "(𝑥+ 𝑦)3 =(𝑥+ 𝑦)(x + y)(𝒳+ 𝒴)\n=[(𝑥+ 𝑦)(x + y)]𝒳+",
    "[(𝑥+ 𝑦)(x + y)]𝒴\n=[(𝑥+ 𝑦)x + (𝑥+ 𝑦)y]𝒳+ [(𝑥+ 𝑦)x + (𝑥+ 𝑦)y]𝒴\n=[𝑥x + 𝑦x + 𝑥y + 𝑦y]𝒳+",
    "[𝑥x + 𝑦x + 𝑥y + 𝑦y]𝒴\n=𝑥x𝒳+ 𝑦x𝒳+ 𝑥y𝒳+ 𝑦y𝒳+ 𝑥x𝒴+ 𝑦x𝒴+ 𝑥y𝒴+ 𝑦y𝒴.\nThis repeated distribution results in a sum of terms, each the product of three\nvariables.",
    "We see that each term is the result of choosing either the 𝑥or the 𝑦from\neach of the binomials.",
    "For example, the term 𝑥y𝒳is the result of choosing the 𝑥\nfrom the first binomial, the y from the second, and the 𝒳from the third.\n",
    "Say we want to find the coefficient of the 𝑥2𝑦therm.",
    "We collect like terms,\ncollecting all the terms in which we have chosen 𝑥two times (and 𝑦the other one\ntime).",
    "Alternatively, the 𝑥2𝑦term comes from all the strings with two 𝑥and one 𝑦,\n\n202\n3.",
    "Counting\njust like a bit string or lattice path.",
    "No matter how you think of it, the result is that\nwe have \u00003\n2\n\u0001\n= 3 terms with the form 𝑥2𝑦.\nHopefully it is clear that this generalizes to the expansion of (𝑥+ 𝑦)𝑛for any\npositive integer 𝑛. This is known as the binomial theorem.\n",
    "Theorem 3.1.9 Binomial Theorem.\n",
    "The 𝑛th row of Pascal’s triangle gives the coefficients of the expansion of (𝑥+ 𝑦)𝑛.\nThat is, for any positive integer 𝑛,\n(𝑥+ 𝑦)𝑛=\n\u0012\n𝑛\n0\n\u0013\n𝑥𝑛+\n\u0012\n𝑛\n1\n\u0013\n𝑥𝑛−1𝑦+ · · · +\n\u0012\n𝑛\n𝑛−1\n\u0013\n𝑥𝑦𝑛−1 +\n\u0012\n𝑛\n𝑛\n\u0013\n𝑦𝑛.,\nso the coefficient of 𝑥𝑘𝑦𝑛−𝑘is \u0000𝑛\n𝑘\n\u0001\n.\n",
    "For this reason, the numbers in Pascal’s triangle are often called binomial\ncoefficients.\n",
    "Example 3.1.10\nWithout multiplying out the binomial, give the expansion of (𝑥+ 𝑦)5.\n",
    "Solution.\n",
    "We take the 5th row of Pascal’s triangle: 1, 5, 10, 10, 5, 1.",
    "The\nexpansion is then,\n(𝑥+ 𝑦)5 = 𝑥5 + 5𝑥4𝑦+ 10𝑥3𝑦2 + 10𝑥2𝑦3 + 5𝑥𝑦4 + 𝑦5.\n",
    "3.1.6\nReading Questions\n1.\n",
    "Why is the number of lattice paths from (0, 0) to (3, 5) the same as the number\nof 8-bit strings with weight 5?\n2.\nWhich of the following counting questions have the answer \u000011\n5\n\u0001?",
    "Select all\nthat apply.\n",
    "A. How many lattice paths are there from (0, 0) to (11, 5)?\n",
    "B. How many subsets of {1, 2, . .",
    ".",
    ", 11} contain exactly 5 elements?\nC. How many 11-bit strings have weight 5?\nD. How many ways can you select 5 flavors of ice cream for a giant sundae\nfrom 11 available flavors?\n",
    "3.\n",
    "The number of subsets of {1, 2, . . .",
    ", 8} of size 3 is the same as the number of\nsubsets of {1, 2, . . .",
    ", 7} of size either 2 or 3.",
    "Explain why this makes sense.\n",
    "4.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n\n3.1.",
    "Pascal’s Arithmetical Triangle\n203\n3.1.7\nPractice Problems\n1.\nUse Pascal’s triangle to find the numeric values of the following.\n",
    "(a)\n\u0012\n7\n2\n\u0013\n(b)\n\u0012\n7\n3\n\u0013\n(c)\n\u0012\n8\n3\n\u0013\n(d)\n\u0012\n10\n5\n\u0013\n(e)\n\u0012\n8\n7\n\u0013\n(f)\n\u0012\n13\n2\n\u0013\n2.\n",
    "Compute the following sums of the rows of Pascal’s triangle.\n",
    "\u0012\n2\n0\n\u0013\n+\n\u0012\n2\n1\n\u0013\n+\n\u0012\n2\n2\n\u0013\n.\n",
    "\u0012\n3\n0\n\u0013\n+\n\u0012\n3\n1\n\u0013\n+\n\u0012\n3\n2\n\u0013\n+\n\u0012\n3\n3\n\u0013\n.\n",
    "\u0012\n4\n0\n\u0013\n+\n\u0012\n4\n1\n\u0013\n+\n\u0012\n4\n2\n\u0013\n+\n\u0012\n4\n3\n\u0013\n+\n\u0012\n4\n4\n\u0013\n.\n",
    "Now based on your work in the above calculations, give a guess for the\nsum of the 13th row of Pascal’s triangle.\n",
    "3.\nConsider the lattice paths from (3,4) to (8,10).\n",
    "How long is each such path?\nHow many steps are in the x-direction?\n",
    "How many different paths are there?\n4.\nHow many lattice paths are there from (𝑎, 𝑏) to (𝑐, 𝑑)?",
    "Give your answer as a\nbinomial coefficient, so \u0000𝑛\n𝑘\n\u0001\n, but say what 𝑛and 𝑘are.\n",
    "5.\nConsider the bit string 100110010.\n",
    "What is the length of the bit string?\n",
    "What is the weight of the bit string?\nHow many bit strings (including this one) have the same length of weight\nas it?\n",
    "6.\nConsider the set B8\n3 of 8-bit strings of weight 3.\nHow many 1s are there in each bit-string?",
    "How many 0s are there in each\nbit-string?\nHow many bit strings are there in the set?\nHow many 8-bit strings of weight 5 are there?\n",
    "7.\nSuppose you are ordering a calzone from D.P. Dough.",
    "You want 5 distinct\ntoppings, chosen from their list of 10 vegetarian toppings.\n",
    "a. How many choices do you have for your calzone?\nb.",
    "How many choices do you have for your calzone if you refuse to have\ngreen pepper as one of your toppings?\n\n204\n3.",
    "Counting\nc. How many choices do you have for your calzone if you insist on having\ngreen pepper as one of your toppings?\n",
    "How do the three questions above relate to each other?",
    "Do you see why\nthis makes sense?\n8.\nHow many subsets of {1, 2, 3, 4, 5, 6, 7, 8} have six elements?\n",
    "Of those, how many contain the number 1?\nOf the total number of 6-element subsets, how many do NOT contain the\nnumber 1?\n9.\n",
    "What is the coefficient of 𝑥14 in (𝑥+ 3)16?\n10.\n",
    "What is the coefficient of 𝑥9 in the expansion of (𝑥+ 2)17 + 𝑥4(𝑥+ 3)21?\n3.1.8\nAdditional Exercises\n1.\n",
    "How many lattice paths are there from (0, 0) to (8, 3).",
    "How many lattice paths\nare there from (0, 0) to (3, 8)?",
    "Why does it make sense that these two numbers\nare the same?",
    "Explain your reasoning.\n",
    "2.\nSuppose you are counting lattice paths from (0, 0) to (4, 3).",
    "We know that the\nnumber of such paths is \u00004+3\n4\n\u0001\n= \u00007\n6\n\u0001\n= 35.",
    "Here is another way to count these\npaths: Consider the cases for where your first step in the 𝑦-direction is.",
    "There\nare five different options here; compute the number of paths for each case.\n",
    "(a) How many paths are there from (0, 0) to (4, 3) where the first step is in\nthe 𝑦-direction (i.e., paths that pass through the point (0, 1))?\n",
    "(b) How many paths are there from (0, 0) to (4, 3) that first move one step in\nthe 𝑥-direction, then one step in the 𝑦-direction (so they pass through\nthe points (1, 0) and then (1, 1))?\n",
    "(c) List the remaining three cases and how many paths there are for each\ncase.\n",
    "(d) Verify that the sum of the paths in each case is 35.",
    "Then describe where\nall these numbers are in Pascal’s triangle.",
    "Find another instance of this\npattern and verify that it works.\n",
    "3.\nExplain why the coefficient of 𝑥5𝑦3 is the same as the coefficient of 𝑥3𝑦5 in the\nexpansion of (𝑥+ 𝑦)8?\n4.\nConsider the expansion of (𝑥+ 𝑦)5.\n",
    "(a) Use the binomial theorem to write out the expansion of (𝑥+ 𝑦)5.\n",
    "(b) Using the expanded version of (𝑥+ 𝑦)5, multiply (using the distributive\nproperty) (𝑥+ 𝑦)5 · (𝑥+ 𝑦).",
    "Simplify your answer, but show all your steps.\n",
    "(c) How does your previous answer relate to what you get when you apply\nthe binomial theorem to (𝑥+ 𝑦)6?\n\n3.2\nCombining Outcomes\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Apply the sum and product principles to count the number of outcomes\nof an event.\n",
    "2.",
    "Solve counting problems using a combination of the sum and product\nprinciples.\n",
    "3. Justify the product principle in terms of the sum principle.\n",
    "3.2.1\nSection Preview\nInvestigate!\n",
    "A standard deck of playing cards contains 52 cards.",
    "There are four suits:\nclubs, diamonds, hearts, and spades.",
    "Each suit contains cards of 13 values:\nAce, 2, 3,..., 10, Jack, Queen, and King.\n",
    "We call the hearts and diamonds red cards (with clubs and spades the\nblack cards).",
    "In each suit, the Jack, Queen, and King are called face cards\n(the others are call number cards).\n",
    "Suppose you pick two cards from a deck.",
    "How many different combi-\nnations will have the first card be a red card and the second card be a face\ncard?\n",
    "Combinatorics is about counting, but looking at the word, we see it really deals\nwith how things combine.",
    "In this section, we will consider two very different ways\nthat we can combine the outcomes we count in combinatorics problems.\n",
    "Preview Activity\n1.\n",
    "A restaurant offers 8 appetizers and 14 entrées.",
    "How many choices do you\nhave if:\na. you will eat one dish, either an appetizer or an entrée?\n",
    "b.",
    "you are extra hungry and want to eat both an appetizer and an entrée?\n",
    "2.\nThink about the methods you used to solve the questions about appetizers\nand entrées.",
    "Can you frame these as rules for how to combine two numbers of\nthings when counting?",
    "Write down the rules for these methods.\n",
    "205\n\n206\n3.",
    "Counting\n3.\nDo your rules work?",
    "Let’s apply them to another counting problem to check.\n",
    "Given that a standard deck of playing cards has 12 face cards and 26 red cards,\nanswer the following.\n",
    "(a) How many ways can you select a card which is either a face card or a red\ncard?\n(b) How many ways can you select a card which is both a face card and a red\ncard?\n",
    "3.2.2\nWhat are Outcomes?\n",
    "Before we start counting, a quick note about how we ask counting problems.",
    "Often\ncounting problems are asked terms of how many ways something can happen.",
    "That\nis, there is some event that can result in different outcomes, and it is the different\noutcomes that are counted.",
    "Alternatively, we can take a less “active” view by asking\nfor the number of elements in a set, such as the set of bit strings of a particular length\nand weight.",
    "However, this too could be rephrased as a question about an event: if\nyou randomly select one of the bit strings (from the set of bit strings), how many\nthings can happen?\n",
    "So counting the elements in a set or counting the number of outcomes of an\nevent is not really different.",
    "Let’s think of every counting problem as asking for the\nnumber of elements in a set of outcomes.\n",
    "At the most basic level, counting is not hard at all: Just write all the outcomes in\na numbered list and see how many numbers you use.",
    "Let me tell you about my bow\ntie collection.",
    "I have,\n1.",
    "A purple bow tie.\n",
    "2.",
    "A green bow tie.\n",
    "3.",
    "A striped bow tie.\n",
    "4.",
    "A paisley bow tie.\n",
    "How many bow ties do I have (how many ways can I select a bow tie)?",
    "Well, the\nlargest number in my numbered list is 4, so I have four bow ties.1",
    "Of course, as\nwe saw in the previous section, we can use shortcuts to avoid listing out all of the\noutcomes, such as using Pascal’s triangle to find the number of items in our list.\n",
    "Where counting begins to get interesting is when we want to make a new list\nthat combines two or more lists we have already counted.",
    "For example, suppose\nthat in addition to my list of four bow ties, I had a list of seven pairs of novelty socks.\n",
    "I could ask how many choices I have if I wanted to wear either a cool bow tie or a\npair of novelty socks.",
    "Okay, combine my two lists to make a new list with 11 items:\nPerhaps first list the four bow ties and then keep counting (starting with 5 for the\nfirst pair of socks) until you have listed the seven additional items, ending at 11.\n",
    "1Obviously this example is quite outdated; only four bow ties?",
    "What sort of mathematician do you\ntake me for?\n\n3.2.",
    "Combining Outcomes\n207\nIn this example, we have combined our two sets of outcomes (picking a bow tie\nand picking a pair of socks) to get a new set of outcomes (picking a bow tie or pair\nof socks).",
    "That resulting set of outcomes contained 11 elements.\n",
    "Now consider the question: How many choices do I have if I want to wear both\na bow tie and a pair of novelty socks?",
    "Again, I need to combine my two sets of\noutcomes to get a new set of outcomes.",
    "But this new set of outcomes will contain\n28 elements.",
    "How did I know that I should multiply the number of elements in\neach of my original sets, instead of adding them?",
    "We are once again combining\noutcomes: The resulting set of outcomes that contains 28 elements that are all\noutcomes consisting of a bow tie and a pair of socks.",
    "Now read the previous\nparagraph!",
    "They sound very close to each other!\n",
    "The difference between the two scenarios is subtle.",
    "There are two ways we can\nthink of combining outcomes:\n",
    "1.",
    "We can combine the sets of outcomes.\n",
    "2.",
    "We can combine the outcomes in the sets.\n",
    "Being able to distinguish between these operations is a key skill in combinatorics.\n",
    "Example 3.2.1\nSuppose your refrigerator door has some magnetic letters and numerals on\nit: There are five letters (A, B, C, D, and E) and three numerals (1, 2, and 3).\n",
    "Your brother says that if you combine these sets of magnets, you will get a\ncollection of 8 magnets.",
    "Your sister says that you can combine these magnets\nin 15 ways.\n",
    "What sets of outcomes are your siblings thinking of?\nSolution.\n",
    "Your brother is thinking of combining the sets of outcomes.",
    "The\nset of outcomes for the letters is {𝐴, 𝐵, 𝐶, 𝐷, 𝐸} and the set of outcomes for\nthe numerals is {1, 2, 3}.",
    "The set of outcomes for the combined set of magnets\nis {𝐴, 𝐵, 𝐶, 𝐷, 𝐸, 1, 2, 3}, which contains 8 elements.\n",
    "Your sister is thinking of combining the outcomes themselves.",
    "The set\nof outcomes is {𝐴1, 𝐴2, 𝐴3, 𝐵1, 𝐵2, 𝐵3, 𝐶1, 𝐶2, 𝐶3, 𝐷1, 𝐷2, 𝐷3, 𝐸1, 𝐸2, 𝐸3},\nwhich contains 15 elements.\n",
    "3.2.3\nThe Sum and Product Principles\nLet’s carefully write down the rules we can use to combine sets of outcomes and\noutcomes in sets.\n",
    "Principle 3.2.2 Sum Principle.\n",
    "If an event 𝐴results in 𝑚outcomes, and event 𝐵results in 𝑛disjoint outcomes,\nthen the event “𝐴or 𝐵” results in 𝑚+ 𝑛outcomes.\n\n",
    "208\n3.",
    "Counting\nIt is important that the events be disjoint: i.e., that there is no way for 𝐴and 𝐵to\nboth happen at the same time.",
    "For example, a standard deck of 52 cards contains 26\nred cards and 12 face cards.",
    "However, the number of ways to select a card which is\neither red or a face card is not 26 + 12 = 38.",
    "This is because there are 6 cards which\nare both red and face cards.\n",
    "Example 3.2.3\nHow many two-letter “words” start with either A or B?",
    "(A word is just a\nsequence of letters; it doesn’t have to be English, or even pronounceable.)\n",
    "Solution.\n",
    "First, how many two-letter words start with A?",
    "We just need to\nselect the second letter, which can be accomplished in 26 ways.",
    "So there are\n26 words starting with A. There are also 26 words that start with B. To select a\nword that starts with either A or B, we can pick the word from the first 26 or\nthe second 26, for a total of 52 words.\n",
    "We have two sets of outcomes: the words starting with A and the words\nstarting with B.",
    "We create a new set of outcomes by combining the sets to get\nthe set of words that start with either A or B, and by the sum principle, this\nnew set contains 52 outcomes.\n",
    "We often use the principle when the sets of outcomes need to be counted using\nother counting techniques.\n",
    "Example 3.2.4\nHow many 10-bit strings of weight 6 start with either 11 or 00?\nSolution.\n",
    "We learned how to count bit strings with a fixed length and weight\nin Section 3.1.",
    "The total number of 10-bit strings of weight 6 is \u000010\n6\n\u0001\n= 210\n(where that value was found using Pascal’s triangle).",
    "However, we want to\ncount just those that start with 11 or 00 (and not those that start with 10 or 01).\n",
    "Since there are no bit strings that start with both 11 and 00, we can apply\nthe sum principle.",
    "We will compute the size of each set of outcomes and then\nadd the results.\n",
    "How many 10-bit strings of weight 6 start with 11?",
    "If the string starts with\n11, then of the remaining eight bits, there must be four 1’s, so that the total\nweight is 6.",
    "This is just like asking for the number of 8-bit strings with weight\n4, so there are \u00008\n4\n\u0001\n= 70 such strings.",
    "Similarly, there are \u00008\n6\n\u0001\n= 28 strings that\nstart with 00 (all six 1’s must be in the remaining 8 bits).",
    "By the sum principle,\nthe total number of strings we want to count is 70 + 28 = 98.\n",
    "We can also use the sum principle indirectly in a way that might be called the\nsubtraction principle (but isn’t).\n\n3.2.",
    "Combining Outcomes\n209\nExample 3.2.5\nHow many 10-bit strings of weight 6 have at least one 1 in their first three bits?\nSolution.\n",
    "There are lots of different ways a string can have at least one 1 in\nits first three bits: It could start with 100, 010, 001, 101, 110, 011, or 111.",
    "We\ncould count the number of strings that start with each of them and then apply\nthe sum principle a bunch of times.",
    "But let’s not.\n",
    "Suppose the number of strings we want to count is 𝑥. Let 𝑦be the number\nof 10-bit strings of weight 6 that do not have a 1 in any of their first three bits.\n",
    "What is 𝑥+ 𝑦?",
    "This is the number of 10-bit strings of weight 6 in total, which\nis \u000010\n6\n\u0001\n= 210.",
    "It is also easy to find 𝑦: Bit strings with length 10 and weight 6\nthat start with 000 must end in a bit string with length 7 and weight 6.",
    "There\nare \u00007\n6\n\u0001\n= 7 of these.\n",
    "Thus, we have\n𝑥+ 7 = 210,\nso 𝑥= 210 −7 = 203.\n",
    "While we didn’t want to use the sum principle multiple times in the previous\nexample, we could have.",
    "The sum principle works with more than two events.",
    "Say,\nin addition to your four bow ties and seven pairs of socks, you could also pick\none of five belt buckles.",
    "How many choices do you have now?",
    "You would have\n4 + 7 + 5 = 16 options.\n",
    "Example 3.2.6\nHow many two-letter words start with one of the 5 vowels?\nSolution.\n",
    "There are 26 two-letter words starting with A, another 26 starting\nwith E, and so on.",
    "By the sum principle, the total number of words will then\nbe 26 + 26 + 26 + 26 + 26 = 130 Of course it would be easier to just multiply\n5 · 26.\n",
    "Note that in the previous example, when using the sum principle on a bunch of\noutcome sets of the same size, it is quicker to multiply.",
    "Let’s take advantage of this\nobservation and state it as a new principle.\n",
    "Principle 3.2.7 Product Principle.\n",
    "If event 𝐴can occur in 𝑚ways, and each possibility for 𝐴allows for exactly 𝑛ways\nfor event 𝐵, then the event “𝐴and 𝐵” can occur in 𝑚· 𝑛ways.\n",
    "A nice way to picture the product principle is to think of the outcomes as “levels”\nin a tree.",
    "To illustrate this, consider the counting question of Example 3.2.1: How\nmany ways can you select a letter from {𝐴, 𝐵, 𝐶, 𝐷, 𝐸} followed by a numeral from\n{1, 2, 3}?",
    "Here is a tree picture that shows what is going on.\n\n210\n3.",
    "Counting\n𝐴\n𝐵\n𝐶\n𝐷\n𝐸\n1\n2\n3\n1\n2\n3\n1\n2\n3\n1\n2\n3\n1\n2\n3\n𝐴1\n𝐴2\n𝐴3\n𝐵1\n𝐵2\n𝐵3\n𝐶1\n𝐶2\n𝐶3\n𝐷1\n𝐷2\n𝐷3\n𝐸1\n𝐸2\n𝐸3\nEach leaf of the tree corresponds to an outcome.",
    "The tree shows that the three\noutcomes of the second level are repeated five times, once for each outcome of the\nfirst level.\n",
    "Example 3.2.8\nHow many two-letter words start with one of the 5 vowels?",
    "This time use the\nproduct principle to answer the question.\nSolution.\n",
    "How can we think of selecting a two-letter word as a sequence of\ntwo events that both happen?",
    "Event 𝐴is “selecting the vowel that starts the\nword.”",
    "Event 𝐵is “selecting the second letter for the word.”",
    "By the product\nprinciple, there are 5 · 26 = 130 ways for the event “𝐴and 𝐵” to occur.\n",
    "Of course the solutions to Example 3.2.6 and Example 3.2.8 are the same, but the\noutcomes we are combining and the ways we are combining them are different.\n",
    "When applying the sum principle, we combined five disjoint sets of outcomes.\n",
    "One such set of outcomes was,\n{𝐴𝐴, 𝐴𝐵, 𝐴𝐶, 𝐴𝐷, . .",
    ".",
    ", 𝐴𝑍}\nand another was,\n{𝐸𝐴, 𝐸𝐵, 𝐸𝐶, 𝐸𝐷, . . .",
    ", 𝐸𝑍}.\n",
    "That is, each set of outcomes was a set of 2-letter words, starting with a different\nvowel.",
    "The sum principle combined these five sets to create a new set that contained\nexactly the same elements in the original sets, just all together in one set.\n",
    "On the other hand, when we applied the product principle, we combined the\noutcomes in two sets.",
    "The first set was,\n{𝐴, 𝐸, 𝐼, 𝑂, 𝑈}\n\n3.2.",
    "Combining Outcomes\n211\nand the second set was,\n{𝐴, 𝐵, 𝐶, 𝐷, . .",
    ".",
    ", 𝑍}.\n",
    "The product principle combines the elements in those sets to make a set of new\noutcomes (outcomes not present in any of the sets being combined).\n",
    "As with the sum principle, we often use the product principle to define sets of\noutcomes that first need to be counted carefully.\n",
    "Example 3.2.9\nHow many lattice paths from (0, 0) to (10, 10) pass through the point (4, 7)?\nSolution.\n",
    "We can count lattice paths with Pascal’s triangle, but how do we\nensure that the path passes through a particular point?",
    "Well, any path that\npasses through (4, 7) must first go from (0, 0) to (4, 7), and then complete its\njourney with a path from (4, 7) to (10, 10).\n",
    "The number of paths from (0, 0) to (4, 7) is \u000011\n4\n\u0001\n= 330.\n",
    "The number of paths from (4, 7) to (10, 10) is \u00009\n3\n\u0001\n= 84.",
    "(The paths have\nlength 9 and with 6 steps in the 𝑥direction.)\n",
    "Now combine these with the... wait, what principle?",
    "To get a path from\n(0, 0) to (10, 10) that passes through (4, 7), we need to first select a path from\n(0, 0) to (4, 7) and then add on a path from (4, 7) to (10, 10).",
    "So is this the sum\nprinciple???\n",
    "No! Remember that the sum principle combines the two sets of outcomes.\n",
    "If we applied the sum principle, we would get a larger set containing the\n330 + 84 paths that are contained in each individual set.",
    "None of these are\npaths we want to count.",
    "We want to combine the different elements in our\nsets of outcomes in every possible combination.",
    "That is why the product\nprinciple is correct here.\n",
    "Thus, the total number of paths we want to count is 330 · 84 = 27720.\n",
    "The product principle generalizes to more than two events as well.\n",
    "Example 3.2.10\nHow many license plates can you make out of three letters followed by three\nnumerical digits?\nSolution.\n",
    "Here we have six events: the first letter, the second letter, the third\nletter, the first digit, the second digit, and the third digit.",
    "The first three events\ncan each happen in 26 ways; the last three can each happen in 10 ways.",
    "So the\ntotal number of license plates will be 26 · 26 · 26 · 10 · 10 · 10, using the product\nprinciple.\n",
    "Does this make sense?",
    "Think about how we would pick a license plate.\n",
    "How many choices would we have?",
    "First, we need to pick the first letter.\n",
    "There are 26 choices.",
    "Now for each of those, there are 26 choices for the\n\n212\n3.",
    "Counting\nsecond letter: 26 second letters with first letter A, 26 second letters with first\nletter B, and so on.",
    "We add 26 to itself 26 times.",
    "Or quicker: there are 26 · 26\nchoices for the first two letters.\n",
    "Now for each choice of the first two letters, we have 26 choices for the\nthird letter.",
    "That is, 26 third letters for the first two letters AA, 26 choices for\nthe third letter after starting AB, and so on.",
    "There are 26 · 26 of these 26 third\nletter choices, for a total of (26 · 26) · 26 choices for the first three letters.",
    "And\nfor each of these 26 · 26 · 26 choices of letters, we have a bunch of choices for\nthe remaining digits.\n",
    "In fact, there are going to be exactly 1000 choices for the numbers.",
    "We can\nsee this because there are 1000 three-digit numbers (000 through 999).",
    "This\nis 10 choices for the first digit, 10 for the second, and 10 for the third.",
    "The\nproduct principle says we multiply: 10 · 10 · 10 = 1000.\n",
    "All together, there were 263 choices for the three letters and 103 choices\nfor the numbers, so we have a total of 263 · 103 choices of license plates.\n",
    "The previous example had an answer that used exponents.",
    "So is there an\nexponential principle we should learn?",
    "We don’t separate one out as there really\nisn’t anything different in the way we think of constructing our outcome sets.",
    "But\nwe will often see the product principle applied to the same event repeated multiple\ntimes.",
    "Here are two examples.\n",
    "Example 3.2.11\nSuppose you roll a 12-sided die seven times, recording the number that\nappears after each roll.",
    "How many sequences of seven rolls are possible?\n",
    "Solution.\n",
    "Each roll can result in 12 different outcomes, so by the product\nprinciple, the total number of sequences is 127.\nExample 3.2.12\nHow many different pizzas can you make if you can choose from 10 toppings\nand you can have any number of toppings on your pizza?\nSolution.\n",
    "If we want to apply the product principle, we must think of the\ncompound event of picking a pizza as the result of combining some number\nof individual events in every possible combination.",
    "What are those events?\n",
    "There are multiple answers to this question, but the following is the most\nuseful.\n",
    "First, decide whether you want to include anchovies on your pizza or not.\n",
    "This event could result in two outcomes (yes or no to the anchovies).",
    "Second,\ndecide whether you want black olives.",
    "Then Canadian bacon, then diced\ntomatoes, etc.",
    "Each event has two outcomes, and we must combine all ten of\n\n3.2.",
    "Combining Outcomes\n213\nthese outcomes to create a single outcome corresponding to a single pizza.\n",
    "Thus, by the product principle, there are 210 possible pizzas.\n",
    "By the way, another approach to this problem is to “code” each pizza as a\nbit-string, where a 1 means the topping is included and a 0 means it is not.\n",
    "Then the number of pizzas is the number of bit-strings of length 10.",
    "Each bit\nin the string has two possible values, so there are 210 10-bit strings.\n",
    "Careful: “and” doesn’t mean “times.”",
    "For example, how many playing cards\nare both red and a face card?",
    "Not 26 · 12.",
    "The answer is 6, and we needed to know\nsomething about cards to answer that question.\n",
    "Example 3.2.13 Counting functions.\n",
    "How many functions 𝑓: {1, 2, 3, 4, 5} →{𝑎, 𝑏, 𝑐, 𝑑} are there?\nSolution.\n",
    "Remember that a function sends each element of the domain to\nexactly one element of the codomain.",
    "To determine a function, we just need\nto specify the image of each element in the domain.",
    "Where can we send 1?\nThere are 4 choices.",
    "Where can we send 2?",
    "Again, 4 choices.",
    "What we have\nhere is 5 “events” (picking the image of an element in the domain) each of\nwhich can happen in 4 ways (the choices for that image).",
    "Thus there are\n4 · 4 · 4 · 4 · 4 = 45 functions.\n",
    "This is more than just an example of how we can use the product principle in\na particular counting question.",
    "What we have here is a general interpretation\nof certain applications of the product principle using rigorously defined\nmathematical objects: functions.",
    "Whenever we have a counting question that\nasks for the number of outcomes of a repeated event, we can interpret that as\nasking for the number of functions from {1, 2, . .",
    ". , 𝑛} (where 𝑛is the number\nof times the event is repeated) to {1, 2, . .",
    ".",
    ", 𝑘} (where 𝑘is the number of ways\nthat event can occur).\n",
    "3.2.4\nCombining Principles\nLet’s return to this section’s Investigate!",
    "question: How many ways can you select\ntwo cards from a standard deck of 52, so that the first one is a red card and the\nsecond one is a face card?\n",
    "This looks a little like the product principle since the outcomes consist of pairs of\ncards.",
    "There are 26 red cards that are outcomes for the first event, and 12 face cards\nthat are outcomes for the second event.",
    "However, the answer is not 26 · 12.",
    "The\nproblem is that while there are 26 ways for the first card to be selected, it is not the\ncase that for each of those, there are 12 ways to select the second card.",
    "If the first card\nwas both red and a face card, then there would be only 11 choices for the second\ncard.\n",
    "In Section 3.3 we will explore some ways to adjust for counting problems when\nevents are not disjoint, but we can solve our card problem now if we are careful.\n\n",
    "214\n3.",
    "Counting\nThink about the entire set of two-card outcomes.",
    "Can we split these outcomes into\ntwo disjoint sets (as to apply the sum principle) such that each set can be formed\nusing the product principle?\n",
    "Of all the outcomes, we first count those that start with a red, non-face card.",
    "Of\nthe 26 red cards, there are 6 that are face cards, so there are 20 red, non-face cards.\n",
    "For each of these, there are 12 face cards that can be selected as the second card.\n",
    "By the product principle, the number of two-card outcomes starting with a red,\nnon-face card is 20 · 12 = 240.\n",
    "Now, what outcomes have we not yet counted?",
    "It is exactly the two-card outcomes\nthat start with a red face card.",
    "There are 6 cards we could start with, and for each\nthere are 11 choices for the second card.",
    "So the number of two-card outcomes\nstarting with a red face card is 6 · 11 = 66.\n",
    "Finally, apply the sum principle to these two disjoint sets of outcomes to see that\nthe total number of two-card outcomes is 240 + 66 = 306.\n",
    "We conclude this section with two more examples of how you can use both the\nsum and product principles in a single counting problem.\n",
    "Example 3.2.14\nHow many lattice paths from (0, 0) to (9, 9) pass through either (2, 6) or (6, 2)?\nSolution.\n",
    "We are quite fortunate that no paths from (0, 0) to (9, 9) pass\nthrough both (2, 6) and (6, 2).",
    "This means we can apply the sum principle to\nthe two sets of outcomes: the paths that pass through (2, 6) and the paths\nthat pass through (6, 2).",
    "We will apply the product principle to determine the\nnumber of paths in each of these disjoint sets of outcomes.\n",
    "The paths from (0, 0) to (9, 9) that pass through (2, 6) are each the con-\ncatenation of paths from (0, 0) to (2, 6) and paths from (2, 6) to (9, 9).",
    "There\nare \u00008\n2\n\u0001\n= 28 paths for the first part and \u000010\n7\n\u0001\n= 120 paths for the second part,\nso applying the product principle gives us 28 · 120 = 3360 paths that pass\nthrough (2, 6).\n",
    "The paths from (0, 0) to (9, 9) that pass through (6, 2) can similarly be\ncalculated as\n\u0012\n8\n6\n\u0013\n·\n\u0012\n10\n3\n\u0013\n= 28 · 120 = 3360\n(and upon reflection, it is not surprising that the two numbers are the same,\nsince each path that passes through (2, 6) can be reflected to create a path that\npasses through (6, 2)).\n",
    "Thus, the total number of paths that pass through either (2, 6) or (6, 2) is\n3360 + 3360 = 6720.\n\n3.2.",
    "Combining Outcomes\n215\nExample 3.2.15\nHow many two-digit numbers, using only the digits {1, 2, 3, 4, 5} have the\nsum of their digits even?\nSolution.\n",
    "First think about the set of outcomes.",
    "Some two-digit numbers\nthat have the sum of their digits even are 11, 13, 15, 22, 24, 31, . .",
    "..",
    "Okay, maybe\nit isn’t all that difficult to just list them all (and this would be a nice way to\ncheck our work).",
    "Let’s try to use the sum and product principles anyway.\n",
    "What do we notice about all these numbers?",
    "It looks like both digits must\nbe even or both digits must be odd, to make the sum even.",
    "We can consider\nthese two cases, counting each case with the product principle.\n",
    "Counting “odd-odd” numbers: three choices for the first digit and three\nchoices for the second digit.",
    "So there are 3 · 3 = 9 odd-odd numbers.\n",
    "Counting “even-even” numbers: two choices for the first digit and two\nchoices for the second digit.",
    "So there are 2 · 2 = 4 even-even numbers.\n",
    "Combined, there are 9 + 4 = 13 two-digit numbers with an even sum of\ndigits.\n",
    "3.2.5\nReading Questions\n1.\n",
    "How will you decide if you should add or multiply when combining numbers\nin a counting problem?",
    "Explain how you are currently thinking about this.\n",
    "2.\n",
    "Your cousin is trying to solve a counting problem about how many different\nroutes he can take between his dorm and his classroom.",
    "He has 9 routes that\nmake sense, and similarly, there are 9 routes to go back from his classroom to\nhis dorm.\n",
    "How many round trips are possible?",
    "Your cousin says 18, because after\ngoing from his dorm to the classroom, he has to add on a route back to the\ndorm.",
    "Is he right?",
    "Why or why not?\n3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "3.2.6\nPractice Problems\n1.\n",
    "Your wardrobe consists of 6 shirts, 3 pairs of pants, and 15 bow ties.",
    "How\nmany different outfits can you make?\n2.\n",
    "For your college interview, you must wear a tie.",
    "You own 8 regular (boring)\nties and 3 (cool) bow ties.\n",
    "a. How many choices do you have for your neck-wear?\nb.",
    "You realize that the interview is for clown college, so you should probably\nwear both a regular tie and a bow tie.",
    "How many choices do you have\nnow?\n\n216\n3.",
    "Counting\nc.",
    "For the rest of your outfit, you have 2 shirts, 7 skirts, 3 pants, and 8 dresses.\n",
    "You want to select either a shirt to wear with a skirt or pants, or just a\ndress.",
    "How many outfits do you have to choose from?\n3.\n",
    "We usually write numbers in decimal form (or base 10), meaning numbers\nare composed using 10 different “digits” {0, 1, . . .",
    ", 9}.",
    "Sometimes though it is\nuseful to write numbers hexadecimal or base 16.",
    "Now there are 16 distinct\ndigits that can be used to form numbers: {0, 1, . .",
    ".",
    ", 9, A, B, C, D, E, F}.",
    "So for\nexample, a 3 digit hexadecimal number might be 2B8.\n",
    "a. How many 3-digit hexadecimals are there in which the first digit is E or\nF?\nb.",
    "How many 6-digit hexadecimals start with a letter (A-F) and end with a\nnumeral (0-9)?\n",
    "c. How many 4-digit hexadecimals start with a letter (A-F) or end with a\nnumeral (0-9) (or both)?\n",
    "4.\nLet 𝑆= {1, 2, 3, 4, 5, 6, 7, 8}\na. How many subsets are there total?\nb.",
    "How many subsets have {2, 3, 5} as a subset?\n",
    "c. How many subsets contain at least one odd number?\n",
    "d. How many subsets contain exactly one even number?\n5.\n",
    "Let 𝑆= {1, 2, 3, 4, 5, 6}.\n",
    "a. How many subsets are there of cardinality 4?\nb.",
    "How many subsets of cardinality 4 have > {2, 3, 5} as a subset?\n",
    "c. How many subsets of cardinality 4 contain at least one odd number?\n",
    "d. How many subsets of cardinality 4 contain exactly one even number?\n6.\n",
    "Let 𝐴= {1, 2, 3, 4, 5, 6}.\n",
    "(a) How many subsets of 𝐴are there?\n(b) How many subsets of 𝐴contain exactly 5 elements?\n(c) How many subsets of 𝐴contain only even numbers?\n(d) How many subsets of 𝐴contain an even number of elements?\n7.\n",
    "You break your piggy-bank to discover lots of pennies and nickels.",
    "You start\narranging these in rows of 4 coins.\n",
    "a. You find yourself making rows containing an equal number of pennies\nand nickels.",
    "For fun, you decide to lay out every possible such row.",
    "How\n\n3.2.",
    "Combining Outcomes\n217\nmany coins will you need?\nb.",
    "How many coins would you need to make all possible rows of 4 coins\n(not necessarily with equal number of pennies and nickels)?",
    "\n8.\nHow many 11-bit strings contain 4 or more 1’s?\n9.\nHow many subsets of {0, 1, . . .",
    ", 9} have cardinality 7 or more?\n10.\n",
    "How many shortest lattice paths start at (5, 5) and\na. end at (12, 12)?\n",
    "b. end at (12, 12) and pass through (8, 9)?\n",
    "c. end at (12, 12) and avoid (8, 9)?\n",
    "3.2.7\nAdditional Exercises\n1.\nYour Blu-ray collection consists of 9 comedies and 7 horror movies.",
    "Give an\nexample of a question for which the answer is:\n(a) 16.\n(b) 63.\n2.\n",
    "The number 735000 factors as 23 · 3 · 54 · 72.",
    "How many divisors does it have?\nExplain your answer using the multiplicative principle.\n\n",
    "3.3\nNon-Disjoint Outcomes\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Use Venn diagrams to count the number of outcomes in the union of\nnon-disjoint sets.\n",
    "2. Apply the principle of inclusion/exclusion for two and three sets.\n",
    "3. Explain why the principle of inclusion/exclusion works.\n",
    "3.3.1\nSection Preview\nInvestigate!\n",
    "A recent buzz marketing campaign for The Pie Hole surveyed patrons on\ntheir pie preferences.",
    "People were asked whether they enjoyed (A) Apple,\n(B) Blueberry, or (C) Cherry pie (respondents answered yes or no to each\ntype of pie, and could say yes to more than one type).",
    "The following table\nshows the results of the survey.\n",
    "Pies enjoyed:\nA\nB\nC\nAB\nAC\nBC\nABC\nNumber of people:\n20\n13\n26\n9\n15\n7\n5\nHow many of those surveyed enjoy at least one of the types of pie?",
    "Also,\nexplain why the answer is not 95.\n",
    "In Section 3.2 we explored the sum principle as a way of combining two (or more)\nsets of disjoint outcomes.",
    "What happens if the outcomes are not disjoint?\n",
    "Something different needs to be done.",
    "For example, when counting the number\nof playing cards that are either face cards or red cards, we cannot apply the sum\nprinciple to claim there are 12 + 26 = 38 cards.",
    "The problem is exactly that six cards\nare both face cards and red cards.",
    "There are a few different ways we can handle this\nthat we will explore in this section.\n",
    "Preview Activity\n1.\nConsider the eight bit strings of length 3.",
    "Let’s find the number of strings that\nstart with 1 or have weight 2 (i.e., contain exactly two 1s).\n",
    "(a) List all the 3-bit strings that start with 1.\n(b) List all the 3-bit strings that have weight 2.\n218\n\n3.3.",
    "Non-Disjoint Outcomes\n219\n(c) Now list all the 3-bit strings that start with 1 or have weight 2.",
    "But be lazy:\nDon’t list them from scratch.",
    "Use your lists from the two tasks above.\n",
    "(d) How many strings are there in the lists?\n• Strings that start with 1:\n• Strings of weight 2:\n• Strings that start with 1 or have weight 2:\n• Strings that both start with a 1 and have weight 2:\n2.\n",
    "How did you combine your two lists above?",
    "Explain how you did it.",
    "Then\nthink of another method you could have used, and explain how that would be\ndifferent.\n",
    "3.\nXiang and Omari are discussing their favorite mathematicians throughout\nhistory.",
    "Xiang has a list of 7 favorites, while Omari has a list of 5.",
    "They discover\nthat they have 3 mathematicians in common.",
    "How many mathematicians are\non their combined list?\n3.3.2\nCounting with Venn Diagrams\nTo understand how to deal with combining sets of outcomes that are not disjoint, it\nwill be helpful to use some notation from set theory, which we will briefly review\nhere.\n",
    "Let 𝐴be the set of outcomes for the first event and 𝐵be the set of outcomes for\nthe second event.",
    "When we ask for the number of ways either event can happen,\nthe new set of outcomes consists of all outcomes that are in 𝐴, or 𝐵, or both.",
    "This is\nnothing more than the union of the set 𝐴and 𝐵, written 𝐴∪𝐵.\nThe sum principle only applies when no outcome belongs to both events.",
    "The\nelements that are common to sets 𝐴and 𝐵are the sets in their intersection, written\n𝐴∩𝐵. The intersection of two sets is itself a set.",
    "If sets 𝐴and 𝐵are disjoint, then\nthere are no elements in the intersection, so the intersection is the empty set, written\n∅.\nWe are counting the number of outcomes, so what we are really interested in is\nthe size (or cardinality) of the sets.",
    "We write the size of a set 𝑋as |𝑋|.\n",
    "With this notation in hand, we can restate the sum principle as follows.\n",
    "Principle 3.3.1 Sum Principle (with sets).\n",
    "Given two sets 𝐴and 𝐵, if 𝐴∩𝐵= ∅, then\n|𝐴∪𝐵| = |𝐴| + |𝐵| .\n",
    "Now consider what happens to the sum principle when the sets are NOT disjoint.\n",
    "Suppose we want to find |𝐴∪𝐵| and know that |𝐴| = 10 and |𝐵| = 8.",
    "If we knew that\nthe sets were disjoint, then |𝐴∪𝐵| would be 18.",
    "But if we don’t have that the sets\nare disjoint, we need more information We must know how many of the 8 elements\n\n220\n3.",
    "Counting\nin 𝐵are also elements of 𝐴. Suppose we also know that |𝐴∩𝐵|",
    "= 6.",
    "Now we can\nsay exactly how many elements are in 𝐴, and, of those, how many are in 𝐵and how\nmany are not (6 of the 10 elements are in 𝐵, so 4 are in 𝐴but not in 𝐵).",
    "We could fill\nin a Venn diagram as follows:\n𝐴\n𝐵\n6\n4\n2\nThis says there are 6 elements in 𝐴∩𝐵, 4 elements in 𝐴but not 𝐵(which",
    "we\ncan write as |𝐴\\ 𝐵| = 4), and 2 elements in 𝐵but not 𝐴(written |𝐵\\ 𝐴| = 2).",
    "Now\nthese three sets are disjoint, so we can use the sum principle to find the number of\nelements in 𝐴∪𝐵.",
    "It is 6 + 4 + 2 = 12.\n",
    "Example 3.3.2\nHow many 7-bit strings of weight 4 start with 11 or end with 00, or both?\nSolution.\n",
    "Let 𝐴be the set of 7-bit strings of weight 4 that start with 11.",
    "We\nhave |𝐴| = \u00005\n2\n\u0001\n= 10.",
    "Let 𝐵be the set of 7-bit strings of weight 4 that end with\n00.",
    "We have |𝐵| = \u00005\n4\n\u0001\n= 5.\n",
    "But it is not true that |𝐴∪𝐵|",
    "= 10 + 5 = 15, since strings like 1101100 both\nstart with 11 and end with 00.",
    "That is included in the 10 strings starting with\n11 and the five strings ending with 00.",
    "We must find the number of strings\nthat belong to both 𝐴and 𝐵. We have\n",
    "|𝐴∩𝐵| =\n\u0012\n3\n2\n\u0013\n= 3\n(and indeed, there are three strings in the intersection: 1111000, 1110100, and\n1101100).\n",
    "We can now fill in a Venn diagram:\n𝐴\n𝐵\n3\n7\n2\nThe circle for 𝐴contains a total of 10 elements, the 3 that also belong to 𝐵\nand 7 more that belong to just 𝐴.",
    "The circle for 𝐵contains a total of 5 elements,\n\n3.3.",
    "Non-Disjoint Outcomes\n221\nthe 3 that also belong to 𝐴and 2 more that belong to just 𝐵.",
    "The number of\nelements in 𝐴∪𝐵is the sum of the elements in each region\n| |𝐴∪𝐵| = 7 + 3 + 2 = 12.\n",
    "We can do something similar with three sets.\n",
    "Example 3.3.3\nAn examination in three subjects, Algebra, Biology, and Chemistry, was taken\nby 41 students.",
    "The following table shows how many students failed in each\nsingle subject and in their various combinations:\n",
    "Subject:\nA\nB\nC\nAB\nAC\nBC\nABC\nFailed:\n12\n5\n8\n2\n6\n3\n1\nHow many students failed at least one subject?\nSolution.\n",
    "The answer is not 37, even though the sum of the numbers above\nis 37.",
    "For example, while 12 students failed Algebra, 2 of those students also\nfailed Biology, 6 also failed Chemistry, and 1 of those failed all three subjects.\n",
    "In fact, that 1 student who failed all three subjects is counted a total of 7\ntimes in the total 37.",
    "To clarify things, let us think of the students who failed\nAlgebra as the elements of the set 𝐴, and similarly for sets 𝐵and 𝐶. The one\nstudent who failed all three subjects is the lone element of the set 𝐴∩𝐵∩𝐶.\n",
    "Thus, in Venn diagrams:\n𝐴\n𝐵\n𝐶\n1\nNow let’s fill in the other intersections.",
    "We know 𝐴∩𝐵contains 2 elements,\nbut 1 element has already been counted.",
    "So we should put a 1 in the region\nwhere 𝐴and 𝐵intersect (but 𝐶does not).",
    "Similarly, we calculate the cardinality\nof (𝐴∩𝐶) \\ 𝐵, and (𝐵∩𝐶) \\ 𝐴:\n\n222\n3.",
    "Counting\n𝐴\n𝐵\n𝐶\n1\n1\n5\n2\nNext, we determine the numbers that should go in the remaining regions,\nincluding outside of all three circles.",
    "This last number is the number of\nstudents who did not fail any subject:\n𝐴\n𝐵\n𝐶\n1\n1\n5\n2\n5\n1\n0\n26\nWe found 5 goes in the “𝐴only” region because the entire circle for 𝐴\nneeded to have a total of 12, and 7 were already accounted for.",
    "Similarly,\nwe calculate the “𝐵only” region to contain only 1 student and the “𝐶only”\nregion to contain no students.\n",
    "Thus the number of students who failed at least one class is 15 (the sum of\nthe numbers in each of the eight disjoint regions).",
    "The number of students\nwho passed all three classes is 26: the total number of students, 41, less the 15\nwho failed at least one class.\n",
    "Note that we can also answer other questions.",
    "For example, how many\nstudents failed just Chemistry?",
    "None.",
    "How many passed Algebra but failed\nboth Biology and Chemistry?",
    "This corresponds to the region inside both 𝐵\nand 𝐶but outside of 𝐴, containing 2 students.\n",
    "Here is an interesting math fact.\n",
    "12 + 5 + 8 −2 −6 −3",
    "+ 1 = 15.\nIs it a coincidence that this way of combining the numbers of students who failed\neach subject in the example above gives the same number of students who failed at\nleast one subject?",
    "This suggests that there might be a simpler way to find the size of\na union of non-disjoint sets.\n",
    "3.3.3\nThe Principle of Inclusion/Exclusion\n",
    "It would be nice to write an algebraic formula that captures what we have done\nin the previous examples.",
    "Even better would be for this algebraic formula to be a\n\n3.3.",
    "Non-Disjoint Outcomes\n223\ngeneralization of the case where the sets are disjoint.\nConsider again the example where |𝐴| = 10, |𝐵| = 8 and |𝐴∩𝐵|",
    "= 6.",
    "We said\nthat |𝐴∪𝐵|",
    "= 12, found by adding 4 + 6 + 2.\n",
    "If 𝐴and 𝐵had been disjoint, then |𝐴∪𝐵| would have been |𝐴|+|𝐵| = 10+8 = 18.\n",
    "We see that is off by exactly 6, which just so happens to be |𝐴∩𝐵|.",
    "So perhaps we\nguess,\n",
    "|𝐴∪𝐵| = |𝐴| + |𝐵| −|𝐴∩𝐵| .\n",
    "This makes sense!",
    "When we add the number of elements in 𝐴to the number of\nelements in 𝐵, we have counted the six elements that belong to both sets exactly\ntwice.",
    "So if we subtract them out, we have counted them exactly once.\n",
    "In other words, we have:\nTheorem 3.3.4 Cardinality of a Union (2 Sets).\n",
    "For any finite sets 𝐴and 𝐵,\n|𝐴∪𝐵| = |𝐴| + |𝐵| −|𝐴∩𝐵| .\n",
    "Example 3.3.5\nHow many 7-bit strings of weight 4 start with 11 or end with 00, or both?",
    "Use\nTheorem 3.3.4 and compare to Example 3.3.2.\nSolution.\n",
    "We have |𝐴| = \u00005\n2\n\u0001\n= 10, |𝐵| = \u00005\n4\n\u0001\n= 5, and |𝐴∩𝐵| = \u00003\n2\n\u0001\n= 3.\n",
    "Therefore:\n|𝐴∪𝐵|",
    "= 10 + 5 −3 = 12.\n",
    "This makes sense since the three bit strings that start with 11 and end with 00\nare counted in the 10 strings starting with 11 and again among the 5 strings\nending with 00, so we have over-counted these exactly one time before we\nsubtract them out.\n",
    "For three sets, we can also count the elements in the union by carefully removing\nelements we have counted multiple times.",
    "Since there are more ways for the sets to\noverlap, the formula is more complicated.\n",
    "Theorem 3.3.6 Cardinality of a Union (3 Sets).\n",
    "For any finite sets 𝐴, 𝐵, and 𝐶,\n|𝐴∪𝐵∪𝐶| = |𝐴| + |𝐵| + |𝐶|\n−|𝐴∩𝐵| −|𝐴∩𝐶| −|𝐵∩𝐶|\n+ |𝐴∩𝐵∩𝐶| .\n",
    "To determine how many elements are in at least one of 𝐴, 𝐵, or 𝐶we add up all\nthe elements in each of those sets.",
    "However, when we do that, any element in both\n\n224\n3.",
    "Counting\n𝐴and 𝐵is counted twice.",
    "Also, each element in both 𝐴and 𝐶is counted twice, as\nare elements in 𝐵and 𝐶, so we take each of those out of our sum once.",
    "But now\nwhat about the elements which are in 𝐴∩𝐵∩𝐶(in all three sets)?",
    "We added them\nin three times, but also removed them three times.",
    "They have not yet been counted.\n",
    "Thus we add those elements back in at the end.\n",
    "Example 3.3.7\nHow many of the numbers in {1, 2, . . .",
    ", 50} are multiples of 2, 3, or 5?\nSolution.\n",
    "Of the numbers in {1, 2, . . .",
    ", 50}, let 𝐴be the set of multiples of\n2, 𝐵be the set of multiples of 3, and 𝐶be the set of multiples of 5.",
    "We have\n|𝐴| = 25, |𝐵| = 16, and |𝐶| = 10.",
    "(These numbers can be found by division; for\nexample, since a third of the numbers are multiples of three, we can compute\n50/3",
    "= 16.66, so there are 16 multiples of 3 in the set.)",
    "Some of the numbers\nin the set are multiples of both 2 and 3, such as 6, 12, 18, . . .",
    "all the multiples\nof 6.",
    "There are |𝐴∩𝐵| = 8 such numbers.",
    "Similarly, there are |𝐴∩𝐶| = 5\nmultiples of both 2 and 5 (multiples of 10), and |𝐵∩𝐶| = 3 multiples of both\n3 and 5 (multiples of 15).",
    "There is |𝐴∩𝐵∩𝐶| = 1 multiples of all three (just\nthe number 30).\n",
    "Using Theorem 3.3.6, we have:\n",
    "|𝐴∪𝐵∪𝐶| = 25 + 16 + 10 −8 −5 −3",
    "+ 1 = 36.\n",
    "Let’s use this example to understand the theorem better.",
    "Consider the\nnumber 21.",
    "In which sets is it counted?",
    "It is in 𝐵, but not 𝐴or 𝐶, so it is\ncounting among the 16 multiples of 3 and not counted in any of the other sets,\nso it is included exactly once in our complete count.",
    "Similarly for all other\nnumbers that are multiples of just one of 2, 3, or 5.\n",
    "The number 18 is in sets 𝐴and 𝐵, and so also in 𝐴∩𝐵. It is counted in\nthe 25 multiples of 2, the 16 multiples of 3, and the 8 multiples of 6.",
    "So it is\nadded twice in our total and subtracted once, meaning it is counted exactly\none time.",
    "The same will be true of all numbers that belong to exactly two of\nthe individual sets.\n",
    "What about 30?",
    "It belongs to all the sets.",
    "It is therefore added to our total\nthree times, when we add the multiples of 2, 3, and 5.",
    "But it is also subtracted\nthree times, once for each of the three pairs of sets.",
    "So it is not counted at all\nin our total... until we add it back in in the last step, after which it is counted\nexactly once.\n",
    "This process of adding in, then subtracting out, then adding back in, and so on\nis called the Principle of Inclusion/Exclusion, or simply PIE.",
    "This principle can be\napplied to any number of sets, but the formula becomes more and more complicated\nthe more sets you have.",
    "For example, this is what PIE looks like for four sets.\n",
    "|𝐴∪𝐵∪𝐶∪𝐷| = |𝐴| + |𝐵| + |𝐶| + |𝐷|\n\n3.3.",
    "Non-Disjoint Outcomes\n225\n−|𝐴∩𝐵| −|𝐴∩𝐶| −|𝐴∩𝐷| −|𝐵∩𝐶| −|𝐵∩𝐷| −|𝐶∩𝐷|\n+ |𝐴∩𝐵∩𝐶| + |𝐴∩𝐵∩𝐷| + |𝐴∩𝐶∩𝐷| + |𝐵∩𝐶∩𝐷|\n−|𝐴∩𝐵∩𝐶∩𝐷| .\n",
    "Phew!",
    "And for five sets it is... just kidding.",
    "But even if we don’t write it down,\nhopefully we all see what you would have to write down.",
    "In practice, PIE for more\nthan three sets is only used when we can simplify the computation by recognizing\nthat, for example, all the intersections of two sets will have the same size.",
    "Some\nexamples of this are explored in Section 3.8.\n",
    "3.3.4\nOverlaps and the Product Principle\nEverything we have considered so far in this section has been about how the sum\nprinciple applies when the sets of outcomes are not disjoint.",
    "Do we need to be\nsimilarly worried about overlaps when applying the product principle?\nNot really.\n",
    "One use of the product principle is to compute probabilities, and in that context,\nwe do make a distinction between events being independent or dependent.",
    "We will\nexplore this more in Section 3.7.",
    "Essentially, to find the probability of two events\noccuring, we can multiply their respective probabilities if and only if the two events\nare independent: if the outcome of one event does not affect the outcome of the other.\n",
    "While finding probability is closely related to counting outcomes, the product\nprinciple itself does not require that sets of outcomes be disjoint or make a distinction\nbetween dependent or independent events.",
    "What does matter is that the number of\noutcomes for the second event does not change based on which outcome was the\nresult of the first event.\n",
    "A distinction we do often make when applying the product principle is whether\nthe outcomes of events can be “repeated.”",
    "Consider the following example.\n",
    "Example 3.3.8\nHow many 3-letter words (sequences of three letters) are there when,\n1. repeats are allowed?\n2. repeats are not allowed?\n",
    "Solution.\n",
    "Being careful with the product principle, we are combining three\nevents:",
    "𝐴is the event of selecting the first letter, 𝐵is the event of selecting\nthe second letter, and 𝐶is the event of selecting the third letter.",
    "If we want\nto count the number of words when letters in the word can be repeated,\nthen each event contains 26 outcomes.",
    "So the number of 3-letter words is\n263 = 17, 576 when repeats are allowed.\n",
    "When repeats are not allowed, then the number of outcomes for event 𝐴is\nstill 26, but the number of outcomes for 𝐵is only 25, since no matter what the\noutcome of event 𝐴is, that letter cannot be selected for the second position in\n\n226\n3.",
    "Counting\nthe word.",
    "Similarly, no matter what the outcomes of event 𝐴and 𝐵are, the\nnumber of outcomes for event 𝐶is always 24: any letter not selected in the\nfirst two events.",
    "Thus the number of 3-letter words containing no repeated\nletters is 26 · 25 · 24 = 15, 600.\n",
    "It’s a little strange that the actual set of outcomes for event 𝐵is different\nfor each possible outcome of event 𝐴.",
    "This doesn’t matter though, as long as\nthe size of the outcome set doesn’t change.\n",
    "We will explore problems such as the previous example in much more depth\nnext in Section 3.4.",
    "Before that though, here is a final example of where the product\nprinciple does NOT easily work.\n",
    "Example 3.3.9\nExplain why the product principle does NOT apply to the following counting\nquestion: How many 3-letter words have their letters in alphabetical order?\n",
    "Solution.\n",
    "The first thing we might try is to make event 𝐴be selecting the\nfirst letter, 𝐵be selecting the second letter, and 𝐶be selecting the third letter.\n",
    "There are 26 outcomes to event 𝐴.",
    "How many outcomes are there for event\n𝐵?",
    "If we selected 𝑤as the first letter, then we can select a letter in the set\n{𝑤, 𝑥, 𝑦, 𝑧} as our second letter, so it appears there are 4 outcomes for event\n𝐵.",
    "However, if we selected 𝑎as our first letter, then any letter could be used\nfor the second letter, so event 𝐵has 26 outcomes.",
    "Oh no!\n",
    "The problem is that the number of outcomes for the second (and third) letter\nin the word changes depending on the outcome of the previous event.",
    "The\nevents are not independent, but more than that, their size is not independent,\nso the product principle does not apply.\n",
    "We will see how to answer the counting problem above in the case that letters\ncan be repeated in Section 3.5.",
    "If we restricted the question further and required that\nthe letters be distinct (and in alphabetical order), we already know how to answer\nthe question.",
    "Since for any set of three letters, there is exactly one 3-letter word that\nhas those letters in alphabetical order, we can simply count the number of sets of\nthree letters.",
    "This is \u000026\n3\n\u0001\n.",
    "Then we just look at Pascal’s triangle to find the value...",
    "oh\nshoot.",
    "Our triangle doesn’t go down that far.",
    "I guess we should think of a way to\ncompute the value without the triangle.",
    "Read on!\n3.3.5\nReading Questions\n1.\n",
    "Which of the following best describes what the Principle of Inclusion/Exclusion\nis used for?\nA. To count the size of a union of two or more not-necessarily disjoint sets.\n",
    "B.",
    "To count the size of the union of two or more sets, as long as they are\n\n3.3.",
    "Non-Disjoint Outcomes\n227\ndisjoint.\n",
    "C. To count the size of the intersection of two or more independent sets of\noutcomes.\n",
    "D. To find the size of the intersection of dependent sets of outcomes.\n",
    "2.\nWhy does the Principle of Inclusion/Exclusion add the size of the intersection\nof three sets, rather than subtract?",
    "Explain in your own words.\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the section you are curious about.\n",
    "3.3.6\nPractice Problems\n1.\nSuppose you have sets 𝐴and 𝐵with |𝐴| = 9 and |𝐵| = 19.\n(a) What is the largest possible value for |𝐴∩𝐵| ?\n(b) What is the smallest possible value for |𝐴∩𝐵| ?\n",
    "(c) What are the possible values for |𝐴∪𝐵| ?\n",
    "2.\n",
    "If |𝐴| = 5 and |𝐵| = 2, what is |𝐴∪𝐵|",
    "+ |𝐴∩𝐵| ?\n",
    "3.\nA group of college students was asked about their TV watching habits.",
    "Of\nthose surveyed, 30 students watch The Walking Dead, 24 watch The Blacklist,\nand 28 watch Game of Thrones.",
    "Additionally, 18 watch The Walking Dead and\nThe Blacklist, 10 watch The Walking Dead and Game of Thrones, and 12 watch The\nBlacklist and Game of Thrones.",
    "There are 7 students who watch all three shows.\n",
    "How many students surveyed watched at least one of the shows?\n4.\n",
    "In a recent survey, 100 students reported whether they liked their potatoes\nmashed, French-fried, or twice-baked.",
    "54 liked them mashed, 39 liked French\nfries, and 51 liked twice baked potatoes.",
    "Additionally, 18 students liked both\nmashed and French-fried potatoes, 28 liked French fries and twice baked\npotatoes, 29 liked mashed and baked, and 11 liked all three styles.",
    "How many\nstudents hate potatoes?",
    "Explain why your answer is correct.\n",
    "5.\nHow many 13-bit strings (that is, bit strings of length 13) are there which:\na. Start with the sub-string 011?\nb.",
    "Have weight 8 (i.e., contain exactly 8 1’s) and start with the sub-string\n011?\n",
    "c. Either start with 011 or end with 01 (or both)?\n",
    "d. Have weight 8 and either start with 011 or end with 01 (or both)?\n6.\n",
    "For how many 𝑛∈{1, 2, . . .",
    ", 715} is 𝑛a multiple of one or more of 4, 3, or 5?\n\n228\n3.",
    "Counting\n7.\nHow many positive integers less than 1400 are multiples of 4, 7, or 9?",
    "Use the\nPrinciple of Inclusion/Exclusion.\n8.\n",
    "We want to build 13 letter “words” using only the first 𝑛= 12 letters of the\nalphabet.",
    "For example, if 𝑛= 5 we can use the first 5 letters, {𝑎, 𝑏, 𝑐, 𝑑, 𝑒}\n(Recall, words are just strings of letters, not necessarily actual English words.)\n",
    "a. How many of these words are there total?\nb.",
    "How many of these words contain no repeated letters?\n",
    "c. How many of these words start with the sub-word “ade”?\n",
    "d. How many of these words either start with “ade” or end with “be” or\nboth?\n",
    "e.",
    "How many of the words containing no repeats also do not contain the\nsub-word “bed”?\n9.\nGridtown USA, besides having excellent donut shops, is known for its precisely\nlaid out grid of streets and avenues.",
    "Streets run east-west, and avenues north-\nsouth, for the entire stretch of the town, never curving and never interrupted\nby parks or schools or the like.\n",
    "Suppose you live on the corner of 4th and 4th and work on the corner of\n19th and 19th.",
    "Thus you must travel 30 blocks to get to work as quickly as\npossible.\n",
    "a. How many different routes can you take to work, assuming you want to\nget there as quickly as possible?\n",
    "a. Now suppose you want to stop and get a donut on the way to work, from\nyour favorite donut shop on the corner of 18th Ave.",
    "and 16th St. How\nmany routes to work, stopping at the donut shop, can you take (again,\nensuring the shortest possible route)?\n",
    "a. Disaster Strikes Gridtown: there is a pothole on 7th Ave.",
    "between 6th\nSt. and 7th St.",
    "How many routes to work can you take avoiding that\nunsightly (and dangerous) stretch of road?\na.",
    "The pothole has been repaired (phew!)",
    "and a new donut shop has opened\non the corner of 7th Ave.",
    "and",
    "6th St.",
    "How many routes to work drive by\none or the other (or both) donut shops?",
    "Hint: the donut shops serve PIE.\n",
    "3.3.7\nAdditional Exercises\n1.\nLet 𝐴, 𝐵, and 𝐶be sets.\n",
    "(a) Find |(𝐴∪𝐶)",
    "\\ 𝐵| provided |𝐴| = 50, |𝐵| = 45, |𝐶| = 40, |𝐴∩𝐵| = 20,\n|𝐴∩𝐶| = 15, |𝐵∩𝐶| = 23, and |𝐴∩𝐵∩𝐶| = 12.\n\n3.3.",
    "Non-Disjoint Outcomes\n229\n(b) Describe a set in terms of 𝐴, 𝐵, and 𝐶with cardinality 26.\n",
    "2.\nFor how many three-digit numbers (100 to 999) is the sum of the digits even?\n(For example, 343 has an even sum of digits: 3 + 4 + 3 = 10 which is even.)",
    "Find\nthe answer and explain why it is correct in at least two different ways.\n\n3.4\nCombinations and Permutations\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Correctly decide between using a combination or a permutation when\nsolving a counting problem.\n",
    "2. Apply the correct combination or permutation to solve a counting\nproblem.\n",
    "3. Explain the relationship between combinations and permutations and\nwhy their formulas are correct.\n",
    "3.4.1\nSection Preview\nInvestigate!\n",
    "You have decided to decorate your magic wand with bands of different\ncolored tape.",
    "You have 10 different colors to choose from, and you will use\nfive of them to create five different stripes of color.",
    "How many different\nwand designs are possible?\n",
    "The product principle gives us a way to count the number of outcomes when\neach outcome is made by combining smaller pieces.",
    "A typical example of this is to\ncount the number of three-letter “words”; each outcome (word) we count is made\nup of a combination of three smaller pieces (letters).",
    "Since there are 26 choices for\neach smaller piece, there are 26 · 26 · 26 = 263 possible outcomes.\n",
    "The product principle does not require that each piece that is being combined be\nchosen from a set of the same size.",
    "We will use this observation to create a standard\nway to count outcomes when the pieces are chosen from a fixed set, but without\nallowing for any piece to be used more than once.",
    "For example, we can ask how\nmany 3-letter words there are that contain distinct letters.\n",
    "These arrangements are called permutations.",
    "We will also consider another\ncounting technique where we count combinations, which is related but counts\nsomething different.",
    "We will explore how these two counting techniques are related\nand how they can be used to solve a wide range of counting problems.\n",
    "Preview Activity\nYou have a bunch of poker chips that come in five different colors: red, blue, green,\npurple, and yellow.\n230\n\n3.4.",
    "Combinations and Permutations\n231\n1.\n",
    "How many two-chip stacks are possible where the bottom chip must be red or\nblue?\n(a) List all possible two-chip stacks.",
    "For example, the stack with a red chip\non bottom and a green chip on top can be listed as “RG”.\n",
    "(b) Using the additive principle, we notice that there are\nstacks that\nhave blue on the bottom, another\nstacks that have red on the bottom,\nso there are a total of\npossible stacks.\n",
    "(c) If we use the multiplicative principle, then there are\nchoices for the\nbottom chip and\nchoices for the top chip, so there are\npossible stacks.\n",
    "2.\nHow many different three-chip stacks are possible if the bottom chip must be\nred or blue and the top chip must be green, purple, or yellow?\n",
    "Hint.\n",
    "How does this question relate to the previous question?\n",
    "Is there\nsomething we can do to the 10 two-chip stacks to make them into three-chip\nstacks?\n3.\nHow many different three-chip stacks are there in which no color is repeated?\n(a) First, how many three-chip stacks with no repeated color have blue on\nthe bottom and green in the middle?\n",
    "And how many three-chip stacks with no repeated color have blue on\nthe bottom and yellow in the middle?\n",
    "In fact, for any stack with blue on the bottom and some other color in the\nmiddle, there are\npossible stacks.\n",
    "(b) If we insist that blue is on the bottom, how many choices do we have for\nthe color of the middle chip?\n",
    "Combining this with the answer from the previous question, how many\nthree-chip stacks with no repeated color have blue on the bottom?\n",
    "(c) Of course, we didn’t need to start with blue on the bottom.",
    "How many\nchoices do we have for the color of the bottom chip?\n",
    "So how many three-chip stacks with no repeated color are there?\n(d) How many four-chip sticks are there with no repeated color?\n4.\nSuppose you wanted to take three chips with different colors and put them in\nyour pocket.\n",
    "(a) One outcome is taking the blue, green, and purple chips.",
    "How many of\nthe three-chip stacks of different color chips correspond to this single\npocketful?\nHint.\n",
    "With these three colors, how many choices do you have for which\nchip is on the bottom?",
    "In the middle?",
    "On top?\n\n232\n3.",
    "Counting\n(b) How many different stacks of chips would result in picking up the red,\nyellow, and green chips?\n(c) So of the\npossible three-chip stacks, we can group the chips into\ngroups of size\n, where each group corresponds to the same pocketful\nof chips.",
    "How many different pocketfuls of chips are there?\n(d) How many different pocketfuls of chips are there if you take four chips?\n",
    "3.4.2\nCounting",
    "Sequences\nA permutation is a (possible) rearrangement of objects.",
    "For example, there are 6\npermutations of the letters a, b, c:\n𝑎𝑏𝑐, 𝑎𝑐𝑏, 𝑏𝑎𝑐, 𝑏𝑐𝑎, 𝑐𝑎𝑏, 𝑐𝑏𝑎.\n",
    "In terms of our discrete structures, each permutation is really a sequence or tuple of a\nfixed length.\n",
    "We know that we have them all listed above —there are 3 choices for which letter\nwe put first, then 2 choices for which letter comes next, which leaves only 1 choice\nfor the last letter.",
    "The multiplicative principle says we multiply 3 · 2 · 1.\n",
    "Example 3.4.1\nHow many sequences (permutations) are there of the letters a, b, c, d, e, f?\nSolution.\n",
    "We do NOT want to try to list all of the length 6 sequences of\nthese letters.",
    "However, if we did, we would need to pick a letter to write down\nfirst.",
    "There are 6 choices for that letter.",
    "For each choice of the first letter, there\nare 5 choices for the second letter (we cannot repeat the first letter; we are\nrearranging letters and only have one of each), and for each of those, there\nare 4 choices for the third, 3 choices for the fourth, 2 choices for the fifth, and\nfinally only 1 choice for the last letter.",
    "So there are 6 · 5 · 4 · 3 · 2 · 1 = 720\npermutations of the 6 letters.\n",
    "A piece of notation is helpful here: 𝑛!, read “𝑛factorial”, is the product of all\npositive integers less than or equal to 𝑛(for reasons of convenience, we also define 0!\nto be 1).",
    "So the number of permutations of 6 letters, as seen in the previous example\nis 6!",
    "= 6 · 5 · 4 · 3 · 2 · 1.",
    "This generalizes:\nTheorem 3.4.2 Permutations of 𝑛Elements.\n",
    "There are 𝑛!",
    "= 𝑛· (𝑛−1) · (𝑛−2) · · · · · 2 · 1 permutations of 𝑛(distinct) elements.\n\n",
    "3.4.",
    "Combinations and Permutations\n233\nExample 3.4.3",
    "Counting Bijective Functions.\n",
    "How many functions 𝑓: {1, 2, . . .",
    ", 8} →{1, 2, . . .",
    ", 8} are bĳective?\nSolution.\n",
    "Remember what it means for a function to be bĳective: Each\nelement in the codomain must be the image of exactly one element of the\ndomain.",
    "Using two-line notation, we could write one of these bĳections as\n𝑓=\n\u0012\n1\n2\n3\n4\n5\n6\n7\n8\n3\n1\n5\n8\n7\n6\n2\n4\n\u0013\n.\n",
    "What we are really doing is just rearranging the elements of the codomain, so\nwe are creating a permutation of 8 elements.",
    "In fact, “permutation” is another\nterm used to describe bĳective functions from a finite set to itself.\n",
    "If you believe this, then you see the answer must be 8!",
    "= 8·7·· · ··1 = 40320.\n",
    "You can see this directly as well: For each element of the domain, we must\npick a distinct element of the codomain to map to.",
    "There are 8 choices for\nwhere to send 1, then 7 choices for where to send 2, and so on.",
    "We multiply\nusing the multiplicative principle.\n",
    "Sometimes we do not want to permute all of the letters/numbers/elements we\nare given.\n",
    "Example 3.4.4\nHow many four-letter “words” can you make from the letters a through g,\nwith no repeated letters?\nSolution.\n",
    "This is just like the problem of permuting four letters, only now\nwe have more choices for each letter.",
    "For the first letter, there are 7 choices.\n",
    "For each of those, there are 6 choices for the second letter.",
    "Then there are 5\nchoices for the third letter and 4 choices for the last letter.",
    "The total number\nof words is 7 · 6 · 5 · 4 = 840.\n",
    "This is not 7! because we never multiplied by 3, 2, or 1.",
    "We could write it\nusing 7!",
    "though, if we cancel the 3, 2, and 1.",
    "Thus we could write the answer\nas\n7!\n3!",
    "= 7 · 6 · 5 · 4 · \u00013 ·",
    "\u00012 · \u00011\n\u00013 · \u00012 · \u00011\n= 7 · 6 · 5 · 4.\nIn general, we can ask how many permutations exist of 𝑘objects choosing those\nobjects from a larger collection of 𝑛objects.",
    "(In the example above, 𝑘= 4, and 𝑛= 7.)\nWe write this number 𝑃(𝑛, 𝑘) and sometimes call it a 𝑘-permutation of 𝑛elements.\n",
    "From the example above, we see that to compute 𝑃(𝑛, 𝑘) we must apply the\nmultiplicative principle to 𝑘numbers, starting with 𝑛and counting backwards.",
    "For\nexample\n𝑃(10, 4) = 10 · 9 · 8 · 7.\n\n234\n3.",
    "Counting\nNotice that 𝑃(10, 4) starts out looking like 10!, but we stop after 7.",
    "We can\nformally account for this “stopping” by dividing away the part of the factorial we do\nnot want:\n𝑃(10, 4) = 10 · 9 · 8 · 7 · 6 · 5 · 4 · 3 · 2 · 1\n6 · 5 · 4 · 3 · 2 · 1\n= 10!\n6! .\n",
    "Careful: The factorial in the denominator is not 4!",
    "but rather (10 −4)!.\n",
    "Definition 3.4.5 𝑘-permutations of 𝑛elements.\n",
    "𝑃(𝑛, 𝑘) is the number of 𝑘-permutations of 𝑛elements, the number of ways\nto arrange 𝑘objects chosen from 𝑛distinct objects.\n",
    "Theorem 3.4.6\n",
    "The number of 𝑘-permutations of 𝑛elements is\n𝑃(𝑛, 𝑘) =\n𝑛!\n(𝑛−𝑘)!",
    "= 𝑛(𝑛−1)(𝑛−2) · · · (𝑛−(𝑘−1)).\n",
    "Note that when 𝑛= 𝑘, we have 𝑃(𝑛, 𝑛) =\n𝑛!\n(𝑛−𝑛)!",
    "= 𝑛!",
    "(since we defined 0!",
    "to be 1).\n",
    "This makes sense —we already know 𝑛! gives the number of permutations of all 𝑛\nobjects.\n",
    "Example 3.4.7",
    "Counting injective functions.\n",
    "How many functions 𝑓: {1, 2, 3} →{1, 2, 3, 4, 5, 6, 7, 8} are injective?\nSolution.\n",
    "Note that it doesn’t make sense to ask for the number of bĳections\nhere, as there are none (because the codomain is larger than the domain, there\nare no surjections).",
    "But for a function to be injective, we just can’t use an\nelement of the codomain more than once.\n",
    "We need to pick an element from the codomain to be the image of 1.",
    "There\nare 8 choices.",
    "Then we need to pick one of the remaining 7 elements to be the\nimage of 2.",
    "Finally, one of the remaining 6 elements must be the image of 3.\n",
    "So the total number of functions is 8 · 7 · 6 = 𝑃(8, 3).\n",
    "What this demonstrates in general is that the number of injections 𝑓: 𝐴→\n𝐵, where |𝐴| = 𝑘and |𝐵| = 𝑛, is 𝑃(𝑛, 𝑘).\n",
    "3.4.3\nCounting Sets\nLet’s consider another way to count sequences:",
    "First count sets, then arrange them.\n\n3.4.",
    "Combinations and Permutations\n235\nExample 3.4.8\nYour basketball team has 12 players.",
    "Assuming everyone can play every\nposition, how many ways can you choose 5 players to be on the court at the\nsame time?\nSolution.\n",
    "This question is actually too vague.",
    "Do we mean how many ways\ncan we select five players?",
    "Or do we mean how many ways can we pick five\nplayers to fill the five positions?2 Let’s answer both of these questions.\n",
    "First, if we just want to select five out of the 12 players, that is just like\npicking five out of 12 pizza toppings (although less delicious).",
    "We know that\nthere are \u000012\n5\n\u0001\nways to do this, and from Pascal’s triangle we know that this is\n792.\n",
    "On the other hand, if we wanted to pick five players for the five different\npositions",
    ",... well, we could start by picking one of the 792 different sets of\nfive players, and then permute them into the five positions.",
    "Of the five\nplayers on the court, we pick one of the five to be the point guard, then one\nof the remaining four to be the shooting guard, and so on.",
    "This gives us\n5 · 4 · 3 · 2 · 1 = 5! ways to arrange the players.",
    "So the total number of ways to\npick five players for the five positions is\n\u0012\n12\n5\n\u0013\n· 5! = 792 · 120 = 95, 040.\nWait.",
    "We could have found that number directly.",
    "Without choosing the\nfive players first, we have 12 choices for the point guard, then 11 choices for\nthe shooting guard, and so on.",
    "So the total number of ways to pick five players\nfor the five positions is simply the permutation\n𝑃(12, 5) = 12 · 11 · 10 · 9 · 8 = 95, 040.\n",
    "Thank goodness that is the same answer!\n",
    "The example above illustrates a second way to compute the number of 𝑘-\npermutations of 𝑛elements: First select which 𝑘elements will be in the permutation,\nthen count how many ways there are to arrange them.",
    "Once you have selected the\nset of 𝑘objects, we know there are 𝑘! ways to arrange (permute) them.",
    "But how do\nyou select 𝑘objects from the 𝑛?",
    "You have 𝑛objects, and you need to choose 𝑘of them.\n",
    "You can do that in \u0000𝑛\n𝑘\n\u0001\nways.\n",
    "Using the multiplicative principle to combine the two steps, we get another\nformula for 𝑃(𝑛, 𝑘):\n𝑃(𝑛, 𝑘) =\n\u0012\n𝑛\n𝑘\n\u0013\n· 𝑘!.\n",
    "2I’m told the five positions are called point guard, shooting guard, small forward, power forward,\nand center.",
    "Who knew?\n\n236\n3.",
    "Counting\n",
    "This is HUGE!\n",
    "We have a closed formula for 𝑃(𝑛, 𝑘) already.",
    "We can substitute that in:\n𝑛!\n(𝑛−𝑘)!",
    "=\n\u0012\n𝑛\n𝑘\n\u0013\n· 𝑘!.\n",
    "If we then divide both sides by 𝑘!, we get a closed formula for \u0000𝑛\n𝑘\n\u0001\n.\n",
    "Theorem 3.4.9 Closed Formula for \u0000𝑛\n𝑘\n\u0001\n.\n",
    "\u0012\n𝑛\n𝑘\n\u0013\n=\n𝑛!\n(𝑛−𝑘)!𝑘!",
    "= 𝑛(𝑛−1)(𝑛−2) · · · (𝑛−(𝑘−1))\n𝑘(𝑘−1)(𝑘−2) · · · 1\n.\n",
    "Another name for the collections of things that \u0000𝑛\n𝑘\n\u0001\ncounts is combinations.",
    "We\nsay that \u0000𝑛\n𝑘\n\u0001\ncounts the number of 𝑘-element combinations of 𝑛elements.",
    "Sometimes\nwe even use the notation 𝐶(𝑛, 𝑘) instead of \u0000𝑛\n𝑘\n\u0001\n.\nClearly combinations and permutations are very closely related.",
    "The formulas\nto count each are very similar; there is just an extra 𝑘!",
    "in the denominator of \u0000𝑛\n𝑘\n\u0001.\nThat extra 𝑘! accounts for the fact that \u0000𝑛\n𝑘\n\u0001\ndoes not distinguish between the different\norders that the 𝑘objects can appear in.",
    "We are just selecting (or choosing) the 𝑘\nobjects, not arranging them.\n",
    "Example 3.4.10\nYou decide to have a dinner party.",
    "Even though you are incredibly popular\nand have 14 different friends, you only have enough chairs to invite 6 of them.\n",
    "1.",
    "How many choices do you have for which 6 friends to invite?\n2.",
    "What if you need to decide not only which friends to invite but also\nwhere to seat them along your long table?",
    "How many choices do you\nhave then?\nSolution.\n",
    "1.",
    "You must simply choose 6 friends from a group of 14.",
    "This can be done\nin \u000014\n6\n\u0001\nways.",
    "We can find this number either by using Pascal’s triangle\nor the closed formula:\n14!\n8!·6!",
    "= 3003.\n",
    "2.",
    "Here you must count all the ways you can permute 6 friends chosen\nfrom a group of 14.",
    "So the answer is 𝑃(14, 6), which can be calculated\nas 14!\n8!",
    "= 2162160.\n",
    "Notice that we can think of this counting problem as a question about\ncounting functions: How many injective functions are there from your\nset of 6 chairs to your set of 14 friends (the functions are injective because\nyou can’t have a single chair go to two of your friends).\n\n",
    "3.4.",
    "Combinations and Permutations\n237\nHow are these numbers related?",
    "Notice that 𝑃(14, 6) is much larger than\n\u000014\n6\n\u0001\n.",
    "This makes sense.",
    "\u000014\n6\n\u0001\npicks 6 friends, but 𝑃(14, 6) arranges the 6 friends\nas well as picks them.",
    "In fact, we can say exactly how much larger 𝑃(14, 6) is.\n",
    "In both counting problems we choose 6 out of 14 friends.",
    "For the first one, we\nstop there, at 3003 ways.",
    "But for the second counting problem, each of those\n3003 choices of 6 friends can be arranged in exactly 6! ways.",
    "So now we have\n3003 ·",
    "6! choices and that is exactly 2162160.\n",
    "Alternatively, look at the first problem another way.",
    "We want to select 6\nout of 14 friends, but we do not care about the order they are selected in.",
    "To\nselect 6 out of 14 friends, we might try this:\n14 · 13 · 12 · 11 · 10 · 9.\n",
    "This is a reasonable guess, since we have 14 choices for the first guest, then\n13 for the second, and so on.",
    "But the guess is wrong (in fact, that product is\nexactly 2162160 = 𝑃(14, 6)).",
    "It distinguishes between the different orders in\nwhich we could invite the guests.",
    "To correct for this, we could divide by the\nnumber of different arrangements of the 6 guests (so that all of these would\ncount as just one outcome).",
    "There are precisely 6! ways to arrange 6 guests, so\nthe correct answer to the first question is\n14 · 13 · 12 · 11 · 10 · 9\n6!\n.\n",
    "Note that another way to write this is\n14!\n8! ·",
    "6!.\nwhich is what we had originally.\n",
    "Perhaps “combination” is a misleading label.",
    "We don’t mean it like a combination\nlock (where the order would definitely matter).",
    "Perhaps a better metaphor is a\ncombination of flavors — you just need to decide which flavors to combine, not the\norder in which to combine them.\n",
    "So how do you know when to use a combination and when to use a permutation?\n",
    "Does order matter?\n",
    "Almost every source you look at about combinations and\npermutations will make some variation of the following claim.\n",
    "Use a permutation when the order matters, and use a combination when\nthe order does not matter.\n",
    "What does this even mean?",
    "And why is it an absolutely awful way to distinguish\nbetween the two counting techniques?",
    "Let’s explore with an example.\n",
    "Suppose you are proposing a new lottery game.",
    "In the game, five numbered\nballs will be randomly shot out of the machine that holds balls numbered 1 to 50.",
    "If\n\n238\n3.",
    "Counting\na player correctly picks the five numbers that come out, they win the jackpot.\n",
    "Of course, we want to know the odds of winning this lottery game, which\nrequires us to know how many different outcomes there are.",
    "The balls fly out of the\nmachine randomly, so one result might be to get the balls\n26, 5, 42, 17, 33.\n",
    "If you were holding the ticket that had numbers 5, 17, 26, 33, 47, do you expect\nto have won?",
    "Most lottery games would say you have, since you have the same\nnumbers, just in a different order.\n",
    "In this sense, the order of the numbers does not matter.",
    "A better way to say this is\nthat any order of the same numbers is considered the same outcome, and is counted\nonly once.",
    "So really, we are counting the sets of five numbers, not the sequences of\nfive numbers.",
    "Each outcome is a combination, so the number of outcomes should\nbe 𝐶(52, 5) = \u000052\n5\n\u0001\n.\n",
    "On the other hand, if we must pick the numbers in the same order they come out\nof the machine, then we are really matching a sequence of numbers to a sequence of\nnumbers.",
    "The number of sequences is 𝑃(52, 5).",
    "In this case, we would say that the\norder matters.\n",
    "Okay, so far so good.",
    "But what about the following example?\nExample 3.4.11\nHow many three letter “words” are there in which\n1.",
    "the letters appear in alphabetical order?\n",
    "2. the letters in the word can come in any order?\nSolution.\n",
    "Does “order matter” for the first question?",
    "In some sense, abso-\nlutely!",
    "We only want to count words where the letters are in the correct order.\n",
    "But from the standard combination/permutation sense of order mattering, it\ndoes not.\n",
    "Much better would be to ask ourselves whether we should represent each\noutcome as a set of letters or a sequence of letters.",
    "It is true that words are a\nsequence of letters, but are we counting all possible sequences?",
    "Nope, just\none sequence for each set of letters.",
    "Ah, yes, set of letters.",
    "Each outcome\ncorresponds exactly to one set of three letters.",
    "We are counting sets, so we\ncount combinations.",
    "The number of outcomes is 𝐶(26, 3) = \u000026\n3\n\u0001\n.\n",
    "For the second question, it might look like the order shouldn’t matter.\n",
    "Well, it doesn’t matter to the machine spitting out the letters, but it would\nmatter if we were trying to match the letters.",
    "No, let’s think about it like\nthis: Are we counting every possible sequence of letters?",
    "Yes!",
    "So these are\npermutations, and the number of outcomes is 𝑃(26, 3).\n",
    "Another deceptive use of order appears when counting bit strings.",
    "Recall that\nan 𝑛-bit string of weight 𝑘is a string of 𝑛bits (0s and 1s) in which 𝑘of the bits are 1s.\n\n",
    "3.4.",
    "Combinations and Permutations\n239\nFor example, the 4-bit strings of weight 2 are\n1100, 1010, 1001, 0110, 0101, 0011.\n",
    "Does order matter for bit strings?",
    "Of course it does!",
    "It is the only thing that matters.\n",
    "All of the strings above contain exactly the same number of 0s and 1s; they are only\ndistinguished by the order of the bits.\n",
    "And yet, the number of 𝑛-bit strings of weight 𝑘is \u0000𝑛\n𝑘\n\u0001\nand NOT a permutation.\n",
    "What is going on here?\n",
    "Nothing is broken; we are just not thinking about the right objects about which\nto consider the order.",
    "When we choose 𝑘out of 𝑛things for a bit string, it is the\npositions we are choosing (to fill with 1s, say).",
    "It does not matter in what order we\nchoose those positions, just what set of positions we choose.",
    "That is, the bit string\n1001 is the result of choosing positions 1 and 4 to put 1s into.",
    "If we chose positions 4\nand then 1, we would get the same bit string.\n",
    "To summarize, the question of whether order matters can lead us astray when\ndeciding between a combination and a permutation.",
    "Instead, we should decide\nwhether the outcomes we are counting are sets or sequences.",
    "If we are counting\nsets, think combination.",
    "If we are counting sequences, think permutation.\n",
    "3.4.4\nThe Quotient Principle\n",
    "We have two ways to write the numerical relationship between the numbers of\ncombinations and permutations.",
    "Using the product principle, we have,\n𝑃(𝑛, 𝑘) =\n\u0012\n𝑛\n𝑘\n\u0013\n· 𝑘!\nwhich can be rewritten as,\n\u0012\n𝑛\n𝑘\n\u0013\n= 𝑃(𝑛, 𝑘)\n𝑘!\n.\n",
    "This second formula suggests that there might be a quotient principle that we could\nuse to justify it.\n",
    "Let’s think about what division means.",
    "One way to think of the division problem\n24 ÷ 6 = 4, for example, is saying that if you have 24 things that you divide into\ngroups of size 6, the number of groups will be 4.3\nNow let’s look at all the 3-permutations of a set of size 4: For example, all the\nways to make 3-letter words using the letters 𝑎, 𝑏, 𝑐, 𝑑. We know the number of such\nwords is 𝑃(4, 3) = 4 · 3 · 2 = 24.",
    "It is helpful to actually list all these out.\n",
    "𝑎𝑏𝑐\n𝑎𝑐𝑏\n𝑏𝑎𝑐\n𝑏𝑐𝑎\n𝑐𝑎𝑏\n𝑐𝑏𝑎\n𝑎𝑏𝑑\n𝑎𝑑𝑏\n𝑏𝑎𝑑\n𝑏𝑑𝑎\n𝑑𝑎𝑏\n𝑑𝑏𝑎\n𝑎𝑐𝑑\n𝑎𝑑𝑐\n𝑐𝑎𝑑\n𝑐𝑑𝑎\n𝑑𝑎𝑐\n𝑑𝑐𝑎\n𝑏𝑐𝑑\n𝑏𝑑𝑐\n𝑐𝑏𝑑\n𝑐𝑑𝑏\n𝑑𝑏𝑐\n𝑑𝑐𝑏\n3The other way to interpret this statement is that if you divide 24 things into six groups, then each\ngroup will have size 4, but this is less useful for what we will do.\n\n",
    "240\n3.",
    "Counting\nLook at the first row.",
    "What do all these permutations have in common?",
    "These\nare exactly the permutations that use the letters 𝑎, 𝑏, 𝑐in different orders.",
    "It is\nnot surprising that there are 6 of these, since the number of ways to arrange three\nelements is 3!",
    "= 6.",
    "Similarly, the second row has 6 permutations that use the letters\n𝑎, 𝑏, 𝑑in different orders, and so on.\n",
    "The point is, if we wanted to just count how many sets of three of the four letters\nwe have, each set corresponds exactly to one of the rows in the table.",
    "There are 24\nelements in the table, and 6 elements in each row, so there must be 24 ÷ 6 = 4 rows.\n",
    "And of course, we are not surprised because \u00004\n3\n\u0001\n= 4.\nA more mathematically rigorous explanation for this phenomenon is to use the\nlanguage of equivalence relations and partitions from Section 2.6.",
    "We start with\npermutations, and then we define an equivalence relation on the permutations by\nsaying two permutations are equivalent provided they contain exactly the same\nelements.",
    "From the equivalence relation we get a partition of our set of permutations\ninto equivalence classes.\n",
    "The combinations we want to count are precisely the\nequivalence classes.",
    "Since each equivalence class has the same size, we can find the\nnumber of classes by dividing the number of permutations by the size of each class.\n",
    "This sort of quotient principle is also useful for solving questions where the\nanswer isn’t obviously either a permutation or combination.\n",
    "Example 3.4.12\nYou have decided to decorate your magic wand with bands of different colored\ntape.",
    "You have 10 different colors to choose from, and you will use five of them\nto create five different stripes of color.",
    "How many different wand designs are\npossible?\nSolution.\n",
    "Our first attempt to solve this problem might be to think of each\noutcome we are trying to count as a 5-permutation of 10 colors.",
    "That would\ngive us an answer of 𝑃(10, 5) = 10 · 9 · 8 · 7 · 6 = 30, 240.",
    "So why is this not\ncorrect?",
    "Let’s start making a list of the outcomes that are possible.\n",
    "1.",
    "Red, blue, green, yellow, orange.\n",
    "2. Red, blue, green, yellow, purple.\n",
    "3. Blue, green, red, yellow, orange.\n",
    "4.",
    "Orange, yellow, green, blue, red.\n5. etc.\nWhile starting this list, perhaps we asked ourselves whether red, red, blue,\nblue, red should be on the list, and recognized that it shouldn’t.",
    "Another\nthing we might have considered is whether items 1 and 3 are really different.\n",
    "They are, since one wand has red as an outside color while the other one does\nnot.\n\n3.4.",
    "Combinations and Permutations\n241\nBut what about items 1 and 4?",
    "They have the same five colors, but in\na different order.",
    "However, if you were to spin the magic wand around,\nlike magicians are apt to do, you could easily end up with wand 4 from\nwand 1.",
    "Aha!",
    "We see that each wand is counted exactly twice in our list of\npermutations: two permutations are equivalent if they are just the reverse of\neach other.\n",
    "Since we can group the permutations into groups of size 2, and each group\ncorresponds to a single wand, we see that the correct answer is,\n𝑃(10, 5)\n",
    "2\n= 10 · 9 · 8 · 7 · 6\n2\n= 15, 120.\n",
    "Tada!\n3.4.5\nReading Questions\n1.\nTrue or false: The number of sequences of two distinct digits from 0-9 is twice\nthe number of sets of two distinct digits from 0-9.",
    "Briefly explain.\n",
    "2.\nTrue or false: The number of sequences of three distinct digits from 0-9 is 3\ntimes the number of sets of three distinct digits from 0-9.",
    "Briefly explain.\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "3.4.6\nPractice Problems\n1.\n",
    "A pizza parlor offers 8 toppings.\n",
    "a. How many 2-topping pizzas could they put on their menu?",
    "Assume\ndouble toppings are not allowed.\n",
    "b.",
    "How many total pizzas are possible, with between zero and 8 toppings\n(but not double toppings) allowed?\n",
    "c.",
    "The pizza parlor will list the 8 toppings in two equal-sized columns on\ntheir menu.",
    "How many ways can they arrange the toppings in the left\ncolumn?\n2.\n",
    "A combination lock consists of a dial with 41 numbers on it.",
    "To open the lock,\nyou turn the dial to the right until you reach the first number, then to the left\nuntil you get to the second number, then to the right again to the third number.\n",
    "The numbers must be distinct.",
    "How many different combinations are possible?\n3.\nUsing the digits 2 through 9, find the number of different 7-digit numbers\nsuch that:\na. Digits can be used more than once.\n",
    "b.",
    "Digits cannot be repeated, but can come in any order.\n\n",
    "242\n3.",
    "Counting\nc. Digits cannot be repeated and must be written in increasing order.\n",
    "4.\nIn an attempt to clean up your room, you have purchased a new floating shelf\nto put some of your 30 books you have stacked in a corner.",
    "These books are\nall by different authors.",
    "The new book shelf is large enough to hold 19 of the\nbooks.",
    "Careful:",
    "Before answering the next two questions, ask yourself which\nanswer should be larger.\n",
    "a. How many ways can you select and arrange 19 of the 30 books on the\nshelf?",
    "Notice that here we will allow the books to end up in any order.\n",
    "b.",
    "How many ways can you arrange 19 of the 30 books on the shelf if you\ninsist they must be arranged alphabetically by author?\n5.\n",
    "An anagram of a word is just a rearrangement of its letters.",
    "How many different\nanagrams of “ambidextrously” are there?\n6.\nHow many anagrams are there of the word “seeded” that start with the letter\n“s”?\n",
    "7.\n",
    "How many anagrams are there of “goggles”?\n8.\n",
    "On a business retreat, your company of 40 businessmen and businesswomen\ngoes golfing.\n",
    "a. You need to divide up into foursomes (groups of 4 people): a first\nfoursome, a second foursome, and so on.",
    "How many ways can you do\nthis?\nb.",
    "After all your hard work, you realize that in fact, you want each foursome\nto include one of the 10 Board members.",
    "How many ways can you do\nthis?\n9.\n",
    "How many different seating arrangements are possible for King Arthur and\nhis 13 knights around their round table?\n10.\n",
    "Consider sets 𝐴and 𝐵with |𝐴|",
    "= 13 and |𝐵| = 22.\n",
    "a. How many functions 𝑓: 𝐴→𝐵are there?\nb.",
    "How many functions 𝑓: 𝐴→𝐵are injective?\n11.\n",
    "Consider functions 𝑓: {1, 2, 3, 4, 5} →{1, 2, 3, 4, 5, 6}.\n",
    "a. How many functions are there total?\nb.",
    "How many functions are injective?\n",
    "c. How many of the injective functions are increasing?",
    "To be increasing\nmeans that if 𝑎< 𝑏then 𝑓(𝑎) < 𝑓(𝑏), or in other words, the outputs get\nlarger as the inputs get larger.\n\n",
    "3.4.",
    "Combinations and Permutations\n243\n3.4.7\nAdditional Exercises\n1.\n",
    "How many triangles are there with vertices from the points shown below?\n",
    "Note that we are not allowing degenerate triangles – ones with all three vertices\non the same line – but we do allow non-right triangles.",
    "Explain why your\nanswer is correct.\n",
    "2.\nWe have seen that the formula for 𝑃(𝑛, 𝑘) is\n𝑛!\n(𝑛−𝑘)!.",
    "Your task here is to\nexplain why this is the right formula.\n",
    "(a) Suppose you have 12 chips, each a different color.",
    "How many different\nstacks of 5 chips can you make?",
    "Explain your answer and why it is the\nsame as using the formula for 𝑃(12, 5).\n",
    "(b) Using the scenario of the 12 chips again, what does 12!",
    "count?",
    "What does\n7! count?",
    "Explain.\n",
    "(c) Explain why it makes sense to divide 12!",
    "by 7! when computing 𝑃(12, 5)\n(in terms of the chips).\n",
    "(d) Does your explanation work for numbers other than 12 and 5?",
    "Explain\nthe formula 𝑃(𝑛, 𝑘) =\n𝑛!\n(𝑛−𝑘)!",
    "using the variables 𝑛and 𝑘.\n\n3.5\nCounting Multisets\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1.",
    "Identify counting problems whose outcomes can be represented by\nmultisets.\n",
    "2. Represent outcomes of counting problems using multisets and sticks\nand stones diagrams.\n",
    "3.",
    "Solve counting problems using sticks and stones.\n",
    "3.5.1\nSection Preview\nInvestigate!\n",
    "Skittles come in five “flavors”.",
    "How many different handfuls of 8 skittles\nare possible?\n",
    "Suppose you have baked 8 identical cupcakes to give to your top five\nfavorite discrete math teachers.",
    "How many ways can you distribute the\ncupcakes?\n",
    "Why are the answers to the two counting questions above the same?\n",
    "We know how to solve lots of types of counting problems now.",
    "If each outcome\nin a set of outcomes we are counting can be represented by a sequence, we count\nit as a permutation (if the terms in the sequence don’t repeat) or use the product\nprinciple (if they do).",
    "If we are counting outcomes for which we don’t distinguish\nbetween different arrangements of the terms (if order doesn’t matter) then we think\nof the outcome as a set and count it as a combination.",
    "However, sets never allow an\nelement to be repeated; each element is either in a set or not.\n",
    "So we have a glaring hole in our counting repertoire.",
    "What if we want to count\noutcomes that are collections of terms for which we do not distinguish between the\norder the terms appear in, but can contain terms more than once?",
    "In other words,\nhow can we complete the following table?\n244\n\n3.5.",
    "Counting Multisets\n245\nDistinguished Arrangements?\n",
    "Yes\nNo\nRepeats OK\nSequences\nProd.",
    "Principle\n𝑛𝑘\nNo repeats\nSequences\nPermutations\n𝑃(𝑛, 𝑘)\nSets\nCombinations\n\u0000𝑛\n𝑘\n\u0001\nWhat we want to count are some sort of set-like structure but one that does permit\nelements in the set to appear more than once.",
    "Such structures are called multisets.\n",
    "Definition 3.5.1\nA multiset is an unordered collection of elements, each of which can appear\nany number of times.",
    "The number of times an element appears is called its\nmultiplicity.\n",
    "Multisets are written using the same notation as sets: a comma-separated\nlist in braces, such as {1, 2, 2, 5}.\n",
    "In this section, we will explore how multisets can be used to represent a wide\nrange of counting problems.",
    "We will then develop a way to translate multisets into a\nspecial type of bit-string so that we can use the numbers in Pascal’s triangle to count\nthe number of multisets.\n",
    "Preview Activity\n1.\nFind a collection of identical objects, perhaps pennies or sugar cubes.",
    "Also\ngrab a few dividers, which could be toothpicks, matches, or pens.\n",
    "Line up the pennies in a single row.",
    "We will divide the row into some\nnumber of groups by placing the toothpicks in the spaces between the pennies.\n",
    "We will distinguish between which order the groups come in.",
    "For example,\ntwo different ways to divide 7 pennies into 4 groups would look like this:\nWe will allow for one or more groups to contain no pennies (by having two\ntoothpicks next to each other or before or after all of the pennies).\n",
    "By lining up the correct number of pennies and sticks, count the number of\nways you can divide a row of pennies into the given number of groups.\n",
    "(a) If you want to divide a row of pennies into 4 groups, how many toothpicks\nwill you need?\n\n246\n3.",
    "Counting\n(b) How many ways are there to separate a row of three pennies into two\ngroups?\n(c) How many ways are there to separate a row of four pennies into two\ngroups?\n(d) How many ways are there to separate a row of five pennies into two\ngroups?\n(e) How many ways are there to separate a row of three pennies into three\ngroups?\n(f) How many ways are there to separate a row of four pennies into three\ngroups?\n(g) How many ways are there to separate a row of five pennies into three\ngroups?\n(h) Based on your answers above, make a conjecture about how many ways\nyou could separate a row of seven pennies into four groups.\n",
    "Hint.\n",
    "Look for the numbers you found in the previous questions in\nPascal’s triangle.\n",
    "3.5.2\nHave Some Cookies\nConsider the following counting problem:\nYou have 7 cookies to give to 4 kids.",
    "How many ways can you do this?\nTake a moment to think about how you might solve this problem.",
    "You may assume\nthat it is acceptable to give a kid no cookies.",
    "Also, the cookies are all identical and\nthe order in which you give out the cookies does not matter (so giving cookies to the\nsecond kid before the first kid does not count as a separate outcome as the other\nway around).\n",
    "Before solving the problem, here is a wrong answer: You might guess that the\nanswer should be 47 because, for each of the 7 cookies, there are 4 choices of kids to\nwhich you can give the cookie.",
    "This is reasonable, but wrong.",
    "To see why, consider\na few possible outcomes: We could assign the first six cookies to kid A, and the\nseventh cookie to kid B. Another outcome would assign the first cookie to kid B and\nthe six remaining cookies to kid A.",
    "Both outcomes are included in the 47 answer.\n",
    "But for our counting problem, both outcomes are really the same – kid A gets six\ncookies and kid B gets one cookie.",
    "This would have been the correct answer if the\ncookies were all different, but they are not.\n",
    "What do outcomes actually look like?",
    "How can we represent them?",
    "One\napproach would be to write an outcome as a string of four numbers like this:\n3112,\n\n3.5.",
    "Counting Multisets\n247\nwhich represents the outcome in which the first kid gets 3 cookies, the second and\nthird kids each get 1 cookie, and the fourth kid gets 2 cookies.",
    "Represented this\nway, the order in which the numbers occur matters.",
    "1312 is a different outcome,\nbecause the first kid gets one cookie instead of 3.",
    "Each number in the string can\nbe any integer between 0 and 7.",
    "But the answer is not 74.",
    "We need the sum of the\nnumbers to be 7.\nAnother way we might represent outcomes is to write a string of seven letters:\nABAADCD,\nwhich represents that the first cookie goes to kid A, the second cookie goes to kid B,\nthe third and fourth cookies go to kid A, and so on.",
    "In fact, this outcome is identical\nto the previous one—A gets 3 cookies, B and C get 1 each, and D gets 2.",
    "Each of\nthe seven letters in the string can be any of the 4 possible letters (one for each kid),\nbut the number of such strings is not 47, because here order does not matter.",
    "In fact,\nanother way to write the same outcome is\nAAABCDD.\n",
    "This will be the preferred representation of the outcome.",
    "Since we can write\nthe letters in any order, we might as well write them in alphabetical order for the\npurposes of counting.",
    "So we will write all the A’s first, then all the B’s, and so on.",
    "In\nfact, since we do not distinguish between the different arrangements, it is like we are\nwriting a set, just that this multiset can contain an element more than one time.\n",
    "So we now have two useful ways to think of the outcomes.\n",
    "1.",
    "As a multiset containing 7 elements, each of which is one of the four kids (or\nletter representing their names).",
    "For example,\n{𝐴, 𝐴, 𝐴, 𝐵, 𝐶, 𝐷, 𝐷}.\n",
    "Each time a kid is in the multiset, it means that kid gets a cookie, so the\nmultiplicity of the kid in the multiset is the number of cookies the kid gets.\n",
    "2.",
    "As a string of 4 non-negative numbers with a sum of 7.",
    "For example,\n3112.\n",
    "The position of the number in the string represents the kid, and the number\nitself represents the number of cookies that kid gets.\n",
    "Before we think about how to count the number of outcomes represented this\nway, here are a couple more examples of counting problems we can represent in\nthese ways.\n\n248\n3.",
    "Counting\nExample 3.5.2\nYou grab a handful of ten jelly beans from a bag that contains six flavors.",
    "Write\ndown three possible outcomes using both multisets and strings of numbers.\n",
    "Solution.\n",
    "Multisets are the more natural way to think of this problem since\neach handful is a multiset of flavors.",
    "So for example we could have,\n{𝑅, 𝑅, 𝐺, 𝐺, 𝐺, 𝐵, 𝐵, 𝐵, 𝐵, 𝑌}\nmeaning you got two red, three green, four blue, and one yellow jelly bean\n(and no purple or orange), or\n{𝑅, 𝑅, 𝑅, 𝑅, 𝑅, 𝑅, 𝑅, 𝑅, 𝑅, 𝑅}\nwhich means you got ten red jelly beans.",
    "You could also have\n{𝑅, 𝐺, 𝐵, 𝑌, 𝑃, 𝑂, 𝑂, 𝑂, 𝑂, 𝑂}\nmeaning you have one each of red, green, blue, and yellow, and five orange\njelly beans.\n",
    "The corresponding sequences of six numbers summing to 10 are\n2, 3, 4, 1, 0, 0;\n10, 0, 0, 0, 0, 0;\n1, 1, 1, 1, 1, 5.\n",
    "(We added commas between numbers since not every number is a single\ndigit.)",
    "Notice that for this representation we need to agree on a fixed order of\nthe flavors, which was not alphabetical in this case, but the same order we\nused when listing the multisets.\n",
    "Example 3.5.3\nYou have 12 identical copies of your favorite Discrete Math book that you\nwant to put on 5 bookshelves.",
    "Write down three possible outcomes using\nboth multisets and strings of numbers.\nSolution.\n",
    "Here the sequences of numbers are more natural, since we can\njust say how many books go on each shelf.",
    "We will need 5 numbers that add\nup to 12.",
    "For example, we could have\n1. 3, 3, 3, 2, 1, meaning 3 books on the first shelf, 3 on the second, 3 on the\nthird, 2 on the fourth, and 1 on the fifth.\n",
    "2. 0, 0, 12, 0, 0, meaning all 12 books are on the middle shelf.\n",
    "3. 1, 1, 1, 1, 8, meaning one book on each of the first four shelves and 8 on\nthe last.\n",
    "The corresponding multisets are\n\n3.5.",
    "Counting Multisets\n249\n1.",
    "{1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 5}, meaning shelf 1 is assigned a book three\ntimes, shelf 2 is assigned a book three times, etc.",
    "Notice that there are 12\nelements in the multiset, one for each book.",
    "The numbers here represent\nthe shelves; the multiplicity of the number is the number of books on\nthat shelf.\n",
    "2. {3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3}.",
    "The only shelf in the multiset is shelf 3,\nwith multiplicity 12, meaning that shelf 3 gets 12 books.\n",
    "3. {1, 2, 3, 4, 5, 5, 5, 5, 5, 5, 5, 5}.",
    "Here shelf 1 gets one book, shelf 2 gets one\nbook, shelf 3 gets one book, shelf 4 gets one book, and shelf 5 gets the\nrest.\n",
    "This last example could also have been asked as a question about solving\nequations with non-negative integer solutions.",
    "In particular, we could have asked\nfor solutions to the equation 𝑎+ 𝑏+ 𝑐+ 𝑑+ 𝑒= 12.",
    "Think of each variable as saying\nhow many books go on each shelf.",
    "We will ask questions directly like this, but\nrealizing how to represent other questions as such an equation can be useful.\n",
    "3.5.3\nRepresenting Multisets with Bit Strings\nNow let’s return to the original problem of distributing 7 cookies to 4 kids and\nactually count the number of outcomes.\n",
    "When we were counting plain old sets, we saw that the numbers in Pascal’s\ntriangle gave us the counts.",
    "In fact, we saw this was true because we could represent\neach set as a bit string.",
    "Whenever an element was in the set, we would denote that\nwith a 1, and if the element was not in the set, we would mark its absence with a 0.\n",
    "This is essentially what we did with multisets but had to use strings of non-\nnegative numbers beyond just 0 and 1, since an element in a multiset can appear\nmore than 0 or 1 times.",
    "But if we could translate those strings of numbers into some\nother sort of bit string, then we could use Pascal’s triangle to count the number of\nmultisets.\n",
    "Here is how we can do this.",
    "Given a multiset such as\n{𝐴, 𝐴, 𝐴, 𝐵, 𝐶, 𝐷, 𝐷}\nwe have a number sequence representation as\n3, 1, 1, 2.\n",
    "Well, instead of individual numbers, write each as a sequence of that many 1s.",
    "So\nthis example becomes\n111, 1, 1, 11.\n",
    "This is slightly awkward since we are using commas to separate the numbers.",
    "To\nmake this clearer, let’s switch to two different symbols.",
    "We will call them sticks and\n\n250\n3.",
    "Counting\nstones, where the stone represents a 1 and the stick represents a comma.",
    "So the\nsequence\n111, 1, 1, 11\nbecomes\n◦◦◦| ◦| ◦| ◦◦.\n",
    "This is a string of ten symbols, 7 of which are stones and 3 of which are sticks.\n",
    "This is fantastic!",
    "Whatever two symbols we use (you might also see these called\nstars and bars or balls and bins), we can use Pascal’s triangle to count the number\nof ways to arrange them.",
    "The number of 10-bit strings of weight 3 (or weight 7) is\n\u000010\n3\n\u0001\n= 120.\n",
    "In terms of cookies, we can view this sticks and stones diagram as saying after\nhow many cookies we stop giving cookies to the first kid and start giving cookies to\nthe second kid.",
    "And then after how many do we switch to the third kid?",
    "And after\nhow many do we switch to the fourth?",
    "So\n◦◦◦| ◦| ◦| ◦◦\nmeans three cookies go to the first kid; then we switch and give one cookie to the\nsecond kid, then switch, one to the third kid, switch, two to the fourth kid.",
    "Notice\nthat we need 7 stones and 3 sticks – one stone for each cookie, and one stick for each\nswitch between kids, so one fewer sticks than there are kids (we don’t need to switch\nafter the last kid – we are done).\n",
    "While we are at it, we can also answer a related question: How many ways are\nthere to distribute 7 cookies to 4 kids so that each kid gets at least one cookie?",
    "What\ncan you say about the corresponding sticks and stones charts?",
    "The charts must start\nand end with at least one stone (so that kids A and D) get cookies, and also no two\nsticks can be adjacent (so that kids B and C are not skipped).",
    "One way to ensure\nthis is to place sticks only in the spaces between the stones.",
    "With 7 stones, there are\n6 spots between the stones, so we must choose 3 of those 6 spots to fill with bars.\n",
    "Thus there are \u00006\n3\n\u0001\nways to distribute 7 cookies to 4 kids giving at least one cookie to\neach kid.\n",
    "Another (and more general) way to approach this modified problem is to first\ngive each kid one cookie.",
    "Now the remaining 3 cookies can be distributed to the 4\nkids without restrictions.",
    "So we have 3 stones and 3 sticks for a total of 6 symbols,\n3 of which must be bars.",
    "So again we see that there are \u00006\n3\n\u0001 ways to distribute the\ncookies.\n",
    "Sticks and stones can be used in counting problems other than kids and cookies.\n",
    "Here are a few examples:\nExample 3.5.4\nYour favorite mathematical ice cream parlor offers 10 flavors.",
    "How many\nmilkshakes could you create using exactly 6, not necessarily distinct scoops?\n",
    "The order you add the flavors does not matter (they will be blended up anyway),\n\n3.5.",
    "Counting Multisets\n251\n",
    "but you are allowed repeats.",
    "So one possible shake is triple chocolate, double\ncherry, and mint chocolate chip.\n",
    "Solution.\n",
    "We get six scoops, each of which could be one of ten possible\nflavors.",
    "Represent each scoop as a star.",
    "Think of going down the counter one\nflavor at a time: You see vanilla first, and skip to the next, chocolate.",
    "You\nsay yes to chocolate three times (use three stones), then switch to the next\nflavor.",
    "You keep skipping until you get to cherry, which you say yes to twice.\n",
    "Another switch and you are at mint chocolate chip.",
    "You say yes once.",
    "Then\nyou keep switching until you get past the last flavor, never saying yes again\n(since you already have said yes six times).",
    "There are ten flavors to choose\nfrom, so we must switch from considering one flavor to the next nine times.\n",
    "These are the nine bars.\n",
    "Now that we are confident that we have the right number of sticks and\nstones, we answer the question simply: There are 6 stones and 9 bars, so 15\nsymbols.",
    "We need to pick 9 of them to be bars, so the number of milkshakes\npossible is\n\u0012\n15\n9\n\u0013\n.\n",
    "Example 3.5.5\nHow many 7 digit phone numbers are there in which the digits are non-\nincreasing?",
    "That is, every digit is less than or equal to the previous one.\nSolution.\n",
    "We need to decide on 7 digits, so we will use 7 stones.",
    "The sticks\nwill represent a switch from each possible single-digit number down to the\nnext smaller one.",
    "So the phone number 866-5221 is represented by the sticks\nand stones chart\n| ◦|| ◦◦| ◦||| ◦◦| ◦|.\n",
    "There are 10 choices for each digit (0-9), so we must switch between choices\n9 times.",
    "We have 7 stones and 9 bars, so the total number of phone numbers is\n\u0012\n16\n9\n\u0013\n.\n",
    "Example 3.5.6\nHow many integer solutions are there to the equation\n𝑥1 + 𝑥2 + 𝑥3 + 𝑥4 + 𝑥5 = 13.\n",
    "(An integer solution to an equation is a solution in which the unknown\nmust have an integer value.)\n\n252\n3.",
    "Counting\n1. where 𝑥𝑖≥0 for each 𝑥𝑖?\n2. where 𝑥𝑖> 0 for each 𝑥𝑖?\n3. where 𝑥𝑖≥2 for each 𝑥𝑖?\nSolution.\n",
    "This problem is just like giving 13 cookies to 5 kids.",
    "We need to\nsay how many of the 13 units go to each of the 5 variables.",
    "In other words, we\nhave 13 stones and 4 bars (the sticks are like the “+” signs in the equation).\n",
    "1.",
    "If 𝑥𝑖can be 0 or greater, we are in the standard case with no restrictions.\n",
    "So 13 stones and 4 sticks can be arranged in \u000017\n4\n\u0001\nways.\n",
    "2.",
    "Now each variable must be at least 1.",
    "So give one unit to each variable\nto satisfy that restriction.",
    "Now there are 8 stones left, and still 4 bars, so\nthe number of solutions is \u000012\n4\n\u0001\n.\n",
    "3.",
    "Now each variable must be 2 or greater.",
    "So before any counting, give\neach variable 2 units.",
    "We now have 3 remaining stones and 4 bars, so\nthere are \u00007\n4\n\u0001\nsolutions.\n",
    "Counting with Functions.\n",
    "Many of the counting problems in this section might at\nfirst appear to be examples of counting functions.",
    "After all, when we try to count the\nnumber of ways to distribute cookies to kids, we are assigning each cookie to a kid,\njust like you assign elements of the domain of a function to elements in the codomain.\n",
    "However, the number of ways to assign 7 cookies to 4 kids is \u000010\n7\n\u0001\n= 120, while the\nnumber of functions 𝑓: {1, 2, 3, 4, 5, 6, 7} →{𝑎, 𝑏, 𝑐, 𝑑} is 47 = 16384.",
    "What is going\non here?\n",
    "When we count functions, we consider the following two functions, for example,\nto be different:\n𝑓=\n\u0012\n1\n2\n3\n4\n5\n6\n7\n𝑎\n𝑏\n𝑐\n𝑐\n𝑐\n𝑐\n𝑐\n\u0013\n𝑔=\n\u0012\n1\n2\n3\n4\n5\n6\n7\n𝑏\n𝑎\n𝑐\n𝑐\n𝑐\n𝑐\n𝑐\n\u0013\n.\n",
    "But these two functions would correspond to the same cookie distribution: Kids 𝑎\nand 𝑏each get one cookie, and kid 𝑐gets the rest (and none for kid 𝑑).\n",
    "The point: Elements of the domain are distinguished, but cookies are indistin-\nguishable.",
    "This is analogous to the distinction between permutations (like counting\nfunctions) and combinations (not).\n",
    "3.5.4\nReading Questions\n1.\n",
    "Which of the following counting questions are NOT an example of a question\nyou would use sticks and stones to solve?\nA. How many ways can you distribute six unique gifts to three friends?\n\n",
    "3.5.",
    "Counting Multisets\n253\nB.",
    "How many ways can you distribute six identical gifts to three friends?\n",
    "C. How many different combinations of numbers can you get if you roll\nthree identical 6-side dice?\n",
    "D. How many different three-scoop milkshakes can you make when each\nscoop of ice cream can be one of six different flavors?\n",
    "2.\n",
    "When you count outcomes using sticks and stones, does order matter?",
    "Do\nyou allow repeats?",
    "What do you mean by your answers (the order of what, the\nrepeat of what)?\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "3.5.5\nPractice Problems\n1.\n",
    "A multiset is a collection of objects, just like a set, but can contain an object\nmore than once (the order of the elements still doesn’t matter).",
    "For example,\n{1, 1, 2, 5, 5, 7} is a multiset of size 6.\na.",
    "How many sets of size 9 can be made using the 10 numeric digits 0\nthrough 9?\nb.",
    "How many multisets of size 9 can be made using the 10 numeric digits 0\nthrough 9?\n2.\nUsing the digits 2 through 7, find the number of different 5-digit numbers\nsuch that:\n",
    "a. Digits cannot be repeated and must be written in increasing order.\n",
    "(Increasing means strictly increasing.",
    "For example, the digits of 134 are\nincreasing, but the digits of 133 are not.)\n",
    "b.",
    "Digits can be repeated and must be written in non-decreasing order.\n",
    "(Now the digits don’t need to be strictly increasing; 133 has digits non-\ndecreasing.)\n",
    "3.\nAfter gym class you are tasked with putting the 16 identical dodgeballs away\ninto 10 bins.\n",
    "a. How many ways can you do this if there are no restrictions?\nb.",
    "How many ways can you do this if each bin must contain at least one\ndodgeball?\n4.\nHow many integer solutions are there to the equation 𝑥+ 𝑦+ 𝑧= 12 for which\na. 𝑥, 𝑦, and 𝑧are all positive?\nb. 𝑥, 𝑦, and 𝑧are all non-negative?\nc. 𝑥, 𝑦, and 𝑧are all greater than or equal to −3.\n\n",
    "254\n3.",
    "Counting\n5.\n",
    "When playing Yahtzee, you roll five regular 6-sided dice.",
    "How many different\noutcomes are possible from a single roll?",
    "The order of the dice does not matter.\n",
    "When playing Super-Yahtzee, you roll 4 regular 10-sided dice.",
    "Now how\nany different outcomes are possible from a single roll?\n6.\nYour friend tells you she has 9 coins in her hand (just pennies, nickels, dimes,\nand quarters).",
    "If you guess how many of each kind of coin she has, she will\ngive them to you.",
    "If you guess randomly, what is the probability that you will\nbe correct?\n7.\n",
    "How many integer solutions to 𝑥1 + 𝑥2 + 𝑥3 + 𝑥4 = 35 are there for which 𝑥1 ≥4,\n𝑥2 ≥4, 𝑥3 ≥1, and 𝑥4 ≥4?\n8.\nConsider functions 𝑓: {1, 2, 3, 4, 5, 6} →{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12}.\n",
    "a. How many of these functions are strictly increasing?",
    "Explain.",
    "(A function\nis strictly increasing provided if 𝑎< 𝑏, then 𝑓(𝑎) < 𝑓(𝑏).)\nb.",
    "How many of the functions are non-decreasing?",
    "Explain.",
    "(A function is\nnon-decreasing provided if 𝑎< 𝑏, then 𝑓(𝑎) ≤𝑓(𝑏).)\n",
    "9.\nConic, your favorite math themed fast food drive-in offers 28 flavors which can\nbe added to your soda.",
    "You have enough money to buy a large soda with 7\nadded flavors.",
    "How many different soda concoctions can you order if:\n",
    "a. You refuse to use any of the flavors more than once?\nb.",
    "You refuse repeats but care about the order in which the flavors are\nadded?\n",
    "c. You allow yourself multiple shots of the same flavor?\n",
    "d.",
    "You allow yourself multiple shots, and care about the order in which the\nflavors are added?\n3.5.6\nAdditional Exercises\n1.\nEach of the counting problems below can be solved with sticks and stones.",
    "For\neach, say what outcome the diagram\n◦◦◦| ◦|| ◦◦|\nrepresents, if there are the correct number of sticks and stones for the problem.\n",
    "Otherwise, say why the diagram does not represent any outcome, and what a\ncorrect diagram would look like.\n",
    "(a) How many ways are there to select a handful of 6 jellybeans from a jar\nthat contains 5 different flavors?\n(b) How many ways can you distribute 5 identical lollipops to 6 kids?\n(c) How many 6-letter words can you make using the 5 vowels in alphabetical\norder?\n\n3.5.",
    "Counting Multisets\n255\n(d) How many solutions are there to the equation 𝑥1 + 𝑥2 + 𝑥3 + 𝑥4 = 6.\n",
    "2.\nSolve the three counting problems below.",
    "Then say why it makes sense that\nthey all have the same answer.",
    "That is, say how you can interpret them as each\nother.\n",
    "(a) How many ways are there to distribute 8 cookies to 3 kids?\n(b) How many solutions in non-negative integers are there to 𝑥+ 𝑦+ 𝑧= 8?\n(c) How many different packs of 8 crayons can you make using crayons that\ncome in red, blue, and yellow?\n3.\n",
    "We have represented multisets with sticks and stones diagrams, then counted\nthe number of sticks and stones diagrams to tell us the number of multisets.\n",
    "This is only a valid process if every multiset corresponds to exactly one sticks\nand stones diagram, and vice versa.\n(a) Clearly write down the rule for how to convert a multiset into a sticks\nand stones diagram.",
    "That is, describe the function 𝑓that takes a multiset\nas input and outputs a sticks and stones diagram.\n",
    "(b) Prove that the function 𝑓is a bĳection.",
    "That is, prove that every sticks\nand stones diagram corresponds to exactly one multiset, and vice versa.\n\n3.6\nCombinatorial Proofs\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Write counting problems that have a given answer.\n",
    "2. Write two different solutions to a counting problem.\n",
    "3. Prove binomial identities using combinatorial proofs.\n",
    "3.6.1\nSection Preview\nInvestigate!\n",
    "Look at any cell in the interior Pascal’s triangle and the six numbers that\nsurround it.",
    "For example, you might look at this cell:\n4\n6\n5\n10\n10\n15\n20\nOf the six numbers surrounding our selected cell, we will divide them\ninto two groups of three, alternating between the groups.",
    "So for this example,\nwe have a group with 4, 10, and 15, and a second group with 5, 6, and 20.\n",
    "But notice:\n4 · 10 · 15 = 600 = 5 · 6 · 20.\n",
    "Does this work no matter what center cell you pick?",
    "Why??\nOne of the coolest things about combinatorics is that you can often answer the\nsame counting question in dramatically different ways.",
    "When we recognize this\nabout a particular problem, we can often generalize the question to reveal two\ndifferent expressions that must represent the same quantity.",
    "The counting problem\nitself becomes a proof of the equality of the two expressions.",
    "This style of proof is\ncalled a combinatorial proof.\n",
    "Preview Activity\nIt is often possible to find the answer to a counting question in two different ways.\nDoing so results in two formulas that give the answer, which might look different,\n256\n\n3.6.",
    "Combinatorial Proofs\n257\nbut must be equal (since they are both the correct answer to the same question).",
    "This\nprovides a proof of the equality of the two formulas, called a combinatorial proof.\n",
    "Let’s explore a couple of examples.\n",
    "1.\nConsider the set of 7-bit strings of weight 3.",
    "That is, strings of 0s and 1s that\nare seven characters long and have exactly three 1s.",
    "How many such strings\nare there?\n(a) Give the answer as a single binomial coefficient.\n",
    "(b) Now count just those 7-bit strings of weight 3 that start with a 1.",
    "How\nmany are there?\n(c) Now count just those 7-bit strings of weight 3 that start with 01.",
    "How\nmany are there?\n(d) Now count just those 7-bit strings of weight 3 that start with 001.",
    "How\nmany are there?\n(e) Continue this process until you have counted all 7-bit strings of weight 3,\nas a sum of binomial coefficients.",
    "What is this sum?\n2.\nConsider the counting question “How many ways can you permute the letters\nof the word STATISTICS?”",
    "Note that this is not just a permutation, since there\nare repeated letters.\n",
    "(a) How many ways can you select three of the ten positions in the anagram\nto be occupied by the letter S?\n(b) How many ways can you select three of the remaining seven positions in\nthe anagram to be occupied by the letter T?\n",
    "(c) Continue with this approach until you have found an expression for the\nnumber of ways to permute the letters of STATISTICS as a product of\nbinomial coefficients.",
    "Write out this product.\n",
    "(d) Now answer the counting question again, this time starting by asking\nhow many ways you can select positions for the letter A first.",
    "Continue\nin any way you like until you have found a different expression for the\nnumber of ways to permute the letters of STATISTICS as a product of\nbinomial coefficients.",
    "Write out this product.\n",
    "(e) Try yet another approach.",
    "What is wrong with saying the answer is 10!?\n",
    "This is too large, but we can correct it by dividing to account for outcomes\nthat are equivalent.",
    "What should you divide by?\nWrite your answer as a quotient of factorials.",
    "Do you get the same answer\nas before?\n\n258\n3.",
    "Counting\n3.6.2\nPatterns in Pascal’s Triangle\nHave a look again at Pascal’s triangle.",
    "Forget for a moment where it comes from.\n",
    "Just look at it as a mathematical object.",
    "What do you notice?\n",
    "1\n1\n1\n1\n1\n1\n1\n1\n1\n2\n1\n3\n3\n1\n4\n6\n4\n1\n5\n10\n10\n5\n1\n6\n15\n20\n15\n6\n1\n7\n21\n35\n35\n21\n7\n1\nThere are lots of patterns hidden away in the triangle, enough to fill a reasonably\nsized book.",
    "Here are just a few of the most obvious ones:\n1.",
    "The entries on the border of the triangle are all 1.\n2.",
    "Any entry not on the border is the sum of the two entries above it.\n",
    "3.",
    "The triangle is symmetric.",
    "In any row, entries on the left side are mirrored on\nthe right side.\n",
    "4.",
    "The sum of all entries on a given row is a power of 2.",
    "(You should check this!)\n",
    "We would like to state these observations in a more precise way, and then prove\nthat they are correct.",
    "Now each entry in Pascal’s triangle is in fact a binomial\ncoefficient.",
    "The 1 on the very top of the triangle is \u00000\n0\n\u0001\n.",
    "The next row (which we will\ncall row 1, even though it is not the top-most row) consists of \u00001\n0\n\u0001\nand \u00001\n1\n\u0001\n.",
    "Row 4 (the\nrow 1, 4, 6, 4, 1) consists of the binomial coefficients\n\u0012\n4\n0\n\u0013 \u0012\n4\n1\n\u0013 \u0012\n4\n2\n\u0013 \u0012\n4\n3\n\u0013 \u0012\n4\n4\n\u0013\n.\n",
    "Given this description of the elements in Pascal’s triangle, we can rewrite the\nabove observations as follows:\n1. \u0000𝑛\n0\n\u0001\n= 1 and \u0000𝑛\n𝑛\n\u0001\n= 1.\n",
    "2. \u0000𝑛\n𝑘\n\u0001\n= \u0000𝑛−1\n𝑘−1\n\u0001\n+ \u0000𝑛−1\n𝑘\n\u0001\n.\n",
    "3. \u0000𝑛\n𝑘\n\u0001\n= \u0000 𝑛\n𝑛−𝑘\n\u0001\n.\n",
    "4. \u0000𝑛\n0\n\u0001\n+ \u0000𝑛\n1\n\u0001\n+ \u0000𝑛\n2\n\u0001\n+ · · · + \u0000𝑛\n𝑛\n\u0001\n= 2𝑛.\n\n3.6.",
    "Combinatorial Proofs\n259\nEach of these is an example of a binomial identity : an identity (i.e., equation)\ninvolving binomial coefficients.\n",
    "Our goal is to establish these identities.",
    "We wish to prove that they hold for all\nvalues of 𝑛and 𝑘.",
    "These proofs can be done in many ways.",
    "One option would be to\ngive algebraic proofs, using the formula for \u0000𝑛\n𝑘\n\u0001\n:\n\u0012\n𝑛\n𝑘\n\u0013\n=\n𝑛!\n(𝑛−𝑘)!",
    "𝑘!.\n",
    "Here’s how you might do that for the second identity above.\n",
    "Example 3.6.1\nGive an algebraic proof for the binomial identity\n\u0012\n𝑛\n𝑘\n\u0013\n=\n\u0012\n𝑛−1\n𝑘−1\n\u0013\n+\n\u0012\n𝑛−1\n𝑘\n\u0013\n.\nSolution.\nProof.\n",
    "By the definition of \u0000𝑛\n𝑘\n\u0001\n, we have\n\u0012\n𝑛−1\n𝑘−1\n\u0013\n=\n(𝑛−1)!\n",
    "(𝑛−1 −(𝑘−1))!(𝑘−1)!",
    "=\n(𝑛−1)!\n(𝑛−𝑘)!(𝑘−1)!\n",
    "and\n\u0012\n𝑛−1\n𝑘\n\u0013\n=\n(𝑛−1)!\n",
    "(𝑛−1 −𝑘)!𝑘!.\n",
    "Thus, starting with the right-hand side of the equation:\n\u0012\n𝑛−1\n𝑘−1\n\u0013\n+\n\u0012\n𝑛−1\n𝑘\n\u0013\n=\n(𝑛−1)!\n",
    "(𝑛−𝑘)!(𝑘−1)!",
    "+\n(𝑛−1)!\n",
    "(𝑛−1 −𝑘)!",
    "𝑘!\n= (𝑛−1)!𝑘\n(𝑛−𝑘)!",
    "𝑘!",
    "+ (𝑛−1)!(𝑛−𝑘)\n(𝑛−𝑘)!",
    "𝑘!\n",
    "= (𝑛−1)!(𝑘+ 𝑛−𝑘)\n(𝑛−𝑘)!",
    "𝑘!\n=\n𝑛!\n(𝑛−𝑘)!",
    "𝑘!\n=\n\u0012\n𝑛\n𝑘\n\u0013\n.\n",
    "The second line (where the common denominator is found) works because\n𝑘(𝑘−1)!",
    "= 𝑘!",
    "and (𝑛−𝑘)(𝑛−𝑘−1)!",
    "= (𝑛−𝑘)!.\n",
    "■\nThis is certainly a valid proof but also is entirely useless.",
    "Even if you understand\nthe proof perfectly, it does not tell you why the identity is true.",
    "A better approach\n\n260\n3.",
    "Counting\nwould be to explain what \u0000𝑛\n𝑘\n\u0001\nmeans and then say why that is also what \u0000𝑛−1\n𝑘−1\n\u0001\n+ \u0000𝑛−1\n𝑘\n\u0001\nmeans.",
    "Let’s see how this works for the four identities we observed above.\n",
    "Example 3.6.2\nExplain why \u0000𝑛\n0\n\u0001\n= 1 and \u0000𝑛\n𝑛\n\u0001\n= 1.\nSolution.\n",
    "What do these binomial coefficients tell us?",
    "Well, \u0000𝑛\n0\n\u0001 gives the\nnumber of ways to select 0 objects from a collection of 𝑛objects.",
    "There is\nonly one way to do this, namely to not select any of the objects.",
    "Thus \u0000𝑛\n0\n\u0001\n= 1.\nSimilarly, \u0000𝑛\n𝑛\n\u0001\ngives the number of ways to select 𝑛objects from a collection of\n𝑛objects.",
    "There is only one way to do this: Select all 𝑛objects.",
    "Thus \u0000𝑛\n𝑛\n\u0001\n= 1.\nAlternatively, we know that \u0000𝑛\n0\n\u0001\nis the number of 𝑛-bit strings with weight\n0.",
    "There is only one such string, the string of all 0’s.",
    "So \u0000𝑛\n0\n\u0001\n= 1.",
    "Similarly \u0000𝑛\n𝑛\n\u0001\nis the number of 𝑛-bit strings with weight 𝑛. There is only one string with\nthis property, the string of all 1’s.\n",
    "Another way: \u0000𝑛\n0\n\u0001\ngives the number of subsets of a set of size 𝑛containing\n0 elements.",
    "There is only one such subset, the empty set.",
    "\u0000𝑛\n𝑛\n\u0001\ngives the number\nof subsets containing 𝑛elements.",
    "The only such subset is the original set (of\nall elements).\n",
    "Example 3.6.3\nExplain why \u0000𝑛\n𝑘\n\u0001\n= \u0000𝑛−1\n𝑘−1\n\u0001\n+ \u0000𝑛−1\n𝑘\n\u0001\n.\n",
    "Solution.\n",
    "The easiest way to see this is to consider bit strings.",
    "\u0000𝑛\n𝑘\n\u0001 is the\nnumber of bit strings of length 𝑛containing 𝑘1’s.",
    "Of all of these strings, some\nstart with a 1 and the rest start with a 0.",
    "First consider all the bit strings which\nstart with a 1.",
    "After the 1, there must be 𝑛−1 more bits (to get the total length\nup to 𝑛) and exactly 𝑘−1 of them must be 1’s (as we already have one, and we\nneed 𝑘total).",
    "How many strings are there like that?",
    "There are exactly \u0000𝑛−1\n𝑘−1\n\u0001\nsuch bit strings, so of all the length 𝑛bit strings containing 𝑘1’s, \u0000𝑛−1\n𝑘−1\n\u0001\nof them\nstart with a 1.",
    "Similarly, there are \u0000𝑛−1\n𝑘\n\u0001 which start with a 0 (we still need\n𝑛−1 bits and now 𝑘of them must be 1’s).",
    "Since there are \u0000𝑛−1\n𝑘\n\u0001 bit strings\ncontaining 𝑛−1 bits with 𝑘1’s, that is the number of length 𝑛bit strings with\n𝑘1’s which start with a 0.",
    "Therefore \u0000𝑛\n𝑘\n\u0001\n= \u0000𝑛−1\n𝑘−1\n\u0001\n+ \u0000𝑛−1\n𝑘\n\u0001\n.\n",
    "Another way: Consider the question, how many ways can you select 𝑘\npizza toppings from a menu containing 𝑛choices?",
    "One way to do this is just\n\u0000𝑛\n𝑘\n\u0001. Another way to answer the same question is to first decide whether or\nnot you want anchovies.",
    "If you do want anchovies, you still need to pick\n𝑘−1 toppings, now from just 𝑛−1 choices.",
    "That can be done in \u0000𝑛−1\n𝑘−1\n\u0001 ways.\n",
    "If you do not want anchovies, then you still need to select 𝑘toppings from\n𝑛−1 choices (the anchovies are out).",
    "You can do that in \u0000𝑛−1\n𝑘\n\u0001\nways.",
    "Since the\nchoices with anchovies are disjoint from the choices without anchovies, the\ntotal choices are \u0000𝑛−1\n𝑘−1\n\u0001\n+ \u0000𝑛−1\n𝑘\n\u0001\n.",
    "But wait.",
    "We answered the same question in two\n\n3.6.",
    "Combinatorial Proofs\n261\ndifferent ways, so the two answers must be the same.",
    "Thus \u0000𝑛\n𝑘\n\u0001\n= \u0000𝑛−1\n𝑘−1\n\u0001\n+ \u0000𝑛−1\n𝑘\n\u0001\n.\n",
    "You can also explain (prove) this identity by counting subsets, or even\nlattice paths.\n",
    "Example 3.6.4\nProve the binomial identity \u0000𝑛\n𝑘\n\u0001\n= \u0000 𝑛\n𝑛−𝑘\n\u0001\n.\nSolution.\n",
    "Why is this true?",
    "\u0000𝑛\n𝑘\n\u0001\ncounts the number of ways to select 𝑘things\nfrom 𝑛choices.",
    "On the other hand, \u0000 𝑛\n𝑛−𝑘\n\u0001\ncounts the number of ways to select\n𝑛−𝑘things from 𝑛choices.",
    "Are these really the same?",
    "Well, what if instead\nof selecting the 𝑛−𝑘things you choose to exclude them.",
    "How many ways are\nthere to choose 𝑛−𝑘things to exclude from 𝑛choices?",
    "Clearly this is \u0000 𝑛\n𝑛−𝑘\n\u0001\nas\nwell (it doesn’t matter whether you include or exclude the things once you\nhave chosen them).",
    "And if you exclude 𝑛−𝑘things, then you are including\nthe other 𝑘things.",
    "So the set of outcomes should be the same.\n",
    "Let’s try the pizza counting example like we did above.",
    "How many ways\nare there to pick 𝑘toppings from a list of 𝑛choices?",
    "On the one hand, the\nanswer is simply \u0000𝑛\n𝑘\n\u0001\n.",
    "Alternatively, you could make a list of all the toppings\nyou don’t want.",
    "To end up with a pizza containing exactly 𝑘toppings, you\nneed to pick 𝑛−𝑘toppings to not put on the pizza.",
    "You have \u0000 𝑛\n𝑛−𝑘\n\u0001 choices\nfor the toppings you don’t want.",
    "Both of these ways give you a pizza with 𝑘\ntoppings, in fact all the ways to get a pizza with 𝑘toppings.",
    "Thus these two\nanswers must be the same: \u0000𝑛\n𝑘\n\u0001\n= \u0000 𝑛\n𝑛−𝑘\n\u0001\n.\n",
    "You can also prove (explain) this identity using bit strings, subsets, or\nlattice paths.",
    "The bit string argument is nice: \u0000𝑛\n𝑘\n\u0001 counts the number of bit\nstrings of length 𝑛with 𝑘1’s.",
    "This is also the number of bit strings of length\n𝑛with 𝑘0’s (just replace each 1 with a 0 and each 0 with a 1).",
    "But if a string of\nlength 𝑛has 𝑘0’s, it must have 𝑛−𝑘1’s.",
    "And there are exactly \u0000 𝑛\n𝑛−𝑘\n\u0001\nstrings\nof length 𝑛with 𝑛−𝑘1’s.\n",
    "Example 3.6.5\nProve the binomial identity \u0000𝑛\n0\n\u0001\n+ \u0000𝑛\n1\n\u0001\n+ \u0000𝑛\n2\n\u0001\n+ · · ·",
    "+ \u0000𝑛\n𝑛\n\u0001\n= 2𝑛.\nSolution.\n",
    "Let’s do a “pizza proof” again.",
    "We need to find a question about\npizza toppings which has 2𝑛as the answer.",
    "How about this: If a pizza joint\noffers 𝑛toppings, how many pizzas can you build using any number of\ntoppings from no toppings to all toppings, using each topping at most once?\n",
    "On one hand, the answer is 2𝑛. For each topping, you can say “yes” or\n“no,” so you have two choices for each topping.\n",
    "On the other hand, divide the possible pizzas into disjoint groups: the\npizzas with no toppings, the pizzas with one topping, the pizzas with two\n\n262\n3.",
    "Counting\ntoppings, etc.",
    "If we want no toppings, there is only one pizza like that (the\nempty pizza, if you will), but it would be better to think of that number as \u0000𝑛\n0\n\u0001\nsince we choose 0 of the 𝑛toppings.",
    "How many pizzas have 1 topping?",
    "We\nneed to choose 1 of the 𝑛toppings, so \u0000𝑛\n1\n\u0001\n.",
    "We have:\n• Pizzas with 0 toppings: \u0000𝑛\n0\n\u0001\n• Pizzas with 1 topping: \u0000𝑛\n1\n\u0001\n• Pizzas with 2 toppings: \u0000𝑛\n2\n\u0001\n• ...\n",
    "• Pizzas with 𝑛toppings: \u0000𝑛\n𝑛\n\u0001\n.\n",
    "The total number of possible pizzas will be the sum of these, which is\nexactly the left-hand side of the identity we are trying to prove.\n",
    "Again, we could have proved the identity using subsets, bit strings, or\nlattice paths (although the lattice path argument is a little tricky).\n",
    "Hopefully this gives some idea of how explanatory proofs of binomial identities\ncan go.",
    "It is worth pointing out that more traditional proofs can also be beautiful.4\nFor example, consider the following rather slick proof of the last identity.\n",
    "Expand the binomial (𝑥+ 𝑦)𝑛:\n(𝑥+ 𝑦)𝑛=\n\u0012\n𝑛\n0\n\u0013\n𝑥𝑛+\n\u0012\n𝑛\n1\n\u0013\n𝑥𝑛−1𝑦+\n\u0012\n𝑛\n2\n\u0013\n𝑥𝑛−2𝑦2 + · · · +\n\u0012\n𝑛\n𝑛−1\n\u0013\n𝑥· 𝑦𝑛−1 +\n\u0012\n𝑛\n𝑛\n\u0013\n𝑦𝑛.\nLet 𝑥= 1 and 𝑦= 1.",
    "We get:\n(1 + 1)𝑛=\n\u0012\n𝑛\n0\n\u0013\n1𝑛+\n\u0012\n𝑛\n1\n\u0013\n1𝑛−11 +\n\u0012\n𝑛\n2\n\u0013\n1𝑛−212 + · · · +\n\u0012\n𝑛\n𝑛−1\n\u0013\n1 · 1𝑛−1 +\n\u0012\n𝑛\n𝑛\n\u0013\n1𝑛.\nOf course this simplifies to:\n(2)𝑛=\n\u0012\n𝑛\n0\n\u0013\n+\n\u0012\n𝑛\n1\n\u0013\n+\n\u0012\n𝑛\n2\n\u0013\n+ · · · +\n\u0012\n𝑛\n𝑛−1\n\u0013\n+\n\u0012\n𝑛\n𝑛\n\u0013\n.\n",
    "Something fun to try: Let 𝑥= 1 and 𝑦= 2.",
    "Neat huh?\n3.6.3\nMore Proofs\nThe explanatory proofs given in the above examples are typically called combina-\ntorial proofs.",
    "In general, to give a combinatorial proof for a binomial identity, say\n𝐴= 𝐵, you do the following:\n4Most every binomial identity can be proved using mathematical induction, using the recursive\ndefinition for \u0000𝑛\n𝑘\n\u0001\n.",
    "We will discuss induction in Section 4.5.\n\n3.6.",
    "Combinatorial Proofs\n263\n1.",
    "Find a counting problem you will be able to answer in two ways.\n",
    "2. Explain why one answer to the counting problem is 𝐴.\n3.",
    "Explain why the other answer to the counting problem is 𝐵.\nSince both 𝐴and 𝐵are the answers to the same question, we must have 𝐴= 𝐵.\n",
    "The tricky thing is coming up with the question.",
    "This is not always obvious, but\nit gets easier the more counting problems you solve.",
    "You will start to recognize\ntypes of answers as the answers to types of questions.",
    "More often what will happen\nis that you will be solving a counting problem and happen to think up two different\nways of finding the answer.",
    "Now you have a binomial identity, and the proof is right\nthere.",
    "The proof is the problem you just solved together with your two solutions.\n",
    "For example, consider this counting question:\nHow many 10-letter words use exactly four A’s, three B’s, two C’s, and\none D?\n",
    "Let’s try to solve this problem.",
    "We have 10 spots for letters to go.",
    "Four of those need\nto be A’s.",
    "We can pick the four A-spots in \u000010\n4\n\u0001\nways.",
    "Now where can we put the B’s?\n",
    "Well there are only 6 spots left; we need to pick 3 of them.",
    "This can be done in \u00006\n3\n\u0001\nways.",
    "The two C’s need to go in two of the 3 remaining spots, so we have \u00003\n2\n\u0001\nways of\ndoing that.",
    "That leaves just one spot of the D, but we could write that 1 choice as \u00001\n1\n\u0001\n.\n",
    "Thus the answer is:\n\u0012\n10\n4\n\u0013 \u0012\n6\n3\n\u0013 \u0012\n3\n2\n\u0013 \u0012\n1\n1\n\u0013\n.\n",
    "But why stop there?",
    "We can find the answer another way too.",
    "First let’s decide\nwhere to put the one D: we have 10 spots and we need to choose 1 of them, so this\ncan be done in \u000010\n1\n\u0001\nways.",
    "Next, choose one of the \u00009\n2\n\u0001\nways to place the two C’s.",
    "We\nnow have 7 spots left, and three of them need to be filled with B’s.",
    "There are \u00007\n3\n\u0001\nways\nto do this.",
    "Finally the A’s can be placed in \u00004\n4\n\u0001 (that is, only one) ways.",
    "So another\nanswer to the question is\n\u0012\n10\n1\n\u0013 \u0012\n9\n2\n\u0013 \u0012\n7\n3\n\u0013 \u0012\n4\n4\n\u0013\n.\n",
    "Interesting.",
    "This gives us the binomial identity:\n\u0012\n10\n4\n\u0013 \u0012\n6\n3\n\u0013 \u0012\n3\n2\n\u0013 \u0012\n1\n1\n\u0013\n=\n\u0012\n10\n1\n\u0013 \u0012\n9\n2\n\u0013 \u0012\n7\n3\n\u0013 \u0012\n4\n4\n\u0013\n.\n",
    "Here are a couple more binomial identities with combinatorial proofs.\n\n",
    "264\n3.",
    "Counting\nExample 3.6.6\nProve the identity\n1𝑛+ 2(𝑛−1) + 3(𝑛−2) + · · · + (𝑛−1)2 + 𝑛1 =\n\u0012\n𝑛+ 2\n3\n\u0013\n.\nSolution.\n",
    "To give a combinatorial proof we need to think up a question\nwe can answer in two ways: one way needs to give the left-hand side of the\nidentity, and the other way needs to be the right-hand side of the identity.\n",
    "Our clue to what question to ask comes from the right-hand side: \u0000𝑛+2\n3\n\u0001\ncounts\nthe number of ways to select 3 things from a group of 𝑛+ 2 things.",
    "Let’s\nname those things 1, 2, 3, . . .",
    ", 𝑛+ 2.",
    "In other words, we want to find 3-element\nsubsets of those numbers (since order should not matter, subsets are exactly\nthe right thing to think about).",
    "We will have to be a bit clever to explain why\nthe left-hand side also gives the number of these subsets.",
    "Here’s the proof.\n",
    "Proof.\nConsider the question “How many 3-element subsets are there of the\nset {1, 2, 3, . . .",
    ", 𝑛+ 2}?”",
    "We answer this in two ways:\nAnswer 1: We must select 3 elements from the collection of 𝑛+ 2 elements.\n",
    "This can be done in \u0000𝑛+2\n3\n\u0001\nways.\n",
    "Answer 2: Break this problem up into cases by what the middle number\nin the subset is.",
    "Say each subset is {𝑎, 𝑏, 𝑐} written in increasing order.",
    "We\ncount the number of subsets for each distinct value of 𝑏.",
    "The smallest possible\nvalue of 𝑏is 2, and the largest is 𝑛+ 1.\n",
    "When 𝑏= 2, there are 1 · 𝑛subsets: 1 choice for 𝑎and 𝑛choices (3 through\n𝑛+ 2) for 𝑐.\n",
    "When 𝑏= 3, there are 2 · (𝑛−1) subsets: 2 choices for 𝑎and 𝑛−1 choices\nfor 𝑐.\n",
    "When 𝑏= 4, there are 3 · (𝑛−2) subsets: 3 choices for 𝑎and 𝑛−2 choices\nfor 𝑐.\nAnd so on.",
    "When 𝑏= 𝑛+ 1, there are 𝑛choices for 𝑎and only 1 choice for\n𝑐, so 𝑛· 1 subsets.\n",
    "Therefore the total number of subsets is\n1𝑛+ 2(𝑛−1) + 3(𝑛−2) + · · · + (𝑛−1)2 + 𝑛1.\n",
    "Since Answer 1 and Answer 2 are answers to the same question, they must\nbe equal.",
    "Therefore\n1𝑛+ 2(𝑛−1) + 3(𝑛−2) + · · · + (𝑛−1)2 + 𝑛1 =\n\u0012\n𝑛+ 2\n3\n\u0013\n.\n",
    "■\n\n3.6.",
    "Combinatorial Proofs\n265\nExample 3.6.7\nProve the binomial identity\n\u0012\n𝑛\n0\n\u00132\n+\n\u0012\n𝑛\n1\n\u00132\n+\n\u0012\n𝑛\n2\n\u00132\n+ · · · +\n\u0012\n𝑛\n𝑛\n\u00132\n=\n\u0012\n2𝑛\n𝑛\n\u0013\n.\n",
    "Solution.\n",
    "We will give two different proofs of this fact.",
    "The first will be very\nsimilar to the previous example (counting subsets).",
    "The second proof is a\nlittle slicker, using lattice paths.\n",
    "Proof.\nConsider the question: “How many pizzas can you make using 𝑛\ntoppings when there are 2𝑛toppings to choose from?”\nAnswer 1: There are 2𝑛toppings, from which you must choose 𝑛. This\ncan be done in \u00002𝑛\n𝑛\n\u0001\nways.\n",
    "Answer 2: Divide the toppings into two groups of 𝑛toppings (perhaps 𝑛\nmeats and 𝑛veggies).",
    "Any choice of 𝑛toppings must include some number\nfrom the first group and some number from the second group.",
    "Consider each\npossible number of meat toppings separately:\n0",
    "meats: \u0000𝑛\n0\n\u0001 \u0000𝑛\n𝑛\n\u0001, since you need to choose 0 of the 𝑛meats and 𝑛of the 𝑛\nveggies.\n",
    "1 meat: \u0000𝑛\n1\n\u0001 \u0000 𝑛\n𝑛−1\n\u0001\n, since you need 1 of 𝑛meats so 𝑛−1 of 𝑛veggies.\n",
    "2 meats: \u0000𝑛\n2\n\u0001 \u0000 𝑛\n𝑛−2\n\u0001\n.",
    "Choose 2 meats and the remaining 𝑛−2 toppings from\nthe 𝑛veggies.\n",
    "And so on.",
    "The last case is 𝑛meats, which can be done in \u0000𝑛\n𝑛\n\u0001 \u0000𝑛\n0\n\u0001\nways.\n",
    "Thus the total number of pizzas possible is\n\u0012\n𝑛\n0\n\u0013 \u0012\n𝑛\n𝑛\n\u0013\n+\n\u0012\n𝑛\n1\n\u0013 \u0012\n𝑛\n𝑛−1\n\u0013\n+\n\u0012\n𝑛\n2\n\u0013 \u0012\n𝑛\n𝑛−2\n\u0013\n+ · · · +\n\u0012\n𝑛\n𝑛\n\u0013 \u0012\n𝑛\n0\n\u0013\n.\n",
    "This is not quite the left-hand side . .",
    ".\n",
    "yet.",
    "Notice that \u0000𝑛\n𝑛\n\u0001\n= \u0000𝑛\n0\n\u0001 and\n\u0000 𝑛\n𝑛−1\n\u0001\n= \u0000𝑛\n1\n\u0001\nand so on, by the identity in Example 3.6.4.",
    "Thus we do indeed get\n\u0012\n𝑛\n0\n\u00132\n+\n\u0012\n𝑛\n1\n\u00132\n+\n\u0012\n𝑛\n2\n\u00132\n+ · · · +\n\u0012\n𝑛\n𝑛\n\u00132\n.\n",
    "Since these two answers are answers to the same question, they must be\nequal, and thus\n\u0012\n𝑛\n0\n\u00132\n+\n\u0012\n𝑛\n1\n\u00132\n+\n\u0012\n𝑛\n2\n\u00132\n+ · · · +\n\u0012\n𝑛\n𝑛\n\u00132\n=\n\u0012\n2𝑛\n𝑛\n\u0013\n.\n",
    "■\nFor an alternative proof, we use lattice paths.",
    "This is reasonable to consider\nbecause the right-hand side of the identity reminds us of the number of paths\nfrom (0, 0) to (𝑛, 𝑛).\n\n",
    "266\n3.",
    "Counting\nProof.\nConsider the question: How many lattice paths are there from (0, 0)\nto (𝑛, 𝑛)?\n",
    "Answer 1: We must travel 2𝑛steps, and 𝑛of them must be in the up\ndirection.",
    "Thus there are \u00002𝑛\n𝑛\n\u0001\npaths.\n",
    "Answer 2: Note that any path from (0, 0) to (𝑛, 𝑛) must cross the line\n𝑥+ 𝑦= 𝑛. That is, any path must pass through exactly one of the points:\n(0, 𝑛), (1, 𝑛−1), (2, 𝑛−2), . . .",
    ", (𝑛, 0).",
    "For example, this is what happens in the\ncase 𝑛= 4:\n(0,0)\n(4,4)\n𝑥+ 𝑦= 4\n(0,4)\n(1,3)\n(2,2)\n(3,1)\n(4,0)\n",
    "How many paths pass through (0, 𝑛)?",
    "To get to that point, you must travel\n𝑛units, and 0 of them are to the right, so there are \u0000𝑛\n0\n\u0001 ways to get to (0, 𝑛).\n",
    "From (0, 𝑛) to (𝑛, 𝑛) takes 𝑛steps, and 0 of them are up.",
    "So there are \u0000𝑛\n0\n\u0001\nways\nto get from (0, 𝑛) to (𝑛, 𝑛).",
    "Therefore there are \u0000𝑛\n0\n\u0001 \u0000𝑛\n0\n\u0001\npaths from (0, 0) to (𝑛, 𝑛)\nthrough the point (0, 𝑛) .\n",
    "What about through (1, 𝑛−1)?",
    "There are \u0000𝑛\n1\n\u0001\npaths to get there (𝑛steps, 1\nto the right) and \u0000𝑛\n1\n\u0001\npaths to complete the journey to (𝑛, 𝑛) (𝑛steps, 1 up).",
    "So\nthere are \u0000𝑛\n1\n\u0001 \u0000𝑛\n1\n\u0001\npaths from (0, 0) to (𝑛, 𝑛) through (1, 𝑛−1).\n",
    "In general, to get to (𝑛, 𝑛) through the point (𝑘, 𝑛−𝑘) we have \u0000𝑛\n𝑘\n\u0001 paths\nto the midpoint and then \u0000𝑛\n𝑘\n\u0001\npaths from the midpoint to (𝑛, 𝑛).",
    "So there are\n\u0000𝑛\n𝑘\n\u0001 \u0000𝑛\n𝑘\n\u0001\npaths from (0, 0) to (𝑛, 𝑛) through (𝑘, 𝑛−𝑘).\n",
    "All together then, the total paths from (0, 0) to (𝑛, 𝑛) passing through\nexactly one of these midpoints is\n\u0012\n𝑛\n0\n\u00132\n+\n\u0012\n𝑛\n1\n\u00132\n+\n\u0012\n𝑛\n2\n\u00132\n+ · · · +\n\u0012\n𝑛\n𝑛\n\u00132\n.\n",
    "Since these two answers are answers to the same question, they must be\nequal, and thus\n\u0012\n𝑛\n0\n\u00132\n+\n\u0012\n𝑛\n1\n\u00132\n+\n\u0012\n𝑛\n2\n\u00132\n+ · · · +\n\u0012\n𝑛\n𝑛\n\u00132\n=\n\u0012\n2𝑛\n𝑛\n\u0013\n.\n",
    "■\n\n3.6.",
    "Combinatorial Proofs\n267\n3.6.4\nReading Questions\n1.\n",
    "Which of the following describes the overall strategy for a combinatorial proof?\n",
    "A. Ask a counting question that can be answered in two ways (and answer\nit).\n",
    "B. Ask two counting questions that can both be answered in the same way\n(and answer the questions).\n",
    "C. Simplify the algebraic expressions for each side of the combinatorial\nidentity.\n",
    "D. Assume the identity fails to hold for some smallest value, and get a\ncontradiction by looking at a smaller value.\n",
    "2.\nWrite a counting question that you could use to establish the identity:\n\u0012\n𝑥+ 𝑦\n𝑥\n\u0013\n=\n\u0012\n𝑥+ 𝑦\n𝑦\n\u0013\n.\n",
    "3.\n",
    "What questions do you have after reading this section?",
    "Write at least one\nquestion about the content of this section that you are curious about.\n",
    "3.6.5\nPractice Problems\n1.\nCreate a combinatorial proof of the identity 10 + 10 = 2 · 10.\n•\nEither:\nConsider the question, “How many two-digit numbers start with a\n3 or 4?”\nOr:\nConsider the question, “How many 2-topping pizzas can you make\nchoosing from 10 toppings?”\n• The first way to answer this is 10 + 10.\n",
    "•\n",
    "Either:\nThis is because there are 10 numbers that start with 3, and another\n10 that start with 4.\nOr:\nThis is because there are 10 choices for the first topping, and 10\nchoices for the second topping.\n",
    "•",
    "A second answer to the question is 2 · 10.\n•\n",
    "Either:\nThis is because you have 2 choices for the first digit, and 10 choices\nfor the second digit.\n\n",
    "268\n3.",
    "Counting\nOr:\n",
    "This is because you must either choose 2 identical toppings or two\ndifferent toppings.\n",
    "• Since both expressions answer the same question, they must be equal.\n",
    "Therefore 10 + 10 = 2 · 10.\n2.\n",
    "If you were asked to give a combinatorial proof of the identity \u0000𝑛\n2\n\u0001 \u0000𝑛−2\n𝑘\n\u0001\n=\n\u0000𝑛\n𝑘\n\u0001 \u0000𝑛−𝑘\n2\n\u0001\n, which of the following would be reasonable questions to use?\nA. How many ways can you select 2 flavors of ice cream from 𝑛choices and\n𝑘toppings for your sundae?\n",
    "B. How many ways can you select 𝑘bow ties to pack in your checked bag\nand 2 more bow ties to pack in your carry-on, from a collection of 𝑛bow\nties?\n",
    "C. There are 𝑛students in Math Club.",
    "How many ways can you pick a\nsubset of size 2 or 𝑘that will run your fall fundraiser?\n",
    "D. From a class of 𝑛students, how many ways can you select 2 to be prefects\nand another 𝑘to be on the party planning committee?\n3.6.6\nAdditional Exercises\n1.\nGive a combinatorial proof of the identity 2 + 2 + 2 = 3 · 2.\n2.\n",
    "Suppose you own 𝑥fezzes and 𝑦bow ties.",
    "Of course, 𝑥and 𝑦are both greater\nthan 1.\n(a) How many combinations of fez and bow tie can you make?",
    "You can wear\nonly one fez and one bow tie at a time.",
    "Explain.\n",
    "(b) Explain why the answer is also \u0000𝑥+𝑦\n",
    "2\n\u0001\n−\u0000𝑥\n2\n\u0001\n−\u0000𝑦\n2\n\u0001. (If this is what you\nclaimed the answer was in part (a), try it again.)\n",
    "(c) Use your answers to parts (a) and (b) to give a combinatorial proof of the\nidentity\n\u0012\n𝑥+ 𝑦\n2\n\u0013\n−\n\u0012\n𝑥\n2\n\u0013\n−\n\u0012\n𝑦\n2\n\u0013\n= 𝑥𝑦.\n3.\nHow many triangles can you draw using the dots below as vertices?\n(a) Find an expression for the answer which is the sum of three terms\n\n3.6.",
    "Combinatorial Proofs\n269\ninvolving binomial coefficients.\n",
    "(b) Find an expression for the answer which is the difference of two binomial\ncoefficients.\n",
    "(c) Generalize the above to state and prove a binomial identity using a\ncombinatorial proof.",
    "Say you have 𝑥points on the horizontal axis and 𝑦\npoints in the semi-circle.\n",
    "4.\nConsider all the triangles you can create using the points shown below as\nvertices.",
    "Note that we are not allowing degenerate triangles (ones with all three\nvertices on the same line), but we do allow non-right triangles.\n",
    "(a) Find the number of triangles, and explain why your answer is correct.\n",
    "(b) Find the number of triangles again, using a different method.",
    "Explain\nwhy your new method works.\n",
    "(c) State a binomial identity that your two answers above establish (that is,\ngive the binomial identity that your two answers are a proof for).",
    "Then\ngeneralize this using 𝑚’s and 𝑛’s.\n5.\n",
    "A woman is getting married.",
    "She has 15 best friends but can only select 6 of\nthem to be her bridesmaids, one of which needs to be her maid of honor.",
    "How\nmany ways can she do this?\n(a)",
    "What if she first selects the 6 bridesmaids, and then selects one of them\nto be the maid of honor?\n(b)",
    "What if she first selects her maid of honor, and then 5 other bridesmaids?\n(c) Explain why 6\u000015\n6\n\u0001\n= 15\u000014\n5\n\u0001\n.\n",
    "6.\nConsider the identity:\n𝑘\n\u0012\n𝑛\n𝑘\n\u0013\n= 𝑛\n\u0012\n𝑛−1\n𝑘−1\n\u0013\n.\n",
    "(a) Is this true?",
    "Try it for a few values of 𝑛and 𝑘.\n(b) Use the formula for \u0000𝑛\n𝑘\n\u0001\nto give an algebraic proof of the identity.\n\n",
    "270\n3.",
    "Counting\n(c) Give a combinatorial proof of the identity.\n",
    "7.\nGive a combinatorial proof of the identity \u0000𝑛\n2\n\u0001 \u0000𝑛−2\n𝑘−2\n\u0001\n= \u0000𝑛\n𝑘\n\u0001 \u0000𝑘\n2\n\u0001\n.\n8.\nConsider the binomial identity\n\u0012\n𝑛\n1\n\u0013\n+ 2\n\u0012\n𝑛\n2\n\u0013\n",
    "+ 3\n\u0012\n𝑛\n3\n\u0013\n",
    "+ · · ·",
    "+ 𝑛\n\u0012\n𝑛\n𝑛\n\u0013\n= 𝑛2𝑛−1.\n",
    "(a) Give a combinatorial proof of this identity.",
    "Hint: What if some number\nof a group of 𝑛people wanted to go to an escape room, and among those\ngoing, one needed to be the team captain?\n(b) Give an alternate proof by multiplying out (1 + 𝑥)𝑛and taking derivatives\nof both sides.\n",
    "9.\nGive a combinatorial proof for the identity 1 + 2 + 3 + · · · + 𝑛= \u0000𝑛+1\n2\n\u0001\n.\n10.\nConsider the bit strings in B6\n2 (bit strings of length 6 and weight 2).\n",
    "(a) How many of those bit strings start with 1?\n(b) How many of those bit strings start with 01?\n(c) How many of those bit strings start with 001?\n(d) Are there any other strings we have not counted yet?",
    "Which ones, and\nhow many are there?\n(e) How many bit strings are there total in B6\n2?\n(f)",
    "What binomial identity have you just given a combinatorial proof for?\n11.\n",
    "Let’s count ternary digit strings, that is, strings in which each digit can be 0, 1,\nor 2.\n(a) How many ternary digit strings contain exactly 𝑛digits?\n(b) How many ternary digit strings contain exactly 𝑛digits and 𝑛2’s.\n",
    "(c) How many ternary digit strings contain exactly 𝑛digits and 𝑛−1 2’s.\n",
    "(Hint: Where can you put the non-2 digit, and then what could it be?)\n",
    "(d) How many ternary digit strings contain exactly 𝑛digits and 𝑛−2 2’s.\n",
    "(Hint: See previous hint.)\n(e) How many ternary digit strings contain exactly 𝑛digits and 𝑛−𝑘2’s.\n(f) How many ternary digit strings contain exactly 𝑛digits and no 2’s.",
    "(Hint:\nWhat kind of a string is this?)\n\n3.6.",
    "Combinatorial Proofs\n271\n(g) Use the above parts to give a combinatorial proof for the identity\n\u0012\n𝑛\n0\n\u0013\n",
    "+ 2\n\u0012\n𝑛\n1\n\u0013\n",
    "+ 22\n\u0012\n𝑛\n2\n\u0013\n+ 23\n\u0012\n𝑛\n3\n\u0013\n+ · · · + 2𝑛\n\u0012\n𝑛\n𝑛\n\u0013\n= 3𝑛.\n12.\n",
    "How many ways are there to rearrange the letters in the word “rearrange”?\n",
    "Answer this question in at least two different ways to establish a binomial\nidentity.\n",
    "13.\nEstablish the identity below using a combinatorial proof.\n",
    "\u0012\n2\n2\n\u0013 \u0012\n𝑛\n2\n\u0013\n+\n\u0012\n3\n2\n\u0013 \u0012\n𝑛−1\n2\n\u0013\n+\n\u0012\n4\n2\n\u0013 \u0012\n𝑛−2\n2\n\u0013\n+ · · · +\n\u0012\n𝑛\n2\n\u0013 \u0012\n2\n2\n\u0013\n=\n\u0012\n𝑛+ 3\n5\n\u0013\n.\n",
    "14.\n",
    "In Example 3.6.5 we established that the sum of any row in Pascal’s triangle is\na power of two.",
    "Specifically,\n\u0012\n𝑛\n0\n\u0013\n+\n\u0012\n𝑛\n1\n\u0013\n+\n\u0012\n𝑛\n2\n\u0013\n+ · · · +\n\u0012\n𝑛\n𝑛\n\u0013\n= 2𝑛.\n",
    "The argument given there used the counting question, “How many pizzas can\nyou build using any number of 𝑛different toppings?”",
    "To practice, give new\nproofs of this identity using different questions.\n",
    "(a) Use a question about counting subsets.\n",
    "(b) Use a question about counting bit strings.\n",
    "(c) Use a question about counting lattice paths.\n",
    "15.\n(a) The Stanley Cup is decided in a best of 7 tournament between two teams.\n",
    "In how many ways can your team win?",
    "Let’s answer this question two\nways:\ni. How many of the 7 games does your team need to win?",
    "How many\nways can this happen?\nii.",
    "What if the tournament goes all 7 games?",
    "So you win the last game.\n",
    "How many ways can the first 6 games go down?\n",
    "iii.",
    "What if the tournament goes just 6 games?",
    "How many ways can\nthis happen?",
    "What about 5 games?",
    "4 games?\niv.",
    "What are the two different ways to compute the number of ways\nyour team can win?",
    "Write down an equation involving binomial\ncoefficients (that is, \u0000𝑛\n𝑘\n\u0001’s).",
    "What pattern in Pascal’s triangle is this\nan example of?\n(b) Generalize.\n",
    "What if the rules changed, and you played a best of 9\ntournament (5 wins required)?",
    "What if you played an 𝑛game tournament\nwith 𝑘wins required to be named champion?\n\n272\n3.",
    "Counting\n16.\nLet 𝑘1, 𝑘2, . . .",
    ", 𝑘𝑗be a list of positive integers that sum to 𝑛(i.e.",
    ", Í𝑗\n𝑖=1 𝑘𝑖= 𝑛).\n",
    "Use two graphs containing 𝑛vertices to explain why\n𝑗Õ\n𝑖=1\n\u0012\n𝑘𝑖\n2\n\u0013\n≤\n\u0012\n𝑛\n2\n\u0013\n.\n\n",
    "3.7\nApplications to Probability\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1.",
    "Use counting techniques to compute probabilities of events.\n",
    "2. Understand the basic rules of probability.\n",
    "3.",
    "Compute probabilities of compound events, both independent and\ndependent.\n",
    "3.7.1\nSection Preview\nInvestigate!\nSuppose you, like the 17th-century French nobleman Chevalier de Mere,\nliked gambling on the outcome of rolling fair 6-sided dice (each numbered\n1 to 6).",
    "Would you bet him that he couldn’t roll at least one 6 in four rolls of\na single die?",
    "What about betting that he couldn’t roll at least one double-6\nin 24 rolls of both dice?\n",
    "To make these decisions, we should decide\n1.",
    "How likely is it that in four rolls of a single die, there will be at least\none 6?\n2.",
    "How likely is it that in 24 rolls of two dice, there will be at least one\ndouble-6?\n3.",
    "Since the ratio 4 : 6 is equal to the ratio 24 : 36, should the probability of\nthese events be the same?",
    "That’s what the Chevalier de Mere thought.\n",
    "Do you?\n",
    "Here is a python script that can help you get a feel for the questions above.",
    "You\ncan switch between the two questions by commenting and uncommenting out the\nappropriate lines (lines that start with a # are comments).",
    "See how lucky you are!\n",
    "import random\nfor i in range (4):\ndie = random.randint (1,6)\nprint(f\"You␣rolled␣a␣{die}\")\n#for i in range (24):\n273\n\n274\n3.",
    "Counting\n#\ndie1 = random.randint (1,6)\n#\ndie2 = random.randint (1,6)\n#\nprint(f\"You rolled a {die1} and a {die2 }\")\n",
    "If you know some python, you might want to modify the script to run the\nexperiment 1000 times and see how many of those are “wins”.\n",
    "We can get a feel for probability empirically by observing how frequently events\noccur when an experiment is repeated many times.",
    "It often happens, as it did with\nthe Chevalier de Mere, that our intuition about probability is not quite right.",
    "Using\nthe counting techniques we have studied, we can explain why our intuition is off\nand what the true probabilities are.\n",
    "Most of the questions about counting we have considered in this chapter can\nalso be asked as a question about probability.",
    "For example: How many passwords\nof length 8 can you make using just lower-case letters?",
    "What is the probability that\nrandomly selecting 8 lower-case letters will give you your password?\n",
    "While the subject of probability is vast and complex, the basics of discrete\nprobability are little more than counting.",
    "So here we will take a brief look at how\nour study of counting can help us understand probability.\n",
    "Preview Activity\nSuppose you were in a class of 30 students.",
    "How likely is it that at least two of the\nstudents were born on the same day of the year?\nAssume that all days are equally likely and that nobody was born on February\n29th.",
    "Would you believe the answer is more than 25%?",
    "More than 50%?",
    "More than\n70%???",
    "Let’s find the answer.\n",
    "1.\n",
    "First, what should we mean by probability?",
    "If you roll a fair six-sided die,\nwhat is the probability of rolling a 6?\n",
    "What is the probability of rolling an even number?\n2.\nWe will define the probability of an event as the number of ways the event can\nhappen divided by the total number of things that can happen.\n",
    "(a) Suppose you roll two dice (one red and one green).",
    "How many total\noutcomes are there?\n(b) Of those outcomes, how many have different numbers on the two dice?\nHint.\n",
    "How many sequences of two different numbers can you make\nusing the numbers 1 to 6?\n(c)",
    "Combining the two numbers your found above, what is the probability\nthat two dice will show different numbers?\n(d)",
    "What is the probability that you will get three different numbers when\nrolling three dice?",
    "(Assume the dice are different colors).\n\n",
    "3.7.",
    "Applications to Probability\n275\n3.\nNow to birthdays.",
    "There are 365 days in a year.\n",
    "(a) How many possible sequences of 30 birthdays are there?\n(b) How many possible sequences of 30 birthdays contain no repeats?\n",
    "(c) What is the probability that 30 people have no repeated birthdays?\n(d) Among the 30 people, either they all have different birthdays or at least\ntwo share a birthday.",
    "Since this is certain, its probability is 1.",
    "So what is\nthe probability that at least two people (out of the 30) share a birthday?\n(e) What is the smallest number of people you would need to have a greater\nthan 90% chance that at least two share a birthday?\n3.7.2\nComputing Probabilities\nThink about how we use the language of probability in our everyday lives.",
    "We\nmight say that tossing a coin has a 50% chance of coming up heads.",
    "Or that when\nrolling two dice, having the sum of the dice result in a 7 is more likely than having\nthe sum be a 2.",
    "Casinos certainly rely on certain pairs of cards being consistently\nmore likely than others when setting payouts for Blackjack.",
    "All of this assumes that\nthere is some randomness to events, and that even in this randomness, there is some\nconsistency to what can happen.",
    "We will assume this model of reality.\n",
    "The things we can assign probabilities to are called random experiments.",
    "These\ncan have different possible outcomes.",
    "We will call the (finite) set of possible outcomes\nto a random experiment the sample space (we will usually denote this set as 𝑆).\n",
    "By definition, performing a random experiment will always result in exactly one\noutcome from the sample space.\n",
    "Throughout this section, we will always assume the uniform probability dis-\ntribution, which means that we insist that each outcome in the sample space is\nequally likely.",
    "Then the probability of any particular outcome in the sample space 𝑆\nis exactly\n1\n|𝑆|.\n",
    "Note 3.7.1",
    "The uniform probability distribution is a common and reasonable\nassumption to make, but it does preclude us from asking some questions.\n",
    "For example, throwing a dart at a dartboard is not uniformly distributed,\nand similarly, rolling weighted dice would not be.",
    "What is the probability\nthat a thumbtack lands point up?",
    "But how would we even start to answer\nthese questions?",
    "We would have to make some assumptions about what\nthe probabilities of the outcomes actually are (perhaps via some repeated\nexperiments).\n",
    "There are other reasons to study different probability distributions, and\nthis is a major topic of study in a course in probability theory.\n\n",
    "276\n3.",
    "Counting\nExample 3.7.2\nSuppose you flip two fair coins (a penny and a nickel).",
    "What is the sample\nspace of possible outcomes?",
    "What is the probability of getting two heads?\nSolution.\n",
    "The same space is the set of all possible outcomes of the experiment,\nwhich in this case is the set {𝐻𝐻, 𝐻𝑇, 𝑇𝐻, 𝑇𝑇}.",
    "The probability of getting\ntwo heads is then 1\n4.",
    "In fact, every outcome has probability 1\n4 since there are 4\noutcomes in the sample space.\n",
    "Finding probabilities of outcomes really is this easy.",
    "Where things get more fun\nis if we look for the probability of an event: a subset of the sample space.",
    "For a\nparticular random experiment, there might be lots of different events we ask about,\nand they do not need to be mutually exclusive.",
    "An event can also be a set containing\njust a single outcome or might contain no outcomes.\n",
    "For example, suppose you roll a fair 6-side die.",
    "The sample space contains six\noutcomes {1, 2, 3, 4, 5, 6}.",
    "Some events we might care about include rolling an even\nnumber (the subset {2, 4, 6}), rolling a number less than 3 (the set {1, 2}), or rolling\na number less than 10 (the subset {1, 2, 3, 4, 5, 6}).",
    "In fact, we now know that there\nare exactly 26 = 64 different events we could ask about, since there are 64 subsets of\nthe sample space.\n",
    "What does our intuition suggest about the example events described above?\n",
    "Rolling an even number should be just as likely as rolling an odd number, so we\nhope that the probability of rolling an even number is 1\n2.",
    "Similarly, the probability of\nrolling a number less than 3 should be 1\n3 since a third of the possible outcomes are\nless than 3.",
    "What about rolling a number less than 10?",
    "Well, this must happen, so it\nwould be 100%, which as a fraction is just 1.\n",
    "Consistent with our intuition, we define the probability of an event as follows.\n",
    "Definition 3.7.3\nSuppose a random experiment has sample space 𝑆. The probability of an\nevent 𝐸is the number of outcomes in 𝐸divided by the number of outcomes\nin 𝑆. We write this as 𝑃(𝐸) = |𝐸|\n|𝑆|.\n",
    "Example 3.7.4\nSuppose you roll a regular 6-sided die (each side contains a number from 1 to\n6).",
    "What is the probability that you will roll an even number?\nSolution.\n",
    "The sample space is the set {1, 2, 3, 4, 5, 6} of possible rolls.",
    "The\nevent, call it 𝐸for even, is the set of outcomes {2, 4, 6}.",
    "Thus the probability\nof 𝐸occurring is\n𝑃(𝐸)",
    "= 3\n6 = 1\n2.\n\n3.7.",
    "Applications to Probability\n277\nWe have spent a lot of effort learning how to count the size of sets.",
    "We can then\nuse this to compute probabilities by counting the size of the sample space (set) and\nthe size of the event (set).\n",
    "Example 3.7.5\nIf you draw 5 cards from a regular deck of 52 cards, what is the probability\nthat you will draw 4-of-a-kind?\nSolution.\n",
    "First, let’s count the sample space, which will consist of all 5-card\nhands.",
    "The order of the cards in a hand is not important, so we will just count\n5-element subsets of the 52 cards.",
    "The sample space therefore contains \u000052\n5\n\u0001\nelements.",
    "(This number is just under 2.6 million: 2, 598, 960 to be exact.)\n",
    "Now, how many of those will be 4-of-a-kind?",
    "One way we could count\nthis would be to first select which of the 13 values will be the 4-of-a-kind,\nwhich can be done in \u000013\n1\n\u0001\n= 13 ways.",
    "What about the other card in the hand?\n",
    "Well, there are 48 other cards it could be, so the number of 4-of-a-kind hands\nis 13 · 48 = 624.\n",
    "This makes the probability of getting 4-of-a-kind,\n𝑃(4-of-a-kind) = 13 · 48\n\u000052\n5\n\u0001\n≈0.00024.\n",
    "An important subtlety:",
    "Whenever counting the size of the sample space and the\nevent, we must make sure that we are really counting the number of elements of\nthe sample space that are in the event.",
    "In particular, if we count subsets of cards\nin the sample space (using a combination instead of using a permutation to count\nsequences of cards) then we must count the number of subsets of cards in the event.\n",
    "Interestingly, we can find the probability of getting 4-of-a-kind using permuta-\ntions too: The number of 5-card sequences is 𝑃(52, 5) = 311, 875, 200.",
    "Finding the\nnumber of 4-of-a-kind sequences is a little more complicated.",
    "There are 13 possible\nvalues for the 4-of-a-kind, and 48 remaining cards for the fifth card.",
    "But those five\ncards can be arranged in 5! different ways.",
    "So the number of 4-of-a-kind sequences\nis 13 · 48 · 5!.",
    "This gives,\n𝑃(4-of-a-kind) = 13 · 48 · 5!\n𝑃(52, 5)\n≈0.00024.\nIs this close to the same answer we had before?",
    "It is exactly the same (we can verify\nthis by noticing the extra 5! in both the numerator and denominator).\n",
    "While picking between combinations and permutations (as long as you pick the\nsame for both the sample space and the event) will give you the same probability, this\nis not always true, as you are asked to explore in some of the additional exercises.\n\n",
    "278\n3.",
    "Counting\n3.7.3\nProbability Rules\nHere are a few basic probability facts that follow easily from our definition of\nprobability and understanding of counting.",
    "While we are still under the assumption\nthat the outcomes in the sample space are equally likely (the uniform probability\ndistribution), these rules will hold for all probability distributions.\n",
    "First, we often are interested in the probability that an event does not occur.",
    "We\ncall this the complement of the event.",
    "Remember, events are subsets of the sample\nspace, and not being “in” the event means you are in the complement of that subset.\n",
    "Using the same notation we have for sets, the complement of an event 𝐸will be\nwritten",
    "𝐸. Here is the relationship between the probability of an event and its\ncomplement.\n",
    "Theorem 3.7.6\nThe probability of the complement of an event 𝐸is\n𝑃(𝐸) = 1 −𝑃(𝐸).\n",
    "Proof.",
    "Remember that 𝑃(𝐸) = |𝐸|\n|𝑆|, the number of outcomes in the event 𝐸divided\nby the total number of outcomes.",
    "But how many outcomes are not in 𝐸?",
    "All the\nothers.",
    "That is,\n\f\f\f𝐸\n\f\f\f = |𝑆| −|𝐸| .\n",
    "So for sure, we have\n𝑃(𝐸) =\n\f\f\f𝐸\n\f\f\f\n|𝑆| = |𝑆| −|𝐸|\n|𝑆|\n= |𝑆|\n|𝑆| −|𝐸|\n|𝑆| = 1 −𝑃(𝐸).\n",
    "Let’s illustrate this proof with an example.\n",
    "Example 3.7.7\nSuppose you flip a fair coin 10 times.",
    "What is the probability that you will get\nat least one heads?\nSolution.\n",
    "There are lots of ways you can get at least one head, but only one\nway you can get no heads (that is, get all tails).",
    "So it makes sense to try to\ncompute the requested probability as the complement of a probability easier\nto compute.\n",
    "The sample space here is the set of all 10-toss sequences.",
    "How many are\nthere?",
    "For each term in the sequence, it could be a head (H) or tail (T), so\nthere are 210 = 1024 possible sequences.\n",
    "We want to find the probability of getting at least one head.",
    "Let’s think of\nthis just as a counting question: How many 10-toss sequences have at least\none head?",
    "All 1024 of them, except the one all tails sequence.",
    "So there are\n\n3.7.",
    "Applications to Probability\n279\n1023 sequences with at least one head.",
    "Thus the probability of getting at least\none head is 1023\n1024.\n",
    "Wait, did we use Theorem 3.7.6?",
    "Not explicitly, but essentially we have.\n",
    "Using the theorem, we would have said that the probability of getting at least\none head is\n1 −𝑃(all tails)",
    "= 1 −\n1\n1024 = 1023\n1024.\n",
    "Note that the calculation we did required subtracting fractions:\n1 −\n1\n1024 = 1024\n1024 −\n1\n1024 = 1024 −1\n1024\n= 1023\n1024.\n",
    "So whether we do the subtraction to calculate the size of the complement, or\nuse the complement formula and subtract fractions, we get the same answer.\n",
    "Complementary probabilities are very useful when answering historical questions\nabout dice.\n",
    "Example 3.7.8\n",
    "What is the probability that you will roll at least one 6 in four rolls of a fair\n6-sided die?\n",
    "Is this the same as the probability that you will roll at least one double 6\nin 24 rolls of two dice?\nSolution.\n",
    "The complementary event is rolling a die four times and never\ngetting a 6.",
    "Of the 64 possible rolls, there are 54 that contain no 6.",
    "So the\nprobability of getting at least one 6 in four rolls is\n𝑃(at least one 6) = 1 −𝑃(no 6) = 1 −54\n64 ≈0.5177.\n",
    "For the double 6 in 24 rolls variant, we use the complementary event as\nwell: what is the probability of not getting double 6s?",
    "That means on every\nroll you get one of the 35 other pairs.\n",
    "𝑃(at least one double 6) = 1 −𝑃(no double 6) = 1 −3524\n3624 ≈0.4914.\n",
    "Indeed, the Chevalier de Mere noticed that when playing the game with\ntwo dice, he tended to lose money in the long run.",
    "Who did he turn to to ask\nfor help?",
    "Blaise Pascal, of course!\n",
    "Another way to think about complementary probabilities is to say that\n𝑃(𝐸) + 𝑃(𝐸) = 1.\nA probability of 1 means the event is certain, so perhaps we should think of this as\n\n280\n3.",
    "Counting\ngiving the probability that event 𝐸either happened or didn’t happen.",
    "This is exactly\nwhat we want to mean by adding probabilities.\n",
    "Theorem 3.7.9\nSuppose 𝐴and 𝐵are two disjoint events.",
    "Then the probability of either 𝐴or 𝐵\nhappening is,\n𝑃(𝐴∪𝐵) = 𝑃(𝐴) + 𝑃(𝐵).\n",
    "If 𝐴and 𝐵are not disjoint, then the probability of 𝐴or 𝐵occurring is,\n𝑃(𝐴∪𝐵) = 𝑃(𝐴)",
    "+ 𝑃(𝐵) −𝑃(𝐴∩𝐵).\n",
    "The proof of this fact is one of the exercises in this section.",
    "However, it should\nbecome clear how this works with an example.\n",
    "Example 3.7.10\nSuppose you roll a fair 6-sided die.",
    "What is the probability of rolling a number\nthat is even or less than 3 ?\nSolution.\n",
    "We don’t need a theorem to answer this.",
    "The sample space is\n{1, 2, 3, 4, 5, 6} and the event is the subset 𝐸= {1, 2, 4, 6}.",
    "So 𝑃(𝐸) = 4\n6.\nTo see where the 4 comes from, let 𝐴be the event of rolling an even\nnumber (so 𝐴= {2, 4, 6}) and 𝐵be the event of rolling a number less than 3\n(so 𝐵= {1, 2}).",
    "Notice that the notation 𝑃(𝐸) = 𝑃(𝐴∪𝐵) makes sense, since\nas sets, we really do have 𝐸= 𝐴∪𝐵.\nIf we go back to the definition of the probability of an event, we have,\n𝑃(𝐸) = |𝐸|\n|𝑆| = |𝐴∪𝐵|\n|𝑆|\n.\n",
    "We must find the size of the set 𝐴∪𝐵.",
    "But we know how to find the size of\nthe union of non-disjoint sets: use PIE!",
    "So |𝐴∪𝐵| = 3 + 2 −1 = 4.\n",
    "As the example demonstrates, we have basically translated the sum principle\ninto the language of probability.",
    "Can we do the same for the product principle?\n",
    "We use the product principle to find the number of ways two events can both\nhappen, one after the other.",
    "Many probability questions ask for the probability of\nsuch compound events.",
    "Let’s consider an example to see what is going on.\n",
    "Example 3.7.11\nWhat is the probability of getting an even number when rolling a 6-sided die\nand a heads when flipping a coin?\nSolution.\n",
    "First we will find the probability directly from the definition.",
    "The\n\n3.7.",
    "Applications to Probability\n281\nsample space consists of all pairs of outcomes from the die and the coin, so 𝑆=\n{(1, 𝐻), (1, 𝑇), (2, 𝐻), (2, 𝑇), (3, 𝐻), (3, 𝑇), (4, 𝐻), (4, 𝑇), (5, 𝐻), (5, 𝑇), (6, 𝐻), (6, 𝑇)}.\n",
    "Without listing these, we could have calculated the size of the sample space\nusing the product principle: |𝑆| = 6 · 2 = 12.",
    "The event we are interested\nin is the set of outcomes 𝐸= {(2, 𝐻), (4, 𝐻), (6, 𝐻)}.",
    "Obviously that is size 3,\nwhich we could have also found as 3 · 1.",
    "So the probability of this event is\n𝑃(𝐸)",
    "= 3\n12 = 1\n4.\nNow consider the two events separately.",
    "Say 𝐴is rolling an even number,\nand 𝐵flipping the coin and getting heads.",
    "The probability of the first event is\n𝑃(𝐴)",
    "= 3\n6.",
    "The probability of the second event is 𝑃(𝐵) = 1\n2.",
    "It appears that the\ncorrect way to combine these probabilities is to multiply them:\n𝑃(𝐸) = (𝐴and 𝐵) = 𝑃(𝐴)𝑃(𝐵)",
    "= 3\n6\n1\n2 = 1\n4.\nHow convenient that multiplying fractions is done by multiplying the nu-\nmerators and denominators separately, and this is the same as applying the\nproduct principle to the numerator and denominator of the fraction.\n",
    "The reason the above example worked out was that the events were independent.\n",
    "Intuitively, this means that the outcome of the first event has no influence on the\noutcome of the second event.",
    "Actually, we use this principle like the product\nprinciple to define independence.\n",
    "Definition 3.7.12\nGiven two events 𝐴and 𝐵, we say that they are independent provided the\nprobability of both events happening is the product of the probabilities of\neach event happening:\n𝑃(𝐴∩𝐵) = 𝑃(𝐴)𝑃(𝐵).\n",
    "Notice that in the definition we describe the event that both 𝐴and 𝐵happen as\nthe intersection 𝐴∩𝐵. Since events are sets, it makes sense to take an intersection.\n",
    "The intersection of two sets contains all the elements that are in both sets, which is\nexactly what we want here.\n",
    "This shines a light on a key difference between this definition and the product\nprinciple.",
    "We use the product principle to construct a new set of outcomes by\ncombining the outcomes in two sets.",
    "This creates new sorts of outcomes.",
    "For\nexample, the product principle would combine the sets\n{1, 2, 3} and {𝐻, 𝑇} into {1𝐻, 1𝑇, 2𝐻, 2𝑇, 3𝐻, 3𝑇}.\n",
    "This is not the intersection of two sets (it is actually the Cartesian product: 𝐴× 𝐵=\n{(𝑎, 𝑏) : 𝑎∈𝐴; 𝑏∈𝐵}).",
    "The definition of independence involves probabilities\nrelative to a fixed set of outcomes.",
    "So the elements in 𝐴and 𝐵in the definition of\nindependence are already sequences like we would have created using the product\n\n282\n3.",
    "Counting\nprinciple.\n",
    "If we are more careful in Example 3.7.11 where we rolled a die and flipped a\ncoin, we should describe the event 𝐴of first rolling an even number as the set\n𝐴= {(2, 𝐻), (2, 𝑇), (4, 𝐻), (4, 𝑇), (6, 𝐻), (6, 𝑇)}\nand the event 𝐵of then flipping heads as the set\n𝐵= {(1, 𝐻), (2, 𝐻), (3, 𝐻), (4, 𝐻), (5, 𝐻), (6, 𝐻)}.\n",
    "We then have 𝑃(𝐴) = 6\n12 and 𝑃(𝐵) = 6\n12, with product 𝑃(𝐴)𝑃(𝐵)",
    "= 6\n12\n6\n12 = 36\n144 = 1\n4.",
    "So\nour solution in the example was correct but misleading.",
    "The events 𝐴and 𝐵are\nindeed independent since\n𝐴∩𝐵= {(2, 𝐻), (4, 𝐻), (6, 𝐻)}\nso 𝑃(𝐴∩𝐵) = 3\n12 = 1\n4.\n",
    "Example 3.7.13\nSuppose you roll a 12-sided die (numbered 1 to 12).",
    "Consider the events:\n• 𝐴is the event of rolling a number that is a multiple of 3.\n• 𝐵is the event of rolling a number that is a multiple of 4.\n• 𝐶is the event of rolling a number less than 7.\nAre the events 𝐴and 𝐵independent?",
    "What about 𝐴and 𝐶?",
    "What about 𝐵\nand 𝐶?\nSolution.\n",
    "The sample space is the set {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12}.",
    "The\nevent 𝐴is the set {3, 6, 9, 12}, 𝐵is the set {4, 8, 12}, and 𝐶is the set\n{1, 2, 3, 4, 5, 6}.",
    "Thus the probabilities for each of these events are\n𝑃(𝐴)",
    "= 4\n12 = 1\n3,\n𝑃(𝐵) = 3\n12 = 1\n4,\n𝑃(𝐶)",
    "= 6\n12 = 1\n2.\nTo decide whether events 𝐴and 𝐵are independent, we find 𝑃(𝐴∩𝐵).",
    "The\nintersection of events 𝐴and 𝐵(meaning the number rolled is both a multiple\nof 3 and 4) is 1\n12 (the only element of the intersection is 12).",
    "We compare this\nto 𝑃(𝐴)𝑃(𝐵)",
    "= 1\n3\n1\n4 = 1\n12.",
    "Since these are equal, the events are independent.\n",
    "Events 𝐵and 𝐶are not independent though.",
    "Since 𝐵∩𝐶= {4}, we have\n𝑃(𝐵∩𝐶) = 1\n12.",
    "But 𝑃(𝐵)𝑃(𝐶) = 1\n4\n1\n2 = 1\n8.",
    "Since these are not equal, the events\nare not independent.",
    "This makes sense since there are fewer multiples of 4\nless than 7 than not.\n",
    "Finally, 𝐴and 𝐶are independent: 𝑃(𝐴∩𝐶) =\n2\n12 = 1\n6 and 𝑃(𝐴)𝑃(𝐶) =\n1\n3\n1\n2 = 1\n6.\n\n3.7.",
    "Applications to Probability\n283\nWhen events are not independent, we get a new interesting question we can ask:\nWhat is the probability of one event given that another event has occurred?",
    "This is\ncalled ...\n3.7.4\nConditional Probability\nThe famous probability problem, known as the Monty Hall problem, presents the\nfollowing conundrum.",
    "You are on the game show Let’s Make a Deal and will win\nwhatever is behind one of three doors you decide to open.",
    "Behind one door is a\ncar; behind the other two are goats.",
    "You pick a door, but before opening it, the host\n(Monty Hall) reveals one of the other doors that has a goat behind it.",
    "You then have\nthe opportunity to switch doors.",
    "Should you switch?",
    "What is the probability of\ngetting the car if you do?\n",
    "By the way...",
    "This problem was perhaps one of the first math problems to\n“go viral,” although it did so when it appeared in the Sunday newspaper\nmagazine Parade.",
    "After its publication, around 10,000 readers (including close\nto 1000 with PhDs) wrote in complaining that the author, Marilyn vos Savant,\nwas wrong.",
    "She wasn’t.\n",
    "You might be tempted to say that the probability of getting the car when you\nswitch is 1\n2.",
    "After all, there are two doors left, and the car is behind one of them.\n",
    "However, we must ask what the probability of getting the car is given that Monty\nhas revealed a goat behind another, unpicked door.\n",
    "Definition 3.7.14\nGiven two events 𝐴and 𝐵, the conditional probability of 𝐴given 𝐵is,\n𝑃(𝐴|𝐵) = 𝑃(𝐴∩𝐵)\n𝑃(𝐵)\n.\n",
    "Does this definition agree with our intuition for what conditional probability\nshould mean?",
    "Let’s think about the sample space.",
    "We want to know the chances of\n𝐴occurring under the assumption that 𝐵has already occurred.",
    "In other words, we\nonly care about the elements of the sample space that belong to 𝐵.\nIf 𝐵becomes the sample space, then the only outcomes from 𝐴that can possibly\noccur are the outcomes that are in 𝐴and 𝐵.",
    "So perhaps the definition of conditional\nprobability really should be,\n𝑃(𝐴|𝐵) = |𝐴∩𝐵|\n|𝐵|\n.\n",
    "Unfortunately, I’m not in charge of probability definitions.",
    "It turns out that the\n\n284\n3.",
    "Counting\nstandard definition is just as good though.",
    "This is because,\n𝑃(𝐴|𝐵) = 𝑃(𝐴∩𝐵)\n𝑃(𝐵)\n=\n|𝐴∩𝐵|\n|𝑆|\n|𝐵|\n|𝑆|\n= |𝐴∩𝐵|\n|𝐵|\n.\nPhew.",
    "Another crisis averted.\n",
    "Example 3.7.15\nSuppose you roll two 6-sided dice with your eyes closed.",
    "Your friend says,\n“Hey look, at least one of your dice is a 4.”",
    "What is the probability that you\nrolled a sum of 7?\nSolution.\n",
    "First note that the probability of rolling a sum of 7 is 6\n36 = 1\n6, since\nof the 36 pairs of numbers that can appear, there are six pairs that sum to\n7: {(1, 6), (2, 5), (3, 4), (4, 3), (5, 2), (6, 1)}.",
    "However, we are now in a situation\nwhere at least one die is a 4.",
    "This limits the sample space to the 11 pairs that\ncontain a 4 (we can count this using PIE as 6 + 6 −1).",
    "Of these, only two sum\nto 7: {(3, 4), (4, 3)}.",
    "So the probability of rolling a sum of 7 given that one die\nis a 4 is 2\n11.\n",
    "If we use the definition of conditional probability, we would compute this\nslightly differently but arrive at the same answer.",
    "We have events 𝐴(the sum\nis 7) and 𝐵(at least one die is a 4).",
    "Then 𝑃(𝐵) = 11\n36 and 𝑃(𝐴∩𝐵) =\n2\n36.",
    "So\n𝑃(𝐴|𝐵) = 2\n11.\n",
    "Notice that the probability of rolling a sum of 7 given that the red die is a 4\n(say they are different colors) will be different!",
    "That would be 1\n6, since we are\nreally just asking for the probability that the other die is a 3.\nExample 3.7.16\nSuppose you draw two cards from a standard deck of 52 cards.",
    "What is the\nprobability that the second card is a face card given that the first card is red?\n",
    "What is the probability that the first card is red given that the second card\nis a face card?\nSolution.\n",
    "We have a sample space consisting of the 52 · 51 sequences of\ntwo cards.",
    "Event 𝐴will be those pairs that have a red card as the first in\nthe sequence.",
    "Event 𝐵will be those pairs that have a face card second in the\nsequence.\n",
    "We are looking for both 𝑃(𝐴|𝐵) and 𝑃(𝐵|𝐴), so we will need to find 𝑃(𝐴),\n𝑃(𝐵), and 𝑃(𝐴∩𝐵).",
    "There are 26 · 51 pairs in 𝐴(select one of the 26 red cards,\nand then any of the remaining 51 cards), so\n𝑃(𝐴) = 26 · 51\n52 · 51 = 26\n52 = 1\n2.\n",
    "There are 12 · 51 pairs in 𝐵(select one of the 12 face cards, and then any of the\n\n3.7.",
    "Applications to Probability\n285\nremaining 51 cards), so\n𝑃(𝐵) = 12 · 51\n52 · 51 = 12\n52 = 3\n13.\n",
    "Finding the size of the intersection is a little more challenging (we did so in\nthe subsection Combining Principles).",
    "There are 20 · 12 pairs that start with a\nred, non-face card, and end with a face card, and another 6 · 11 pairs that start\nwith a red face card and end with a face card.",
    "So\n𝑃(𝐴∩𝐵)",
    "= 20 · 12 + 6 · 11\n52 · 51\n= 306\n2652 = 3\n26.\n",
    "So the probability that the second card is a face card given that the first\ncard is red is,\n𝑃(𝐵|𝐴) = 𝑃(𝐴∩𝐵)\n𝑃(𝐴)\n=\n3\n26\n1\n2\n= 3\n13.\n",
    "The probability that the first card is red given that the second card is a face\ncard is,\n𝑃(𝐴|𝐵) = 𝑃(𝐴∩𝐵)\n𝑃(𝐵)\n=\n3\n26\n3\n13\n= 1\n2.\nWait a second!",
    "What?",
    "The probability that the first card is red given that\nthe second card is a face card is the same as the probability that the first card\nis red??",
    "It seems that 𝑃(𝐴|𝐵) = 𝑃(𝐴), and that 𝑃(𝐵|𝐴) = 𝑃(𝐵).",
    "What could\nthat mean?\n",
    "Look what happens when you clear the denominator in the definition of condi-\ntional probability\n𝑃(𝐴|𝐵) = 𝑃(𝐴∩𝐵)\n𝑃(𝐵)\nbecomes\n𝑃(𝐴∩𝐵)",
    "= 𝑃(𝐵)𝑃(𝐴|𝐵).\n",
    "This looks almost like the definition of events being independent, except that instead\nof 𝑃(𝐴) in the product we now have 𝑃(𝐴|𝐵).",
    "But what does 𝑃(𝐴|𝐵) even mean if 𝐴\nand 𝐵are independent?",
    "If the events are independent, then it should be no more or\nless likely that 𝐴occurs given that 𝐵has occurred.",
    "So we should have 𝑃(𝐴|𝐵) = 𝑃(𝐴).\n",
    "This is exactly what we saw in the last example.\n",
    "3.7.5\nReading Questions\n1.\nWhich of the following are true about the equation 𝑃(𝐴∪𝐵) = 𝑃(𝐴) + 𝑃(𝐵)?\n",
    "A. This is true as long as the events 𝐴and 𝐵are disjoint.\n",
    "B.",
    "This is true as long as the events 𝐴and 𝐵are independent.\n\n",
    "286\n3.",
    "Counting\nC.",
    "This is always true.\n",
    "D. This is never true.\n",
    "2.\nWhich of the following relationships hold for any two events 𝐴and 𝐵?\nA. 𝑃(𝐴∩𝐵) = 𝑃(𝐴)𝑃(𝐵).\n",
    "B. 𝑃(𝐴∩𝐵)",
    "= 𝑃(𝐴)𝑃(𝐵|𝐴)\nC. 𝑃(𝐴∩𝐵)",
    "= 𝑃(𝐵)𝑃(𝐴|𝐵)\nD. 𝑃(𝐴∩𝐵)",
    "= 𝑃(𝐴)𝑃(𝐴|𝐵)\n3.\n",
    "What questions do you have after reading this section?",
    "Ask at least one\nquestion about the material that you are curious about.\n",
    "3.7.6\nPractice Problems\n1.\n",
    "You flip a fair coin three times and record whether it lands head (H) or tails\n(T).\n",
    "(a) List all the elements in the sample space.",
    "For example, one outcome is\nHHT.\n",
    "(b) Suppose you bet your friend that you would get more heads than tails.\n",
    "List all elements in this event.\n",
    "(c) What is the probability of getting more heads than tails?\n(d)",
    "What is the probability of getting exactly two heads?\n",
    "What is the probability of getting exactly three heads?\n2.\nSuppose you flip a fair coin 15 times.\n",
    "(a) What is the size of the sample space?\n(b) What is the size of the event that you get exactly 8 heads?\n",
    "So then what is the probability that you get exactly 8 heads?\n",
    "(c) What is the size of the event that you do NOT get exactly 8 heads?\n",
    "What is the probability that you do NOT get exactly 8 heads?",
    "Use the\ndefinition of probability and the previous answer.\n",
    "What probability do you get for this same event if you use the fact that\nthe probability of an event is 1 minus the probability of the complement\nof the event?\n",
    "3.\nSuppose you flip a fair coin 16 times.\n",
    "(a) What is the size of the sample space?\n(b) What is the size of the event that you get exactly 4 heads?\n\n3.7.",
    "Applications to Probability\n287\n",
    "What is the size of the event that you get exactly 12 heads?\n",
    "What is the size of the event that you get exactly 4 heads OR exactly 12\nheads?\n(c) What is the sum of the probabilities of getting exactly 4 heads and getting\nexactly 12 heads?\n",
    "+\n=\nWhat is the probability of getting exactly 4 heads OR getting exactly 12\nheads?",
    "Compute this by finding the size of the event, divided by the size\nof the sample space.\n",
    "÷\n=\n.\n",
    "4.\nYou have a bag of special math-themed M&M’s.",
    "The bag promises that inside\nthere are 5 blue, 4 red, 1 orange, 1 green, 2 brown, and 3 yellow M&M’s.\n",
    "Find the probabilities of the following events.\n",
    "(a) What is the probability that if you pick a single M&M, it is blue or yellow?\n(b) What is the probability that if you pick two M&M’s at the same time, you\nwill get a blue and yellow?\n(c) What is the probability that if you pick two M&M’s one at a time, you\nwill get a blue first and a yellow second?\n5.\n",
    "In a standard deck of 52 cards, 26 cards are red and 26 cards are black.",
    "Thus\nthe probability of drawing a red card is 0.5.\n(a) What is the probability that when flipping a coin twice, you get tails both\ntimes?\n(b) What is the probability that if you are dealt two cards from a standard\ndeck, both cards are red?\n6.\n",
    "Suppose you take just eight playing cards, four red and four black.",
    "You also\nhave a fair coin that you can flip as many times as you want.\n",
    "(a) Compare the probability of getting tails when flipping a coin once to the\nprobability of drawing a single red card.\n",
    "𝑃(tails) =\n; 𝑃(red) =\n.",
    "Difference:\n(b) Compare the probability of getting two tails when flipping a coin twice\nto the probability of drawing two red cards (without replacement).\n",
    "𝑃(2 tails) =\n; 𝑃(2 reds) =\n.",
    "Difference:\n(c) Compare the probability of getting three tails when flipping a coin thrice\nto the probability of drawing three red cards (without replacement).\n",
    "𝑃(3 tails) =\n; 𝑃(3 reds) =\n.",
    "Difference:\n\n288\n3.",
    "Counting\n(d) Compare the probability of getting four tails when flipping a coin four\ntimes to the probability of drawing four red cards (without replacement).\n",
    "𝑃(4 tails)",
    "=\n; 𝑃(4 reds) =\n.",
    "Difference:\n(e) Compare the probability of getting five tails when flipping a coin five\ntimes to the probability of drawing five red cards (without replacement).\n",
    "𝑃(5 tails) =\n; 𝑃(5 reds) =\n.",
    "Difference:\n7.\nSuppose you have three dice: a 4-sided die, a 6-sided die, and an 8-sided die.\n",
    "Each die is fair and numbered from 1 to the number of sides it has.",
    "You roll all\nthree dice.\n",
    "(a) What is the probability that the sum of the dice is 3?\n(b) What is the probability that the sum of the dice is 6?\n(c)",
    "What is the probability all three dice have the same number when rolled?\n(d)",
    "What is the probability all three dice have the same number when rolled\ngiven that the sum of the dice is 6?\n8.\n",
    "You roll 3 fair 6-sided dice.",
    "What is the probability that all three dice show\ndifferent numbers?\n",
    "What is the probability that all three dice show the same number?\n",
    "Is it possible for the dice to show neither all the same nor all different\nnumbers?",
    "If so, the probability of this happening would be 0.",
    "What is the\nprobability?\n3.7.7\nAdditional Exercises\n1.\n",
    "When playing 5-card poker, a full house is a hand that contains three cards of\none rank and two cards of another rank.",
    "For example, you could have three 7s\nand two 4s.\n",
    "Find the probability of being dealt a full house in two different ways:\n(a) Assume that all five cards are dealt at once, so that the sample space has\nsize \u000052\n5\n\u0001\n.\n",
    "(b) Assume that the cards are dealt one at a time, so that the sample space\nhas size 𝑃(52, 5).\n",
    "Are the two answers the same?",
    "Why does this make sense?\n2.\n",
    "A random number generator selects single-digit numbers (0 through 9) with\nequal probability.",
    "Suppose the generator produces five numbers.\n",
    "What is the probability that the five numbers will all be different?",
    "Answer\nthis question in two ways:\n(a) Assume the numbers come out of the generator in a sequence, so that the\nsample space has size 105.\n\n",
    "3.7.",
    "Applications to Probability\n289\n(b) Assume the numbers come out as a multiset, or equivalently, that the\nnumbers must appear in non-decreasing order.",
    "You will want to use\nsticks and stones to count the size of the sample space.\n",
    "Are the two answers the same?",
    "Why does this make sense?\n3.\nProve Theorem 3.7.9.\n",
    "4.\nEach of 10 friends has a deck of cards that they shuffle thoroughly.",
    "Each friend\ndraws a card from their deck.",
    "What is the probability that at least one pair of\nfriends draw a matching card?\n5.\nHow many people do you need to have in a room to have a 50% chance that at\nleast two people share the same birthday (day of the year)?",
    "Assume that all\nbirthdays are equally likely, and that nobody is born on Leap Day (February\n29th).\n",
    "6.\nAt your 20th high school reunion, you meet an old friend you hadn’t heard\nfrom in years.",
    "You talk about pets, specifically cats and dogs.",
    "She tells you that\nshe has two pets, and that at least one of them is a cat.",
    "What is the probability\nthat she has two cats?",
    "(Assume that having a cat or a dog is equally likely.)\n",
    "7.\nAnother old friend overhears your pet conversation and says that he also\nhas two pets, and that the one he has had the longest is a cat.",
    "What is the\nprobability that he has two cats?",
    "And why is this answer different from the\nprevious question?\n8.\n",
    "You are playing a shell game with three cups.",
    "Under one cup are two green\nballs, under another cup are two red balls, and under the third cup are one\ngreen and one red ball.",
    "You close your eyes, and your friend rearranges the\ncups.",
    "You then open your eyes and pick a cup at random.",
    "You see that it\ncontains a green ball.",
    "What is the probability that the other ball under that cup\nis also green?",
    "Explain your answer in terms of conditional probability.\n\n",
    "3.8\nAdvanced Counting Using PIE\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Apply the principle of inclusion/exclusion to solve counting problems\ninvolving multisets with bounded multiplicity.\n",
    "2. Apply the principle of inclusion/exclusion to solve counting problems\ninvolving derangements.\n",
    "3. Apply the principle of inclusion/exclusion to solve counting problems\ninvolving surjective functions.\n",
    "3.8.1\nSection Preview\nInvestigate!\n",
    "You have 11 identical mini key lime pies to give to 4 children.",
    "However,\nyou don’t want any kid to get more than 3 pies.",
    "How many ways can you\ndistribute the pies?\n",
    "Sticks and stones allows us to count the number of ways to distribute 10 cookies\nto 3 kids and natural number solutions to 𝑥+ 𝑦+ 𝑧= 10, for example.",
    "A relatively\neasy modification allows us to put a lower bound restriction on these problems:\nPerhaps each kid must get at least two cookies or 𝑥, 𝑦, 𝑧≥2.",
    "This was done by first\nassigning each kid (or variable) 2 cookies (or units) and then distributing the rest\nusing sticks and stones.\n",
    "What if we wanted an upper bound restriction?",
    "For example, we might insist that\nno kid gets more than 4 cookies or that 𝑥, 𝑦, 𝑧≤4.",
    "It turns out this is considerably\nharder.\n",
    "Notice that if we consider the complementary event, i.e., distributions of cookies\nin which kids do get more than 4 cookies, then we are back to a sticks and stones\nproblem with a lower bound.",
    "If we could count this, then subtracting from the total\nnumber of distributions should give us the desired answer.",
    "However, the problem\nis that the complement of “no kid gets more than 4 cookies” is “at least one kid gets\nmore than 4 cookies.”",
    "We know how to take care of requiring all kids getting at\nleast 4 cookies, but how do we handle the case where one or more kids get at least 4\ncookies?",
    "We must use PIE.\n290\n\n3.8.",
    "Advanced Counting Using PIE\n291\nPreview Activity\nFirst, let’s review some sticks and stones type questions we learned about in\nSection 3.5.\n",
    "Then we will modify this and apply the principle of inclusion/exclusion from\nSection 3.3.\n",
    "1.\nSuppose we have 10 cookies to give away to three children, Albie, Bertie, and\nCharlie.\n",
    "(a) How many ways can we distribute the cookies with no restrictions?\n(b) How many ways can we distribute the cookies if each child must get at\nleast two cookies?\nHint.\n",
    "Give each kid the minimum number of cookies first.",
    "How many\nways are there to distribute the remaining cookies?\n(c) How many ways can you distribute the cookies if Albie gets at least 3\ncookies and Bertie gets at least 2 cookies (and Charlie has no restrictions)?\n",
    "2.\nLet’s again consider the 10 cookies we want to distribute to Albie, Bertie, and\nCharlie.",
    "This time, we will impose some upper bound restrictions.\n",
    "(a) How many ways can we distribute the cookies if Albie does get more than\n3 cookies (so at least 4)?\n",
    "How many ways can we distribute the cookies if Albie does not get more\nthan 3 cookies?\n(b) How many ways can we distribute the cookies if Bertie does get more than\n3 cookies?\n",
    "(c) How many ways can we distribute the cookies if both Albie and Bertie do\nget more than 3 cookies?\n",
    "(d) Using the Principle of Inclusion/Exclusion for two sets, how many ways\ncan we distribute the cookies if at least one of Albie or Bertie gets more\nthan 3 cookies?",
    "So either Albie gets more than 3 cookies, Bertie gets more\nthan 3 cookies, or both get more than 3 cookies.\n",
    "(e) How many ways can we distribute the cookies if neither Albie nor Bertie\ngets more than 3 cookies?\n3.8.2\nPIE for Multisets\nThe Principle of Inclusion/Exclusion (PIE) gives a method for finding the cardinality\nof the union of not necessarily disjoint sets.",
    "We saw in Section 3.3 how this works\nwith three sets.",
    "To find how many things are in one or more of the sets 𝐴, 𝐵, and\n𝐶, we should just add up the number of things in each of these sets.",
    "However, if\n\n292\n3.",
    "Counting\nthere is any overlap among the sets, those elements are counted multiple times.",
    "So\nwe subtract the things in each intersection of a pair of sets.",
    "But doing this removes\nelements that are in all three sets once too often, so we need to add it back in.",
    "In\nterms of the cardinality of sets, we have\n|𝐴∪𝐵∪𝐶| = |𝐴| + |𝐵| + |𝐶| −|𝐴∩𝐵| −|𝐴∩𝐶| −|𝐵∩𝐶| + |𝐴∩𝐵∩𝐶|.\n",
    "Example 3.8.1\nThree kids, Alberto, Bernadette, and Carlos, decide to share 11 cookies.",
    "They\nwonder how many ways they could split the cookies up provided that none of\nthem receive more than 4 cookies (someone receiving no cookies is for some\nreason acceptable to these kids).\n",
    "Solution.\n",
    "Without the “no more than 4” restriction, the answer would be\n\u000013\n2\n\u0001, using 11 stones and 2 sticks (separating the three kids).",
    "Now count the\nnumber of ways that one or more of the kids violates the condition, i.e., gets\nat least 4 cookies.\n",
    "Let 𝐴be the set of outcomes in which Alberto gets more than 4 cookies.\n",
    "Let 𝐵be the set of outcomes in which Bernadette gets more than 4 cookies.\n",
    "Let 𝐶be the set of outcomes in which Carlos gets more than 4 cookies.",
    "We\nthen are looking (for the sake of subtraction) for the size of the set 𝐴∪𝐵∪𝐶.\nUsing PIE, we must find the sizes of |𝐴|, |𝐵|, |𝐶|, |𝐴∩𝐵| and so on.",
    "Here is\nwhat we find.\n",
    "• |𝐴| = \u00008\n2\n\u0001. First give Alberto 5 cookies, then distribute the remaining 6\nto the three kids without restrictions, using 6 stones and 2 sticks.\n",
    "• |𝐵| = \u00008\n2\n\u0001\n.",
    "Just like above, only now Bernadette gets 5 cookies at the start.\n",
    "• |𝐶| = \u00008\n2\n\u0001\n.",
    "Carlos gets 5 cookies first.\n",
    "• |𝐴∩𝐵| = \u00003\n2\n\u0001. Give Alberto and Bernadette 5 cookies each, leaving 1\n(stone) to distribute to the three kids (2 sticks).\n",
    "• |𝐴∩𝐶| = \u00003\n2\n\u0001\n.",
    "Alberto and Carlos get 5 cookies first.\n",
    "• |𝐵∩𝐶| = \u00003\n2\n\u0001\n.",
    "Bernadette and Carlos get 5 cookies first.\n",
    "• |𝐴∩𝐵∩𝐶| = 0.",
    "It is not possible for all three kids to get 4 or more\ncookies.\n",
    "Combining all of these we see\n|𝐴∪𝐵∪𝐶| =\n\u0012\n8\n2\n\u0013\n+\n\u0012\n8\n2\n\u0013\n+\n\u0012\n8\n2\n\u0013\n−\n\u0012\n3\n2\n\u0013\n−\n\u0012\n3\n2\n\u0013\n−\n\u0012\n3\n2\n\u0013\n",
    "+ 0",
    "= 75.\n",
    "Thus the answer to the original question is \u000013\n2\n\u0001\n−75",
    "= 78 −75 = 3.",
    "This\nmakes sense now that we see it.",
    "The only way to ensure that no kid gets more\n\n3.8.",
    "Advanced Counting Using PIE\n293\nthan 4 cookies is to give two kids 4 cookies and one kid 3; there are three\nchoices for which kid that should be.",
    "We could have found the answer much\nquicker through this observation, but the point of the example is to illustrate\nthat PIE works!\n",
    "For four or more sets, we do not write down a formula for PIE.",
    "Instead, we just\nthink of the principle: Add up all the elements in single sets and then subtract out\nthings you counted twice (elements in the intersection of a pair of sets); then add\nback in elements you removed too often (elements in the intersection of groups of\nthree sets); then take back out elements you added back in too often (elements in\nthe intersection of groups of four sets); then add back in, take back out, add back\nin, etc.",
    "This would be very difficult if it wasn’t for the fact that in these problems,\nall the cardinalities of the single sets are equal, as are all the cardinalities of the\nintersections of two sets, and that of three sets, and so on.",
    "Thus we can group all of\nthese together and multiply by how many different combinations of 1, 2, 3, . . .",
    "sets\nthere are.\n",
    "Example 3.8.2\nHow many ways can you distribute 10 cookies to 4 kids so that no kid gets\nmore than 2 cookies?\nSolution.\n",
    "There are \u000013\n3\n\u0001 ways to distribute 10 cookies to 4 kids (using 10\nstones and 3 sticks).",
    "We will subtract all the outcomes in which a kid gets 3\nor more cookies.",
    "How many outcomes are there like that?",
    "We can force kid\nA to eat 3 or more cookies by giving him 3 cookies before we start.",
    "Doing\nso reduces the problem to one in which we have 7 cookies to give to 4 kids\nwithout any restrictions.",
    "In that case, we have 7 stones (the 7 remaining\ncookies) and 3 sticks (one less than the number of kids) so we can distribute\nthe cookies in \u000010\n3\n\u0001 ways.",
    "Of course we could choose any one of the 4 kids\nto give too many cookies, so it would appear that there are \u00004\n1\n\u0001 \u000010\n3\n\u0001 ways\nto distribute the cookies giving too many to one kid.",
    "But in fact, we have\novercounted.\n",
    "We must get rid of the outcomes in which two kids have too many cookies.\n",
    "There are \u00004\n2\n\u0001 ways to select 2 kids to give extra cookies.",
    "It takes 6 cookies to\ndo this, leaving only 4 cookies.",
    "So we have 4 stones and still 3 sticks.",
    "The\nremaining 4 cookies can thus be distributed in \u00007\n3\n\u0001 ways (for each of the \u00004\n2\n\u0001\nchoices of which 2 kids to over-feed).\n",
    "But now we have removed too much.",
    "We must add back in all the ways to\ngive too many cookies to three kids.",
    "This uses 9 cookies, leaving only 1 to\ndistribute to the 4 kids using sticks and stones, which can be done in \u00004\n3\n\u0001\nways.\n",
    "We must consider this outcome for every possible choice of which three kids\nwe over-feed, and there are \u00004\n3\n\u0001\nways of selecting that set of 3 kids.\n",
    "Next we would subtract all the ways to give four kids too many cookies,\n\n294\n3.",
    "Counting\nbut in this case, that number is 0.\n",
    "All together we get that the number of ways to distribute 10 cookies to 4\nkids without giving any kid more than 2 cookies is:\n\u0012\n13\n3\n\u0013\n−\n\u0014\u0012\n4\n1\n\u0013 \u0012\n10\n3\n\u0013\n−\n\u0012\n4\n2\n\u0013 \u0012\n7\n3\n\u0013\n+\n\u0012\n4\n3\n\u0013 \u0012\n4\n3\n\u0013\u0015\nwhich is\n286 −[480 −210 + 16] = 0.\n",
    "This makes sense: There is NO way to distribute 10 cookies to 4 kids and\nmake sure that nobody gets more than 2.",
    "It is slightly surprising that\n\u0012\n13\n3\n\u0013\n=\n\u0014\u0012\n4\n1\n\u0013 \u0012\n10\n3\n\u0013\n−\n\u0012\n4\n2\n\u0013 \u0012\n7\n3\n\u0013\n+\n\u0012\n4\n3\n\u0013 \u0012\n4\n3\n\u0013\u0015\n,\nbut since PIE works, this equality must hold.\n",
    "Just so you don’t think that these problems always have easier solutions, consider\nthe following example.\n",
    "Example 3.8.3\nEarlier (Example 3.5.6) we counted the number of solutions to the equation\n𝑥1 + 𝑥2 + 𝑥3 + 𝑥4 + 𝑥5 = 13,\nwhere 𝑥𝑖≥0 for each 𝑥𝑖.\nHow many of those solutions have 0 ≤𝑥𝑖≤3 for each 𝑥𝑖?\nSolution.\n",
    "We must subtract off the number of solutions in which one or\nmore of the variables has a value greater than 3.",
    "We will need to use PIE\nbecause counting the number of solutions for which each of the five variables\nseparately are greater than 3 counts solutions multiple times.",
    "Here is what\nwe get:\n• Total solutions: \u000017\n4\n\u0001\n.\n",
    "• Solutions where 𝑥1 > 3: \u000013\n4\n\u0001. Give 𝑥1 4 units first; then distribute the\nremaining 9 units to the 5 variables.\n",
    "• Solutions where 𝑥1 > 3 and 𝑥2 > 3: \u00009\n4\n\u0001\n.",
    "After you give 4 units to 𝑥1 and\nanother 4 to 𝑥2, you only have 5 units left to distribute.\n",
    "• Solutions where 𝑥1 > 3, 𝑥2 > 3 and 𝑥3 > 3: \u00005\n4\n\u0001\n.\n",
    "• Solutions where 𝑥1 > 3, 𝑥2 > 3, 𝑥3 > 3, and 𝑥4 > 3: 0.\n\n3.8.",
    "Advanced Counting Using PIE\n295\nWe also need to account for the fact that we could choose any of the five\nvariables in the place of 𝑥1 above (so there will be \u00005\n1\n\u0001 outcomes like this),\nany pair of variables in the place of 𝑥1 and 𝑥2 (\u00005\n2\n\u0001 outcomes) and so on.",
    "It is\nbecause of this that the double counting occurs, so we need to use PIE.",
    "All\ntogether we have that the number of solutions with 0 ≤𝑥𝑖≤3 is\n\u0012\n17\n4\n\u0013\n",
    "−\n\u0014\u0012\n5\n1\n\u0013 \u0012\n13\n4\n\u0013\n−\n\u0012\n5\n2\n\u0013 \u0012\n9\n4\n\u0013\n+\n\u0012\n5\n3\n\u0013 \u0012\n5\n4\n\u0013\u0015\n= 15.\n",
    "3.8.3\nCounting Derangements\nInvestigate!\n",
    "For your senior prank, you decide to switch the nameplates on your favorite\n5 professors’ doors.",
    "So that none of them feel left out, you want to make\nsure that all of the nameplates end up on the wrong door.",
    "How many ways\ncan this be accomplished?\n",
    "The advanced use of PIE has applications beyond sticks and stones.",
    "A derange-\nment of 𝑛elements {1, 2, 3, . . .",
    ", 𝑛} is a permutation in which no element is fixed.\n",
    "For example, there are 6 permutations of the three elements {1, 2, 3}:\n123 132 213 231 312 321.\nbut most of these have one or more elements fixed: 123 has all three elements fixed\nsince all three elements are in their original positions, 132 has the first element fixed\n(1 is in its original first position), and so on.",
    "In fact, the only derangements of three\nelements are\n231 and 312.\n",
    "If we go up to 4 elements, there are 24 permutations (because we have 4 choices\nfor the first element, 3 choices for the second, 2 choices for the third leaving only\n1 choice for the last).",
    "How many of these are derangements?",
    "If you list out all 24\npermutations and eliminate those that are not derangements, you will be left with\njust 9 derangements.",
    "Let’s see how we can get that number using PIE.\n",
    "Example 3.8.4\nHow many derangements are there of 4 elements?\nSolution.\n",
    "We count all permutations and subtract those that are not derange-\nments.",
    "There are 4! = 24 permutations of 4 elements.",
    "Now for a permutation\nto not be a derangement, at least one of the 4 elements must be fixed.",
    "There\nare \u00004\n1\n\u0001 choices for which single element we fix.",
    "Once fixed, we need to find\n\n296\n3.",
    "Counting\na permutation of the other three elements.",
    "There are 3! permutations on 3\nelements.\n",
    "But now we have counted too many non-derangements, so we must\nsubtract those permutations that fix two elements.",
    "There are \u00004\n2\n\u0001 choices for\nwhich two elements we fix, and then for each pair, 2! permutations of the\nremaining elements.",
    "But this subtracts too many, so add back in permutations\nthat fix 3 elements, all \u00004\n3\n\u00011! of them.",
    "Finally subtract the \u00004\n4\n\u00010! permutations\n(recall 0!",
    "= 1) which fix all four elements.",
    "All together we get that the number\nof derangements of 4 elements is:\n4!",
    "−\n\u0014\u0012\n4\n1\n\u0013\n3!",
    "−\n\u0012\n4\n2\n\u0013\n2!",
    "+\n\u0012\n4\n3\n\u0013\n",
    "1!",
    "−\n\u0012\n4\n4\n\u0013\n0!\n\u0015\n= 24 −15 = 9.\n",
    "Of course we can use a similar formula to count the derangements of any number\nof elements.",
    "However, the more elements we have, the longer the formula gets.",
    "Here\nis another example:\nExample 3.8.5\n",
    "Five gentlemen attend a party, leaving their hats at the door.",
    "At the end of\nthe party, they hastily grab hats on their way out.",
    "How many different ways\ncould this happen so that none of the gentlemen leaves with his own hat?\n",
    "Solution.\n",
    "We are counting derangements on 5 elements.",
    "There are 5! ways\nfor the gentlemen to grab hats in any order—but many of these permutations\nwill result in someone getting their own hat.",
    "So we subtract all the ways in\nwhich one or more of the men get their own hat.",
    "In other words, we subtract\nthe non-derangements.",
    "Doing so requires PIE.",
    "Thus the answer is:\n5!",
    "−\n\u0014\u0012\n5\n1\n\u0013\n4!",
    "−\n\u0012\n5\n2\n\u0013\n3!",
    "+\n\u0012\n5\n3\n\u0013\n",
    "2! −\n\u0012\n5\n4\n\u0013\n1! +\n\u0012\n5\n5\n\u0013\n0!\n\u0015\n.\n",
    "3.8.4\nCounting Functions\nInvestigate!\n1. Consider all functions 𝑓: {1, 2, 3, 4, 5} →{1, 2, 3, 4, 5}.",
    "How many\nfunctions are there in total?",
    "How many of those are injective?",
    "Re-\nmember, a function is an injection if every input goes to a different\noutput.\n",
    "2. Consider all functions 𝑓: {1, 2, 3, 4, 5} →{1, 2, 3, 4, 5}.",
    "How many of\nthe injections have the property that 𝑓(𝑥) ≠𝑥for any 𝑥∈{1, 2, 3, 4, 5}?\n\n3.8.",
    "Advanced Counting Using PIE\n297\n",
    "Your friend claims that the answer is:\n5!",
    "−\n\u0014\u0012\n5\n1\n\u0013\n4!",
    "−\n\u0012\n5\n2\n\u0013\n3!",
    "+\n\u0012\n5\n3\n\u0013\n",
    "2! −\n\u0012\n5\n4\n\u0013\n1! +\n\u0012\n5\n5\n\u0013\n0!\n\u0015\n.\n",
    "Explain why this is correct.\n",
    "3. Recall that a surjection is a function for which every element of\nthe codomain is in the range.\n",
    "How many of the functions 𝑓:\n{1, 2, 3, 4, 5} →{1, 2, 3, 4, 5} are surjective?",
    "Use PIE!\n",
    "We have seen throughout this chapter that many counting questions can be\nrephrased as questions about counting functions with certain properties.",
    "This is\nreasonable since many counting questions can be thought of as counting the number\nof ways to assign elements from one set to elements of another.\n",
    "Example 3.8.6\nYou decide to give away your video game collection so as to better spend\nyour time studying advanced mathematics.",
    "How many ways can you do this,\nprovided:\n1.",
    "You want to distribute your 3 different PS4 games among 5 friends, so\nthat no friend gets more than one game?\n",
    "2.",
    "You want to distribute your 8 different 3DS games among 5 friends?\n",
    "3.",
    "You want to distribute your 8 different SNES games among 5 friends, so\nthat each friend gets at least one game?\n",
    "In each case, model the counting question as a function counting question.\n",
    "Solution.\n",
    "1.",
    "We must use the three games (call them 1, 2, 3) as the domain and the 5\nfriends (a,b,c,d,e) as the codomain (otherwise the function would not\nbe defined for the whole domain when a friend didn’t get any game).\n",
    "So how many functions are there with domain {1, 2, 3} and codomain\n{𝑎, 𝑏, 𝑐, 𝑑, 𝑒}?",
    "The answer to this is 53 = 125, since we can assign any of\n5 elements to be the image of 1, any of 5 elements to be the image of 2\nand any of 5 elements to be the image of 3.\n",
    "But this is not the correct answer to our counting problem, because one\nof these functions is 𝑓=\n\u0012\n1\n2\n3\n𝑎\n𝑎\n𝑎\n\u0013\n; one friend can get more than one\n\n298\n3.",
    "Counting\ngame.",
    "What we really need to do is count injective functions.",
    "This gives\n𝑃(5, 3) = 60 functions, which is the answer to our counting question.\n",
    "2.",
    "Again, we need to use the 8 games as the domain and the 5 friends as\nthe codomain.",
    "We are counting all functions, so the number of ways to\ndistribute the games is 58.\n",
    "3.",
    "This question is harder.",
    "Use the games as the domain and friends as the\ncodomain (the reverse would not give a function).",
    "To ensure that every\nfriend gets at least one game means that every element of the codomain\nis in the range.",
    "In other words, we are looking for surjective functions.\n",
    "How do you count those?\n",
    "In Example 3.2.13 we saw how to count all functions (using the multiplicative\nprinciple) and in Example 3.4.7 we learned how to count injective functions (using\npermutations).",
    "Surjective functions are not as easily counted (unless the size of the\ndomain is smaller than the codomain, in which case there are none).\n",
    "The idea is to count the functions that are not surjective, and then subtract that\nfrom the total number of functions.",
    "This works very well when the codomain has\ntwo elements in it:\n",
    "Example 3.8.7\nHow many functions 𝑓: {1, 2, 3, 4, 5} →{𝑎, 𝑏} are surjective?\nSolution.\n",
    "There are 25 functions total, two choices for where to send each\nof the 5 elements of the domain.",
    "Now of these, the functions that are not\nsurjective must exclude one or more elements of the codomain from the range.\n",
    "So first, consider functions for which 𝑎is not in the range.",
    "This can only\nhappen one way: Everything gets sent to 𝑏.",
    "Alternatively, we could exclude 𝑏\nfrom the range.",
    "Then everything gets sent to 𝑎, so there is only one function\nlike this.",
    "These are the only ways in which a function could not be surjective\n(no function excludes both 𝑎and 𝑏from the range) so there are exactly 25 −2\nsurjective functions.\n",
    "When there are three elements in the codomain, there are now three choices for\na single element to exclude from the range.",
    "Additionally, we could pick pairs of two\nelements to exclude from the range, and we must make sure we don’t overcount\nthese.",
    "It’s PIE time!\n",
    "Example 3.8.8\nHow many functions 𝑓: {1, 2, 3, 4, 5} →{𝑎, 𝑏, 𝑐} are surjective?\nSolution.\n",
    "Again start with the total number of functions: 35 (as each of the\nfive elements of the domain can go to any of three elements of the codomain).\n\n",
    "3.8.",
    "Advanced Counting Using PIE\n299\n",
    "Now we count the functions that are not surjective.\nStart by excluding 𝑎from the range.",
    "Then we have two choices (𝑏or 𝑐)\nfor where to send each of the five elements of the domain.",
    "Thus there are 25\nfunctions that exclude 𝑎from the range.",
    "Similarly, there are 25 functions that\nexclude 𝑏, and another 25 that exclude 𝑐.",
    "Now have we counted all functions\nthat are not surjective?",
    "Yes, but in fact, we have counted some multiple times.\n",
    "For example, the function which sends everything to 𝑐was one of the 25\nfunctions we counted when we excluded 𝑎from the range, and also one of\nthe 25 functions we counted when we excluded 𝑏from the range.",
    "We must\nsubtract out all the functions which specifically exclude two elements from\nthe range.",
    "There is 1 function when we exclude 𝑎and 𝑏(everything goes to\n𝑐), one function when we exclude 𝑎and 𝑐, and one function when we exclude\n𝑏and 𝑐.\n",
    "We are using PIE: To count the functions that are not surjective, we added\nup the functions that exclude 𝑎, 𝑏, and 𝑐separately; then subtracted the\nfunctions that exclude pairs of elements.",
    "We would then add back in the\nfunctions that exclude groups of three elements, except that there are no such\nfunctions.",
    "We find that the number of functions that are not surjective is\n25 + 25 + 25",
    "−1 −1 −1 + 0.\n",
    "Perhaps a more descriptive way to write this is\n\u0012\n3\n1\n\u0013\n25 −\n\u0012\n3\n2\n\u0013\n15 +\n\u0012\n3\n3\n\u0013\n05.\n",
    "since each of the 25’s was the result of choosing 1 of the 3 elements of the\ncodomain to exclude from the range; each of the three 15’s was the result of\nchoosing 2 of the 3 elements of the codomain to exclude.",
    "Writing 15 instead of\n1 makes sense too: We have 1 choice of where to send each of the 5 elements\nof the domain.\n",
    "Now we can finally count the number of surjective functions:\n35 −\n\u0014\u0012\n3\n1\n\u0013\n25 −\n\u0012\n3\n2\n\u0013\n15\n\u0015\n= 150.\n",
    "You might worry that to count surjective functions when the codomain is larger\nthan 3 elements would be too tedious.",
    "We need to use PIE but with more than 3\nsets the formula for PIE is very long.",
    "However, we have lucked out.",
    "As we saw\nin the example above, the number of functions that exclude a single element from\nthe range is the same no matter which single element is excluded.",
    "Similarly, the\nnumber of functions that exclude a pair of elements will be the same for every pair.\n",
    "With larger codomains, we will see the same behavior with groups of 3, 4, and more\nelements excluded.",
    "So instead of adding/subtracting each of these, we can simply\nadd or subtract all of them at once, if you know how many there are.",
    "This works just\n\n300\n3.",
    "Counting\nlike it did in for the other types of counting questions in this section, only now the\nsize of the various combinations of sets is a number raised to a power, as opposed to\na binomial coefficient or factorial.",
    "Here’s what happens with 4 and 5 elements in the\ncodomain.\n",
    "Example 3.8.9\n1.",
    "How many functions 𝑓: {1, 2, 3, 4, 5} →{𝑎, 𝑏, 𝑐, 𝑑} are surjective?\n",
    "2.",
    "How many functions 𝑓: {1, 2, 3, 4, 5} →{𝑎, 𝑏, 𝑐, 𝑑, 𝑒} are surjective?\nSolution.\n",
    "1.",
    "There are 45 functions all together; we will subtract the functions that\nare not surjective.",
    "We could exclude any one of the four elements of\nthe codomain, and doing so will leave us with 35 functions for each\nexcluded element.",
    "This counts too many, so we subtract the functions\nthat exclude two of the four elements of the codomain, each pair giving\n25 functions.",
    "But this excludes too many, so we add back in the functions\nthat exclude three of the four elements of the codomain, each triple\ngiving 15 function.",
    "There are \u00004\n1\n\u0001\ngroups of functions excluding a single\nelement, \u00004\n2\n\u0001 groups of functions excluding a pair of elements, and \u00004\n3\n\u0001\ngroups of functions excluding a triple of elements.",
    "This means that the\nnumber of functions that are not surjective is:\n\u0012\n4\n1\n\u0013\n35 −\n\u0012\n4\n2\n\u0013\n25 +\n\u0012\n4\n3\n\u0013\n15.\n",
    "We can now say that the number of functions that are surjective is:\n",
    "45 −\n\u0014\u0012\n4\n1\n\u0013\n35 −\n\u0012\n4\n2\n\u0013\n25 +\n\u0012\n4\n3\n\u0013\n15\n\u0015\n.\n",
    "2.",
    "The number of surjective functions is:\n55 −\n\u0014\u0012\n5\n1\n\u0013\n45 −\n\u0012\n5\n2\n\u0013\n35 +\n\u0012\n5\n3\n\u0013\n25 −\n\u0012\n5\n4\n\u0013\n15\n\u0015\n.\n",
    "We took the total number of functions 55 and subtracted all that were\nnot surjective.",
    "There were \u00005\n1\n\u0001 ways to select a single element from\nthe codomain to exclude from the range, and for each there were 45\nfunctions.",
    "But this double counts, so we use PIE and subtract functions\nexcluding two elements from the range: There are \u00005\n2\n\u0001 choices for the\ntwo elements to exclude, and for each pair, 35 functions.",
    "This takes out\ntoo many functions, so we add back in functions that exclude 3 elements\nfrom the range: \u00005\n3\n\u0001\nchoices for which 3 to exclude, and then 25 functions\n\n3.8.",
    "Advanced Counting Using PIE\n301\nfor each choice of elements.",
    "Finally we take back out the 1 function that\nexcludes 4 elements for each of the \u00005\n4\n\u0001\nchoices of 4 elements.\n",
    "If you happen to calculate this number precisely, you will get 120\nsurjections.",
    "That happens to also be the value of 5!.",
    "This might seem like\nan amazing coincidence until you realize that every surjective function\n𝑓: 𝑋→𝑌with |𝑋|",
    "= |𝑌| finite must necessarily be a bĳection.",
    "The\nnumber of bĳections is always |𝑋|!",
    "in this case.",
    "What we have here is a\ncombinatorial proof of the following identity:\n𝑛𝑛−\n\u0014\u0012\n𝑛\n1\n\u0013\n(𝑛−1)𝑛−\n\u0012\n𝑛\n2\n\u0013\n(𝑛−2)𝑛+ · · · +\n\u0012\n𝑛\n𝑛−1\n\u0013\n1𝑛\n\u0015\n= 𝑛!.\n",
    "We have seen that counting surjective functions is another nice example of\nthe advanced use of the principle of inclusion/exclusion.",
    "Also, counting injective\nfunctions turns out to be equivalent to permutations, and counting all functions\nhas a solution akin to those counting problems where order matters but repeats\nare allowed (like counting the number of words you can make from a given set of\nletters).\n",
    "These are not just a few more examples of the techniques we have developed in\nthis chapter.",
    "Quite the opposite: Everything we have learned in this chapter is an\nexample of counting functions!\n",
    "Example 3.8.10\nHow many 5-letter words can you make using the eight letters 𝑎through ℎ?\nHow many contain no repeated letters?\nSolution.\n",
    "By now it should be no surprise that there are 85 words, and 𝑃(8, 5)\nwords without repeated letters.",
    "The new piece here is that we are actually\ncounting functions.",
    "For the first problem, we are counting all functions from\n{1, 2, . . .",
    ", 5} to {𝑎, 𝑏, . .",
    ". , ℎ}.",
    "The numbers in the domain represent the position\nof the letter in the word; the codomain represents the letter that could be\nassigned to that position.",
    "If we ask for no repeated letters, we are asking for\ninjective functions.\n",
    "If 𝐴and 𝐵are any sets with |𝐴| = 5 and |𝐵| = 8, then the number of\nfunctions 𝑓: 𝐴→𝐵is 85 and the number of injections is 𝑃(8, 5).",
    "So if you\ncan represent your counting problem as a function counting problem, most\nof the work is done.\n",
    "Example 3.8.11\nHow many subsets are there of {1, 2, . . .",
    ", 9}?",
    "How many 9-bit strings are\nthere (of any weight)?\n\n302\n3.",
    "Counting\nSolution.\n",
    "We saw in Section 3.1 that the answer to both these questions\nis 29, as we can say yes or no (or 0 or 1) to each of the 9 elements in the set\n(positions in the bit-string).",
    "But 29 also looks like the answer you get from\ncounting functions.",
    "In fact, if you count all functions 𝑓: 𝐴→𝐵with |𝐴| = 9\nand |𝐵| = 2, this is exactly what you get.\n",
    "This makes sense!",
    "Let 𝐴= {1, 2, . . .",
    ", 9} and 𝐵= {𝑦, 𝑛}.",
    "We are assigning\neach element of the set either a yes or a no.",
    "Or in the language of bit-strings,\nwe would take the 9 positions in the bit string as our domain and the set {0, 1}\nas the codomain.\n",
    "So far we have not used a function as a model for binomial coefficients (combi-\nnations).",
    "Think for a moment about the relationship between combinations and\npermutations, say specifically \u00009\n3\n\u0001\nand 𝑃(9, 3).",
    "We do have a function model for 𝑃(9, 3).\n",
    "This is the number of injective functions from a set of size 3 (say {1, 2, 3} to a set of\nsize 9 (say {1, 2, . . .",
    ", 9}) since there are 9 choices for where to send the first element\nof the domain, then only 8 choices for the second, and 7 choices for the third.",
    "For\nexample, the function might look like this:\n𝑓(1) = 5\n𝑓(2)",
    "= 8\n𝑓(3)",
    "= 4.\n",
    "This is a different function from:\n𝑓(1) = 4\n𝑓(2)",
    "= 5\n𝑓(3)",
    "= 8.\n",
    "Now 𝑃(9, 3) counts these as different outcomes correctly, but \u00009\n3\n\u0001\nwill count these\n(among others) as just one outcome.",
    "In fact, in terms of functions \u00009\n3\n\u0001 just counts\nthe number of possible ranges for injective functions.",
    "This should not be a surprise\nsince binomial coefficients count subsets, and the range is a possible subset of the\ncodomain.5\nWhile it is possible to interpret combinations as functions, perhaps the better\nadvice is to instead use combinations (or sticks and stones) when functions are not\nquite the right way to interpret the counting question.\n",
    "3.8.5\nPractice Problems\n1.\n",
    "The dollar menu at your favorite tax-free fast food restaurant has 7 items.",
    "You\nhave $16 to spend.",
    "How many different meals can you buy if you spend all\nyour money and",
    ":\na. Purchase at least one of each item.\n",
    "b.",
    "Possibly skip some items.\n",
    "c. Don’t get more than 2 of any particular item.\n",
    "5A more mathematically sophisticated interpretation of combinations is that we are defining two\ninjective functions to be equivalent if they have the same range, and then counting the number of\nequivalence classes under this notion of equivalence.\n\n3.8.",
    "Advanced Counting Using PIE\n303\n2.\n",
    "After a late night of math studying, you and your friends decide to go to your\nfavorite tax-free fast food Mexican restaurant, Burrito Chime.",
    "You decide to\norder off of the dollar menu, which has 6 items.",
    "Your group has $17 to spend\n(and will spend all of it).\n",
    "a. How many different orders are possible?",
    "(The order in which the order\nis placed does not matter, just which and how many of each item that is\nordered.)\nb.",
    "How many different orders are possible if you want to get at least one of\neach item?\n",
    "c. How many different orders are possible if you don’t want to get more\nthan 4 of any one item?\n",
    "3.\nAfter another gym class you are tasked with putting the 14 identical dodgeballs\naway into 5 bins.",
    "This time, no bin can hold more than 6 balls.",
    "How many\nways can you clean up?\n4.\nConsider the equation 𝑥1 + 𝑥2 + 𝑥3 + 𝑥4 = 19.",
    "How many solutions are there\nwith 1 ≤𝑥𝑖≤6 for all 𝑖∈{1, 2, 3, 4}?\n",
    "5.\nSuppose you planned on giving 7 gold stars to some of the 12 star students in\nyour class.",
    "Each student can receive at most one star.",
    "How many ways can you\ndo this?\na. Use Pascal’s triangle to find the numeric answer.\n",
    "a. Use the principle of inclusion/exclusion.\n",
    "6.\n",
    "How many permutations of {1, 2, 3, 4} leave exactly 1 element fixed?\n7.\n12 ladies of a certain age drop off their red hats at the hat check of a museum.\n",
    "As they are leaving, the hat check attendant gives the hats back randomly.",
    "In\nhow many ways can exactly 8 of the ladies receive their own hat (and the other\n4 not)?\n",
    "8.\n",
    "The Grinch sneaks into a room in which there are 8 Christmas presents for 8\ndifferent people.",
    "He proceeds to switch the name labels on the presents.",
    "How\nmany ways could he do this if:\na.",
    "No present is allowed to end up with its original label?",
    "Explain what\neach term in your answer represents.\n",
    "b.",
    "Exactly 4 presents keep their original labels?",
    "Explain.\n",
    "c. Exactly 7 presents keep their original labels?",
    "Explain.\n",
    "9.\nConsider functions 𝑓: {1, 2, 3, 4, 5, 6, 7, 8} →{𝑎, 𝑏, 𝑐, 𝑑, 𝑒, 𝑓}.",
    "How many\nfunctions have the property that 𝑓(1) ≠𝑐or 𝑓(2) ≠𝑓, or both?\n10.\nConsider sets 𝐴and 𝐵with |𝐴| = 8 and |𝐵| = 5.",
    "How many functions 𝑓: 𝐴→𝐵\nare surjective?\n\n304\n3.",
    "Counting\n11.\n",
    "Let 𝐴= {1, 2, 3, 4, 5, 6, 7}.",
    "How many injective functions 𝑓: 𝐴→𝐴have the\nproperty that for each 𝑥∈𝐴, 𝑓(𝑥) ≠𝑥?\n3.8.6\nAdditional Exercises\n1.\n",
    "Based on the previous question, give a combinatorial proof for the identity:\n\u0012\n𝑛\n𝑘\n\u0013\n=\n\u0012\n𝑛+ 𝑘−1\n𝑘\n\u0013\n−\n𝑛\nÕ\n𝑗=1\n(−1)𝑗+1\n\u0012\n𝑛\n𝑗\n\u0013 \u0012𝑛+",
    "𝑘−(2𝑗+ 1)\n𝑘−2𝑗\n\u0013\n.\n",
    "2.\nIllustrate how the counting of derangements works by writing all permutations\nof {1, 2, 3, 4} and then crossing out those which are not derangements.",
    "Keep\ntrack of the permutations you cross out more than once, using PIE.\n",
    "3.\nLet 𝑑𝑛be the number of derangements of 𝑛objects.",
    "For example, using the\ntechniques of this section, we find\n𝑑3 = 3!",
    "−\n\u0012\u0012\n3\n1\n\u0013\n2!",
    "−\n\u0012\n3\n2\n\u0013\n1!",
    "+\n\u0012\n3\n3\n\u0013\n0!\n",
    "\u0013\n.\n",
    "We can use the formula for \u0000𝑛\n𝑘\n\u0001 to write this all in terms of factorials.",
    "After\nsimplifying, for 𝑑3 we would get\n𝑑3 = 3!\n\u0012\n1 −1\n1 + 1\n2 −1\n6\n\u0013\n.\n",
    "Generalize this to find a nicer formula for 𝑑𝑛. Bonus: For large 𝑛, approximately\nwhat fraction of all permutations are derangements?",
    "Use your knowledge of\nTaylor series from calculus.\n\n3.9\nChapter Summary\nInvestigate!\n",
    "Suppose you have a huge box of animal crackers containing plenty of each\nof 10 different animals.",
    "For the counting questions below, carefully examine\ntheir similarities and differences, and then give an answer.",
    "The answers are\nall one of the following:\n𝑃(10, 6),\n\u0012\n10\n6\n\u0013\n,\n106,\n\u0012\n15\n9\n\u0013\n.\n",
    "1.",
    "How many animal parades containing 6 crackers can you line up?\n2.",
    "How many animal parades of 6 crackers can you line up so that the\nanimals appear in alphabetical order?\n3.",
    "How many ways could you line up 6 different animals in alphabetical\norder?\n4.",
    "How many ways could you line up 6 different animals if they can\ncome in any order?\n5.",
    "How many ways could you give 6 children one animal cracker each?\n6.",
    "How many ways could you give 6 children one animal cracker each so\nthat no two kids get the same animal?\n",
    "7.",
    "How many ways could you give out 6 giraffes to 10 kids?\n8.",
    "Write a question about giving animal crackers to kids that has the\nanswer \u000010\n6\n\u0001\n.\n",
    "With all the different counting techniques we have mastered in this last chapter,\nit might be difficult to know when to apply which technique.",
    "Indeed, it is very easy\nto get mixed up and use the wrong counting method for a given problem.",
    "You get\nbetter with practice.",
    "As you practice, you start to notice some trends that can help\nyou distinguish between types of counting problems.",
    "Here are some suggestions\nthat you might find helpful when deciding how to tackle a counting problem and\nchecking whether your solution is correct.\n",
    "• Remember that you are counting the number of items in some list of outcomes.\n",
    "Write down part of this list.",
    "Write down an element in the middle of the list –\nhow are you deciding whether your element really is in the list?",
    "Could you\nget this element more than once using your proposed answer?\n•",
    "If generating an element on the list involves selecting something (for example,\n305\n\n306\n3.",
    "Counting\npicking a letter or picking a position to put a letter, etc.), can the things you\nselect be repeated?",
    "Remember, permutations and combinations select objects\nfrom a set without repeats.\n",
    "• Does order matter?",
    "Be careful here, and be sure you know what your answer\nreally means.",
    "We usually say that order matters when you get different\noutcomes when the same objects are selected in different orders.",
    "Combinations\nand “sticks and stones” are used when order does not matter.\n",
    "• There are four possibilities when it comes to order and repeats.",
    "If order matters\nand repeats are allowed, the answer will look like 𝑛𝑘.",
    "If order matters and\nrepeats are not allowed, we have 𝑃(𝑛, 𝑘).",
    "If order doesn’t matter and repeats\nare allowed, use sticks and stones.",
    "If order doesn’t matter and repeats are\nnot allowed, use \u0000𝑛\n𝑘\n\u0001\n.",
    "But be careful: this only applies when you are selecting\nthings, and you should make sure you know exactly what you are selecting\nbefore determining which case you are in.\n",
    "• Think about how you would represent your counting problem in terms of sets\nor functions.",
    "We know how to count different sorts of sets and different types\nof functions.\n",
    "• As we saw with combinatorial proofs, you can often solve a counting problem\nin more than one way.",
    "Do that, and compare your numerical answers.",
    "If they\ndon’t match, something is amiss.\n",
    "While we have covered many counting techniques, we have really only scratched\nthe surface of the large subject of enumerative combinatorics.",
    "There are mathematicians\ndoing original research in this area even as you read this.",
    "Counting can be really\nhard.\n",
    "In the next chapter, we will approach counting questions from a very different\ndirection, and in doing so, answer infinitely many counting questions at the same\ntime.",
    "We will create sequences of answers to related questions.\n",
    "Chapter Review\n1.\n",
    "You have 15 presents to give to your 5 kids.",
    "How many ways can this be done\nif:\na.",
    "The presents are identical, and each kid gets at least one present?\nb.",
    "The presents are identical, and some kids might get no presents?\n",
    "c.",
    "The presents are unique, and some kids might get no presents?\n",
    "d.",
    "The presents are unique and each kid gets at least one present?\n2.\n",
    "For each of the following counting problems, say whether the answer is \u000010\n4\n\u0001,\n𝑃(10, 4), or neither.",
    "If your answer is “neither,” say what the answer should be\ninstead.\n\n",
    "3.9.",
    "Chapter Summary\n307\n(a) How many shortest lattice paths are there from (0, 0) to (10, 4)?\n(b) If you have 10 bow ties, and you want to select 4 of them for next week,\nhow many choices do you have?\n",
    "(c) Suppose you have 10 bow ties and you will wear a different one on each\nof the next 4 days.",
    "How many choices do you have?\n",
    "(d) If you want to wear 4 of your 10 bow ties next week (Monday through\nSunday), in how many ways can this be accomplished?\n(e) Out of a group of 10 classmates, how many ways can you rank your top 4\nfriends?\n(f) If 10 students come to their professor’s office but only 4 can fit at a time,\nhow many different combinations of 4 students can see the prof first?\n(g) How many 4-letter words can be made from the first 10 letters of the\nalphabet?\n",
    "(h)",
    "In how many ways can you make the word “cake” from the first 10 letters\nof the alphabet?\n",
    "(i) How many ways are there to distribute 10 identical apples among 4\nchildren?\n(j) If you have 10 kids (and live in a shoe) and 4 types of cereal, in how many\nways can your kids eat breakfast?\n(k)",
    "In how many ways can you arrange exactly 4 ones in a string of 10 binary\ndigits?\n(l) You want to select 4 distinct, single-digit numbers as your lotto picks.\n",
    "How many choices do you have?\n(m) 10 kids want ice cream.",
    "You have 4 varieties.",
    "How many ways are there\nto give the kids as much ice cream as they want?\n(n) How many 1-1 functions are there from {1, 2, . . .",
    ", 10} to {𝑎, 𝑏, 𝑐, 𝑑}?\n(o) How many surjective functions are there from {1, 2, . . .",
    ", 10} to {𝑎, 𝑏, 𝑐, 𝑑}?\n(p) Each of your 10 bow ties matches 4 pairs of suspenders.",
    "How many\noutfits can you make?\n(q) After the party, the 10 kids each choose one of 4 party-favors.",
    "How many\noutcomes are there?\n(r) How many 6-elements subsets are there of the set {1, 2, . . .",
    ", 10}\n(s) In how many ways can you split up 11 kids into 5 named teams?\n\n308\n3.",
    "Counting\n(t) How many solutions are there to 𝑥1 + 𝑥2 + · · · + 𝑥5 = 6 where each 𝑥𝑖is a\nnon-negative integer?\n(u) Your band goes on tour.",
    "There are 10 cities within driving distance, but\nonly enough time to play 4 of them.",
    "How many choices do you have for\nthe cities on your tour?\n",
    "(v) In how many different ways can you play the 4 cities you choose?\n(w) Out of the 10 breakfast cereals available, you want to have 4 bowls.",
    "In\nhow many ways can you do this?\n(x) There are 10 types of cookies available.",
    "You want to make a 4 cookie\nstack.",
    "How many different stacks can you make?\n(y) From your home at (0,0) you want to go to either the donut shop at (5,4)\nor the one at (3,6).",
    "How many paths could you take?\n(z) How many 10-digit numbers do not contain a sub-string of 4 repeated\ndigits?\n",
    "3.\n",
    "Recall, you own 9 regular ties and 5 bow ties.",
    "You realize that it would be okay\nto wear more than two ties to your clown college interview.\n",
    "a. You must select some of your ties to wear.",
    "Everything is okay, from no\nties up to all ties.",
    "How many choices do you have?\nb.",
    "If you want to wear at least one regular tie and one bow tie, but are\nwilling to wear up to all your ties, how many choices do you have for\nwhich ties to wear?\n",
    "c. How many choices of which ties to wear do you have if you wear exactly\n3 of the 9 regular ties and 2 of the 5 bow ties?\n",
    "d.",
    "Once you have selected 3 regular and 2 bow ties, in how many orders\ncould you put the ties on, assuming you must have one of the bow ties\non top?\n4.\nGive a counting question where the answer is 8 · 3 · 3 · 5.",
    "Give another question\nwhere the answer is 8 + 3 + 3 + 5.\n5.\nConsider numbers of the form 𝛼= 𝑎1𝑎2𝑎3 . . .",
    "𝑎𝑛, with 𝑛digits, each digit from\nthe set {1, 2, 3, 4, 5, 6, 7, 8}.",
    "For example, if 𝑛= 4, the number 𝛼= 𝑎1𝑎2𝑎3𝑎4 will\nhave 4 digits from the set {1, 2, 3, 4, 5, 6, 7, 8}.\n",
    "Let 𝑛= 11.\n",
    "a. How many such numbers are there?\nb.",
    "How many such numbers are there for which the sum of the digits is\neven?\n",
    "c. How many such numbers contain more even digits than odd digits?\n\n3.9.",
    "Chapter Summary\n309\n6.\n",
    "In a recent small survey of airline passengers, 27 said they had flown American\nin the last year, 20 had flown Jet Blue, and 29 had flown Continental.",
    "Of those,\n13 reported they had flown on American and Jet Blue, 10 had flown on Jet Blue\nand Continental, and 11 had flown on American and Continental.",
    "6 passengers\nhad flown on all three airlines.\n",
    "How many passengers were surveyed?",
    "(Assume the results above make up\nthe entire survey.)\n",
    "7.\nRecall, by 10-bit strings, we mean strings of binary digits, of length 10.\na. How many 10-bit strings are there total?\nb.",
    "How many 10-bit strings have weight 5?\nc.",
    "How many subsets of the set {1,2,3,4,5,6,7,8,9,10} contain exactly 5 ele-\nments?\n8.\n",
    "What is the coefficient of 𝑥10 in the expansion of (𝑥+ 3)15 +",
    "𝑥3(𝑥+ 5)21?\n9.\n",
    "How many 10-letter words contain exactly 3 vowels?",
    "(For example, an 8-letter\nword with 5 vowels is “aaioobtt”; don’t consider “y” a vowel for this exercise.)\n",
    "What if repeated letters were not allowed?\n10.\n",
    "For each of the following, find the number of shortest lattice paths from (4, 4)\nto (10, 10) which:\na. pass through the point (6, 5).\n",
    "b. avoid (do not pass through) the point (9, 9).\n",
    "c. either pass through (6, 5) or (9, 9) (or both).\n",
    "11.\n",
    "You live in Grid-Town on the corner of 2nd and 4th, and work in a building on\nthe corner of 17th and 20th.",
    "How many routes are there which take you from\nhome to work and then back home, but by a different route?\n12.\n",
    "How many 11-bit strings start with 101 or end with 10 or both?\n13.\n",
    "How many 15-bit strings of weight 5 start with 101 or end with 10 or both?\n14.\n",
    "We are making 5-letter words from the set of letters 𝑎, 𝑏, 𝑐, 𝑑, 𝑒, 𝑓. .",
    "., in such a\nway that we have exactly the first 5 letters available so that we use all letters.\n",
    "a. How many 5-letter words can we make from the letters without repeats\nthat do not contain the sub-word “bad” in consecutive letters?\n",
    "a. How many words don’t contain the subword “bad” in not-necessarily-\nconsecutive letters (but in order)?\n",
    "15.\n",
    "Explain using lattice paths why Í𝑛\n𝑘=0\n\u0000𝑛\n𝑘\n\u0001\n= 2𝑛.\n16.\n",
    "Suppose you have 16 one-dollar bills to give out as prizes to your top 6 discrete\nmath students.",
    "How many ways can you do this if:\na. Each of the 6 students gets at least 1 dollar?\n\n310\n3.",
    "Counting\nb.",
    "Some students might get nothing?\n",
    "c. Each student gets at least 1 dollar but no more than 8 dollars?\n17.\n",
    "How many functions 𝑓: {1, 2, 3, 4} →{1, 2, 3, 4} are there satisfying:\na. 𝑓(1)",
    "= 1 or 𝑓(2)",
    "= 2 (or both)?\nb. 𝑓(1) ≠1 or 𝑓(2) ≠2 (or both)?\nc. 𝑓(1) ≠1 and 𝑓(2) ≠2, and 𝑓is injective?\nd. 𝑓is surjective, but ∀𝑥∈{1, 2, . . .",
    ", 4}, 𝑓(𝑥) ≠𝑥?\n18.\n",
    "How many functions map {1, 2, 3, 4, 5} onto {1, 2, 3} (i.e., how many surjections\nare there)?\n19.\n",
    "To thank your math professor for doing such an amazing job all semester, you\ndecide to bake your professor cookies.",
    "You know how to make 13 different\ntypes of cookies.\n",
    "a.",
    "If you want to give your professor 8 different types of cookies, how\nmany different combinations of cookie type can you select?",
    "Explain your\nanswer.\n",
    "b.",
    "To keep things interesting, you decide to make a different number of each\ntype of cookie.",
    "If again you want to select 8 cookie types, how many ways\ncan you select the cookie types and decide for which there will be the\nmost, second most, etc. Explain your answer.\n",
    "c. You change your mind again.",
    "This time you decide you will make a total\nof 23 cookies.",
    "Each cookie could be any one of the 13 types of cookies\nyou know how to bake (and it’s okay if you leave some types out).",
    "How\nmany choices do you have?",
    "Explain.\n",
    "d.",
    "You realize that the previous plan did not account for presentation.",
    "This\ntime, you once again want to make 23 cookies, each one could be any one\nof the 13 types of cookies.",
    "However, now you plan to shape the cookies\ninto the numerals 1, 2, ..., 23.",
    "How many choices do you have for which\ntypes of cookies to bake into which numerals?",
    "Explain.\n",
    "e.",
    "The only flaw with the last plan is that your professor might not get to\nsample all 13 different varieties of cookies.",
    "How many choices do you\nhave for which types of cookies to make into which numerals, given that\neach type of cookie should be present at least once?",
    "Explain.\n",
    "20.\n",
    "For which of the parts of the previous problem (Exercise 3.9.19) does it make\nsense to interpret the counting question as counting some number of functions?\nSay what the domain and codomain should be, and whether you are counting\nall functions, injections, surjections, or something else.\n\n",
    "Chapter 4\nSequences\nWe have encountered finite sequences already as a discrete structure and something\nwe can count.",
    "In this chapter, we will consider possibly infinite sequences of numbers.\n",
    "When the sequence itself is infinite, it no longer makes sense to ask how many\npossible sequences there are, but there is still an interesting connection to counting:\nEach term in the sequence can represent an answer to a counting question!\n",
    "4.1\nDescribing Sequences\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Use proper notation to represent a sequence.\n",
    "2. Explain the difference between a closed formula and a recursive\ndefinition for a sequence.\n",
    "3. Find a recursive definition for a sequence based on its description.\n",
    "4.1.1\nSection Preview\nInvestigate!\n",
    "There is a monastery in Hanoi, as the legend goes, with a great hall containing\nthree tall pillars.",
    "Resting on the first pillar were 64 giant disks (or washers),\nall different sizes, stacked from largest to smallest.\n",
    "The monks of the\nmonastery have been moving the disks for generations, attempting to move\nthe entire stack of disks to the third pillar.",
    "However, due to the size of the\ndisks, the monks cannot move more than one at a time.",
    "Each disk must be\nplaced on one of the pillars before the next disk is moved.",
    "And because the\ndisks are so heavy and fragile, the monks may never place a larger disk on\ntop of a smaller disk.",
    "When the monks finally complete their task, the world\nshall come to an end.\n",
    "Your task: Figure out how long it will be before we need to start worrying\nabout the end of the world.\n",
    "This puzzle is called the Tower of Hanoi.",
    "You are tasked with finding the minimum\nnumber of moves to complete the puzzle.",
    "This certainly sounds like a counting\n311\n\n312\n4.",
    "Sequences\nproblem.",
    "Perhaps you have an answer?",
    "If not, what else could we try?\n",
    "The answer to the puzzle depends on the number of disks you need to move.\n",
    "In fact, we could answer the puzzle first for 1 disk, then 2, then 3, and so on.",
    "If we\nlist all of the answers for each number of disks, we will get a sequence of numbers.\n",
    "The 𝑛th term in the sequence is the answer to the question, “What is the smallest\nnumber of moves required to complete the Tower of Hanoi puzzle with 𝑛disks?”\nGive it a try.",
    "Find the smallest number of moves needed to transport the stack of\n𝑛disks to another pillar, for different values of 𝑛.\nFigure 4.1.1",
    "The Towers of Hanoi puzzle.\n",
    "You might wonder why we would create such a sequence instead of just answering\nthe question.",
    "By looking at how the sequence of numbers grows, we gain insight\ninto the problem.",
    "It is easy to count the number of moves required for a small\nnumber of disks.",
    "We can then look for a pattern among the first few terms of the\nsequence.",
    "Hopefully this will suggest a method for finding the 𝑛th term of the\nsequence, which is the answer to our question.",
    "Of course we will also need to verify\nthat our suspected pattern is correct, and that this correct pattern really does give us\nthe 𝑛th term that we think it does, but it is impossible to prove that your formula is\ncorrect without having a formula to start with.\n",
    "In this section, we will explore how to represent sequences of numbers in various\nways, and two sorts of formulas that can be used to describe the sequence.",
    "We will\nsee that sequences are also interesting mathematical objects to study in their own\nright.\n",
    "Preview Activity\nLet’s get a feel for the sequence from the Towers of Hanoi puzzle.\n",
    "1.\n(a)",
    "What is the smallest number of moves required to transport 2 disks to\nanother pillar?\n(b) What is the smallest number of moves required to transport 3 disks to\nanother pillar?\n(c) What is the smallest number of moves required to transport 4 disks to\nanother pillar?\n(d) To find the smallest number of moves required to transport 5 disks to\nanother pillar, let’s try to relate this task to the task of moving 4 disks.\n",
    "How many moves do each of the following tasks require?\n\n4.1.",
    "Describing Sequences\n313\na. Move the 4 smallest disks to the second pillar:\nmoves.\n",
    "b. Move the largest disk to the third pillar:\nmoves.\n",
    "c. Move the 4 smallest disks to the third pillar (on top of the largest\ndisk):\nmoves.\n",
    "Therefore, the smallest number of moves required to move five disks is:\n(e) Generalize the last observation.",
    "Let 𝑎𝑛represent the smallest number of\nmoves required to transport 𝑛disks from the start pillar to another pillar.\n",
    "Then 𝑎𝑛−1 represents the number of moves required to transport 𝑛−1\ndisks to another pillar.\n",
    "Give a formula for 𝑎𝑛in terms of 𝑎𝑛−1.\n4.1.2\nSequences and Formulas\n",
    "A sequence is simply an ordered list of numbers.",
    "Unlike a set of numbers, the order\nof the numbers in a sequence is an essential characteristic of the sequence.",
    "For this\nreason, when we use variables to represent terms in a sequence they will look like\nthis:\n𝑎0, 𝑎1, 𝑎2, 𝑎3, . . . .\n",
    "To refer to the entire sequence at once, we will write (𝑎𝑛)𝑛∈ℕor (𝑎𝑛)𝑛≥0, or sometimes\nif we are being sloppy, just (𝑎𝑛) (in which case we assume we start the sequence with\n𝑎0).\n",
    "We might replace the 𝑎with another letter, and sometimes we omit 𝑎0, starting\nwith 𝑎1, in which case we would use (𝑎𝑛)𝑛≥1 to refer to the sequence as a whole.",
    "The\nnumbers in the subscripts are called indices (the plural of index).\n",
    "While we often just think of a sequence as an ordered list of numbers, it is really\na type of function.",
    "Specifically, the sequence (𝑎𝑛)𝑛≥0 is a function with domain ℕ\nwhere 𝑎𝑛is the image of the natural number 𝑛.",
    "Later we will manipulate sequences\nin much the same way you have manipulated functions in algebra or calculus.",
    "We\ncan shift a sequence up or down, add two sequences, or ask for the rate of change of\na sequence.",
    "These are done exactly as you would for functions.\n",
    "That said, while keeping the rigorous mathematical definition in mind is helpful,\nwe often describe sequences by writing out the first few terms.\n",
    "Example 4.1.2\nCan you find the next term in the following sequences?\n\n314\n4.",
    "Sequences\n1. 7, 7, 7, 7, 7, . .",
    ".\n",
    "2. 3, −3, 3, −3, 3, . . .\n",
    "3. 1, 5, 2, 10, 3, 15, . . .\n",
    "4. 1, 2, 4, 8, 16, 32, . . .\n",
    "5. 1, 4, 9, 16, 25, 36, . . .\n",
    "6. 1, 2, 3, 5, 8, 13, 21, . . .\n",
    "7. 1, 3, 6, 10, 15, 21, . . .\n",
    "8. 2, 3, 5, 7, 11, 13, . . .\n",
    "9. 3, 2, 1, 0, −1, . . .\n",
    "10. 1, 1, 2, 6, . . .\n",
    "Solution.\n",
    "No, you cannot.\n",
    "You might guess that the next terms are:\n",
    "1. 7\n2.",
    "−3\n3. 4\n4. 64\n5. 49\n6.",
    "34\n7. 28\n8. 17\n9. −2\n10.",
    "24\n",
    "In fact, those are the next terms of the sequences I had in mind when I\nmade up the example, but there is no way to be sure they are correct.\n",
    "Still, we will often do this.",
    "Given the first few terms of a sequence, we can\nask what the pattern in the sequence suggests the next terms are.\n",
    "Given that no number of initial terms in a sequence is enough to say for certain\nwhich sequence we are dealing with, we need to find another way to specify a\nsequence.",
    "We consider two main ways to do this:\nDefinition 4.1.3 Closed formula.\n",
    "A closed formula for a sequence (𝑎𝑛)𝑛∈ℕis a formula for 𝑎𝑛using a fixed\nfinite number of operations on 𝑛. This is what you normally think of as a\nformula in 𝑛, just as if you were defining a function in terms of 𝑛(because\nthat is exactly what you are doing).\n",
    "Definition 4.1.4 Recursive definition.\n",
    "A recursive definition (sometimes called an inductive definition) for a\nsequence (𝑎𝑛)𝑛∈ℕconsists of a recurrence relation : an equation relating a\nterm of the sequence to previous terms (terms with smaller index), and an\ninitial condition: a list of a few terms of the sequence (one less than the\nnumber of terms in the recurrence relation).\n",
    "It is easier to understand what is going on here with an example:\n\n4.1.",
    "Describing Sequences\n315\nExample 4.1.5\nHere are a few closed formulas for sequences:\n• 𝑎𝑛= 𝑛2.\n",
    "• 𝑎𝑛= 𝑛(𝑛+ 1)\n2\n.\n",
    "• 𝑎𝑛=\n\u0010\n1+\n√\n5\n2\n\u0011𝑛\n−\n\u0010\n1−\n√\n5\n2\n\u0011−𝑛\n√\n5\n.\n",
    "Note in each formula, if you are given 𝑛, you can calculate 𝑎𝑛directly:\nJust plug in 𝑛. For example, to find 𝑎3 in the second sequence, just compute\n𝑎3 = 3(3+1)\n2\n= 6.\n",
    "Here are a few recursive definitions for sequences:\n• 𝑎𝑛= 2𝑎𝑛−1 with 𝑎0 = 1.\n• 𝑎𝑛= 2𝑎𝑛−1 with 𝑎0 = 27.\n• 𝑎𝑛= 𝑎𝑛−1 + 𝑎𝑛−2 with 𝑎0 = 0 and 𝑎1 = 1.\n",
    "In these formulas, if you are given 𝑛, you cannot calculate 𝑎𝑛directly; you\nfirst need to find 𝑎𝑛−1 (or 𝑎𝑛−1 and 𝑎𝑛−2).",
    "In the second sequence, to find 𝑎3\nyou would take 2𝑎2, but to find 𝑎2 =",
    "2𝑎1 we would need to know 𝑎1 = 2𝑎0.",
    "We\ndo know this, so we could trace back through these equations to find 𝑎1 = 54,\n𝑎2 = 108 and finally 𝑎3 = 216.\n",
    "You might wonder why we would bother with recursive definitions for sequences.\n",
    "After all, it is harder to find 𝑎𝑛with a recursive definition than with a closed formula.\n",
    "This is true, but it is also harder to find a closed formula for a sequence than it is to\nfind a recursive definition.",
    "So to find a useful closed formula, we might first find the\nrecursive definition, and then use that to find the closed formula.\n",
    "Example 4.1.6\nFor defeating the evil dragon, the king promises you a reward of one grain\nof rice on the first day, and then twice as many grains the next day as the\nprevious day, for the rest of the month.\n",
    "Not to be swindled, you barter and get him to agree to add one additional\ngrain of rice each day as well.\n",
    "How many grains of rice will you receive on the 30th day?\nSolution.\n",
    "We can write down the first few terms of the sequence (𝑎𝑛)𝑛≥1\n\n316\n4.",
    "Sequences\nthat gives the number of grains of rice you receive on day 𝑛. We get\n1, 3, 7, 15, . . .",
    ",\nsince, for example, on day 4, you take the number of grains of rice you had on\nday 3 (all seven of them), double that and add 1, to get 15.",
    "The next day you\nwould get 2 · 15 + 1 = 31.\n",
    "By actually computing these values, we see right away what the recurrence\nrelation is:\n𝑎𝑛= 2𝑎𝑛−1 + 1.\n",
    "This is justified because the problem the sequence is modeling says that we\ndouble the number of grains each day, and then add 1.",
    "We can read the\nrecurrence relation right off the problem.\n",
    "The original question asked about 𝑎30.",
    "We could find this using the\nrecurrence relation, but we would first need to find 𝑎29, and to find that we\nwould need 𝑎28, which requires 𝑎27 first, and so on.",
    "While I’m sure we could\nwork all the way back to 𝑎4, which we already found, this sounds like a lot of\nwork.\n",
    "It would be so much nicer to have a closed formula.",
    "If we could solve the\nrecurrence relation and find that closed formula, we could just substitute 30 for\n𝑛.\nLet’s guess.",
    "It looks like the sequence is close to 2, 4, 8, 16, . . .",
    "which has\nclosed formula 2𝑛.",
    "That sequence has terms one greater than the terms in our\nsequence, so we might guess that\n𝑎𝑛= 2𝑛−1.\n",
    "To be clear, we have no good reason to believe this guess is correct, but maybe\nlater in this chapter we will.",
    "However, if it is correct, then we are golden (and\nincredibly sick of rice):\n𝑎30 = 230 −1 = 1, 073, 741, 823.\n",
    "This is not to say that recursive definitions aren’t useful in finding 𝑎𝑛.",
    "You can\nalways calculate 𝑎𝑛given a recursive definition; it might just take a while.\n",
    "Example 4.1.7\nFind 𝑎6 in the sequence defined by 𝑎𝑛= 2𝑎𝑛−1 −𝑎𝑛−2 with 𝑎0 = 3 and 𝑎1 = 4.\nSolution.\n",
    "We know that 𝑎6 = 2𝑎5 −𝑎4.",
    "So to find 𝑎6 we need to find 𝑎5 and\n𝑎4.",
    "Well\n𝑎5 = 2𝑎4 −𝑎3\nand\n𝑎4 = 2𝑎3 −𝑎2,\n\n4.1.",
    "Describing Sequences\n317\nso if we can only find 𝑎3 and 𝑎2, we would be set.",
    "Of course\n𝑎3 = 2𝑎2 −𝑎1\nand\n𝑎2 =",
    "2𝑎1 −𝑎0,\n",
    "so we only need to find 𝑎1 and 𝑎0.",
    "But we are given these.",
    "Thus\n𝑎0 = 3\n𝑎1 = 4\n𝑎2 = 2 · 4 −3 = 5\n𝑎3 = 2 · 5 −4 = 6\n𝑎4 = 2 · 6 −5 = 7\n𝑎5 = 2 · 7 −6 = 8\n𝑎6 = 2 · 8 −7 = 9.\n",
    "Note that now we can guess a closed formula for the 𝑛th term of the\nsequence: 𝑎𝑛= 𝑛+ 3.",
    "To be sure this will always work, we could plug in this\nformula into the recurrence relation:\n2𝑎𝑛−1 −𝑎𝑛−2 = 2((𝑛−1)",
    "+ 3) −((𝑛−2)",
    "+ 3)\n= 2𝑛+ 4 −𝑛−1\n= 𝑛+ 3\n= 𝑎𝑛.\nThat is not quite enough though, since there can be multiple closed\nformulas that satisfy the same recurrence relation; we must also check that our\nclosed formula agrees on the initial terms of the sequence.",
    "Since 𝑎0 = 0+3 = 3\nand 𝑎1 = 1 + 3 = 4 are the correct initial conditions, we can now conclude that\nwe have the correct closed formula.\n",
    "Finding closed formulas, or even recursive definitions, for sequences is not trivial.\n",
    "There is no one method for doing this.",
    "Just as in evaluating integrals or solving\ndifferential equations, it is useful to have a bag of tricks you can apply, but sometimes\nthere is no easy answer.\n",
    "One useful method is to relate a given sequence to another sequence for which\nwe already know the closed formula.",
    "To do this, we need a few “known sequences”\nto compare mystery sequences to.",
    "Here are a few that are good to know.",
    "We will\nverify the formulas for these in the coming sections.\n",
    "Common Sequences.\n",
    "1, 4, 9, 16, 25, . .",
    ".\n",
    "The square numbers.",
    "The sequence (𝑠𝑛)𝑛≥1 has closed\nformula 𝑠𝑛= 𝑛2\n\n318\n4.",
    "Sequences\n1, 3, 6, 10, 15, 21, . .",
    ".\n",
    "The triangular numbers.",
    "The sequence (𝑇𝑛)𝑛≥1 has\nclosed formula 𝑇𝑛= 𝑛(𝑛+1)\n2\n.\n",
    "1, 2, 4, 8, 16, 32, . .",
    ".\n",
    "The powers of 2.",
    "The sequence (𝑎𝑛)𝑛≥0 with closed\nformula 𝑎𝑛= 2𝑛.\n1, 1, 2, 3, 5, 8, 13, . . .\n",
    "The Fibonacci numbers (or Fibonacci sequence), de-\nfined recursively by 𝐹𝑛= 𝐹𝑛−1 + 𝐹𝑛−2 with 𝐹1 = 𝐹2 = 1.\n",
    "Example 4.1.8\nUse the formulas 𝑇𝑛= 𝑛(𝑛+1)\n2\nand 𝑎𝑛= 2𝑛to find closed formulas that agree\nwith the following sequences.",
    "Assume each first term corresponds to 𝑛= 0.\n",
    "1. (𝑏𝑛): 1, 2, 4, 7, 11, 16, 22, . .",
    "..\n",
    "2. (𝑐𝑛): 3, 5, 9, 17, 33, . .",
    "..\n",
    "3. (𝑑𝑛): 0, 2, 6, 12, 20, 30, 42, . .",
    "..\n",
    "4. (𝑒𝑛): 3, 6, 10, 15, 21, 28, . . ..\n",
    "5.",
    "( 𝑓𝑛): 0, 1, 3, 7, 15, 31, . .",
    "..\n",
    "6. (𝑔𝑛) 3, 6, 12, 24, 48, . . ..\n",
    "7. (ℎ𝑛): 6, 10, 18, 34, 66, . .",
    "..\n",
    "8. (𝑗𝑛): 15, 33, 57, 87, 123, . .",
    "..\n",
    "Solution.\n",
    "We wish to compare these sequences to the triangular numbers\n(0, 1, 3, 6, 10, 15, 21, . . .)",
    ", when we start with 𝑛= 0, and the powers of 2:\n(1, 2, 4, 8, 16, . . .).\n",
    "1.",
    "(1, 2, 4, 7, 11, 16, 22, . . .).",
    "Note that if we subtract 1 from each term, we\nget the sequence (𝑇𝑛).",
    "So we have 𝑏𝑛= 𝑇𝑛+ 1.",
    "Therefore a closed\nformula is 𝑏𝑛= 𝑛(𝑛+1)\n2\n+ 1.",
    "A quick check of the first few 𝑛confirms we\nhave it right.\n",
    "2. (3, 5, 9, 17, 33, . . .).",
    "Each term in this sequence is one more than a power\nof 2, so we might guess the closed formula is 𝑐𝑛= 𝑎𝑛+ 1 = 2𝑛+ 1.",
    "If we\ntry this though, we get 𝑐0 = 20 + 1 = 2 and 𝑐1 = 21 + 1 = 3.",
    "We are off\nbecause the indices are shifted.",
    "What we really want is 𝑐𝑛= 𝑎𝑛+1 + 1\ngiving 𝑐𝑛= 2𝑛+1 + 1.\n\n4.1.",
    "Describing Sequences\n319\n3.",
    "(0, 2, 6, 12, 20, 30, 42, . . .).",
    "Notice that all these terms are even.",
    "What\nhappens if we factor out a 2?",
    "We get (𝑇𝑛)!",
    "More precisely, we find that\n𝑑𝑛/2 = 𝑇𝑛, so this sequence has closed formula 𝑑𝑛= 𝑛(𝑛+ 1).\n",
    "4. (3, 6, 10, 15, 21, 28, . . .).",
    "These are all triangular numbers.",
    "However, we\nare starting with 3 as our initial term instead of as our third term.",
    "So\nif we could plug in 2 instead of 0 into the formula for 𝑇𝑛, we would be\nset.",
    "Therefore the closed formula is 𝑒𝑛= (𝑛+2)(𝑛+3)\n2\n(where 𝑛+ 3 came\nfrom (𝑛+ 2) + 1).",
    "Thinking about sequences as functions, we are doing\na horizontal shift by 2: 𝑒𝑛= 𝑇𝑛+2 which would cause the graph to shift 2\nunits to the left.\n",
    "5. (0, 1, 3, 7, 15, 31, . . .).",
    "Try adding 1 to each term, and we get powers of\n2.",
    "You might guess this because each term is a little more than twice\nthe previous term (the powers of 2 are exactly twice the previous term).\n",
    "Closed formula: 𝑓𝑛= 2𝑛−1.\n6. (3, 6, 12, 24, 48, . . .).",
    "These numbers are also doubling each time, but are\nalso all multiples of 3.",
    "Dividing each by 3 gives 1, 2, 4, 8, . . . .",
    "Aha.",
    "We\nget the closed formula 𝑔𝑛= 3 · 2𝑛.\n7.",
    "(6, 10, 18, 34, 66, . . .).",
    "To get from one term to the next, we almost double\neach term.",
    "So maybe we can relate this back to 2𝑛.",
    "Yes, each term is 2\nmore than a power of 2.",
    "So we get ℎ𝑛= 2𝑛+2 + 2 (the 𝑛+ 2 is because\nthe first term is 2 more than 22, not 20).",
    "Alternatively, we could have\nrelated this sequence to the second sequence in this example: Starting\nwith 3, 5, 9, 17, . . .",
    "we see that this sequence is twice the terms from\nthat sequence.",
    "That sequence had closed formula 𝑐𝑛= 2𝑛+1",
    "+",
    "1.",
    "Our\nsequence here would be twice this, so ℎ𝑛= 2(2𝑛+ 1), which is the same\nas what we got before.\n",
    "8.",
    "(15, 33, 57, 87, 123, . . .).",
    "Try dividing each term by 3.",
    "That gives the se-\nquence 5, 11, 19, 29, 41, . .",
    "..",
    "Now add 1 to each term: 6, 12, 20, 30, 42, . .",
    ".,\nwhich is (𝑑𝑛) in this example, except starting with 6 instead of 0.\n",
    "So let’s start with the formula 𝑑𝑛= 𝑛(𝑛+ 1).\n",
    "To start with the 6,\nwe shift: (𝑛+ 2)(𝑛+ 3).\n",
    "But this is one too many, so subtract 1:\n(𝑛+ 2)(𝑛+ 3) −1.\n",
    "That gives us our sequence, but divided by 3.\n",
    "So we want 𝑗𝑛= 3((𝑛+ 2)(𝑛+ 3) −1).\n",
    "4.1.3\nPartial Sums and Differences\nSome sequences naturally arise as the sum of terms of another sequence.\n\n",
    "320\n4.",
    "Sequences\nExample 4.1.9\nSam keeps track of how many push-ups she does each day of her “do lots of\npush-ups challenge.”",
    "Let (𝑎𝑛)𝑛≥1 be the sequence that describes the number\nof push-ups done on the 𝑛th day of the challenge.",
    "The sequence starts\n3, 5, 6, 10, 9, 0, 12, . . . .\n",
    "Describe a sequence (𝑏𝑛)𝑛≥1 that gives the total number of push-ups done by\nSam after the 𝑛th day.\n",
    "Solution.\n",
    "We can find the terms of this sequence easily enough.\n",
    "3, 8, 14, 24, 33, 33, 45, . . .",
    ".\n",
    "Here 𝑏1 is just 𝑎1, but then\n𝑏2 = 3 + 5 = 𝑎1 + 𝑎2,\n𝑏3 = 3 + 5 + 6 = 𝑎1 + 𝑎2 + 𝑎3,\nand so on.\n",
    "There are a few ways we might describe 𝑏𝑛in general.",
    "We could do so\nrecursively as,\n𝑏𝑛= 𝑏𝑛−1 + 𝑎𝑛,\nsince the total number of push-ups done after 𝑛days will be the number done\nafter 𝑛−1 days, plus the number done on day 𝑛.\nFor something closer to a closed formula, we could write\n𝑏𝑛= 𝑎1 + 𝑎2 + 𝑎3 + · · · + 𝑎𝑛,\nor the same thing using summation notation:\n𝑏𝑛=\n𝑛\nÕ\n𝑖=1\n𝑎𝑖.\nHowever, note that these are not really closed formulas since even if we had\na formula for 𝑎𝑛, we would still have an increasing number of computations\nto do as 𝑛increases.\n",
    "Given any sequence (𝑎𝑛)𝑛∈ℕ, we can always form a new sequence (𝑏𝑛)𝑛∈ℕby\n𝑏𝑛= 𝑎0 + 𝑎1 + 𝑎2 + · · ·",
    "+ 𝑎𝑛.\nSince the terms of (𝑏𝑛) are the sums of the initial part of the sequence (𝑎𝑛), we call\n(𝑏𝑛) the sequence of partial sums of (𝑎𝑛).\n",
    "Soon we will see that it is sometimes\npossible to find a closed formula for (𝑏𝑛) from the closed formula for (𝑎𝑛).\n\n",
    "4.1.",
    "Describing Sequences\n321\nTo simplify writing out these sums, we will often use notation like\n𝑛\nÕ\n𝑘=1\n𝑎𝑘.",
    "This\nmeans add up the 𝑎𝑘’s where 𝑘changes from 1 to 𝑛.\nExample 4.1.10\nUse Í notation to rewrite the sums:\n1. 1",
    "+ 2 + 3 + 4 + · · ·",
    "+ 100\n2. 1 + 2 + 4 + 8 + · · · + 250\n3. 6 + 10 + 14 + · · · + (4𝑛−2).\n",
    "Solution.\n",
    "1.\n100\nÕ\n𝑘=1\n𝑘\n2.\n50\nÕ\n𝑘=0\n2𝑘\n3.\n𝑛\nÕ\n𝑘=2\n(4𝑘−2)\n",
    "It is also often useful to look at the sequence of difference of a sequence (𝑎𝑛).",
    "By\nthis we just mean the sequence (𝑑𝑛) where\n𝑑𝑛= 𝑎𝑛+1 −𝑎𝑛.\n",
    "For example, if (𝑎𝑛) = (1, 4, 9, 16, 25, . . .)",
    "(the square numbers, so 𝑎𝑛= 𝑛2), then the\nsequence of differences is (𝑑𝑛) = (3, 5, 7, 9, . . .)",
    "since 4 −1 = 3, 9 −4 = 5, and so on.\n",
    "We could also find a closed formula for the sequence of differences here since we\nhave a closed formula for 𝑎𝑛. We would have\n𝑑𝑛= 𝑎𝑛+1 −𝑎𝑛= (𝑛+ 1)2 −𝑛2 = 𝑛2 + 2𝑛+ 1 −𝑛2 = 2𝑛+ 1.\n",
    "In general, it is easy to go from a closed formula for a sequence to a closed\nformula for the sequence of differences.",
    "It is not always easy to go the other way\naround.",
    "In fact, what would it look like to start with a sequence of differences and\nget the “original” sequence?\nThinking about a recurrence relation is helpful here.",
    "Since\n𝑑𝑛= 𝑎𝑛+1 −𝑎𝑛,\nwe have that\n𝑎𝑛+1 = 𝑎𝑛+ 𝑑𝑛.\n",
    "This makes sense: to get from one term of a sequence to the next, you add the\ndifference between those terms.",
    "Ah!",
    "You add the differences.",
    "So the original\nsequence is the sequence of partial sums of the sequence of differences!\n",
    "In upcoming sections we will see that understanding the sequence of differences\ncan tell us exactly where to look for a closed formula.",
    "The differences also suggest\nhow to create a recursive definition.\n\n",
    "322\n4. Sequences\nExample 4.1.11\nFind a recurrence relation and initial conditions that agree with the terms of\nthis sequence: 1, 5, 17, 53, 161, 485 . .",
    "..\n",
    "Solution.\n",
    "Finding the recurrence relation would be easier if we had some\ncontext for the problem (like the Tower of Hanoi, for example).",
    "Alas, we\nhave only the sequence.",
    "Remember, the recurrence relation tells you how to\nget from previous terms to future terms.",
    "What is going on here?",
    "We could\nlook at the differences between terms: 4, 12, 36, 108, . .",
    "..",
    "Notice that these are\ngrowing by a factor of 3.",
    "Is the original sequence as well?",
    "1 · 3 = 3, 5 · 3 = 15,\n17 · 3 = 51 and so on.",
    "It appears that we always end up with 2 less than the\nnext term.",
    "Aha!\n",
    "So 𝑎𝑛= 3𝑎𝑛−1 + 2 is our recurrence relation and the initial condition is\n𝑎0 = 1.\n",
    "4.1.4\nSequences in python\nChecking that a closed formula agrees with the initial terms in a sequence is easy\nwith a calculator, or better yet, a programming language like python.",
    "One way you\ncan do this is to define a function that returns the 𝑛th term of the sequence.\n",
    "Here is an example: Suppose you wanted to check whether a formula you found\nfor the sequence (𝑎𝑛)𝑛∈ℕ= (1, 3, 7, 15, 31, . . .)",
    "is correct.",
    "Perhaps you guess that\n𝑎𝑛= 2𝑛−1.",
    "Try running the code below.",
    "(Note: In python, the ^ symbol means\nsomething else, so to do exponentiation, we use **.)\n",
    "def a(n):\nreturn 2**n-1\nprint(a(3))\n",
    "Looks promising, but we should be careful: Our sequence started with 𝑎0 = 1,\nwhich makes 𝑎3 = 15.",
    "Now try modifying the definition of a(n) (by changing the\nreturn value) to get the correct closed formula.\n",
    "Perhaps you want to print out the first 20 terms of the sequence?",
    "This is easy to\ndo with python, by putting the terms in a list:\ndef a(n):\nreturn 2**(n+1) - 1\nsequence =",
    "[]\nfor n in range (20):\nsequence.append(a(n))\nprint(sequence)\nNote that range(20) starts at 0 and stops at 19 (it is the list [0,1,2,...,19]).\n",
    "We can also use python to generate terms for a sequence given a recursive\ndefinition.",
    "Suppose we wanted to explore the sequence 𝑎𝑛= 2𝑎𝑛−1",
    "+ 1 with initial\ncondition 𝑎0 = 1.",
    "In python, we could generate the sequence as follows.\n\n4.1.",
    "Describing Sequences\n323\ndef a(n):\nif n == 0:\nreturn 1\nelse:\nreturn 2*a(n-1)+1\n# just print out the first 10 terms\nfor i in range (10):\nprint(a(i))\n",
    "Do you see how to translate a recurrence relation into a recursive python function?\nTry playing around with the code above to explore other sequences.\n",
    "4.1.5\nReading Questions\n1.\n",
    "For the formulas for sequences below, select all that are closed formulas (as\nopposed to recursive formulas).\n",
    "A. 𝑎𝑛= 3(𝑛−1)",
    "+ 2\nB. 𝑎𝑛= 𝑛2 + 2𝑛+ 3\n",
    "4𝑛\nC. 𝑎𝑛= 3𝑎𝑛−1 + 2\nD. 𝑎𝑛= 𝑎𝑛−1 + 𝑎𝑛−2 + 𝑎𝑛−3\n2.\nDrag each sequence on the left to a recurrence relation that agrees with the\nsequence.\n",
    "1, 2, 3, 4, 5, . .",
    ".\n",
    "𝑎𝑛= 2𝑎𝑛−1 −𝑎𝑛−2\n5, 5, 5, 5, 5, . . .\n",
    "𝑎𝑛= 2𝑎𝑛−1 −1\n2, 3, 5, 9, 17, . . .\n",
    "𝑎𝑛= 𝑎𝑛−1 + 1\n3, 4, 7, 11, 18, . . .\n",
    "𝑎𝑛= 𝑎𝑛−1 + 𝑎𝑛−2\n3.\n",
    "What questions do you have?",
    "Write at least one question about the content of\nthis section that you or a classmate might be curious about after reading this\nsection.\n",
    "4.1.6\nPractice Problems\n1.\n",
    "For the sequence with closed formula 𝑎𝑛= 𝑛2 + 5𝑛+ 4, find the term 𝑎7.\n",
    "2.\nConsider the sequence with recurrence relation 𝑎𝑛= 𝑎𝑛−1 + 6 with initial term\n𝑎0 = 3.",
    "Find the term 𝑎4.\n",
    "3.\nConsider the sequence with recurrence relation 𝑎𝑛= 7 · 𝑎𝑛−1 with initial term\n𝑎0 = 9.",
    "Find the term 𝑎6.\n",
    "4.\nFind the closed formula for each of the following sequences (𝑎𝑛)𝑛≥1 by relating\nthem to a well known sequence.",
    "Assume the first term given is 𝑎1.\na. −1, 2, 7, 14, 23, . . .\n\n",
    "324\n4. Sequences\n𝑎𝑛=\nb. 3, 5, 8, 12, 17, . . .\n",
    "𝑎𝑛=\nc. 11, 16, 22, 29, 37, . . .\n",
    "𝑎𝑛=\nd. 25, 121, 721, 5041, 40321, . . .\n",
    "𝑎𝑛=\n5.\n",
    "For each sequence given below, find a closed formula for 𝑎𝑛, the 𝑛th term\nof the sequence (assume the first terms here are always 𝑎0) by relating it to\nanother sequence for which you already know the formula.\n",
    "a. 0, 1, 3, 7, 15, 31, . . .\n",
    "𝑎𝑛=\nb. −1, 0, 7, 26, 63, 124, . . .\n",
    "𝑎𝑛=\nc. 0, 3, 12, 27, 48, 75, . . .\n",
    "𝑎𝑛=\nd. 1, 3, 8, 17, 32, 57, . .",
    ".\n",
    "𝑎𝑛=\n4.1.7\nAdditional Exercises\n1.\nConsider the sequence (𝑎𝑛)𝑛≥1 that starts 1, 3, 5, 7, 9, . . .",
    "(i.e., the odd numbers\nin order).\n",
    "(a) Give a recursive definition and closed formula for the sequence.\n",
    "(b) Write out the sequence (𝑏𝑛)𝑛≥2 of partial sums of (𝑎𝑛).",
    "Write down the\nrecursive definition for (𝑏𝑛) and guess at the closed formula.\n",
    "2.\n",
    "The Fibonacci sequence is 0, 1, 1, 2, 3, 5, 8, 13, . . .",
    "(where 𝐹0 = 0).\n",
    "(a) Write out the first few terms of the sequence of partial sums: 0, 0",
    "+ 1,\n0",
    "+ 1",
    "+ 1,. .",
    ".\n",
    "(b) Guess a formula for the sequence of partial sums expressed in terms of a\nsingle Fibonacci number.",
    "For example, you might say 𝐹0 + 𝐹1 + · · · + 𝐹𝑛=\n3𝐹2\n𝑛−1 + 𝑛, although that is definitely not correct.\n",
    "3.\nConsider the three sequences below.",
    "For each, find a recursive definition.",
    "How\nare these sequences related?\n\n4.1.",
    "Describing Sequences\n325\n(a) 2, 4, 6, 10, 16, 26, 42, . .",
    "..\n(b) 5, 6, 11, 17, 28, 45, 73, . .",
    "..\n",
    "(c) 0, 0, 0, 0, 0, 0, 0, . .",
    "..\n",
    "4.\nWrite out the first few terms of the sequence given by 𝑎1 = 3; 𝑎𝑛= 2𝑎𝑛−1 + 4.\nThen find a recursive definition for the sequence 10, 24, 52, 108, . .",
    "..\n",
    "5.\nWrite out the first few terms of the sequence given by 𝑎𝑛= 𝑛2 −3𝑛+ 1.",
    "Then\nfind a closed formula for the sequence (starting with 𝑎1) 0, 2, 6, 12, 20, . .",
    "..\n",
    "6.\nShow that 𝑎𝑛= 3 · 2𝑛+ 7 · 5𝑛is a solution to the recurrence relation 𝑎𝑛=\n7𝑎𝑛−1 −10𝑎𝑛−2.",
    "What would the initial conditions need to be for this to be the\nclosed formula for the sequence?\n",
    "7.\nShow that 𝑎𝑛= 2𝑛−5𝑛is also a solution to the recurrence relation 𝑎𝑛=\n7𝑎𝑛−1 −10𝑎𝑛−2.",
    "What would the initial conditions need to be for this to be the\nclosed formula for the sequence?\n8.\nFind a closed formula for the sequence with recursive definition 𝑎𝑛= 2𝑎𝑛−1 −\n𝑎𝑛−2 with 𝑎1 = 1 and 𝑎2 = 2.\n9.\nGive two different recursive definitions for the sequence with closed formula\n𝑎𝑛= 3 + 2𝑛.",
    "Prove you are correct.",
    "At least one of the recursive definitions\nshould make use of two previous terms and no constants.\n",
    "10.\nUse summation (Í) or product (Î) notation to rewrite the following.\n",
    "(a) 2 + 4 + 6 + 8 + · · · + 2𝑛.\n(b) 1",
    "+ 5 + 9 + 13 + · · ·",
    "+ 425.\n(c) 1",
    "+ 1\n2 + 1\n3 + 1\n4 + · · · + 1\n50.\n(d) 2 · 4 · 6 · · · · · 2𝑛.\n(e) (1\n2)(2\n3)(3\n4) · · · (100\n101).\n",
    "11.\nExpand the following sums and products.",
    "That is, write them out the long\nway.\n",
    "(a)\n100\nÕ\n𝑘=1\n(3 + 4𝑘).\n",
    "(b)\n𝑛\nÕ\n𝑘=0\n2𝑘.\n(c)\n50\nÕ\n𝑘=2\n1\n(𝑘2 −1).\n",
    "(d)\n100\nÖ\n𝑘=2\n𝑘2\n(𝑘2 −1).\n",
    "(e)\n𝑛\nÖ\n𝑘=0\n(2 + 3𝑘).\n",
    "12.\nSuppose you draw 𝑛lines in the plane so that every pair of lines cross (no\nlines are parallel) and no three lines cross at the same point.",
    "This will create\nsome number of regions in the plane, including some unbounded regions.",
    "Call\nthe number of regions 𝑅𝑛.",
    "Find a recursive formula for the number of regions\ncreated by 𝑛lines, and justify why your recursion is correct.\n\n",
    "326\n4.",
    "Sequences\n13.\n",
    "A ternary string is a sequence of 0’s, 1’s, and 2’s.",
    "Just like a bit string, but with\nthree symbols.\n",
    "Let’s call a ternary string good provided it never contains a 2 followed\nimmediately by a 0.",
    "Let 𝐺𝑛be the number of good strings of length 𝑛. For\nexample, 𝐺1 = 3, and 𝐺2 = 8 (since of the 9 ternary strings of length 2, only\none is not good).\n",
    "Find, with justification, a recursive formula for 𝐺𝑛, and use it to compute\n𝐺5.\n",
    "14.\nConsider bit strings with length 𝑙and weight 𝑘(so strings of 𝑙0’s and 1’s,\nincluding 𝑘1’s).",
    "We know how to count the number of these for a fixed 𝑙and\n𝑘.",
    "Now, we will count the number of strings for which the sum of the length\nand the weight is fixed.",
    "For example, let’s count all the bit strings for which\n𝑙+ 𝑘= 11.\n(a) Find examples of these strings of different lengths.",
    "What is the longest\nstring possible?",
    "What is the shortest?\n(b) How many strings are there of each of these lengths.",
    "Use this to count\nthe total number of strings (with sum 11).\n",
    "(c) The other approach: Let 𝑛= 𝑙+ 𝑘vary.",
    "How many strings have sum\n𝑛= 1?",
    "How many have sum 𝑛= 2?",
    "And so on.",
    "Find and explain a\nrecurrence relation for the sequence (𝑎𝑛) that gives the number of strings\nwith sum 𝑛.\n(d) Describe what you have found above in terms of Pascal’s triangle.",
    "What\npattern have you discovered?\n15.\n",
    "When bees play chess, they use a hexagonal board like the one shown below.\n",
    "The queen bee can move one space at a time either directly to the right or\nangled up-right or down-right (but can never move leftwards).",
    "How many\ndifferent paths can the queen take from the top left hexagon to the bottom right\nhexagon?",
    "Explain your answer, and how this relates to the previous question.\n",
    "(As an example, there are three paths to get to the second hexagon on the\nbottom row.)\n",
    "start\n3\nstop\n16.\n",
    "Let 𝑡𝑛denote the number of ways to tile a 2×𝑛chessboard using 1×2 dominoes.\n",
    "Write out the first few terms of the sequence (𝑡𝑛)𝑛≥1, and then give a recursive\ndefinition.",
    "Explain why your recursive formula is correct.\n\n",
    "4.2\nRate of Growth\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Identify a sequence as arithmetic or geometric based on its rate of\ngrowth.\n",
    "2. Give recursive definitions and closed formulas for arithmetic and\ngeometric sequences.\n",
    "4.2.1\nSection Preview\nInvestigate!\n",
    "For each of the patterns of dots below, draw the next pattern in the sequence.\n",
    "Describe the rate of growth of the number of dots in the patterns.",
    "Then\nguess a recursive definition and a closed formula for the number of dots in\nthe 𝑛th pattern.\n𝑛= 0\n𝑛= 1\n𝑛= 2\n𝑛= 0\n𝑛= 1\n𝑛= 2\n𝑛= 1\n𝑛= 2\n𝑛= 3\n𝑛= 4\nOur goal is to find closed formulas for sequences.",
    "Our primary strategy will be\n327\n\n328\n4.",
    "Sequences\nto first determine how the sequence is changing from term to term.",
    "This will lead to\na recurrence relation for the sequence, and from that recurrence relation, we will\nfind a closed formula.",
    "We start with two types of sequences that are particularly\ncommon and useful: arithmetic and geometric sequences.",
    "Along the way, we will\nexplore some techniques for solving recurrence relations.\n",
    "Preview Activity\n1.\nExplore the first sequence of dots from the Investigate! activity.",
    "We will let 𝑎𝑛\nrepresent the number of dots in figure 𝑛.",
    "The sequence starts 1, 5, 9, . . .\n",
    "(a) How many dots would you expect in the next two figures in the sequence?\n(b) How is the sequence growing?",
    "How many dots do you add to or multiply\nby to get the next figure?\n",
    "(c) Let 𝑎𝑛be the number of dots in figure 𝑛. Write a recursive definition for\n𝑎𝑛.\n(d)",
    "Guess a closed formula for the number of dots in the 𝑛th figure.\n",
    "2.\nNow look at the second sequence of dots from the Investigate!",
    "activity.",
    "We will\nlet 𝑎𝑛represent the number of dots in figure 𝑛.",
    "The sequence starts 2, 6, 18, . . .\n",
    "(a) How many dots would you expect in the next two figures in the sequence?\n(b) How is the sequence growing?",
    "How many dots do you add to or multiply\nby to get the next figure?\n",
    "(c) Let 𝑎𝑛be the number of dots in figure 𝑛. Write a recursive definition for\n𝑎𝑛.\n(d)",
    "Guess a closed formula for the number of dots in the 𝑛th figure.\n",
    "3.\nNow look at the third sequence of dots from the Investigate!",
    "activity.",
    "We will let\n𝑎𝑛represent the number of dots in figure 𝑛.",
    "The sequence starts 1, 3, 6, 10, . . .\n",
    "(a) How many dots would you expect in the next two figures in the sequence?\n(b) Let 𝑎𝑛be the number of dots in figure 𝑛. Write a recursive definition for\n𝑎𝑛.\n(c) Guess a closed formula for the number of dots in the 𝑛th figure.\n",
    "4.2.2\nArithmetic Sequences\nSuppose you start a business selling prints of mathematical art.",
    "In week zero, you\nsell two prints.",
    "Each week after that, you sell four more prints than you did the\nprevious week.",
    "How many prints will you sell in the 𝑛th week?\n\n4.2.",
    "Rate of Growth\n329\nWe can easily compute the first few terms of the sequence: 2, 6, 10, 14, . .",
    "..",
    "How\ndo I know this is correct?",
    "From the problem, we see that to get from one term to the\nnext, we must add 4.",
    "It is clear then that the recurrence relation for the sequence is\n𝑎𝑛= 𝑎𝑛−1 + 4.\n",
    "The rate of growth for the sequence is the constant 4 since the difference between any\ntwo terms is 4 (note, we could write the recurrence relation as 𝑎𝑛−𝑎𝑛−1 = 4).\n",
    "We call sequences with a constant rate of change arithmetic sequences.\n",
    "Now let’s find a closed formula for our sequence.",
    "The first term is 𝑎0 = 2.",
    "To get\n𝑎1, we add 4.",
    "The next term requires us to add 4 again, which means we have added\n4 to our initial term twice.",
    "Then we add 4 again, for a total of three times for 𝑎3.",
    "In\nfact, to get 𝑎𝑛, we will have added 4 to 𝑎0 a total of 𝑛times.",
    "Thus, the closed formula\nfor the sequence is\n𝑎𝑛= 2 + 4𝑛.\n",
    "This works for any arithmetic sequence.",
    "That is, any sequence with a constant\ndifference will have a linear closed formula, where the “slope” of the linear function\nis the common difference.\n",
    "Arithmetic Sequences.\n",
    "If the terms of a sequence differ by a constant, we say the sequence is\narithmetic.",
    "If the initial term (𝑎0) of the sequence is 𝑎and the common\ndifference is 𝑑, then we have,\nRecursive definition: 𝑎𝑛= 𝑎𝑛−1 + 𝑑with 𝑎0 = 𝑎.\nClosed formula: 𝑎𝑛= 𝑎+ 𝑑𝑛.\n",
    "As we did for our example above, for the recursive definition, we need to specify\n𝑎0.",
    "Then we need to express 𝑎𝑛in terms of 𝑎𝑛−1.",
    "If we call the first term 𝑎, then\n𝑎0 = 𝑎.",
    "For the recurrence relation, by the definition of an arithmetic sequence, the\ndifference between successive terms is some constant, say 𝑑. So 𝑎𝑛−𝑎𝑛−1 = 𝑑, or in\nother words,\n𝑎0 = 𝑎\n𝑎𝑛= 𝑎𝑛−1 + 𝑑.\nLet’s now argue why the closed formula is correct.",
    "One way we could do this\nis by using a technique sometimes called telescoping (a name which hopefully we\nbecome meaningful momentarily).\n",
    "We write the recurrence relation in its difference form, 𝑎𝑛−𝑎𝑛−1 = 𝑑for all terms\nstarting with 𝑎1 and going up to 𝑎𝑛.",
    "This gives the following:\n𝑎1 −𝑎0 =𝑑\n𝑎2 −𝑎1",
    "=𝑑\n𝑎3 −𝑎2 =𝑑\n...\n",
    "𝑎𝑛−1 −𝑎𝑛−2 =𝑑\n\n330\n4.",
    "Sequences\n𝑎𝑛−𝑎𝑛−1 =𝑑.\nNow we add all 𝑛equations together.\n",
    "On the right-hand side, we have added 𝑑to itself 𝑛times, so the sum is 𝑑· 𝑛.\nOn the left-hand side, we get the sum:\n(𝑎1 −𝑎0)",
    "+ (𝑎2 −𝑎1)",
    "+ (𝑎3 −𝑎2)",
    "+ · · · + (𝑎𝑛−1 −𝑎𝑛−2) + (𝑎𝑛−𝑎𝑛−1).\n",
    "But look what happens when we regroup and cancel like terms:\n\u001a\u001a\n𝑎1 −𝑎0 +\u001a\u001a\n𝑎2 −\u001a\u001a\n𝑎1 +\u001a\u001a\n𝑎3 −\u001a\u001a\n𝑎2 + · · · +\u0018\u0018\u0018\n𝑎𝑛−1 −\u0018\u0018\u0018\n𝑎𝑛−2 + 𝑎𝑛−\u0018\u0018\u0018\n𝑎𝑛−1 = 𝑎𝑛−𝑎0.\n",
    "The sum telescopes down to be nice and compact for easy storage.\n",
    "Putting the two sides together gives us\n𝑎𝑛−𝑎0 = 𝑑· 𝑛\nwhich becomes\n𝑎𝑛= 𝑎0 + 𝑑· 𝑛\nas we claimed.\n",
    "The telescoping we did above is useful in other contexts (see Exercise 4.2.7.6),\nbut now that we have established a general form of the closed formula, we can apply\nit to any arithmetic sequence.\n",
    "Example 4.2.1\nFind recursive definitions and closed formulas for the arithmetic sequences\nbelow.",
    "Assume the first term listed is 𝑎0.\n",
    "1. 2, 5, 8, 11, 14, . .",
    "..\n",
    "2. 50, 43, 36, 29, . .",
    "..\n",
    "Solution.\n",
    "First we should check that these sequences really are arithmetic\nby taking differences of successive terms.",
    "Doing so will reveal the common\ndifference 𝑑.\n1. 5 −2 = 3, 8 −5 = 3, etc.",
    "To get from each term to the next, we add three,\nso 𝑑= 3.",
    "The recursive definition is therefore 𝑎𝑛= 𝑎𝑛−1 + 3 with 𝑎0 = 2.\n",
    "The closed formula is 𝑎𝑛= 2 + 3𝑛.\n2.",
    "Here the common difference is −7, since we add −7 to 50 to get 43, and\nso on.",
    "Thus we have a recursive definition of 𝑎𝑛= 𝑎𝑛−1 −7 with 𝑎0 = 50.\n",
    "The closed formula is 𝑎𝑛= 50 −7𝑛.\n4.2.3\nGeometric Sequences\nWhat about sequences like 3, 6, 12, 24, 48, . . .?",
    "This is not arithmetic because the\ndifference between terms is not constant.",
    "However, the ratio between successive\nterms is constant: 6\n3 = 12\n6 = 24\n12 = · · ·",
    "= 2 We call such sequences geometric.\n\n",
    "4.2.",
    "Rate of Growth\n331\nRecognizing that the sequence is geometric lets us easily write down a recursive\ndefinition.",
    "𝑎𝑛= 2𝑎𝑛−2, with 𝑎0 = 3.\n",
    "A closed formula is also not difficult to reason out.",
    "How do we get the term 𝑎3\nfor example?",
    "We start with 3, then multiply by 2 to get 𝑎1, multiply by 2 again to get\n𝑎2, and multiply by 2 a third time to get 𝑎3.",
    "So we multiplied 3 by 2 a total of three\ntimes, or 𝑎3 = 3 · 23.",
    "It looks like 𝑎𝑛= 3 · 2𝑛.\nIn general, the recursive definition for the geometric sequence with initial term 𝑎\nand common ratio 𝑟will be\n𝑎𝑛= 𝑎𝑛−1 · 𝑟; 𝑎0 = 𝑎.\nTo get the next term we multiply the previous term by 𝑟.\n",
    "For the general closed formula, we could try something like telescoping again,\nalthough we would need to cancel fractions.",
    "Instead, let’s illustrate another technique\nfor solving recurrence relations called iteration.",
    "The idea here is that we work our\nway up to 𝑎𝑛and notice the pattern.",
    "Write\n𝑎0 = 𝑎\n𝑎1 = 𝑎0 · 𝑟\n𝑎2 = 𝑎1 · 𝑟=",
    "𝑎0 · 𝑟· 𝑟=",
    "𝑎0 ·",
    "𝑟2\n𝑎3 = 𝑎2 · 𝑟=",
    "𝑎0 ·",
    "𝑟2 · 𝑟=",
    "𝑎0 · 𝑟3\n...\n𝑎𝑛= 𝑎𝑛−1 · 𝑟=",
    "𝑎0 ·",
    "𝑟𝑛−1 · 𝑟=",
    "𝑎0𝑟𝑛.\nWe must multiply the first term 𝑎by 𝑟a number of times, 𝑛times to be precise.",
    "We\nget 𝑎𝑛= 𝑎· 𝑟𝑛.\nGeometric Sequences.\n",
    "A sequence is called geometric if the ratio between successive terms is\nconstant.",
    "Suppose the initial term 𝑎0 is 𝑎and the common ratio is 𝑟.",
    "Then we\nhave,\nRecursive definition: 𝑎𝑛= 𝑟𝑎𝑛−1 with 𝑎0 = 𝑎.\nClosed formula: 𝑎𝑛= 𝑎· 𝑟𝑛.\nExample 4.2.2\nFind the recursive and closed formula for the geometric sequences below.\n",
    "Again, the first term listed is 𝑎0.\n",
    "1. 3, 6, 12, 24, 48, . . .\n",
    "2. 27, 9, 3, 1, 1/3, . . .\n",
    "Solution.\n",
    "Start by checking that these sequences really are geometric by\n\n332\n4.",
    "Sequences\ndividing each term by its previous term.",
    "If this ratio really is constant, we\nwill have found 𝑟.\n1. 6/3 = 2, 12/6 = 2, 24/12 = 2, etc.",
    "Yes, to get from any term to the next,\nwe multiply by 𝑟=",
    "2.",
    "So the recursive definition is 𝑎𝑛= 2𝑎𝑛−1 with\n𝑎0 = 3.",
    "The closed formula is 𝑎𝑛= 3 · 2𝑛.\n2.",
    "The common ratio is 𝑟= 1/3.",
    "So the sequence has recursive definition\n𝑎𝑛= 1\n3𝑎𝑛−1 with 𝑎0 = 27 and closed formula 𝑎𝑛= 27 · 1\n3\n𝑛.\nGeometric sequences are those which have a growth rate that is proportional\nto the sequence itself.",
    "Just like you might have seen in calculus, it is exactly the\nexponential functions that have this property.\n",
    "In the examples and formulas above, we assumed that the initial term was 𝑎0.",
    "If\nyour sequence starts with 𝑎1, you can easily find the term that would have been 𝑎0\nand use that in the formula.",
    "For example, if we want a formula for the sequence\n2, 5, 8, . . .",
    "and insist that 2 = 𝑎1, then we can find 𝑎0 = −1 (since the sequence is\narithmetic with common difference 3, we have 𝑎0 + 3 = 𝑎1).",
    "Then the closed formula\nwill be 𝑎𝑛= −1 + 3𝑛.\nRemark 4.2.3",
    "If you look at other sources, you might find that their closed\nformulas for arithmetic and geometric sequences differ from ours.",
    "Specifically,\nyou might find the formulas 𝑎𝑛= 𝑎+ (𝑛−1)𝑑(arithmetic) and 𝑎𝑛= 𝑎· 𝑟𝑛−1\n(geometric).",
    "Which is correct?",
    "Both!",
    "In our case, we take 𝑎to be 𝑎0.",
    "If instead\nwe had 𝑎1 as our initial term, we would get the (slightly more complicated)\nformulas you find elsewhere.\n",
    "4.2.4\nBeyond Arithmetic and Geometric Sequences\nLook at the sequence (𝑇𝑛)𝑛≥1 which starts 1, 3, 6, 10, 15, . .",
    "..",
    "These are called the\ntriangular numbers since they represent the number of dots in an equilateral triangle\n(think of how you arrange 10 bowling pins: a row of 4 plus a row of 3 plus a row of\n2 and a row of 1).\n",
    "𝑇1 = 1\n𝑇2 = 3\n𝑇3 = 6\n𝑇4 = 10\nIs this sequence arithmetic?",
    "No, since 3 −1 = 2 and 6 −3 = 3 ≠2, so there is no\ncommon difference.",
    "Is the sequence geometric?",
    "No. 3/1 = 3 but 6/3 = 2, so there is\nno common ratio.",
    "What to do?\nNotice that the differences between terms do form an arithmetic sequence:\n2, 3, 4, 5, 6, . . ..",
    "In other words, the rate of change of this sequence is arithmetic:\n\n4.2.",
    "Rate of Growth\n333\n𝑇𝑛−𝑇𝑛−1 = 𝑛, which immediately gives us the recurrence relation 𝑇𝑛= 𝑇𝑛−1 + 𝑛.\nAnother way to think of this is that the 𝑛th term of the sequence (𝑇𝑛) is the sum of\nthe first 𝑛terms in the sequence 1, 2, 3, 4, 5, . . ..",
    "Thus (𝑇𝑛) is the sequence of partial\nsums of the sequence 1, 2, 3, . . .",
    "(partial sums because we are not taking the sum of\nall infinitely many terms).\n",
    "This should become clearer if we expand the recurrence relation to write the\ntriangular numbers like this:\n𝑇1 = 1 = 1\n𝑇2 = 3 = 1 + 2\n𝑇3 = 6 = 1 + 2 + 3\n𝑇4 = 10 = 1 + 2 + 3 + 4\n...\n...\n",
    "𝑇𝑛= 1 + 2 + 3 + · · · + 𝑛.\nWe are really using iteration here.",
    "We could also have seen this by using telescoping,\ntaking 𝑇0 = 0:\n𝑇1 −𝑇0 =1\n𝑇2 −𝑇1 =2\n𝑇3 −𝑇2 =3\n...\n𝑇𝑛−𝑇𝑛−1 =𝑛.\nSumming these equations, the right-hand side becomes 1 + 2 + 3 + · · · + 𝑛; the\nleft-hand side cancels to leave just 𝑇𝑛−𝑇0 = 𝑇𝑛.\nIf we know how to add up the terms of an arithmetic sequence, we can find a\nclosed formula for a sequence whose differences are the terms of that arithmetic\nsequence.",
    "Consider how we could find the sum of the first 100 positive integers\n(that is, 𝑇100).",
    "Instead of adding them in order, we regroup and add 1 + 100 = 101.\n",
    "The next pair to combine is 2 + 99 = 101.",
    "Then 3 + 98 = 101.",
    "Keep going.",
    "This gives\n50 pairs which each add up to 101, so 𝑇100 = 101 · 50 = 5050.1\nIn general, using this same sort of regrouping, we find that 𝑇𝑛= 𝑛(𝑛+1)\n2\n.",
    "Inci-\ndentally, this is exactly the same as \u0000𝑛+1\n2\n\u0001, which makes sense if you think of the\ntriangular numbers as counting the number of handshakes that take place at a party\nwith 𝑛+ 1 people: the first person shakes 𝑛hands, the next shakes an additional\n𝑛−1 hands and so on.\n",
    "The point of all of this is that some sequences, while not arithmetic or geometric,\ncan be interpreted as the sequence of partial sums of arithmetic and geometric\n",
    "1This insight is usually attributed to Carl Friedrich Gauss, one of the greatest mathematicians of all\ntime, who discovered it as a child when his unpleasant elementary teacher thought he would keep the\nclass busy by requiring them to compute the lengthy sum.\n\n",
    "334\n4. Sequences\nsequences.",
    "Luckily there are methods we can use to compute these sums quickly,\nwhich we will explore in the next two sections.\n",
    "4.2.5\nReading Questions\n1.\nMatch each formula on the left with the type of formula described on the right.\n",
    "𝑎𝑛= 2𝑛+ 3\nGeometric; closed\n𝑎𝑛= 𝑎𝑛−1 + 3\nGeometric; recursive\n𝑎𝑛= 3 · 2𝑛\nArithmetic; recursive\n𝑎𝑛= 3𝑎𝑛−1\nArithmetic; closed\n2.\n",
    "How can you decide whether a sequence is the sequence of partial sums of\nan arithmetic or geometric sequence?",
    "Describe what you would do to check,\nusing an example.\n",
    "3.\n",
    "What questions do you have?",
    "Write at least one question about the content of\nthis section that you or a classmate might be curious about after reading this\nsection.\n",
    "4.2.6\nPractice Problems\n1.\nConsider the recurrence relation 𝑎𝑛= 𝑎𝑛−1 + 7.\n(a) Find the first five terms of the sequence defined by the recurrence relation\nand initial condition 𝑎0 = 17.\n(b) Find the closed formula for the sequence defined by the recurrence\nrelation and initial condition 𝑎0 = 17.\n",
    "(c) Find the first five terms of another sequence, also defined by the same\nrecurrence relation but this time with initial condition 𝑎0 = 1.\n(d) Find the closed formula for this second sequence.\n",
    "2.\nConsider the recurrence relation 𝑎𝑛= 7𝑎𝑛−1.\n",
    "(a) Find the first five terms of the sequence defined by the recurrence relation\nand initial condition 𝑎0 = 10.\n(b) Find the closed formula for the sequence defined by the recurrence\nrelation and initial condition 𝑎0 = 10.\n(c) Find the first five terms of another sequence, also defined by the same\nrecurrence relation but this time with initial condition 𝑎0 = 17.\n",
    "(d) Find the closed formula for this second sequence.\n",
    "3.\nFind a closed formula for the sequence that starts 3, 27, 243, 2187, 19683, . . . .\n",
    "Assume 𝑎0 = 3.\n\n4.2.",
    "Rate of Growth\n335\n4.\nFind a closed formula for the sequence that starts 16, 26, 36, 46, 56, . . . .",
    "Assume\n𝑎0 = 16.\n",
    "5.\nConsider the sequence that starts 1, 7, 13, 19, 25, . . .",
    "where 𝑎0 = 1.\n(a) Which of the following could be a recursive definition for the sequence?\n• 𝑎𝑛= 1 · 6𝑛\n• 𝑎𝑛= 6 · 𝑎𝑛−1; 𝑎0 = 1\n• 𝑎𝑛= 𝑎𝑛−1 + 𝑎𝑛−2; 𝑎0 = 1\n• 𝑎𝑛= 𝑎𝑛−1 + 6; 𝑎0 = 1\n• None of the above\n(b) Find the closed formula for the sequence.\n",
    "(c) Is 3007 a term of the sequence?\n6.\n",
    "Your summer job pays you $1000 per week, with a raise of $50 per week as a\nbonus for not being a quitter.",
    "How much will you make in the 10th week?\n7.\n",
    "Your sister’s summer job pays her $1000 per week, with a raise of 5% per week\nas a bonus for not being a quitter.",
    "How much will she make in the 10th week?\n8.\nFind 𝑥and 𝑦such that 125, 𝑥, 𝑦, 1 is part of an arithmetic sequence.\n",
    "𝑥=\n, 𝑦=\nThen find 𝑥and 𝑦so that the sequence is part of a geometric sequence.\n",
    "𝑥=\n, 𝑦=\n(Warning:",
    "𝑥and 𝑦might not be integers.)\n",
    "9.\nFind 𝑥and 𝑦such that 4, 𝑥, 𝑦, 31 is part of an arithmetic sequence.\n",
    "𝑥=\n, 𝑦=\nThen find 𝑥and 𝑦so that the sequence is part of a geometric sequence.\n",
    "𝑥=\n, 𝑦=\n(Warning:",
    "𝑥and 𝑦might not be integers.)\n",
    "4.2.7\nAdditional Exercises\n1.\nSuppose that the candy machine currently holds exactly 650 Skittles, and every\ntime someone inserts a quarter, exactly 7 Skittles come out of the machine.\n",
    "(a) How many Skittles will be left in the machine after 20 quarters have been\ninserted?\n(b) Will there ever be exactly zero Skittles left in the machine?",
    "Explain.\n",
    "2.\nIs there a pair of integers (𝑎, 𝑏) such that 𝑎, 𝑥1, 𝑦1, 𝑏is part of an arithmetic\nsequence and 𝑎, 𝑥2, 𝑦2, 𝑏is part of a geometric sequence with 𝑥1, 𝑥2, 𝑦1, 𝑦2 all\nintegers?\n\n336\n4.",
    "Sequences\n3.\nAre there any sequences that are both arithmetic and geometric?",
    "If so, how\nmany can you find?",
    "If not, explain why not.\n4.\n",
    "Starting with any rectangle, we can create a new, larger rectangle by attaching\na square to the longer side.",
    "For example, if we start with a 2 × 5 rectangle, we\nwould glue on a 5 × 5 square, forming a 5 × 7 rectangle:\n5\n2\n5\n⇝5\n7\nThe next rectangle would be formed by attaching a 7 × 7 square to the top\nor bottom of the 5 × 7 rectangle.\n",
    "(a) Create a sequence of rectangles using this rule starting with a 1 × 2\nrectangle.",
    "Then write out the sequence of perimeters for the rectangles\n(the first term of the sequence would be 6, since the perimeter of a 1 × 2\nrectangle is 6; the next term would be 10).\n",
    "(b) Repeat the above part, this time starting with a 1 × 3 rectangle.\n",
    "(c) Find recursive formulas for each of the sequences of perimeters you\nfound in parts (a) and (b).",
    "Don’t forget to give the initial conditions as\nwell.\n",
    "(d) Are the sequences arithmetic?",
    "Geometric?",
    "If not, are they close to being\neither of these (i.e., are the differences or ratios almost constant)?",
    "Explain.\n",
    "5.\nProve that the closed formula for a geometric sequence with initial term 𝑎≠0\nand common ratio 𝑟is 𝑎𝑛= 𝑎𝑟𝑛, using telescoping.\n",
    "6.\n",
    "Telescoping to find a sum.",
    "Another context in which sequences arise is calculus\nwhen you study sequences and series (which is the word in calculus for what\nwe call a sequence of partial sums).",
    "Some of the techniques we have developed\nhere can be applied there as well.",
    "This is an example of a telescoping sum,\nsimilar to the telescoping technique we used.\n",
    "Consider the sequence (𝑎𝑛)𝑛≥1 that starts\n1\n1, 1\n3, 1\n6, 1\n10, 1\n15, . . . .\n",
    "That is, each term is the reciprocal of the 𝑛th triangular number.",
    "Find the sum\nof the first 𝑛terms of this sequence:\n𝑛\nÕ\n𝑘=1\n1\n𝑇𝑘\n= 1\n1 + 1\n3 + 1\n6 + 1\n10 + · · ·",
    "+ 1\n𝑇𝑛\n.\n\n",
    "4.2.",
    "Rate of Growth\n337\n7.\n",
    "A geometric sequence has a constant rate of growth in the sense that the\nratio of consecutive terms is always the same.",
    "But what can we say about the\ndifference of consecutive terms in an geometric sequence?\n(a) Consider the geometric sequence 1, 2, 4, 8, 16, . .",
    "..",
    "Find the differences\nbetween consecutive terms.",
    "That is, find its sequence of differences.\n",
    "(b) Find a closed formula for the sequence of differences.",
    "Then use this\nclosed formula to find a different recurrence relation for the original\nsequence (other than 𝑎𝑛= 2𝑎𝑛−1).\n",
    "(c) Repeat the two parts above for a different geometric sequence of your\nchoice.",
    "Then explain what you found in general.\n8.\nNone of the following sequences are arithmetic or geometric:\n1, 3, 6, 10, 15, . . .\n",
    "3, 5, 8, 12, 17, . . .\n",
    "0, 2, 5, 9, 14, . .",
    ".\n",
    "Explain what these sequences have in common with each other and then use\nthat to find a closed formula for each of them.",
    "How do their closed formulas\nrelate to each other?",
    "What can you say in general?\n\n4.3\nPolynomial Sequences\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Identify a sequence as having a polynomial closed formula based on\nits sequence of differences, and determine the polynomial’s degree.\n",
    "2. Fit an appropriate degree polynomial to a sequence of initial terms.\n",
    "3.",
    "Explain how recurrence relations for polynomial sequences relate to\ntheir closed formulas.\n",
    "4.3.1\nSection Preview\nInvestigate!\n",
    "A standard 8 × 8 chessboard contains 64 squares.",
    "Actually, this is just the\nnumber of unit squares.",
    "How many squares of all sizes are there on a\nchessboard?",
    "Start with smaller boards: 1 × 1, 2 × 2, 3 × 3, etc. Find a formula\nfor the total number of squares in an 𝑛× 𝑛board.\n",
    "We have seen that arithmetic sequences grow at a constant rate, and so their\nclosed formulas are linear functions.",
    "What about sequences that grow faster?",
    "What\nif their rate of change (really the differences between terms) is itself growing at a\nconstant rate?\n",
    "In Section 4.2 we claimed that the triangular numbers, the sum of the first 𝑛\npositive integers, have closed formula\n𝑇𝑛= 𝑛(𝑛+ 1)\n2\n= 𝑛2\n2 + 𝑛\n2 .\n",
    "So this sequence, whose sequence of differences is arithmetic, is a degree 2 polynomial\n(a quadratic function).\n",
    "Our goal in this section is to explore this phenomenon.",
    "We will verify that this\nreally is the closed formula for the triangular numbers, extend it to other sequences\nwith arithmetic differences, and then explore sequences that grow at even faster\nrates.\n338\n\n4.3.",
    "Polynomial Sequences\n339\nPreview Activity\n1.\n",
    "While wandering the halls of the math department, you find yourself staring\nat the captivating artwork shown below.\n",
    "(a) How many dots are in the figure?\n",
    "The dots form a\nby\nsquare, for a total of\ndots.\n",
    "(b) We can also compute the total number of dots by summing each “hook”\nregion, from smallest to largest:\n+\n+\n+\n+\n+\n.\n",
    "(c) Yet another way to calculate the total number of dots is to group the\nterms of this sum.\n",
    "1 + 11 =\n; 3 + 9 =\n; 5 + 7 =\n.\n",
    "Since there are three pairs of sums, the total is 3·\n=\n.\n",
    "(d) If we generalize the diagram, so it has 𝑛hooks, how many dots will be in\nthe largest hook?\nHow many dots will be in the second largest hook?\n(e) What will the sum of the smallest and largest hooks be?\n",
    "What will the sum of the second smallest and second largest hooks be?\n(f) If we continue adding pairs of hooks (next smallest plus next largest),\nhow many pairs will we have?\n",
    "Multiplying then, the total number of dots will be:\n.\n",
    "Hint.\n",
    "Let’s assume that 𝑛is even.",
    "If it wasn’t, then there would be a\nsingle “middle” hook that isn’t added to anything, but this is counteracted\nby the fact that 𝑛/2 would count a half hook sum.\n\n340\n4.",
    "Sequences\n4.3.2\nSumming Arithmetic Sequences: Reverse and Add\nLet’s find the sum of the first 𝑛positive integers carefully.",
    "Call that sum 𝑇𝑛, and\nwrite it down twice, once in the usual order and once in reverse order.\n",
    "𝑇𝑛\n=\n1\n+\n2\n+\n3\n+ · · · +\n𝑛\n+\n𝑇𝑛\n=\n𝑛\n+\n(𝑛−1)\n+\n(𝑛−2)\n+ · · · +\n1\n2𝑇𝑛\n=\n𝑛+ 1\n+\n𝑛+ 1\n+\n𝑛+ 1\n+ · · · +\n𝑛+ 1\nWe then added the two equations together.",
    "The left-hand side is 2𝑇𝑛. On the\nright-hand side, something great happens: All the terms of the sum are the same!\n",
    "So instead of adding up a bunch of different numbers, we now just add a bunch of\nthe same number.",
    "That’s a task that multiplication lives for!",
    "There are 𝑛terms in\nthe sum, so we get,\n2𝑇𝑛= 𝑛(𝑛+ 1).\n",
    "Solving for 𝑇𝑛gives us,\n𝑇𝑛= 𝑛(𝑛+ 1)\n2\n,\nas expected.\n",
    "This technique will work for any arithmetic sum.\n",
    "Example 4.3.1\nFind the sum: 2 + 5 + 8 + 11 + 14 + · · · + 470.\nSolution.\n",
    "The idea is to mimic how we found the formula for triangular\nnumbers.",
    "If we add the first and last terms, we get 472.",
    "The second term and\nsecond-to-last term also add up to 472.",
    "To keep track of everything, we might\nexpress this as follows.",
    "Call the sum 𝑆. Then,\n𝑆=\n2\n+\n5\n+\n8\n+ · · · +\n467\n+\n470\n+\n𝑆=\n470\n+\n467\n+\n464\n+ · · · +\n5\n+\n2\n2𝑆=\n472\n+\n472\n+\n472\n+ · · · +\n472\n+\n472\nTo find 2𝑆then, we add 472 to itself a number of times.",
    "What number?",
    "We\nneed to decide how many terms (summands) are in the sum.",
    "Since the terms\nform an arithmetic sequence, the 𝑛th term in the sum (counting 2 as the 0th\nterm) can be expressed as 2 + 3𝑛.",
    "If 2 + 3𝑛= 470 then 𝑛= 156.",
    "So 𝑛ranges\nfrom 0 to 156, giving 157 terms in the sum.",
    "This is the number of 472’s in the\nsum for 2𝑆. Thus\n2𝑆= 157 · 472 = 74104.\n",
    "It is now easy to find 𝑆:\n𝑆= 74104/2 = 37052.\n\n",
    "4.3.",
    "Polynomial Sequences\n341\n",
    "This will work for the sum of any arithmetic sequence.",
    "Call the sum 𝑆. Reverse\nand add.",
    "This produces a single number added to itself many times.",
    "Find the\nnumber of times.",
    "Multiply.",
    "Divide by 2.",
    "Done.\n",
    "Example 4.3.2\nFind a closed formula for 6 + 10 + 14 + · · · + (4𝑛−2).\n",
    "Solution.\n",
    "Again, we have a sum of an arithmetic sequence.",
    "How many\nterms are in the sequence?",
    "Clearly each term in the sequence has the form\n4𝑘−2 (as evidenced by the last term).",
    "For which values of 𝑘though?",
    "To get\n6, 𝑘= 2.",
    "To get 4𝑛−2 take 𝑘= 𝑛.",
    "So to find the number of terms, we must\ncount the number of integers in the range 2, 3, . .",
    ".",
    ", 𝑛. This is 𝑛−1.",
    "(There are\n𝑛numbers from 1 to 𝑛, so one less if we start with 2.)\n",
    "Now reverse and add:\n𝑆=\n6\n+\n10\n+ · · · +\n4𝑛−6\n+\n4𝑛−2\n+\n𝑆=\n4𝑛−2\n+\n4𝑛−6\n+ · · · +\n10\n+\n6\n2𝑆=\n4𝑛+ 4\n+\n4𝑛+ 4\n+ · · · +\n4𝑛+ 4\n+\n4𝑛+ 4\nSince there are 𝑛−1 terms, we get\n2𝑆= (𝑛−1)(4𝑛+ 4)\nso\n𝑆= (𝑛−1)(4𝑛+ 4)\n2\n.\n",
    "Besides finding sums, we can use this technique to find closed formulas for\nsequences we recognize as sequences of partial sums.\n",
    "Example 4.3.3\nUse partial sums to find a closed formula for(𝑎𝑛)𝑛≥0 which starts 2, 3, 7, 14, 24, 37, . . . . .",
    "..\nAssume a recurrence relation for the sequence is 𝑎𝑛= 𝑎𝑛−1 + 3𝑛−2.\n",
    "Solution.\n",
    "First, if you look at the differences between terms, you get a\nsequence of differences (𝑑𝑛)𝑛≥1: 1, 4, 7, 10, 13, . .",
    ".,",
    "which is an arithmetic\nsequence.\n",
    "Indeed, we notice that 𝑑𝑛= 3𝑛−2, which agrees with the\nrecurrence relation.",
    "Written another way:\n𝑎0 = 2\n𝑎1 = 2 + 1 = 2 + 𝑑1\n𝑎2 = 2 + 1 + 4 = 2 + 𝑑1 + 𝑑2\n𝑎3 = 2",
    "+ 1 + 4 + 7 = 2 + 𝑑1 + 𝑑2 + 𝑑3\nand so on.",
    "We can write the general term of (𝑎𝑛) in terms of the arithmetic\nsequence as follows:\n𝑎𝑛= 2 + 1 + 4 + 7 + 10 + · · ·",
    "+ 3𝑛−2.\n\n342\n4.",
    "Sequences\nWe can reverse and add, but the initial 2 does not fit our pattern.",
    "This just\nmeans we need to keep the 2 out of the reverse part:\n𝑎𝑛=\n2\n+\n1\n+\n4\n+ · · · +\n3𝑛−2\n+\n𝑎𝑛=\n2\n+\n3𝑛−2\n+\n3(𝑛−1) −2\n+ · · · +\n1\n2𝑎𝑛=\n4\n+\n2 + 3𝑛−3\n+\n2 + 3𝑛−3\n+ · · · +\n2 + 3𝑛−3\nNot counting the first term (the 4) there are 𝑛summands of 2 + 3𝑛−3 = 3𝑛−1\n",
    "so the right-hand side becomes 4 + (3𝑛−1)𝑛.\nFinally, solving for 𝑎𝑛we get\n𝑎𝑛= 4 + (3𝑛−1)𝑛\n2\n.\n",
    "Just to be sure, we check 𝑎0 = 4\n2 = 2, 𝑎1 = 4+2\n2\n= 3, etc.",
    "We have the correct\nclosed formula.\n",
    "Notice that the closed formula for a sequence that has an arithmetic (i.e., linear)\nrate of change is a quadratic function.",
    "Interesting....\n4.3.3\nHigher Degree Polynomials\nSince we know how to compute the sum of the first 𝑛terms of arithmetic sequences,\nwe can compute the closed formulas for sequences that have an arithmetic sequence\nof differences between terms.",
    "But what if we consider a sequence that is the sum of\nthe first 𝑛terms of a sequence that is itself the sum of an arithmetic sequence?\nHow many squares (of all sizes) are there on a chessboard?",
    "A chessboard consists\nof 64 squares, but we also want to consider squares of longer side length.",
    "Even\nthough we are only considering an 8 × 8 board, there is already a lot to count.",
    "So\ninstead, let us build a sequence: the first term will be the number of squares on a\n1 × 1 board, the second term will be the number of squares on a 2 × 2 board, and so\non.",
    "After a little thought, we arrive at the sequence\n1, 5, 14, 30, 55, . . . .\n",
    "This sequence is not arithmetic (or geometric for that matter), but perhaps its\nsequence of differences is.",
    "For differences we get\n4, 9, 16, 25, . . . .\n",
    "Not a huge surprise: One way to count the number of squares in a 4×4 chessboard\nis to notice that there are 16 squares with side length 1, 9 with side length 2, 4 with\nside length 3 and 1 with side length 4.",
    "So the original sequence is just the sum of\nsquares.",
    "Now this sequence of differences is not arithmetic since its sequence of\ndifferences (the differences of the differences of the original sequence) is not constant.\n",
    "In fact, this sequence of second differences is\n5, 7, 9, . . .",
    ",\n\n4.3.",
    "Polynomial Sequences\n343\nwhich is an arithmetic sequence (with constant difference 2).",
    "Notice that our original\nsequence had third differences (that is, differences of differences of differences of\nthe original) constant.",
    "We will call such a sequence Δ3-constant.",
    "The sequence\n1, 4, 9, 16, . . .",
    "has second differences constant, so it will be a Δ2-constant sequence.\n",
    "In general, we will say a sequence is a Δ𝑘-constant sequence if the 𝑘th differences\nare constant.\n",
    "Example 4.3.4\nWhich of the following sequences are Δ𝑘-constant for some value of 𝑘?\n1. 2, 3, 7, 14, 24, 37, . .",
    "..\n",
    "2. 1, 8, 27, 64, 125, 216, . .",
    "..\n",
    "3. 1, 2, 4, 8, 16, 32, 64, . .",
    "..\n",
    "Solution.\n",
    "1.",
    "This is the sequence from Example 4.3.3, in which we found a closed\nformula by recognizing the sequence as the sequence of partial sums\nof an arithmetic sequence.",
    "Indeed, the sequence of first differences\nis 1, 4, 7, 10, 13, . .",
    "., which itself has differences 3, 3, 3, 3, . .",
    "..\n",
    "Thus\n2, 3, 7, 14, 24, 37, . .",
    ".",
    "is a Δ2-constant sequence.\n",
    "2.",
    "These are the perfect cubes.\n",
    "The sequence of first differences is\n7, 19, 37, 61, 91, . .",
    ".; the sequence of second differences is 12, 18, 24, 30, . .",
    ".;\nthe sequence of third differences is constant: 6, 6, 6, . .",
    "..",
    "Thus the perfect\ncubes are a Δ3-constant sequence.\n",
    "3.",
    "If we take first differences, we get 1, 2, 4, 8, 16, . .",
    "..",
    "Wait, what?",
    "That’s\nthe sequence we started with.",
    "So taking second differences will give us\nthe same sequence again.",
    "No matter how many times we repeat this\nwe will always have the same sequence, which in particular means no\nfinite number of differences will be constant.",
    "Thus this sequence is not\nΔ𝑘-constant for any 𝑘.\nThe Δ0-constant sequences are themselves constant, so a closed formula for\nthem is easy to compute (it’s just the constant).",
    "The Δ1-constant sequences are\narithmetic, and we have a method for finding closed formulas for them as well.\n",
    "Every Δ2-constant sequence is the sum of an arithmetic sequence, so we can find\nformulas for these as well.",
    "But notice that the format of the closed formula for a\nΔ2-constant sequence is always quadratic.",
    "For example, the square numbers are\nΔ2-constant with closed formula 𝑎𝑛= 𝑛2.",
    "The triangular numbers (also Δ2-constant)\nhave closed formula 𝑎𝑛= 𝑛(𝑛+1)\n2\n, which when multiplied out gives you an 𝑛2 term as\nwell.",
    "It appears that every time we increase the complexity of the sequence, that\nis, increase the number of differences before we get constants, we also increase the\n\n344\n4.",
    "Sequences\ndegree of the polynomial used for the closed formula.",
    "We go from constant to linear\nto quadratic.",
    "The sequence of differences between terms tells us something about\nthe rate of growth of the sequence.",
    "If a sequence is growing at a constant rate, then\nthe formula for the sequence will be linear.",
    "If the sequence is growing at a rate which\nitself is growing at a constant rate, then the formula is quadratic.",
    "You might have\nseen this elsewhere: If a function has a constant second derivative (rate of change),\nthen the function must be quadratic.\n",
    "This works in general:\nTheorem 4.3.5 Polynomial Fitting.\n",
    "The closed formula for a sequence will be a degree 𝑘polynomial if and only if the\nsequence is Δ𝑘-constant (i.e., the 𝑘th sequence of differences is constant).\n",
    "This tells us that the sequence of numbers of squares on a chessboard, 1, 5, 14, 30, 55, . .",
    ".,\nwhich we saw to be Δ3-constant, will have a cubic (degree 3 polynomial) for its\nclosed formula.\n",
    "Now once we know what format the closed formula for a sequence will take, it is\nmuch easier to actually find the closed formula.",
    "In the case that the closed formula\nis a degree 𝑘polynomial, we just need 𝑘+ 1 data points to “fit” the polynomial to\nthe data.\n",
    "Example 4.3.6\nFind a formula for the sequence 3, 7, 14, 24, . . ..",
    "Assume 𝑎1 = 3.\nSolution.\n",
    "First, check to see if the formula has constant differences at some\nlevel.",
    "The sequence of first differences is 4, 7, 10, . . .",
    "which is arithmetic, so\nthe sequence of second differences is constant.",
    "The sequence is Δ2-constant,\nso the formula for 𝑎𝑛will be a degree 2 polynomial.",
    "That is, we know that for\nsome constants 𝑎, 𝑏, and 𝑐,\n𝑎𝑛= 𝑎𝑛2",
    "+ 𝑏𝑛+ 𝑐.\n",
    "Now to find 𝑎, 𝑏, and 𝑐. First, it would be nice to know what 𝑎0 is, since\nplugging in 𝑛= 0 simplifies the above formula greatly.",
    "In this case, 𝑎0 = 2\n(work backward from the sequence of constant differences).",
    "Thus\n𝑎0 = 2 = 𝑎· 02 + 𝑏· 0",
    "+ 𝑐,\nso 𝑐= 2.",
    "Now plug in 𝑛= 1 and 𝑛= 2.",
    "We get\n𝑎1 = 3 = 𝑎+ 𝑏+ 2\n𝑎2 = 7 = 𝑎4 + 𝑏2 +",
    "2.\nAt this point, we have two (linear) equations and two unknowns, so we\ncan solve the system for 𝑎and 𝑏(using substitution or elimination or even\nmatrices).",
    "We find 𝑎= 3\n2 and 𝑏= −1\n2 , so 𝑎𝑛= 3\n2𝑛2 −1\n2𝑛+ 2.\n\n4.3.",
    "Polynomial Sequences\n345\nExample 4.3.7\nFind a closed formula for the number of squares on an 𝑛× 𝑛chessboard.\n",
    "Solution.\n",
    "We have seen that the sequence 1, 5, 14, 30, 55, . . .",
    "is Δ3-constant,\nso we are looking for a degree 3 polynomial.",
    "That is,\n𝑎𝑛= 𝑎𝑛3",
    "+ 𝑏𝑛2",
    "+ 𝑐𝑛+ 𝑑.\nWe can find 𝑑if we know what 𝑎0 is.",
    "Working backward from the third\ndifferences, we find 𝑎0 = 0 (unsurprisingly, since there are no squares on a\n0 × 0 chessboard).",
    "Thus 𝑑= 0.",
    "Now plug in 𝑛= 1, 𝑛= 2, and 𝑛= 3:\n1 =𝑎+ 𝑏+ 𝑐\n5 =8𝑎+ 4𝑏+ 2𝑐\n14 =27𝑎+ 9𝑏+ 3𝑐.\nIf we solve this system of equations, we get 𝑎= 1\n3, 𝑏= 1\n2 and 𝑐= 1\n6.\n",
    "Therefore the number of squares on an 𝑛×𝑛chessboard is 𝑎𝑛= 1\n3𝑛3+ 1\n2𝑛2+ 1\n6𝑛=\n1\n6𝑛(𝑛+ 1)(2𝑛+ 1).\n",
    "Note: Since the squares-on-a-chessboard problem is really asking for the sum of\nsquares, we now have a nice formula for\n𝑛\nÕ\n𝑘=1\n𝑘2.\n",
    "Example 4.3.8\nFind a closed formula for (𝑎𝑛)𝑛≥0 which starts 2, 3, 7, 14, 24, 37, . .",
    "..",
    "Assume a\nrecurrence relation for the sequence is 𝑎𝑛= 𝑎𝑛−1 + 3𝑛−2\nSolution.\n",
    "Note that we have already done this in Example 4.3.3, but now\nwe can solve this using polynomial fitting.\n",
    "The sequence of (first) differences is 1, 4, 7, 10, 13, . . .",
    "(which agrees with\nwhat is given in the recurrence relation).",
    "The sequence of second differences\nis 3, 3, 3, 3, . . .",
    "constant!",
    "So we expect that the closed formula for 𝑎𝑛will be a\ndegree 2 polynomial.",
    "That is, we guess,\n𝑎𝑛= 𝑎𝑛2 + 𝑏𝑛+ 𝑐.\n",
    "Since 𝑎0 = 2, we know that 𝑐= 2 (as 𝑎· 02 + 𝑏· 02 + 𝑐= 2).",
    "Then, we can\nsee what happens with 𝑛= 1 and 𝑛= 2:\n𝑎1 = 3 =𝑎· 12 + 𝑏· 1 + 2\n𝑎2 = 7 =𝑎· 22 + 𝑏· 2 + 2.\n\n346\n4.",
    "Sequences\nSimplifying this, we must find 𝑎and 𝑏which satisfy the equations\n1 =𝑎+ 𝑏\n5 =4𝑎+ 2𝑏.\nUsing a computer algebra system or substitution or elimination, we find that\n𝑎= 3\n2 and 𝑏= −1\n2.",
    "Therefore the closed formula is,\n𝑎𝑛= 3\n2𝑛2 −1\n2𝑛+ 2.\n",
    "This is the same as we found in Example 4.3.3, once you multiply out that\nsolution.\n",
    "Not all sequences will have polynomials as their closed formula.",
    "We can use the\ntheory of finite differences to identify these.\n",
    "Example 4.3.9\nDetermine whether the following sequences can be described by a polynomial,\nand if so, of what degree.\n",
    "1. 1, 2, 4, 8, 16, . . .\n",
    "2. 0, 7, 50, 183, 484, 1055, . . .\n",
    "3. 1, 1, 2, 3, 5, 8, 13, . . .\n",
    "Solution.\n",
    "1.",
    "As we saw in Example 4.3.4, this sequence is not Δ𝑘-constant for any 𝑘.\n",
    "Therefore the closed formula for the sequence is not a polynomial.",
    "In\nfact, we know the closed formula is 𝑎𝑛= 2𝑛, which grows faster than\nany polynomial (so is not a polynomial).\n",
    "2.",
    "The sequence of first differences is 7, 43, 133, 301, 571, . .",
    "..",
    "The second\ndifferences are: 36, 90, 168, 270, . . ..",
    "Third differences: 54, 78, 102, . .",
    "..\n",
    "Fourth differences: 24, 24, . .",
    "..",
    "As far as we can tell, this sequence of\ndifferences is constant so the sequence is Δ4-constant, and as such the\nclosed formula is a degree 4 polynomial.\n",
    "3.",
    "This is the Fibonacci sequence.",
    "The sequence of first differences is\n0, 1, 1, 2, 3, 5, 8, . .",
    "., the second differences are 1, 0, 1, 1, 2, 3, 5 . .",
    "..",
    "We\nnotice that after the first few terms, we get the original sequence back.\n",
    "So there will never be constant differences, so the closed formula for the\nFibonacci sequence is not a polynomial.\n\n",
    "4.3.",
    "Polynomial Sequences\n347\nWarning 4.3.10",
    "A degree 𝑛polynomial is completely determined by its 𝑛+ 1\ncoefficients (the +1 is because of the constant term).",
    "Therefore we can always\nfind a degree 𝑛polynomial when given 𝑛+ 1 terms of a sequence.\n",
    "If we take the 𝑛+ 1 terms, we can take differences of differences of\ndifferences of... until (after 𝑛steps) we are left with just a single number.",
    "As\nfar as we can tell, this 𝑛th difference is constant.",
    "This doesn’t mean we have\nfound the closed formula for the right sequence.",
    "This is why it is so important\nto work with sequences in a particular context.\n",
    "4.3.4\nSolving Systems of Equations with Technology\n",
    "The point of polynomial fitting is that if we can be sure that a sequence has a\npolynomial as its closed formula, then we can find that formula.",
    "Since we know the\ndegree of the polynomial, all we need is to find its coefficients, and with enough\nterms of the sequence, we can find a system of enough linear equations whose\nsolution will be those coefficients.",
    "However, this requires solving a system of linear\nequations.\n",
    "For a degree 2 polynomial, we need to find three coefficients (the constant term,\nthe coefficient of 𝑛, and the coefficient of 𝑛2).",
    "A system of three linear equations will\nbe enough to find these three unknowns.",
    "In fact, since 𝑎0 will be the constant term,\nwe can really get away with just two equations and two unknowns, and this is not\ndifficult to solve by hand.\n",
    "For higher degree polynomials, the number of equations is larger, and solving by\nhand can be tedious.",
    "Luckily, it is easy for computers to solve these equations.",
    "Below\nwe demonstrate how to use the free computer algebra system SageMath, as well as\npython, to solve these systems of equations.",
    "Besides these two choices, pretty much\nany computer algebra system (including Wolfram Alpha) can solve these systems of\nequations.\n",
    "Suppose we have the following system of three equations and three unknowns,\nas in the chess board example above:\n1",
    "=𝑎+ 𝑏+ 𝑐\n5 =8𝑎+ 4𝑏+ 2𝑐\n14 =27𝑎+ 9𝑏+ 3𝑐\n",
    "In SageMath, we can use the solve method to solve the system of equations.",
    "Here\nis the code:\nvar('a␣b␣c')\nsolve(\n[\na+b+c==1,\n8*a+4*b+2*c==5,\n27*a+9*b+3*c==14\n], a,b,c)\n\n348\n4.",
    "Sequences\n",
    "[[a == (1/3), b == (1/2), c == (1/6)]]\nThis is easier than in python, but python might be more readily available.",
    "One\nway you can solve the system in python is to use the numpy library.",
    "In this case,\nyou would create a matrix of coefficients and a vector of constants, and then use the\nsolve method.",
    "Here is the code:\nimport numpy as np\nA = np.array ([[1 ,1 ,1] ,[8 ,4 ,2] ,[27 ,9 ,3]]",
    ")\nb = np.array ([1 ,5 ,14])\n",
    "x = np.linalg.solve(A,b)\nprint(x)\n",
    "An explanation of what is going on here: We create a matrix A of coefficients of\nthe system of equations (not the coefficients of the closed formula we are looking\nfor),\n𝐴=\n\n1\n1\n1\n8\n4\n2\n27\n9\n3\n\nand a vector b for the constants,\n𝑏=\n\n1\n5\n14\n\n.\n",
    "What numpy does is solve the matrix equation\n",
    "𝐴𝑥= 𝑏.\n",
    "The vector 𝑥that satisfies this matrix equation will be the values of the unknowns in\nthe system (so the vector",
    "[𝑎, 𝑏, 𝑐]).\n",
    "Of course, once you find the coefficients of the polynomial, you should still write\nout the closed formula using those coefficients.",
    "It is always a good idea to check that\nthe formula appears to work by using an 𝑛that you did not use to get your system\nof equations.\n",
    "4.3.5\nReading Questions\n1.\nMatch each sequence on the left with the type of closed formula it might have,\non the right.\n",
    "3, 7, 11, 15, 19, . . .\n",
    "Linear formula\n3, 5, 8, 12, 18, . . .\n",
    "Cubic formula\n3, 4, 7, 13, 23, . . .\n",
    "Exponential (not a polynomial)\n3, 4, 7, 11, 18, 29, . . .\n",
    "Quadratic formula\n2.\nSuppose (𝑎𝑛) is a sequence whose sequence of differences has a degree 2\npolynomial as its closed formula.",
    "What can you say about the sequence of\npartial sums of (𝑎𝑛)?",
    "Explain.\n\n",
    "4.3.",
    "Polynomial Sequences\n349\n3.\n",
    "What questions do you have?",
    "Write at least one question about the content of\nthis section that you or a classmate might be curious about after reading this\nsection.\n",
    "4.3.6\nPractice Problems\n1.\nConsider the sequence 10, 13, 16, 19, 22 . . .",
    "where 𝑎1 = 10.\n(a) What is the recursive definition for the sequence?\n(b) Give a closed formula for the 𝑛th term of the sequence.\n",
    "(c) Is 1555 a term in the sequence?\n(d) How many terms does the finite sequence 10, 13, 16, . . .",
    ", 433 have?\n(e) Find the sum: 10 + 13 + 16 + . . .",
    "+",
    "433.\n(f) Use what you found above to find 𝑏𝑛, the 𝑛th term of 3, 13, 26, 42, 61, . . .\n",
    "2.\nConsider the sequence (𝑎𝑛)𝑛≥0 which starts 5, 10, 15, 20, . . . .\n",
    "a.",
    "What is the next term in the sequence?\nb.",
    "Find a formula for the 𝑛th term of this sequence.\n",
    "𝑎𝑛=\nc. Find the sum of the first 100 terms of the sequence: Í99\n𝑘=0 𝑎𝑘.\n3.\nConsider the sum 9 + 14 + 19 + 24 + · · · + 229.\na.",
    "How many terms (summands) are in the sum?\nb.",
    "Compute the sum using a technique discussed in this section.\n",
    "4.\nConsider the sequence −18, −6, 6, 18, . . .",
    ", 12𝑛+ 6.\na. How many terms are there in the sequence?",
    "Your answer will be in terms\nof 𝑛.\nb.",
    "What is the second-to-last term?\n",
    "c. Find the sum of all the terms in the sequence, in terms of 𝑛.\n5.\nFind 2 + 8 + 14 + 20 + · · ·",
    "+ 1808 using a technique from this section.\n",
    "6.\nUse polynomial fitting to find the formula for the 𝑛th term of the sequence\n(𝑎𝑛)𝑛≥0 which starts,\n0, 9, 20, 33, 48, 65, . . .\n",
    "𝑎𝑛=\n\n350\n4.",
    "Sequences\n7.\nUse polynomial fitting to find the formula for the 𝑛th term of the sequence\n(𝑎𝑛)𝑛≥0 which starts,\n−1, 4, 11, 20, 31, 44, . . .\n",
    "𝑎𝑛=\n8.\nUse polynomial fitting to find the formula for the 𝑛th term of the sequence\n(𝑎𝑛)𝑛≥0 which starts,\n5, 5, 17, 53, 125, 245, . . .\n",
    "𝑎𝑛=\n9.\nUse polynomial fitting to find the formula for the 𝑛th term of the sequence\n(𝑎𝑛)𝑛≥1 which starts,\n9, 43, 117, 243, 433, . . .",
    "Note the first term above is 𝑎1, not 𝑎0.\n",
    "𝑎𝑛=\n10.\nSuppose 𝑎𝑛= 2𝑛2",
    "+",
    "3𝑛+ 2. Find a closed formula for the sequence of differ-\nences by computing 𝑎𝑛−𝑎𝑛−1.",
    "Simplify your answer as much as possible.\n",
    "11.\nUse polynomial fitting to find the formula for the 𝑛th term of the sequence\n(𝑎𝑛)𝑛≥1 which starts,\n7, 32, 87, 184, 335, . . .",
    "Note the first term above is 𝑎1, not 𝑎0.\n",
    "𝑎𝑛=\n4.3.7\nAdditional Exercises\n1.\n",
    "Your friendly neighborhood bodega has a candy machine that gives 7 Skittles\nto the first customer who puts in a quarter, 10 to the second, 13 to the third, 16\nto the fourth, etc.",
    "How many candies has the machine given out in total after\n20 quarters are put into the machine?",
    "After 𝑛quarters?\n2.\nNot to be outdone, the mega-mart across the street has installed a candy\nmachine that gives 4 Skittles to the first customer, 7 to the second, 12 to the\nthird, 19 to the fourth, etc.",
    "How many Skittles has the machine given out in\ntotal after 20 quarters are put into the machine?",
    "After 𝑛quarters?\n3.\nMake up sequences that have\n(a) 3, 3, 3, 3, . . .",
    "as its second differences.\n",
    "(b) 1, 2, 3, 4, 5, . . .",
    "as its third differences.\n",
    "(c) 1, 2, 4, 8, 16, . . .",
    "as its 100th differences.\n",
    "4.\nConsider the sequence 1, 3, 7, 13, 21, . .",
    "..",
    "Explain how you know the closed\nformula for the sequence will be quadratic.",
    "Then “guess” the correct formula\nby comparing this sequence to the squares 1, 4, 9, 16, . . .",
    "(do not use polynomial\nfitting).\n\n",
    "4.3.",
    "Polynomial Sequences\n351\n5.\nUse a similar technique as in the previous exercise to find a closed formula for\nthe sequence 2, 11, 34, 77, 146, 247, . .",
    "..\n",
    "6.\nConsider the sequence 2, 7, 15, 26, 40, 57, . . .",
    "(with 𝑎0 = 2).",
    "By looking at the\ndifferences between terms, express the sequence as a sequence of partial sums.\n",
    "Then find a closed formula for the sequence by computing the 𝑛th partial sum.\n",
    "7.\n",
    "If you have enough toothpicks, you can make a large triangular grid.",
    "Below,\nare the triangular grids of size 1 and of size 2.",
    "The size 1 grid requires 3\ntoothpicks, the size 2 grid requires 9 toothpicks.\n",
    "(a) Let 𝑡𝑛be the number of toothpicks required to make a size 𝑛triangular\ngrid.",
    "Write out the first 5 terms of the sequence 𝑡1, 𝑡2, . .",
    "..\n(b) Find a recursive definition for the sequence.",
    "Explain why you are correct.\n",
    "(c) Is the sequence arithmetic or geometric?",
    "If not, is it the sequence of\npartial sums of an arithmetic or geometric sequence?",
    "Explain why your\nanswer is correct.\n",
    "(d) Use your results from part (c) to find a closed formula for the sequence.\n",
    "Show your work.\n",
    "8.\n",
    "If you were to shade in an 𝑛× 𝑛square on graph paper, you could do it the\nboring way (with sides parallel to the edge of the paper) or the interesting way,\nas illustrated below:\nThe interesting thing here is that a 3 × 3 square now has area 13.",
    "Our goal\nis to find a formula for the area of an 𝑛× 𝑛(diagonal) square.\n",
    "(a) Write out the first few terms of the sequence of areas (assume 𝑎1 = 1,\n𝑎2 = 5, etc).",
    "Is the sequence arithmetic or geometric?",
    "If not, is it the\nsequence of partial sums of an arithmetic or geometric sequence?",
    "Explain\nwhy your answer is correct, referring to the diagonal squares.\n\n",
    "352\n4.",
    "Sequences\n(b) Use your results from part (a) to find a closed formula for the sequence.\n",
    "Show your work.",
    "Note that while there are lots of ways to find a closed\nformula here, you should use partial sums specifically.\n",
    "(c) Find the closed formula in as many other interesting ways as you can.\n",
    "9.\nGeneralize Practice Problem 5: Find a closed formula for the sequence of\ndifferences of 𝑎𝑛= 𝑎𝑛2 +",
    "𝑏𝑛+ 𝑐.",
    "That is, prove that every quadratic sequence\nhas arithmetic differences.\n",
    "10.\n",
    "Can you use polynomial fitting to find the formula for the 𝑛th term of the\nsequence 4, 7, 11, 18, 29, 47, . . . ?",
    "Explain why or why not.\n11.\n",
    "Will the 𝑛th sequence of differences of 2, 6, 18, 54, 162, . . .",
    "ever be constant?\nExplain.\n12.\n",
    "In their down time, ghost pirates enjoy stacking cannonballs in triangular\nbased pyramids (aka, tetrahedrons), like those pictured here:\nNote: These are solid tetrahedrons, so there will be some cannonballs\nobscured from view (the picture on the right has one cannonball in the back\nnot shown in the picture, for example).\n",
    "The pirates wonder how many cannonballs would be required to build a\npyramid 15 layers high (thus breaking the world cannonball stacking record).\n",
    "Can you help?\n(a) Let 𝑃(𝑛) denote the number of cannonballs needed to create a pyramid 𝑛\nlayers high.",
    "So 𝑃(1) = 1, 𝑃(2) = 4, and so on.",
    "Calculate 𝑃(3), 𝑃(4), and\n𝑃(5).\n",
    "(b) Use polynomial fitting to find a closed formula for 𝑃(𝑛).",
    "Show your work.\n",
    "(c) Answer the pirate’s question: How many cannonballs do they need to\nmake a pyramid 15 layers high?\n(d) Bonus:",
    "Locate this sequence in Pascal’s triangle.",
    "Why does that make\nsense?\n\n4.4\nExponential Sequences\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Identify a sequence as exponential based on its recurrence relation.\n",
    "2. Apply the characteristic root technique to solve appropriate recurrence\nrelations.\n",
    "4.4.1\nSection Preview\nInvestigate!\n",
    "You have a large collection of 1 × 1 squares and 1 × 2 dominoes.",
    "You want to\narrange these to make a 1 × 15 strip.",
    "How many ways can you do this?\n",
    "What if the squares come in three different colors and the dominos come\nin four different colors?",
    "And why is this second question easier than the\nfirst?\nHint.\n",
    "Start by creating a recurrence relation.",
    "How are the different 1 × 3\nstrips and 1 × 4 strips related to the 1 × 5 strips?\n",
    "In Section 4.3 we saw that if a sequence has some sequence of differences that is\nconstant, then the sequence has a polynomial closed formula.",
    "Are there sequences\nthat never have constant differences?",
    "And what would their closed formulas look\nlike?\nConsider the Fibonacci sequence:\n0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, . . . .\n",
    "If we look at the first differences, we get this sequence:\n1, 1, 2, 3, 5, 8, 13, 21, 34, . . .",
    ",\nwhich is the Fibonacci sequence itself.",
    "This is not surprising, since the Fibonacci\nsequence is defined by the recurrence relation 𝐹𝑛= 𝐹𝑛−1 + 𝐹𝑛−2.",
    "That is saying\nprecisely that to get the next turn of the sequence, we take the current term and\nadd... a term in the sequence!\n",
    "Of course, if we take another difference, we will get the same sequence back, and\nagain and again, so no 𝑛th differences will be constant.\n",
    "Another sequence that has this behavior is the powers of 2:\n1, 2, 4, 8, 16, 32, 64, 128, 256, 512, . . .\n",
    "353\n\n354\n4.",
    "Sequences\nwhich has differences\n1, 2, 4, 8, 16, 32, 64, 128, 256, . . .",
    ".\n",
    "We can also see this from the recurrence relation, since\n𝑎𝑛= 2𝑎𝑛−1 = 𝑎𝑛−1 + 𝑎𝑛−1.\n",
    "The rate of growth for this, and in fact any geometric sequence, is the sequence itself.\n",
    "If you have studied calculus, you may recall that the functions that have them-\nselves (or close) as their rate of change (derivative, in the calculus context) are exactly\nthe exponential functions.",
    "Here too, geometric sequences, which have exponential\nclosed formulas, have themselves as their rate of change.\n",
    "In this section, we will explore sequences that are changing at a rate proportional\nto the sequence itself, and see how these all have an exponential closed formula, or\nsome variation of that.\n",
    "Preview Activity\n1.\nConsider the recurrence relation\n𝑎𝑛= 5𝑎𝑛−1 −6𝑎𝑛−2.\n",
    "Since the 𝑛th term is given as a combination of the two previous terms, we\nwill need two initial terms to determine the sequence.",
    "Different initial terms\nwill give different sequences.\n",
    "(a) What sequence do you get if the initial conditions are 𝑎0 = 1, 𝑎1 = 2?",
    "Give\nthe first five terms (including 1 and 2).\n",
    "(b) Based on the first few terms, what is a closed formula for this sequence?\n(c) What sequence do you get if the initial conditions are 𝑎0 = 1, 𝑎1 = 3?",
    "Give\nthe first five terms.\n",
    "(d) Based on the first few terms, what is a closed formula for this sequence?\n(e) What sequence do you get if the initial conditions are 𝑎0 = 2, 𝑎1 = 5?",
    "Give\nthe first five terms.\n",
    "(f) Based on the first few terms, what is a closed formula for this sequence?\nHint.\n",
    "How do the terms in this sequence relate to the terms in the\nprevious two sequences?\n",
    "4.4.2\nSumming Geometric Sequences: Multiply, Shift, and Subtract\nSuppose a candy machine dispenses candy in a geometric sequence by first giving 1\ncandy, then 2 candies, then 4, then 8, and so on.",
    "How many candies will you have\nreceived in total after 10 turns of the machine?\n\n4.4.",
    "Exponential Sequences\n355\nWe can create the sequence of partials sum as 1, 1 + 2, 1 + 2 + 4, 1 + 2 + 4 + 8, . . .\n",
    "that gives\n1, 3, 7, 15, 31, 63, . .",
    ".\n",
    "This is not a geometric sequence, but is almost.",
    "In fact, if we add 1 to each term, we\nget what sure looks like the geometric sequence 2, 4, 8, 16, 32, 64, . .",
    ".,",
    "so we might\nguess that the closed formula for the sequence of sums is 2𝑛+1 −1.",
    "If this is correct,\nthen the answer to the candy question would be 211 −1 = 2047.\n",
    "More intriguing though is the observation that the sequence of partial sums of a\ngeometric sequence is again geometric-ish.",
    "Let’s consider how to find the sum of a\ngeometric sequence in general.\n",
    "We cannot just reverse and add as we did for the sum of an arithmetic sequence.\n",
    "Do you see why?",
    "The reason we got the same term added to itself many times\nis because there was a constant difference.",
    "So as we added that difference in one\ndirection, we subtracted the difference going the other way, leaving a constant total.\n",
    "For geometric sums; we have a different technique.\n",
    "Example 4.4.1\nWhat is 3 + 6 + 12 + 24 + · · · + 12288?\nSolution.\n",
    "Multiply each term by 2, the common ratio.",
    "We get 2𝑆= 6 + 12 +\n24 + · · · + 24576.",
    "Now subtract: 2𝑆−𝑆= −3 + 24576 = 24573.",
    "Since 2𝑆−𝑆= 𝑆,\nwe have our answer.\n",
    "To better see what happened in the above example, we can write it this way:\n𝑆=\n3 +\n6 + 12 + 24 + · · · + 12288\n−\n2𝑆=\n6 + 12 + 24 + · · · + 12288\n+24576\n−𝑆=\n3 +\n0",
    "+ 0",
    "+ 0 + · · · + 0\n−24576\nThen divide both sides by −1 and we have the same result for 𝑆. The idea is, by\nmultiplying the sum by the common ratio, each term becomes the next term.",
    "We\nshift over the sum to get the subtraction to mostly cancel out, leaving just the first\nterm and the new last term.\n",
    "Example 4.4.2\nFind a closed formula for 𝑆(𝑛) = 2 + 10 + 50 + · · · + 2 · 5𝑛.\nSolution.\n",
    "The common ratio is 5.",
    "So we have\n𝑆\n= 2 + 10 + 50 + · · ·",
    "+ 2 · 5𝑛\n−\n5𝑆\n=\n10 + 50 + · · · + 2 · 5𝑛+ 2 · 5𝑛+1\n−4𝑆\n= 2 −2 ·",
    "5𝑛+1\nThus 𝑆= 2 −2 · 5𝑛+1\n−4\n\n356\n4.",
    "Sequences\nEven though this might seem like a new technique, you have probably used it\nbefore.\n",
    "Example 4.4.3\nExpress 0.464646 .",
    ". .",
    "as a fraction.\n",
    "Solution.\n",
    "Let 𝑁= 0.46464646 . .",
    ".. Consider 0.01𝑁.",
    "We get:\n𝑁=\n0.4646464 .",
    ". .\n",
    "−\n0.01𝑁=\n0.00464646 .",
    ". .\n",
    "0.99𝑁=\n0.46\n",
    "So 𝑁= 46\n99.",
    "What have we done?",
    "We viewed the repeating decimal 0.464646 . .",
    ".\n",
    "as a sum of the geometric sequence 0.46, 0.0046, 0.000046, . . .",
    "The common\nratio is 0.01.",
    "The only real difference is that we are now computing an infinite\ngeometric sum, we do not have the extra “last” term to consider.",
    "Really, this is\nthe result of taking a limit as we would in calculus when we compute infinite\ngeometric sums.\n",
    "To summarize, we now can find a closed formula for a sequence 𝑎𝑛that has a rate\nof growth that is an exponential function: 𝑎𝑛−𝑎𝑛−1 = 𝑏𝑛, where 𝑏𝑛is a geometric\nsequence (i.e., an exponential function).",
    "What sort of closed formula do we get here?\n",
    "It’s another exponential function!\n",
    "4.4.3\nThe Characteristic Root Technique\nSuppose we want to solve a recurrence relation expressed as a combination of the\ntwo previous terms, such as 𝑎𝑛= 𝑎𝑛−1 + 6𝑎𝑛−2.",
    "In other words, we want to find a\nfunction of 𝑛which satisfies 𝑎𝑛−𝑎𝑛−1 −6𝑎𝑛−2 = 0.",
    "Think about how we build up\nthis sequence iteratively.\n",
    "𝑎2 = 𝑎1 + 6𝑎0\n𝑎3 = 𝑎2 + 6𝑎1",
    "=",
    "𝑎1 + 6𝑎0 + 6𝑎1\n𝑎4 = 𝑎3 + 6𝑎2 = 𝑎1 + 6𝑎0 + 6𝑎1",
    "+ 62𝑎0 + 62𝑎1\nLet’s stop there and agree this is getting very complicated.",
    "However, we do notice\nthat in each step, we would, among other things, multiply a previous iteration by 6.\n",
    "So our closed formula would include 6 multiplied some number of times.",
    "Thus it is\nreasonable to guess the solution will contain parts that look geometric.",
    "Perhaps the\nsolution will take the form 𝑟𝑛for some constant 𝑟.\n",
    "The nice thing is, we know how to check whether a formula is actually a solution\nto a recurrence relation: plug it in.",
    "What happens if we plug in 𝑟𝑛into the recursion\nabove?",
    "We get\n𝑟𝑛−𝑟𝑛−1 −6𝑟𝑛−2 = 0.\n",
    "Now solve for 𝑟:\n𝑟𝑛−2(𝑟2 −𝑟−6)",
    "= 0,\n\n4.4.",
    "Exponential Sequences\n357\nso by factoring, 𝑟= −2 or 𝑟= 3 (or 𝑟= 0, although this does not help us).",
    "This tells\nus that 𝑎𝑛= (−2)𝑛is a solution to the recurrence relation, as is 𝑎𝑛= 3𝑛. Which one is\ncorrect?",
    "They both are, unless we specify initial conditions.",
    "Notice we could also\nhave 𝑎𝑛= (−2)𝑛+3𝑛. Or 𝑎𝑛= 7(−2)𝑛+4·3𝑛. In fact, for any 𝑎and 𝑏, 𝑎𝑛= 𝑎(−2)𝑛+𝑏3𝑛\nis a solution (try plugging this into the recurrence relation).",
    "To find the values of 𝑎\nand 𝑏, use the initial conditions.\n",
    "This points us in the direction of a more general technique for solving recurrence\nrelations.",
    "Notice we will always be able to factor out the 𝑟𝑛−2 as we did above.",
    "So\nwe really only care about the other part.",
    "We call this other part the characteristic\nequation for the recurrence relation.",
    "We are interested in finding the roots of the\ncharacteristic equation, which are called (surprise) the characteristic roots.\n",
    "Characteristic Roots.\n",
    "Given a recurrence relation 𝑎𝑛+ 𝛼𝑎𝑛−1 + 𝛽𝑎𝑛−2 = 0, the characteristic\npolynomial is\n𝑥2 + 𝛼𝑥+ 𝛽\ngiving the characteristic equation:\n𝑥2 + 𝛼𝑥+ 𝛽= 0.\n",
    "If 𝑟1 and 𝑟2 are two distinct roots of the characteristic polynomial (i.e.,\nsolutions to the characteristic equation), then the solution to the recurrence\nrelation is\n𝑎𝑛= 𝑎𝑟𝑛\n1 + 𝑏𝑟𝑛\n2 ,\nwhere 𝑎and 𝑏are constants determined by the initial conditions.\n",
    "Example 4.4.4\nSolve the recurrence relation 𝑎𝑛= 7𝑎𝑛−1 −10𝑎𝑛−2 with 𝑎0 = 2 and 𝑎1 = 3.\nSolution.\n",
    "Rewrite the recurrence relation 𝑎𝑛−7𝑎𝑛−1 + 10𝑎𝑛−2 = 0.",
    "Now\nform the characteristic equation:\n𝑥2 −7𝑥+ 10 = 0\nand solve for 𝑥:\n(𝑥−2)(𝑥−5) = 0,\nso 𝑥= 2 and 𝑥= 5 are the characteristic roots.",
    "We therefore know that the\nsolution to the recurrence relation will have the form\n𝑎𝑛= 𝑎2𝑛+ 𝑏5𝑛.\nTo find 𝑎and 𝑏, plug in 𝑛= 0",
    "and 𝑛= 1 to get a system of two equations\nwith two unknowns:\n",
    "2 = 𝑎20 + 𝑏50 = 𝑎+ 𝑏\n\n358\n4.",
    "Sequences\n3 = 𝑎21 + 𝑏51 = 2𝑎+ 5𝑏.\nSolving this system gives 𝑎=\n7\n3 and 𝑏= −1\n3, so the solution to the\nrecurrence relation is\n𝑎𝑛= 7\n32𝑛−1\n35𝑛.\nPerhaps the most famous recurrence relation is 𝐹𝑛= 𝐹𝑛−1 + 𝐹𝑛−2, which together\nwith the initial conditions 𝐹0 = 0 and 𝐹1 = 1 defines the Fibonacci sequence.",
    "But\nnotice that this is precisely the type of recurrence relation on which we can use the\ncharacteristic root technique.",
    "When we do, the only thing that changes is that the\ncharacteristic equation does not factor, so we must use the quadratic formula to\nfind the characteristic roots.",
    "In fact, doing so gives the third most famous irrational\nnumber, 𝜑, the golden ratio.\n",
    "Before leaving the characteristic root technique, we should think about what\nmight happen when solving the characteristic equation.",
    "We have an example above\nin which the characteristic polynomial has two distinct roots.",
    "These roots can be\nintegers, or perhaps irrational numbers (requiring the quadratic formula to find\nthem).",
    "In these cases, we know what the solution to the recurrence relation looks\nlike.\n",
    "However, it is possible for the characteristic polynomial to have only one root.\n",
    "This can happen if the characteristic polynomial factors as (𝑥−𝑟)2.",
    "It is still the case\nthat 𝑟𝑛would be a solution to the recurrence relation, but we won’t be able to find\nsolutions for all initial conditions using the general form 𝑎𝑛= 𝑎𝑟𝑛\n1 + 𝑏𝑟𝑛\n2 , since we\ncan’t distinguish between 𝑟𝑛\n1 and 𝑟𝑛\n2 .",
    "We are in luck though:\nCharacteristic Root Technique for Repeated Roots.\n",
    "Suppose the recurrence relation 𝑎𝑛= 𝛼𝑎𝑛−1 + 𝛽𝑎𝑛−2 has a characteristic\npolynomial with only one root 𝑟.",
    "Then the solution to the recurrence relation\nis\n𝑎𝑛= 𝑎𝑟𝑛+ 𝑏𝑛𝑟𝑛\nwhere 𝑎and 𝑏are constants determined by the initial conditions.\n",
    "Notice the extra 𝑛in 𝑏𝑛𝑟𝑛. This allows us to solve for the constants 𝑎and 𝑏from\nthe initial conditions.\n",
    "Example 4.4.5\nSolve the recurrence relation 𝑎𝑛= 6𝑎𝑛−1 −9𝑎𝑛−2 with initial conditions 𝑎0 = 1\nand 𝑎1 = 4.\nSolution.\n",
    "The characteristic polynomial is 𝑥2 −6𝑥+ 9.",
    "We solve the charac-\nteristic equation\n𝑥2 −6𝑥+ 9 = 0\n\n4.4.",
    "Exponential Sequences\n359\nby factoring:\n(𝑥−3)2 = 0,\nso 𝑥= 3 is the only characteristic root.",
    "Therefore we know that the solution\nto the recurrence relation has the form\n𝑎𝑛= 𝑎3𝑛+ 𝑏𝑛3𝑛\nfor some constants 𝑎and 𝑏.",
    "Now use the initial conditions:\n𝑎0 = 1 = 𝑎30 + 𝑏· 0 · 30 = 𝑎\n𝑎1 = 4 = 𝑎· 3 + 𝑏· 1 · 3 = 3𝑎+ 3𝑏.\nSince 𝑎= 1, we find that 𝑏= 1\n3.",
    "Therefore the solution to the recurrence\nrelation is\n𝑎𝑛= 3𝑛+ 1\n3𝑛3𝑛.\nAlthough we will not consider examples more complicated than these, this\ncharacteristic root technique can be applied to much more complicated recurrence\nrelations.",
    "For example, 𝑎𝑛= 2𝑎𝑛−1 + 𝑎𝑛−2 −3𝑎𝑛−3 has characteristic polynomial\n𝑥3 −2𝑥2 −𝑥+3.",
    "Assuming we see how to factor such a degree 3 (or more) polynomial,\nwe can easily find the characteristic roots and as such solve the recurrence relation\n(the solution would look like 𝑎𝑛= 𝑎𝑟𝑛\n1 + 𝑏𝑟𝑛\n2 + 𝑐𝑟𝑛\n3 if there were 3 distinct roots).",
    "It is\nalso possible that the characteristic roots are complex numbers.\n",
    "However, the characteristic root technique is only useful for solving recurrence\nrelations in a particular form: 𝑎𝑛is given as a linear combination of some number\nof previous terms.",
    "These recurrence relations are called linear homogeneous\nrecurrence relations with constant coefficients.",
    "The “homogeneous” refers to the\nfact that there is no additional term in the recurrence relation other than a multiple\nof 𝑎𝑗terms.",
    "For example, 𝑎𝑛= 2𝑎𝑛−1 + 1 is non-homogeneous because of the additional\nconstant 1.",
    "There are general methods of solving such things, but we will not\nconsider them here, other than through the use of telescoping or iteration described\nabove.\n",
    "4.4.4\nReading Questions\n1.\nWhich of the following recurrence relations would be good candidates to try\nthe characteristic root technique on?",
    "Select all that apply\nA. 𝑎𝑛= 3𝑎𝑛−1 + 𝑎𝑛−2\nB. 𝑎𝑛= 𝑎𝑛−1 + 2𝑎𝑛−2 + 3𝑎𝑛−3\nC. 𝑎𝑛= 1\n3 · 2𝑛+ 2\n3(−1)𝑛\nD. 𝑎𝑛= 𝑎𝑛−1 + 3𝑎𝑛−2 + 5\n\n360\n4.",
    "Sequences\nE. 𝑥2 −3𝑥−1 = 0\n2.\n",
    "At what step do you need to refer to the initial conditions when completing\nthe characteristic root technique?",
    "What would happen if you didn’t use these?\nExplain.\n",
    "3.\n",
    "What questions do you have?",
    "Write at least one question about the content of\nthis section that you or a classmate might be curious about.\n",
    "4.4.5\nPractice Problems\n1.\nFind 6 + 30 + 150 + · · · + 6 · 519.\n",
    "2.\nFind 1 −7\n4 + 49\n16 −· · · + (−1)37 737\n437 .\n",
    "3.\nSolve the recurrence relation 𝑎𝑛= 𝑎𝑛−1 + 2𝑛with 𝑎0 = −2.\n",
    "𝑎𝑛=\n4.\nFind the solution to the recurrence relation 𝑎𝑛= 2𝑎𝑛−1 + 24𝑎𝑛−2 with initial\nterms 𝑎0 = 2 and 𝑎1 = 2.\n𝑎𝑛=\n5.\nFind the solution to the recurrence relation 𝑎𝑛= 𝑎𝑛−1 + 2𝑎𝑛−2 with initial terms\n𝑎0 = 2 and 𝑎1 = 1.\n𝑎𝑛=\nFind the solution to the recurrence relation 𝑏𝑛= 𝑏𝑛−1 + 2𝑏𝑛−2 with initial\nterms 𝑏0 = 9 and 𝑏1 = 14.\n",
    "𝑏𝑛=\n6.\nFind the solution to the recurrence relation 𝑎𝑛= 𝑎𝑛−1 + 2𝑎𝑛−2 with initial terms\n𝑎0 = 4 and 𝑎1 = 17.\n𝑎𝑛=\n4.4.6\nAdditional Exercises\n1.\nFind the next two terms in (𝑎𝑛)𝑛≥0 beginning 3, 5, 11, 21, 43, 85 . . ..",
    "Then give\na recursive definition for the sequence.",
    "Finally, use the characteristic root\ntechnique to find a closed formula for the sequence.\n",
    "2.\nConsider the sequences 2, 5, 12, 29, 70, 169, 408, . . .",
    "(with 𝑎0 = 2).\n",
    "(a) Describe the rate of growth of this sequence.\n",
    "(b) Find a recursive definition for the sequence.\n",
    "(c) Find a closed formula for the sequence.\n",
    "(d) If you look at the sequence of differences between terms, and then the\nsequence of second differences, the sequence of third differences, and so\non, will you ever get a constant sequence?",
    "Explain how you know.\n",
    "3.\nShow that 4𝑛is a solution to the recurrence relation 𝑎𝑛= 3𝑎𝑛−1 + 4𝑎𝑛−2.\n\n4.4.",
    "Exponential Sequences\n361\n4.\nSuppose that 𝑟𝑛and 𝑞𝑛are both solutions to a recurrence relation of the form\n𝑎𝑛= 𝛼𝑎𝑛−1 + 𝛽𝑎𝑛−2.",
    "Prove that 𝑐· 𝑟𝑛+ 𝑑· 𝑞𝑛is also a solution to the recurrence\nrelation, for any constants 𝑐, 𝑑.\n5.\nThink back to the magical candy machine at your neighborhood grocery store.\n",
    "Suppose that the first time a quarter is put into the machine 1",
    "Skittle comes\nout.",
    "The second time, 4 Skittles, the third time 16 Skittles, the fourth time 64\nSkittles, etc.\n(a) Find both a recursive and closed formula for how many Skittles the nth\ncustomer gets.\n",
    "(b) Check your solution for the closed formula by solving the recurrence\nrelation using the characteristic root technique.\n",
    "6.\nLet 𝑎𝑛be the number of 1 × 𝑛tile designs you can make using 1 × 1 squares\navailable in 4 colors and 1 × 2 dominoes available in 5 colors.\n",
    "(a) First, find a recurrence relation to describe the problem.",
    "Explain why the\nrecurrence relation is correct (in the context of the problem).\n",
    "(b) Write out the first 6 terms of the sequence 𝑎1, 𝑎2, . .",
    "..\n",
    "(c) Solve the recurrence relation.",
    "That is, find a closed formula for 𝑎𝑛.\n7.\n",
    "You have access to 1 × 1 tiles which come in 2 different colors and 1 × 2 tiles\nwhich come in 3 different colors.",
    "We want to figure out how many different\n1 × 𝑛path designs we can make out of these tiles.\n",
    "(a) Find a recursive definition for the sequence 𝑎𝑛of paths of length 𝑛.\n(b) Solve the recurrence relation using the characteristic root technique.\n",
    "8.\nSolve the recurrence relation 𝑎𝑛= 2𝑎𝑛−1 −𝑎𝑛−2.\n",
    "(a) What is the solution if the initial terms are 𝑎0 = 1 and 𝑎1 = 2?\n(b) What do the initial terms need to be in order for 𝑎9 = 30?\n(c) For which 𝑥are there initial terms which make 𝑎9 = 𝑥?\n9.\nConsider the recurrence relation 𝑎𝑛= 4𝑎𝑛−1 −4𝑎𝑛−2.\n(a) Find the general solution to the recurrence relation (beware the repeated\nroot).\n",
    "(b) Find the solution when 𝑎0 = 1 and 𝑎1 = 2.\n(c) Find the solution when 𝑎0 = 1 and 𝑎1 = 8.\n10.\n",
    "Here is a surprising use of sequences to answer a counting question: How\nmany license plates consist of 6 symbols, using only the three numerals 1, 2,\nand 3 and the four letters a, b, c, and d, so that no numeral appears after any\n\n362\n4.",
    "Sequences\nletter?",
    "For example, “31ddac”, “123321”, and “ababab” are each acceptable\nlicense plates, but “13ba2c” is not.\n(a) First answer this question by considering different cases: how many of\nthe license plates contain no numerals?",
    "How many contain one numeral,\netc.\n(b) Now use the techniques of this section to show why the answer is 47 −37.\n\n",
    "4.5\nProof by Induction\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Identify the parts of a proof by mathematical induction and how they\nrelate to the statement being proved.\n",
    "2. Prove statements using mathematical induction.\n",
    "3. Explain why a proof by mathematical induction is valid.\n",
    "4.5.1\nSection Preview\nInvestigate!\n",
    "What is the unit digit (the right-most digit) of 6𝑛?",
    "Does the answer depend\non 𝑛?\nMathematical induction is a powerful proof technique that can be used to prove\nstatements are true for a sequence of statements, as long as that sequence of statements\nhas some starting place.",
    "For example, if we are trying to say something about the\nunit digit of 6𝑛, we are making that claim for 𝑛= 1, then 𝑛= 2, then 𝑛= 3, and so\non.\n",
    "Induction is closely related to recursive definitions; the main idea in a proof by\ninduction is to explain how you can get from one statement in the sequence to the\nnext.\n",
    "Preview Activity\n1.\nSuppose that 6472 had a 2 for its unit digit.\n",
    "That is, suppose 6472 =\n19, 381, 6 . . . . .",
    ".",
    "2.",
    "What would the unit digit of 6473 be?\nHint.\n",
    "6473 = 6 · 6472.\n",
    "2.\n",
    "What is the unit digit of 62, of 63, and of 64?\n3.\nWhich of the following are true?",
    "Select all that apply.\n",
    "A.",
    "If the unit’s digit of 6𝑘is a 6, then the unit’s digit of 6𝑘+1 is a 6.\nB.",
    "If the unit’s digit of 6𝑘is a 2, then the unit’s digit of 6𝑘+1 is a 2.\nC. The unit’s digit of 6472 is a 2.\n",
    "D. The unit’s digit of 6472 is a 6.\n363\n\n364\n4.",
    "Sequences\n4.\nExplain your answer to the previous question.\n",
    "4.5.2\nRecursive Reasoning\nWe have seen that describing a sequence recursively can often be easier than\ndescribing the sequence with a closed formula.",
    "We will now see how using similar\nrecursive reasoning can help us prove statements using a proof technique called\nmathematical induction.",
    "This style of proof is especially useful when the different\ninstances of the statement (for different values of 𝑛, say) are related recursively.\n",
    "For example, suppose we wanted to prove a fact about all the terms in a sequence\nfor which we have a recursive definition.",
    "Consider the sequence (𝑎𝑛)𝑛≥0 defined\nrecursively by 𝑎𝑛= 3𝑎𝑛−1 −2 with 𝑎0 = 5.",
    "Could we prove that every term in this\nsequence is odd?\nLet’s start by writing out the first few terms of the sequence:\n5, 13, 37, 109, . . . .\n",
    "So far, all these numbers look odd.",
    "Will the next number be odd?",
    "Of course, we\ncould just compute it using the recurrence relation.",
    "We would take 3 · 109 −2.",
    "We\ndon’t actually care which odd number this is, just that it is, in fact, odd.",
    "We know it\nwill be odd because the product of two odd numbers is odd, and subtracting 2 from\nan odd number results in an odd number.\n",
    "Great, so 𝑎4 is odd.",
    "Will 𝑎5 be odd too?",
    "Yes, use the same argument as above:\n𝑎5 = 3𝑎4 −2.",
    "We just convinced ourselves that 𝑎4 is odd (without finding its actual\nvalue), so 3𝑎4 is odd, and 2 less than it will be odd too.\n",
    "What about 𝑎6?",
    "Do the same thing.",
    "In fact, why are we using any particular\nnumber as the index?",
    "If it is the same argument each time, we should be able to just\ngive this argument once and say it always works.\n",
    "Suppose we have found that 𝑎𝑘is odd (where 𝑘is some arbitrary natural number).\n",
    "From this, we can find that 𝑎𝑘+1 is odd, since 𝑎𝑘+1 = 3𝑎𝑘−2, and 3 times the odd\nnumber 𝑎𝑘will be odd, and subtracting 2 will result in an odd number.",
    "Yay.",
    "Let’s\nput this all together as a proof.\n",
    "Proof.",
    "We claim that for any 𝑛≥0, the number 𝑎𝑛is odd, where 𝑎𝑛= 3𝑎𝑛−1 −2\nand 𝑎0 = 5.\n",
    "When 𝑛= 0, the claim is true, since 𝑎0 = 5 is an odd number.\n",
    "Further, we can prove that every larger 𝑛has 𝑎𝑛odd because as long as 𝑎𝑘is\nodd, so is 𝑎𝑘+1 (since 𝑎𝑘+1 = 3𝑎𝑘−2, and 3 times an odd number minus 2 is always\nodd).\n",
    "Therefore 𝑎𝑛is odd for all 𝑛≥0.\n",
    "Soon we will give a more rigid structure for proofs by induction, but the basic\nidea is exactly what we have above.\n",
    "4.5.3\nFormalizing Proofs\nInduction can prove many statements that hold for all natural numbers, not just\nstatements about sequences.",
    "In particular, induction should be used when there is\n\n4.5.",
    "Proof by Induction\n365\nsome way to go from one case to the next – when you can see how to always “do\none more.”\nThinking about how we write statements in logical symbols, we will use induction\nto prove statements of the form\n∀𝑛𝑃(𝑛),\nwhere the domain of discourse (the values of 𝑛we quantify over) has some least\nelement.",
    "Say that domain of discourse is the natural numbers.",
    "We are then proving\nthis sequence of statements:\n𝑃(0), 𝑃(1), 𝑃(2), 𝑃(3), . . . .\n",
    "The way we do this with induction is to prove a base case, that 𝑃(0) is true (or\n𝑃(𝑎) where 𝑎is the least element of our domain of discourse).",
    "Next, we prove the\ninductive case, that 𝑃(𝑘) →𝑃(𝑘+ 1) for all 𝑘≥0 (or 𝑘≥𝑎).\n",
    "Together, these are enough to prove 𝑃(𝑛) is true for all 𝑛. How do we know?\n",
    "That is, why is this style of proof valid?",
    "Well, let’s convince ourselves that 𝑃(3) is\ntrue.",
    "We know 𝑃(0) is true.",
    "And because we know that 𝑃(0) →𝑃(1), we then also\nknow that 𝑃(1) is true.",
    "Because 𝑃(1) →𝑃(2), we then get that 𝑃(2) is true.",
    "Finally,\nbecause 𝑃(2) →𝑃(3), we have that 𝑃(3).",
    "There is nothing special about 3 here.",
    "We\ncould have gone up as far as we like, to any 𝑛value!\n",
    "Think of a row of dominoes set up standing on their edges.",
    "We want to argue\nthat in a minute, all the dominoes will have fallen.",
    "For this to happen, you will\nneed to push the first domino.",
    "That is the base case.",
    "It will also have to be that the\ndominoes are close enough together that when any particular domino falls, it will\ncause the next domino to fall.",
    "That is the inductive case.",
    "If both of these conditions\nare met – you push the first domino over, and each domino will cause the next to\nfall – then all the dominoes will fall.\n",
    "Induction is powerful!",
    "Think how much easier it is to knock over dominoes\nwhen you don’t have to push over each domino yourself.",
    "You just start the chain\nreaction and then rely on the relative nearness of the dominoes to take care of the\nrest.\n",
    "When writing a proof by induction, we will follow a standard style.",
    "Writing in\nthis style allows us to keep our ideas organized and might even help us formulate\nthe proof.\n",
    "Here is the general structure of a proof by mathematical induction:\nInduction Proof Structure.\n",
    "Start by saying what the statement is that you want to prove: “Let 𝑃(𝑛) be\nthe statement. . . .”",
    "To prove that 𝑃(𝑛) is true for all 𝑛≥0, you must prove\ntwo facts:\n1.",
    "Base case: Prove that 𝑃(0) is true.",
    "You do this directly.",
    "This is often\neasy.\n",
    "2.",
    "Inductive case: Prove that 𝑃(𝑘) →𝑃(𝑘+ 1) for all 𝑘≥0.",
    "That is, prove\nthat for any 𝑘≥0 if 𝑃(𝑘) is true, then 𝑃(𝑘+ 1) is true as well.",
    "This is\n\n366\n4.",
    "Sequences\nthe proof of an if . .",
    ".",
    "then . . .",
    "statement, so you can assume 𝑃(𝑘) is\ntrue (𝑃(𝑘) is called the inductive hypothesis).",
    "You must then explain why\n𝑃(𝑘+ 1) is also true, given that assumption.\n",
    "Assuming you are successful on both parts above, you can conclude,\n“Therefore by the principle of mathematical induction, the statement 𝑃(𝑛) is\ntrue for all 𝑛≥0.”\n",
    "Sometimes the statement 𝑃(𝑛) will only be true for values of 𝑛≥4, for example,\nor some other value.",
    "In such cases, replace all the 0’s above with 4’s (or the other\nvalue).\n",
    "Before attempting to prove a statement by mathematical induction, first think\nabout why the statement is true using inductive reasoning.",
    "Explain why induction is\nthe right thing to do, and roughly why the inductive case will work.",
    "Then, sit down\nand write out a careful, formal proof using the structure above.\n",
    "4.5.4\nExamples\nHere are some examples of proof by mathematical induction.\n",
    "Example 4.5.1\nProve for each natural number 𝑛≥1 that 1 + 2 + 3 + · · · + 𝑛= 𝑛(𝑛+1)\n2\n.\nSolution.\n",
    "First, let’s think inductively about this equation.",
    "In fact, we know\nthis is true for other reasons (reverse and add comes to mind).",
    "But why might\ninduction be applicable?",
    "The left-hand side adds up the numbers from 1\nto 𝑛. If we know how to do that, adding just one more term (𝑛+ 1) would\nnot be that hard.",
    "For example, if 𝑛= 100, suppose we know that the sum of\nthe first 100 numbers is 5050 (so 1 + 2 + 3 + · · ·",
    "+ 100 = 5050, which is true).\n",
    "Now to find the sum of the first 101 numbers, it makes more sense to just\nadd 101 to 5050, instead of computing the entire sum again.",
    "We would have\n1 + 2 + 3 + · · ·",
    "+ 100 + 101 = 5050 + 101 = 5151.",
    "In fact, it would always be\neasy to add just one more term.",
    "This is why we should use induction.\n",
    "Now the formal proof:\nProof.\n",
    "Let 𝑃(𝑛) be the statement 1 + 2 + 3 + · · · + 𝑛= 𝑛(𝑛+1)\n2\n.",
    "We will show\nthat 𝑃(𝑛) is true for all natural numbers 𝑛≥1.\n",
    "Base case: 𝑃(1) is the statement 1 = 1(1+1)\n2\nwhich is clearly true.\n",
    "Inductive case: Let 𝑘≥1 be a natural number.",
    "Assume (for induction) that\n𝑃(𝑘) is true.",
    "That means 1 + 2 + 3 + · · · + 𝑘= 𝑘(𝑘+1)\n2\n.",
    "We will prove that 𝑃(𝑘+ 1)\nis true as well.",
    "That is, we must prove that 1+2+3+· · ·+ 𝑘+(𝑘+1) = (𝑘+1)(𝑘+2)\n2\n.\n",
    "To prove this equation, start by adding 𝑘+ 1 to both sides of the inductive\n\n4.5.",
    "Proof by Induction\n367\nhypothesis:\n1 + 2 + 3 + · · · + 𝑘+ (𝑘+ 1) = 𝑘(𝑘+ 1)\n2\n+ (𝑘+ 1).\n",
    "Now, simplifying the right side we get:\n𝑘(𝑘+ 1)\n2\n+ 𝑘+ 1 = 𝑘(𝑘+ 1)\n2\n+ 2(𝑘+ 1)\n2\n= 𝑘(𝑘+ 1) + 2(𝑘+ 1)\n2\n= (𝑘+ 2)(𝑘+ 1)\n2\n.\n",
    "Thus 𝑃(𝑘+ 1) is true, so by the principle of mathematical induction, 𝑃(𝑛)\nis true for all natural numbers 𝑛≥1.\n",
    "■\nNote that in the part of the proof where we proved 𝑃(𝑘+1) from 𝑃(𝑘), we used the\nequation 𝑃(𝑘).",
    "This was the inductive hypothesis.",
    "Seeing how to use the inductive\nhypotheses is usually straightforward when proving a fact about a sum like this.",
    "In\nother proofs, it can be less obvious where it fits in.\n",
    "Example 4.5.2\nProve that for all 𝑛∈ℕ, 6𝑛−1 is a multiple of 5.\nSolution.\n",
    "Again, start by understanding the dynamics of the problem.",
    "What\ndoes increasing 𝑛do?",
    "Let’s try with a few examples.",
    "If 𝑛= 1, then yes,\n61 −1 = 5 is a multiple of 5.",
    "What does incrementing 𝑛to 2 look like?",
    "We\nget 62 −1 = 35, which again is a multiple of 5.",
    "Next, 𝑛= 3: But instead of\njust finding 63 −1, what did the increase in 𝑛do?",
    "We will still subtract 1,\nbut now we are multiplying by another 6 first.",
    "Viewed another way, we are\nmultiplying a number that is one more than a multiple of 5 by 6 (because\n62 −1 is a multiple of 5, so 62 is one more than a multiple of 5).",
    "What do\nnumbers that are one more than a multiple of 5 look like?",
    "They must have\nlast digit 1 or 6.",
    "What happens when you multiply such a number by 6?",
    "It\ndepends on the number, but in any case, the last digit of the new number\nmust be a 6.",
    "And then if you subtract 1, you get last digit 5, so a multiple of 5.\n",
    "The point is, every time we multiply by just one more six, we still get a\nnumber with last digit 6, so subtracting 1 gives us a multiple of 5.",
    "Now the\nformal proof:\nProof.\n",
    "Let 𝑃(𝑛) be the statement, “6𝑛−1 is a multiple of 5.”",
    "We will prove\nthat 𝑃(𝑛) is true for all 𝑛∈ℕ.\nBase case: 𝑃(0) is true: 60 −1 = 0, which is a multiple of 5.\nInductive case: Let 𝑘be an arbitrary natural number.\n",
    "Assume, for\n\n368\n4.",
    "Sequences\ninduction, that 𝑃(𝑘) is true.",
    "That is, 6𝑘−1 is a multiple of 5.",
    "Then 6𝑘−1 = 5𝑗\nfor some integer 𝑗.",
    "This means that 6𝑘= 5𝑗+ 1.",
    "Multiply both sides by 6:\n6𝑘+1 = 6(5𝑗+ 1) = 30𝑗+ 6.\n",
    "But we want to know about 6𝑘+1 −1, so subtract 1 from both sides:\n6𝑘+1 −1 = 30𝑗+ 5.\n",
    "Of course 30𝑗+ 5 = 5(6𝑗+ 1), so is a multiple of 5.\n",
    "Therefore 6𝑘+1 −1 is a multiple of 5, or in other words, 𝑃(𝑘+ 1) is true.\n",
    "Thus, by the principle of mathematical induction 𝑃(𝑛) is true for all 𝑛∈ℕ. ■\nWe had to be a little bit clever (i.e., use some algebra) to locate the 6𝑘−1 inside\nof 6𝑘+1 −1 before we could apply the inductive hypothesis.",
    "This is what can make\ninductive proofs challenging.\n",
    "In the two examples above, we started with 𝑛= 1 or 𝑛= 0.",
    "We can start later if\nwe need to.\n",
    "Example 4.5.3\nProve that 𝑛2 <",
    "2𝑛for all integers 𝑛≥5.\n",
    "Solution.\n",
    "First, the idea of the argument.",
    "What happens when we increase\n𝑛by 1?",
    "On the left-hand side, we increase the base of the square and go to\nthe next square number.",
    "On the right-hand side, we increase the power of 2.\n",
    "This means we double the number.",
    "So the question is, how does doubling\na number relate to increasing to the next square?",
    "Think about what the\ndifference of two consecutive squares looks like.",
    "We have (𝑛+ 1)2 −𝑛2.",
    "This\nfactors:\n(𝑛+ 1)2 −𝑛2 = (𝑛+ 1 −𝑛)(𝑛+ 1 + 𝑛) = 2𝑛+ 1.\nBut doubling the right-hand side increases it by 2𝑛, since 2𝑛+1 = 2𝑛+ 2𝑛.\n",
    "When 𝑛is large enough, 2𝑛>",
    "2𝑛+ 1.\n",
    "What we are saying here is that each time 𝑛increases, the left-hand side\ngrows by less than the right-hand side.",
    "So if the left-hand side starts smaller\n(as it does when 𝑛= 5), it will never catch up.",
    "Now the formal proof:\nProof.\n",
    "Let 𝑃(𝑛) be the statement 𝑛2 <",
    "2𝑛. We will prove 𝑃(𝑛) is true for all\nintegers 𝑛≥5.\n",
    "Base case: 𝑃(5) is the statement 52 < 25.",
    "Since 52 = 25 and 25 = 32, we see\nthat 𝑃(5) is indeed true.\n",
    "Inductive case: Let 𝑘≥5 be an arbitrary integer.",
    "Assume, for induction,\nthat 𝑃(𝑘) is true.",
    "That is, assume 𝑘2 <",
    "2𝑘.",
    "We will prove that 𝑃(𝑘+ 1) is true,\ni.e., (𝑘+ 1)2 < 2𝑘+1.",
    "To prove such an inequality, start with the left-hand side\n\n4.5.",
    "Proof by Induction\n369\nand work towards the right-hand side:\n(𝑘+ 1)2 = 𝑘2 + 2𝑘+ 1\n< 2𝑘+ 2𝑘+ 1\n. . .",
    "by the inductive hypothesis.\n< 2𝑘+ 2𝑘\n. . .",
    "since 2𝑘+ 1 < 2𝑘for 𝑘≥5.\n",
    "= 2𝑘+1.\n",
    "Following the equalities and inequalities through, we get (𝑘+ 1)2 < 2𝑘+1,\nin other words, 𝑃(𝑘+1).",
    "Therefore by the principle of mathematical induction,\n𝑃(𝑛) is true for all 𝑛≥5.\n",
    "■\nThe previous example might remind you of the racetrack principle from calculus,\nwhich says that if 𝑓(𝑎) < 𝑔(𝑎), and 𝑓′(𝑥) < 𝑔′(𝑥) for 𝑥> 𝑎, then 𝑓(𝑥) < 𝑔(𝑥) for\n𝑥> 𝑎. Same idea: the larger function is increasing more than the smaller function,\nso the larger function will stay larger.",
    "In discrete math, we don’t have derivatives, so\nwe look at differences.",
    "Thus induction is the way to go.\n",
    "A Warning.\n",
    "With great power, comes great responsibility.",
    "Induction isn’t magic.\n",
    "It seems very powerful to be able to assume 𝑃(𝑘) is true.",
    "After all, we are trying\nto prove 𝑃(𝑛) is true, and the only difference is in the variable: 𝑘vs.",
    "𝑛. Are we\nassuming that what we want to prove is true?",
    "Not really.",
    "We assume 𝑃(𝑘) is true\nonly for the sake of proving that 𝑃(𝑘+ 1) is true.\n",
    "Still you might start to believe that you can prove anything with induction.\n",
    "Consider this incorrect “proof” that every Canadian has the same eye color: Let\n𝑃(𝑛) be the statement that any 𝑛Canadians have the same eye color.",
    "𝑃(1) is true,\nsince everyone has the same eye color as themselves.",
    "Now assume 𝑃(𝑘) is true.",
    "That\nis, assume that in any group of 𝑘Canadians, everyone has the same eye color.",
    "Now\nconsider an arbitrary group of 𝑘+ 1 Canadians.",
    "The first 𝑘of these must all have the\nsame eye color, since 𝑃(𝑘) is true.",
    "Also, the last 𝑘of these must have the same eye\ncolor, since 𝑃(𝑘) is true.",
    "So in fact, everyone in the group must have the same eye\ncolor.",
    "Thus 𝑃(𝑘+ 1) is true.",
    "So by the principle of mathematical induction, 𝑃(𝑛) is\ntrue for all 𝑛.\nClearly something went wrong.",
    "The problem is that the proof that 𝑃(𝑘) implies\n𝑃(𝑘+ 1) assumes that 𝑘≥2.",
    "We have only shown 𝑃(1) is true.",
    "In fact, 𝑃(2) is false.\n",
    "Try this: read through the previous paragraph again, substituting 1 for each 𝑘. Can\nyou spot the error in that argument?\n4.5.5\nReading Questions\n1.\n",
    "Suppose you wanted to prove, using mathematical induction, that 1 + 3 + 5 +\n· · · + 2𝑛−1 = 𝑛2 for all values of 𝑛≥1.",
    "Which of the following would be an\nappropriate first line of the proof?",
    "Select all that apply.\n",
    "A. Let 𝑃(𝑛) be the statement “1 + 3 + 5 + · · · + 2𝑛−1 = 𝑛2.”\n\n370\n4.",
    "Sequences\nB.",
    "For each 𝑛≥1, let 𝑃(𝑛) be the statement, “the sum of the first 𝑛odd\nnumbers is 𝑛2.”\nC. Assume 1 + 3 + · · · + 2𝑛−1 = 𝑛2 for all 𝑛≥1.\n",
    "D. Let 𝑃(𝑛) be the statement, “1 + 3 + · · · + 2𝑛−1 = 𝑛2 for all 𝑛≥1.”\nE. Since 𝑃(1) = 1 = 12, the base case is true.\n",
    "2.\nSuppose you wanted to prove that 𝑃(𝑛, 3) ≥\u0000𝑛\n3\n\u0001 for all 𝑛≥4.",
    "Write the first\nline of a proof by induction.\n",
    "3.\n",
    "What questions do you have?",
    "Write at least one question about the content of\nthis section that you or a classmate might be curious about after reading this\nsection.\n",
    "4.5.6\nPractice Problems\n1.\nSuppose you are trying to prove, by mathematical induction, that a statement\n𝑃(𝑛) is true for all 𝑛≥0.",
    "What would you attempt to prove in the induction\nstep of the proof?",
    "(Select all that apply.)\n",
    "A. That assuming 𝑃(𝑘) is true for an arbitrary 𝑘≥0, we can prove that\n𝑃(𝑘+ 1) is true.\n",
    "B. That 𝑃(𝑘) implies 𝑃(𝑘+ 1) for all 𝑘≥0.\n",
    "C. That assuming 𝑃(𝑘+ 1) is true for an arbitrary 𝑘≥0, we can prove that\n𝑃(𝑘) is true.\n",
    "D. That 𝑃(𝑘+ 1) implies 𝑃(𝑘) for all 𝑘≥0.\n",
    "E. That 𝑃(𝑘) implies 𝑃(𝑘+ 1) for at least one 𝑘≥0.\n",
    "2.\nSuppose you wanted to prove the following statement:\n2 + 4 + 6 + · · ·",
    "+ 2𝑛= 𝑛(𝑛+ 1) for all 𝑛≥1.\n",
    "What would the first line of a proof by induction be?\nA. Let 𝑃(𝑛) be the statement “2 + 4 + 6 + · · ·",
    "+ 2𝑛= 𝑛(𝑛+ 1).”\n",
    "B. Let 𝑃(𝑛) be the statement “2 + 4 + 6 + · · · + 2𝑛= 𝑛(𝑛−1) for all 𝑛≥1.”\nC. Assume 𝑃(𝑛) is true for all 𝑛≥1.\n",
    "D. Let 𝑃(𝑛) = 2 + 4 + 6",
    "+ · · · + 2𝑛.\nE. Suppose 𝑃(𝑛) = 𝑛(𝑛+ 1) for all 𝑛≥1.\n",
    "3.\nSuppose you were proving the following statement by mathematical induction:\n2 + 4 + 6 + · · ·",
    "+ 2𝑛= 𝑛(𝑛+ 1) for all 𝑛≥1.\n\n",
    "4.5.",
    "Proof by Induction\n371\n",
    "What would you need to show to establish the base case?\nA. Show that 𝑃(1) is true.",
    "That is, show that 2 = 1(1 + 1).\n",
    "B. Show that 𝑃(2) is true.",
    "That is, show that 2 + 4 = 2(2 + 1).\n",
    "C. Show that 𝑃(1) and 𝑃(2) are both true.\n",
    "D. Show that 𝑃(1) implies 𝑃(2).\n",
    "E. Nothing, since the sum already has more than 𝑛= 1 terms.\n",
    "4.\nSuppose you were proving the following statement by mathematical induction:\n2 + 4 + 6 + · · ·",
    "+ 2𝑛= 𝑛(𝑛+ 1) for all 𝑛≥1.\n",
    "What would the first line of the inductive case be?\nA. Assume 𝑃(𝑘) is true for some arbitrary 𝑘≥1, that is, assume 2 + 4 + 6 +\n· · · + 2𝑘= 𝑘(𝑘+ 1).\n",
    "B. Assume 𝑃(𝑘) is true for all 𝑘≥1, that is, assume 2",
    "+4+6+· · ·+2𝑘= 𝑘(𝑘+1).\n",
    "C. Assume 𝑃(𝑘) implies 𝑃(𝑘+ 1) for an arbitrary 𝑘≥1.\n",
    "D. Assume 𝑃(𝑘) is true for some large 𝑘≥1; say, assume 2+4+6+· · ·+432 =\n216(217).\n",
    "5.\nArrange some of the statements below to create a correct proof by induction\nthat the recurrence relation 𝑎𝑛= 5𝑎𝑛−1 + 4, with initial condition 𝑎0 = 0 has\nclosed formula 𝑎𝑛= 5𝑛−1.\n•",
    "This simplifies to 𝑎𝑘+1 = 5𝑘+1 −5",
    "+ 4 = 5𝑘+1 −1, so 𝑃(𝑘+ 1) is true.\n",
    "•",
    "Therefore, by the principle of mathematical induction, 𝑃(𝑛) is true for all\n𝑛≥0.\n",
    "• Now assume that 𝑃(𝑘+ 1) is true for an arbitrary integer 𝑘≥0.\n",
    "• Then 𝑎𝑘+1 = 5𝑎𝑘+ 4, so 𝑃(𝑘+ 1) is true.\n",
    "• Then 𝑎𝑘= 5𝑘−1.\n",
    "• Let 𝑃(𝑛) be the statement, “𝑎𝑛= 5𝑛−1”.\n",
    "•",
    "By the recurrence relation, we have 𝑎𝑘+1",
    "= 5𝑎𝑘+ 4 = 5(5𝑘−1)",
    "+",
    "4.\n• Note that 𝑎0 = 50 −1 = 0, so 𝑃(0) is true.\n",
    "• Now assume that 𝑃(𝑘) is true for an arbitrary integer 𝑘≥0.\n\n372\n4.",
    "Sequences\n6.\nArrange some of the statements below to create a correct proof by induction\nthat for all 𝑛≥1, the number 14𝑛−1 is a multiple of 13.\n•",
    "Then 14𝑘−1 = 13 · 𝑗for some integer 𝑗.\n•",
    "Therefore, by the principle of mathematical induction, 𝑃(𝑛) is true for all\n𝑛≥1.\n",
    "• Note that 142 −1 = (14 −1)(14 + 1) by difference of squares, so this is a\nmultiple of 13.\n",
    "• Now assume that 𝑃(𝑛) is true for all 𝑛≥1.\n",
    "• Thus 14𝑘= 14𝑘+1−1\n14\n, which must also be a multiple of 13.\n",
    "• Since 14𝑘+1 −1 = 14(14𝑘−1)",
    "+ 14 −1 = 14(13 · 𝑗)",
    "+ 13, we see that 14𝑘+1 −1\nis a multiple of 13.\n",
    "• Let 𝑃(𝑛) be the statement, “14𝑛−1 is a multiple of 13.”\n",
    "• Thus 𝑃(𝑘+ 1) is true.\n",
    "• Note that 141 −1 = 13, so this is definitely a multiple of 13.\n",
    "• Now assume that 𝑃(𝑘) is true for an arbitrary integers 𝑘≥1.\n",
    "7.\nArrange some of the statements below to create a correct proof by induction\nthat for all 𝑛≥1, 1 + 1 + 2 + 3 + 5 + · · · + 𝐹𝑛= 𝐹𝑛+2 −1, where 𝐹𝑛is the 𝑛th\nFibonacci number.\n•",
    "By the definition of Fibonacci numbers, 𝐹𝑘+1 + 𝐹𝑘+2 = 𝐹𝑘+3, so the right-\nhand side simplifies to 𝐹𝑘+3 −1.\n",
    "•",
    "Then by the inductive hypothesis, 1 + 1 + 2 + 3 + · · · + 𝐹𝑘+1 = 𝐹𝑘+2 −1.\n",
    "• That is, assume 1 + 1 + 2 + 3 + 5 + 𝐹𝑘= 𝐹𝑘+2 −1.\n",
    "•",
    "For the base case, note that 1 + 1 + 2 = 4 = 𝐹5 −1.\n",
    "• Let 𝑃(𝑛) be the statement, “1 + 1 + 2 + 3 + 5 + · · · + 𝐹𝑛= 𝐹𝑛+2 −1.”\n",
    "• Thus 𝑃(𝑘+ 1) is true, and therefore by the principle of mathematical\ninduction, 𝑃(𝑛) is true for all 𝑛≥1.\n",
    "• Then adding 𝐹𝑘+1 to both sides, we get 1 + 1 + 2 + 3 + 5 + · · ·",
    "+ 𝐹𝑘+ 𝐹𝑘+1 =\n𝐹𝑘+1 + 𝐹𝑘+2 −1.\n",
    "•",
    "For the base case, note that 𝑃(1) and 𝑃(2) are true, because 1 = 2 −1 and\n1 + 1 = 3 −1.\n",
    "• Now assume that 𝑃(𝑘) is true for an arbitrary integer 𝑘≥2.\n",
    "• Subtracting 𝐹𝑘+1 from both sides gives us 𝑃(𝑘), which we also assumed\nto be true.\n\n4.5.",
    "Proof by Induction\n373\n4.5.7\nAdditional Exercises\n1.\n",
    "On the way to the market, you exchange your cow for some magic dark\nchocolate espresso beans.",
    "These beans have the property that every night at\nmidnight, each bean splits into two, effectively doubling your collection.",
    "You\ndecide to take advantage of this, and each morning (around 8 am) you eat 5\nbeans.\n",
    "(a) Explain why it is true that if at noon on day 𝑛you have a number of beans\nending in a 5, then at noon on day 𝑛+ 1 you will still have a number of\nbeans ending in a 5.\n(b) Why is the previous fact not enough to conclude that you will always\nhave a number of beans ending in a 5?",
    "What additional fact would you\nneed?\n(c)",
    "Assuming you have the additional fact in part (b), and have successfully\nproved the fact in part (a), how do you know that you will always have a\nnumber of beans ending in a 5?",
    "Illustrate what is going on by carefully\nexplaining how the two facts above prove that you will have a number\nof beans ending in a 5 on day 4 specifically.",
    "In other words, explain why\ninduction works in this context.\n",
    "2.\nUse induction to prove for all 𝑛∈ℕthat\n𝑛\nÕ\n𝑘=0\n2𝑘= 2𝑛+1 −1.\n",
    "3.\nProve that 7𝑛−1 is a multiple of 6 for all 𝑛∈ℕ.\n4.\nProve that 1 + 3 + 5 + · · ·",
    "+ (2𝑛−1) = 𝑛2 for all 𝑛≥1.\n",
    "5.\nProve that 𝐹0 + 𝐹2 + 𝐹4 + · · · + 𝐹2𝑛= 𝐹2𝑛+1 −1 where 𝐹𝑛is the 𝑛th Fibonacci\nnumber.\n",
    "6.\nProve that 2𝑛< 𝑛! for all 𝑛≥4.",
    "(Recall, 𝑛! = 1 · 2 · 3 · · · · · 𝑛.)\n7.\nProve, by mathematical induction, that 𝐹0 + 𝐹1 + 𝐹2 + · · · + 𝐹𝑛= 𝐹𝑛+2 −1, where\n𝐹𝑛is the 𝑛th Fibonacci number (𝐹0 = 0, 𝐹1 = 1 and 𝐹𝑛= 𝐹𝑛−1 + 𝐹𝑛−2).\n",
    "8.\nZombie Euler and Zombie Cauchy, two famous zombie mathematicians, have\njust signed up for Myspace accounts.",
    "After one day, Zombie Cauchy has\nmore followers than Zombie Euler.",
    "Each day after that, the number of new\nfollowers of Zombie Cauchy is exactly the same as the number of new followers\nof Zombie Euler (and neither lose any followers).",
    "Explain how a proof by\nmathematical induction can show that on every day after the first day, Zombie\nCauchy will have more followers than Zombie Euler.",
    "That is, explain what the\nbase case and inductive case are, and why they together prove that Zombie\nCauchy will have more followers on the 4th day.\n",
    "9.\nFind the largest number of points that it is impossible for a football team to\nget exactly, using just 3-point field goals and 7-point touchdowns (ignore the\npossibilities of safeties, missed extra points, and two-point conversions).",
    "Prove\n\n374\n4.",
    "Sequences\nyour answer is correct by mathematical induction.\n",
    "10.\nProve that the sum of 𝑛squares can be found as follows\n12 + 22 + 32 + · · · + 𝑛2 = 𝑛(𝑛+ 1)(2𝑛+ 1)\n6\n.\n11.\n",
    "Prove that the sum of the interior angles of a convex 𝑛-gon is (𝑛−2) · 180◦.",
    "(A\nconvex 𝑛-gon is a polygon with 𝑛sides for which each interior angle is less\nthan 180◦.)\n12.\n",
    "What is wrong with the following “proof” of the “fact” that 𝑛+ 3 = 𝑛+ 7 for\nall values of 𝑛(besides of course that the thing it is claiming to prove is false)?\nProof.\n",
    "Let 𝑃(𝑛) be the statement that 𝑛+ 3 = 𝑛+ 7.",
    "We will prove that\n𝑃(𝑛) is true for all 𝑛∈ℕ. Assume, for induction, that 𝑃(𝑘) is true.",
    "That is,\n𝑘+3",
    "= 𝑘+7.",
    "We must show that 𝑃(𝑘+1) is true.",
    "Now since 𝑘+3 = 𝑘+7, add 1\nto both sides.",
    "This gives 𝑘+3+1 = 𝑘+7+1.",
    "Regrouping (𝑘+1)+3 = (𝑘+1)+7.\n",
    "But this is simply 𝑃(𝑘+ 1).",
    "Thus by the principle of mathematical induction\n𝑃(𝑛) is true for all 𝑛∈ℕ.\n13.\n",
    "The proof in the previous problem does not work.",
    "But if we modify the “fact,”\nwe can get a working proof.",
    "Prove that 𝑛+ 3 < 𝑛+ 7 for all values of 𝑛∈ℕ.\nYou can do this proof with algebra (without induction), but the goal of this\nexercise is to write out a valid induction proof.\n",
    "14.\nFind the flaw in the following “proof” of the “fact” that 𝑛< 100 for every\n𝑛∈ℕ.\nProof.",
    "Let 𝑃(𝑛) be the statement 𝑛< 100.",
    "We will prove 𝑃(𝑛) is true for all\n𝑛∈ℕ.",
    "First we establish the base case: when 𝑛= 0, 𝑃(𝑛) is true, because\n0 < 100.",
    "Now for the inductive step, assume 𝑃(𝑘) is true.",
    "That is, 𝑘< 100.\n",
    "Now if 𝑘< 100, then 𝑘is some number, like 80.",
    "Of course 80 + 1 = 81 which\nis still less than 100.",
    "So 𝑘+ 1 < 100 as well.",
    "But this is what 𝑃(𝑘+ 1) claims, so\nwe have shown that 𝑃(𝑘) →𝑃(𝑘+ 1).",
    "Thus by the principle of mathematical\ninduction, 𝑃(𝑛) is true for all 𝑛∈ℕ.\n15.\n",
    "While the above proof does not work (it better not since the statement it is\ntrying to prove is false!)",
    "we can prove something similar.",
    "Prove that there is a\nstrictly increasing sequence 𝑎1, 𝑎2, 𝑎3, . . .",
    "of numbers (not necessarily integers)\n",
    "such that 𝑎𝑛< 100 for all 𝑛∈ℕ. (By strictly increasing we mean 𝑎𝑛< 𝑎𝑛+1 for\nall 𝑛. So each term must be larger than the last.)\n",
    "16.\n",
    "What is wrong with the following “proof” of the “fact” that for all 𝑛∈ℕ, the\nnumber 𝑛2 + 𝑛is odd?\n\n4.5.",
    "Proof by Induction\n375\nProof.\n",
    "Let 𝑃(𝑛) be the statement “𝑛2 + 𝑛is odd.”",
    "We will prove that 𝑃(𝑛)\nis true for all 𝑛∈ℕ. Suppose, for induction, that 𝑃(𝑘) is true, that is, that\n𝑘2 + 𝑘is odd.",
    "Now consider the statement 𝑃(𝑘+ 1).",
    "Now (𝑘+ 1)2 + (𝑘+ 1) =\n𝑘2 + 2𝑘+ 1 + 𝑘+ 1 = 𝑘2 + 𝑘+ 2𝑘+ 2.",
    "By the inductive hypothesis, 𝑘2 + 𝑘is\nodd, and of course 2𝑘+ 2 is even.",
    "An odd plus an even is always odd, so\ntherefore (𝑘+ 1)2 + (𝑘+ 1) is odd.",
    "Therefore by the principle of mathematical\ninduction, 𝑃(𝑛) is true for all 𝑛∈ℕ.\n17.\n",
    "Now give a valid proof (by induction, even though you might be able to do so\nwithout using induction) of the statement, “For all 𝑛∈ℕ, the number 𝑛2 + 𝑛is\neven.”\n18.\n",
    "Prove that there is a sequence of positive real numbers 𝑎0, 𝑎1, 𝑎2, . . .",
    "such that\nthe partial sum 𝑎0 + 𝑎1 + 𝑎2 + · · · + 𝑎𝑛is strictly less than 2 for all 𝑛∈ℕ. Hint:\nThink about how you could define what 𝑎𝑘+1 is to make the induction argument\nwork.\n",
    "19.\nUse induction to prove that if 𝑛people all shake hands with each other, that\nthe total number of handshakes is 𝑛(𝑛−1)\n2\n.\n20.\nUse induction to prove that\n𝑛\nÕ\n𝑘=0\n\u0012\n𝑛\n𝑘\n\u0013\n= 2𝑛. That is, the sum of the 𝑛th row of\nPascal’s triangle is 2𝑛.\n21.\n",
    "Use induction to prove \u00004\n0\n\u0001\n+ \u00005\n1\n\u0001\n+ \u00006\n2\n\u0001\n+ · · · + \u00004+𝑛\n𝑛\n\u0001\n= \u00005+𝑛\n𝑛\n\u0001\n.",
    "(This is an example\nof the hockey stick theorem.)\n",
    "22.\nUse the product rule for logarithms (log(𝑎𝑏) = log(𝑎)",
    "+ log(𝑏)) to prove, by\ninduction on 𝑛, that log(𝑎𝑛) = 𝑛log(𝑎), for all natural numbers 𝑛≥2.\n23.\n",
    "Let 𝑓1, 𝑓2, . . .",
    ", 𝑓𝑛be differentiable functions.",
    "Prove, using induction, that\n( 𝑓1 + 𝑓2 + · · · + 𝑓𝑛)′ = 𝑓′\n1 + 𝑓′\n2 + · · ·",
    "+ 𝑓′\n𝑛.\nYou may assume ( 𝑓+ 𝑔)′ = 𝑓′ + 𝑔′ for any differentiable functions 𝑓and 𝑔.\n24.\nSuppose 𝑓1, 𝑓2, . . .",
    ", 𝑓𝑛are differentiable functions.",
    "Use mathematical induction\nto prove the generalized product rule:\n( 𝑓1 𝑓2 𝑓3 · · ·",
    "𝑓𝑛)′ = 𝑓′\n1 𝑓2 𝑓3 · · ·",
    "𝑓𝑛+ 𝑓1 𝑓′\n2 𝑓3 · · ·",
    "𝑓𝑛+ 𝑓1 𝑓2 𝑓′\n3 · · · 𝑓𝑛+ · · · + 𝑓1 𝑓2 𝑓3 · · · 𝑓′\n𝑛.\nYou may assume the product rule for two functions is true.\n",
    "25.\n",
    "In Exercises 1.3.8 we proved that the following is a valid deduction rule:\n𝑃→𝑄\n𝑄→𝑅\n∴\n𝑃→𝑅\nNow use mathematical induction to prove you can chain together any number\nof statements like this.",
    "That is, prove for any 𝑛that the following is a valid\ndeduction rule:\n\n376\n4.",
    "Sequences\n𝑃1 →𝑃2\n𝑃2 →𝑃3\n...\n𝑃𝑛−1 →𝑃𝑛\n∴\n𝑃1 →𝑃𝑛.\n\n4.6\nStrong Induction\nObjectives\nAfter completing this section, you should be able to do the following.\n",
    "1. Explain the difference between proof by induction and proof by strong\ninduction.\n",
    "2. Use strong induction to prove statements.\n4.6.1\nSection Preview\nInvestigate!\nStart with a square piece of paper.",
    "You want to cut this square into smaller\nsquares, leaving no waste (every piece of paper you end up with must be a\nsquare).",
    "Obviously it is possible to cut the square into 4 squares.",
    "You can\nalso cut it into 9 squares.",
    "It turns out you can cut the square into 7 squares\n(although not all the same size).",
    "What other numbers of squares could you\nend up with?\n",
    "Sometimes, to prove that 𝑃(𝑘+ 1) is true, it would be helpful to know that\n𝑃(𝑘) and 𝑃(𝑘−1) and 𝑃(𝑘−2) are all true.",
    "This is certainly the case when proving\nsomething about a recurrence relation that is given as a combination of two previous\nterms.\n",
    "Example 4.6.1\nProve that 2𝑛is a solution to the recurrence relation 𝑎𝑛= 5𝑎𝑛−1 −6𝑎𝑛−2 with\ninitial conditions 𝑎0 = 1 and 𝑎1 = 2.\nSolution.\nProof.\n",
    "Let 𝑃(𝑛) be the statement, “𝑎𝑛= 2𝑛.” We will show this is true for all\n𝑛≥0.\n",
    "Base cases: 𝑎0 = 20 = 1 and 𝑎1 = 21 = 2 both agree with the initial\nconditions.\n",
    "Inductive case: Let 𝑘≥2 be arbitrary.",
    "Assume 𝑃(𝑘) and 𝑃(𝑘−1) are both\ntrue.",
    "That is, assume 𝑎𝑘= 2𝑘and 𝑎𝑘−1 = 2𝑘−1.",
    "We will show that 𝑃(𝑘+ 1) is\ntrue.",
    "Consider 𝑎𝑘+1.",
    "We have\n𝑎𝑘+1",
    "=5𝑎𝑘−6𝑎𝑘−1\n=5 · 2𝑘−6 · 2𝑘−1\n377\n\n378\n4.",
    "Sequences\n=10 · 2𝑘−1 −6 · 2𝑘−1\n=4 · 2𝑘−1\n=2𝑘+1.\n",
    "Therefore, by the principle of mathematical induction, 𝑃(𝑛) is true for all\n𝑛≥0.\n",
    "■\nWell, almost the principle of mathematical induction.",
    "Is what we did\nokay?\nThere are also times when we might want to go even farther back to use an\nassumption that 𝑃(𝑗) is true for 𝑗much smaller than 𝑘+ 1.",
    "This is the idea behind\nstrong induction and the topic of this short section.\n",
    "Preview Activity\n1.\nConsider the following puzzle:\nYou have a rectangular chocolate bar, made up of 𝑛identical squares of\nchocolate.",
    "You can take such a bar and break it along any row or column.",
    "How\nmany times will you have to break the bar to reduce it to 𝑛single chocolate\nsquares?\n",
    "At first, this question might seem impossible.",
    "Perhaps we meant to ask for\nthe smallest number of breaks needed.",
    "Let’s investigate.\n",
    "(a) Suppose you started with a 1 × 3 bar.",
    "How many breaks would you need\nto reduce it to single squares?\n",
    "(b) If you had a 1 × 4 bar, how many breaks are required?\n",
    "If you had 4 squares arranged in a 2 × 2 square, your first break would\nrequire you to break the chocolate into two 1 × 2 bars.",
    "Then each of these\nwould require\nmore break(s), for a total of\nbreaks to go from\nthe 2 × 2 to single squares.\n",
    "(c) A 6-square bar could either be a 1 × 6 bar, requiring\nbreaks, or a\n2 × 3 bar.\n",
    "There are two ways to proceed now.\n",
    "a. Break the bar into two 1 × 3 bars, each requiring\nmore breaks,\nfor a total of\nbreaks.\n",
    "b.",
    "Break the bar into a 1 × 2 bar and a 2 × 2 bar.",
    "The 1 × 2 bar takes\nmore break(s) and the 2 × 2 bar takes\nmore break(s), for\na total of\nbreaks.\n",
    "(d) Based on the above data, what should our conjecture be for the number\nof breaks to reduce an 𝑛-square bar to single squares, in terms of 𝑛?\nIt will take\nbreaks to reduce an 𝑛-square bar to single squares.\n\n",
    "4.6.",
    "Strong Induction\n379\n(e)",
    "Do we believe this?",
    "Suppose you used one break to reduce the bar into\ntwo smaller bars, with 𝑎and 𝑏squares respectively.",
    "If the conjecture is\ncorrect, how many more breaks will it take to reduce the size 𝑎bar?\n",
    "How many more breaks will it take to reduce the size 𝑏bar?\n",
    "How many breaks is this all together, in terms of 𝑎and 𝑏, including the\ninitial break?\nBut what is 𝑎+ 𝑏?",
    "We got 𝑎and 𝑏by breaking the 𝑛squares in two pieces,\nso 𝑎+ 𝑏=\n.",
    "This gives us a total number of breaks as\n.\n4.6.2\nDivide and Conquer\nThink of recursive definitions as instructions for building a ladder.",
    "You can build\nthe ladder as tall as you like because you have instructions for building the next\nrung, as long as you are standing on the rung before it.\n",
    "Induction is the corresponding proof technique.",
    "To prove that you can climb the\nladder as high as you like, you prove that you can step onto the ladder (the base\ncase) and then prove that, from any rung, you can get to the next rung (the inductive\nstep).\n",
    "More specifically, suppose you were trying to prove that you can get to rung 4 on\nthe ladder.",
    "You have successfully proved that you can get to rung 1, and that from\nany rung, you can get to the next.",
    "So you can get to rung 1, and from 1 you can get to\n2.",
    "From 2 you can get to 3, and from 3 you can get to 4.",
    "Therefore, you can get to 4.\nBut notice that along the way, you know you have visited rungs 1 through 3.",
    "We\nmight as well assume that we have visited all the rungs below the next one we are\ntrying to reach.",
    "This is the idea behind strong induction.\n",
    "A better ladder metaphor for strong induction is to think of ladders as things we\ncan stack on top of each other.",
    "We want to argue that it is possible to climb 20 rungs\nof a ladder.",
    "Let’s divide that into two smaller ladders, say a 12-rung ladder and an\n8-rung ladder.",
    "We can assume that we can climb both of these since 20 is the least\nsize we are not yet convinced of.",
    "Well, put those two ladders together, and you get\n12 + 8 = 20 rungs.\n",
    "We better climb down from our shaky metaphor before we hurt ourselves.",
    "Let’s\nlook at a formal definition of strong induction.\n",
    "Strong Induction Proof Structure.\n",
    "Start by saying what we want to prove: “Let 𝑃(𝑛) be the statement. . . .",
    "”\nThen establish two facts:\n1.",
    "Base case: Prove that 𝑃(0) is true.",
    "(Perhaps also prove other needed\nbase cases.)\n",
    "2.",
    "Inductive case: Assume 𝑃(𝑗) is true for all 𝑗≤𝑘. Prove that 𝑃(𝑘+ 1) is\ntrue.\n",
    "Conclude, “Therefore, by strong induction, 𝑃(𝑛) is true for all 𝑛> 0.”\n\n380\n4.",
    "Sequences\nOf course, it is acceptable to replace 0 with a larger base case if needed.2\nTo illustrate strong induction, let’s return to the chocolate bar problem.\n",
    "Proposition 4.6.2\nGiven an 𝑛-square rectangular chocolate bar, it always takes 𝑛−1 breaks to reduce\nthe bar to single squares.\n",
    "Proof.\n",
    "Let 𝑃(𝑛) be the statement, “It takes 𝑛−1 breaks to reduce a 𝑛-square\nchocolate bar to single squares.”\n",
    "Base case: Consider 𝑃(2).",
    "The squares must be arranged into a 1 × 2 rectangle,\nand we require 2 −1 = 1 breaks to reduce this to single squares.\n",
    "Inductive case: Fix an arbitrary 𝑘≥2 and assume 𝑃(𝑗) is true for all 𝑗≤𝑘.\nConsider a (𝑘+ 1)-square rectangular chocolate bar.",
    "Break the bar once along any\nrow or column.",
    "This results in two chocolate bars, say of sizes 𝑎and 𝑏. That is, we\nhave an 𝑎-square rectangular chocolate bar, a 𝑏-square rectangular chocolate bar,\nand",
    "𝑎+ 𝑏= 𝑘+ 1.\n",
    "We also know that 𝑎≤𝑘and 𝑏≤𝑘, so by our inductive hypothesis, 𝑃(𝑎) and\n𝑃(𝑏) are true.",
    "To reduce the 𝑎-square bar to single squares takes 𝑎−1 breaks; to\nreduce the 𝑏-square bar to single squares takes 𝑏−1 breaks.",
    "Doing this results in\nour original bar being reduced to single squares.",
    "All together it took the initial\nbreak, plus the 𝑎−1 and 𝑏−1 breaks, for a total of\n1 + 𝑎−1 + 𝑏−1",
    "= 𝑎+ 𝑏−1 = 𝑘+ 1 −1 = 𝑘\nbreaks.",
    "Thus 𝑃(𝑘+ 1) is true.\n",
    "Therefore, by strong induction, 𝑃(𝑛) is true for all 𝑛≥2.\n",
    "Here is a more mathematically relevant example:\nExample 4.6.3\nProve that any natural number greater than 1 is either prime or can be written\nas the product of primes.\n",
    "Solution.\n",
    "First, the idea: If we take some number 𝑛, maybe it is prime.",
    "If so,\nwe are done.",
    "If not, then it is composite, so it is the product of two smaller\nnumbers.",
    "Each of these factors is smaller than 𝑛(but at least 2), so we can\nrepeat the argument with these numbers.",
    "We have reduced to a smaller case.\n",
    "Now the formal proof:\nProof.\n",
    "Let 𝑃(𝑛) be the statement, “𝑛is either prime or can be written as the\nproduct of primes.”",
    "We will prove 𝑃(𝑛) is true for all 𝑛≥2.\n",
    "2Technically, strong induction does not require you to prove a separate base case.",
    "This is because\nwhen proving the inductive case, you must show that 𝑃(0) is true, assuming 𝑃(𝑘) is true for all 𝑘< 0.\n",
    "But this is not any help so you end up proving 𝑃(0) anyway.",
    "To be on the safe side, we will always\ninclude the base case separately.\n\n4.6.",
    "Strong Induction\n381\nBase case: 𝑃(2) is true because 2 is indeed prime.\n",
    "Inductive case: assume 𝑃(𝑗) is true for all 𝑗≤𝑘. We want to show that\n",
    "𝑃(𝑘+ 1) is true.",
    "That is, we want to show that 𝑘+ 1 is either prime or is the\nproduct of primes.",
    "If 𝑘+ 1 is prime, we are done.",
    "If not, then 𝑘+ 1 has more\nthan 2 divisors, so we can write 𝑘+ 1 = 𝑚1 · 𝑚2, with 𝑚1 and 𝑚2 less than\n𝑘+ 1 (and greater than 1).",
    "By the inductive hypothesis, 𝑚1 and 𝑚2 are each\neither prime or can be written as the product of primes.",
    "In either case, we\nhave that 𝑚1 · 𝑚2 = 𝑘+ 1 can be written as the product of primes.\n",
    "Thus by strong induction, 𝑃(𝑛) is true for all 𝑛≥2.\n",
    "■\nWhether you use regular induction or strong induction depends on the statement\nyou want to prove.",
    "If you wanted to be safe, you could always use strong induction.\n",
    "It really is stronger, so can accomplish everything “weak” induction can.",
    "That said,\nusing regular induction is often easier since there is only one place you can use the\ninduction hypothesis.",
    "There is also something to be said for elegance in proofs.",
    "If\nyou can prove a statement using simpler tools, it is nice to do so.\n",
    "4.6.3\nReading Questions\n1.\nTrue or false: To prove the inductive case of a proof by strong induction, you\nshould assume 𝑃(𝑘+ 1) is true and prove that 𝑃(𝑗) is true for all 𝑗≤𝑘.\nTrue or False?\n2.\nWhich of the following claims about the relationship between proof by\ninduction and proof by strong induction are true?\n",
    "A.",
    "Any proof by induction can be written as a proof by strong induction.\n",
    "B.",
    "Any proof by strong induction can be written as a proof by induction.\n",
    "C. Strong induction is “stronger” because the base case is stronger.\n",
    "D. Strong induction is “stronger” because the inductive hypothesis is\nstronger.\n",
    "3.\n",
    "What questions do you have?",
    "Write at least one question about the content of\nthis section that you or a classmate might be curious about after reading this\nsection.\n",
    "4.6.4\nPractice Problems\n1.\nSuppose you are trying to prove, by strong induction, that a statement 𝑃(𝑛) is\ntrue for all 𝑛≥0.",
    "What would you attempt to prove in the induction step of the\nproof?",
    "(Select all that apply.)\n",
    "A. That assuming 𝑃(𝑗) is true for all 𝑗≤𝑘, for an arbitrary 𝑘≥0, we can\nprove that 𝑃(𝑘+ 1) is true.\n\n",
    "382\n4.",
    "Sequences\nB.",
    "That (𝑃(0) ∧𝑃(1) ∧· · · ∧𝑃(𝑘)) implies 𝑃(𝑘+ 1) for all 𝑘≥0.\n",
    "C. That assuming 𝑃(𝑘+ 1) is true for an arbitrary 𝑘≥0, we can prove that\n𝑃(𝑗) is true for all 𝑗≤𝑘.\nD. That 𝑃(𝑘+ 1) implies 𝑃(𝑗) for all 𝑗≤𝑘.\nE. That 𝑃(𝑘−2) implies 𝑃(𝑘+ 1) for at least one 𝑘≥0.\n",
    "2.\nA simpler version of the chocolate bar problem is as follows: Suppose you\nhave a chocolate bar that is 𝑛squares long.",
    "You can break the chocolate bar\ninto two pieces by making a single straight break across the bar.",
    "No matter\nwhere you make the breaks, you will break the chocolate bar into 𝑛pieces by\nmaking 𝑛−1 breaks.\n",
    "Arrange some of the following statements in the correct order to form a\nproof of this claim by strong induction.\n",
    "• Assume that 𝑃(𝑗) is true for all 𝑗≤𝑘for an arbitrary 𝑘≥1.\n",
    "•",
    "Therefore, by the principle of strong induction, 𝑃(𝑛) is true for all 𝑛≥1.\n",
    "• 𝑃(1) is true because a chocolate bar that is 1 square long is already in one\npiece.\n",
    "• Consider a chocolate bar that is 𝑘+ 1 squares long.\n",
    "• Let 𝑃(𝑛) be the statement that a chocolate bar that is 𝑛squares long can\nbe broken into 𝑛pieces by making 𝑛−1 breaks.\n",
    "•",
    "Anywhere you break this bar will result in two smaller bars, say of length\n𝑎and 𝑏.\n•",
    "The total number of breaks is therefore 𝑎−1 + 𝑏−1",
    "+ 1 = 𝑎+ 𝑏−1, which\nis 𝑘+ 1 −1 = 𝑘.\n•",
    "Since 𝑎and 𝑏are no more than 𝑘, it will be possible to break these smaller\nbars into single squares using 𝑎−1 and 𝑏−1 breaks, respectively.\n",
    "4.6.5\nAdditional Exercises\n1.\nSuppose a football team only scores 3-point field goals and 7-point touch-\ndowns (ignore the possibilities of safeties, missed extra points, and two-point\nconversions).",
    "Prove, using strong induction, that the team can get any number\nof points, 12 points or greater.\n",
    "2.\nProve using strong induction that the sum of the interior angles of a convex\n𝑛-gon is (𝑛−2) · 180◦.",
    "(A convex 𝑛-gon is a polygon with 𝑛sides for which\neach interior angle is less than 180◦.)\n\n",
    "4.6.",
    "Strong Induction\n383\n3.\nProve that every positive integer is either a power of 2 or can be written as the\nsum of distinct powers of 2.\n",
    "4.\nProve, using strong induction, that every natural number is either a Fibonacci\nnumber or can be written as the sum of distinct Fibonacci numbers.\n",
    "5.\nWe have previously proved that for any tree, the number of edges is always\none less than the number of vertices.",
    "That is, a tree with 𝑣vertices and 𝑒edges\nsatisfies 𝑣= 𝑒+ 1.\nGive an alternate proof of this fact using strong induction on the number of\nvertices.",
    "Do so by taking a non-leaf vertex and “splitting” it into two vertices,\neach belonging to a separate tree.\n",
    "6.\nSuppose that a particular real number 𝑥has the property that 𝑥+ 1\n𝑥is an\ninteger.",
    "Prove that 𝑥𝑛+ 1\n𝑥𝑛is an integer for all natural numbers 𝑛.\n7.\n",
    "Here is an example of a more complicated induction technique called double\ninduction.\n",
    "You will prove that the Fibonacci numbers satisfy the identity 𝐹2\n𝑛+ 𝐹2\n𝑛+1 =\n𝐹2𝑛+1.",
    "One way to do this is to prove the more general identity,\n",
    "𝐹𝑚𝐹𝑛+ 𝐹𝑚+1𝐹𝑛+1 = 𝐹𝑚+𝑛+1,\nand realize that when 𝑚= 𝑛we get our desired result.\n",
    "Note that we now have two variables, so we want to prove this for all 𝑚≥0\nand all 𝑛≥0 at the same time.",
    "For each such pair (𝑚, 𝑛), let 𝑃(𝑚, 𝑛) be the\nstatement 𝐹𝑚𝐹𝑛+ 𝐹𝑚+1𝐹𝑛+1 = 𝐹𝑚+𝑛+1\n(a) First fix 𝑚= 0, and give a proof by mathematical induction that 𝑃(0, 𝑛)\nholds for all 𝑛≥0.",
    "Note that this proof will be very easy.\n",
    "(b) Now fix an arbitrary 𝑛, and give a proof by strong mathematical induction\nthat 𝑃(𝑚, 𝑛) holds for all 𝑚≥0.\n",
    "(c) You can now conclude that 𝑃(𝑚, 𝑛) holds for all 𝑚, 𝑛≥0.",
    "Do you believe\nthat?",
    "Explain why this sort of induction is valid.",
    "For example, why do\nyour proofs above guarantee that 𝑃(2, 3) is true?\n8.\n",
    "Given a square, you can cut the square into smaller squares by cutting along\nlines parallel to the sides of the original square (these lines do not need to travel\nthe entire side length of the original square).",
    "For example, by cutting along the\nlines below, you will divide a square into 6 smaller squares:\n\n384\n4.",
    "Sequences\nProve, using strong induction, that it is possible to cut a square into 𝑛\nsmaller squares for any 𝑛≥6.\n\n",
    "4.7\nChapter Summary\nInvestigate!\n",
    "Each day your supply of magic chocolate-covered espresso beans doubles\n(each one splits in half), but then you eat 5 of them.",
    "You have 10 at the start\nof day 0.\n",
    "1. Write out the first few terms of the sequence.",
    "Then give a recursive\ndefinition for the sequence, and explain how you know it is correct.\n",
    "2. Prove, using induction, that the last digit of the number of beans you\nhave on the 𝑛th day is always a 5 for all 𝑛≥1.\n",
    "3. Find a closed formula for the 𝑛th term of the sequence, and prove it is\ncorrect by induction.\n",
    "In this chapter, we explored sequences and mathematical induction.",
    "At first,\nthese might not seem entirely related, but there is a link: recursive reasoning.",
    "When\nwe have many cases (maybe infinitely many), it is often easier to describe a particular\ncase by saying how it relates to other cases, instead of describing it from scratch.",
    "For\nsequences, we can describe the 𝑛th term in the sequence by saying how it is related\nto the previous term.",
    "When showing a statement involving the variable 𝑛is true for\nall values of 𝑛, we can describe why the case for 𝑛= 𝑘is true based on why the case\nfor 𝑛=",
    "𝑘−1 is true.\n",
    "While thinking of problems recursively is often easier than thinking of them\nabsolutely (at least after you get used to thinking in this way), our ultimate goal is\nto move beyond this recursive description.",
    "For sequences, we want to find closed\nformulas for the 𝑛th term of the sequence.",
    "For proofs, we want to know that the\nstatement is true for a particular 𝑛(not only under the assumption that the statement\nis true for the previous value of 𝑛).",
    "In this chapter, we saw some methods for moving\nfrom recursive descriptions to absolute descriptions.\n",
    "•",
    "If the terms of a sequence increase by a constant difference or constant ratio\n(these are both recursive descriptions), then the sequence is arithmetic or\ngeometric, respectively, and we have closed formulas for each of these based\non the initial terms and common difference or ratio.\n",
    "•",
    "If the terms of a sequence increase at a polynomial rate (that is, if the differences\nbetween terms form a sequence with a polynomial closed formula), then the\nsequence is given by a polynomial closed formula (of degree one more than\nthe sequence of differences).\n",
    "•",
    "If the terms of a sequence increase at an exponential rate, then we expect the\nclosed formula for the sequence to be exponential.",
    "These sequences often have\n385\n\n386\n4.",
    "Sequences\nrelatively nice recursive formulas, and the characteristic root technique allows us\nto find the closed formula for these sequences.\n",
    "• If we want to prove that a statement is true for all values of 𝑛(greater than\nsome first small value), and we can describe why the statement for 𝑛= 𝑘\nimplies the statement for 𝑛= 𝑘+ 1, then the principle of mathematical induction\ngives us that the statement is true for all values of 𝑛(greater than the base\ncase).\n",
    "Throughout the chapter we tried to understand why these facts listed above are\ntrue.",
    "In part, that is what proofs, by induction or not, attempt to accomplish: They\nexplain why mathematical truths are, in fact, truths.",
    "As we develop our ability to\nreason about mathematics, it is a good idea to make sure that the methods of our\nreasoning are sound.",
    "The branch of mathematics that deals with deciding whether\nreasoning is good or not is mathematical logic, the subject of the next chapter.\n",
    "Chapter Review\n1.\nFind 7 + 13 + 19 + · · · + 1243.\n",
    "2.\nConsider the sequence 28, 38, 48, 58, . . .",
    ", 10𝑛−2.\na.",
    "How many terms are there in the sequence?\nb.",
    "What is the second-to-last term?\n",
    "c. Find the sum of all the terms in the sequence.\n",
    "3.\nConsider the sequence given by 𝑎𝑛= 6 · 5𝑛−1.\na.",
    "Find the first 4 terms of the sequence.\n",
    "𝑎1 =\n, 𝑎2 =\n, 𝑎3 =\n, 𝑎4 =\n,...\n",
    "What sort of sequence is this?\n(□arithmetic\n□geometric\n□neither)\nb.",
    "Find the sum of the first 22 terms.",
    "That is, compute Í22\n𝑘=1 𝑎𝑘.\n4.\nConsider the sequence 5, 11, 19, 29, 41, 55, . . ..",
    "Assume 𝑎1 = 5.\n(a) Find a closed formula for 𝑎𝑛, the 𝑛th term of the sequence, by writing\neach term as a sum of a sequence.",
    "Hint: first find 𝑎0, but ignore it when\ncollapsing the sum.\n",
    "(b) Find a closed formula again, this time using either polynomial fitting or\nthe characteristic root technique (whichever is appropriate).",
    "Show your\nwork.\n",
    "(c) Find a closed formula once again, this time by recognizing the sequence\nas a modification of some well-known sequence(s).",
    "Explain.\n\n",
    "4.7.",
    "Chapter Summary\n387\n5.\nUse polynomial fitting to find the formula for the 𝑛th term of the sequence\n(𝑎𝑛)𝑛≥1 which starts,\n11, 22, 35, 50, 67, . . .\n",
    "Note the first term above is 𝑎1, not 𝑎0.\n",
    "𝑎𝑛=\n6.\nSuppose the closed formula for a particular sequence is a degree 3 polynomial.\n",
    "What can you say about the closed formula for:\n(a) The sequence of partial sums?\n(b)",
    "The sequence of second differences?\n7.\nConsider the sequence given recursively by 𝑎1 = 4, 𝑎2 = 6, and 𝑎𝑛= 𝑎𝑛−1 + 𝑎𝑛−2.\n(a) Write out the first 6 terms of the sequence.\n",
    "(b) Could the closed formula for 𝑎𝑛be a polynomial?",
    "Explain.\n",
    "8.\n",
    "The sequence (𝑎𝑛)𝑛≥1 starts −1, 0, 2, 5, 9, 14 . . .",
    "and has closed formula\n𝑎𝑛= (𝑛+ 1)(𝑛−2)\n2\n.\n",
    "Use this fact to find a closed formula for the sequence (𝑏𝑛)𝑛≥1 which starts\n4, 10, 18, 28, 40, . . . .\n",
    "9.\n",
    "In the song The Twelve Days of Christmas, my true love gave to me first 1 gift;\nthen 2 gifts and 1 gift; then 3 gifts, 2 gifts, and 1 gift; and so on.",
    "How many\ngifts did my true love give me all together during the twelve days?\n10.\nConsider the recurrence relation 𝑎𝑛= 𝑎𝑛−1 + 20𝑎𝑛−2 with first two terms 𝑎0 = 4\nand 𝑎1 = 9.\n",
    "a. Write out the first 5 terms of the sequence defined by this recurrence\nrelation.\n",
    "𝑎2 =\n, 𝑎3 =\n, 𝑎4 =\n, ...\n",
    "b.",
    "Solve the recurrence relation.",
    "That is, find a closed formula for 𝑎𝑛.\n𝑎𝑛=\n11.\n",
    "Consider the recurrence relation 𝑎𝑛= 3𝑎𝑛−1 + 18𝑎𝑛−2 with first two terms\n𝑎0 = 5 and 𝑎1 = 7.\na. Find the next two terms of the sequence (𝑎2 and 𝑎3):\n𝑎2 =\n𝑎3 =\nb.",
    "Solve the recurrence relation.",
    "That is, find a closed formula for 𝑎𝑛.\n𝑎𝑛=\n\n388\n4.",
    "Sequences\n12.\n",
    "Your magic chocolate bunnies reproduce like rabbits: every large bunny\nproduces 2 new mini bunnies each day, and each day every mini bunny born\nthe previous day grows into a large bunny.",
    "Assume you start with 2 mini\nbunnies and no bunny ever dies (or gets eaten).\n",
    "(a) Write out the first few terms of the sequence.\n",
    "(b) Give a recursive definition of the sequence, and explain why it is correct.\n",
    "(c) Find a closed formula for the 𝑛th term of the sequence.\n",
    "13.\nConsider the sequence of partial sums of squares of Fibonacci numbers: 𝐹2\n1,\n𝐹2\n1 + 𝐹2\n2, 𝐹2\n1 + 𝐹2\n2 + 𝐹2\n3, . . ..",
    "The sequence starts 1, 2, 6, 15, 40, . . .\n",
    "(a) Guess a formula for the 𝑛th partial sum, in terms of Fibonacci numbers.\n",
    "Hint: Write each term as a product.\n",
    "(b) Prove your formula is correct by mathematical induction.\n",
    "(c) Explain what this problem has to do with the following picture:\n14.\n",
    "Prove the following statements by mathematical induction:\n(a) 𝑛! <",
    "𝑛𝑛for 𝑛≥2\n(b)\n1\n1 · 2 +\n1\n2 · 3 +\n1\n3 · 4 + · · · +\n1\n𝑛· (𝑛+ 1) =\n𝑛\n𝑛+ 1 for all 𝑛∈ℤ+.\n",
    "(c) 4𝑛−1 is a multiple of 3 for all 𝑛∈ℕ.\n(d) The greatest amount of postage you cannot make exactly using 4 and 9\ncent stamps is 23 cents.\n",
    "(e) Every even number squared is divisible by 4.\n15.\n",
    "Prove 13 + 23 + 33 + · · ·",
    "+ 𝑛3 =\n\u0010\n𝑛(𝑛+1)\n2\n\u00112\nholds for all 𝑛≥1, by mathematical\ninduction.\n",
    "16.\nSuppose 𝑎0 = 1, 𝑎1 = 1 and 𝑎𝑛= 3𝑎𝑛−1 −2𝑎𝑛−2.",
    "Prove, using strong induction,\n",
    "that 𝑎𝑛= 1 for all 𝑛.\n17.\nProve using induction that every set containing 𝑛elements has 2𝑛different\nsubsets for any 𝑛≥1.\n\n",
    "Chapter 5\nDiscrete Structures Revisited\nThroughout the previous chapters, we have seen many examples of discrete structures\nand their properties and uses.",
    "The following sections are self-contained overviews\nof each of the main structures we have explored.",
    "These can either be studied prior\nto other material in the book or as a review and reference after the fact.\n5.1\nSets\nNote that this section contains a lot of detail on what we can say about sets.",
    "If you\nhave never seen anything about unions or Venn diagrams, it is worth reading this\ncarefully.\n",
    "The most fundamental objects we will use in our studies (and really in all of\nmath) are sets.",
    "Much of what follows might be review, but it is very important that\nyou are fluent in the language of set theory.",
    "Most of the notation we use below is\nstandard, although some might be a little different than what you have seen before.\n",
    "For us, a set will simply be an unordered collection of objects.",
    "Two examples:\nWe could consider the set of all actors who have played The Doctor on Doctor Who, or\nthe set of natural numbers between 1 and 10 inclusive.",
    "In the first case, Tom Baker is\nan element (or member) of the set, while Idris Elba, among many others, is not an\nelement of the set.",
    "Also, the two examples are of different sets.",
    "Two sets are equal\nexactly if they contain the exact same elements.",
    "For example, the set containing all\nof the vowels in the Declaration of Independence is precisely the same set as the set\nof vowels in the word “questionably” (namely, all of them); we do not care about\norder or repetitions, just whether the element is in the set or not.\n",
    "5.1.1\nNotation\nWe need some notation to make talking about sets easier.",
    "Consider,\n𝐴= {1, 2, 3}.\n",
    "This is read, “𝐴is the set containing the elements 1, 2, and 3.”",
    "We use curly\nbraces “{, }” to enclose elements of a set.",
    "Some more notation:\n𝑎∈{𝑎, 𝑏, 𝑐}.\n",
    "The symbol “∈” is read “is in” or “is an element of.”",
    "Thus the above means that\n𝑎is an element of the set containing the letters 𝑎, 𝑏, and",
    "𝑐.",
    "Note that this is a true\nstatement.",
    "It would also be true to say that 𝑑is not in that set:\n𝑑∉{𝑎, 𝑏, 𝑐}.\n389\n\n390\n5.",
    "Discrete Structures Revisited\nBe warned: We write “𝑥∈𝐴” when we wish to express that one of the elements\nof the set 𝐴is 𝑥.",
    "For example, consider the set,\n𝐴= {1, 𝑏, {𝑥, 𝑦, 𝑧}, ∅}.\n",
    "This is a strange set, to be sure.",
    "It contains four elements: the number 1, the\nletter b, the set {𝑥, 𝑦, 𝑧}, and the empty set ∅= {}, the set containing no elements.\n",
    "Is 𝑥in 𝐴?",
    "The answer is no.",
    "None of the four elements in 𝐴are the letter 𝑥, so we\nmust conclude that 𝑥∉𝐴. Similarly, consider the set 𝐵= {1, 𝑏}.",
    "Even though the\nelements of 𝐵are elements of 𝐴, we cannot say that the set 𝐵is one of the elements\nof 𝐴. Therefore 𝐵∉𝐴. (Soon we will see that 𝐵is a subset of 𝐴, but this is different\nfrom being an element of 𝐴.)\nWe have described the sets above by listing their elements.",
    "Sometimes this is\nhard to do, especially when there are a lot of elements in the set (perhaps infinitely\nmany).",
    "For instance, if we want 𝐴to be the set of all even natural numbers, would\ncould write,\n𝐴= {0, 2, 4, 6, . . .",
    "},\nbut this is a little imprecise.",
    "A better way would be\n𝐴= {𝑥∈ℕ: there exists 𝑛∈ℕsuch that 𝑥= 2𝑛}.\n",
    "Let’s look at this carefully.",
    "First, there are some new symbols to digest: “ℕ” is\nthe symbol usually used to denote the natural numbers, which we will take to be\nthe set {0, 1, 2, 3, . . .}.",
    "Next, the colon, “:”, is read such that; it separates the elements\nthat are in the set from the condition that the elements in the set must satisfy.",
    "So\nputting this all together, we would read the set as, “the set of all 𝑥in the natural\nnumbers, such that there exists some 𝑛in the natural numbers for which 𝑥is twice\n𝑛.”",
    "In other words, the set of all natural numbers that are even.",
    "Here is another way\nto write the same set.\n",
    "𝐴= {𝑥∈ℕ: 𝑥is even}.\n",
    "Note: Sometimes mathematicians use | or ϶ for the “such that” symbol instead of\nthe colon.",
    "Also, there is a fairly even split between mathematicians about whether 0\nis an element of the natural numbers, so be careful there.\n",
    "This notation is usually called set builder notation.",
    "It tells us how to build a set\nby telling us precisely the condition elements must meet to gain access (the condition\nis the logical statement after the “:” symbol).",
    "Reading and comprehending sets\nwritten in this way takes practice.",
    "Here are some more examples:\nExample 5.1.1\nDescribe each of the following sets both in words and by listing out enough\nelements to see the pattern.\n",
    "1. {𝑥: 𝑥+ 3 ∈ℕ}.\n",
    "2. {𝑥∈ℕ: 𝑥+ 3 ∈ℕ}.\n\n",
    "5.1.",
    "Sets\n391\n3. {𝑥: 𝑥∈ℕor −𝑥∈ℕ}.\n",
    "4. {𝑥: 𝑥∈ℕand −𝑥∈ℕ}.\n",
    "Solution.\n",
    "1.",
    "This is the set of all numbers that are 3 less than a natural number (i.e.,\nthat if you add 3 to them, you get a natural number).",
    "The set could also\nbe written as {−3, −2, −1, 0, 1, 2, . . .}",
    "(note that 0 is a natural number, so\n−3 is in this set because −3 + 3 = 0).\n",
    "2.",
    "This is the set of all natural numbers that are 3 less than a natural\nnumber.",
    "So here we just have {0, 1, 2, 3 . . .}.\n",
    "3.",
    "This is the set of all integers (positive and negative whole numbers,\nwritten ℤ).",
    "In other words, {. . . , −2, −1, 0, 1, 2, . . .}.\n4.",
    "Here we want all numbers 𝑥such that 𝑥and −𝑥are natural numbers.\n",
    "There is only one: 0.",
    "So we have the set {0}.\n",
    "There is also a subtle variation on set builder notation.",
    "While the condition is\ngenerally given after the “such that”, sometimes it is hidden in the first part.",
    "Here is\nan example.\n",
    "Example 5.1.2\nList a few elements in the sets below and describe them in words.",
    "The set ℤ\nis the set of integers; positive and negative whole numbers.\n",
    "1. 𝐴= {𝑥∈ℤ: 𝑥2 ∈ℕ}\n2.",
    "𝐵= {𝑥2 : 𝑥∈ℕ}\nSolution.\n",
    "1.",
    "The set of integers that pass the condition that their square is a natural\nnumber.",
    "Well, every integer, when you square it, gives you a non-\nnegative integer, so a natural number.",
    "Thus 𝐴= ℤ= {. . . , −2, −1, 0, 1, 2, 3, . . .}.\n",
    "2.",
    "Here we are looking for the set of all 𝑥2s where 𝑥is a natural number.\n",
    "So this set is simply the set of perfect squares.",
    "𝐵= {0, 1, 4, 9, 16, . . .}.\n",
    "Another way we could have written this set, using more strict set builder\nnotation, would be as 𝐵= {𝑥∈ℕ: 𝑥= 𝑛2 for some 𝑛∈ℕ}.\n",
    "We already have a lot of notation, and there is more yet.",
    "Below is a handy chart\nof symbols.",
    "Some of these will be discussed in greater detail as we move forward.\n\n",
    "392\n5.",
    "Discrete Structures Revisited\nSpecial sets.\n",
    "∅\nThe empty set is the set that contains no elements.\n",
    "𝒰\nThe universe set is the set of all elements.\n",
    "ℕ\nThe set of natural numbers.",
    "That is, ℕ= {0, 1, 2, 3 . . .}.\n",
    "ℤ\nThe set of integers.",
    "That is, ℤ= {. . . , −2, −1, 0, 1, 2, 3, . . .}.\n",
    "ℚ\nThe set of rational numbers.\n",
    "ℝ\nThe set of real numbers.\n𝒫(𝐴)\n",
    "The power set of any set 𝐴is the set of all subsets of 𝐴.\nSet Theory Notation.\n",
    "{, }\nWe use these braces to enclose the elements of a set.",
    "So {1, 2, 3} is\nthe set containing 1, 2, and 3.\n:\n{𝑥: 𝑥> 2} is the set of all 𝑥such that 𝑥is greater than 2.\n∈\n2 ∈{1, 2, 3} asserts that 2 is an element of the set {1, 2, 3}.\n",
    "∉\n4 ∉{1, 2, 3} because 4 is not an element of the set {1, 2, 3}.\n",
    "⊆\n𝐴⊆𝐵asserts that 𝐴is a subset of 𝐵: Every element of 𝐴is also\nan element of 𝐵.\n⊂\n𝐴⊂𝐵asserts that 𝐴is a proper subset of 𝐵: Every element of 𝐴\nis also an element of 𝐵, but 𝐴≠𝐵.\n∩\n𝐴∩𝐵is the intersection of 𝐴and 𝐵: the set containing all elements\nthat are elements of both 𝐴and 𝐵.\n∪\n𝐴∪𝐵is the union of 𝐴and 𝐵: the set containing all elements that\nare elements of 𝐴or 𝐵or both.\n×\n𝐴× 𝐵is the Cartesian product of 𝐴and 𝐵: the set of all ordered\npairs (𝑎, 𝑏) with 𝑎∈𝐴and 𝑏∈𝐵.\n\\\n𝐴\\ 𝐵is set difference between 𝐴and 𝐵: the set containing all\nelements of 𝐴that are not elements of 𝐵.\n𝐴\nThe complement of 𝐴is the set of everything that is not an element\nof 𝐴.\n|𝐴|\nThe cardinality (or size) of 𝐴is the number of elements in 𝐴.\n\n5.1.",
    "Sets\n393\nInvestigate!\n",
    "1. Find the cardinality of each set below.\n",
    "(a) 𝐴= {3, 4, . . .",
    ", 15}.\n",
    "(b) 𝐵= {𝑛∈ℕ: 2 < 𝑛≤200}.\n",
    "(c) 𝐶= {𝑛≤100 : 𝑛∈ℕand for some 𝑚∈ℕ, (𝑛= 2𝑚+ 1)}.\n",
    "2. Find two sets 𝐴and 𝐵for which |𝐴| = 5, |𝐵| = 6, and |𝐴∪𝐵|",
    "= 9.\n",
    "What is |𝐴∩𝐵|?\n3.",
    "Find sets 𝐴and 𝐵with |𝐴| = |𝐵| such that |𝐴∪𝐵| = 7 and |𝐴∩𝐵|",
    "= 3.\n",
    "What is |𝐴|?\n4.",
    "Let 𝐴= {1, 2, . . .",
    ", 10}.",
    "Define ℬ2 = {𝐵⊆𝐴: |𝐵| = 2}.",
    "Find |ℬ2|.\n",
    "5.",
    "For any sets 𝐴and 𝐵, define 𝐴𝐵= {𝑎𝑏: 𝑎∈𝐴and 𝑏∈𝐵}.",
    "If 𝐴= {1, 2}\nand 𝐵= {2, 3, 4}, what is |𝐴𝐵|?",
    "What is |𝐴× 𝐵|?\n5.1.2\nRelationships between Sets\nWe have already said what it means for two sets to be equal: They have exactly the\nsame elements.",
    "Thus, for example,\n{1, 2, 3} = {2, 1, 3}.\n",
    "(Remember, the order the elements are written down in does not matter.)",
    "Also,\n{1, 2, 3} = {1, 1 + 1, 1 + 1",
    "+ 1} = {𝐼, 𝐼𝐼, 𝐼𝐼𝐼} = {1, 2, 3, 1 + 2}\nsince these are all ways to write the set containing the first three positive integers\n(how we write them doesn’t matter, just what they are).\n",
    "What about the sets 𝐴= {1, 2, 3} and 𝐵= {1, 2, 3, 4}?",
    "Clearly 𝐴≠𝐵, but notice\nthat every element of 𝐴is also an element of 𝐵. Because of this we say that 𝐴is a\nsubset of 𝐵, or in symbols, 𝐴⊂𝐵or 𝐴⊆𝐵. Both symbols are read “is a subset of.”\n",
    "The difference is that sometimes we want to say that 𝐴is either equal to or is a subset\nof 𝐵, in which case we use ⊆. This is analogous to the difference between < and ≤.\nExample 5.1.3\nLet 𝐴= {1, 2, 3, 4, 5, 6}, 𝐵= {2, 4, 6}, 𝐶= {1, 2, 3}, and 𝐷= {7, 8, 9}.",
    "Deter-\nmine which of the following are true, false, or meaningless.\n\n394\n5.",
    "Discrete Structures Revisited\n1. 𝐴⊂𝐵.\n",
    "2. 𝐵⊂𝐴.\n3. 𝐵∈𝐶.\n4. ∅∈𝐴.\n5.",
    "∅⊂𝐴.\n6. 𝐴< 𝐷.\n7. 3 ∈𝐶.\n8. 3 ⊂𝐶.\n9.",
    "{3} ⊂𝐶.\nSolution.\n",
    "1.",
    "False.",
    "For example, 1 ∈𝐴but 1 ∉𝐵.\n2. True.",
    "Every element in 𝐵is an element in 𝐴.\n3. False.",
    "The elements in 𝐶are 1, 2, and 3.",
    "The set 𝐵is not equal to 1, 2, or\n3.\n4.",
    "False.",
    "𝐴has exactly 6 elements, and none of them are the empty set.\n",
    "5.",
    "True.",
    "Everything in the empty set (nothing) is also an element of 𝐴.\nNotice that the empty set is a subset of every set.\n",
    "6. Meaningless.",
    "A set cannot be less than another set.\n",
    "7.",
    "True. 3 is one of the elements of the set 𝐶.\n8.",
    "Meaningless.",
    "3 is not a set, so it cannot be a subset of another set.\n",
    "9.",
    "True. 3 is the only element of the set {3}, and is an element of 𝐶, so\nevery element in {3} is an element of 𝐶.\n",
    "In the example above, 𝐵is a subset of 𝐴. You might wonder what other sets are\nsubsets of 𝐴.",
    "If you collect all these subsets of 𝐴into a new set, we get a set of sets.\n",
    "We call the set of all subsets of 𝐴the power set of 𝐴, and write it 𝒫(𝐴).\n",
    "Example 5.1.4\nLet 𝐴= {1, 2, 3}.",
    "Find 𝒫(𝐴).\n",
    "Solution.\n𝒫(𝐴) is a set of sets, all of which are subsets of 𝐴. So\n𝒫(𝐴)",
    "= {∅, {1}, {2}, {3}, {1, 2}, {1, 3}, {2, 3}, {1, 2, 3}}.\n",
    "Notice that while 2 ∈𝐴, it is wrong to write 2 ∈𝒫(𝐴) since none of the\nelements in 𝒫(𝐴) are numbers!",
    "On the other hand, we do have {2} ∈𝒫(𝐴)\nbecause {2} ⊆𝐴.\nWhat does a subset of 𝒫(𝐴) look like?",
    "Notice that {2} ⊈𝒫(𝐴) because not\neverything in {2} is in 𝒫(𝐴).",
    "But we do have {{2}} ⊆𝒫(𝐴).",
    "The only element\nof {{2}} is the set {2}, which is also an element of 𝒫(𝐴).",
    "We could take the\ncollection of all subsets of 𝒫(𝐴) and call that 𝒫(𝒫(𝐴)).",
    "Or even the power set\nof that set of sets of sets.\n\n5.1.",
    "Sets\n395\nAnother way to compare sets is by their size.",
    "Notice that in the example above, 𝐴\nhas 6 elements, and 𝐵, 𝐶, and 𝐷all have 3 elements.",
    "The size of a set is called the\nset’s cardinality.",
    "We would write |𝐴| = 6, |𝐵| = 3, and so on.",
    "For sets that have a\nfinite number of elements, the cardinality of the set is simply the number of elements\nin the set.",
    "Note that the cardinality of {1, 2, 3, 2, 1} is 3.",
    "We do not count repeats\n(in fact, {1, 2, 3, 2, 1} is exactly the same set as {1, 2, 3}).",
    "There are sets with infinite\ncardinality, such as ℕ, the set of rational numbers (written ℚ), the set of even natural\nnumbers, and the set of real numbers (ℝ).",
    "It is possible to distinguish between\ndifferent infinite cardinalities, but that is beyond the scope of this text.",
    "For us, a set\nwill either be infinite or finite; if it is finite, then we can determine its cardinality by\ncounting elements.\n",
    "Example 5.1.5\n1.",
    "Find the cardinality of 𝐴= {23, 24, . .",
    ".",
    ", 37, 38}.\n",
    "2. Find the cardinality of 𝐵= {1, {2, 3, 4}, ∅}.\n",
    "3.",
    "If 𝐶= {1, 2, 3}, what is the cardinality of 𝒫(𝐶)?\nSolution.\n1.",
    "Since 38 −23 = 15, we can conclude that the cardinality of the set is\n|𝐴| = 16 (you need to add one since 23 is included).\n",
    "2.",
    "Here |𝐵| = 3.",
    "The three elements are the number 1, the set {2, 3, 4}, and\nthe empty set.\n",
    "3.",
    "We wrote out the elements of the power set 𝒫(𝐶) above, and there are 8\nelements (each of which is a set).",
    "So |𝒫(𝐶)|",
    "= 8.",
    "(You might wonder if\nthere is a relationship between |𝐴| and |𝒫(𝐴)| for all sets 𝐴.",
    "This is a\ngood question that we explore in Chapter 3.)\n5.1.3\nOperations on Sets\nIs it possible to add two sets?",
    "Not really, however there is something similar.",
    "If we\nwant to combine two sets to get the collection of objects that are in either set, then\nwe can take the union of the two sets.",
    "Symbolically,\n𝐶= 𝐴∪𝐵,\nread, “𝐶is the union of 𝐴and 𝐵,” means that the elements of 𝐶are exactly the\nelements that are either an element of 𝐴or an element of 𝐵(or an element of both).\n",
    "For example, if 𝐴= {1, 2, 3} and 𝐵= {2, 3, 4}, then 𝐴∪𝐵= {1, 2, 3, 4}.\n",
    "The other common operation on sets is intersection.",
    "We write,\n𝐶= 𝐴∩𝐵\n\n396\n5.",
    "Discrete Structures Revisited\nand say, “𝐶is the intersection of 𝐴and 𝐵,” when the elements in 𝐶are precisely\nthose both in 𝐴and in 𝐵.",
    "So if 𝐴= {1, 2, 3} and 𝐵= {2, 3, 4}, then 𝐴∩𝐵= {2, 3}.\n",
    "Often when dealing with sets, we will have some understanding as to what\n“everything” is.",
    "Perhaps we are only concerned with natural numbers.",
    "In this case\nwe would say that our universe is ℕ. Sometimes we denote this universe by 𝒰.\nGiven this context, we might wish to speak of all the elements that are not in a\nparticular set.",
    "We say 𝐵is the complement of 𝐴, and write,\n𝐵= 𝐴\nwhen 𝐵contains every element not contained in 𝐴. So, if our universe is {1, 2, . . .",
    ", 9, 10},\nand 𝐴= {2, 3, 5, 7}, then 𝐴= {1, 4, 6, 8, 9, 10}.\n",
    "Of course we can perform more than one operation at a time.",
    "For example,\nconsider\n𝐴∩𝐵.\n",
    "This is the set of all elements that are both elements of 𝐴and not elements of\n𝐵. What have we done?",
    "We’ve started with 𝐴and removed all of the elements that\nwere in 𝐵. Another way to write this is the set difference:\n𝐴∩𝐵= 𝐴\\ 𝐵.\n",
    "It is important to remember that these operations (union, intersection, comple-\nment, and difference) on sets produce other sets.",
    "Don’t confuse these with the\nsymbols from the previous section (element of and subset of).",
    "𝐴∩𝐵is a set, while\n𝐴⊆𝐵is true or false.",
    "This is the same difference as between 3 + 2 (which is a\nnumber) and 3 ≤2 (which is false).\n",
    "Example 5.1.6\nLet 𝐴= {1, 2, 3, 4, 5, 6}, 𝐵= {2, 4, 6}, 𝐶= {1, 2, 3}, and 𝐷= {7, 8, 9}.",
    "If the\nuniverse is 𝒰= {1, 2, . .",
    ".",
    ", 10}, find:\n1.",
    "𝐴∪𝐵.\n2. 𝐴∩𝐵.\n3.",
    "𝐵∩𝐶.\n4. 𝐴∩𝐷.\n5.",
    "𝐵∪𝐶.\n6. 𝐴\\ 𝐵.\n7. (𝐷∩𝐶) ∪𝐴∩𝐵.\n8.",
    "∅∪𝐶.\n9.",
    "∅∩𝐶.\nSolution.\n",
    "1. 𝐴∪𝐵= {1, 2, 3, 4, 5, 6} = 𝐴since everything in 𝐵is already in 𝐴.\n2. 𝐴∩𝐵= {2, 4, 6} = 𝐵since everything in 𝐵is in 𝐴.\n3. 𝐵∩𝐶= {2} as the only element of both 𝐵and 𝐶is 2.\n\n5.1.",
    "Sets\n397\n4. 𝐴∩𝐷= ∅since",
    "𝐴and",
    "𝐷have no common elements.\n",
    "5. 𝐵∪𝐶= {5, 7, 8, 9, 10}.",
    "First we find that 𝐵∪𝐶= {1, 2, 3, 4, 6}, and then\nwe take everything not in that set.\n",
    "6. 𝐴\\ 𝐵= {1, 3, 5} since the elements 1, 3, and 5 are in 𝐴but not in 𝐵. This\nis the same as 𝐴∩𝐵.\n7.",
    "(𝐷∩𝐶) ∪𝐴∩𝐵= {1, 3, 5, 7, 8, 9, 10}.",
    "The set contains all elements that\nare either in 𝐷but not in 𝐶(i.e., {7, 8, 9}), or not in both 𝐴and 𝐵(i.e.",
    ",\n{1, 3, 5, 7, 8, 9, 10}).\n",
    "8.",
    "∅∪𝐶= 𝐶since nothing is added by the empty set.\n",
    "9.",
    "∅∩𝐶= ∅since nothing can be both in a set and in the empty set.\n",
    "Having notation like this is useful.",
    "We will often want to add or remove elements\nfrom sets, and our notation allows us to do so precisely.\n",
    "Example 5.1.7\nIf 𝐴= {1, 2, 3}, then we can describe the set we get by adding the number 4\nas 𝐴∪{4}.",
    "If we want to express the set we get by removing the number 2\nfrom 𝐴, we can do so by writing 𝐴\\ {2}.\n",
    "Careful though.",
    "If you add an element to the set, you get a new set!",
    "So\nyou would have 𝐵= 𝐴∪{4} and then correctly say that 𝐵contains 4, but 𝐴\ndoes not.\n",
    "There is one more way to combine sets that will be useful for us: the Cartesian\nproduct, 𝐴× 𝐵.",
    "This sounds fancy but is nothing you haven’t seen before.",
    "When\nyou graph a function in calculus, you graph it in the Cartesian plane.",
    "This is the set\nof all ordered pairs of real numbers (𝑥, 𝑦).",
    "We can do this for any pair of sets, not\njust the real numbers with themselves.\n",
    "Put another way, 𝐴× 𝐵= {(𝑎, 𝑏) : 𝑎∈𝐴and 𝑏∈𝐵}.",
    "The first coordinate comes\nfrom the first set, and the second coordinate comes from the second set.",
    "Sometimes\nwe will want to take the Cartesian product of a set with itself, and this is fine:\n𝐴× 𝐴= {(𝑎, 𝑏) : 𝑎, 𝑏∈𝐴} (we might also write 𝐴2 for this set).",
    "Notice that in 𝐴× 𝐴,\nwe still want all ordered pairs, not just the ones where the first and second coordinate\nare the same.",
    "We can also take products of 3 or more sets, getting ordered triples, or\nquadruples, and so on.\n",
    "Example 5.1.8\nLet 𝐴= {1, 2} and 𝐵= {3, 4, 5}.",
    "Find 𝐴× 𝐵and 𝐴× 𝐴.",
    "How many elements\ndo you expect to be in 𝐵× 𝐵?\n\n398\n5.",
    "Discrete Structures Revisited\nSolution.\n",
    "𝐴× 𝐵= {(1, 3), (1, 4), (1, 5), (2, 3), (2, 4), (2, 5)}.\n",
    "𝐴× 𝐴= 𝐴2 = {(1, 1), (1, 2), (2, 1), (2, 2)}.\n",
    "|𝐵× 𝐵| = 9.",
    "There will be 3 pairs with first coordinate 3, three more with\nfirst coordinate 4, and a final three with first coordinate 5.\n",
    "5.1.4\nVenn Diagrams\nThere is a very nice visual tool we can use to represent operations on sets.",
    "A Venn\ndiagram displays sets as intersecting circles.",
    "We can shade the region we are talking\nabout when we carry out an operation.",
    "We can also represent the cardinality of a\nparticular set by putting the number in the corresponding region.\n",
    "𝐴\n𝐵\n𝐴\n𝐵\n𝐶\nEach circle represents a set.",
    "The rectangle containing the circles represents the\nuniverse.",
    "To represent combinations of these sets, we shade the corresponding\nregion.",
    "For example, we could draw 𝐴∩𝐵as:\n𝐴\n𝐵\nHere is a representation of 𝐴∩𝐵, or equivalently 𝐴\\ 𝐵:\n𝐴\n𝐵\nA more complicated example is (𝐵∩𝐶) ∪(𝐶∩𝐴), as seen below.\n\n5.1.",
    "Sets\n399\n𝐴\n𝐵\n𝐶\nNotice that the shaded regions above could also be arrived at in another way.\n",
    "We could have started with all of 𝐶and then excluded the region where 𝐶and 𝐴\noverlap outside of 𝐵. That region is (𝐴∩𝐶) ∩𝐵.",
    "So the above Venn diagram also\nrepresents 𝐶∩\n\u0010\n(𝐴∩𝐶) ∩𝐵\n\u0011\n.",
    "So using just the picture, we have determined that\n(𝐵∩𝐶) ∪(𝐶∩𝐴) = 𝐶∩\n\u0010\n(𝐴∩𝐶) ∩𝐵\n\u0011\n.\n",
    "5.1.5\nExercises\n1.\n𝐴= {2, 4, 5, 6, 7} and 𝐵= {2, 4, 5, 6, 8} Find each of the following sets.\n",
    "Your answers should include the curly braces\na. 𝐴∪𝐵.\nb. 𝐴∩𝐵.\nc. 𝐴\\ 𝐵.\nd. 𝐵\\ 𝐴.\n2.\nFind the least element of the following sets, if there is one.\n",
    "a. {𝑛∈ℕ: 𝑛2 −3",
    "≥4}\nb. {𝑛∈ℕ: 𝑛2 −7 ∈ℕ}\nc. {𝑛2 + 4 : 𝑛∈ℕ}\nd. {𝑛∈ℕ: 𝑛= 𝑘2 + 4 for some 𝑘∈ℕ}\n3.\nFind the following cardinalities.\na. |𝐴|",
    "when 𝐴= {4, 5, 6, 7, . . .",
    ", 33}.\n",
    "b. |𝐴|",
    "when 𝐴= {𝑥∈ℤ: −7 ≤𝑥≤91”}.\n",
    "c. |𝐴∩𝐵|",
    "when 𝐴= {𝑥∈ℕ: 𝑥≤27} and 𝐵= {𝑥∈ℕ: 𝑥is prime }.\n",
    "4.\nLet 𝐴= {8, 10, 11, 12, 13} and 𝐵= {8, 16, 17, 24, 32}.",
    "Find a set of largest\npossible size that is a subset of both 𝐴and 𝐵.\n5.\nFind a set of smallest possible size that has both {4,6,7,9} and {5,6,7,9,10} as\nsubsets.\n\n400\n5.",
    "Discrete Structures Revisited\n6.\n",
    "Let 𝐴= {𝑛∈ℕ: 39",
    "≤𝑛< 55} and 𝐵= {𝑛∈ℕ: 16 < 𝑛≤44}.",
    "Suppose 𝐶is a\nset such that 𝐶⊆𝐴and 𝐶⊆𝐵.",
    "What is the largest possible cardinality of 𝐶?\n7.\n",
    "Let 𝐴= {1, 4, 7, 12, 14} and 𝐵= {1, 4, 14}.",
    "How many sets 𝐶have the property\nthat 𝐶⊆𝐴and 𝐵⊆𝐶.\n8.\n",
    "Let 𝐴= {2, 3, 4, 5, 6}, 𝐵= {4, 5, 6, 7, 8}, and 𝐶= {3, 6, 8}.\n",
    "a. Find 𝐴∩𝐵.\nb.",
    "Find 𝐴∪𝐵.\nc. Find",
    "𝐴\\ 𝐵.\nd. Find 𝐴∩(𝐵∪𝐶).\n",
    "9.\nLet 𝐴= {𝑥∈ℕ: 2",
    "≤𝑥< 14} and 𝐵= {𝑥∈ℕ: 𝑥is even}.\na. Find 𝐴∩𝐵.\nb.",
    "Find 𝐴\\ 𝐵.\n10.\n",
    "Let 𝐴= {𝑥∈ℕ: 3 ≤𝑥≤13}, 𝐵= {𝑥∈ℕ: 𝑥is even}, and 𝐶= {𝑥∈ℕ:\n𝑥is odd}.\n",
    "(a) Find 𝐴∩𝐵.\n(b) Find 𝐴∪𝐵.\n(c) Find 𝐵∩𝐶.\n(d) Find 𝐵∪𝐶.\n11.\nFind an example of sets 𝐴and 𝐵such that 𝐴∩𝐵= {3, 5} and 𝐴∪𝐵=\n{2, 3, 5, 7, 8}.\n12.\n",
    "Find an example of sets 𝐴and 𝐵such that 𝐴⊆𝐵and 𝐴∈𝐵.\n13.\nRecall ℤ= {. . .",
    ", −2, −1, 0, 1, 2, . . .}",
    "(the integers).",
    "Let ℤ+ = {1, 2, 3, . . .}",
    "be the\npositive integers.",
    "Let 2ℤbe the even integers, 3ℤbe the multiples of 3, and so\non.\n",
    "(a) Is ℤ+ ⊆2ℤ?",
    "Explain.\n",
    "(b) Is 2ℤ⊆ℤ+?",
    "Explain.\n",
    "(c) Find 2ℤ∩3ℤ. Describe the set in words, and using set notation.\n",
    "(d) Express {𝑥∈ℤ: ∃𝑦∈ℤ(𝑥= 2𝑦∨𝑥= 3𝑦)} as a union or intersection of\ntwo sets already described in this problem.\n",
    "14.\n",
    "Let 𝐴2 be the set of all multiples of 2 except for 2.",
    "Let 𝐴3 be the set of all\nmultiples of 3 except for 3.",
    "And so on, so that 𝐴𝑛is the set of all multiples of 𝑛\nexcept for 𝑛, for any 𝑛≥2.",
    "Describe (in words) the set 𝐴2 ∪𝐴3 ∪𝐴4 ∪· · ·.\n\n5.1.",
    "Sets\n401\n15.\n",
    "Draw a Venn diagram to represent each of the following:\n(a) 𝐴∪𝐵\n(b) (𝐴∪𝐵)\n(c) 𝐴∩(𝐵∪𝐶)\n(d) (𝐴∩𝐵) ∪𝐶\n(e) 𝐴∩𝐵∩𝐶\n(f) (𝐴∪𝐵) \\ 𝐶\n16.\nDescribe a set in terms of 𝐴and 𝐵(using set notation) which has the following\nVenn diagram:\n𝐴\n𝐵\n17.\n",
    "Let 𝐴= {𝑎, 𝑏, 𝑐, 𝑑}.",
    "Find 𝒫(𝐴).\n",
    "18.\n",
    "Let 𝐴= {1, 2, . .",
    ".",
    ", 9}.",
    "How many subsets of 𝐴contain exactly one element (i.e.,\nhow many singleton subsets are there)?\n",
    "How many doubleton subsets (containing exactly two elements) are there?\n19.\n",
    "Let 𝐴= {1, 2, 3, 4, 5, 6}.",
    "Find all sets 𝐵∈𝒫(𝐴) which have the property\n{2, 3, 5} ⊆𝐵.\n20.\nFind an example of sets 𝐴and 𝐵such that |𝐴| = 4, |𝐵| = 5, and |𝐴∪𝐵|",
    "= 9.\n21.\n",
    "Find an example of sets 𝐴and 𝐵such that |𝐴| = 3, |𝐵| = 4, and |𝐴∪𝐵|",
    "= 5.\n22.\n",
    "Are there sets 𝐴and 𝐵such that |𝐴| = |𝐵|, |𝐴∪𝐵| = 10, and |𝐴∩𝐵|",
    "= 5?\nExplain.\n",
    "23.\n",
    "Let 𝐴= {2, 4, 6, 8}.",
    "Suppose 𝐵is a set with |𝐵| = 5.\na.",
    "What are the smallest and largest possible values of |𝐴∪𝐵|?",
    "Explain.\n",
    "b.",
    "What are the smallest and largest possible values of |𝐴∩𝐵|?",
    "Explain.\n",
    "c. What are the smallest and largest possible values of |𝐴× 𝐵|?",
    "Explain.\n",
    "24.\nLet 𝑋= {𝑛∈ℕ: 10 ≤𝑛< 20}.",
    "Find examples of sets with the properties\nbelow and very briefly explain why your examples work.\n",
    "(a) A set 𝐴⊆ℕwith |𝐴|",
    "= 10 such that 𝑋\\ 𝐴= {10, 12, 14}.\n",
    "(b) A set 𝐵∈𝒫(𝑋) with |𝐵| = 5.\n(c) A set 𝐶⊆𝒫(𝑋) with |𝐶| = 5.\n\n402\n5.",
    "Discrete Structures Revisited\n(d)",
    "A set 𝐷⊆𝑋× 𝑋with |𝐷| = 5\n(e) A set 𝐸⊆𝑋such that |𝐸| ∈𝐸.\n25.\n",
    "Let 𝐴, 𝐵, and 𝐶be sets.\n",
    "(a) Suppose that 𝐴⊆𝐵and 𝐵⊆𝐶. Does this mean that 𝐴⊆𝐶?",
    "Prove your\nanswer.",
    "Hint: To prove that 𝐴⊆𝐶, you must prove the implication, “For\nall 𝑥, if 𝑥∈𝐴, then 𝑥∈𝐶.”\n(b) Suppose that 𝐴∈𝐵and 𝐵∈𝐶. Does this mean that 𝐴∈𝐶?",
    "Give an\nexample to prove that this does NOT always happen (and explain why\nyour example works).",
    "You should be able to give an example where\n|𝐴| = |𝐵| = |𝐶| = 2.\n26.\n",
    "In a regular deck of playing cards there are 26 red cards and 12 face cards.\n",
    "Explain, using sets and what you have learned about cardinalities, why there\nare only 32 cards which are either red or a face card.\n",
    "27.\nFind an example of a set 𝐴with |𝐴| = 3 which contains only other sets and has\nthe following property: For all sets 𝐵∈𝐴, we also have 𝐵⊆𝐴. Explain why\nyour example works.",
    "(FYI: Sets that have this property are called transitive.)\n",
    "28.\nConsider the sets 𝐴and 𝐵, where 𝐴= {3, |𝐵|} and 𝐵= {1, |𝐴|, |𝐵|}.",
    "What are\nthe sets?\n29.\nExplain why there is no set 𝐴which satisfies 𝐴= {2, |𝐴|}.\n",
    "30.\nFind all sets 𝐴, 𝐵, and 𝐶which satisfy the following.\n",
    "𝐴={1, |𝐵| , |𝐶|}\n𝐵={2, |𝐴| , |𝐶|}\n𝐶={1, 2, |𝐴| , |𝐵|}\n.\n\n",
    "5.2\nFunctions\nThis section contains many details about functions, much of which should be\nfamiliar from non-discrete contexts.",
    "As you read, consider how the way we talk\nabout functions here might be different from what you know from other areas of\nmathematics.\n",
    "A function is a rule that assigns each input exactly one output.",
    "We call the\noutput the image of the input.",
    "The set of all inputs for a function is called the\ndomain.",
    "The set of all allowable outputs is called the codomain.",
    "We would write\n𝑓: 𝑋→𝑌to describe a function with name 𝑓, domain 𝑋, and codomain 𝑌.",
    "This\ndoes not tell us which function 𝑓is though.",
    "To define the function, we must describe\nthe rule.",
    "This is often done by giving a formula to compute the output for any input\n(although this is certainly not the only way to describe the rule).\n",
    "For example, consider the function 𝑓: ℕ→ℕdefined by 𝑓(𝑥) = 𝑥2 + 3.",
    "Here the\ndomain and codomain are the same set (the natural numbers).",
    "The rule: Take your\ninput, multiply it by itself, and add 3.",
    "This works because we can apply this rule\nto every natural number (every element of the domain) and the result is always a\nnatural number (an element of the codomain).",
    "Notice though that not every natural\nnumber is actually an output (there is no way to get 0, 1, 2, 5, etc.).",
    "The set of natural\nnumbers that are outputs is called the range of the function (in this case, the range is\n{3, 4, 7, 12, 19, 28, . . .",
    "}, all the natural numbers that are 3 more than a perfect square).\n",
    "The key thing that makes a rule a function is that there is exactly one output for\neach input.",
    "That is, it is important that the rule be a good rule.",
    "What output do we\nassign to the input 7?",
    "There can only be one answer for any particular function.\n",
    "Example 5.2.1\nThe following are all examples of functions:\n1. 𝑓: ℤ→ℤdefined by 𝑓(𝑛) =",
    "3𝑛.",
    "The domain and codomain are both\nthe set of integers.",
    "However, the range is only the set of integer multiples\nof 3.\n2. 𝑔: {1, 2, 3} →{𝑎, 𝑏, 𝑐} defined by 𝑔(1)",
    "= 𝑐, 𝑔(2) = 𝑎, and 𝑔(3)",
    "= 𝑎.",
    "The\ndomain is the set {1, 2, 3}, the codomain is the set {𝑎, 𝑏, 𝑐} and the range\nis the set {𝑎, 𝑐}.",
    "Note that 𝑔(2) and 𝑔(3) are the same element of the\ncodomain.",
    "This is okay since each element in the domain still has only\none output.\n",
    "3.",
    "ℎ: {1, 2, 3, 4} →ℕdefined by the table:\n𝑥\n1\n2\n3\n4\nℎ(𝑥)\n3\n6\n9\n12\nHere the domain is the finite set {1, 2, 3, 4}, and the codomain is the set\nof natural numbers, ℕ. At first you might think this function is the same\n403\n\n404\n5.",
    "Discrete Structures Revisited\nas 𝑓defined above.",
    "It absolutely is not.",
    "Even though the rule is the\nsame, the domain and codomain are different, so these are two different\nfunctions.\n",
    "Example 5.2.2\nJust because you can describe a rule in the same way you would write a\nfunction does not mean that the rule is a function.",
    "The following are NOT\nfunctions.\n",
    "1.",
    "𝑓: ℕ→ℕdefined by 𝑓(𝑛) = 𝑛\n2 .",
    "The reason this is not a function is\nbecause not every input has an output.",
    "Where does 𝑓send 3?",
    "The rule\nsays that 𝑓(3) = 3\n2, but 3\n2 is not an element of the codomain.\n",
    "2. Consider the rule that matches each person to their phone number.\n",
    "If you think of the set of people as the domain and the set of phone\nnumbers as the codomain, then this is not a function, since some people\nhave two phone numbers.",
    "Switching the domain and codomain sets\ndoesn’t help either, since some phone numbers belong to multiple\npeople (assuming some households still have landlines when you are\nreading this).\n",
    "5.2.1\nDescribing Functions\nIt is worth making a distinction between a function and its description.",
    "The function\nis the abstract mathematical object that in some way exists whether or not anyone\never talks about it.",
    "But when we do want to talk about the function, we need a way\nto describe it.",
    "A particular function can be described in multiple ways.\n",
    "Some calculus textbooks talk about the Rule of Four, that every function can be\ndescribed in four ways: algebraically (a formula), numerically (a table), graphically,\nor in words.",
    "In discrete math, we can still use any of these to describe functions, but\nwe can also be more specific since we are primarily concerned with functions that\nhave ℕor a finite subset of ℕas their domain.\n",
    "Describing a function graphically usually means drawing the graph of the\nfunction: plotting the points on the plane.",
    "We can do this and might get a graph\nlike the following for a function 𝑓: {1, 2, 3} →{1, 2, 3}.\n\n5.2.",
    "Functions\n405\nIt would be absolutely WRONG to connect the dots or try to fit them to some\ncurve.",
    "There are only three elements in the domain.",
    "A curve would mean that the\ndomain contains an entire interval of real numbers.\n",
    "Here is another way to represent that same function:\n1\n2\n2\n1\n3\n3\nThis shows that the function 𝑓sends 1 to 2, 2 to 1, and 3 to 3: Just follow the\narrows.\n",
    "The arrow diagram used to define the function above can be very helpful in\nvisualizing functions.",
    "We will often be working with functions with finite domains,\nso this kind of picture is often more useful than a traditional graph of a function.\n",
    "Note that for finite domains, finding an algebraic formula that gives the output\nfor any input is often impossible.",
    "Of course we could use a piecewise-defined\nfunction, like\n𝑓(𝑥) =\n\n\n𝑥+ 1\nif 𝑥= 1\n𝑥−1\nif 𝑥= 2\n𝑥\nif 𝑥= 3\n.\n",
    "This describes exactly the same function as above, but we can all agree is a ridiculous\nway of doing so.\n",
    "Since we will so often use functions with small domains and codomains, let’s\nadopt some notation to describe them.",
    "All we need is some clear way of denoting\nthe image of each element in the domain.",
    "In fact, writing a table of values would\nwork perfectly:\n𝑥\n0\n1\n2\n3\n4\n𝑓(𝑥)\n3\n3\n2\n4\n1\nWe simplify this further by writing this as a “matrix” with each input directly over\nits output:\n𝑓=\n\u0012\n0\n1\n2\n3\n4\n3\n3\n2\n4\n1\n\u0013\n.\n\n406\n5.",
    "Discrete Structures Revisited\nNote this is just notation and not the same sort of matrix you would find in a linear\nalgebra class (it does not make sense to do operations with these matrices, or row\nreduce them, for example).\n",
    "One advantage of the two-line notation over the arrow diagrams is that it is\nharder to accidentally define a rule that is not a function using two-line notation.\n",
    "Example 5.2.3\nWhich of the following diagrams represent a function?",
    "Let 𝑋= {1, 2, 3, 4}\nand 𝑌= {𝑎, 𝑏, 𝑐, 𝑑}.\n",
    "1\n𝑑\n2\n𝑎\n3\n𝑐\n4\n𝑏\n𝑓: 𝑋→𝑌\n1\n𝑑\n2\n𝑎\n3\n4\n𝑏\n𝑐\n𝑔: 𝑋→𝑌\n1\n2\n𝑎\n3\n𝑑\n4\n𝑏\n𝑐\nℎ: 𝑋→𝑌\nSolution.\n",
    "𝑓is a function.",
    "So is 𝑔.",
    "There is no problem with an element of\nthe codomain not being the image of any input, and there is no problem with\n𝑎from the codomain being the image of both 2 and 3 from the domain.",
    "We\ncould use our two-line notation to write these as\n𝑓=\n\u0012\n1\n2\n3\n4\n𝑑\n𝑎\n𝑐\n𝑏\n\u0013\n𝑔=\n\u0012\n1\n2\n3\n4\n𝑑\n𝑎\n𝑎\n𝑏\n\u0013\n.\n",
    "However, ℎis NOT a function.",
    "In fact, it fails for two reasons.",
    "First, the\nelement 1 from the domain has not been mapped to any element from the\ncodomain.",
    "Second, the element 2 from the domain has been mapped to more\nthan one element from the codomain (𝑎and 𝑐).",
    "Note that either one of these\nproblems is enough to make a rule not a function.",
    "In general, neither of the\nfollowing mappings are functions:\nIt might also be helpful to think about how you would write the two-line\nnotation for ℎ. We would have something like:\nℎ=\n\u0012\n1\n2\n3\n4\n𝑎, 𝑐?\n𝑑\n𝑏\n\u0013\n.\n",
    "There is nothing under 1 (bad), and we needed to put more than one thing\nunder 2 (very bad).",
    "With a rule that is actually a function, the two-line\nnotation will always “work.”\n\n5.2.",
    "Functions\n407\nWe will also be interested in functions with domain ℕ. Here two-line notation is\nno good, but describing the function algebraically is often possible.",
    "Even tables are\na little awkward since they do not describe the function completely.",
    "For example,\nconsider the function 𝑓: ℕ→ℕgiven by the table below.\n",
    "𝑥\n0\n1\n2\n3\n4\n5\n. . .\n",
    "𝑓(𝑥)\n0\n1\n4\n9\n16\n25\n. .",
    ".\n",
    "Have I given you enough entries for you to be able to determine 𝑓(6)?",
    "You might\nguess that 𝑓(6) = 36, but there is no way for you to know this for sure.",
    "Maybe I am\nbeing a jerk and intended 𝑓(6)",
    "= 42.",
    "In fact, for every natural number 𝑛, there is a\nfunction that agrees with the table above, but for which 𝑓(6) = 𝑛.\nOkay, suppose I really did mean for 𝑓(6)",
    "= 36, and in fact, for the rule that you\nthink is governing the function to actually be the rule.",
    "Then I should say what that\nrule is.",
    "𝑓(𝑛) = 𝑛2.",
    "Now there is no confusion possible.\n",
    "Giving an explicit formula that calculates the image of any element in the domain\nis a great way to describe a function.",
    "We will say that these explicit rules are closed\nformulas for the function.\n",
    "There is another very useful way to describe functions whose domain is ℕ, that\nrely specifically on the structure of the natural numbers.",
    "We can define a function\nrecursively!\n",
    "Example 5.2.4\nConsider the function 𝑓: ℕ→ℕgiven by 𝑓(0) = 0 and 𝑓(𝑛+1)",
    "= 𝑓(𝑛)+2𝑛+1.\n",
    "Find 𝑓(6).\n",
    "Solution.\n",
    "The rule says that 𝑓(6) = 𝑓(5)+11 (we are using 6 = 𝑛+1 so 𝑛= 5).\n",
    "We don’t know what 𝑓(5) is though.",
    "Well, we know that 𝑓(5) = 𝑓(4)",
    "+ 9.",
    "So\nwe need to compute 𝑓(4), which will require knowing 𝑓(3), which will require\nknowing𝑓(2),. . .",
    "will it ever end?\n",
    "Yes!",
    "This process will always end because we have ℕas our domain, so\nthere is a least element.",
    "And we gave the value of 𝑓(0) explicitly, so we are\ngood.",
    "We might decide to work up to 𝑓(6) instead of working down from\n𝑓(6):\n𝑓(1) = 𝑓(0)",
    "+ 1 =\n0",
    "+ 1 = 1\n𝑓(2)",
    "= 𝑓(1)",
    "+ 3 =\n1 + 3 = 4\n𝑓(3)",
    "=𝑓(2)",
    "+ 5 =\n4 + 5 = 9\n𝑓(4) =𝑓(3)",
    "+ 7 =\n9 + 7 = 16\n𝑓(5) =𝑓(4)",
    "+ 9 =\n16 + 9 = 25\n𝑓(6) =𝑓(5)",
    "+ 11 =\n25 + 11 = 36\n",
    "It looks like this recursively defined function is the same as the explicitly\ndefined function 𝑓(𝑛) = 𝑛2.",
    "Is it?",
    "Later we will prove that it is.\n\n",
    "408\n5.",
    "Discrete Structures Revisited\nRecursively defined functions are often easier to create from a “real-world”\nproblem, because they describe how the values of the functions are changing.\n",
    "However, this comes with a price.",
    "It is harder to calculate the image of a single input,\nsince you need to know the images of other (previous) elements in the domain.\n",
    "Recursively Defined Functions.\n",
    "For a function 𝑓: ℕ→ℕ, a recursive definition consists of an initial\ncondition together with a recurrence relation.",
    "The initial condition is the\nexplicitly given value of 𝑓(0).",
    "The recurrence relation is a formula for 𝑓(𝑛+ 1)\nin terms of 𝑓(𝑛) (and possibly 𝑛itself).\n",
    "Example 5.2.5\nGive recursive definitions for the functions described below.\n",
    "1.",
    "𝑓: ℕ→ℕgives the number of snails in your terrarium 𝑛years after\nyou built it, assuming you started with 3 snails and the number of snails\ndoubles each year.\n",
    "2. 𝑔: ℕ→ℕgives the number of push-ups you do 𝑛days after you\nstarted your push-ups challenge, assuming you could do 7 push-ups on\nday 0",
    "and you can do 2 more push-ups each day.\n",
    "3.",
    "ℎ: ℕ→ℕdefined by ℎ(𝑛) = 𝑛!.",
    "Recall that 𝑛! = 1 · 2 · 3 · · · · · (𝑛−1) · 𝑛\nis the product of all numbers from 1 through 𝑛. We also define 0!",
    "= 1.\nSolution.\n",
    "1.",
    "The initial condition is 𝑓(0)",
    "= 3.",
    "To get 𝑓(𝑛+ 1), we would double the\nnumber of snails in the terrarium the previous year, which is given by\n𝑓(𝑛).",
    "Thus 𝑓(𝑛+ 1) = 2𝑓(𝑛).",
    "The full recursive definition contains both\nof these and would be written,\n𝑓(0) = 3; 𝑓(𝑛+ 1) = 2 𝑓(𝑛).\n",
    "2.",
    "We are told that on day 0 you can do 7 push-ups, so 𝑔(0)",
    "= 7.",
    "The\nnumber of push-ups you can do on day 𝑛+ 1 is 2 more than the number\nyou can do on day 𝑛, which is given by 𝑔(𝑛).",
    "Thus\n𝑔(0) = 7; 𝑔(𝑛+ 1) = 𝑔(𝑛)",
    "+ 2.\n",
    "3. Here ℎ(0)",
    "= 1.",
    "To get the recurrence relation, think about how you can\nget ℎ(𝑛+ 1) = (𝑛+ 1)!",
    "from ℎ(𝑛) = 𝑛!.",
    "If you write out both of these as\nproducts, you see that (𝑛+ 1)!",
    "is just like 𝑛! except that you have one\nmore term in the product, an extra 𝑛+ 1.",
    "So we have,\nℎ(0)",
    "= 1; ℎ(𝑛+ 1) = (𝑛+ 1) · ℎ(𝑛).\n\n",
    "5.2.",
    "Functions\n409\n5.2.2\nSurjections, Injections, and Bijections\nWe now turn to investigating special properties functions might or might not possess.\n",
    "In the examples above, you may have noticed that sometimes there are elements\nof the codomain that are not in the range.",
    "When this sort of thing does not happen\n(that is, when everything in the codomain is in the range), we say the function is\nonto or that the function maps the domain onto the codomain.",
    "This terminology\nshould make sense: The function puts the domain (entirely) on top of the codomain.\n",
    "The fancy math term for an onto function is a surjection, and we say that an onto\nfunction is a surjective function.\n",
    "In pictures:\nSurjective\nNot surjective\nExample 5.2.6\n",
    "Which functions are surjective (i.e., onto)?",
    "\n1. 𝑓: ℤ→ℤdefined by 𝑓(𝑛) = 3𝑛.\n2. 𝑔: {1, 2, 3} →{𝑎, 𝑏, 𝑐} defined by 𝑔=\n\u0012\n1\n2\n3\n𝑐\n𝑎\n𝑎\n\u0013\n.\n",
    "3.",
    "ℎ: {1, 2, 3} →{1, 2, 3} defined as follows:\n1\n2\n2\n1\n3\n3\nSolution.\n",
    "1. 𝑓is not surjective.",
    "There are elements in the codomain that are not in\nthe range.",
    "For example, no 𝑛∈ℤgets mapped to the number 1 (the\nrule would say that 1\n3 would be sent to 1, but 1\n3 is not in the domain).",
    "In\nfact, the range of the function is 3ℤ(the integer multiples of 3), which is\nnot equal to ℤ.\n2. 𝑔is not surjective.",
    "There is no 𝑥∈{1, 2, 3} (the domain) for which\n𝑔(𝑥)",
    "= 𝑏, so 𝑏, which is in the codomain, is not in the range.",
    "Notice that\nthere is an element from the codomain “missing” from the bottom row\nof the matrix.\n\n410\n5.",
    "Discrete Structures Revisited\n3.",
    "ℎis surjective.",
    "Every element of the codomain is also in the range.\n",
    "Nothing in the codomain is missed.\n",
    "To be a function, a rule cannot assign a single element of the domain to two or\nmore different elements of the codomain.",
    "However, we have seen that the reverse is\npermissible: A function might assign the same element of the codomain to two or\nmore different elements of the domain.",
    "When this does not occur (that is, when each\nelement of the codomain is the image of at most one element of the domain), then we\nsay the function is one-to-one.",
    "Again, this terminology makes sense: We are sending\nat most one element from the domain to one element from the codomain.",
    "One input\nto one output.",
    "The fancy math term for a one-to-one function is an injection.",
    "We\ncall one-to-one functions injective functions.\n",
    "In pictures:\nInjective\nNot injective\nExample 5.2.7\nWhich functions are injective (i.e., one-to-one)?\n1. 𝑓: ℤ→ℤdefined by 𝑓(𝑛) = 3𝑛.\n2. 𝑔: {1, 2, 3} →{𝑎, 𝑏, 𝑐} defined by 𝑔=\n\u0012\n1\n2\n3\n𝑐\n𝑎\n𝑎\n\u0013\n.\n",
    "3.",
    "ℎ: {1, 2, 3} →{1, 2, 3} defined as follows:\n1\n2\n2\n1\n3\n3\nSolution.\n",
    "1.",
    "𝑓is injective.",
    "Each element in the codomain is assigned to at most\none element from the domain.",
    "If 𝑥is a multiple of three, then only\n𝑥/3 is mapped to 𝑥. If 𝑥is not a multiple of 3, then there is no input\ncorresponding to the output 𝑥.\n",
    "2. 𝑔is not injective.",
    "Both inputs 2 and 3 are assigned the output 𝑎.",
    "Notice\nthat there is an element from the codomain that appears more than once\non the bottom row of the matrix.\n\n",
    "5.2.",
    "Functions\n411\n3. ℎis injective.",
    "Each output is only an output once.\n",
    "Be careful: “surjective” and “injective” are NOT opposites.",
    "You can see in the\ntwo examples above that there are functions that are surjective but not injective,\ninjective but not surjective, both, or neither.",
    "In the case when a function is both\none-to-one and onto (an injection and surjection), we say the function is a bĳection,\nor that the function is a bĳective function.\n",
    "To illustrate the contrast between these two properties, consider a more formal\ndefinition of each, side by side.\n",
    "Injective vs. Surjective.\n",
    "A function is injective provided every element of the codomain is the\nimage of at most one element from the domain.\n",
    "A function is surjective provided every element of the codomain is the\nimage of at least one element from the domain.\n",
    "Notice both properties are determined by what happens to elements of the\ncodomain: They could be repeated as images, or they could be “missed” (not\nbe images).",
    "Injective functions do not have repeats but might or might not miss\nelements.",
    "Surjective functions do not miss elements, but might or might not have\nrepeats.",
    "The bĳective functions are those that do not have repeats and do not miss\nelements.\n",
    "5.2.3\nImage and Inverse Image\n",
    "When discussing functions, we have notation for talking about an element of the\ndomain (say 𝑥) and its corresponding element in the codomain (we write 𝑓(𝑥), which\nis the image of 𝑥).",
    "Sometimes we will want to talk about all the elements that are\nimages of some subset of the domain.",
    "It would also be nice to start with some\nelement of the codomain (say 𝑦) and talk about which element or elements (if any)\nfrom the domain it is the image of.",
    "We could write “those 𝑥in the domain such that\n𝑓(𝑥) = 𝑦,” but this is a lot of writing.",
    "Here is some notation to make our lives easier.\n",
    "To address the first situation, what we are after is a way to describe the set of\nimages of elements in some subset of the domain.",
    "Suppose 𝑓: 𝑋→𝑌is a function\nand that 𝐴⊆𝑋is some subset of the domain (possibly all of it).",
    "We will use the\nnotation 𝑓(𝐴) to denote the image of 𝐴under 𝑓, namely the set of elements in 𝑌\nthat are the image of elements from 𝐴. That is, 𝑓(𝐴) = { 𝑓(𝑎) ∈𝑌: 𝑎∈𝐴}.\n",
    "We can do this in the other direction as well.",
    "We might ask which elements of\nthe domain get mapped to a particular set in the codomain.",
    "Let 𝑓: 𝑋→𝑌be a\nfunction and suppose 𝐵⊆𝑌is a subset of the codomain.",
    "Then we will write 𝑓−1(𝐵)\nfor the inverse image of 𝐵under 𝑓, namely the set of elements in 𝑋whose image\nare elements in 𝐵. In other words, 𝑓−1(𝐵) = {𝑥∈𝑋: 𝑓(𝑥) ∈𝐵} .\n",
    "Often we are interested in the element(s) whose image is a particular element 𝑦\n\n412\n5.",
    "Discrete Structures Revisited\nof in the codomain.",
    "The notation above works: 𝑓−1({𝑦}) is the set of all elements in\nthe domain that 𝑓sends to 𝑦. It makes sense to think of this as a set: there might\nnot be anything sent to 𝑦(if 𝑦is not in the range), in which case 𝑓−1({𝑦}) = ∅. Or 𝑓\nmight send multiple elements to 𝑦(if 𝑓is not injective).",
    "As a notational convenience,\nwe usually drop the set braces around the 𝑦and write 𝑓−1(𝑦) instead for this set.\n",
    "WARNING: 𝑓−1(𝑦) is not an inverse function!",
    "Inverse functions only exist for\nbĳections, but 𝑓−1(𝑦) is defined for any function 𝑓.",
    "The point: 𝑓−1(𝑦) is a set, not an\nelement of the domain.",
    "This is just sloppy notation for 𝑓−1({𝑦}).",
    "To help make this\ndistinction, we would call 𝑓−1(𝑦) the complete inverse image of 𝑦under 𝑓.",
    "It is not\nthe image of 𝑦under 𝑓−1 (since the function 𝑓−1 might not exist).\n",
    "Example 5.2.8\nConsider the function 𝑓: {1, 2, 3, 4, 5, 6} →{𝑎, 𝑏, 𝑐, 𝑑} given by\n𝑓=\n\u0012\n1\n2\n3\n4\n5\n6\n𝑎\n𝑎\n𝑏\n𝑏\n𝑏\n𝑐\n\u0013\n.\n",
    "Find 𝑓({1, 2, 3}), 𝑓−1({𝑎, 𝑏}), and 𝑓−1(𝑑).\n",
    "Solution.\n",
    "𝑓({1, 2, 3}) = {𝑎, 𝑏} since 𝑎and 𝑏are the elements in the codomain\nto which 𝑓sends 1, 2, and 3.\n𝑓−1({𝑎, 𝑏})",
    "= {1, 2, 3, 4, 5} since these are exactly the elements that 𝑓sends\nto 𝑎and 𝑏.\n𝑓−1(𝑑) = ∅since 𝑑is not in the range of 𝑓.\nExample 5.2.9\nConsider the function 𝑔: ℤ→ℤdefined by 𝑔(𝑛) = 𝑛2 + 1.",
    "Find 𝑔(1) and\n𝑔({1}).",
    "Then find 𝑔−1(1), 𝑔−1(2), and 𝑔−1(3).\n",
    "Solution.\n",
    "Note that 𝑔(1) ≠𝑔({1}).",
    "The first is an element: 𝑔(1)",
    "= 2.",
    "The\nsecond is a set: 𝑔({1}) = {2} .\n",
    "To find 𝑔−1(1), we need to find all integers 𝑛such that 𝑛2 + 1 = 1.",
    "Clearly\nonly 0 works, so 𝑔−1(1) = {0} (note that even though there is only one element,\nwe still write it as a set with one element in it).\n",
    "To find 𝑔−1(2), we need to find all 𝑛such that 𝑛2 + 1 = 2.\n",
    "We see\n𝑔−1(2) = {−1, 1}.\n",
    "Finally, if 𝑛2 + 1 = 3, then we are looking for an 𝑛such that 𝑛2 = 2.",
    "There\nare no such integers so 𝑔−1(3) = ∅.\nSince 𝑓−1(𝑦) is a set, it makes sense to ask for\n\f\f𝑓−1(𝑦)\n\f\f, the number of elements in\nthe domain that map to 𝑦.\n\n5.2.",
    "Functions\n413\nExample 5.2.10\nFind a function 𝑓: {1, 2, 3, 4, 5} →ℕsuch that\n\f\f𝑓−1(7)\n\f\f = 5.\nSolution.\n",
    "There is only one such function.",
    "We need five elements of the\ndomain to map to the number 7 ∈ℕ.",
    "Since there are only five elements in the\ndomain, all of them must map to 7.",
    "So\n𝑓=\n\u0012\n1\n2\n3\n4\n5\n7\n7\n7\n7\n7\n\u0013\n.\n",
    "Function Definitions.\n",
    "Here is a summary of all the main concepts and definitions\nwe use when working with functions.\n",
    "•",
    "A function is a rule that assigns each element of a set, called the domain, to\nexactly one element of a second set, called the codomain.\n",
    "• Notation: 𝑓: 𝑋→𝑌is our way of saying that the function is called 𝑓, the\ndomain is the set 𝑋, and the codomain is the set 𝑌.\n• To specify the rule for a function with small domain, use two-line notation by\nwriting a matrix with each output directly below its corresponding input, as\nin:\n𝑓=\n\u0012\n1\n2\n3\n4\n2\n1\n3\n1\n\u0013\n.\n",
    "• 𝑓(𝑥) = 𝑦means the element 𝑥of the domain (input) is assigned to the element\n𝑦of the codomain.",
    "We say 𝑦is an output.",
    "Alternatively, we call 𝑦the image\nof 𝑥under 𝑓.\n•",
    "The range is a subset of the codomain.",
    "It is the set of all elements that are\nassigned to at least one element of the domain by the function.",
    "That is, the\nrange is the set of all outputs.\n",
    "•",
    "A function is injective (an injection or one-to-one) if every element of the\ncodomain is the image of at most one element from the domain.\n",
    "•",
    "A function is surjective (a surjection or onto) if every element of the codomain\nis the image of at least one element from the domain.\n",
    "•",
    "A bĳection is a function that is both an injection and surjection.",
    "In other\nwords, if every element of the codomain is the image of exactly one element\nfrom the domain.\n",
    "•",
    "The image of an element 𝑥in the domain is the element 𝑦in the codomain\nthat 𝑥is mapped to.",
    "That is, the image of 𝑥under 𝑓is 𝑓(𝑥).\n\n",
    "414\n5.",
    "Discrete Structures Revisited\n• The complete inverse image of an element 𝑦in the codomain, written 𝑓−1(𝑦),\nis the set of all elements in the domain that are assigned to 𝑦by the function.\n",
    "•",
    "The image of a subset 𝐴of the domain is the set 𝑓(𝐴) = { 𝑓(𝑎) ∈𝑌: 𝑎∈𝐴}.\n",
    "•",
    "The inverse image of a subset 𝐵of the codomain is the set 𝑓−1(𝐵) = {𝑥∈𝑋:\n𝑓(𝑥) ∈𝐵}.\n",
    "Reading Questions\n1.\nExplain, in your own words, the relationship between the codomain of a\nfunction and the range of a function.\n",
    "2.\n",
    "If a function has domain and codomain of equal sizes, must the function be\nsurjective?",
    "Must it be injective?",
    "Could it be only one of these?",
    "Briefly explain\nyour thinking.\n",
    "3.\n",
    "What questions do you have?",
    "Write at least one question about the content of\nthis section that you or a classmate might be curious about after reading this\nsection.\n",
    "5.2.4\nExercises\n1.\nConsider the function 𝑓: {1, 2, 3, 4, 5} →{1, 2, 3, 4, 5} given by\n𝑓=\n\u0012\n1\n2\n3\n4\n5\n1\n1\n4\n2\n5\n\u0013\n.\na. Find 𝑓(4).\n",
    "b.",
    "Find a 𝑛in the domain such that 𝑓(𝑛) = 4.\nc. Find an element 𝑛of the domain such that 𝑓(𝑛) = 𝑛.\nd. Find an element of the codomain that is not in the range.\n",
    "2.\nThe following functions all have {1, 2, 3, 4, 5} as both their domain and\ncodomain.",
    "For each, determine whether it is (only) injective, (only) surjective,\nbĳective, or neither injective nor surjective.\n(a) 𝑓=\n\u0012\n1\n2\n3\n4\n5\n1\n2\n3\n4\n1\n\u0013\n(b) 𝑓(𝑥) =\n(\n𝑥\nif 𝑥< 3\n𝑥−2\nif 𝑥≥3\n(c) 𝑓=\n\u0012\n1\n2\n3\n4\n5\n1\n3\n2\n5\n4\n\u0013\n\n5.2.",
    "Functions\n415\n(d) 𝑓(𝑥) =\n(\n3 −𝑥\nif 𝑥< 3\n𝑥\nif 𝑥≥3\n3.\nConsider the following functions 𝑓: {1, 2, 3, 4, 5} →{1, 2, 3}.\n",
    "For each,\ndetermine whether it is (only) injective, (only) surjective, bĳective, or neither\ninjective nor surjective.\n(a) 𝑓=\n\u0012\n1\n2\n3\n4\n5\n3\n3\n2\n1\n1\n\u0013\n(b) 𝑓(𝑥) =\n(\n𝑥\nif 𝑥< 4\n6 −𝑥\nif 𝑥≥4\n(c) 𝑓=\n\u0012\n1\n2\n3\n4\n5\n2\n3\n2\n3\n1\n\u0013\n4.\nConsider the following functions 𝑓: {1, 2, 3, 4} →{1, 2, 3, 4, 5}.",
    "For each,\ndetermine whether it is (only) injective, (only) surjective, bĳective, or neither\ninjective nor surjective.\n(a) 𝑓(𝑥) = 6 −𝑥\n(b) 𝑓=\n\u0012\n1\n2\n3\n4\n1\n2\n3\n4\n\u0013\n(c) 𝑓=\n\u0012\n1\n2\n3\n4\n1\n3\n2\n5\n\u0013\n5.\nWrite out all functions 𝑓: {1, 2, 3, 4} →{𝑎, 𝑏} (using two-line notation).\n",
    "How many functions are there?\n",
    "How many are surjective?\nHow many are injective?\n",
    "How many are bĳective?\n6.\nWrite out all function 𝑓: {1, 2} →{𝑎, 𝑏, 𝑐, 𝑑} (in two-line notation).\n",
    "How many functions are there?\n",
    "How many are surjective?\nHow many are injective?\n",
    "How many are bĳective?\n7.\nConsider the function 𝑓: {1, 2, 3, 4, 5} →{1, 2, 3, 4} given by the table below:\n𝑥\n1\n2\n3\n4\n5\n𝑓(𝑥)\n3\n2\n4\n1\n2\n(a) Is 𝑓injective?",
    "Explain.\n",
    "(b) Is 𝑓surjective?",
    "Explain.\n\n",
    "416\n5.",
    "Discrete Structures Revisited\n(c) Write the function using two-line notation.\n",
    "8.\nConsider the function 𝑓: {1, 2, 3, 4} →{1, 2, 3, 4} given by the graph below.\n𝑓(𝑥)\n𝑥\n1\n1\n2\n2\n3\n3\n4\n4\n(a) Is 𝑓injective?",
    "Explain.\n",
    "(b) Is 𝑓surjective?",
    "Explain.\n",
    "(c) Write the function using two-line notation.\n",
    "9.\nConsider the function 𝑓: ℕ→ℕgiven recursively by\n𝑓(0) = 1 and 𝑓(𝑛+ 1) = 3 · 𝑓(𝑛).\n",
    "Find 𝑓(12).\n",
    "10.\nSuppose 𝑓: ℕ→ℕsatisfies the recurrence\n𝑓(𝑛+ 1) = 𝑓(𝑛)",
    "+ 6.\n",
    "Note that this is not enough information to define the function, since we\ndon’t have an initial condition.",
    "For each of the initial conditions below, find the\nvalue of 𝑓(7).\n",
    "a.",
    "If 𝑓(0) = 1.\nb. 𝑓(0)",
    "= 7.\nc. 𝑓(0)",
    "= 17.\nd. 𝑓(0)",
    "= 155.\n",
    "11.\nSuppose 𝑓: ℕ→ℕsatisfies the recurrence relation\n𝑓(𝑛+ 1) =\n( 𝑓(𝑛)\n2\nif 𝑓(𝑛) is even\n3 𝑓(𝑛) +",
    "1\nif 𝑓(𝑛) is odd\n.\n",
    "Note that with the initial condition 𝑓(0) = 1, the values of the function are:\n𝑓(1) = 4 , 𝑓(2)",
    "= 2, 𝑓(3) = 1, 𝑓(4) = 4, and so on, the images cycling through\nthose three numbers.",
    "Thus 𝑓is NOT injective (and also certainly not surjective).\n",
    "Might it be under other initial conditions?1\n\n5.2.",
    "Functions\n417\n(a) If 𝑓satisfies the initial condition 𝑓(0) = 5, is 𝑓injective?",
    "Explain why or\ngive a specific example of two elements from the domain with the same\nimage.\n",
    "(b) If 𝑓satisfies the initial condition 𝑓(0)",
    "= 3, is 𝑓injective?",
    "Explain why or\ngive a specific example of two elements from the domain with the same\nimage.\n",
    "(c) If 𝑓satisfies the initial condition 𝑓(0) = 27, then it turns out that 𝑓(105) =\n10 and no two numbers less than 105 have the same image.",
    "Could 𝑓be\ninjective?",
    "Explain.\n",
    "(d) Prove that no matter what initial condition you choose, the function\ncannot be surjective.\n12.\n",
    "For each function given below, determine whether or not the function is\ninjective and whether or not the function is surjective.\n(a) 𝑓: ℕ→ℕgiven by 𝑓(𝑛) = 𝑛+ 4.\n(b) 𝑓: ℤ→ℤgiven by 𝑓(𝑛) = 𝑛+ 4.\n(c) 𝑓: ℤ→ℤgiven by 𝑓(𝑛) = 5𝑛−8.\n",
    "(d) 𝑓: ℤ→ℤgiven by 𝑓(𝑛) =\n(\n𝑛/2\nif 𝑛is even\n(𝑛+ 1)/2\nif 𝑛is odd.\n13.\n",
    "Let 𝐴= {1, 2, 3, . .",
    ".",
    ", 10}.",
    "Consider the function 𝑓: 𝒫(𝐴)",
    "→ℕgiven by\n𝑓(𝐵) = |𝐵|.",
    "That is, 𝑓takes a subset of 𝐴as an input and outputs the cardinality\nof that set.\n",
    "(a) Is 𝑓injective?",
    "Prove your answer.\n",
    "(b) Is 𝑓surjective?",
    "Prove your answer.\n",
    "(c) Find 𝑓−1(1).\n",
    "(d) Find 𝑓−1(0).\n",
    "(e) Find 𝑓−1(12).\n",
    "14.\n",
    "Let 𝑋= {𝑛∈ℕ: 0 ≤𝑛≤999} be the set of all numbers with three or fewer\ndigits.",
    "Define the function 𝑓: 𝑋→ℕby 𝑓(𝑎𝑏𝑐) = 𝑎+ 𝑏+ 𝑐, where 𝑎, 𝑏, and 𝑐\nare the digits of the number in 𝑋(write numbers less than 100 with leading 0’s\nto make them three digits).",
    "In other words, 𝑓returns the sum of the digits of\nits input.",
    "For example, 𝑓(253) = 2 + 5 + 3 = 10.\n(a) Let 𝐴= {𝑛∈𝑋: 306 ≤𝑥≤323}.",
    "Find 𝑓(𝐴).\n",
    "1It turns out this is a really hard question to answer in general.",
    "The Collatz conjecture is that no\nmatter what the initial condition is, the function will eventually produce 1 as an output.",
    "This is an\nopen problem in mathematics: nobody knows the answer.\n\n",
    "418\n5.",
    "Discrete Structures Revisited\n(b) Find 𝑓−1({1, 3}).\n",
    "(c) Find 𝑓−1(2).\n",
    "(d) Find 𝑓−1(139).\n",
    "15.\nConsider the set ℕ2 = ℕ× ℕ, the set of all ordered pairs (𝑎, 𝑏) where 𝑎and 𝑏\nare natural numbers.",
    "Consider a function 𝑓: ℕ2 →ℕgiven by 𝑓((𝑎, 𝑏))",
    "= 𝑎+ 𝑏\n.\n(a) Let 𝐴= {(𝑎, 𝑏) ∈ℕ2 : 𝑎, 𝑏≤10}.",
    "Find 𝑓(𝐴).\n",
    "(b) Find 𝑓−1(3) and 𝑓−1({0, 1, 2, 3}).\n",
    "(c) Give geometric descriptions of 𝑓−1(𝑛) and 𝑓−1({0, 1, . . .",
    ", 𝑛}) for any 𝑛≥1.\n",
    "(d) Find\n\f\f𝑓−1(8)\n\f\f and\n\f\f𝑓−1({0, 1, . . .",
    ", 8})\n\f\f.\n",
    "16.\nLet 𝑓: 𝑋→𝑌be some function.",
    "Suppose 3",
    "∈𝑌.",
    "What can you say about\n𝑓−1(3) if you know,\n(a) 𝑓is injective?",
    "Explain.\n",
    "(b) 𝑓is surjective?",
    "Explain.\n",
    "(c) 𝑓is bĳective?",
    "Explain.\n",
    "17.\nFind a set 𝑋and a function 𝑓: 𝑋→ℕso that 𝑓−1(0) ∪𝑓−1(1) = 𝑋.\n18.\n",
    "What can you deduce about the sets 𝑋and 𝑌if you know,\n(a) there is an injective function 𝑓: 𝑋→𝑌?",
    "Explain.\n",
    "(b) there is a surjective function 𝑓: 𝑋→𝑌?",
    "Explain.\n",
    "(c) there is a bĳective function 𝑓: 𝑋→𝑌?",
    "Explain.\n",
    "19.\nSuppose 𝑓: 𝑋→𝑌is a function.",
    "Which of the following are possible?",
    "Explain.\n",
    "(a) 𝑓is injective but not surjective.\n",
    "(b) 𝑓is surjective but not injective.\n",
    "(c) |𝑋| = |𝑌| and 𝑓is injective but not surjective.\n",
    "(d) |𝑋| = |𝑌| and 𝑓is surjective but not injective.\n",
    "(e) |𝑋| = |𝑌|, 𝑋and 𝑌are finite, and",
    "𝑓is injective but not surjective.\n",
    "(f) |𝑋| = |𝑌|, 𝑋and 𝑌are finite, and 𝑓is surjective but not injective.\n",
    "20.\nLet 𝑓: 𝑋→𝑌and 𝑔: 𝑌→𝑍be functions.",
    "We can define the composition of\n𝑓and 𝑔to be the function 𝑔◦𝑓: 𝑋→𝑍for which the image of each 𝑥∈𝑋is\n𝑔(𝑓(𝑥)).",
    "That is, plug 𝑥into 𝑓, then plug the result into 𝑔(just like composition\n\n5.2.",
    "Functions\n419\nin algebra and calculus).\n",
    "(a) If 𝑓and 𝑔are both injective, must 𝑔◦𝑓be injective?",
    "Explain.\n",
    "(b) If 𝑓and 𝑔are both surjective, must 𝑔◦𝑓be surjective?",
    "Explain.\n",
    "(c) Suppose 𝑔◦𝑓is injective.",
    "What, if anything, can you say about 𝑓and 𝑔?\nExplain.\n",
    "(d) Suppose 𝑔◦𝑓is surjective.",
    "What, if anything, can you say about 𝑓and\n𝑔? Explain.\n",
    "21.\nConsider the function 𝑓: ℤ→ℤgiven by 𝑓(𝑛) =\n(\n𝑛+ 1\nif 𝑛is even\n𝑛−3\nif 𝑛is odd.\n",
    "(a) Is 𝑓injective?",
    "Prove your answer.\n",
    "(b) Is 𝑓surjective?",
    "Prove your answer.\n",
    "22.\n",
    "At the end of the semester a teacher assigns letter grades to each of her students.\n",
    "Is this a function?",
    "If so, what sets make up the domain and codomain, and is\nthe function injective, surjective, bĳective, or neither?\n23.\n",
    "In the game of Hearts, four players are each dealt 13 cards from a deck of 52.",
    "Is\nthis a function?",
    "If so, what sets make up the domain and codomain, and is the\nfunction injective, surjective, bĳective, or neither?\n24.\n",
    "Seven players are playing 5-card stud.",
    "Each player initially receives 5 cards\nfrom a deck of 52.",
    "Is this a function?",
    "If so, what sets make up the domain and\ncodomain, and is the function injective, surjective, bĳective, or neither?\n25.\nConsider the function 𝑓: ℕ→ℕthat gives the number of handshakes that take\nplace in a room of 𝑛people assuming everyone shakes hands with everyone\nelse.",
    "Give a recursive definition for this function.\n26.\n",
    "Let 𝑓: 𝑋→𝑌be a function and 𝐴⊆𝑋be a finite subset of the domain.",
    "What\ncan you say about the relationship between |𝐴| and\n\f\f𝑓(𝐴)\n\f\f?",
    "Consider both the\ngeneral case and what happens when you know 𝑓is injective, surjective, or\nbĳective.\n27.\nLet 𝑓: 𝑋→𝑌be a function and 𝐵⊆𝑌be a finite subset of the codomain.",
    "What\ncan you say about the relationship between |𝐵| and\n\f\f𝑓−1(𝐵)\n\f\f?",
    "Consider both\nthe general case and what happens when you know 𝑓is injective, surjective, or\nbĳective.\n28.\nLet 𝑓: 𝑋→𝑌be a function, 𝐴⊆𝑋and 𝐵⊆𝑌.\n(a) Is 𝑓−1 \u0000𝑓(𝐴)\u0001\n= 𝐴?",
    "Always, sometimes, never?",
    "Explain.\n",
    "(b) Is 𝑓\u0000𝑓−1(𝐵)\u0001\n= 𝐵?",
    "Always, sometimes, never?",
    "Explain.\n",
    "(c) If one or both of the above do not always hold, is there something else\nyou can say?",
    "Will equality always hold for particular types of functions?\n\n420\n5.",
    "Discrete Structures Revisited\nIs there some other relationship other than equality that would always\nhold?",
    "Explore.\n29.\n",
    "Let 𝑓: 𝑋→𝑌be a function and 𝐴, 𝐵⊆𝑋be subsets of the domain.\n",
    "(a) Is 𝑓(𝐴∪𝐵) = 𝑓(𝐴) ∪𝑓(𝐵)?",
    "Always, sometimes, or never?",
    "Explain.\n",
    "(b) Is 𝑓(𝐴∩𝐵) = 𝑓(𝐴) ∩𝑓(𝐵)?",
    "Always, sometimes, or never?",
    "Explain.\n30.\n",
    "Let 𝑓: 𝑋→𝑌be a function and 𝐴, 𝐵⊆𝑌be subsets of the codomain.\n",
    "(a) Is 𝑓−1(𝐴∪𝐵) = 𝑓−1(𝐴) ∪𝑓−1(𝐵)?",
    "Always, sometimes, or never?",
    "Explain.\n",
    "(b) Is 𝑓−1(𝐴∩𝐵) = 𝑓−1(𝐴) ∩𝑓−1(𝐵)?",
    "Always, sometimes, or never?",
    "Explain.\n\n",
    "Chapter 6\nAdditional Topics\n6.1\nGenerating Functions\n",
    "There is an extremely powerful tool in discrete mathematics used to manipulate\nsequences called the generating function.",
    "The idea is this: instead of an infinite\nsequence (for example: 2, 3, 5, 8, 12, . . .)",
    "we look at a single function which encodes\nthe sequence.",
    "But not a function that gives the 𝑛th term as output.",
    "Instead, a function\nwhose power series (like from calculus) “displays” the terms of the sequence.",
    "So for\nexample, we would look at the power series 2 + 3𝑥+ 5𝑥2 + 8𝑥3 + 12𝑥4 + · · · which\ndisplays the sequence 2, 3, 5, 8, 12, . . .",
    "as coefficients.\n",
    "An infinite power series is simply an infinite sum of terms of the form 𝑐𝑛𝑥𝑛were\n𝑐𝑛is some constant.",
    "So we might write a power series like this:\n∞\nÕ\n𝑘=0\n𝑐𝑘𝑥𝑘.\nor expanded like this\n𝑐0 + 𝑐1𝑥+ 𝑐2𝑥2",
    "+ 𝑐3𝑥3",
    "+ 𝑐4𝑥4",
    "+ 𝑐5𝑥5",
    "+ · · · .\n",
    "When viewed in the context of generating functions, we call such a power series\na generating series.",
    "The generating series generates the sequence\n𝑐0, 𝑐1, 𝑐2, 𝑐3, 𝑐4, 𝑐5, . . . .\n",
    "In other words, the sequence generated by a generating series is simply the\nsequence of coefficients of the infinite polynomial.\n",
    "Example 6.1.1\n",
    "What sequence is represented by the generating series 3 + 8𝑥2 + 𝑥3 + 𝑥5\n7 +\n100𝑥6 + · · ·?\nSolution.\n",
    "We just read off the coefficients of each 𝑥𝑛term.",
    "So 𝑎0 = 3 since\nthe coefficient of 𝑥0 is 3 (𝑥0 = 1",
    "so this is the constant term).",
    "What is 𝑎1?",
    "It\nis NOT 8, since 8 is the coefficient of 𝑥2, so 8 is the term 𝑎2 of the sequence.\n",
    "To find 𝑎1 we need to look for the coefficient of 𝑥1 which in this case is 0.",
    "So\n𝑎1 = 0.",
    "Continuing, we have 𝑎2 = 8, 𝑎3 = 1, 𝑎4 = 0, and 𝑎5 = 1\n7.",
    "So we have the\nsequence\n3, 0, 8, 1, 0, 1\n7, 100, . . . .\n",
    "Note that when discussing generating functions, we always start our\n421\n\n422\n6.",
    "Additional Topics\nsequence with 𝑎0.\n",
    "Now you might very naturally ask why we would do such a thing.\n",
    "One\nreason is that encoding a sequence with a power series helps us keep track of\nwhich term is which in the sequence.\n",
    "For example, if we write the sequence\n1, 3, 4, 6, 9, . . .",
    ", 24, 41, . . .",
    "it is impossible to determine which term 24 is (even if we\nagreed that the first term was supposed to be 𝑎0).",
    "However, if we wrote the generating\nseries instead, we would have 1+3𝑥+4𝑥2 +6𝑥3 +9𝑥4 +· · · +24𝑥17",
    "+41𝑥18 +· · ·.",
    "Now\nit is clear that 24 is the 17th term of the sequence (that is, 𝑎17 = 24).",
    "Of course to get\nthis benefit we could have displayed our sequence in any number of ways, perhaps\n1 0 3 1 4 2 6 3 9 4 · · · 24 17 41 18 · · ·, but we do not do this.",
    "The reason is that the\ngenerating series looks like an ordinary power series (although we are interpreting\nit differently) so we can do things with it that we ordinarily do with power series\nsuch as write down what it converges to.\n",
    "For example, from calculus we know that the power series 1 + 𝑥+ 𝑥2\n2 + 𝑥3\n6 + 𝑥4\n24 +\n· · · + 𝑥𝑛\n𝑛! + · · · converges to the function",
    "𝑒𝑥.",
    "So we can use 𝑒𝑥as a way of talking about\nthe sequence of coefficients of the power series for 𝑒𝑥. When we write down a nice\ncompact function which has an infinite power series that we view as a generating\nseries, then we call that function a generating function.",
    "In this example, we would say\n1, 1, 1\n2, 1\n6, 1\n24, . . .",
    ", 1\n𝑛!, . . .",
    "has generating function 𝑒𝑥.\n6.1.1\nBuilding Generating Functions\n",
    "The 𝑒𝑥example is very specific.",
    "We have a rather odd sequence, and the only reason\nwe know its generating function is because we happen to know the Taylor series\nfor 𝑒𝑥. Our goal now is to gather some tools to build the generating function of a\nparticular given sequence.\n",
    "Let’s see what the generating functions are for some very simple sequences.",
    "The\nsimplest of all: 1, 1, 1, 1, 1, . . . .",
    "What does the generating series look like?",
    "It is simply\n1 + 𝑥+ 𝑥2 + 𝑥3 + 𝑥4 + · · ·.",
    "Now, can we find a closed formula for this power series?\n",
    "Yes!",
    "This particular series is really just a geometric series with common ratio 𝑥.",
    "So if\nwe use our “multiply, shift and subtract” technique from Section 4.4, we have\n𝑆= 1 + 𝑥+ 𝑥2 + 𝑥3 + · · ·\n−\n𝑥𝑆=\n𝑥+ 𝑥2 + 𝑥3 + 𝑥4 + · · ·\n(1 −𝑥)𝑆= 1\n",
    "Therefore we see that\n1 + 𝑥+ 𝑥2 + 𝑥3 · · · =\n1\n1 −𝑥.\n\n6.1.",
    "Generating Functions\n423\nYou might remember from calculus that this is only true on the interval of\nconvergence for the power series, in this case when |𝑥| < 1.",
    "That is true for us, but\nwe don’t care.",
    "We are never going to plug anything in for 𝑥, so as long as there is\nsome value of 𝑥for which the generating function and generating series agree, we\nare happy.",
    "And in this case we are happy.\n",
    "1, 1, 1, . .",
    "..\n",
    "The generating function for 1, 1, 1, 1, 1, 1, . . . is\n1\n1 −𝑥\nLet’s use this basic generating function to find generating functions for more\nsequences.",
    "What if we replace 𝑥by −𝑥.",
    "We get\n1\n1 + 𝑥= 1 −𝑥+ 𝑥2 −𝑥3 + · · · which generates 1, −1, 1, −1, . . . .\n",
    "If we replace 𝑥by 3𝑥we get\n1\n1 −3𝑥= 1",
    "+ 3𝑥+ 9𝑥2 + 27𝑥3",
    "+ · · · which generates 1, 3, 9, 27, . . .",
    ".\n",
    "By replacing the 𝑥in\n1\n1−𝑥we can get generating functions for a variety of\nsequences, but not all.",
    "For example, you cannot plug in anything for 𝑥to get the\ngenerating function for 2, 2, 2, 2, . .",
    "..",
    "However, we are not lost yet.",
    "Notice that each\nterm of 2, 2, 2, 2, . . .",
    "is the result of multiplying the terms of 1, 1, 1, 1, . . .",
    "by the\nconstant 2.",
    "So multiply the generating function by 2 as well.\n2\n1 −𝑥= 2 + 2𝑥+ 2𝑥2 + 2𝑥3 + · · · which generates 2, 2, 2, 2, . . . .\n",
    "Similarly, to find the generating function for the sequence 3, 9, 27, 81, . .",
    "., we note\nthat this sequence is the result of multiplying each term of 1, 3, 9, 27, . . .",
    "by 3.",
    "Since\nwe have the generating function for 1, 3, 9, 27, . . .",
    "we can say\n3\n1 −3𝑥= 3 · 1 + 3 · 3𝑥+ 3 · 9𝑥2 + 3 · 27𝑥3 + · · · which generates 3, 9, 27, 81, . . . .\n",
    "What about the sequence 2, 4, 10, 28, 82, . . .?",
    "Here the terms are always 1 more\nthan powers of 3.",
    "That is, we have added the sequences 1, 1, 1, 1, . . .",
    "and 1, 3, 9, 27, . . .\nterm by term.",
    "Therefore we can get a generating function by adding the respective\ngenerating functions:\n2 + 4𝑥+ 10𝑥2 + 28𝑥3 + · · · = (1 + 1) + (1 + 3)𝑥+ (1 + 9)𝑥2 + (1 + 27)𝑥3 + · · ·\n= 1 + 𝑥+ 𝑥2 + 𝑥3 + · · · + 1 + 3𝑥+ 9𝑥2 + 27𝑥3 + · · ·\n=\n1\n1 −𝑥+\n1\n1 −3𝑥\n\n424\n6.",
    "Additional Topics\nThe fun does not stop there: if we replace 𝑥in our original generating function\nby 𝑥2 we get\n1\n1 −𝑥2 = 1 + 𝑥2 + 𝑥4 + 𝑥6 · · · which generates 1, 0, 1, 0, 1, 0, . . .",
    ".\n",
    "How could we get 0, 1, 0, 1, 0, 1, . . .?",
    "Start with the previous sequence and shift\nit over by 1.",
    "But how do you do this?",
    "To see how shifting works, let’s first try\nto get the generating function for the sequence 0, 1, 3, 9, 27, . .",
    "..",
    "We know that\n1\n1−3𝑥= 1 + 3𝑥+ 9𝑥2 + 27𝑥3 + · · ·.",
    "To get the zero out front, we need the generating\nseries to look like 𝑥+3𝑥2 +9𝑥3 +27𝑥4 +· · · (so there is no constant term).",
    "Multiplying\nby 𝑥has this effect.",
    "So the generating function for 0, 1, 3, 9, 27, . . .",
    "is\n𝑥\n",
    "1−3𝑥.",
    "This will\nalso work to get the generating function for 0, 1, 0, 1, 0, 1, . . .",
    ":\n𝑥\n1 −𝑥2 = 𝑥+ 𝑥3 + 𝑥5 + · · · which generates 0, 1, 0, 1, 0, 1 . . .",
    ".\n",
    "What if we add the sequences 1, 0, 1, 0, 1, 0, . . .",
    "and 0, 1, 0, 1, 0, 1, . . .",
    "term by\nterm?",
    "We should get 1, 1, 1, 1, 1, 1 . .",
    "..",
    "What happens when we add the generating\nfunctions?",
    "It works (try it)!\n",
    "1\n1 −𝑥2 +\n𝑥\n1 −𝑥2 =\n1\n1 −𝑥.\nHere’s a sneaky one: what happens if you take the derivative of\n1\n1−𝑥?",
    "We get\n1\n(1−𝑥)2 .",
    "On the other hand, if we differentiate term by term in the power series, we\nget (1 + 𝑥+ 𝑥2 + 𝑥3 + · · · )′",
    "= 1 + 2𝑥+ 3𝑥2 + 4𝑥3 + · · · which is the generating series\nfor 1, 2, 3, 4, . .",
    "..",
    "This says\n1, 2, 3, . .",
    "..\n",
    "The generating function for 1, 2, 3, 4, 5, . . . is\n1\n(1 −𝑥)2 .\n",
    "Take a second derivative:\n2\n(1−𝑥)3 = 2 + 6𝑥+ 12𝑥2 + 20𝑥3 + · · ·.\n",
    "So\n1\n(1−𝑥)3 =\n1 + 3𝑥+ 6𝑥2 + 10𝑥3 + · · · is a generating function for the triangular numbers,\n1, 3, 6, 10 . . .",
    "(although here we have 𝑎0 = 1 while 𝑇0 = 0 usually).\n",
    "6.1.2\nDifferencing\n",
    "We have seen how to find generating functions from\n1\n1−𝑥using multiplication (by a\nconstant or by 𝑥), substitution, addition, and differentiation.",
    "To use each of these,\nyou must notice a way to transform the sequence 1, 1, 1, 1, 1 . . .",
    "into your desired\nsequence.",
    "This is not always easy.",
    "It is also not really the way we have analyzed\nsequences.",
    "One thing we have considered often is the sequence of differences\nbetween terms of a sequence.",
    "This will turn out to be helpful in finding generating\nfunctions as well.",
    "The sequence of differences is often simpler than the original\n\n6.1.",
    "Generating Functions\n425\nsequence.",
    "So if we know a generating function for the differences, we would like to\nuse this to find a generating function for the original sequence.\n",
    "For example, consider the sequence 2, 4, 10, 28, 82, . .",
    "..",
    "How could we move to\nthe sequence of first differences: 2, 6, 18, 54, . . .?",
    "We want to subtract 2 from the 4, 4\nfrom the 10, 10 from the 28, and so on.",
    "So if we subtract (term by term) the sequence\n0, 2, 4, 10, 28, . . .",
    "from 2, 4, 10, 28 . .",
    "., we will be set.",
    "We can get the generating function\nfor 0, 2, 4, 10, 28, . . .",
    "from the generating function for 2, 4, 10, 28 . . .",
    "by multiplying\nby 𝑥. Use 𝐴to represent the generating function for 2, 4, 10, 28, 82, . . .",
    "Then:\n𝐴= 2 + 4𝑥+",
    "10𝑥2",
    "+",
    "28𝑥3 + 82𝑥4 + · · ·\n−\n𝑥𝐴= 0 + 2𝑥+ 4𝑥2 + 10𝑥3 + 28𝑥4 + 82𝑥5 + · · ·\n(1 −𝑥)𝐴= 2 + 2𝑥+ 6𝑥2 + 18𝑥3 + 54𝑥4 + · · ·\nWhile we don’t get exactly the sequence of differences, we do get something close.\n",
    "In this particular case, we already know the generating function 𝐴(we found it in\nthe previous section) but most of the time we will use this differencing technique to\nfind 𝐴: if we have the generating function for the sequence of differences, we can\nthen solve for 𝐴.\nExample 6.1.2\nFind a generating function for 1, 3, 5, 7, 9, . .",
    "..\n",
    "Solution.\n",
    "Notice that the sequence of differences is constant.",
    "We know how\nto find the generating function for any constant sequence.",
    "So denote the\ngenerating function for 1, 3, 5, 7, 9, . . .",
    "by 𝐴. We have\n𝐴= 1 + 3𝑥+ 5𝑥2 + 7𝑥3",
    "+ 9𝑥4 + · · ·\n−\n𝑥𝐴= 0",
    "+ 𝑥+ 3𝑥2 + 5𝑥3 + 7𝑥4 + 9𝑥5 + · · ·\n(1 −𝑥)𝐴= 1 + 2𝑥+ 2𝑥2 + 2𝑥3 + 2𝑥4 + · · ·\nWe know that 2𝑥+ 2𝑥2 + 2𝑥3 + 2𝑥4 + · ·",
    "· =\n2𝑥\n1 −𝑥.",
    "Thus\n(1 −𝑥)𝐴= 1 +\n2𝑥\n1 −𝑥.\nNow solve for 𝐴:\n𝐴=\n1\n1 −𝑥+\n2𝑥\n(1 −𝑥)2 =\n1 + 𝑥\n(1 −𝑥)2 .\n",
    "Does this make sense?",
    "Before we simplified the two fractions into one,\nwe were adding the generating function for the sequence 1, 1, 1, 1, . . .",
    "to\nthe generating function for the sequence 0, 2, 4, 6, 8, 10, . . .",
    "(remember\n1\n(1−𝑥)2\ngenerates 1, 2, 3, 4, 5, . .",
    ".",
    ", multiplying by 2𝑥shifts it over, putting the zero\nout front, and doubles each term).",
    "If we add these term by term, we get the\ncorrect sequence 1, 3, 5, 7, 9, . .",
    "..\n\n",
    "426\n6.",
    "Additional Topics\nNow that we have a generating function for the odd numbers, we can use that to\nfind the generating function for the squares:\nExample 6.1.3\nFind the generating function for 1, 4, 9, 16, . . ..",
    "Note we take 1 = 𝑎0.\n",
    "Solution.\n",
    "Again we call the generating function for the sequence 𝐴.",
    "Using\ndifferencing:\n𝐴= 1 + 4𝑥+ 9𝑥2 + 16𝑥3 + · · ·\n−\n𝑥𝐴= 0",
    "+ 𝑥+ 4𝑥2 + 9𝑥3 + 16𝑥4 + · · ·\n(1 −𝑥)𝐴= 1 + 3𝑥+ 5𝑥2 + 7𝑥3 + · · ·\nSince 1 + 3𝑥+ 5𝑥2 + 7𝑥3 + · · · =\n1 + 𝑥\n(1 −𝑥)2 we have 𝐴=\n1 + 𝑥\n(1 −𝑥)3 .\n",
    "In each of the examples above, we found the difference between consecutive\nterms which gave us a sequence of differences for which we knew a generating\nfunction.",
    "We can generalize this to more complicated relationships between terms\nof the sequence.",
    "For example, if we know that the sequence satisfies the recurrence\nrelation 𝑎𝑛= 3𝑎𝑛−1 −2𝑎𝑛−2?",
    "In other words, if we take a term of the sequence and\nsubtract 3 times the previous term and then add 2 times the term before that, we get\n0",
    "(since 𝑎𝑛−3𝑎𝑛−1 + 2𝑎𝑛−2 = 0).",
    "That will hold for all but the first two terms of the\nsequence.",
    "So after the first two terms, the sequence of results of these calculations\nwould be a sequence of 0’s, for which we definitely know a generating function.\n",
    "Example 6.1.4\n",
    "The sequence 1, 3, 7, 15, 31, 63, . . .",
    "satisfies the recurrence relation 𝑎𝑛= 3𝑎𝑛−1−\n2𝑎𝑛−2.",
    "Find the generating function for the sequence.\n",
    "Solution.\n",
    "Call the generating function for the sequence 𝐴.",
    "We have\n𝐴= 1 + 3𝑥+ 7𝑥2",
    "+ 15𝑥3 + 31𝑥4 + ·",
    "· · + 𝑎𝑛𝑥𝑛+ · · ·\n−3𝑥𝐴= 0 −3𝑥−9𝑥2 −21𝑥3 −45𝑥4 −· · · −3𝑎𝑛−1𝑥𝑛−· · ·\n+ 2𝑥2𝐴\n= 0 + 0𝑥+ 2𝑥2 + 6𝑥3 + 14𝑥4 + · · · + 2𝑎𝑛−2𝑥𝑛+ · · ·\n(1 −3𝑥+ 2𝑥2)𝐴= 1\nWe multiplied 𝐴by −3𝑥which shifts every term over one spot and\nmultiplies them by −3.",
    "On the third line, we multiplied 𝐴by 2𝑥2, which\nshifted every term over two spots and multiplied them by 2.",
    "When we add\nup the corresponding terms, we are taking each term, subtracting 3 times the\nprevious term, and adding 2 times the term before that.",
    "This will happen for\neach term after 𝑎1 because 𝑎𝑛−3𝑎𝑛−1 + 2𝑎𝑛−2 = 0.",
    "In general, we might have\n\n6.1.",
    "Generating Functions\n427\ntwo terms from the beginning of the generating series, although in this case\nthe second term happens to be 0 as well.\n",
    "Now we just need to solve for 𝐴:\n𝐴=\n1\n1 −3𝑥+ 2𝑥2 .\n",
    "6.1.3\nMultiplication and Partial Sums\nWhat happens to the sequences when you multiply two generating functions?",
    "Let’s\nsee: 𝐴= 𝑎0 + 𝑎1𝑥+ 𝑎2𝑥2 + · · · and 𝐵= 𝑏0 + 𝑏1𝑥+ 𝑏2𝑥2 + · · ·.",
    "To multiply 𝐴and 𝐵,\nwe need to do a lot of distributing (infinite FOIL?)",
    "but keep in mind we will group\nlike terms and only need to write down the first few terms to see the pattern.",
    "The\nconstant term is 𝑎0𝑏0.",
    "The coefficient of 𝑥is 𝑎0𝑏1 + 𝑎1𝑏0.",
    "And so on.",
    "We get:\n",
    "𝐴𝐵= 𝑎0𝑏0",
    "+(𝑎0𝑏1 + 𝑎1𝑏0)𝑥+(𝑎0𝑏2 + 𝑎1𝑏1 + 𝑎2𝑏0)𝑥2 +(𝑎0𝑏3 + 𝑎1𝑏2 + 𝑎2𝑏1 + 𝑎3𝑏0)𝑥3 +· · · .\n",
    "Example 6.1.5\n“Multiply” the sequence 1, 2, 3, 4, . . .",
    "by the sequence 1, 2, 4, 8, 16, . .",
    "..\n",
    "Solution.\n",
    "The new constant term is just 1·1.",
    "The next term will be 1·2+2·1 = 4.\n",
    "The next term: 1 · 4 + 2 · 2 + 3 · 1 = 11.",
    "One more: 1 · 8 + 2 · 4 + 3 · 2 + 4 · 1 = 26.\n",
    "The resulting sequence is\n1, 4, 11, 26, 57, . . . .\n",
    "Since the generating function for 1, 2, 3, 4, . . .",
    "is\n1\n(1−𝑥)2 and the generating\nfunction for 1, 2, 4, 8, 16, . .",
    ".",
    "is\n1\n1−2𝑥, we have that the generating function for\n1, 4, 11, 26, 57, . . .",
    "is\n1\n(1−𝑥)2(1−2𝑥)\nConsider the special case when you multiply a sequence by 1, 1, 1, . .",
    "..",
    "For\nexample, multiply 1, 1, 1, . . .",
    "by 1, 2, 3, 4, 5 . .",
    "..",
    "The first term is 1 · 1 = 1.",
    "Then\n1 · 2 + 1 · 1 = 3.",
    "Then 1 · 3 + 1 · 2 + 1 · 1 = 6.",
    "The next term will be 10.",
    "We are\ngetting the triangular numbers.",
    "More precisely, we get the sequence of partial\nsums of 1, 2, 3, 4, 5, . .",
    "..",
    "In terms of generating functions, we take\n1\n1−𝑥(generating\n1, 1, 1, 1, 1 . . .)",
    "and multiply it by\n1\n(1−𝑥)2 (generating 1, 2, 3, 4, 5, . . .)",
    "and this gives\n1\n(1−𝑥)3 .",
    "This should not be a surprise as we found the same generating function for\nthe triangular numbers earlier.\n",
    "The point is, if you need to find a generating function for the sum of the first\n𝑛terms of a particular sequence, and you know the generating function for that\nsequence, you can multiply it by\n1\n1−𝑥. To go back from the sequence of partial sums\nto the original sequence, you look at the sequence of differences.",
    "When you get the\nsequence of differences you end up multiplying by 1 −𝑥, or equivalently, dividing\nby\n1\n1−𝑥. Multiplying by\n1\n1−𝑥gives partial sums, dividing by\n1\n1−𝑥gives differences.\n\n",
    "428\n6.",
    "Additional Topics\n6.1.4\nSolving Recurrence Relations with Generating Functions\n",
    "We conclude with an example of one of the many reasons studying generating\nfunctions is helpful.",
    "We can use generating functions to solve recurrence relations.\n",
    "Example 6.1.6\nSolve the recurrence relation 𝑎𝑛= 3𝑎𝑛−1 −2𝑎𝑛−2 with initial conditions 𝑎0 = 1\nand 𝑎1 = 3.\nSolution.\n",
    "We saw in an example above that this recurrence relation gives\nthe sequence 1, 3, 7, 15, 31, 63, . . .",
    "which has generating function\n1\n1 −3𝑥+ 2𝑥2 .\n",
    "We did this by calling the generating function 𝐴and then computing 𝐴−\n3𝑥𝐴+ 2𝑥2𝐴which was just 1, since every other term canceled out.\n",
    "But how does knowing the generating function help us?",
    "First, break up\nthe generating function into two simpler ones.",
    "For this, we can use partial\nfraction decomposition.",
    "Start by factoring the denominator:\n1\n1 −3𝑥+ 2𝑥2 =\n1\n(1 −𝑥)(1 −2𝑥).\n",
    "Partial fraction decomposition tells us that we can write this faction as the\nsum of two fractions (we decompose the given fraction):\n1\n(1 −𝑥)(1 −2𝑥) =\n𝑎\n1 −𝑥+\n𝑏\n1 −2𝑥\nfor some constants 𝑎and 𝑏.\nTo find 𝑎and 𝑏we add the two decomposed fractions using a common\ndenominator.",
    "This gives\n1\n(1 −𝑥)(1 −2𝑥) = 𝑎(1 −2𝑥) + 𝑏(1 −𝑥)\n(1 −𝑥)(1 −2𝑥)\n.\n",
    "so\n1 = 𝑎(1 −2𝑥) + 𝑏(1 −𝑥).\n",
    "This must be true for all values of 𝑥. If 𝑥= 1, then the equation becomes\n1 = −𝑎so 𝑎= −1.",
    "When 𝑥= 1\n2 we get 1 = 𝑏/2 so 𝑏= 2.",
    "This tells us that we\ncan decompose the fraction like this:\n1\n(1 −𝑥)(1 −2𝑥) =\n−1\n1 −𝑥+\n2\n1 −2𝑥.\nThis completes the partial fraction decomposition.",
    "Notice that these two\nfractions are generating functions we know.",
    "In fact, we should be able to\nexpand each of them.\n",
    "−1\n1 −𝑥= −1 −𝑥−𝑥2 −𝑥3 −𝑥4 −· · · which generates −1, −1, −1, −1, −1, . . .",
    ".\n\n",
    "6.1.",
    "Generating Functions\n429\n2\n1 −2𝑥= 2 + 4𝑥+ 8𝑥2",
    "+ 16𝑥3 + 32𝑥4 + · · · which generates 2, 4, 8, 16, 32, . . .",
    ".\n",
    "We can give a closed formula for the 𝑛th term of each of these sequences.\n",
    "The first is just 𝑎𝑛= −1.",
    "The second is 𝑎𝑛= 2𝑛+1.",
    "The sequence we are\ninterested in is just the sum of these, so the solution to the recurrence relation\nis\n𝑎𝑛= 2𝑛+1 −1.\n",
    "We can now add generating functions to our list of methods for solving recurrence\nrelations.\n",
    "6.1.5\nExercises\n1.\nFind the generating function for each of the following sequences by relating\nthem back to a sequence with known generating function.\n",
    "(a) 4, 4, 4, 4, 4, . .",
    "..\n(b) 2, 4, 6, 8, 10, . .",
    "..\n",
    "(c) 0, 0, 0, 2, 4, 6, 8, 10, . .",
    "..\n(d) 1, 5, 25, 125, . .",
    "..\n(e) 1, −3, 9, −27, 81, . .",
    "..\n(f) 1, 0, 5, 0, 25, 0, 125, 0, . .",
    "..\n(g) 0, 1, 0, 0, 2, 0, 0, 3, 0, 0, 4, 0, 0, 5, . .",
    "..\n",
    "2.\nFind the sequence generated by the following generating functions:\n(a)\n4𝑥\n1 −𝑥.\n(b)\n1\n1 −4𝑥.\n(c)\n𝑥\n1 + 𝑥.\n(d)\n3𝑥\n(1 + 𝑥)2 .\n(e) 1 + 𝑥+ 𝑥2\n(1 −𝑥)2\n(Hint: multiplication).\n",
    "3.\nShow how you can get the generating function for the triangular numbers in\nthree different ways:\n(a) Take two derivatives of the generating function for 1, 1, 1, 1, 1, . . .\n\n",
    "430\n6.",
    "Additional Topics\n(b) Use differencing.\n",
    "(c) Multiply two known generating functions.\n",
    "4.\nUse differencing to find the generating function for 4, 5, 7, 10, 14, 19, 25, . .",
    "..\n",
    "5.\nFind a generating function for the sequence with recurrence relation 𝑎𝑛=\n3𝑎𝑛−1 −𝑎𝑛−2 with initial terms 𝑎0 = 1 and 𝑎1 = 5.\n6.\nUse the recurrence relation for the Fibonacci numbers to find the generating\nfunction for the Fibonacci sequence.\n",
    "7.\nUse multiplication to find the generating function for the sequence of partial\nsums of Fibonacci numbers, 𝑆0, 𝑆1, 𝑆2, . . .",
    "where 𝑆0 = 𝐹0, 𝑆1 = 𝐹0 + 𝐹1, 𝑆2 =\n𝐹0 + 𝐹1 + 𝐹2, 𝑆3 = 𝐹0 + 𝐹1 + 𝐹2 + 𝐹3 and so on.\n8.\nFind the generating function for the sequence with closed formula 𝑎𝑛=\n2(5𝑛)",
    "+",
    "7(−3)𝑛.\n9.\nFind a closed formula for the 𝑛th term of the sequence with generating function\n3𝑥\n1 −4𝑥+\n1\n1 −𝑥.\n10.\n",
    "Find 𝑎7 for the sequence with generating function\n2\n(1 −𝑥)2 ·\n𝑥\n1 −𝑥−𝑥2 .\n",
    "11.\nExplain how we know that\n1\n(1 −𝑥)2 is the generating function for 1, 2, 3, 4, . .",
    "..\n",
    "12.\n",
    "Starting with the generating function for 1, 2, 3, 4, . .",
    "., find a generating function\nfor each of the following sequences.\n",
    "(a) 1, 0, 2, 0, 3, 0, 4, . .",
    "..\n(b) 1, −2, 3, −4, 5, −6, . .",
    "..\n",
    "(c) 0, 3, 6, 9, 12, 15, 18, . .",
    "..\n(d) 0, 3, 9, 18, 30, 45, 63, . .",
    "..",
    "(Hint: relate this sequence to the previous one.)\n13.\n",
    "You may assume that 1, 1, 2, 3, 5, 8, . . .",
    "has generating function\n1\n1 −𝑥−𝑥2\n(because it does).",
    "Use this fact to find the sequence generated by each of the\nfollowing generating functions.\n",
    "(a)\n𝑥2\n1−𝑥−𝑥2 .\n",
    "(b)\n1\n1−𝑥2−𝑥4 .\n",
    "(c)\n1\n1−3𝑥−9𝑥2 .\n",
    "(d)\n1\n(1−𝑥−𝑥2)(1−𝑥).\n",
    "14.\nFind the generating function for the sequence 1, −2, 4, −8, 16, . .",
    "..\n",
    "15.\nFind the generating function for the sequence 1, 1, 1, 2, 3, 4, 5, 6, . .",
    "..\n\n",
    "6.1.",
    "Generating Functions\n431\n16.\nSuppose 𝐴is the generating function for the sequence 3, 5, 9, 15, 23, 33, . .",
    "..\n",
    "(a) Find a generating function (in terms of 𝐴) for the sequence of differences\nbetween terms.\n",
    "(b) Write the sequence of differences between terms and find a generating\nfunction for it (without referencing 𝐴).\n",
    "(c) Use your answers to parts (a) and (b) to find the generating function for\nthe original sequence.\n\n",
    "6.2\nIntroduction to Number Theory\nWe have used the natural numbers to solve problems.",
    "This was the right set of\nnumbers to work with in discrete mathematics because we always dealt with a whole\nnumber of things.",
    "The natural numbers have been a tool.",
    "Let’s take a moment now\nto inspect that tool.",
    "What mathematical discoveries can we make about the natural\nnumbers themselves?\n",
    "This is the main question of number theory: a huge, ancient, complex, and above\nall, beautiful branch of mathematics.",
    "Historically, number theory was known as the\nQueen of Mathematics and was very much a branch of pure mathematics, studied for\nits own sake instead of as a means to understanding real-world applications.",
    "This\nhas changed in recent years however, as applications of number theory have been\nunearthed.",
    "Probably the most well-known example of this is RSA cryptography, one\nof the methods used to encrypt data on the internet.",
    "It is number theory that makes\nthis possible.\n",
    "What sorts of questions belong to the realm of number theory?\n",
    "Here is a\nmotivating example.",
    "Recall in our study of induction, we asked:\nWhich amounts of postage can be made exactly using just 5-cent and\n8-cent stamps?\n",
    "We were able to prove that any amount greater than 27 cents could be made.",
    "You\nmight wonder what would happen if we changed the denomination of the stamps.\n",
    "What if we instead had 4- and 9-cent stamps?",
    "Would there be some amount after\nwhich all amounts would be possible?",
    "Well, again, we could replace two 4-cent\nstamps with a 9-cent stamp, or three 9-cent stamps with seven 4-cent stamps.",
    "In each\ncase we can create one more cent of postage.",
    "Using this as the inductive case would\nallow us to prove that any amount of postage greater than 23 cents can be made.\n",
    "What if we had 2-cent and 4-cent stamps.",
    "Here it looks less promising.",
    "If we\ntake some number of 2-cent stamps and some number of 4-cent stamps, what can\nwe say about the total?",
    "Could it ever be odd?",
    "Doesn’t look like it.\n",
    "Why does 5 and 8 work, 4 and 9 work, but 2 and 4 not work?",
    "What is it about\nthese numbers?",
    "If I gave you a pair of numbers, could you tell me right away if\nthey would work or not?",
    "We will answer these questions, and more, after first\ninvestigating some simpler properties of numbers themselves.\n",
    "6.2.1\nDivisibility\nIt is easy to add and multiply natural numbers.",
    "If we extend our focus to all integers,\nthen subtraction is also easy (we need the negative numbers, so we can subtract\nany number from any other number, even larger from smaller).",
    "Division is the first\noperation that presents a challenge.",
    "If we wanted to extend our set of numbers so\nany division would be possible (maybe excluding division by 0), we would need to\nlook at the rational numbers (the set of all numbers that can be written as fractions).\n",
    "This would be going too far, so we will refuse this option.\n",
    "432\n\n6.2.",
    "Introduction to Number Theory\n433\nIn fact, it is a good thing that not every number can be divided by other numbers.\n",
    "This helps us understand the structure of the natural numbers and opens the door\nto many interesting questions and applications.\n",
    "If given numbers 𝑎and 𝑏, it is possible that 𝑎÷ 𝑏gives a whole number.",
    "In this\ncase, we say that 𝑏divides 𝑎; in symbols, we write 𝑏| 𝑎.",
    "If this holds, then 𝑏is a\ndivisor or factor of 𝑎, and 𝑎is a multiple of 𝑏. In other words, if 𝑏| 𝑎, then 𝑎= 𝑏𝑘for\nsome integer 𝑘(this is saying 𝑎is some multiple of 𝑏).\n",
    "The Divisibility Relation.\n",
    "Given integers 𝑚and 𝑛, we say “𝑚divides 𝑛” and write\n𝑚| 𝑛\nprovided 𝑛÷ 𝑚is an integer.",
    "Thus the following assertions mean the same\nthing:\n1. 𝑚| 𝑛.\n2. 𝑛= 𝑚𝑘for some integer 𝑘.\n3.",
    "𝑚is a factor (or divisor) of 𝑛.\n4.",
    "𝑛is a multiple of 𝑚.\nNotice that 𝑚| 𝑛is a statement.",
    "It is either true or false.",
    "On the other hand,\n𝑛÷ 𝑚or 𝑛/𝑚is",
    "some number.",
    "If we want to claim that 𝑛/𝑚is not an integer, so 𝑚\ndoes not divide 𝑛, then we can write 𝑚∤𝑛.\nExample 6.2.1\nDecide whether each of the statements below are true or false.\n",
    "1. 4 | 20\n2. 20 | 4\n3. 0",
    "| 5\n4. 5 | 0\n5. 7 | 7\n6. 1 | 37\n7. −3",
    "| 12\n8. 8 | 12\n9. 1642 | 136299\nSolution.\n",
    "1.",
    "True. 4 “goes into” 20 five times without remainder.",
    "In other words,\n20 ÷ 4 = 5, an integer.",
    "We could also justify this by saying that 20 is a\nmultiple of 4: 20 = 4 · 5.\n2.",
    "False.",
    "While 20 is a multiple of 4, it is false that 4 is a multiple of 20.\n3.",
    "False. 5 ÷ 0 is not even defined, let alone an integer.\n\n",
    "434\n6.",
    "Additional Topics\n4. True.",
    "In fact, 𝑥| 0 is true for all 𝑥. This is because 0 is a multiple of\nevery number: 0 = 𝑥· 0.\n5.",
    "True.",
    "In fact, 𝑥| 𝑥is true for all 𝑥.\n6.",
    "True. 1 divides every number (other than 0).\n",
    "7.",
    "True.",
    "Negative numbers work just fine for the divisibility relation.",
    "Here\n12 = −3 · 4.",
    "It is also true that 3 | −12 and that −3 | −12.\n8.",
    "False.",
    "Both 8 and 12 are divisible by 4, but this does not mean that 12 is\ndivisible by 8.\n9.",
    "False.",
    "See below.\n",
    "This last example raises a question: How might one decide whether 𝑚| 𝑛?",
    "Of\ncourse, if you had a trusted calculator, you could ask it for the value of 𝑛÷ 𝑚.",
    "If it\nspits out anything other than an integer, you know 𝑚∤𝑛.",
    "This seems a little like\ncheating though: We don’t have division, so should we really use division to check\ndivisibility?\n",
    "While we don’t really know how to divide, we do know how to multiply.",
    "We\nmight try multiplying 𝑚by larger and larger numbers until we get close to 𝑛. How\nclose?",
    "Well, we want to be sure that if we multiply 𝑚by the next larger integer, we\ngo over 𝑛.\nFor example, let’s try this to decide whether 1642 | 136299.",
    "Start finding multiples\nof 1642:\n1642 · 2 = 3284\n1642 · 3 = 4926\n1642 · 4 = 6568\n· · · .\n",
    "All of these are well less than 136299.",
    "I suppose we can jump ahead a bit:\n1642 ·",
    "50 = 82100\n1642 ·",
    "80 = 131360\n1642 · 85 = 139570.\n",
    "Ah, so we need to look somewhere between 80 and 85.",
    "Try 83:\n1642 · 83 = 136286.\n",
    "Is this the best we can do?",
    "How far are we from our desired 136299?",
    "If we\nsubtract, we get 136299 −136286 = 13.",
    "So we know we cannot go up to 84; that will\nbe too much.",
    "In other words, we have found that\n136299 = 83 · 1642 + 13.\n",
    "Since 13 < 1642, we can now safely say that 1642 ∤136299.\n",
    "It turns out that the process we went through above can be repeated for any pair of\nnumbers.",
    "We can always write the number 𝑎as some multiple of the number 𝑏plus\nsome remainder.",
    "We know this because we know about division with remainder\nfrom elementary school.",
    "This is just a way of saying it using multiplication.",
    "Due\nto the procedural nature that can be used to find the remainder, this fact is usually\ncalled the division algorithm:\n\n6.2.",
    "Introduction to Number Theory\n435\nThe Division Algorithm.\n",
    "Given any two integers 𝑎and 𝑏, we can always find an integer 𝑞such that\n𝑎= 𝑞𝑏+ 𝑟\nwhere 𝑟is an integer satisfying 0",
    "≤𝑟< |𝑏|\nThe idea is that we can always take a large enough multiple of 𝑏so that the\nremainder 𝑟is as small as possible.",
    "We do allow the possibility of 𝑟= 0, in which\ncase we have 𝑏| 𝑎.\n6.2.2\nRemainder Classes\nThe division algorithm tells us that there are only 𝑏possible remainders when\ndividing by 𝑏.",
    "If we fix this divisor, we can group integers by the remainder.",
    "Each\ngroup is called a remainder class modulo 𝑏(or sometimes residue class).\n",
    "Example 6.2.2\nDescribe the remainder classes modulo 5.\nSolution.\n",
    "We want to classify numbers by what their remainder would be\nwhen divided by 5.",
    "From the division algorithm, we know there will be\nexactly 5 remainder classes, because there are only 5 choices for what 𝑟could\nbe (0 ≤𝑟< 5).\n",
    "First consider 𝑟= 0.",
    "Here we are looking for all the numbers divisible by\n5 since 𝑎= 5𝑞+ 0.",
    "In other words, the multiples of 5.",
    "We get the infinite set\n{. . .",
    ", −15, −10, −5, 0, 5, 10, 15, 20, . . .}.\n",
    "Notice we also include negative integers.\n",
    "Next consider 𝑟=",
    "1.",
    "Which integers, when divided by 5, have remainder\n1?",
    "Well, certainly 1 does, as does 6, and 11.",
    "Negatives?",
    "Here we must be\ncareful: −6 does NOT have remainder 1.",
    "We can write −6 = −2 · 5 + 4 or\n−6 = −1 · 5 −1, but only one of these is a “correct” instance of the division\nalgorithm: 𝑟=",
    "4 since we need 𝑟to be non-negative.",
    "So in fact, to get 𝑟= 1,\nwe would have −4, or −9, etc.",
    "Thus we get the remainder class\n{. . .",
    ", −14, −9, −4, 1, 6, 11, 16, 21, . . .}.\n",
    "There are three more to go.",
    "The remainder classes for 2, 3, and 4 are,\nrespectively\n{. . .",
    ", −13, −8, −3, 2, 7, 12, 17, 22, . . .}\n{. . .",
    ", −12, −7, −2, 3, 8, 13, 18, 23, . . .",
    "}\n{. . .",
    ", −11, −6, −1, 4, 9, 14, 19, 24, . . .}.\n\n",
    "436\n6.",
    "Additional Topics\nNote that in the example above, every integer is in exactly one remainder class.\n",
    "The technical way to say this is that the remainder classes modulo 𝑏form a partition\nof the integers.1 The most important fact about partitions is that it is possible to\ndefine an equivalence relation from a partition: This is a relationship between pairs\nof numbers which acts in all the important ways like the “equals” relationship.2\nAll fun technical language aside, the idea is really simple.",
    "If two numbers belong\nto the same remainder class, then in some way, they are the same.",
    "That is, they are\nthe same up to division by 𝑏.",
    "In the case where 𝑏= 5 above, the numbers 8 and 23,\nwhile not the same number, are the same when it comes to dividing by 5, because\nboth have remainder 3.\n",
    "It matters what the divisor is: 8 and 23 are the same up to division by 5, but not\nup to division by 7, since 8 has a remainder of 1 when divided by 7 while 23 has a\nremainder of 2.\n",
    "With all this in mind, let’s introduce some notation.",
    "We want to say that 8 and\n23 are basically the same, even though they are not equal.",
    "It would be wrong to\nsay 8 = 23.",
    "Instead, we write 8 ≡23.",
    "But this is not always true.",
    "It works if we are\nthinking division by 5, so we need to denote that somehow.",
    "What we will actually\nwrite is this:\n8 ≡23\n(mod 5)\nwhich is read, “8 is congruent to 23 modulo 5” (or just “mod 5”).",
    "Of course then we\ncould observe that\n8 .",
    "23\n(mod 7).\n",
    "Congruence Modulo 𝑛.\nWe say 𝑎is congruent to 𝑏modulo 𝑛, and write,\n𝑎≡𝑏\n(mod 𝑛)\nprovided 𝑎and 𝑏have the same remainder when divided by 𝑛. In other\nwords, provided 𝑎and 𝑏belong to the same remainder class modulo 𝑛.\nMany books define congruence modulo 𝑛slightly differently.",
    "They say that\n𝑎≡𝑏(mod 𝑛) if and only if 𝑛| 𝑎−𝑏. In other words, two numbers are congruent\nmodulo 𝑛, if their difference is a multiple of 𝑛. So which definition is correct?",
    "It\nturns out that it doesn’t matter; they are equivalent.\n",
    "To see why, consider two numbers 𝑎and 𝑏that are congruent modulo 𝑛. Then 𝑎\nand 𝑏have the same remainder when divided by 𝑛. We have\n𝑎=",
    "𝑞1𝑛+ 𝑟\n𝑏= 𝑞2𝑛+ 𝑟.\n1It is possible to develop a mathematical theory of partitions, prove statements about all partitions\nin general, and then apply those observations to our case here.\n",
    "2Again, there is a mathematical theory of equivalence relations which applies in many more\ninstances than the one we look at here.",
    "See Subsection 2.6.4.\n\n6.2.",
    "Introduction to Number Theory\n437\nHere the two 𝑟’s really are the same.",
    "Consider what we get when we take the\ndifference of 𝑎and 𝑏:\n𝑎−𝑏= 𝑞1𝑛+ 𝑟−(𝑞2𝑛+ 𝑟) = 𝑞1𝑛−𝑞2𝑛= (𝑞1 −𝑞2)𝑛.\nSo 𝑎−𝑏is a multiple of 𝑛, or equivalently, 𝑛| 𝑎−𝑏.\nOn the other hand, if we assume first that 𝑛| 𝑎−𝑏, so 𝑎−𝑏= 𝑘𝑛, then consider\nwhat happens if we divide each term by 𝑛. Dividing 𝑎by 𝑛will leave some remainder,\nas will dividing 𝑏by 𝑛. However, dividing 𝑘𝑛by 𝑛will leave 0 remainder.",
    "So the\nremainders on the left-hand side must cancel out.",
    "That is, the remainders must be\nthe same.\n",
    "Thus we have:\nCongruence and Divisibility.\n",
    "For any integers 𝑎, 𝑏, and 𝑛, we have\n𝑎≡𝑏\n(mod 𝑛)\nif and only if\n𝑛| (𝑎−𝑏).\n",
    "It will also be useful to switch back and forth between congruences and regular\nequations.",
    "The above fact helps with this.",
    "We know that 𝑎≡𝑏(mod 𝑛) if and only\nif 𝑛| 𝑎−𝑏, if and only if 𝑎−𝑏= 𝑘𝑛for some integer 𝑘.",
    "Rearranging that equation,\nwe get 𝑎= 𝑏+",
    "𝑘𝑛.",
    "In other words, if 𝑎and 𝑏are congruent modulo 𝑛, then 𝑎is 𝑏\nmore than some multiple of 𝑛. This conforms with our earlier observation that all\nthe numbers in a particular remainder class are the same amount larger than the\nmultiples of 𝑛.\nCongruence and Equality.\n",
    "For any integers 𝑎, 𝑏, and 𝑛, we have\n𝑎≡𝑏\n(mod 𝑛)\nif and only if\n𝑎= 𝑏+ 𝑘𝑛for some integer 𝑘.\n6.2.3\nProperties of Congruence\nWe said earlier that congruence modulo 𝑛behaves, in many important ways, the\nsame way equality does.",
    "Specifically, we could prove that congruence modulo 𝑛is\nan equivalence relation, which would require checking the following three facts:\nCongruence Modulo 𝑛is an Equivalence Relation.\n",
    "Given any integers 𝑎, 𝑏, and 𝑐, and any positive integer 𝑛, the following\nhold:\n1. 𝑎≡𝑎(mod 𝑛).\n",
    "2.",
    "If 𝑎≡𝑏(mod 𝑛) then 𝑏≡𝑎(mod 𝑛).\n\n",
    "438\n6.",
    "Additional Topics\n3.",
    "If 𝑎≡𝑏(mod 𝑛) and 𝑏≡𝑐(mod 𝑛), then 𝑎≡𝑐(mod 𝑛).\n",
    "In other words, congruence modulo 𝑛is reflexive, symmetric, and transi-\ntive, and so is an equivalence relation.\n",
    "You should take a minute to convince yourself that each of the properties above\nactually holds for congruence.",
    "Try explaining each using both the remainder and\ndivisibility definitions.\n",
    "Next, consider how congruence behaves when doing basic arithmetic.",
    "We already\nknow that if you subtract two congruent numbers, the result will be congruent\nto 0 (be a multiple of 𝑛).",
    "What if we add something congruent to 1 to something\ncongruent to 2?",
    "Will we get something congruent to 3?\nCongruence and Arithmetic.\n",
    "Suppose 𝑎≡𝑏(mod 𝑛) and 𝑐≡𝑑(mod 𝑛).",
    "Then the following hold:\n1.",
    "𝑎+ 𝑐≡𝑏+ 𝑑(mod 𝑛).\n",
    "2. 𝑎−𝑐≡𝑏−𝑑(mod 𝑛).\n",
    "3. 𝑎𝑐≡𝑏𝑑(mod 𝑛).\n",
    "The above facts might be written a little strangely, but the idea is simple.",
    "If we\nhave a true congruence, and we add the same thing to both sides, the result is still a\ntrue congruence.",
    "This sounds like we are saying:\nIf 𝑎≡𝑏(mod 𝑛) then 𝑎+ 𝑐≡𝑏+ 𝑐(mod 𝑛).\n",
    "Of course this is true as well; it is the special case where 𝑐= 𝑑. But what we have\nworks in more generality.",
    "Think of congruence as being “basically equal.”",
    "If we\nhave two numbers that are basically equal, and we add basically the same thing to\nboth sides, the result will be basically equal.\n",
    "This seems reasonable.",
    "Is it really true?",
    "Let’s prove the first fact:\nProof.",
    "Suppose 𝑎≡𝑏(mod 𝑛) and 𝑐≡𝑑(mod 𝑛).",
    "That means 𝑎=",
    "𝑏+ 𝑘𝑛and\n𝑐= 𝑑+ 𝑗𝑛for integers 𝑘and 𝑗.",
    "Add these equations:\n",
    "𝑎+ 𝑐= 𝑏+ 𝑑+ 𝑘𝑛+ 𝑗𝑛.\n",
    "But 𝑘𝑛+ 𝑗𝑛= (𝑘+ 𝑗)𝑛, which is just a multiple of 𝑛. So 𝑎+ 𝑐= 𝑏+",
    "𝑑+",
    "(",
    "𝑗+ 𝑘)𝑛,\nor in other words, 𝑎+ 𝑐≡𝑏+ 𝑑(mod 𝑛).\n",
    "The other two facts can be proved in a similar way.\n",
    "One of the important consequences of these facts about congruences is that\nwe can basically replace any number in a congruence with any other number it is\ncongruent to.",
    "Here are some examples to see how (and why) that works:\n\n6.2.",
    "Introduction to Number Theory\n439\nExample 6.2.3\nFind the remainder of 3491 divided by 9.\nSolution.\n",
    "We could do long division, but there is another way.",
    "We want\nto find 𝑥such that 𝑥≡3491 (mod 9).",
    "Now 3491 = 3000 + 400 + 90 + 1.",
    "Of\ncourse 90 ≡0 (mod 9), so we can replace the 90 in the sum with 0.",
    "Why is\nthis okay?",
    "We are actually subtracting the “same” thing from both sides:\n𝑥≡3000 + 400 + 90 + 1\n(mod 9)\n−0 ≡90\n(mod 9)\n𝑥≡3000 + 400",
    "+ 0",
    "+ 1\n(mod 9).\n",
    "Next, note that 400 = 4 · 100, and 100 ≡1 (mod 9) (since 9 | 99).",
    "So we\ncan in fact replace the 400 with simply a 4.",
    "Again, we are appealing to our\nclaim that we can replace congruent elements, but we are really appealing to\nproperty 3 about the arithmetic of congruence: We know 100 ≡1 (mod 9), so\nif we multiply both sides by 4, we get 400 ≡4 (mod 9).\n",
    "Similarly, we can replace 3000 with 3, since 1000 = 1 + 999 ≡1 (mod 9).\n",
    "So our original congruence becomes\n𝑥≡3 + 4 + 0",
    "+ 1\n(mod 9)\n𝑥≡8\n(mod 9).\n",
    "Therefore 3491 divided by 9 has remainder 8.\n",
    "The above example should convince you that the well-known divisibility test for\n9 is true: The sum of the digits of a number is divisible by 9 if and only if the original\nnumber is divisible by 9.",
    "In fact, we now know something more: Any number is\ncongruent to the sum of its digits, modulo 9.3\nLet’s try another.\n",
    "Example 6.2.4\nFind the remainder when 3123 is divided by 7.\nSolution.\n",
    "Of course, we are working with congruence because we want\nto find the smallest positive 𝑥such that 𝑥≡3123 (mod 7).",
    "Now first write\n3123 = (33)41.",
    "We have:\n3123 = 2741 ≡641\n(mod 7),\nsince 27 ≡6 (mod 7).",
    "Notice further that 62 = 36 is congruent to 1 modulo 7.\n",
    "Thus we can simplify further:\n641 = 6 · (62)20 ≡6 · 120\n(mod 7).\n",
    "3This works for 3 as well, but definitely not for any modulus in general.\n\n",
    "440\n6.",
    "Additional Topics\nBut 120 = 1, so we are done:\n3123 ≡6\n(mod 7).\n",
    "In the above example, we are using the fact that if 𝑎≡𝑏(mod 𝑛), then 𝑎𝑝≡𝑏𝑝\n(mod 𝑛).",
    "This is just applying property 3 a bunch of times.\n",
    "So far we have seen how to add, subtract, and multiply with congruences.",
    "What\nabout division?",
    "There is a reason we have waited to discuss it.",
    "It turns out that we\ncannot simply divide.",
    "In other words, even if 𝑎𝑑≡𝑏𝑑(mod 𝑛), we do not know\nthat 𝑎≡𝑏(mod 𝑛).",
    "Consider, for example,\n18 ≡42\n(mod 8).\n",
    "This is true.",
    "Now 18 and 42 are both divisible by 6.",
    "However,\n3 . 7\n(mod 8).\n",
    "While this doesn’t work, note that 3 ≡7 (mod 4).",
    "We cannot divide 8 by 6, but\nwe can divide 8 by the greatest common factor of 8 and 6.",
    "Will this always happen?\n",
    "Suppose 𝑎𝑑≡𝑏𝑑(mod 𝑛).",
    "In other words, we have 𝑎𝑑= 𝑏𝑑+ 𝑘𝑛for some\ninteger 𝑘.",
    "Of course 𝑎𝑑is divisible by 𝑑, as is 𝑏𝑑. So 𝑘𝑛must also be divisible by 𝑑.\nNow if 𝑛and 𝑑have no common factors (other than 1), then we must have 𝑑| 𝑘.",
    "But\nin general, if we try to divide 𝑘𝑛by 𝑑, we don’t know that we will get an integer\nmultiple of 𝑛. Some of the 𝑛might get divided as well.",
    "To be safe, let’s divide as\nmuch of 𝑛as we can.",
    "Take the largest factor of both 𝑑and 𝑛, and cancel that out\nfrom 𝑛. The rest of the factors of 𝑑will come from 𝑘, no problem.\n",
    "We will call the largest factor of both 𝑑and 𝑛the gcd(𝑑, 𝑛), for greatest common\ndivisor.",
    "In our example above, gcd(6, 8) = 2 since the greatest divisor common to 6\nand 8 is 2.\nCongruence and Division.\nSuppose 𝑎𝑑≡𝑏𝑑(mod 𝑛).",
    "Then 𝑎≡𝑏(mod\n𝑛\ngcd(𝑑,𝑛)).\n",
    "If 𝑑and 𝑛have no common factors, then gcd(𝑑, 𝑛) = 1, so 𝑎≡𝑏(mod 𝑛).\n",
    "Example 6.2.5\nSimplify the following congruences using division: (a) 24 ≡39 (mod 5) and\n(b) 24 ≡39 (mod 15).\n",
    "Solution.\n",
    "(a) Both 24 and 39 are divisible by 3, and 3 and 5 have no common\nfactors, so we get\n8 ≡13\n(mod 5).\n",
    "(b) Again, we can divide by 3.",
    "However, doing so blindly gives us 8 ≡13\n(mod 15) which is no longer true.",
    "Instead, we must also divide the modulus\n\n6.2.",
    "Introduction to Number Theory\n441\n15 by the greatest common factor of 3 and 15, which is 3.",
    "Again we get\n8 ≡13\n(mod 5).\n",
    "6.2.4\nSolving Congruences\nNow that we have some algebraic rules to govern congruence relations, we can\nattempt to solve for an unknown in a congruence.",
    "For example, is there a value of 𝑥\nthat satisfies,\n3𝑥+ 2 ≡4\n(mod 5),\nand if so, what is it?\n",
    "In this example, since the modulus is small, we could simply try every possible\nvalue for 𝑥. There are really only 5 to consider, since any integer that satisfied the\ncongruence could be replaced with any other integer it was congruent to modulo\n5.",
    "Here, when 𝑥= 4 we get 3𝑥+ 2 = 14, which is indeed congruent to 4 modulo 5.\n",
    "This means that 𝑥= 9 and 𝑥= 14 and 𝑥= 19 and so on will each also be a solution\nbecause, as we saw above, replacing any number in a congruence with a congruent\nnumber does not change the truth of the congruence.\n",
    "So in this example, simply compute 3𝑥+ 2 for values of 𝑥∈{0, 1, 2, 3, 4}.",
    "This\ngives 2, 5, 8, 11, and 14 respectively, for which only 14 is congruent to 4.\nLet’s also see how you could solve this using our rules for the algebra of\ncongruences.",
    "Such an approach would be much simpler than the trial and error\ntactic if the modulus was larger.",
    "First, we know we can subtract 2 from both sides:\n3𝑥≡2\n(mod 5).\n",
    "Then to divide both sides by 3, we first add 0 to both sides.",
    "Of course, on the\nright-hand side, we want that 0 to be a 10 (yes, 10 really is 0 since they are congruent\nmodulo 5).",
    "This gives,\n3𝑥≡12\n(mod 5).\n",
    "Now divide both sides by 3.",
    "Since gcd(3, 5) = 1, we do not need to change the\nmodulus:\n𝑥≡4\n(mod 5).\n",
    "Notice that this in fact gives the general solution: Not only can 𝑥= 4, but 𝑥can be\nany number which is congruent to 4.",
    "We can leave it like this, or write “𝑥= 4 + 5𝑘\nfor any integer 𝑘.”\nExample 6.2.6\nSolve the following congruences for 𝑥.\n1. 7𝑥≡12 (mod 13).\n",
    "2. 84𝑥−38 ≡79 (mod 15).\n\n442\n6.",
    "Additional Topics\n3. 20𝑥≡23 (mod 14).\n",
    "Solution.\n",
    "1.",
    "All we need to do here is divide both sides by 7.",
    "We add 13 to the\nright-hand side repeatedly until we get a multiple of 7 (adding 13 is the\nsame as adding 0, so this is legal).",
    "We get 25, 38, 51, 64, 77 – got it.",
    "So\nwe have:\n7𝑥≡12\n(mod 13)\n7𝑥≡77\n(mod 13)\n𝑥≡11\n(mod 13).\n",
    "2.",
    "Here, since we have numbers larger than the modulus, we can reduce\nthem prior to applying any algebra.",
    "We have 84 ≡9, 38 ≡8 and 79 ≡4.\n",
    "Thus,\n84𝑥−38 ≡79\n(mod 15)\n9𝑥−8 ≡4\n(mod 15)\n9𝑥≡12\n(mod 15)\n9𝑥≡72\n(mod 15).\n",
    "We got the 72 by adding 0 ≡60 (mod 15) to both sides of the congruence.\n",
    "Now divide both sides by 9.",
    "However, since gcd(9, 15) = 3, we must\ndivide the modulus by 3 as well:\n𝑥≡8\n(mod 5).\n",
    "So the solutions are those values that are congruent to 8, or equivalently\n3, modulo 5.",
    "This means that in some sense there are 3 solutions modulo\n15: 3, 8, and 13.",
    "We can write the solution:\n𝑥≡3\n(mod 15);",
    "𝑥≡8\n(mod 15); 𝑥≡13\n(mod 15).\n3.",
    "First, reduce modulo 14:\n20𝑥≡23\n(mod 14)\n6𝑥≡9\n(mod 14).\n",
    "We could now divide both sides by 3 or try to increase 9 by a multiple\nof 14 to get a multiple of 6.",
    "If we divide by 3, we get,\n2𝑥≡3\n(mod 14).\n",
    "Now try adding multiples of 14 to 3, in hopes of getting a number we\ncan divide by 2.",
    "This will not work!",
    "Every time we add 14 to the right\nside, the result will still be odd.",
    "We will never get an even number, so\nwe will never be able to divide by 2.",
    "Thus there are no solutions to the\ncongruence.\n\n",
    "6.2.",
    "Introduction to Number Theory\n443\nThe last congruence above illustrates the way in which congruences might not\nhave solutions.",
    "We could have seen this immediately in fact.",
    "Look at the original\ncongruence:\n20𝑥≡23\n(mod 14).\n",
    "If we write this as an equation, we get\n20𝑥= 23 + 14𝑘,\nor equivalently 20𝑥−14𝑘= 23.",
    "We can easily see there will be no solution to this\nequation in integers.",
    "The left-hand side will always be even, but the right-hand side\nis odd.",
    "A similar problem would occur if the right-hand side was divisible by any\nnumber that the left-hand side was not.\n",
    "So in general, given the congruence\n𝑎𝑥≡𝑏\n(mod 𝑛),\nif 𝑎and 𝑛are divisible by a number by which 𝑏is not divisible, then there will be no\nsolutions.",
    "In fact, we really only need to check one divisor of 𝑎and 𝑛: the greatest\ncommon divisor.",
    "Thus, a more compact way to say this is:\nCongruences with No Solutions.\n",
    "If gcd(𝑎, 𝑛) ∤𝑏, then 𝑎𝑥≡𝑏(mod 𝑛) has no solutions.\n",
    "6.2.5\nSolving Linear Diophantine Equations\nDiscrete math deals with whole numbers of things.",
    "So when we want to solve\nequations, we usually are looking for integer solutions.",
    "Equations that are intended\nto only have integer solutions were first studied by in the third century by the\nGreek mathematician Diophantus of Alexandria, and as such are called Diophantine\nequations.",
    "Probably the most famous example of a Diophantine equation is 𝑎2+𝑏2 = 𝑐2.\n",
    "The integer solutions to this equation are called Pythagorean triples.",
    "In general,\nsolving Diophantine equations is hard (in fact, there is provably no general algorithm\nfor deciding whether a Diophantine equation has a solution, a result known as\nMatiyasevich’s Theorem).",
    "We will restrict our focus to linear Diophantine equations,\nwhich are considerably easier to work with.\n",
    "Diophantine Equations.\n",
    "An equation in two or more variables is called a Diophantine equation if\nonly integer solutions are of interest.",
    "A linear Diophantine equation takes\nthe form 𝑎1𝑥1 + 𝑎2𝑥𝑥+ · · · + 𝑎𝑛𝑥𝑛= 𝑏for constants 𝑎1, . .",
    ".",
    ", 𝑎𝑛, 𝑏.\nA solution to a Diophantine equation is a solution to the equation consist-\ning only of integers.\n\n",
    "444\n6.",
    "Additional Topics\nWe have the tools we need to solve linear Diophantine equations.",
    "We will\nconsider, as a main example, the equation\n51𝑥+ 87𝑦= 123.\n",
    "The general strategy will be to convert the equation to a congruence, and then\nsolve that congruence.4 Let’s work through this particular example to see how this\nmight go.\n",
    "First, check if perhaps there are no solutions because a divisor of 51 and 87 is\nnot a divisor of 123.",
    "Really, we just need to check whether gcd(51, 87) | 123.",
    "This\ngreatest common divisor is 3, and yes 3 | 123.",
    "At this point, we might as well factor\nout this greatest common divisor.",
    "So instead, we will solve:\n17𝑥+ 29𝑦= 41.\n",
    "Now observe that if there are going to be solutions, then for those values of 𝑥\nand 𝑦, the two sides of the equation must have the same remainder as each other, no\nmatter what we divide by.",
    "In particular, if we divide both sides by 17, we must get\nthe same remainder.",
    "Thus we can safely write\n17𝑥+ 29𝑦≡41\n(mod 17).\n",
    "We choose 17 because 17𝑥will have remainder 0.",
    "This will allow us to reduce the\ncongruence to just one variable.",
    "We could have also moved to a congruence modulo\n29, although there is usually a good reason to select the smaller choice, as this will\nallow us to reduce the other coefficient.",
    "In our case, we reduce the congruence as\nfollows:\n17𝑥+ 29𝑦≡41\n(mod 17)\n0𝑥+ 12𝑦≡7\n(mod 17)\n12𝑦≡24\n(mod 17)\n𝑦≡2\n(mod 17).\n",
    "Now at this point we know 𝑦=",
    "2 + 17𝑘will work for any integer 𝑘.",
    "If we haven’t\nmade a mistake, we should be able to plug this back into our original Diophantine\nequation to find 𝑥:\n17𝑥+ 29(2 + 17𝑘)",
    "= 41\n17𝑥= −17 −29 · 17𝑘\n𝑥= −1",
    "−29𝑘.\nWe have now found all solutions to the Diophantine equation.",
    "For each 𝑘,\n𝑥= −1 −29𝑘and 𝑦=",
    "2 + 17𝑘will satisfy the equation.",
    "We could check this for a few\ncases.",
    "If 𝑘= 0, the solution is (−1, 2), and yes, −17 + 2 · 29 = 41.",
    "If 𝑘= 3, the solution\nis (−88, 53).",
    "If 𝑘= −2, we get (57, −32).\n",
    "To summarize this process, to solve 𝑎𝑥+ 𝑏𝑦= 𝑐, we,\n4This is certainly not the only way to proceed.",
    "A more common technique would be to apply the\nEuclidean algorithm.",
    "Our way can be a little faster, and is presented here primarily for variety.\n\n",
    "6.2.",
    "Introduction to Number Theory\n445\n1.",
    "Divide both sides of the equation by gcd(𝑎, 𝑏) (if this does not leave the right-\nhand side as an integer, there are no solutions).",
    "Let’s assume that 𝑎𝑥+ 𝑏𝑦= 𝑐\nhas already been reduced in this way.\n",
    "2. Pick the smaller of 𝑎and 𝑏(here, assume it is 𝑏), and convert to a congruence\nmodulo 𝑏:\n𝑎𝑥+ 𝑏𝑦≡𝑐\n(mod 𝑏).\n",
    "This will reduce to a congruence with one variable, 𝑥:\n𝑎𝑥≡𝑐\n(mod 𝑏).\n",
    "3. Solve the congruence as we did in the previous section.",
    "Write your solution as\nan equation, such as,\n𝑥= 𝑛+ 𝑘𝑏.\n4.",
    "Plug this into the original Diophantine equation, and solve for 𝑦.\n5.",
    "If we want to know solutions in a particular range (for example, 0 ≤𝑥, 𝑦≤20),\npick different values of 𝑘until you have all required solutions.\n",
    "Here is another example:\n",
    "Example 6.2.7\nHow can you make $6.37 using just 5-cent and 8-cent stamps?",
    "What is the\nsmallest and largest number of stamps you could use?\nSolution.\n",
    "First, we need a Diophantine equation.",
    "We will work in numbers\nof cents.",
    "Let 𝑥be the number of 5-cent stamps, and 𝑦be the number of 8-cent\nstamps.",
    "We have:\n5𝑥+ 8𝑦= 637.\nConvert to a congruence and solve:\n",
    "8𝑦≡637\n(mod 5)\n",
    "3𝑦≡2\n(mod 5)\n3𝑦≡12\n(mod 5)\n𝑦≡4\n(mod 5).\n",
    "Thus 𝑦= 4 + 5𝑘. Then 5𝑥+ 8(4 + 5𝑘) = 637, so 𝑥= 121 −8𝑘.\n",
    "This says that one way to make $6.37 is to take 121 of the 5-cent stamps\nand 4 of the 8-cent stamps.",
    "To find the smallest and largest number of stamps,\ntry different values of 𝑘.\n\n446\n6.",
    "Additional Topics\n𝑘\n(𝑥, 𝑦)\nStamps\n-1\n(129, -1)\nnot possible\n0\n(121, 4)\n125\n1\n(113, 9)\n122\n2\n(105, 13)\n119\n...\n...\n...\n",
    "This is no surprise.",
    "Having the most stamps means we have as many 5-cent\nstamps as possible, and to get the smallest number of stamps would require\nhaving the least number of 5-cent stamps.",
    "To minimize the number of 5-cent\nstamps, we want to pick 𝑘so that 121 −8𝑘is as small as possible (but still\npositive).",
    "When 𝑘= 15, we have 𝑥= 1 and 𝑦= 79.\n",
    "Therefore, to make $6.37, you can use as few as 80 stamps (1 5-cent stamp\nand 79 8-cent stamps) or as many as 125 stamps (121 5-cent stamps and 4\n8-cent stamps).\n",
    "Using this method, as long as you can solve linear congruences in one variable,\nyou can solve linear Diophantine equations of two variables.",
    "There are times, though,\nthat solving the linear congruence is a lot of work.",
    "For example, suppose you need\nto solve,\n13𝑥≡6\n(mod 51).\n",
    "You could keep adding 51 to the right side until you get a multiple of 13: You\nwould get 57, 108, 159, 210, 261, 312, and 312 is the first of these that is divisible\nby 13.",
    "This works but is really too much work.",
    "Instead we could convert back to a\nDiophantine equation:\n13𝑥= 6 + 51𝑘.\nNow solve this like we have in this section.",
    "Write it as a congruence modulo 13:\n0 ≡6 + 51𝑘\n(mod 13)\n−12𝑘≡6\n(mod 13)\n2𝑘≡−1\n(mod 13)\n",
    "2𝑘≡12\n(mod 13)\n𝑘≡6\n(mod 13).\n",
    "so 𝑘= 6 + 13𝑗. Now go back and figure out 𝑥:\n",
    "13𝑥= 6 + 51(6 + 13𝑗)\n𝑥= 24 + 51𝑗.\n",
    "Of course you could do this switching back and forth between congruences and\nDiophantine equations as many times as you like.",
    "If you only used this technique,\n\n6.2.",
    "Introduction to Number Theory\n447\nyou would essentially replicate the Euclidean algorithm, a more standard way to\nsolve Diophantine equations.\n",
    "6.2.6\nExercises\n1.\nSuppose 𝑎, 𝑏, and 𝑐are integers.",
    "Prove that if 𝑎| 𝑏, then 𝑎| 𝑏𝑐.\n2.\nSuppose 𝑎, 𝑏, and 𝑐are integers.",
    "Prove that if 𝑎| 𝑏and 𝑎| 𝑐then 𝑎| 𝑏+ 𝑐and\n𝑎| 𝑏−𝑐.\n3.\nWrite out the remainder classes for 𝑛= 4.\n4.\n",
    "What is the largest 𝑛such that 16 and 25 are in the same remainder class\nmodulo 𝑛?",
    "Write out the remainder class they both belong to and give an\nexample of a number more than 100 in that class.\n",
    "5.\nLet 𝑎, 𝑏, 𝑐, and 𝑛be integers.",
    "Prove that if 𝑎≡𝑏(mod 𝑛) and 𝑐≡𝑑(mod 𝑛),\nthen 𝑎−𝑐≡𝑏−𝑑(mod 𝑛).\n",
    "6.\nFind the remainder of 3456 when divided by\n(a) 2.\n(b) 5.\n(c) 7.\n(d) 9.\n7.\nRepeat the previous exercise, this time dividing 22019.\n",
    "8.\nDetermine which of the following congruences have solutions, and find any\nsolutions (between 0 and the modulus) by trial and error.\n",
    "(a) 4𝑥≡5 (mod 6).\n",
    "(b) 6𝑥≡3 (mod 9).\n",
    "(c) 𝑥2 ≡2 (mod 4).\n",
    "9.\nDetermine which of the following congruences have solutions, and find any\nsolutions (between 0 and the modulus) by trial and error.\n",
    "(a) 4𝑥≡5 (mod 7).\n",
    "(b) 6𝑥≡4 (mod 9).\n",
    "(c) 𝑥2 ≡2 (mod 7).\n",
    "10.\nSolve the congruence: 5𝑥+ 8 ≡11 (mod 22).",
    "That is, describe the general\nsolution.\n11.\n",
    "Solve the congruence: 6𝑥≡4 (mod 10).\n",
    "12.\nSolve the congruence: 4𝑥≡24 (mod 30).\n",
    "13.\nSolve the congruence: 341𝑥≡2941 (mod 9).\n",
    "14.\n",
    "I’m thinking of a number.",
    "If you multiply my number by 7, add 5, and divide\nthe result by 11, you will be left with a remainder of 2.",
    "What remainder would\nyou get if you divided my original number by 11?\n\n448\n6.",
    "Additional Topics\n15.\nSolve the following linear Diophantine equation, using modular arithmetic\n(describe the general solutions).\n",
    "6𝑥+ 10𝑦= 32.\n",
    "16.\nSolve the following linear Diophantine equation, using modular arithmetic\n(describe the general solutions).\n",
    "17𝑥+ 8𝑦= 31.\n",
    "17.\nSolve the following linear Diophantine equation, using modular arithmetic\n(describe the general solutions).\n",
    "35𝑥+ 47𝑦= 1.\n18.\n",
    "You have a 13 oz. bottle and a 20 oz. bottle, with which you wish to measure\nexactly 2 oz.",
    "However, you have a limited supply of water.",
    "If any water enters\neither bottle and then gets dumped out, it is gone forever.",
    "What is the least\namount of water you can start with and still complete the task?\n\nAppendix A\nSelected Hints\n1 · Logic and Proofs\n1.1 · Mathematical Statements\n1.1.6 ·",
    "Additional Exercises\n1.1.6.3.",
    "First figure out what each statement is saying.",
    "For part (c), you don’t need to\nassume the domain is an infinite set.\n",
    "1.2 · Implications\n1.2.6 ·",
    "Additional Exercises\n1.2.6.4.",
    "Of course there are many answers.",
    "It helps to assume that the statement is\ntrue and the converse is not true.",
    "Think about what that means in the real world,\nand then start saying it in different ways.",
    "Some ideas: Use “necessary and sufficient”\nlanguage, use “only if,” consider negations, use “or else” language.\n1.3 · Rules of Logic\n1.3.8 ·",
    "Additional Exercises\n1.3.8.1.",
    "You could probably reason through the cases by hand, but try making a\ntruth table.",
    "Use two statements, 𝑃being “we are cousins” and 𝑄being “we are both\nknaves”.\n",
    "1.3.8.4.",
    "You should write down three statements using the symbols 𝑃, 𝑄, 𝑅, 𝑆. If\nGeoff is a truth-teller, then all three statements would be true.",
    "If he was a liar, then\nall three statements would be false.",
    "But in either case, we don’t yet know whether\nthe four atomic statements are true or false, since he hasn’t said them by themselves.\n",
    "A truth table might help, although it is probably not entirely necessary.\n",
    "1.3.8.8.\n(a) There will be three rows in which the statement is false.\n",
    "(b) Consider the three rows that evaluate to false, and say what the truth values of\n𝑇, 𝑆, and 𝑃are there.\n",
    "(c) You are looking for a row in which 𝑃is true and the whole statement is true.\n",
    "1.3.8.9.",
    "Write down three statements, and then take the negation of each (since he\nis a liar).",
    "You should find that Tommy ate one item and drank one item.",
    "(𝑄is for\ncucumber sandwiches.)\n",
    "1.3.8.11.",
    "What do these concepts mean in terms of truth tables?\n",
    "1.3.8.14.",
    "Try an example.",
    "What if 𝑃(𝑥) was the predicate, “𝑥is prime”?",
    "What if it\nwas, “If 𝑥is divisible by 4, then it is even”?",
    "Of course examples are not enough to\nprove something in general, but that is entirely the point of this question.\n449\n\n450\nA. Selected Hints\n1.3.8.15.",
    "It might help to translate the statements into symbols and then use the\nformulaic rules to simplify negations (i.e., rules for quantifiers and De Morgan’s\nlaws).",
    "After simplifying, you should get ∀𝑥(¬𝐸(𝑥) ∧¬𝑂(𝑥)) for the first one, for\nexample.",
    "Then translate this back into English.\n1.4 · Proofs\n1.4.8 · Additional Exercises\n1.4.8.6.",
    "One of the implications will be a direct proof; the other will be a proof by\ncontrapositive.\n",
    "1.4.8.7.",
    "This is really an exercise in modifying the proof that\n√\n2 is irrational.",
    "There\nyou proved things were even; here they will be multiples of 3.\n1.4.8.8.",
    "Part (a) should be a relatively easy direct proof.",
    "Look for a counterexample\nfor part (b).\n",
    "1.4.8.10.",
    "A proof by contradiction would be reasonable here, because then you get to\nassume that both 𝑎and 𝑏are odd.",
    "Deduce that 𝑐2 is even, and therefore a multiple\nof 4 (why?",
    "and why is that a contradiction?).\n",
    "1.4.8.12. Use a different style of proof for each part.\n1.4.8.14.",
    "Note that if log(7) = 𝑎\n𝑏, then 7 = 10\n𝑎\n𝑏.",
    "Can any power of 7 be the same as a\npower of 10?\n1.4.8.15.",
    "What if there were?",
    "Deduce that 𝑥must be odd, and continue towards a\ncontradiction.\n",
    "1.4.8.16.",
    "Prove the contrapositive by cases.",
    "There will be 4 cases to consider.\n",
    "1.4.8.17.",
    "Your friend’s proof is a proof, but of what?",
    "What implication follows from\nthe given proof?",
    "Is that helpful?\n1.4.8.19.",
    "Consider the set of numbers of friends that everyone has.",
    "If everyone had a\ndifferent number of friends, this set must contain 20 elements.",
    "Is that possible?",
    "Why\nnot?\n1.4.8.20.",
    "This feels like the pigeonhole principle, although a bit more complicated.\n",
    "At least, you could try to replicate the style of proof used by the pigeonhole principle.\n",
    "How would the episodes need to be spaced out so that no two of your sixty were\nexactly 4 apart?\n1.5 · Proofs about Discrete Structures\n1.5.8 · Additional Exercises\n1.5.8.1.",
    "To prove that 𝐴⊆𝐵if and only if 𝐴∪𝐵= 𝐵, you need to prove two\nimplications:\n(a) If 𝐴⊆𝐵, then 𝐴∪𝐵= 𝐵.\n(b) If 𝐴∪𝐵= 𝐵, then 𝐴⊆𝐵.\nTo prove two sets are equal, we usually prove that each is a subset of the other.\n\n",
    "Selected Hints\n451\n2 · Graph Theory\n2.1 · Problems and Definitions\n2.1.4 · Practice Problems\n2.1.4.5. Remember that 𝑃𝑛is the path that contains 𝑛edges and 𝑛+ 1 vertices.\n",
    "2.1.5 · Additional Exercises\n2.1.5.3.",
    "Both situations are possible.",
    "Go find some examples.\n",
    "2.1.5.6.",
    "The bipartite graph is a little tricky.",
    "You will definitely want a complete\nbipartite graph, but it could be 𝐾5,5 or maybe 𝐾1,9, or . . .\n",
    "2.1.5.7.",
    "The first graph is bipartite, which can be seen by labeling it as follows.\n",
    "𝐴\n𝐵\n𝐴\n𝐵\n𝐵\nTwo of the remaining three are also bipartite.\n",
    "2.1.5.8.",
    "𝐶4 is bipartite; 𝐶5 is not.",
    "What about all the other values of 𝑛?\n2.1.5.11.",
    "You should be able to deduce everything directly from the definition.\n",
    "However, perhaps it would be helpful to know that the 𝑁stands for neighborhood.\n",
    "2.1.5.12.",
    "Be careful to make sure the edges are not “directed.”",
    "In a graph, if 𝑎is\nadjacent to 𝑏, then 𝑏is adjacent to 𝑎.",
    "In the language of relations, we say that the\nedge relation is symmetric.\n",
    "2.1.5.13.",
    "You might want to answer the questions for some specific values of 𝑛to get\na feel for them, but your final answers should be in terms of 𝑛.\n2.1.5.14.",
    "Try a small example first: Any graph with 8 vertices must have two vertices\nof the same degree.",
    "If not, what would the degree sequence be?\n2.1.5.15.",
    "Use the handshake lemma 2.1.8.",
    "What would happen if all the vertices had\ndegree 2?\n2.2 ·",
    "Trees\n2.2.7 ·",
    "Additional Exercises\n2.2.7.3.",
    "Careful: the graphs might not be connected.\n",
    "2.2.7.4.",
    "Try Exercise 2.2.7.2.\n",
    "2.2.7.5.",
    "Try a proof by contradiction, and consider a spanning tree of the graph.\n2.2.7.7.",
    "For part (b), trying some simple examples should give you the formula.",
    "Then\nyou just need to prove it is correct.\n2.2.7.8.",
    "Examining the proof of Proposition 2.2.2 gives you most of what you need,\nbut make sure to just give the relevant parts, and take care to not use proof by\n\n452\nA. Selected Hints\ncontradiction.\n",
    "2.2.7.9.",
    "Minimality here should be in terms of the number of vertices.",
    "If you had a\nminimum counterexample and removed a leaf vertex, the resulting graph will be a\nsmaller tree, so...\n2.2.7.10.",
    "If 𝑒is the root, then 𝑏will have three children (𝑎, 𝑐, and 𝑑), all of which will\nbe siblings and have 𝑏as their parent.",
    "𝑎will not have any children.\n",
    "In general, how can you determine the number of children a vertex will have, if\nit is not a root?\n2.2.7.14.",
    "There is an example with 7 edges.\n",
    "2.2.7.15.",
    "The previous exercise will be helpful.\n",
    "2.2.7.16.",
    "Note that such an edge, if removed, would disconnect the graph.",
    "We call\ngraphs that have an edge like this 1-connected.\n",
    "2.3 · Planar Graphs\n2.3.7 · Additional Exercises\n2.3.7.3.",
    "What would Euler’s formula tell you?\n2.3.7.5.",
    "You can use the handshake lemma to find the number of edges, in terms of\n𝑣, the number of vertices.\n",
    "2.3.7.11.",
    "What is the length of the shortest cycle?",
    "(This quantity is usually called the\ngirth of the graph.)\n",
    "2.3.7.14.",
    "The girth of the graph is 4.\n2.3.7.15.",
    "What has happened to the girth?",
    "Careful:",
    "We have a different number of\nedges as well.",
    "Better check Euler’s formula.\n",
    "2.4 · Euler Trails and Circuits\n2.4.6 · Additional Exercises\n2.4.6.7.",
    "This is harder than the previous three questions.",
    "Think about which “side”\nof the graph the Hamilton path would need to be on at every other step.\n",
    "2.4.6.9.",
    "If you read off the names of the students in order, you would need to read\neach student’s name exactly once, and the last name would need to be of a student\nwho was friends with the first.",
    "What sort of a cycle is this?\n2.4.6.10.",
    "Draw a graph with 6 vertices and 8 edges.",
    "What sort of walk would be\nappropriate?\n2.5 ·",
    "Coloring\n2.5.6 · Additional Exercises\n2.5.6.7.",
    "For (a), you will want the teams to be vertices and games to be edges.",
    "Which\ndoes it make sense to color?\n2.5.6.10.",
    "The chromatic number is 4.",
    "Now prove this!\n",
    "Note that you cannot use the 4-color theorem, or Brooke’s theorem, or the clique\nnumber here.",
    "In fact, this graph, called the Grötzsch graph, is the smallest graph with\n\nSelected Hints\n453\nchromatic number 4 that does not contain any triangles.\n",
    "2.5.6.13.",
    "You can color 𝐾5 in such a way that every vertex is adjacent to exactly two\nblue edges and two red edges.",
    "However, there is a graph with only 5 edges that will\nresult in a vertex incident to three edges of the same color, no matter how they are\ncolored.",
    "What is it, and how can you generalize?\n2.5.6.14.",
    "The previous exercise is useful as a starting point.\n",
    "2.8 · Chapter Summary\n· Chapter Review\n2.8.23.",
    "You might want to give the proof in two parts.",
    "First prove by induction that\nthe cycle 𝐶𝑛has 𝑣= 𝑒.",
    "Then consider what happens if the graph is more than just\nthe cycle.\n",
    "3 ·",
    "Counting\n3.2 ·",
    "Combining Outcomes\n3.2.6 ·",
    "Practice Problems\n3.2.6.9.",
    "Break the question into 4 cases.\n",
    "3.2.7 ·",
    "Additional Exercises\n3.2.7.2.",
    "For a simpler example, there are 4 divisors of 6 = 2 · 3.",
    "They are 1 = 20 · 30,\n2 = 21 · 30, 3 = 20 · 31, and 6 = 21 · 31.\n3.3 · Non-Disjoint Outcomes\n3.3.6 ·",
    "Practice Problems\n3.3.6.6.",
    "To find out how many numbers are divisible by 4 and 5, for example, take\n715/(4 · 5) and round down.\n",
    "3.3.7 · Additional Exercises\n3.3.7.1.",
    "For part (a) you could use the formula for PIE, but for part (b) you might be\nbetter off drawing a Venn diagram.\n",
    "3.3.7.2.",
    "You could consider cases.",
    "For example, any number of the form ODD-ODD-\nEVEN will have an even sum.",
    "Alternatively, how many three-digit numbers have\nthe sum of their digits even if the first two digits are 54?",
    "What if the first two digits\nare 19?\n3.4 ·",
    "Combinations and Permutations\n3.4.7 ·",
    "Additional Exercises\n3.4.7.1.",
    "If you pick any three points, you can get a triangle, unless those three points\nare all on the 𝑥-axis or on the 𝑦-axis.",
    "There are other ways to start this as well, and\nany correct method should give the same answer.\n",
    "3.5 ·",
    "Counting Multisets\n3.5.5 ·",
    "Practice Problems\n\n454\nA. Selected Hints\n3.5.5.6.",
    "The probability will be 1 divided by however many different combinations\nof 9 coins your friend could have.\n",
    "3.5.6 · Additional Exercises\n3.5.6.3.\n(b)",
    "This really requires proving four facts.",
    "That every multiset corresponds to at\nleast one diagram, and that every diagram corresponds to at least one multiset.\n",
    "Then that every multiset corresponds to at most one diagram, and that every\ndiagram corresponds to at most one multiset.",
    "In other words, we must prove\nthat the function is well defined, injective, and surjective.\n",
    "3.6 ·",
    "Combinatorial Proofs\n3.6.6 · Additional Exercises\n3.6.6.3.",
    "There will be 185 triangles.",
    "But to find them . .",
    ".\n",
    "(a) How many vertices of the triangle can be on the horizontal axis?\n(b) Will any three dots work as the vertices?\n",
    "3.6.6.4.",
    "The answer is 120.\n3.6.6.6.",
    "Try Exercise 3.6.6.5.\n3.6.6.7.",
    "What if you wanted a pair of co-maids-of-honor?\n3.6.6.8.\n",
    "For the combinatorial proof: What if you don’t yet know how many\nbridesmaids you will have?\n3.6.6.9.",
    "Count handshakes.\n",
    "3.6.6.13.",
    "This one might remind you of Example 3.6.6\n3.6.6.14.",
    "For the lattice paths, think about what sort of paths 2𝑛would count.",
    "Not all\nthe paths will end at the same point, but you could describe the set of end points as\na line.\n3.6.6.16.",
    "How many edges does 𝐾𝑛have?",
    "One of the two graphs will not be connected\n(unless 𝑗= 1 ).\n",
    "3.7 · Applications to Probability\n3.7.6 · Practice Problems\n3.7.6.7.\n(b) You could list out all the ways you can get a 6, or use sticks and stones.\n",
    "3.7.7 ·",
    "Additional Exercises\n3.7.7.4.",
    "Use complementary probabilities.",
    "And don’t be surprised if your answer is\nlarger than you would have expected.\n",
    "3.9 · Chapter Summary\n· Chapter Review\n\nSelected Hints\n455\n3.9.16.",
    "Use stars and bars.\n4 · Sequences\n4.1 · Describing Sequences\n4.1.6 · Practice Problems\n4.1.6.4.",
    "Try adding or subtracting the same small number from each term to see if\nyou recognize the sequence.\n",
    "4.1.6.5.",
    "Try adding, subtracting, or dividing each term by a constant to make the\nsequence more recognizable.\n",
    "For part (d), try expressing the sequence as the sum of two well known sequences.\n",
    "4.1.7 ·",
    "Additional Exercises\n4.1.7.8.",
    "You will want to write out the sequence, guess a closed formula, and then\nverify that you are correct.\n",
    "4.1.7.9. Write out the sequence, guess a recursive definition, and verify that the\nclosed formula is a solution to that recursive definition.\n4.1.7.12.",
    "Try an example: When you draw the 4th line, it will cross three other lines\nand so will be divided into four segments, two of which are infinite.",
    "Each segment\nwill divide a previous region into two.\n",
    "4.1.7.13. Consider three cases: The last digit is a 0, a 1, or a 2.",
    "Two of these should be\neasy to count, but strings ending in 0 cannot be proceeded by a 2, so they require a\nlittle more work.\n",
    "4.1.7.15. Think recursively, like you did in Pascal’s triangle.\n",
    "4.1.7.16.",
    "There is only one way to tile a 2 × 1 board, and two ways to tile a 2 × 2 board\n(you can orient the dominoes in two ways).",
    "In general, consider the two ways the\ndomino covering the top left corner could be oriented.\n",
    "4.2 · Rate of Growth\n4.2.7 ·",
    "Additional Exercises\n4.2.7.5.",
    "We can write the recurrence relation as\n𝑎𝑛\n𝑎𝑛−1 = 𝑟.",
    "What happens when you\nmultiply all the different versions of this recurrence relation (for different values of\n𝑛) together?\n4.2.7.6.",
    "Telescoping to find a sum.\n",
    "Using the fact that 𝑇𝑛= 𝑛(𝑛+1)\n2\n, each term in the sequence is\n2\n𝑛(𝑛+1).\n",
    "What is the result of the following fraction subtraction: 2\n3 −2\n4, or 2\n4 −2\n5?",
    "What is\nhappening in general?\n",
    "4.4 ·",
    "Exponential Sequences\n4.4.5 ·",
    "Practice Problems\n4.4.5.3.",
    "Use telescoping or iteration.\n\n",
    "456\nA. Selected Hints\n4.5 · Proof by Induction\n4.5.7 · Additional Exercises\n4.5.7.9.",
    "It is not possible to score exactly 11 points.",
    "Can you prove that you can score\n𝑛points for any 𝑛≥12?\n4.5.7.11.",
    "Start with (𝑘+ 1)-gon, and divide it up into a 𝑘-gon and a triangle.\n",
    "4.5.7.15.",
    "For the inductive step, you can assume you have a strictly increasing\nsequence up to 𝑎𝑘where 𝑎𝑘< 100.",
    "Now you just need to find the next term 𝑎𝑘+1",
    "so\nthat 𝑎𝑘< 𝑎𝑘+1 < 100.",
    "What should 𝑎𝑘+1 be?\n4.5.7.17.",
    "For the inductive case, you will need to show that (𝑘+ 1)2 + (𝑘+ 1) is even.\n",
    "Factor this out, and locate the part of it that is 𝑘2 +",
    "𝑘.",
    "What have you assumed about\nthat quantity?\n4.5.7.18.",
    "This is similar to Exercise 4.5.7.15, although there you were showing that\na sequence had all its terms less than some value, and here you are showing that\nthe sum is less than some value.",
    "But the partial sums forms a sequence, so this is\nactually very similar.\n",
    "4.5.7.19.",
    "We have already proved this without using induction, but looking at it\ninductively sheds light onto the problem (and is fun).\n",
    "The question you need to answer to complete the inductive step is, how many\nnew handshakes take place when a person 𝑘+ 1 enters the room?",
    "Why does adding\nthis give you the correct formula?\n4.5.7.20.",
    "Here’s the idea: Since every entry in Pascal’s triangle is the sum of the two\nentries above it, we can get the 𝑘+ 1st row by adding up all the pairs of entry from\nthe 𝑘th row.",
    "But doing this uses each entry on the 𝑘th row twice.",
    "Thus each time we\ndrop to the next row, we double the total.",
    "Of course, row 0 has sum 1 = 20 (the base\ncase).",
    "Now try to make this precise with a formal induction proof.",
    "You will use the\nfact that \u0000𝑛\n𝑘\n\u0001\n= \u0000𝑛−1\n𝑘−1\n\u0001\n+ \u0000𝑛−1\n𝑘\n\u0001\nfor the inductive case.\n4.5.7.21.",
    "To see why this works, try it on a copy of Pascal’s triangle.",
    "We are adding\nup the entries along a diagonal, starting with the 1 on the left-hand side of the 4th\nrow.",
    "Suppose we add up the first 5 entries on this diagonal.",
    "The claim is that the\nsum is the entry below and to the left of the last of these 5 entries.",
    "Note that if this is\ntrue, and we instead add up the first 6 entries, we will need to add the entry one spot\nto the right of the previous sum.",
    "But these two together give the entry below them,\nwhich is below and left of the last of the 6 entries on the diagonal.",
    "If you follow that,\nyou can see what is going on.",
    "But it is not a great proof.",
    "A formal induction proof is\nneeded.\n",
    "4.5.7.23.",
    "You are allowed to assume the base case.",
    "For the inductive case, group all\nbut the last function together as one sum of functions, and then apply the usual sum\nof derivatives rule, and then the inductive hypothesis.\n",
    "4.5.7.24.",
    "For the inductive step, we know by the product rule for two functions that\n( 𝑓1 𝑓2 𝑓3 · · · 𝑓𝑘𝑓𝑘+1)′ = ( 𝑓1 𝑓2 𝑓3 · · · 𝑓𝑘)′ 𝑓𝑘+1 + ( 𝑓1 𝑓2 𝑓3 · · · 𝑓𝑘) 𝑓′\n𝑘+1.\n",
    "Then use the inductive hypothesis on the first summand, and distribute.\n\n",
    "Selected Hints\n457\n4.5.7.25.",
    "You can inductively assume that from the first 𝑛−2 implications you can\ndeduce 𝑃1 →𝑃𝑛−1.",
    "Then you can use a truth table to verify that this simplified\ndeduction rule is valid.\n4.6 ·",
    "Strong Induction\n4.6.5 · Additional Exercises\n4.6.5.1.",
    "If you have three base cases, can you always be sure you can get three points\nmore?\n4.6.5.2.",
    "Start with a (𝑘+ 1)-gon, and divide it into two smaller polygons.\n",
    "4.6.5.4.",
    "As with the previous question, we will want to subtract something from 𝑛in\nthe inductive step.",
    "There we subtracted the largest power of 2 less than 𝑛.",
    "So what\nshould you subtract here?\n",
    "Note that you will still need to take care here that the sum you get from the\ninductive hypothesis, together with the number you subtracted, will be a sum of\ndistinct Fibonacci numbers.",
    "In fact, you could prove that the Fibonacci numbers in\nthe sum are non-consecutive!\n",
    "4.6.5.6.",
    "You will need to use strong induction.",
    "For the inductive case, try multiplying\n\u0010\n𝑥𝑘+ 1\n𝑥𝑘\n\u0011 \u0000𝑥+ 1\n𝑥\n\u0001\n, and collect which terms together are integers.\n",
    "4.6.5.8.",
    "You will need three base cases.",
    "This is a very good hint actually, as it suggests\nthat to prove 𝑃(𝑛) is true, you would want to use the fact that 𝑃(𝑛−3) is true.",
    "So\nsomehow you need to increase the number of squares by 3.\n4.7 · Chapter Summary\n· Chapter Review\n4.7.14.\n(a) (𝑛+ 1)𝑛+1 > (𝑛+ 1) · 𝑛𝑛.\n(b)",
    "This should be similar to the other sum proofs.",
    "The last bit comes down to\nadding fractions.\n",
    "(c) Write 4𝑘+1 −1 = 4 · 4𝑘−4 + 3.\n(d)",
    "One 9-cent stamp is 1 more than two 4-cent stamps, and seven 4-cent stamps is\n1 more than three 9-cent stamps.\n",
    "(e) Be careful to actually use induction here.",
    "The base case: 22 = 4.",
    "The inductive\ncase: Assume (2𝑛)2 is divisible by 4, and consider (2𝑛+ 2)2 = (2𝑛)2 + 4𝑛+ 4.\n",
    "This is divisible by 4 because 4𝑛+ 4 clearly is, and by our inductive hypothesis,\nso is (2𝑛)2.\n4.7.15.",
    "This is a straight-forward induction proof.",
    "Note that you will need to simplify\n\u0010\n𝑛(𝑛+1)\n2\n\u00112\n+ (𝑛+ 1)3 and get\n\u0010\n(𝑛+1)(𝑛+2)\n2\n\u00112\n.\n\n458\nA. Selected Hints\n4.7.16.",
    "There are two base cases 𝑃(0) and 𝑃(1).",
    "Then, for the inductive case, assume\n𝑃(𝑘) is true for all 𝑘< 𝑛. This allows you to assume 𝑎𝑛−1 = 1 and 𝑎𝑛−2 = 1.",
    "Apply\nthe recurrence relation.\n",
    "5 · Discrete Structures Revisited\n5.1 ·",
    "Sets\n5.1.5 · Exercises\n5.1.5.7.",
    "You should be able to write all of them out.",
    "Don’t forget 𝐴and 𝐵, which are\nalso candidates for 𝐶.\n5.1.5.14.",
    "It might help to think about what the union 𝐴2 ∪𝐴3 is first.",
    "Then think\nabout what numbers are not in that union.",
    "What will happen when you also include\n𝐴5?\n",
    "5.1.5.17.",
    "We are looking for a set containing 16 sets.\n",
    "5.1.5.18.",
    "Write these out, or at least start to and look for a pattern.\n",
    "5.1.5.29.",
    "It looks like you should be able to define the set 𝐴like this.",
    "But consider\nthe two possible values for |𝐴|.\n",
    "5.2 · Functions\n5.2.4 · Exercises\n5.2.4.2.",
    "Since the domain and codomain are the same size, is it possible for a function\nto be injective but not surjective, or surjective but not injective?\n5.2.4.20.",
    "Work with some examples.",
    "What if 𝑓=\n\u0012\n1\n2\n3\n𝑎\n𝑎\n𝑏\n\u0013\nand 𝑔=\n\u0012\n𝑎\n𝑏\n𝑐\n5\n6\n7\n\u0013\n?\n5.2.4.25.",
    "To find the recurrence relation, consider how many new handshakes occur\nwhen person 𝑛+ 1 enters the room.\n",
    "5.2.4.29.",
    "One of these is not always true.",
    "Try some examples!\n",
    "6 · Additional Topics\n6.1 · Generating Functions\n6.1.5 · Exercises\n6.1.5.10.",
    "You should “multiply” the two sequences.\n",
    "6.2 · Introduction to Number Theory\n6.2.6 · Exercises\n6.2.6.13.",
    "First reduce each number modulo 9, which can be done by adding up the\ndigits of the numbers.\n6.2.6.18.",
    "Solve the Diophantine equation 13𝑥+ 20𝑦= 2 (why?).",
    "Then consider which\nvalue of 𝑘(the parameter in the solution) is optimal.\n\n",
    "Appendix B\nSelected Solutions\n1 · Logic and Proofs\n1.1 · Mathematical Statements\n1.1.5 ·",
    "Practice Problems\n1.1.5.4.\n",
    "Some people can be fooled all of the time.\n",
    "∃𝑥∀𝑦𝑃(𝑥, 𝑦)\nEveryone can be fooled sometimes.\n",
    "∀𝑥∃𝑦𝑃(𝑥, 𝑦)\n",
    "It is always true that some people can be fooled.\n",
    "∀𝑦∃𝑥𝑃(𝑥, 𝑦)\n",
    "Sometimes everyone can be fooled.\n",
    "∃𝑦∀𝑥𝑃(𝑥, 𝑦)\n1.1.5.5.\nA. Correct.\n",
    "B. Incorrect.\n",
    "C. Incorrect.\n",
    "D. Incorrect.\n",
    "1.1.5.6.\nA. Correct.\n",
    "B. Incorrect.\n",
    "Careful, 𝑃(𝑥, 𝑦) means 𝑥is less than 𝑦, not 𝑥is less than or equal to 𝑦.\nC. Incorrect.\n",
    "D. Incorrect.\n",
    "E. Correct.\n",
    "1.1.5.7.\n(a) 𝑃(15) is true, since 17 · 15 + 1 = 256 is even.\n",
    "(b) Since 𝑃(15) is true, we know that ∃𝑥𝑃(𝑥) is true.",
    "There is at least one 𝑥for\nwhich 𝑃(𝑥) is true.\n",
    "(c) Just because one value of 𝑥makes 𝑃(𝑥) true does not mean that all values of 𝑥\nmake 𝑃(𝑥) true.",
    "But it could be.",
    "So we cannot conclude that ∀𝑥𝑃(𝑥) is true or\nfalse.\n",
    "1.1.5.8.\n(a) 𝑃(15) is false, since 18 · 15 + 1 = 271 is odd.\n",
    "459\n\n460\nB. Selected Solutions\n(b) Since 𝑃(15) is false, we do not know whether ∃𝑥𝑃(𝑥) is true.",
    "There could be\nsome other value of 𝑥for which 𝑃(𝑥) is true.\n",
    "(c) We know that there is some value of 𝑥makes 𝑃(𝑥) false",
    "so we know that\n∀𝑥𝑃(𝑥) is false.\n",
    "1.1.5.9.\nA. Incorrect.\n",
    "B. Incorrect.\n",
    "C. Correct.\n",
    "D. Correct.\n",
    "1.1.6 · Additional Exercises\n1.1.6.1.\n(a) 𝑃∧𝑄.\n(b) 𝑃→¬𝑄.\n(c) Jack passed math or Jill passed math (or both).\n",
    "(d) If Jack and Jill did not both pass math, then Jill did.\n",
    "(e)\ni. Nothing else.\nii.",
    "Jack did not pass math either.\n",
    "1.1.6.2.\n",
    "(a) ¬∃𝑥(𝐸(𝑥) ∧𝑂(𝑥)).\n",
    "(b) ∀𝑥(𝐸(𝑥) →𝑂(𝑥+ 1)).\n",
    "(c) ∃𝑥(𝑃(𝑥) ∧𝐸(𝑥))",
    "(where 𝑃(𝑥) means “𝑥is prime”).\n",
    "(d) ∀𝑥∀𝑦∃𝑧(𝑥< 𝑧< 𝑦∨𝑦< 𝑧< 𝑥).\n",
    "(e) ∀𝑥¬∃𝑦(𝑥< 𝑦< 𝑥+ 1).\n",
    "1.2 · Implications\n1.2.5 ·",
    "Practice Problems\n1.2.5.1.",
    "The main thing to realize is that we do not know the colors of these two\nshapes, but we do know that we are in one of three cases: We could have a purple\ncircle and orange pentagon.",
    "We could have a circle that was not purple but a orange\npentagon.",
    "Or we could have a circle that was not purple and a pentagon that was\nnot orange.",
    "The case in which the circle is purple but the pentagon is not orange\ncannot occur, as that would make the statement false.\n\nSelected Solutions\n461\n1.2.5.2.",
    "The only way for an implication 𝑃→𝑄to be true but its converse to be false\nis for 𝑄to be true and 𝑃to be false.",
    "Thus we know that circle is purple and that\nsquare is not yellow.\n",
    "1.2.5.3.",
    "The converse is \"If I will give you a cow, then you will give me magic beans.",
    "\"\nThe contrapositive is \"If I will not give you a cow, then you will not give me magic\nbeans.\"",
    "All the other statements are neither the converse nor contrapositive.\n",
    "1.2.6 ·",
    "Additional Exercises\n1.2.6.1.\n(a) Any even number plus 2 is an even number.\n",
    "(b) For any 𝑥there is a 𝑦such that sin(𝑥) = 𝑦.",
    "In other words, every number 𝑥is\nin the domain of sine.\n",
    "(c) For every 𝑦there is an 𝑥such that sin(𝑥) = 𝑦.",
    "In other words, every number 𝑦\nis in the range of sine (which is false).\n",
    "(d) For any numbers, if the cubes of two numbers are equal, then the numbers are\nequal.\n",
    "1.2.6.3.\n(a) If you have lost weight, then you exercised.\n",
    "(b) If you exercise, then you will lose weight.\n",
    "(c) If you are American, then you are patriotic.\n",
    "(d) If you are patriotic, then you are American.\n",
    "(e) If a number is rational, then it is real.\n",
    "(f)",
    "If a number is not even, then it is prime.",
    "(Or the contrapositive: If a number is\nnot prime, then it is even.)\n",
    "(g) If the Broncos don’t win the Super Bowl, then they didn’t play in the Super\nBowl.",
    "Alternatively, if the Broncos play in the Super Bowl, then they will win\nthe Super Bowl.\n1.2.6.5.",
    "It is true that in order for a function to be differentiable at a point 𝑐, it is\nnecessary for the function to be continuous at 𝑐.",
    "However, it is not necessary that a\nfunction be differentiable at 𝑐for it to be continuous at 𝑐.\n",
    "It is true that to be continuous at a point 𝑐, it is sufficient that the function be\ndifferentiable at 𝑐.",
    "However, it is not the case that being continuous at 𝑐is sufficient\nfor a function to be differentiable at 𝑐.\n1.3 · Rules of Logic\n1.3.7 · Practice Problems\n\n462\nB. Selected Solutions\n1.3.7.1.",
    "If you think about what this statement is saying, it makes sense that it is a\ntautology (that it is true in every case).",
    "The complete truth table is:\n𝑃\n𝑄\n𝑃∧𝑄\n𝑃∨𝑄\n(𝑃∧𝑄) →(𝑃∨𝑄))\nT\nT\nT\nT\nT\nT\nF\nF\nT\nT\nF\nT\nF\nT\nT\nF\nF\nF\nF\nT\n1.3.7.2.",
    "The truth table is:\n𝑃\n𝑄\n¬𝑄\n𝑄→𝑃\n¬𝑄∨(𝑄→𝑃))\nT\nT\nF\nT\nT\nT\nF\nT\nT\nT\nF\nT\nF\nF\nF\nF\nF\nT\nT\nT\n",
    "If this statement is false, we must be in the third row, making 𝑃false and 𝑄true.\n",
    "1.3.7.3.",
    "The complete truth table is:\n𝑃\n𝑄\n𝑅\n¬𝑃\n¬𝑃∨𝑅\n𝑄→(¬𝑃∨𝑅)\nT\nT\nT\nF\nT\nT\nT\nT\nF\nF\nF\nF\nT\nF\nT\nF\nT\nT\nT\nF\nF\nF\nF\nT\nF\nT\nT\nT\nT\nT\nF\nT\nF\nT\nT\nT\nF\nF\nT\nT\nT\nT\nF\nF\nF\nT\nT\nT\n1.3.7.4.",
    "The complete truth table is:\n𝑃\n𝑄\n𝑅\n𝑃→(𝑄∨𝑅)\n(𝑃→𝑄) ∨(𝑃→𝑅)\nT\nT\nT\nT\nT\nT\nT\nF\nT\nT\nT\nF\nT\nT\nT\nT\nF\nF\nF\nF\nF\nT\nT\nT\nT\nF\nT\nF\nT\nT\nF\nF\nT\nT\nT\nF\nF\nF\nT\nT\nSince the two columns are identical, the statements are logically equivalent.\n",
    "1.3.7.5.",
    "The complete truth table is:\n\nSelected Solutions\n463\n𝑃\n𝑄\n𝑃→𝑄\n¬𝑄\n¬𝑃\nT\nT\nT\nF\nF\nT\nF\nF\nT\nF\nF\nT\nT\nF\nT\nF\nF\nT\nT\nT\nThere is only one row in which both premises are true (row 4).",
    "In this row, the\nconclusion is also true.",
    "Thus the deduction rule is valid.\n",
    "1.3.7.6.",
    "The complete truth table is:\n𝑃\n𝑄\n𝑅\n𝑃→(𝑄∨𝑅)\n¬(𝑃→𝑄)\nT\nT\nT\nT\nF\nT\nT\nF\nT\nF\nT\nF\nT\nT\nT\nT\nF\nF\nF\nT\nF\nT\nT\nT\nF\nF\nT\nF\nT\nF\nF\nF\nT\nT\nF\nF\nF\nF\nT\nF\nThere is only one row in which both premises are true (row 3).",
    "In this row, the\nconclusion is also true, so the deduction rule is valid.\n",
    "1.3.7.7.",
    "The complete truth table is:\n𝑃\n𝑄\n𝑅\n(𝑃∧𝑄) →𝑅\n¬𝑃∨¬𝑄\n¬𝑅\nT\nT\nT\nT\nF\nF\nT\nT\nF\nF\nF\nT\nT\nF\nT\nT\nT\nF\nT\nF\nF\nT\nT\nT\nF\nT\nT\nT\nT\nF\nF\nT\nF\nT\nT\nT\nF\nF\nT\nT\nT\nF\nF\nF\nF\nT\nT\nT\n",
    "In rows 3, 5 and 7 both of the premises are true, but the conclusion is false.",
    "Thus the\ndeduction rule is not valid.\n",
    "1.3.7.8.",
    "The complete truth table is:\n\n464\nB. Selected Solutions\n𝑃\n𝑄\n𝑅\n𝑃→𝑄\n𝑃∧¬𝑄\nT\nT\nT\nT\nF\nT\nT\nF\nT\nF\nT\nF\nT\nF\nT\nT\nF\nF\nF\nT\nF\nT\nT\nT\nF\nF\nT\nF\nT\nF\nF\nF\nT\nT\nF\nF\nF\nF\nT\nF\nThere is no row in which both premises are true (indeed, these are contradictory\npremises; the second is the negation of the first).",
    "Thus every row in which both\npremises are true (i.e., no row), the conclusion is also true.",
    "Therefore the deduction\nrule is valid.",
    "(This is an example of how everything follows from a contradiction.)\n",
    "1.3.7.9.\nA. Correct.\n",
    "B. Incorrect.\n",
    "C. Incorrect.\n",
    "D. Incorrect.\n",
    "1.3.8 ·",
    "Additional Exercises\n1.3.8.3.\n(a) 𝑃:",
    "It’s your birthday; 𝑄: There will be cake.",
    "(𝑃∨𝑄) →𝑄\n(b) Hint: You should get three T’s and one F.\n(c) Only that there will be cake.\n",
    "(d) It’s NOT your birthday!\n(e) It’s your birthday, but the cake is a lie.\n",
    "1.3.8.5.",
    "Make a truth table for each and compare.",
    "The statements are logically\nequivalent.\n",
    "1.3.8.6.\n",
    "(a) 𝑃∧𝑄.\n(b) (¬𝑃∨¬𝑅) →(𝑄∨¬𝑅) or, replacing the implication with a disjunction first:\n(𝑃∧𝑄) ∨(𝑄∨¬𝑅).\n",
    "(c) (𝑃∧𝑄) ∧(𝑅∧¬𝑅).",
    "This is necessarily false, so it is also equivalent to 𝑃∧¬𝑃.\n(d)",
    "Either Sam is a woman and Chris is a man, or Chris is a woman.\n\n",
    "Selected Solutions\n465\n1.3.8.16.\n",
    "(a) ∀𝑥∃𝑦(𝑂(𝑥) ∧¬𝐸(𝑦)).\n",
    "(b) ∃𝑥∀𝑦(𝑥≥𝑦∨∀𝑧(𝑥≥𝑧∧𝑦≥𝑧)).\n",
    "(c) There is a number 𝑛for which every other number is strictly greater than 𝑛.\n(d)",
    "There is a number 𝑛which is not between any other two numbers.\n",
    "1.4 ·",
    "Proofs\n1.4.7 · Practice Problems\n1.4.7.1.\n",
    "• Let 𝑛be an arbitrary integer, and assume 𝑛is even.\n",
    "•",
    "Since the product of any number with an even number is even,\n• 7𝑛must be even.\n",
    "1.4.7.2.\n",
    "• Let 𝑛be an arbitrary integer, and assume 𝑛is odd.\n",
    "• Since 7 is odd and the product of an odd number and an odd number is odd,\n• 7𝑛must be odd.\n",
    "1.4.7.3.\n",
    "• Let 𝑎and 𝑏be integers, and assume both are even.\n",
    "• The sum of two even integers must also be even.\n",
    "•",
    "Therefore 𝑎+ 𝑏is even.\n",
    "1.4.7.4.\n",
    "• Let 𝑎and 𝑏be integers, and assume that 𝑎+ 𝑏is odd but 𝑎and 𝑏are both even.\n",
    "• The sum of two even integers must also be even.\n",
    "•",
    "But then 𝑎+ 𝑏is both even and odd, a contradiction.\n",
    "1.4.7.6.\n",
    "Assume 𝑓: 𝐴→𝐵is a bĳection\nDirect proof\nAssume |𝐴|",
    "≠|𝐵|\nProof by contrapositive\nAssume 𝑓: 𝐴→𝐵is a bĳection and |𝐴| ≠|𝐵|\nProof by contradiction\n1.4.8 · Additional Exercises\n1.4.8.1.\n(a)",
    "The claim that ∀𝑥𝑃(𝑥) means that 𝑃(𝑛) is true no matter what 𝑛you consider\nin the domain of discourse.",
    "Thus the only way to prove that ∀𝑥𝑃(𝑥) is true is\n\n466\nB. Selected Solutions\nto check or otherwise argue that 𝑃(𝑛) is true for all 𝑛in the domain.\n",
    "(b) To prove ∀𝑥𝑃(𝑥) is false all you need is one example of an element in the\ndomain for which 𝑃(𝑛) is false.",
    "This is often called a counterexample.\n",
    "(c) We are simply claiming that there is some element 𝑛in the domain of discourse\nfor which 𝑃(𝑛) is true.",
    "If you can find one such element, you have verified the\nclaim.\n",
    "(d)",
    "Here we are claiming that no element we find will make 𝑃(𝑛) true.",
    "The only\nway to be sure of this is to verify that every element of the domain makes 𝑃(𝑛)\nfalse.",
    "Note that the level of proof needed for this statement is the same as to\nprove that ∀𝑥𝑃(𝑥) is true.\n",
    "1.4.8.2.\n",
    "(a) For all integers 𝑎and 𝑏, if 𝑎or 𝑏is not even, then 𝑎+ 𝑏is not even.\n",
    "(b) For all integers 𝑎and 𝑏, if 𝑎and 𝑏are even, then 𝑎+ 𝑏is even.\n",
    "(c) There are numbers 𝑎and 𝑏such that 𝑎+ 𝑏is even but 𝑎and 𝑏are not both\neven.\n",
    "(d) False.",
    "For example, 𝑎= 3 and 𝑏= 5.",
    "𝑎+ 𝑏= 8, but neither 𝑎nor 𝑏is even.\n",
    "(e) False, since it is equivalent to the original statement.\n",
    "(f) True.",
    "Let 𝑎and 𝑏be integers.",
    "Assume both are even.",
    "Then 𝑎= 2𝑘and 𝑏= 2𝑗\nfor some integers 𝑘and 𝑗.",
    "But then 𝑎+ 𝑏= 2𝑘+ 2𝑗= 2(𝑘+ 𝑗), which is even.\n",
    "(g) True, since the statement is false.\n",
    "1.4.8.3.\n(a) Proof by contradiction.",
    "Start of proof: Assume, for the sake of contradiction,\nthat there are integers 𝑥and 𝑦such that 𝑥is a prime greater than 5 and\n𝑥= 6𝑦+ 3.",
    "End of proof: . . .",
    "this is a contradiction, so there are no such\nintegers.\n",
    "(b) Direct proof.",
    "Start of proof: Let 𝑛be an integer.",
    "Assume 𝑛is a multiple of 3.\nEnd of proof: Therefore 𝑛can be written as the sum of consecutive integers.\n",
    "(c) Proof by contrapositive.",
    "Start of proof: Let 𝑎and 𝑏be integers.",
    "Assume that 𝑎\nand 𝑏are even.",
    "End of proof: Therefore 𝑎2 + 𝑏2 is even.\n",
    "1.4.8.4.\n(a) Direct proof.\n",
    "Proof.\n",
    "Let 𝑛be an integer.",
    "Assume 𝑛is even.",
    "Then 𝑛= 2𝑘for some integer 𝑘.\n",
    "Thus 8𝑛= 16𝑘= 2(8𝑘).",
    "Therefore 8𝑛is even.\n",
    "■\n(b) The converse is false.",
    "That is, there is an integer 𝑛such that 8𝑛is",
    "even but 𝑛is\n\nSelected Solutions\n467\nodd.",
    "For example, consider 𝑛= 3.",
    "Then 8𝑛= 24 which is even, but 𝑛= 3 is\nodd.\n",
    "1.4.8.5.\n",
    "(a) This is an example of the pigeonhole principle.",
    "We can prove it by contraposi-\ntive.\nProof.\n",
    "Suppose that each number only came up 6 or fewer times.",
    "So there are\nat most six 1’s, six 2’s, and so on.",
    "That’s a total of 36 dice, so you must not have\nrolled all 40 dice.\n",
    "■\n(b) We can have 9 dice without any four matching or any four being all different:\nthree 1’s, three 2’s, three 3’s.",
    "We will prove that whenever you roll 10 dice, you\nwill always get four matching or all being different.\nProof.\n",
    "Suppose you roll 10 dice, but that there are NOT four matching rolls.\n",
    "This means that at most there are three of any given value.",
    "If we only had\nthree different values, that would be only 9 dice, so there must be 4 different\nvalues, giving 4 dice that are all different.\n",
    "■\n1.5 · Proofs about Discrete Structures\n1.5.7 · Practice Problems\n1.5.7.1.\nA. Incorrect.\n",
    "B. Correct.\nC. Incorrect.\n",
    "D. Incorrect.\n",
    "This would be a good start to a proof by contradiction or contrapositive, not a\ndirect proof.\n",
    "1.5.7.2.\nA. Incorrect.\n",
    "B. Correct.\nC. Incorrect.\n",
    "D. Incorrect.\n",
    "This would be a good start to a direct proof, not a proof by contradiction.\n",
    "1.5.7.3.\n",
    "• Suppose 𝐵⊆𝐴∩𝐵, and let 𝑏be an element of 𝐵.\n• Then 𝑏is an element of 𝐴∩𝐵since 𝐵⊆𝐴∩𝐵.\n\n468\nB. Selected Solutions\n• Since 𝐴∩𝐵contains all the elements that are in both 𝐴and 𝐵, 𝑏is an element\nof 𝐴.\n•",
    "Therefore 𝐵⊆𝐴.\n1.5.7.4.\n",
    "•",
    "First we will prove that (𝐴∩𝐵) ∪𝐴⊆𝐴.\n• Let 𝑥be an element of (𝐴∩𝐵) ∪𝐴.\n• Then 𝑥is an element of 𝐴∩𝐵, or 𝑥is an element of 𝐴.\n•",
    "So in particular, 𝑥is an element of 𝐴.\n• Therefore (𝐴∩𝐵) ∪𝐴⊆𝐴.\n• Second, we will prove that 𝐴⊆(𝐴∩𝐵) ∪𝐴.\n• Let 𝑥be an element of 𝐴.\n• Then 𝑥is an element of (𝐴∩𝐵) ∪𝐴, since 𝑥is in 𝐴or in the other set.\n",
    "•",
    "Therefore 𝐴⊆(𝐴∩𝐵) ∪𝐴.\n• Since (𝐴∩𝐵) ∪𝐴⊆𝐴and 𝐴⊆(𝐴∩𝐵) ∪𝐴, we have (𝐴∩𝐵) ∪𝐴= 𝐴.\n1.5.7.5.\n• Suppose 𝐵1 ⊆𝐵2.\n",
    "• Let 𝑎be an element of 𝑓−1(𝐵1).\n",
    "•",
    "This means that 𝑓(𝑎) is an element of 𝐵1.\n",
    "•",
    "Since 𝐵1 ⊆𝐵2, 𝑓(𝑎) is an element of 𝐵2.\n",
    "•",
    "This then means that 𝑎is an element of 𝑓−1(𝐵2).\n",
    "• Therefore 𝑓−1(𝐵1) ⊆𝑓−1(𝐵2).\n",
    "1.6 · Chapter Summary\n· Chapter Review\n1.6.1.\n\nSelected Solutions\n469\n𝑃\n𝑄\n𝑅\n¬𝑃→(𝑄∧𝑅)\nT\nT\nT\nT\nT\nT\nF\nT\nT\nF\nT\nT\nT\nF\nF\nT\nF\nT\nT\nT\nF\nT\nF\nF\nF\nF\nT\nF\nF\nF\nF\nF\n1.6.2.",
    "Peter is not tall, and Robert is not skinny.",
    "You must be in row 6 in the truth\ntable above.\n",
    "1.6.3.",
    "Yes.",
    "To see this, make a truth table for each statement and compare.\n",
    "1.6.4.",
    "Make a truth table that includes all three statements in the argument:\n𝑃\n𝑄\n𝑅\n𝑃→𝑄\n𝑃→𝑅\n𝑃→(𝑄∧𝑅)\nT\nT\nT\nT\nT\nT\nT\nT\nF\nT\nF\nF\nT\nF\nT\nF\nT\nF\nT\nF\nF\nF\nF\nF\nF\nT\nT\nT\nT\nT\nF\nT\nF\nT\nT\nT\nF\nF\nT\nT\nT\nT\nF\nF\nF\nT\nT\nT\nNotice that in every row for which both 𝑃→𝑄and 𝑃→𝑅is true, so is 𝑃→(𝑄∧𝑅).\n",
    "Therefore, whenever the premises of the argument are true, so is the conclusion.",
    "In\nother words, the deduction rule is valid.\n",
    "1.6.5.\n(a) Negation: The power goes off, and the food does not spoil.\n",
    "Converse: If the food spoils, then the power went off.\n",
    "Contrapositive: If the food does not spoil, then the power did not go off.\n",
    "(b) Negation: The door is closed, and the light is on.\n",
    "Converse: If the light is off, then the door is closed.\n",
    "Contrapositive: If the light is on, then the door is open.\n",
    "(c) Negation: ∃𝑥(𝑥< 1 ∧𝑥2 ≥1)\nConverse: ∀𝑥(𝑥2 < 1 →𝑥< 1)\nContrapositive: ∀𝑥(𝑥2 ≥1 →𝑥≥1).\n",
    "(d) Negation: There is a natural number 𝑛which is prime but not solitary.\n\n",
    "470\nB. Selected Solutions\nConverse: For all natural numbers 𝑛, if 𝑛is solitary, then 𝑛is prime.\n",
    "Contrapositive: For all natural numbers 𝑛, if 𝑛is not solitary, then 𝑛is not\nprime.\n",
    "(e) Negation: There is a function which is differentiable and not continuous.\n",
    "Converse: For all functions 𝑓, if 𝑓is continuous, then 𝑓is differentiable.\n",
    "Contrapositive: For all functions 𝑓, if 𝑓is not continuous then 𝑓is not\ndifferentiable.\n",
    "(f) Negation: There are integers 𝑎and 𝑏for which 𝑎· 𝑏is even but 𝑎or 𝑏is odd.\n",
    "Converse: For all integers 𝑎and 𝑏, if 𝑎and 𝑏are even, then 𝑎𝑏is even.\n",
    "Contrapositive: For all integers 𝑎and 𝑏, if 𝑎or 𝑏is odd, then 𝑎𝑏is odd.\n",
    "(g) Negation: There are integers 𝑥and 𝑦such that for every integer 𝑛, 𝑥> 0",
    "and\n𝑛𝑥≤𝑦.\nConverse: For every integer 𝑥and every integer 𝑦there is an integer 𝑛such\nthat if 𝑛𝑥> 𝑦, then 𝑥> 0.\n",
    "Contrapositive: For every integer 𝑥and every integer 𝑦there is an integer 𝑛\nsuch that if 𝑛𝑥≤𝑦, then 𝑥≤0.\n",
    "(h) Negation: There are real numbers 𝑥and 𝑦such that 𝑥𝑦= 0, but 𝑥≠0 and\n𝑦≠0.\n",
    "Converse: For all real numbers 𝑥and 𝑦, if 𝑥= 0 or 𝑦= 0, then 𝑥𝑦= 0\nContrapositive: For all real numbers 𝑥and 𝑦, if 𝑥≠0 and 𝑦≠0, then 𝑥𝑦≠0.\n(i) Negation: There is at least one student in Math 228 who does not understand\nimplications but will still pass the exam.\n",
    "Converse: For every student in Math 228, if they fail the exam, then they did\nnot understand implications.\n",
    "Contrapositive: For every student in Math 228, if they pass the exam, then\nthey understood implications.\n1.6.6.\n",
    "(a) The statement is true.",
    "If 𝑛is an even integer less than or equal to 7, then the\nonly way it could not be negative is if 𝑛was equal to 0, 2, 4, or 6.\n(b) There is an integer 𝑛such that 𝑛is even and 𝑛≤7, but 𝑛is not negative and\n𝑛∉{0, 2, 4, 6}.",
    "This is false, since the original statement is true.\n",
    "(c) For all integers 𝑛, if 𝑛is not negative and 𝑛∉{0, 2, 4, 6}, then 𝑛is odd or 𝑛> 7.\n",
    "This is true, since the contrapositive is equivalent to the original statement\n(which is true).\n",
    "(d) For all integers 𝑛, if 𝑛is negative or 𝑛∈{0, 2, 4, 6}, then 𝑛is even and 𝑛≤7.\n",
    "This is false.",
    "𝑛= −3 is a counterexample.\n\n",
    "Selected Solutions\n471\n1.6.7.\n",
    "(a) For any number 𝑥, if it is the case that adding any number to 𝑥gives that\nnumber back, then multiplying any number by 𝑥will give 0.",
    "This is true (of\nthe integers or the reals).",
    "The “if” part only holds if 𝑥= 0, and in that case,\nanything times 𝑥will be 0.\n",
    "(b) The converse in words is this: For any number 𝑥, if everything times 𝑥is zero,\nthen everything added to 𝑥gives itself.",
    "Or in symbols: ∀𝑥(∀𝑧(𝑥· 𝑧= 0) →\n∀𝑦(𝑥+ 𝑦= 𝑦)).",
    "The converse is true: The only number which when multiplied\nby any other number gives 0 is 𝑥= 0.",
    "And if 𝑥= 0, then 𝑥+ 𝑦= 𝑦.\n(c)",
    "The contrapositive in words is: For any number 𝑥, if there is some number\nwhich when multiplied by 𝑥does not give zero, then there is some number\nwhich when added to 𝑥does not give that number.",
    "In symbols: ∀𝑥(∃𝑧(𝑥· 𝑧≠\n0) →∃𝑦(𝑥+ 𝑦≠𝑦)).",
    "We know the contrapositive must be true because the\noriginal implication is true.\n",
    "(d)",
    "The negation: There is a number 𝑥such that any number added to 𝑥gives the\nnumber back again, but there is a number you can multiply 𝑥by and not get\n0.",
    "In symbols: ∃𝑥(∀𝑦(𝑥+ 𝑦= 𝑦) ∧∃𝑧(𝑥· 𝑧≠0)).",
    "Of course since the original\nimplication is true, the negation is false.\n",
    "1.6.8.\n(a) (¬𝑃∨𝑄) ∧(¬𝑅∨(𝑃∧¬𝑅)).\n",
    "(b) ∀𝑥∀𝑦∀𝑧(𝑧= 𝑥+ 𝑦∧∀𝑤(𝑥−𝑦≠𝑤)).\n",
    "1.6.9.\n(a) Direct proof.\n",
    "Proof.\n",
    "Let 𝑛be an integer.",
    "Assume 𝑛is odd.",
    "So 𝑛= 2𝑘+ 1 for some integer 𝑘.\n",
    "Then\n7𝑛= 7(2𝑘+ 1) = 14𝑘+ 7 = 2(7𝑘+ 3)",
    "+ 1.\n",
    "Since 7𝑘+ 3 is an integer, we see that 7𝑛is odd.\n",
    "■\n(b) The converse is: For all integers 𝑛, if 7𝑛is odd, then 𝑛is odd.",
    "We will prove\nthis by contrapositive.\nProof.\n",
    "Let 𝑛be an integer.",
    "Assume 𝑛is not odd.",
    "Then 𝑛= 2𝑘for some integer\n𝑘.",
    "So 7𝑛=",
    "14𝑘= 2(7𝑘) which is to say 7𝑛is even.",
    "Therefore 7𝑛is not odd.",
    "■\n1.6.10.\n",
    "(a) Suppose you only had 5 coins of each denomination.",
    "This means you have 5\npennies, 5 nickels, 5 dimes, and 5 quarters.",
    "This is a total of 20 coins.",
    "But you\nhave more than 20 coins, so you must have more than 5 of at least one type.\n\n",
    "472\nB. Selected Solutions\n(b) Suppose you have 22 coins, including 2𝑘nickels, 2𝑗dimes, and 2𝑙quarters (so\nan even number of each of these three types of coins).",
    "The number of pennies\nyou have will then be\n22 −2𝑘−2𝑗−2𝑙= 2(11 −𝑘−𝑗−𝑙).\n",
    "But this says that the number of pennies is also even (it is 2 times an integer).\n",
    "Thus we have established the contrapositive of the statement, “If you have an\nodd number of pennies, then you have an odd number of at least one other\ncoin type.”\n(c) You need 10 coins.",
    "You could have 3 pennies, 3 nickels, and 3 dimes.",
    "The 10th\ncoin must either be a quarter, giving you 4 coins that are all different, or else a\n4th penny, nickel, or dime.",
    "To prove this, assume you don’t have 4 coins that\nare all the same or all different.",
    "In particular, this says that you only have 3\ncoin types, and each of those types can only contain 3 coins, for a total of 9\ncoins, which is less than 10.\n2 ·",
    "Graph Theory\n2.1 · Problems and Definitions\n2.1.4 · Practice Problems\n2.1.4.1.",
    "The graphs in (a) and (c) are isomorphic to 𝐺.\n2.1.4.2.",
    "Graphs (a) and (c) are isomorphic to each other.",
    "So are graphs (b) and (d).\n",
    "2.1.4.3. 𝐺1 has 24 edges.",
    "𝑘= 2 for 𝐺2.",
    "𝐺3 has 8 vertices.\n",
    "2.1.4.4.",
    "The graph must have 29 edges.\n",
    "2.1.4.5.\n(a) The largest 𝑛such that 𝑃𝑛is a subgraph of 𝐾5 is 4.\n(b) The largest 𝑛such that 𝐶𝑛is a subgraph of 𝐾5 is 5.\n(c) The largest 𝑛such that 𝑃𝑛is an induced subgraph of 𝐾5 is 1.\n(d) The largest 𝑛such that 𝐶𝑛is an induced subgraph of 𝐾5 is 3.\n",
    "2.1.5 · Additional Exercises\n2.1.5.1.",
    "This is asking for the number of edges in 𝐾10.",
    "Each vertex (person) has\ndegree (shook hands with) 9 (people).",
    "So the sum of the degrees is 90.",
    "However, the\ndegrees count each edge (handshake) twice, so there are 45 edges in the graph.",
    "That\nis how many handshakes took place.\n",
    "2.1.5.2.",
    "It is possible for everyone to be friends with exactly 2 people.",
    "You could\narrange the 5 people in a circle and say that everyone is friends with the two people\non either side of them (so you get the graph 𝐶5).",
    "However, it is not possible for\neveryone to be friends with 3 people.",
    "That would lead to a graph with an odd\nnumber of odd degree vertices which is impossible since the sum of the degrees\n\nSelected Solutions\n473\nmust be even.\n",
    "2.1.5.4.",
    "The graphs are not equal.",
    "For example, graph 1 has an edge {𝑎, 𝑏}, but\ngraph 2 does not have that edge.",
    "They are isomorphic.",
    "One possible isomorphism is\n𝑓: 𝐺1 →𝐺2 defined by 𝑓(𝑎) = 𝑑, 𝑓(𝑏)",
    "= 𝑐, 𝑓(𝑐) = 𝑒, 𝑓(𝑑) = 𝑏, 𝑓(𝑒)",
    "= 𝑎.\n2.1.5.9.\n(a) For example:\n(b)",
    "This is not possible if we require the graphs to be connected.",
    "If not, we could\ntake 𝐶8 as one graph and two copies of 𝐶4 as the other.\n",
    "(c) Not possible.",
    "If you have a graph with 5 vertices all of degree 4, then every\nvertex must be adjacent to every other vertex.",
    "This is the graph 𝐾5.\n",
    "(d)",
    "This is not possible.",
    "In fact, there is not even one graph with this property\n(such a graph would have 5 · 3/2 = 7.5 edges).\n",
    "2.1.5.10.\n(a) False.\n",
    "(b) True.\n",
    "(c) True.\n",
    "(d) False.\n",
    "2.2 ·",
    "Trees\n2.2.6 · Practice Problems\n2.2.6.3.",
    "Every spanning tree must still contain 22 vertices.",
    "Since it is a tree, it will\nhave 22 −1 = 21 edges.\n",
    "Thus we must remove 8 edges to get a spanning tree.\n",
    "2.2.6.5. Let 𝑥be the number of leaves.",
    "Then the sum of degrees will be 𝑥+8+6+5+3 =\n𝑥+ 22.",
    "This is twice the number of edges.",
    "Since the number of edges is one less than\nthe number of vertices, which is 𝑥+ 4, we also know that the number of edges is\n𝑥+ 3.\n",
    "Thus we have 2(𝑥+ 3) = 𝑥+ 22.",
    "Solving for 𝑥gives 𝑥= 16.\n",
    "2.2.7 ·",
    "Additional Exercises\n2.2.7.1.\n(a) This is not a tree since it contains a cycle.",
    "Note also that there are too many\nedges to be a tree, since we know that all trees with 𝑣vertices have 𝑣−1 edges.\n",
    "(b) This is a tree since it is connected and contains no cycles (which you can see by\ndrawing the graph).",
    "All paths are trees.\n",
    "(c)",
    "This is a tree since it is connected and contains no cycles (draw the graph).",
    "All\nstars are trees.\n\n",
    "474\nB. Selected Solutions\n(d)",
    "This is a not a tree since it is not connected.",
    "Note that there are not enough\nedges to be a tree.\n",
    "2.2.7.2.\n(a)",
    "This must be the degree sequence for a tree.",
    "This is because the vertex of\ndegree 4 must be adjacent to the four vertices of degree 1 (there are no other\nvertices for it to be adjacent to), and thus we get a star.\n",
    "(b) This cannot be a tree.",
    "Each degree 3 vertex is adjacent to all but one of the\nvertices in the graph.",
    "Thus each must be adjacent to one of the degree 1 vertices\n(and not the other).",
    "That means both degree 3 vertices are adjacent to the\ndegree 2 vertex and to each other, so that means there is a cycle.\n",
    "Alternatively, count how many edges there are!\n",
    "(c)",
    "This might or might not be a tree.",
    "The length 4 path has this degree sequence\n(this is a tree), but so does the union of a 3-cycle and a length 1 path (which is\nnot connected, so this is not a tree).\n",
    "(d)",
    "This cannot be a tree.",
    "The sum of the degrees is 28, so there are 14 edges.",
    "But\nthere are 14 vertices as well, so we don’t have 𝑣= 𝑒+ 1, meaning this cannot\nbe a tree.\n",
    "2.2.7.6.",
    "Yes.",
    "We will prove the contrapositive.",
    "Assume 𝐺does not contain a cycle.\n",
    "Then 𝐺is a tree, so this would have 𝑣= 𝑒+ 1, contrary to stipulation.\n",
    "2.2.7.12.\n(a) No, although there are graphs for which this is true.",
    "For example, 𝐾4 has a\nspanning tree that is a path (of three edges) and also a spanning tree that is a\nstar (with center vertex of degree 3).\n",
    "(b) Yes.",
    "For a fixed graph, we have a fixed number 𝑣of vertices.",
    "Any spanning\ntree of the graph will also have 𝑣vertices, and since it is a tree, must have 𝑣−1\nedges.\n",
    "(c)",
    "No, although there are graphs for which this is true (note that if all spanning\ntrees are isomorphic, then all spanning trees will have the same number of\nleaves).",
    "Again, 𝐾4 is a counterexample.",
    "One spanning tree is a path, with only\ntwo leaves, and another spanning tree is a star with 3 leaves.\n",
    "2.3 · Planar Graphs\n2.3.7 · Additional Exercises\n2.3.7.1.",
    "No.",
    "A (connected) planar graph must satisfy Euler’s formula: 𝑣−𝑒+ 𝑓= 2.\n",
    "Here 𝑣−𝑒+ 𝑓= 6 −10 + 5 = 1.\n2.3.7.2.",
    "𝐺has 10 edges, since 10 = 2+2+3+4+4+5\n2\n.",
    "It could be planar, and then it would\nhave 6 faces, using Euler’s formula: 6 −10 + 𝑓= 2 means 𝑓= 6.",
    "To make sure that it\nis actually planar though, we would need to draw a graph with those vertex degrees\nwithout edges crossing.",
    "This can be done by trial and error (and is possible).\n\n",
    "Selected Solutions\n475\n2.3.7.6.",
    "Say the last polyhedron has 𝑛edges and also 𝑛vertices.",
    "The total number of\nedges the polyhedron has then is (7 · 3 + 4 · 4 + 𝑛)/2 = (37 + 𝑛)/2.",
    "In particular, we\nknow the last face must have an odd number of edges.",
    "We also have that 𝑣= 11.",
    "By\nEuler’s formula, we have 11 −(37 + 𝑛)/2 + 12 = 2, and solving for 𝑛we get 𝑛= 5, so\nthe last face is a pentagon.\n",
    "2.3.7.8.\n",
    "Proof.\n",
    "Suppose there is a graph 𝐺with fewest edges that does not satisfy Euler’s\nformula.\n",
    "Note that 𝐺cannot be a tree, since for any tree, 𝑣= 𝑒+1 and 𝑓= 1, so 𝑣−𝑒+ 𝑓= 2.\n",
    "Therefore, 𝐺must contain a cycle.",
    "Pick any edge 𝑒0 that is part of a cycle in 𝐺and\nconsider the graph 𝐺′ = 𝐺−𝑒0 that you get by removing just the edge 𝑒0 from 𝐺.\n",
    "Since 𝐺′ has fewer edges than 𝐺, it must satisfy Euler’s formula.\n",
    "That is,\n𝑣′ −𝑒′",
    "+",
    "𝑓′ = 2, where 𝑣′, 𝑒′, and 𝑓′ are the number of vertices, edges, and faces of\n𝐺′. Since 𝐺′ is obtained by removing a single edge from a cycle in 𝐺, we have 𝑣′",
    "= 𝑣,\n𝑒′ = 𝑒−1, and 𝑓′ = 𝑓−1.",
    "Therefore, 𝑣−(𝑒−1) + (𝑓−1) = 2, so 𝑣−𝑒+ 𝑓= 2 as well.\n",
    "This is a contradiction, so no such graph 𝐺can exist.\n",
    "■\n2.3.7.12.\nProof.\n",
    "We know in any planar graph the number of faces 𝑓satisfies 3 𝑓≤2𝑒\nsince each face is bounded by at least three edges, but each edge borders two faces.\n",
    "Combine this with Euler’s formula:\n𝑣−𝑒+ 𝑓= 2\n𝑣−𝑒+ 2𝑒\n3 ≥2\n3𝑣−𝑒≥6\n3𝑣−6 ≥𝑒.\n■\n2.4 · Euler Trails and Circuits\n2.4.5 · Practice Problems\n2.4.5.2.",
    "Only (b) has an Euler circuit.",
    "The graph in (a) is not connected, so even\nthough every vertex has even degree, it does not have an Euler circuit.",
    "(c) has two\nvertices of odd degree, so it does not have an Euler circuit.\n",
    "One Euler circuit for (b) is\n(𝑎, 𝑑, 𝑓, 𝑒, 𝑔, 𝑐, 𝑏, 𝑒, ℎ, 𝑏, 𝑖, 𝑐, 𝑓, 𝑎).\n",
    "2.4.5.3.",
    "The first graph has an Euler trail, but not an Euler circuit.",
    "The second\ngraph has an Euler circuit.",
    "The third graph has neither an Euler circuit nor an Euler\ntrail.",
    "You can see this by drawing the graphs, but also by finding the degrees of the\nvertices.\n",
    "2.4.6 · Additional Exercises\n\n476\nB. Selected Solutions\n2.4.6.1.",
    "This is a question about finding Euler trails.",
    "Draw a graph with a vertex in\neach state, and connect vertices if their states share a border.",
    "Exactly two vertices\nwill have odd degree, the vertices for Nevada and Utah.",
    "Thus you must start your\nroad trip at in one of those states and end it in the other.\n",
    "2.4.6.2.\n(a) 𝐾4 does not have an Euler trail or circuit.\n",
    "(b) 𝐾5 has an Euler circuit (so also an Euler trail).\n",
    "(c) 𝐾5,7 does not have an Euler trail or circuit.\n",
    "(d) 𝐾2,7 has an Euler trail but not an Euler circuit.\n",
    "(e) 𝐶7 has an Euler circuit (it is a circuit graph!)\n",
    "(f) 𝑃7 has an Euler trail but no Euler circuit.\n",
    "2.4.6.8.",
    "If we build one bridge, we can have an Euler trail.",
    "Two bridges must be built\nfor an Euler circuit.\n",
    "2.5 ·",
    "Coloring\n2.5.6 · Additional Exercises\n2.5.6.1. 2, since the graph is bipartite.",
    "One color for the top set of vertices, another\ncolor for the bottom set of vertices.\n",
    "2.5.6.2.",
    "For example, 𝐾6.",
    "If the chromatic number is 6, then the graph is not planar;\nthe 4-color theorem states that all planar graphs can be colored with 4 or fewer\ncolors.\n",
    "2.5.6.3.",
    "The chromatic numbers are 2, 3, 4, 5, and 3 respectively from left to right.\n",
    "2.5.6.5.",
    "The cube can be represented as a planar graph and colored with two colors\nas follows:\nR\nB\nR\nB\nB\nR\nB\nR\nSince it would be impossible to color the vertices with a single color, we see that\nthe cube has chromatic number 2 (it is bipartite).\n\n",
    "Selected Solutions\n477\n2.5.6.9.",
    "The wheel graph below has this property.",
    "The outside of the wheel forms an\nodd cycle and so requires 3 colors; the center of the wheel must be a different color\nfrom all the outside vertices.\n",
    "2.5.6.12.",
    "If we drew a graph with each letter representing a vertex and each edge\nconnecting two letters that were consecutive in the alphabet, we would have a graph\ncontaining two vertices of degree 1 (A and Z) and the remaining 24 vertices all of\ndegree 2 (for example, 𝐷would be adjacent to both 𝐶and 𝐸).",
    "By Brooks’ theorem,\nthis graph has chromatic number at most 2, as that is the maximal degree in the\ngraph, and the graph is not a complete graph or odd cycle.",
    "Thus only two boxes are\nneeded.\n",
    "2.5.6.13.\n2.6 · Relations and Graphs\n2.6.7 · Practice Problems\n2.6.7.1.\n(a) Not reflexive, since, for example, 0 + 0 = 0 is not odd.\n",
    "(b) Not reflexive, since, for example, (−1) +",
    "(−1) is not positive.\n",
    "(c) Reflexive.",
    "Any number times itself is non-negative.\n",
    "(d) Not reflexive. 0",
    "· 0 is not positive.\n",
    "(e) Reflexive.",
    "Since 𝑛−𝑛= 0 is a multiple of 10.\n2.6.7.2.",
    "All the relations listed are symmetric.\n",
    "2.6.7.3.\n(a) Not transitive.",
    "For example, 1 ∼2 and 2 ∼3, but 1 / 3.\n(b) Not transitive.",
    "For example, −1 ∼3 and 3 ∼−2, but −1 / −2.\n",
    "(c) Not transitive.",
    "For example, −1 ∼0 and 0 ∼1, but −1 ∼1.\n",
    "(d) Transitive.",
    "If 𝑥∼𝑦, then 𝑥and 𝑦have the same sign.",
    "And then if 𝑦∼𝑧, 𝑧has\nthe same sign as 𝑦, so 𝑧also has the same sign as 𝑥.",
    "Thus 𝑥∼𝑧.\n(e) Transitive.",
    "This is because 𝑧−𝑦+ 𝑦−𝑥= 𝑧−𝑥, so if 𝑧−𝑦and 𝑦−𝑥are both\nmultiples of 10, then so is 𝑧−𝑥.\n2.7 · Matching in Bipartite Graphs\n\n478\nB. Selected Solutions\n· Exercises\n2.7.1.",
    "The first and third graphs have a matching, shown in bold (there are other\nmatchings as well).",
    "The middle graph does not have a matching.",
    "If you look at the\nthree circled vertices, you see that they only have two neighbors, which violates the\nmatching condition |𝑁(𝑆)| ≥|𝑆| (the three circled vertices form the set 𝑆).\n",
    "2.8 · Chapter Summary\n· Chapter Review\n2.8.1.",
    "The first and the third graphs are the same (try dragging vertices around to\nmake the pictures match up), but the middle graph is different (which you can see,\nfor example, by noting that the middle graph has only one vertex of degree 2, while\nthe others have two such vertices).\n",
    "2.8.2.",
    "The first (and third) graphs contain an Euler trail.",
    "All the graphs are planar.\n",
    "2.8.3.",
    "For example, 𝐾5.\n2.8.4.",
    "For example, 𝐾3,3.\n2.8.5.\n(a)",
    "Yes, the graphs are isomorphic, which you can see by drawing them.",
    "One\nisomorphism is:\n𝑓=\n\u0012\n𝑎\n𝑏\n𝑐\n𝑑\n𝑒\n𝑓\n𝑔\n𝑢\n𝑧\n𝑣\n𝑥\n𝑤\n𝑦\n𝑡\n\u0013\n.\n(b)",
    "This is easy to do if you draw the picture.",
    "Here is such a graph:\nAny labeling of this graph will be not isomorphic to 𝐺. For example, we could\ntake 𝑉′′ = {𝑎, 𝑏, 𝑐, 𝑑, 𝑒, 𝑓, 𝑔} and",
    "𝐸′′ = {𝑎𝑏, 𝑎𝑐, 𝑎𝑑, 𝑏𝑒, 𝑐𝑓, 𝑑𝑔}.\n",
    "(c) The degree sequence for 𝐺is (3, 3, 2, 1, 1, 1, 1).\n",
    "(d)",
    "In general this should be possible: The degree sequence does not determine\nthe graph’s isomorphism class.",
    "However, in this case, I was almost certain this\nwas not possible.",
    "That is, until I stumbled up this:\n\nSelected Solutions\n479\n(e) 𝐺is a tree (there are no cycles) and as such is also bipartite.\n",
    "(f) Yes, all trees are planar.",
    "You can draw them in the plane without edges\ncrossing.\n",
    "(g) The chromatic number of 𝐺is 2.",
    "It shouldn’t be hard to give a 2-coloring (for\nexample, color 𝑎, 𝑑, 𝑒, 𝑔red and 𝑏, 𝑐, 𝑓blue), but we know that all bipartite\ngraphs have chromatic number 2.\n(h)",
    "It is clear from the drawing that there is no Euler trail, let alone an Euler circuit.\n",
    "Also, since there are more than 2 vertices of odd degree, we know for sure\nthere is no Euler trail.\n",
    "2.8.6.",
    "Yes.",
    "According to Euler’s formula it would have 2 faces.",
    "It does.",
    "The only such\ngraph is 𝐶10.\n",
    "2.8.7.\n(a)",
    "Only if 𝑛≥6 and is even.\n(b) None.\n(c) 12.",
    "Such a graph would have 5𝑛\n2 edges.",
    "If the graph is planar, then 𝑛−5𝑛\n2 + 𝑓= 2\nso there would be 4+3𝑛\n2\nfaces.",
    "Also, we must have 3 𝑓≤2𝑒, since the graph is\nsimple.",
    "So we must have 3 \u0000 4+3𝑛\n2\n\u0001\n≤5𝑛. Solving for 𝑛gives 𝑛≥12.\n2.8.8.\n",
    "(a) There were 24 couples: 6 choices for the girl and 4 choices for the boy.\n",
    "(b) There were 45 couples: \u000010\n2\n\u0001\nsince we must choose two of the 10 people to dance\ntogether.\n",
    "(c) For part (a), we are counting the number of edges in 𝐾4,6.",
    "In part (b) we count\nthe edges of 𝐾10.\n",
    "2.8.9.",
    "Yes, as long as 𝑛is even.",
    "If 𝑛were odd, then the corresponding graph would\nhave an odd number of odd degree vertices, which is impossible.\n2.8.10.\n",
    "(a) No.",
    "The 9 triangles each contribute 3 edges, and the 6 pentagons contribute\n5 edges.",
    "This gives a total of 57, which is exactly twice the number of edges,\nsince each edge borders exactly 2 faces.",
    "But 57 is odd, so this is impossible.\n",
    "(b) Now adding up all the edges of all the 16 polygons gives a total of 64, meaning\n\n480\nB. Selected Solutions\nthere would be 32 edges in the polyhedron.",
    "We can then use Euler’s formula\n𝑣−𝑒+ 𝑓= 2 to deduce that there must be 18 vertices.\n",
    "(c) If you add up all the vertices from each polygon separately, we get a total of 64.\n",
    "This is not divisible by 3, so it cannot be that each vertex belongs to exactly 3\nfaces.",
    "Could they all belong to 4 faces?",
    "That would mean there were 64/4 = 16\nvertices, but we know from Euler’s formula that there must be 18 vertices.",
    "We\ncan write 64 = 3𝑥+ 4𝑦and solve for 𝑥and 𝑦(as integers).",
    "We get that there\nmust be 10 vertices with degree 4 and 8 with degree 3.",
    "(Note that the number\nof faces joined at a vertex is equal to its degree in graph theoretic terms.)\n",
    "2.8.11.",
    "No.",
    "Every polyhedron can be represented as a planar graph, and the Four\nColor Theorem says that every planar graph has chromatic number at most 4.\n",
    "2.8.12.",
    "𝐾𝑛,𝑛has 𝑛2 edges.",
    "The graph will have an Euler circuit when 𝑛is even.",
    "The\ngraph will be planar only when 𝑛< 3.\n",
    "2.8.13.",
    "𝐺has 8 edges (since the sum of the degrees is 16).",
    "If 𝐺is planar, then it will\nhave 4 faces (since 6 −8 + 4 = 2).",
    "𝐺does not have an Euler trail since there are more\nthan 2 vertices of odd degree.\n",
    "2.8.14.",
    "7 colors.",
    "Thus 𝐾7 is not planar (by the contrapositive of the Four Color\nTheorem).\n",
    "2.8.15.",
    "The chromatic number of 𝐾3,4 is 2, since the graph is bipartite.",
    "You cannot\nsay whether the graph is planar based on this coloring (the converse of the Four\nColor Theorem is not true).",
    "In fact, the graph is not planar, since it contains 𝐾3,3 as a\nsubgraph.\n",
    "2.8.16.",
    "We have that 𝐾3,4 has 7 vertices and 12 edges (each vertex in the group of 3\nhas degree 4).",
    "Then by Euler’s formula we have that 7 −12 + 𝑓= 2, so if the graph\nwere planar, it would have 𝑓= 7 faces.",
    "However, since the girth of the graph is\n4 (there are no cycles of length 3), we get that 4 𝑓≤2𝑒.",
    "But this would mean that\n28 ≤24, a contradiction.\n",
    "2.8.17.",
    "For all these questions, we are really coloring the vertices of a graph.",
    "You\nget the graph by first drawing a planar representation of the polyhedron and then\ntaking its planar dual: Put a vertex in the center of each face (including the outside),\nand connect two vertices if their faces share an edge.\n",
    "(a) Since the planar dual of a dodecahedron contains a 5-wheel, its chromatic\nnumber is at least 4.",
    "Alternatively, suppose you could color the faces using 3\ncolors without any two adjacent faces colored the same.",
    "Take any face, and\ncolor it blue.",
    "The 5 pentagons bordering this blue pentagon cannot be colored\nblue.",
    "Color the first one red.",
    "Its two neighbors (adjacent to the blue pentagon)\nget colored green.",
    "The remaining 2 cannot be blue or green, but also cannot\nboth be red since they are adjacent to each other.",
    "Thus a 4th color is needed.\n",
    "(b) The planar dual of the dodecahedron is itself a planar graph.",
    "Thus by the 4-color\ntheorem, it can be colored using only 4 colors without two adjacent vertices\n(corresponding to the faces of the polyhedron) being colored identically.\n\n",
    "Selected Solutions\n481\n(c)",
    "The cube can be properly 3-colored.",
    "Color the “top” and “bottom” red, the\n“front” and “back” blue, and the “left” and “right” green.\n",
    "2.8.18.\n(a) False.",
    "To prove this, we can give an example of a pair of graphs with the same\nchromatic number that are not isomorphic.",
    "For example, 𝐾3,3 and 𝐾3,4 both\nhave chromatic number 2 but are not isomorphic.\n",
    "(b) False.",
    "The previous example does not work, but you can easily draw two trees\nthat have the same number of vertices and edges but are not isomorphic.",
    "Since\nall trees have chromatic number 2, this is a counterexample.\n",
    "(c) True.",
    "If there is an isomorphism from 𝐺1 to 𝐺2, then we have a bĳection\nthat tells us how to match up vertices between the graph.",
    "Any proper vertex\ncoloring of 𝐺1 will tell us how to properly color 𝐺2, simply by coloring 𝑓(𝑣𝑖)\nthe same color as 𝑣𝑖, for each vertex 𝑣𝑖∈𝑉. That is, color the vertices in 𝐺2\nexactly how you color the corresponding vertices in 𝐺1.",
    "Similarly, any proper\nvertex coloring of 𝐺2 corresponds to a proper vertex coloring of 𝐺1.",
    "Thus the\nsmallest number of colors needed to properly color 𝐺1 cannot be smaller than\nthe smallest number of colors needed to properly color 𝐺2, and vice-versa, so\nthe chromatic numbers must be equal.\n",
    "2.8.19.",
    "𝐺has 13 edges, since we need 7 −𝑒+ 8 = 2.\n2.8.20.\n",
    "(a) The graph does have an Euler trail, but not an Euler circuit.",
    "There are exactly\ntwo vertices with odd degree.",
    "The path starts at one and ends at the other.\n",
    "(b) The graph is planar.",
    "Even though as it is drawn with edges crossing, it is easy\nto redraw it without edges crossing.\n",
    "(c)",
    "The graph is not bipartite (there is an odd cycle), nor complete.\n",
    "(d)",
    "The chromatic number of the graph is 3.\n2.8.21.\n",
    "(a) False.",
    "For example, 𝐾3,3 is not planar.\n",
    "(b) True.",
    "The graph is bipartite, so it is possible to divide the vertices into two\ngroups with no edges between vertices in the same group.",
    "Thus we can color\nall the vertices of one group red and the other group blue.\n",
    "(c) False.",
    "𝐾3,3 has 6 vertices with degree 3 and so contains no Euler trail.\n",
    "(d) False.",
    "𝐾3,3 again.\n",
    "(e) False.",
    "The sum of the degrees of all vertices is even for all graphs so this\nproperty does not imply that the graph is bipartite.\n\n",
    "482\nB. Selected Solutions\n2.8.22.\n(a) If a graph has an Euler trail, then it is planar.\n(b) If a graph does not have an Euler trail, then it is not planar.\n",
    "(c) There is a graph which is planar and does not have an Euler trail.\n",
    "(d)",
    "Yes.",
    "In fact, in this case it is because the original statement is false.\n",
    "(e) False.",
    "𝐾4 is planar but does not have an Euler trail.\n",
    "(f) False.",
    "𝐾5 has an Euler trail but is not planar.\n3 ·",
    "Counting\n3.1 · Pascal’s Arithmetical Triangle\n3.1.7 · Practice Problems\n3.1.7.7.\na. \u000010\n",
    "5\n\u0001\n= 252 choices, since you have to select a 5-element subset of the set of 10\ntoppings.\n",
    "b. \u00009\n5\n\u0001\n= 126 choices, since you must select 5 of the 9 non-green pepper toppings.\n",
    "c. \u00009\n4\n\u0001\n= 126 choices, since you must select 4 of the remaining 9 non-green pepper\ntoppings to have in addition to the green pepper.\n",
    "Note that 252 = 126 + 126 choices, which makes sense because every 5-topping\npizza either has green pepper or does not have green pepper as a topping.\n",
    "3.1.7.9.",
    "To get an 𝑥14, we must pick 14 of the 16 factors to contribute an 𝑥, leaving\nthe other 2 to contribute a 3.",
    "There are \u000016\n14\n\u0001 ways to select these 14 factors.",
    "So the\nterm containing an 𝑥14 will be \u000016\n14\n\u0001\n𝑥1432.",
    "In other words, the coefficient of 𝑥14 is\n\u000016\n14\n\u0001\n32 = 1080.\n3.1.7.10.",
    "To get an 𝑥9 from the first term, we must pick 9 of the 17 factors to contribute\nan 𝑥, leaving the other 8 to contribute a 2.",
    "There are \u000017\n9\n\u0001\nways to select these 9 factors,\nso the coefficient will be \u000017\n",
    "9\n\u0001\n∗28.",
    "Now we must choose 5 of the factors in the second\nterm to contribute an 𝑥, leaving the other 16 terms to contribute a 3.",
    "This gives us\n\u000021\n5\n\u0001\n∗316 for the coefficient resulting from this term.",
    "In total, the term containing an\n𝑥9 will be \u000017\n9\n\u0001\n∗28 + \u000021\n5\n\u0001\n∗316 = 8.75964 × 1011.\n",
    "3.2 ·",
    "Combining Outcomes\n3.2.6 ·",
    "Practice Problems\n3.2.6.1.",
    "By the product principle, there are 6 × 3 × 15 = 270 different outfits.\n",
    "3.2.6.2.\na. 8 + 3 = 11 ties.",
    "Use the additive principle.\n\n",
    "Selected Solutions\n483\nb. 8 · 3 = 24 ties.",
    "Use the multiplicative principle\nc. 2 · (7 + 3) + 8 = 42 outfits.\n",
    "3.2.6.3.\n",
    "a. There are 256 3-digit hexadecimals in which the first digit is an E (one for each\nchoice of the remaining digits).",
    "Similarly, there are 256 hexadecimals in which\nthe first digit is an F. We want the union of these two disjoint sets, so there are\n256",
    "+ 256 = 2 · 256 = 512 3-digit hexadecimals in which the first digit is either\nan E or an F.\nb.",
    "We can select the first digit in 6 ways, digits 2-5 in 16 ways each, and the final\ndigit in 10 ways.",
    "Thus there are 6 · 164 · 10 = 3932160 hexadecimals given these\nrestrictions.\n",
    "c.",
    "The number of 4-digit hexadecimals that start with a letter is 6 · 163 = 24576.\n",
    "The number of 4-hexadecimals that end with a numeral is 163 · 10 = 40960.",
    "We\nwant all the elements from both these sets.",
    "However, both sets include those\n4-digit hexadecimals which both start with a letter and end with a numeral(\n6 · 162 · 10 = 15360), so we must subtract these (once).",
    "Thus the number of\n4-digit hexadecimals starting with a letter or ending with a numeral is:\n24576 + 40960 −15360 = 50176\n3.2.6.4.\na. 28 = 256 subsets.",
    "We need to select yes/no for each of the 8 elements.\n",
    "b. 25 = 32 subsets.",
    "We need to select yes/no for each of the remaining 5 elements.\n",
    "c. 28 −24 = 240 subsets.",
    "We subtract the number of subsets which do not contain\nany odd numbers (24-select",
    "yes or no for each even element) from the total\nnumber of possible subsets.\n",
    "d. \u00004\n1\n\u0001\n· 24 = 64 subsets.",
    "First pick the even number.",
    "Then say yes or no to each of\nthe odd numbers.\n",
    "3.2.6.5.\na. \u00006\n4\n\u0001\n= 15 subsets\nb. \u00003\n1\n\u0001\n= 3 subsets.",
    "We need to select 1 of the 3 remaining elements of 𝑆to be in\nthe subset.\n",
    "c. \u00006\n4\n\u0001\n= 15 subsets.",
    "All subsets of cardinality 4 must contain at least one odd\nnumber.\n",
    "d. \u00003\n1\n\u0001\n= 3 subsets.",
    "Select 1 of the 3 even numbers.",
    "The remaining 3 odd numbers\nof 𝑆must all be in the set.\n",
    "3.2.6.7.\n",
    "a. We can think of each row as a 4-bit string of weight 2 (since of the 4 coins,\n\n484\nB. Selected Solutions\nwe require 2 to be pennies).",
    "Thus there are \u00004\n2\n\u0001\n= 6 rows possible.",
    "Each row\nrequires 4 coins, so if we want to make all the rows at the same time, we will\nneed 24 coins, half of them nickels and half of them pennies.\n",
    "b.",
    "Now there are 24 = 16 rows possible, which is also \u00004\n0\n\u0001\n+ \u00004\n1\n\u0001\n+ \u00004\n2\n\u0001\n+ · · · + \u00004\n4\n\u0001\n, if\nyou break them up into rows containing 0, 1, 2, etc. pennies.",
    "Thus, since there\nare 4 coins in each row, we need 4 · 16 = 64 total coins.\n",
    "3.2.6.8.",
    "Count the number of strings with each permissible number of 1’s separately\nand then add them up.",
    "So there are \u000011\n4\n\u0001\n+ \u000011\n5\n\u0001\n+ · · · \u000011\n11\n\u0001\n= 1816 strings.\n",
    "3.2.6.9.",
    "This is the same as a question about 7-bit strings, since we can think of each\nsubset as a 7-bit string with a 1 representing that we include that element in the\nsubset.",
    "\u000010\n7\n\u0001\n+ \u000010\n8\n\u0001\n+ · · · + \u000010\n10\n\u0001\n= 176 subsets.\n",
    "3.2.6.10.\na. \u000014\n7\n\u0001\n= 3432 paths.",
    "The paths all have length 14 (7 steps up and 7 steps right);\nwe just select which 7 of those 14 should be right.\n",
    "b.",
    "\u00007\n3\n\u0001 \u00007\n4\n\u0001\n= 1225 paths.",
    "First travel to (8, 9), and then continue on to (12, 12) .\n",
    "c. \u000014\n7\n\u0001\n−\u00007\n3\n\u0001 \u00007\n4\n\u0001\n= 2207 paths.",
    "Remove all the paths that you found in part (b).\n",
    "3.2.7 ·",
    "Additional Exercises\n3.2.7.1.\n(a) For example, 16 is the number of choices you have if you want to watch one\nmovie, either a comedy or horror flick.\n",
    "(b) For example, 63 is the number of choices you have if you will watch two movies,\nfirst a comedy and then a horror movie.\n",
    "3.3 ·",
    "Non-Disjoint Outcomes\n3.3.6 ·",
    "Practice Problems\n3.3.6.3.",
    "49 students.",
    "Use Venn diagram or PIE: 30 + 24 + 28 −(18 + 10 + 12) + 7 = 49.\n",
    "3.3.6.4.",
    "Using the principle of inclusion/exclusion, the number of students who like\ntheir potatoes in at least one of the ways described is\n54",
    "+ 39 + 51 −(18",
    "+ 28",
    "+ 29)",
    "+ 11 = 80.\n",
    "Therefore there are 100 −80 = 20 students who do not like potatoes.",
    "You can\nalso do this problem with a Venn diagram.\n",
    "3.3.6.5.\na. 210 = 1024.",
    "You have 2 choices for each of the remaining 10 bits.\n",
    "b. \u000010\n6\n\u0001\n= 210.",
    "You need to choose 6 of the remaining 10 bits to be 1’s.\nc. 2816.",
    "There are 210 strings that start with 011, and another 211 which end with\n01 (we choose 1 or 0 for 11 bits).",
    "However, we count the strings that start with\n\nSelected Solutions\n485\n011 and end with 01 twice; there are 28 such strings.",
    "So using PIE, we have\n210 + 211 −28 = 2816.\n",
    "d. 484.",
    "There are \u000010\n6\n\u0001\n= 210 strings of weight 8 which start with 011, and another\n\u000011\n7\n\u0001\n= 330 which end with 01.",
    "We have over counted again: There are weight 8\nstrings which both start with 011 and end with 01, in fact \u00008\n5\n\u0001\n= 56 of them.",
    "So\nall together we have 210 + 330 −56 = 484 strings.\n",
    "3.3.6.6.",
    "429 values of 𝑛. Use PIE: 178 + 238 + 143 −(59 + 35 + 47) + 11 or a Venn\ndiagram.",
    "To find out how many numbers are divisible by 3 and 5, for example, take\n715/(3 · 5) and round down.\n",
    "3.3.6.7.",
    "To find out how many numbers strictly less than 1400 are multiples of 4, we\ncan divide 1400 by 4 and round down.",
    "There are 349 of these.",
    "Similarly, there are\n199 multiples of 7 and 155 multiples of 9 less than 1400.\n",
    "We also need the combinations of these.",
    "To be a multiple of 4 and 7 means you\nare a multiple of 28 , and there are 49 multiples of 4 and 7.",
    "There will be 38 multiples\nof 4 and 9.",
    "There will be 22 multiples of 7 and 9.",
    "Finally, there will be 5 multiples of\nall three.\n",
    "Using PIE, we get\n349 + 199 + 155 −(49",
    "+ 38 + 22) + 5 = 599\nmultiples of 4, 7, or 9 less than 1400.\n",
    "3.3.6.8.\na. 1213 = 1.06993 ×",
    "1014 words, since you select from 12 letters 13 times.\nb.",
    "(12) · (11) · (10) . . .",
    "(12 −13 + 1) = 0 words.",
    "After selecting a letter, you have\nfewer letters to select for the next one.\n",
    "c. 1210",
    "= 6.19174 × 1010 words: You need to select the letters that follow the\n“ade.”\nd. 1210 +1211 −128 = 8.04496 × 1011 words.",
    "There are 1210 words which start with\n“ade” and another 1211 words that end with “be.”",
    "Then we need to subtract\nthe words that have both, which we have overcounted.\n",
    "e. (12 · (12 −1) · (12 −2) . . .",
    "(12 −13 + 1)) −(11 ·",
    "(9) · (9 −1) · (9 −2) . .",
    ".",
    "9 −10 + 1) = 0\nwords.",
    "All possible words without repeats minus the bad ones.",
    "The taboo\nword “bed” can be in any of 11 positions, and for each position we must choose\nthe remaining 10 letters from the remaining 9 letters in our alphabet.\n3.4 ·",
    "Combinations and Permutations\n3.4.6 · Practice Problems\n3.4.6.1.\na. \u00008\n2\n\u0001\n= 28 pizzas.",
    "We must choose (in no particular order) 2 out of the 8 toppings.\n",
    "b. 28 = 256 pizzas.",
    "Say yes or no to each topping.\n\n486\nB. Selected Solutions\nc. 𝑃(8, 4) = 1680 ways.",
    "Assign each of the 4 spots in the left column to a unique\npizza topping.\n",
    "3.4.6.2.",
    "Despite its name, we are not looking for a combination here.",
    "The order in\nwhich the three numbers appear matters.",
    "There are 𝑃(41, 3) = 41 · 40 · 39 different\npossibilities for the “combination”.",
    "This is assuming you cannot repeat any of the\nnumbers (if you could, the answer would be 413).\n",
    "3.4.6.3.\n",
    "a.",
    "This is just the multiplicative principle.",
    "There are 8 digits which we can select\nfor each of the 7 positions, so we have 87 = 2.09715 × 106 such numbers.\n",
    "b.",
    "Now we have 8 choices for the first number, 7 for the second, etc.",
    "So there are\n8 · 7 · · · · · 7 = 𝑃(8, 7) = 40320 such numbers.\n",
    "c. To build such a number we simply must select 7 different digits.",
    "After doing\nso, there will only be one way to arrange them into increasing order.",
    "Thus\nthere are \u00008\n7\n\u0001\n= 8 such numbers.\n",
    "3.4.6.4.\na. We can write the answer as 𝑃(30, 19) = 30 · 29 · 28 · · · · · 12 , which is the same\nas 30!\n11! .",
    "Or, if you think of picking the 19 books and then arranging those 19,\nyou can write this as \u000030\n19\n\u0001\n· 19! .",
    "Note, that since any order is acceptable, we are\ndistinguishing between different orders, so a permutation is appropriate here.\n",
    "b.",
    "Here we just need to select the books, and have no choice as how to arrange\nthem.",
    "So the answer is just \u000030\n19\n\u0001\n3.4.6.5.",
    "Since there are 14 different letters in “ambidextrously”, we have 14 choices\nfor the first letter, 13 for the next, 12 for the next, and so on.",
    "Thus there are 14!\nanagrams.\n",
    "3.4.6.6.",
    "After the first letter (namely, s), we must rearrange the remaining 5 letters.\n",
    "There are only two choices of letter now, so this is really just a bit-string question\nwhere one of the letters is 0, and the other letter is 1.",
    "Thus there are \u00005\n2\n\u0001\n= 10\nanagrams starting with “s”.\n",
    "3.4.6.7.",
    "First, decide where to put the “g”s.",
    "There are 7 positions, and we must\nchoose 3 of them to fill with an “g”.",
    "This can be done in \u00007\n3\n\u0001\nways.",
    "The remaining 4\nspots all get a different letter, so there are 4! ways to finish off the anagram.",
    "This\ngives a total of \u00007\n3\n\u0001\n· 4! anagrams.",
    "Strangely enough, this is 840, which is also equal to\n𝑃(7, 4).",
    "To get the answer that way, start by picking one of the 7 positions to be filled\nby the first non-”g” letter, one of the remaining 7 positions to be filled by the next,\nand so on.",
    "Then put “g”s in the remaining 3 positions.\n",
    "3.4.6.8.\na. \u000040\n4\n\u0001\n· \u000036\n4\n\u0001\n· \u000032\n4\n\u0001\n· · · · · \u00004\n4\n\u0001\nways.",
    "Pick 4 out of 40 people to be in the first foursome,\nthen 4 of the remaining 36 for the second foursome, and so on (use the\nmultiplicative principle to combine).\n\n",
    "Selected Solutions\n487\nb. 10!\u000030\n3\n\u0001\n· \u000027\n3\n\u0001\n· \u000024\n3\n\u0001\n· · · · · \u00003\n3\n\u0001 ways.",
    "First determine the tee time of the 10 board\nmembers, then select 3 of the 30 non-board members to golf with the first\nboard member, then 3 of the remaining 27 to golf with the second, and so on.\n3.4.6.9. 13!.",
    "There are 14 people seated around the table, but it does not matter where\nKing Arthur sits, only who sits to his left, two seats to his left, and so on.\n",
    "3.4.6.10.\na. 2213 functions.",
    "There are 22 choices for the image of each element in the\ndomain.\n",
    "b. 𝑃(22, 13) = 22 · 21 · 20 · · · · · 9 injective functions.",
    "There are 22 choices for the\nimage of the first element of the domain, then only 21 choices for the second,\n20 for the third, and so on.\n",
    "3.4.6.11.\n",
    "a. 65 = 7776 functions, since there are 6 choices of where to send each of the 5\nelements of the domain.\n",
    "b.",
    "𝑃(6, 5) = 6 · 5 · · · · ·",
    "2 = 720 functions, since outputs cannot be repeated.\n",
    "c. \u00006\n5\n\u0001\n= 6 functions.",
    "Since the function must be injective and increasing, we just\nneed to select the 5 distinct elements of the range from the 6 elements of the\ncodomain.",
    "Once these have been selected, we must put the smallest as the\nimage of 1, the next smallest as the image of 2, and so on (doing this does not\nincrease the number of functions, since there is one choice for how this event\ncan occur).\n",
    "3.4.7 ·",
    "Additional Exercises\n3.4.7.1. 120.\n3.5 ·",
    "Counting Multisets\n3.5.5 ·",
    "Practice Problems\n3.5.5.1.\na. \u000010\n9\n\u0001\nsets.",
    "We must select 9 of the 10 digits to put in the set.\n",
    "b. Use sticks and stones: Each stone represents one of the 9 elements of the set;\neach stick represents a switch between digits.",
    "So there are 9 stones and 9 sticks,\ngiving us \u000018\n9\n\u0001\nsets.\n",
    "3.5.5.2.\na. There are \u00006\n5\n\u0001\nnumbers.",
    "We simply choose 5 of the 6 digits and, once the choice\nis made, put them in increasing order.\nb.",
    "This uses sticks and stones.",
    "Use a stone to represent each of the 5 digits in the\nnumber, and use their position relative to the sticks to say what numeral fills\nthat spot.",
    "So we will have 5 stones and 5 sticks, giving \u000010\n5\n\u0001\nnumbers.\n\n",
    "488\nB. Selected Solutions\n3.5.5.3.\na. \u000025\n16\n\u0001 ways.",
    "Each outcome can be represented by a sequence of 9 sticks and 16\nstones.\n",
    "b. \u000015\n6\n\u0001\nways.",
    "First put one ball in each bin.",
    "This leaves 9 sticks and 6 stones.\n",
    "3.5.5.4.\na. \u000011\n9\n\u0001\nsolutions.",
    "After each variable gets 1 stone for free, we are left with 9 stones\nand 2 sticks.\n",
    "b. \u000014\n12\n\u0001\nsolutions.",
    "We have 12 stones and 2 sticks.\n",
    "c. \u000023\n2\n\u0001 solutions.",
    "This problem is equivalent to finding the number of solutions\nto 𝑥′ + 𝑦′ + 𝑧′ = 21 where 𝑥′, 𝑦′, and 𝑧′ are non-negative.",
    "(In fact, we really just\ndo a substitution.",
    "Let 𝑥= 𝑥′ −3, 𝑦= 𝑦′ −3 and 𝑧= 𝑧′ −3).\n",
    "3.5.5.5.",
    "\u000010\n5\n\u0001 outcomes are possible in traditional Yahtzee.",
    "Each die is a stone; its\nvalue is determined by where it is put relative to the sticks.\n",
    "For Super-Yahtzee, \u000013\n9\n\u0001\noutcomes.",
    "We have 4 stones (the 4 dice) and 9 sticks (the\n9 switches between the numbers 1-10).\n",
    "3.5.5.6.",
    "We must figure out how many different combinations of 9 coins are possible.\n",
    "Let a stone represent each coin, and a stick represent switching between type of coin.\n",
    "For example, if we have 7 coins, ∗∗| ∗|| ∗∗∗∗represents 2 pennies, one nickel, no\ndimes and 4 quarters.",
    "The number of such stone and stick diagrams for 12 total\nstones and sticks (with 9 stones and 3 sticks) is \u000012\n9\n\u0001\n= 0.00454545.",
    "Thus you have a 1\nin 0.00454545 chance of guessing correctly.\n",
    "3.5.5.7.\n\u000025\n22\n\u0001 solutions.\n",
    "First we guarantee the restrictions on the variables by\ndistributing 13 units to the variables.",
    "Then we find all solutions to 𝑥′\n1+𝑥′\n2+𝑥′\n3+𝑥′\n4 = 22\nin non-negative integers.\n",
    "3.5.5.8.\na. \u000013\n6\n\u0001\n= 1716.",
    "Note that a strictly increasing function is automatically injective.\n",
    "So the 6 outputs must all be different.",
    "So let’s first pick which 6 outputs we will\nuse: there are \u000013\n6\n\u0001 ways to do this.",
    "Now how many ways are there to assign\nthose outputs to the inputs 1 through 6?",
    "Only one way, since there is only one\nway to arrange numbers in increasing order.\n",
    "b. \u000018\n6\n\u0001\n.",
    "This is in fact a sticks and stones problem.",
    "The stones are the 6 inputs,\nand the sticks are the 12 spots between the 13 possible outputs.",
    "Think of it\nthis way: We will specify 𝑓(1), then 𝑓(2), then 𝑓(3), and so on in that order.\n",
    "Start with the possible output 0.",
    "We can use it as the output of 𝑓(1), or we can\nswitch to 1 as a potential output.",
    "Say we put 𝑓(1)",
    "= 1.",
    "Now we are at 1 (can’t\ngo back to 0).",
    "Should 𝑓(2) = 1?",
    "If yes, then we are putting down another stone.\n",
    "If no, put down a bar and switch to 2.",
    "Maybe you switch to 3, then assign\n𝑓(2)",
    "= 3 and 𝑓(3)",
    "= 3 (two more stones) before switching to 4 as a possible\noutput.",
    "And so on.\n\nSelected Solutions\n489\n3.5.5.9.\na. \u000028\n7\n\u0001\nsodas (order does not matter, and repeats are not allowed).\n",
    "b. 𝑃(28, 7) = (28) · (28 −1) · · · · · 22 sodas (order matters, and repeats are not\nallowed).\n",
    "c. \u000034\n7\n\u0001\nsodas (order does not matter, and repeats are allowed; 7 stars and 27 bars).\n",
    "d. 287 sodas (order matters, and repeats are allowed; 28 choices 7 times).\n",
    "3.5.6 · Additional Exercises\n3.5.6.1.\n(a)",
    "You take 3 strawberry, 1 lime, 0 licorice, 2 blueberry, and 0 bubblegum.\n",
    "(b)",
    "This is backwards.",
    "We don’t want the stones to represent the kids because the\nkids are not identical, but the stones are.",
    "Instead we should use 5 stones (for\nthe lollipops) and use 5 sticks to switch between the 6 kids.",
    "For example,\n◦◦|| ◦◦◦|||\nwould represent the outcome with the first kid getting 2 lollipops, the third\nkid getting 3, and the rest of the kids getting none.\n",
    "(c)",
    "This is the word AAAEOO.\n",
    "(d)",
    "This doesn’t represent a solution.",
    "Each stone should represent one of the\n6 units that add up to 6, and the sticks should switch between the different\nvariables.",
    "We have one too many sticks.",
    "An example of a correct diagram\nwould be\n◦| ◦◦|| ◦◦◦,\nrepresenting that 𝑥1 = 1, 𝑥2 = 2, 𝑥3 = 0, and 𝑥4 = 3.\n",
    "3.6 ·",
    "Combinatorial Proofs\n3.6.5 · Practice Problems\n3.6.5.1.\n• Consider the question, “How many two-digit numbers start with a 3 or 4?”\n• The first way to answer this is 10 + 10.\n",
    "•",
    "This is because there are 10 numbers that start with 3, and another 10 that start\nwith 4.\n",
    "•",
    "A second answer to the question is 2 · 10.\n",
    "•",
    "This is because you have 2 choices for the first digit, and 10 choices for the\nsecond digit.\n\n",
    "490\nB. Selected Solutions\n• Since both expressions answer the same question, they must be equal.",
    "Therefore\n10 + 10 = 2 · 10.\n3.6.5.2.\nA. Incorrect.\n",
    "This is not going to be helpful, since when we switch from one side of the\nequation to the other, we will not be counting the same thing.",
    "We need a\nquestion where the 𝑘things and the 2 things come from the same set of 𝑛\nthings.\n",
    "B. Correct.\nC. Incorrect.\n",
    "If we wanted either 2 or 𝑘people, we would need to add the number of\noutcomes from each.\n",
    "D. Correct.\n",
    "3.6.6 · Additional Exercises\n3.6.6.1.\nProof.\n",
    "Question: How many 2-letter words start with a, b, or c and end with either\ny or z?\nAnswer 1: There are two words that start with a, two that start with b, two that\nstart with c, for a total of 2 + 2 + 2.\nAnswer 2: There are three choices for the first letter and two choices for the\nsecond letter, for a total of 3 · 2.\n",
    "Since the two answers are both answers to the same question, they are equal.\n",
    "Thus 2 + 2 + 2 = 3 · 2.\n■\n3.6.6.5.\n(a)",
    "She has \u000015\n6\n\u0001 ways to select the 6 bridesmaids, and then for each way, has 6\nchoices for the maid of honor.",
    "Thus she has \u000015\n6\n\u0001\n6 choices.\n",
    "(b) She has 15 choices for who will be her maid of honor.",
    "Then she needs to select\n5 of the remaining 14 friends to be bridesmaids, which she can do in \u000014\n5\n\u0001\nways.\n",
    "Thus she has 15\u000014\n5\n\u0001\nchoices.\n",
    "(c) We have answered the question (how many wedding parties can the bride\nchoose from) in two ways.",
    "The first way gives the left-hand side of the identity,\nand the second way gives the right-hand side of the identity.",
    "Therefore the\nidentity holds.\n",
    "3.6.6.7.\nProof.\n",
    "Question: You have a large container filled with ping-pong balls, all with a\ndifferent number on them.",
    "You must select 𝑘of the balls, putting two of them in a\njar and the others in a box.",
    "How many ways can you do this?\n\nSelected Solutions\n491\nAnswer 1: First select 2 of the 𝑛balls to put in the jar.",
    "Then select 𝑘−2 of the\nremaining 𝑛−2 balls to put in the box.",
    "The first task can be completed in \u0000𝑛\n2\n\u0001\ndifferent\nways and the second task in \u0000𝑛−2\n𝑘−2\n\u0001 ways.",
    "Thus there are \u0000𝑛\n2\n\u0001 \u0000𝑛−2\n𝑘−2\n\u0001 ways to select the\nballs.\n",
    "Answer 2: First select 𝑘balls from the 𝑛in the container.",
    "Then pick 2 of the 𝑘\nballs you picked to put in the jar, placing the remaining 𝑘−2 in the box.",
    "The first\ntask can be completed in \u0000𝑛\n𝑘\n\u0001 ways and the second task in \u0000𝑘\n2\n\u0001 ways.",
    "Thus there are\n\u0000𝑛\n𝑘\n\u0001 \u0000𝑘\n2\n\u0001\nways to select the balls.\n",
    "Since both answers count the same thing, they must be equal, and the identity is\nestablished.\n",
    "■\n3.8 · Advanced Counting Using PIE\n3.8.5 ·",
    "Practice Problems\n3.8.5.1.\n",
    "a. \u000015\n6\n\u0001\nmeals.",
    "First spend $7 to buy one of each item and then use 9 stars to select\nitems between 6 bars.\n",
    "b. \u000022\n6\n\u0001 meals.",
    "Here you have 16 stars and 6 bars (separating the 7 items).",
    "a.\n\u000022\n6\n\u0001\n−\n\u0002\u00007\n1\n\u0001 \u000019\n6\n\u0001\n−\u00007\n2\n\u0001 \u000016\n6\n\u0001\n+ \u00007\n3\n\u0001 \u000013\n6\n\u0001\n· · ·\n\u0003\nmeals.",
    "Use PIE to subtract all the meals in\nwhich you get 3 or more of a particular item.\n",
    "3.8.5.2.\na. \u000022\n5\n\u0001\n= 26334 - there are 17 stars and 5 bars.\n",
    "b. \u000016\n5\n\u0001\n= 4368 - buy one of each item, using $6.",
    "This leaves you $11 to distribute\nto the 6 items, so 11 stars and 5 bars.\n",
    "c. \u000022\n5\n\u0001\n−\n\u0002\u00006\n1\n\u0001 \u000017\n5\n\u0001\n−\u00006\n2\n\u0001 \u000012\n5\n\u0001\n+ · · ·\n\u0003\nmeals.",
    "Use PIE to subtract all the meals in which\nyou get 5 or more of a particular item.\n",
    "3.8.5.3.",
    "\u000018\n4\n\u0001\n−\n\u0002\u00005\n1\n\u0001 \u000011\n4\n\u0001\n−\u00005\n2\n\u0001 \u00004\n4\n\u0001\u0003\n.\n",
    "3.8.5.4.",
    "The easiest way to solve this is to first distribute the minimum number of\nunits to each variable (1), and then count the solutions to 𝑦1 + 𝑦2 + 𝑦3 + 𝑦4 = 15 with\n0 ≤𝑦𝑖≤5.",
    "By taking 𝑥𝑖= 𝑦𝑖+ 5, each solution to this new equation corresponds to\nexactly one solution to the original equation.\n",
    "Now all the ways to distribute the 15 units to the four 𝑦𝑖variables can be found\nusing stars and bars, specifically 15 stars and 3 bars, so \u000018\n15\n\u0001\nways.",
    "But this includes\nthe ways that one or more 𝑦𝑖variables can be assigned more than 3 units.",
    "So subtract\nusing PIE to get\n\u0012\n18\n3\n\u0013\n−\n\u0012\u0012\n4\n1\n\u0013 \u0012\n12\n3\n\u0013\n−\n\u0012\n4\n2\n\u0013 \u0012\n6\n3\n\u0013\n+ . .",
    ".\n",
    "\u0013\n",
    "The \u00004\n1\n\u0001\ncounts the number of ways to pick one variable to be over-assigned; the\n\u000012\n3\n\u0001\nis the number of ways to assign the remaining units to the 4 variables, etc.\n3.8.5.5.\na. \u000012\n7\n\u0001\n= 792.",
    "This makes sense because if each student can receive at most one\n\n492\nB. Selected Solutions\nstar, you must pick which 7 of the 12 kids will get one.\nb.",
    "Without any restriction, there would be \u000018\n11\n\u0001\nways to distribute the stars.",
    "Now\nwe must use PIE to eliminate all distributions in which one or more students\nget more than one star:\n",
    "\u0012\n18\n11\n\u0013\n−\n\u0014\u0012\n12\n1\n\u0013 \u0012\n16\n11\n\u0013\n−\n\u0012\n12\n2\n\u0013 \u0012\n14\n11\n\u0013\n+\n\u0012\n12\n3\n\u0013 \u0012\n12\n11\n\u0013\n−· · ·\n\u0015\n= 792.\n3.8.5.6.\n",
    "First pick one of the 4 elements to be fixed.\n",
    "For each such choice,\nderange the remaining 3, using the standard advanced PIE formula.\n",
    "We get\n\u00004\n1\n\u0001 \u0010\n3!",
    "−\n\u0002\u00003\n1\n\u0001\n2! −\u00003\n2\n\u0001\n1!",
    "+ . . .",
    "\u00003\n3\n\u0001\n0!\n\u0003\u0011\npermutations.\n",
    "3.8.5.7.",
    "\u000012\n8\n\u0001 \u0010\n4!",
    "−\n\u0002\u00004\n1\n\u0001\n3! −\u00004\n2\n\u0001\n2! · · · + \u00004\n4\n\u0001\n0!\n",
    "\u0003\u0011\n= 4455 ways.",
    "We choose 8 of the 12 ladies\nto get their own hats, and then multiply by the number of ways the remaining hats\ncan be deranged.\n",
    "3.8.5.8.\na.\n8!",
    "−\n\u0014\u0012\n8\n1\n\u0013\n7!",
    "−\n\u0012\n8\n2\n\u0013\n6! . .",
    ".\n",
    "\u0012\n8\n8\n\u0013\n0!\n\u0015\n= 14833\nb. \u0012\n8\n4\n\u0013 \u0012\n4!",
    "−\n\u0014\u0012\n4\n1\n\u0013\n3!",
    "−\n\u0012\n4\n2\n\u0013\n2! + . . .\n",
    "\u0012\n4\n4\n\u0013\n0!\n\u0015\u0013\n= 630\nc. 0.",
    "Once 7 presents have their original label, there is only one present left and\nonly one label left, so the 8th present must get its own label.\n",
    "3.8.5.9.",
    "There are 5 · 67 functions for which 𝑓(1) ≠𝑐and another 5 · 67 functions for\nwhich 𝑓(2) ≠𝑓. There are 52 · 66 functions for which both 𝑓(1) ≠𝑐and 𝑓(2)",
    "≠𝑓. So\nthe total number of functions for which 𝑓(1) ≠𝑐or 𝑓(2) ≠𝑓or both is\n5 · 67 + 5 · 67 −52 ·",
    "66 = 1.63296 × 106.\n3.8.5.10.",
    "58 −\n\u0002\u00005\n1\n\u0001\n48 −\u00005\n2\n\u0001\n38 + \u00005\n3\n\u0001\n28 −· · · + \u00005\n4\n\u0001\n18\u0003\nfunctions.",
    "The 58 is all the functions\nfrom 𝐴to 𝐵. We subtract those that aren’t surjective.",
    "Pick one of the elements in\n𝐵to not be in the range (in \u00005\n1\n\u0001 ways) and count all those functions (48).",
    "But this\novercounts the functions where two elements from 𝐵are excluded from the range,\nso subtract those.",
    "And so on, using PIE.\n3.8.5.11. 1854 functions.",
    "This is a sneaky way to ask for the number of derangements\non 7 elements.\n",
    "3.8.6 ·",
    "Additional Exercises\n3.8.6.2.",
    "The 9 derangements are: 2143, 2341, 2413, 3142, 3412, 3421, 4123, 4312, 4321.\n",
    "3.9 · Chapter Summary\n· Chapter Review\n\nSelected Solutions\n493\n3.9.1.\n",
    "a. \u000014\n10\n\u0001 ways.",
    "After giving one present to each kid, you are left with 10 presents\n(stones) which need to be divided among the 5 kids (giving 4 sticks).\n",
    "b. \u000019\n15\n\u0001\n= 3876 ways.",
    "You have 15 stones and 4 sticks.\n",
    "c. 515.",
    "You have 5 choices for whom to give each present.",
    "This is like making a\nfunction from the set of presents to the set of kids.\n",
    "d. 515−\n\u0002\u00005\n1\n\u0001\n(5 −1)15 −\u00005\n2\n\u0001\n(5 −2)15 + \u00005\n3\n\u0001\n(5 −3)15 . . .\n",
    "\u0003\nways.",
    "Now the function from\nthe set of presents to the set of kids must be surjective.\n",
    "3.9.2.\n(a) Neither.",
    "\u000014\n4\n\u0001\npaths.\n",
    "(b) \u000010\n4\n\u0001\nbow ties.\n",
    "(c) 𝑃(10, 4), since order is important.\n",
    "(d) Neither.",
    "Assuming you will wear each of the 4 ties on just 4 of the 7 days,\nwithout repeats: \u000010\n4\n\u0001\n𝑃(7, 4).\n",
    "(e) 𝑃(10, 4).\n",
    "(f) \u000010\n4\n\u0001\n.\n",
    "(g) Neither.",
    "Since you could repeat letters: 104.",
    "If no repeats are allowed, it would\nbe 𝑃(10, 4).\n",
    "(h) Neither.",
    "Actually, “k” is the 11th letter of the alphabet, so the answer is 0.",
    "If\n“k” was among the first 10 letters, there would only be 1 way – write it down.\n",
    "(i) Neither.",
    "Either \u00009\n3\n\u0001 (if every kid gets an apple) or \u000013\n3\n\u0001 (if appleless kids are\nallowed).\n",
    "(j) Neither.",
    "Note that this could not be \u000010\n",
    "4\n\u0001 since the 10 things and 4 things are\nfrom different groups.",
    "410, assuming each kid eats one type of cereal.\n(k) \u000010\n4\n\u0001. Don’t be fooled by the “arrange” in there.",
    "You are picking 4 out of 10\nspots to put the 1’s.\n(l) \u000010\n4\n\u0001\n(assuming order is irrelevant).\n",
    "(m) Neither. 1610 (each kid chooses yes or no to 4 varieties).\n",
    "(n) Neither. 0.\n(o) Neither.",
    "410 −[\u00004\n1\n\u0001\n310 −\u00004\n2\n\u0001\n210 + \u00004\n3\n\u0001\n110].\n(p) Neither. 10 · 4.\n\n494\nB. Selected Solutions\n(q) Neither. 410.\n(r) \u000010\n4\n\u0001\n(which is the same as \u000010\n6\n\u0001\n).\n",
    "(s) Neither.",
    "If all the kids were identical, and you wanted no empty teams, it\nwould be \u000010\n4\n\u0001. Instead, this will be the same as the number of surjective\nfunctions from a set of size 11 to a set of size 5.\n(t) \u000010\n4\n\u0001\n.\n",
    "(u) \u000010\n4\n\u0001\n.\n",
    "(v) Neither. 4!.\n",
    "(w) Neither.",
    "It’s \u000010\n4\n\u0001\nif you won’t repeat any choices.",
    "If repetition is allowed, then\nthis becomes 𝑥1 + 𝑥2 + · · · + 𝑥10 = 4, which has \u000013\n9\n\u0001 solutions in non-negative\nintegers.\n",
    "(x) Neither.",
    "Since repetition of cookie type is allowed, the answer is 104.",
    "Without\nrepetition, you would have 𝑃(10, 4).\n",
    "(y) \u000010\n4\n\u0001\nsince that is equal to \u00009\n4\n\u0001\n+ \u00009\n3\n\u0001\n.\n",
    "(z) Neither.",
    "It will be a complicated (possibly PIE) counting problem.\n",
    "3.9.3.\n",
    "a. 214 = 16384 choices.",
    "You have two choices for each tie: wear it or don’t.\n",
    "b.",
    "You have 511 choices for regular ties (the 29 choices less the “no regular tie”\noption) and 31 choices for bow ties (25 total minus the “no bow tie” option).\n",
    "Thus you have 511 · 31 = 15841 total choices.\n",
    "c. \u00009\n3\n\u0001 \u00005\n2\n\u0001\n= 840 choices.\n",
    "d. Select one of the 2 bow ties to go on top.",
    "There are then 4 choices for the next\ntie, 4-1 for the tie after that, and so on.",
    "Thus 2 · 4! = 48 choices.\n",
    "3.9.4.",
    "You own 8 purple bow ties, 3 red bow ties, 3 blue bow ties, and 5 green bow\nties.",
    "How many ways can you select one of each color bow tie to take with you on a\ntrip?",
    "8 · 3 · 3 · 5 ways.",
    "How many choices do you have for a single bow tie to wear\ntomorrow?",
    "8",
    "+ 3 + 3 + 5 choices.\n",
    "3.9.5.\na. 811 numbers.\n",
    "b. 810 · 4 numbers (choose any digits for the first 10 digits, then pick either an\neven or an odd last digit to make the sum even).\n",
    "c. We need 6 or more even digits.",
    "6 even digits: \u000011\n6\n\u000146411−6. 6",
    "+1 even digits:\n",
    "\u0000 11\n(6+1)\n\u000146+1 ∗411−6−1, etc.",
    "By adding these together, we get the total number of\nways to have 6 or more even digits.\n\n",
    "Selected Solutions\n495\n3.9.6.",
    "48 passengers.",
    "We are asking for the size of the union of three non-disjoint\nsets.",
    "Using PIE, we have 27 + 20 + 29 −(13 + 11 + 10)",
    "+ 6 = 48.\n",
    "3.9.7.\na. 210 strings.\n",
    "b. \u000010\n5\n\u0001\nstrings.\n",
    "c. \u000010\n5\n\u0001\nstrings.\n3.9.8. 35 · \u000015\n10\n\u0001\n+ 514 · \u000021\n7\n\u0001\n.\n3.9.9.",
    "With repeated letters allowed, we select which 3 of the 10 letters will be vowels,\nthen pick one of the 5 vowels for each spot, and finally pick one of the other 21 letters\nfor each of the remaining 7 spots.",
    "Thus, \u000010\n3\n\u0001\n53217 words.\n",
    "Without repeats, we still pick the positions of the vowels, but now each time we\nplace a vowel there, we have one fewer choice for the next one.",
    "Similarly, we cannot\nrepeat the consonants.",
    "We get \u000010\n3\n\u0001\n𝑃(5, 3)𝑃(21, 7) words.\n",
    "3.9.10.\n",
    "a. \u00003\n2\n\u0001 \u00009\n4\n\u0001\n= 378 paths.\n",
    "b. \u000012\n6\n\u0001\n−\u000010\n5\n\u0001 \u00002\n1\n\u0001\n= 420 paths.\n",
    "c. \u00003\n2\n\u0001 \u00009\n4\n\u0001\n+ \u000010\n5\n\u0001 \u00002\n1\n\u0001\n−\u00003\n2\n\u0001 \u00007\n3\n\u0001 \u00002\n1\n\u0001\n= 672 paths.\n",
    "3.9.11.",
    "\u000031\n15\n\u0001 \u0010\u000031\n15\n\u0001\n−1\n\u0011\nroutes.",
    "For each of the \u000031\n15\n\u0001\nroutes to work, there is exactly one\nless route back.\n",
    "3.9.12. 28 + 29 −26 strings (using PIE).\n",
    "3.9.13. \u000012\n3\n\u0001\n+ \u000013\n4\n\u0001\n−\u000010\n2\n\u0001\nstrings.\n",
    "3.9.14.",
    "There are 3 spots to start the word, and then there are 2! ways to arrange the\nother letters in the remaining three spots.",
    "Thus the number of words avoiding the\nsub-word “bad” in consecutive letters is 5! −3 ·",
    "2! = 114.\n",
    "If we now need to avoid words that put “b” before “a” before “d”, we must\nchoose which spots those letters go (in that order) and then arrange the remaining 2\nletters.",
    "Thus, 5! −\u00005\n3\n\u0001\n2! = 100 words.\n",
    "3.9.15.",
    "2𝑛is the number of lattice paths which have length 𝑛, since for each step you\ncan go up or right.",
    "Such a path would end along the line 𝑥+ 𝑦= 𝑛.",
    "So you will end\nat (0, 𝑛), or (1, 𝑛−1) or (2, 𝑛−2) or . . .",
    "or (𝑛, 0).",
    "Counting the paths to each of these\npoints separately, give \u0000𝑛\n0\n\u0001\n, \u0000𝑛\n1\n\u0001\n, \u0000𝑛\n2\n\u0001\n, . .",
    ".",
    ", \u0000𝑛\n𝑛\n\u0001\n(each time choosing which of the 𝑛steps\nto be to the right).",
    "These two methods count the same quantity, and so are equal.\n",
    "3.9.16.\na. \u000015\n10\n\u0001\n= 3003 ways.\n",
    "b. \u000021\n16\n\u0001\n= 20349 ways.\n\n",
    "496\nB. Selected Solutions\nc. \u000015\n10\n\u0001\n−\n\u0002\u00006\n1\n\u0001 \u00008\n5\n\u0001\n−\u00006\n2\n\u0001 \u00001\n5\n\u0001\n. . .\n",
    "\u0003\n= 2877 ways.\n3.9.17.\na. 43 + 43 −42 = 112 functions.\n",
    "b. 3 · 43 + 4 · 3 · 42 −3 · 3 · 42 = 240 functions.\n",
    "c. 4!",
    "−[3!",
    "+ 3! −2!]",
    "= 14 functions.",
    "Note that we use factorials instead of powers\nbecause we are looking for injective functions.\n",
    "d. Note that being surjective here is the same as being injective, so we can start\nwith all 4! injective functions and subtract those which have one or more\n“fixed point”.",
    "We get 4!",
    "−\n\u0002\u00004\n1\n\u0001\n(4 −1)!",
    "−\u00004\n2\n\u0001\n(4 −2)!",
    "+ \u00004\n3\n\u0001\n(4 −3)!",
    "−. . .",
    "\u00004\n4\n\u0001\n0!\n\u0003\n= 9\nfunctions.\n",
    "3.9.18.",
    "46 −\n\u0002\u00004\n1\n\u0001\n36 −\u00004\n2\n\u0001\n26 + \u00004\n3\n\u0001\n16\u0003\n.\n3.9.19.\n",
    "a. \u000013\n8\n\u0001\n= 1287 combinations.",
    "You need to choose 8 of the 13 cookie types.",
    "Order\ndoesn’t matter.\n",
    "b. 𝑃(13, 8) = 13 · (13 −1) · (13 −2) · · · · · (13 −8 + 1) = 5.18918 ×",
    "107 ways.",
    "You are\nchoosing and arranging 8 out of 13 cookies.",
    "Order matters now.\n",
    "c. \u000035\n23\n\u0001\n= 8.34452 × 108 choices.",
    "You must switch between cookie type 12 times as\nyou make your 23 cookies.",
    "The cookies are the stones; the switches between\ncookie types are the sticks.\n",
    "d. 1323 choices.",
    "You have 13 choices for the “1” cookie, 13 choices for the “2”\ncookie, and so on.\n",
    "e. 1323",
    "−\n\u0002\u000013\n1\n\u0001\n(13 −1)23 −\u000013\n2\n\u0001\n(13 −2)23 + · · · −\u000013\n13\n\u0001\n023\u0003\n= 2.49879 × 1024 choices.\n",
    "We must use PIE to remove all the ways in which one or more cookie type is\nnot selected.\n3.9.20.\n",
    "(a) You are giving your professor 4 types of cookies coming from 10 different\ntypes of cookies.",
    "This does not lend itself well to a function interpretation.",
    "We\ncould say that the domain contains the 4 types you will give your professor\nand the codomain contains the 10 you can choose from, but then counting\ninjections would be too much (it doesn’t matter if you pick type 3 first and type\n2 second, or the other way around, just that you pick those two types).\n",
    "(b) We want to consider injective functions from the set {most, second most,\nsecond least, least} to the set of 10 cookie types.",
    "We want injections because\nwe cannot pick the same type of cookie to give most and least of (for example).\n",
    "(c)",
    "This is not a good problem to interpret as a function.",
    "The problem is that\nthe domain would have to be the 12 cookies you bake, but these elements are\n\nSelected Solutions\n497\nindistinguishable (there is not a first cookie, second cookie, etc.).\n",
    "(d)",
    "The domain should be the 12 shapes, the codomain the 10 types of cookies.\n",
    "Since we can use the same type for different shapes, we are interested in\ncounting all functions here.\n",
    "(e) Here we insist that each type of cookie be given at least once, so now we are\nasking for the number of surjections of those functions counted in the previous\npart.\n",
    "4 ·",
    "Sequences\n4.1 · Describing Sequences\n4.1.7 ·",
    "Additional Exercises\n4.1.7.1.\n(a) The recursive definition is 𝑎𝑛= 𝑎𝑛−1 + 2 with 𝑎1 = 1.",
    "A closed formula is\n𝑎𝑛= 2𝑛−1.\n",
    "(b) The sequence of partial sums is 1, 4, 9, 16, 25, 36, . .",
    "..",
    "A recursive definition is\n(as always) 𝑏𝑛= 𝑏𝑛−1 + 𝑎𝑛which in this case is 𝑏𝑛= 𝑏𝑛−1 + 2𝑛−1.",
    "It appears\nthat the closed formula is 𝑏𝑛= 𝑛2\n4.1.7.2.\n(a) 0, 1, 2, 4, 7, 12, 20, . .",
    "..\n(b) 𝐹0 + 𝐹1 + · · · + 𝐹𝑛= 𝐹𝑛+2 −1.\n",
    "4.1.7.3.",
    "The sequences all have the same recurrence relation: 𝑎𝑛= 𝑎𝑛−1 + 𝑎𝑛−2 (the\nsame as the Fibonacci numbers).",
    "The only difference is the initial conditions.\n",
    "4.1.7.4. 3, 10, 24, 52, 108, . .",
    "..",
    "The recursive definition for 10, 24, 52, . . . is 𝑎𝑛= 2𝑎𝑛−1+4\nwith 𝑎1 = 10.\n4.1.7.5. −1, −1, 1, 5, 11, 19, . . .",
    "Thus the sequence 0, 2, 6, 12, 20, . . .",
    "has closed formula\n𝑎𝑛= (𝑛+ 1)2 −3(𝑛+ 1) + 2.\n4.1.7.6.\n",
    "This closed formula would have 𝑎𝑛−1 = 3 · 2𝑛−1 + 7 · 5𝑛−1 and 𝑎𝑛−2 =\n3 · 2𝑛−2 + 7 · 5𝑛−2.",
    "Then we would have\n7𝑎𝑛−1 −10𝑎𝑛−2 =7(3 · 2𝑛−1 + 7 · 5𝑛−1) −10(3 · 2𝑛−2 + 7 · 5𝑛−2)\n",
    "=21 · 2𝑛−1 + 49 · 5𝑛−1 −30 · 2𝑛−2 −70 · 5𝑛−2)\n=21 · 2𝑛−1 + 49 · 5𝑛−1 −15 · 2𝑛−1 −14 · 5𝑛−1)\n=6 · 2𝑛−1 + 35 · 5𝑛−1\n=3 ·",
    "2𝑛+ 7 · 5𝑛= 𝑎𝑛.\nSo the closed formula agrees with the recurrence relation.",
    "The closed formula has\ninitial terms 𝑎0 = 10 and 𝑎1 = 41.\n\n",
    "498\nB. Selected Solutions\n4.1.7.10.\n(a)\n𝑛\nÕ\n𝑘=1\n2𝑘.\n(b)\n107\nÕ\n𝑘=1\n(1 + 4(𝑘−1)).\n",
    "(c)\n50\nÕ\n𝑘=1\n1\n𝑘.\n(d)\n𝑛\nÖ\n𝑘=1\n2𝑘.\n(e)\n100\nÖ\n𝑘=1\n𝑘\n𝑘+ 1.\n4.1.7.11.\n",
    "(a)\n100\nÕ\n𝑘=1\n(3 + 4𝑘) = 7 + 11 + 15 + · · · + 403.\n(b)\n𝑛\nÕ\n𝑘=0\n2𝑘= 1 + 2 + 4 + 8 + · · · + 2𝑛.\n(c)\n50\nÕ\n𝑘=2\n1\n(𝑘2 −1)",
    "= 1 + 1\n3 + 1\n8 + 1\n15 + · · · +\n1\n2499.\n",
    "(d)\n100\nÖ\n𝑘=2\n𝑘2\n(𝑘2 −1) = 4\n3 · 9\n8 · 16\n15 · · · 10000\n9999 .\n",
    "(e)\n𝑛\nÖ\n𝑘=0\n(2 + 3𝑘) = (2)(5)(8)(11)(14) · · · (2 + 3𝑛).\n",
    "4.2 · Rate of Growth\n4.2.6 · Practice Problems\n4.2.6.8.\n",
    "For arithmetic: 𝑥= 83.6666666666667, 𝑦= 42.3333333333333.",
    "For the\narithmetic sequence, we know 125 + 𝑑= 𝑥, 𝑥+ 𝑑= 𝑦, and 𝑦+ 𝑑= 1.",
    "In other\nwords, 125 + 3𝑑= 1 so 𝑑= (−41.3333333333333)/3.",
    "For geometric: 𝑥= 25 and\n𝑦= 5.",
    "Similarly we can find the common ratio for the geometric sequence by solving\n125 · 𝑟3 = 1 for 𝑟.\n4.2.6.9.",
    "For arithmetic: 𝑥= 13, 𝑦= 22.",
    "We know that 4 + 𝑑= 𝑥, 𝑥+ 𝑑= 𝑦, and\n𝑦+ 𝑑= 31.",
    "In other words, 4 + 3𝑑= 31 so 𝑑= (27)/3.\nFor geometric: 𝑥= 7.91578 and 𝑦= 15.6649.",
    "We can find the common ratio for\nthe geometric sequence by solving 4 · 𝑟3 = 31 for 𝑟.\n4.3 · Polynomial Sequences\n4.3.6 ·",
    "Practice Problems\n\nSelected Solutions\n499\n4.3.6.1.\n(a) 𝑎𝑛= 𝑎𝑛−1 + 3; 𝑎1 = 10.\n(b) 𝑎𝑛= 7 + 3𝑛.\n(c)",
    "Yes, 1555 = 𝑎516.\n(d)",
    "The sequence has 142 terms.\n",
    "(e) The sum is 31453.\n",
    "(f) 𝑏𝑛= 3",
    "+ (10+7+3𝑛)𝑛\n2\n.\n",
    "4.3.6.2.\na. 25, which is 20 + 5.\nb.",
    "The sequence is arithmetic, with 𝑎0 = 5 and constant difference 5, so 𝑎𝑛= 5+5𝑛.\nc. 25250.",
    "We want 5 + 15 + · · ·",
    "+ 500.",
    "Reverse and add to get 100 sums of 505, a\ntotal of 50500, which is twice the sum we are looking for.\n",
    "4.3.6.3.\na. 45.\n",
    "b. 238 · 44\n2\n= 5355.\n",
    "4.3.6.4.\na. 𝑛−(−2)",
    "+ 1 terms, since to get −18 using the formula 12𝑛+ 6 we must use\n𝑛= −2.\n",
    "b. 12𝑛−6, which is 12 less than 12𝑛+ 6 (or plug in 𝑛−1 for 𝑛).\n",
    "c.\n(12𝑛−12)∗(𝑛−(−2)+1)\n2\n.",
    "Reverse and add.",
    "Each sum gives the constant 12𝑛−12, and\nthere are 𝑛−(−2)",
    "+ 1 terms.\n4.3.6.5. 273310.",
    "If we take 𝑎0 = 2, the terms of the sum are an arithmetic sequence\nwith closed formula 𝑎𝑛= 2 + 6𝑛.",
    "Then 1808 = 𝑎301, for a total of 302 terms in the sum.\n",
    "Reverse and add to get 302 identical 1810 terms, which is twice the total we seek.\n",
    "1810 ·",
    "302/2 = 273310.\n",
    "4.3.6.6.",
    "𝑎𝑛= 𝑛2 + 8𝑛.",
    "Here we know that we are looking for a quadratic because the\nsecond differences are constant.",
    "So 𝑎𝑛= 𝑎𝑛2 + 𝑏𝑛+ 𝑐.",
    "Since 𝑎0 = 0, we know 𝑐= 0.\n",
    "So just solve the system\n9 = 𝑎+ 𝑏\n20 = 4𝑎+ 2𝑏\nto find 𝑎= 1 and 𝑏= 8.\n",
    "4.3.6.7.",
    "𝑎𝑛= 𝑛2 + 4𝑛−1.",
    "Here we know that we are looking for a quadratic because\nthe second differences are constant.",
    "So 𝑎𝑛= 𝑎𝑛2 + 𝑏𝑛+ 𝑐.",
    "Since 𝑎0 = −1, we know\n\n500\nB. Selected Solutions\n𝑐= −1.",
    "So just solve the system\n4 = 𝑎+ 𝑏+ −1\n11 = 4𝑎+ 2𝑏+ −1\nto find 𝑎= 1 and 𝑏= 4.\n",
    "4.3.6.8.",
    "𝑎𝑛= 2𝑛3 −2𝑛+ 5.",
    "Here we know that we are looking for a cubic because the\nthird differences are constant.",
    "So 𝑎𝑛= 𝑎𝑛3 + 𝑏𝑛2",
    "+ 𝑐𝑛+ 𝑑. Since 𝑎0 = 5, we know\n𝑑= 5.",
    "So just solve the system\n5 = 𝑎+ 𝑏+ 𝑐+ 5\n17 = 8𝑎+ 4𝑏+ 2𝑐+ 5\n53 = 27𝑎+ 9𝑏+ 3𝑐+ 5\nto find 𝑎= 2, 𝑏= 0, and 𝑐= −2.\n",
    "4.3.6.9.",
    "𝑎𝑛= 2𝑛3 + 8𝑛2 −4𝑛+ 3.",
    "Here we know that we are looking for a cubic\nbecause the third differences are constant.",
    "So 𝑎𝑛= 𝑎𝑛3 + 𝑏𝑛2",
    "+ 𝑐𝑛+ 𝑑. We can work\nbackwards to find that 𝑎0 = 3, so we know 𝑑= 3.",
    "Then solve the system,\n9 = 𝑎+ 𝑏+ 𝑐+ 3\n43 = 8𝑎+ 4𝑏+ 2𝑐+ 3\n117 = 27𝑎+ 9𝑏+ 3𝑐+ 3\nto find 𝑎= 2, 𝑏= 8, and 𝑐= −4.\n",
    "4.3.6.10.",
    "𝑎𝑛−1 = (𝑛−1)2 + 3(𝑛−1)",
    "+ 2 = 2𝑛2",
    "−𝑛+ 1 Thus 𝑎𝑛−𝑎𝑛−1 = 4𝑛+ 1.",
    "Note\nthat this is linear (arithmetic).\n",
    "4.3.6.11.",
    "𝑎𝑛= 2𝑛3 + 3𝑛2 + 2𝑛.",
    "Here we know that we are looking for a cubic because\nthe third differences are constant.",
    "So 𝑎𝑛= 𝑎𝑛3 +𝑏𝑛2 +𝑐𝑛+𝑑. We can work backwards\nto find that 𝑎0 = 0, so we know 𝑑= 0.",
    "Then solve the system,\n7 = 𝑎+ 𝑏+ 𝑐\n32 = 8𝑎+ 4𝑏+ 2𝑐\n87 = 27𝑎+ 9𝑏+ 3𝑐\nto find 𝑎= 2, 𝑏= 3, and 𝑐= 2.\n4.3.7 ·",
    "Additional Exercises\n4.3.7.4.",
    "𝑎𝑛= 𝑛2 −𝑛+ 1.\n",
    "4.3.7.5.",
    "𝑎𝑛= 𝑛3 + 𝑛2 −𝑛+ 1\n4.3.7.6.",
    "We have 2 = 2, 7 = 2 + 5, 15 = 2 + 5 + 8, 26 = 2 + 5 + 8 + 11, and so on.\n",
    "The terms in the sums are given by the arithmetic sequence 𝑏𝑛= 2 + 3𝑛. In other\nwords, 𝑎𝑛= Í𝑛\n𝑘=0(2 + 3𝑘).",
    "To find the closed formula, we reverse and add.",
    "We get\n𝑎𝑛= (4+3𝑛)(𝑛+1)\n2\n(we have 𝑛+ 1 there because there are 𝑛+ 1 terms in the sum for 𝑎𝑛).\n",
    "4.3.7.9.",
    "𝑎𝑛−1 = 𝑎(𝑛−1)2 + 𝑏(𝑛−1) + 𝑐= 𝑎𝑛2 −2𝑎𝑛+ 𝑎+ 𝑏𝑛−𝑏+ 𝑐.",
    "Therefore\n𝑎𝑛−𝑎𝑛−1 = 2𝑎𝑛−𝑎+𝑏, which is arithmetic.",
    "Notice that this is not quite the derivative\nof 𝑎𝑛, which would be 2𝑎𝑛+ 𝑏, but it is close.\n\n",
    "Selected Solutions\n501\n4.3.7.10.",
    "No.",
    "The sequence of differences is the same as the original sequence, so no\ndifferences will be constant.\n4.3.7.11.",
    "No.",
    "The sequence is geometric, and in fact has closed formula 2 ·",
    "3𝑛. This is\nan exponential function, which is not equal to any polynomial of any degree.",
    "If the\n𝑛th sequence of differences was constant, then the closed formula for the original\nsequence would be a degree 𝑛polynomial.\n",
    "4.4 ·",
    "Exponential Sequences\n4.4.5 ·",
    "Practice Problems\n4.4.5.1.\n6·520−6\n4\n.",
    "Let the sum be 𝑆, and compute 5𝑆−𝑆= 4𝑆, which causes terms\nexcept 6 and 6 · 520 to cancel.",
    "Then solve for 𝑆.\n4.4.5.2.\n",
    "1+(−1)38 738\n438\n11/4\n.",
    "Compute 𝑆+ 7\n4𝑆.\n4.4.5.3.",
    "𝑎𝑛= −4 + 2𝑛+1.",
    "We should use telescoping or iteration here.",
    "For example,\ntelescoping gives\n𝑎1 −𝑎0",
    "= 21\n𝑎2 −𝑎1",
    "= 22\n𝑎3 −𝑎2 = 23\n......\n",
    "𝑎𝑛−𝑎𝑛−1 = 2𝑛\nwhich sums to 𝑎𝑛−𝑎0 = 2𝑛+1 −2 (using the multiply-shift-subtract technique for\nthe geometric series on the right-hand side).",
    "Substituting 𝑎0 = −2 and solving for 𝑎𝑛\ncompletes the solution.\n",
    "4.4.5.4.",
    "By the characteristic root technique.",
    "𝑎𝑛= (−4)𝑛+ 6𝑛.\n4.4.5.5.",
    "The characteristic roots for both sequences are −1 and 2 (since the two\nsequences have the same recurrence relation, they have the same characteristic\nroots).",
    "Solving for coefficients in each case gives the closed formulas.",
    "We have\n𝑎𝑛= (−1)𝑛+ 2𝑛and 𝑏𝑛= \u0000 4\n3\n\u0001\n(−1)𝑛+ \u0000 23\n3\n\u0001\n· 2𝑛.\n4.4.5.6.",
    "By the characteristic root technique.",
    "𝑎𝑛= 7 · 2𝑛−3(−1)𝑛.\n4.4.6 · Additional Exercises\n4.4.6.1. 171 and 341.",
    "𝑎𝑛= 𝑎𝑛−1 + 2𝑎𝑛−2 with 𝑎0 = 3 and 𝑎1 = 5.",
    "Closed formula:\n𝑎𝑛= 8\n32𝑛+ 1\n3(−1)𝑛. To find this solve the characteristic equation, 𝑥2 −𝑥−2 = 0, to\nget characteristic roots 𝑥= 2 and 𝑥= −1.",
    "Then solve the system\n3 = 𝑎+ 𝑏\n5 = 2𝑎−𝑏\n4.4.6.3.",
    "We claim 𝑎𝑛= 4𝑛works.",
    "Plug it in: 4𝑛= 3(4𝑛−1) + 4(4𝑛−2).",
    "This works; just\nsimplify the right-hand side.\n\n",
    "502\nB. Selected Solutions\n4.4.6.6.\n(a) 𝑎𝑛= 4𝑎𝑛−1 + 5𝑎𝑛−2.\n",
    "(b) 4, 21, 104, 521, 2604, 13021\n(c) 𝑎𝑛= 5\n65𝑛+ 1\n6(−1)𝑛.\n4.4.6.8.",
    "We have characteristic polynomial 𝑥2 −2𝑥+ 1, which has 𝑥= 1 as the only\nrepeated root.",
    "Thus, using the characteristic root technique for repeated roots, the\ngeneral solution is 𝑎𝑛= 𝑎+ 𝑏𝑛where 𝑎and 𝑏depend on the initial conditions.\n",
    "(a) 𝑎𝑛= 1 + 𝑛.\n(b) For example, we could have 𝑎0 = 21 and 𝑎1 = 22.\n",
    "(c) For every 𝑥. Take 𝑎0 = 𝑥−9 and 𝑎1 = 𝑥−8.\n",
    "4.5 · Proof by Induction\n4.5.6 · Practice Problems\n4.5.6.1.\nA. Correct.\n",
    "B. Correct.\nC. Incorrect.\n",
    "D. Incorrect.\n",
    "E. Incorrect.\n",
    "4.5.6.2.\nA. Correct.\n",
    "B. Incorrect.\n",
    "C. Incorrect.\n",
    "D. Incorrect.\n",
    "E. Incorrect.\n",
    "4.5.6.3.\nA. Correct.\n",
    "B. Incorrect.\n",
    "Even though the sum starts with 2, we need to consider the smallest 𝑛for\nwhich the statement 𝑃(𝑛) is true.\n",
    "C. Incorrect.\n\n",
    "Selected Solutions\n503\nD. Incorrect.\n",
    "E. Incorrect.\n",
    "4.5.6.4.\nA. Correct.\n",
    "B. Incorrect.\n",
    "Assume 𝑃(𝑘) and 𝑃(𝑘) are both true for an arbitrary 𝑘≥1; that is, assume\n2 + 4 + 6 + · · · + 2𝑘= 𝑘(𝑘+ 1) and 2 + 4 + 6 + · · · + 2𝑘+ 2𝑘+ 2) = (𝑘+ 1)(𝑘+ 2).\n",
    "C. Incorrect.\n",
    "D. Incorrect.\n",
    "4.5.6.5.\n",
    "• Let 𝑃(𝑛) be the statement, “𝑎𝑛= 5𝑛−1”.\n",
    "• Note that 𝑎0 = 50 −1 = 0, so 𝑃(0) is true.\n",
    "• Now assume that 𝑃(𝑘) is true for an arbitrary integer 𝑘≥0.\n•",
    "Then 𝑎𝑘= 5𝑘−1.\n",
    "•",
    "By the recurrence relation, we have 𝑎𝑘+1",
    "= 5𝑎𝑘+ 4 = 5(5𝑘−1)",
    "+ 4",
    ".\n•",
    "This simplifies to 𝑎𝑘+1 = 5𝑘+1 −5",
    "+ 4 = 5𝑘+1 −1, so 𝑃(𝑘+ 1) is true.\n",
    "•",
    "Therefore, by the principle of mathematical induction, 𝑃(𝑛) is true for all 𝑛≥0.\n4.5.6.6.\n• Let 𝑃(𝑛) be the statement, “14𝑛−1 is a multiple of 13.”\n• Note that 141 −1 = 13, so this is definitely a multiple of 13.\n",
    "• Now assume that 𝑃(𝑘) is true for an arbitrary integers 𝑘≥1.\n",
    "•",
    "Then 14𝑘−1 = 13 · 𝑗for some integer 𝑗.\n•",
    "Since 14𝑘+1 −1 = 14(14𝑘−1)",
    "+ 14 −1 = 14(13 · 𝑗)",
    "+ 13, we see that 14𝑘+1 −1 is a\nmultiple of 13.\n",
    "• Thus 𝑃(𝑘+ 1) is true.\n",
    "•",
    "Therefore, by the principle of mathematical induction, 𝑃(𝑛) is true for all 𝑛≥1.\n",
    "4.5.6.7.\n",
    "• Let 𝑃(𝑛) be the statement, “1 + 1 + 2 + 3 + 5 + · · · + 𝐹𝑛= 𝐹𝑛+2 −1.”\n",
    "• For the base case, note that 𝑃(1) and 𝑃(2) are true, because 1 = 2 −1 and\n1 + 1 = 3 −1.\n\n",
    "504\nB. Selected Solutions\n• Now assume that 𝑃(𝑘) is true for an arbitrary integer 𝑘≥2.\n",
    "• That is, assume 1 + 1 + 2 + 3 + 5 + 𝐹𝑘= 𝐹𝑘+2 −1.\n",
    "• Then adding 𝐹𝑘+1 to both sides, we get 1 + 1 + 2 + 3 + 5 + · · ·",
    "+ 𝐹𝑘+ 𝐹𝑘+1 =\n𝐹𝑘+1 + 𝐹𝑘+2 −1.\n",
    "•",
    "By the definition of Fibonacci numbers, 𝐹𝑘+1 + 𝐹𝑘+2 = 𝐹𝑘+3, so the right-hand\nside simplifies to 𝐹𝑘+3 −1.\n",
    "• Thus 𝑃(𝑘+ 1) is true, and therefore by the principle of mathematical induction,\n𝑃(𝑛) is true for all 𝑛≥1.\n",
    "4.5.7 · Additional Exercises\n4.5.7.1.\n(a) If we have a number of beans ending in a 5, and we double it, we will get a\nnumber of beans ending in a 0 (since 5 · 2 = 10 ).",
    "Then if we subtract 5, we will\nonce again get a number of beans ending in a 5.",
    "Thus, if on any day we have a\nnumber ending in a 5, the next day we will also have a number ending in a 5.\n(b) If you don’t start with a number of beans ending in a 5 (on day 1), the above\nreasoning is still correct but not helpful.",
    "For example, if you start with a\nnumber ending in a 3, the next day you will have a number ending in a 1.\n(c) Part (b) is the base case, and part (a) is the inductive case.",
    "If on day 1 we have\na number ending in a 5 (by part (b)), then on day 2 we will also have a number\nending in a 5 (by part (a)).",
    "Then by part (a) again, we will have a number\nending in a 5 on day 3.",
    "By part (a) again, this means we will have a number\nending in a 5 on day 4.\n",
    "The proof by induction would say that on every day we will have a number\nending in a 5, and this works because we can start with the base case and then\nuse the inductive case over and over until we get up to our desired 𝑛.\n4.5.7.2.\nProof.\n",
    "We must prove that 1 + 2",
    "+ 22 + 23 + · · · + 2𝑛= 2𝑛+1 −1 for all 𝑛∈ℕ. Thus let\n𝑃(𝑛) be the statement 1 + 2 + 22 + · · ·",
    "+ 2𝑛= 2𝑛+1 −1.",
    "We will prove that 𝑃(𝑛) is true\nfor all 𝑛∈ℕ. First we establish the base case, 𝑃(0), which claims that 1 = 20+1 −1.\n",
    "Since 21 −1 = 2 −1 = 1, we see that 𝑃(0) is true.",
    "Now for the inductive case.",
    "Assume\nthat 𝑃(𝑘) is true for an arbitrary 𝑘∈ℕ. That is, 1 + 2 + 22 + · · · + 2𝑘= 2𝑘+1 −1.",
    "We\nmust show that 𝑃(𝑘+ 1) is true (i.e., that 1 + 2 + 22 + · · · + 2𝑘+1 = 2𝑘+2 −1).",
    "To do this,\nwe start with the left-hand side of 𝑃(𝑘+ 1) and work to the right-hand side:\n1 + 2",
    "+ 22 + · · · + 2𝑘+ 2𝑘+1 = 2𝑘+1 −1 + 2𝑘+1\n",
    "by the inductive hypothesis.\n",
    "= 2 · 2𝑘+1 −1\n= 2𝑘+2 −1\n",
    "Thus 𝑃(𝑘+ 1) is true, so by the principle of mathematical induction, 𝑃(𝑛) is true\n\nSelected Solutions\n505\nfor all 𝑛∈ℕ.\n■\n4.5.7.3.\nProof.\n",
    "Let 𝑃(𝑛) be the statement, “7𝑛−1 is a multiple of 6.”",
    "We will show 𝑃(𝑛) is\ntrue for all 𝑛∈ℕ. First we establish the base case, 𝑃(0).",
    "Since 70 −1 = 0, and 0 is a\nmultiple of 6, 𝑃(0) is true.",
    "Now for the inductive case.",
    "Assume 𝑃(𝑘) holds for an\narbitrary 𝑘∈ℕ. That is, 7𝑘−1 is a multiple of 6, or in other words, 7𝑘−1 = 6𝑗for\nsome integer 𝑗. Now consider 7𝑘+1 −1:\n7𝑘+1 −1 = 7𝑘+1 −7 + 6\nby cleverness: −1 = −7 + 6\n= 7(7𝑘−1)",
    "+ 6\nfactor out a 7 from the first two terms\n= 7(6𝑗)",
    "+ 6\nby the inductive hypothesis\n= 6(7𝑗+ 1)\nfactor out a 6\nTherefore 7𝑘+1 −1 is a multiple of 6, or in other words, 𝑃(𝑘+ 1) is true.",
    "Therefore\nby the principle of mathematical induction, 𝑃(𝑛) is true for all 𝑛∈ℕ.\n■\n4.5.7.4.\nProof.\n",
    "Let 𝑃(𝑛) be the statement 1 + 3 + 5 + · · · + (2𝑛−1) = 𝑛2.",
    "We will prove that\n𝑃(𝑛) is true for all 𝑛≥1.",
    "First the base case, 𝑃(1).",
    "We have 1 = 12 which is true,\nso 𝑃(1) is established.",
    "Now the inductive case.",
    "Assume that 𝑃(𝑘) is true for some\nfixed arbitrary 𝑘≥1.",
    "That is, 1 + 3 + 5 + · · · + (2𝑘−1) = 𝑘2.",
    "We will now prove that\n𝑃(𝑘+ 1) is also true (i.e., that 1 + 3 + 5 + · · · + (2𝑘+ 1) = (𝑘+ 1)2).",
    "We start with the\nleft-hand side of 𝑃(𝑘+ 1) and work to the right-hand side:\n1 + 3 + 5 + · · · + (2𝑘−1)",
    "+",
    "(2𝑘+ 1) = 𝑘2 + (2𝑘+ 1)\nby the inductive hypothesis\n= (𝑘+ 1)2\nby factoring\nThus 𝑃(𝑘+ 1) holds, so by the principle of mathematical induction, 𝑃(𝑛) is true\nfor all 𝑛≥1.\n",
    "■\n4.5.7.5.\nProof.\n",
    "Let 𝑃(𝑛) be the statement 𝐹0 + 𝐹2 + 𝐹4 + · · ·",
    "+ 𝐹2𝑛= 𝐹2𝑛+1 −1.",
    "We will show\nthat 𝑃(𝑛) is true for all 𝑛≥0.",
    "First the base case is easy because 𝐹0 = 0 and",
    "𝐹1 = 1 so\n𝐹0 = 𝐹1 −1.",
    "Now consider the inductive case.",
    "Assume 𝑃(𝑘) is true, that is, assume\n𝐹0 + 𝐹2 + 𝐹4 + · · ·",
    "+ 𝐹2𝑘= 𝐹2𝑘+1 −1.",
    "To establish 𝑃(𝑘+ 1) we work from left to right:\n𝐹0 + 𝐹2 + · · ·",
    "+ 𝐹2𝑘+ 𝐹2𝑘+2 = 𝐹2𝑘+1 −1 + 𝐹2𝑘+2\nby the inductive hypothesis.\n",
    "= 𝐹2𝑘+1 + 𝐹2𝑘+2 −1\n= 𝐹2𝑘+3 −1\nby the recursive definition.\n",
    "Therefore 𝐹0 + 𝐹2 + 𝐹4 + · · · + 𝐹2𝑘+2 = 𝐹2𝑘+3 −1, which is to say 𝑃(𝑘+ 1) holds.\n",
    "Therefore by the principle of mathematical induction, 𝑃(𝑛) is true for all 𝑛≥0.\n",
    "■\n4.5.7.6.\nProof.\n",
    "Let 𝑃(𝑛) be the statement 2𝑛< 𝑛!.",
    "We will show 𝑃(𝑛) is true for all 𝑛≥4.\n\n",
    "506\nB. Selected Solutions\nFirst, we check the base case and see that yes, 24 < 4!",
    "(as 16 < 24), so 𝑃(4) is true.\n",
    "Now for the inductive case.",
    "Assume 𝑃(𝑘) is true for an arbitrary 𝑘≥4.",
    "That is,\n2𝑘< 𝑘!.",
    "Now consider 𝑃(𝑘+ 1): 2𝑘+1 < (𝑘+ 1)!.",
    "To prove this, we start with the left\nside and work to the right side.\n",
    "2𝑘+1 = 2 · 2𝑘\n< 2 · 𝑘!\nby the inductive hypothesis\n< (𝑘+ 1) · 𝑘!\nsince 𝑘+ 1 > 2\n= (𝑘+ 1)!\n",
    "Therefore 2𝑘+1 < (𝑘+ 1)!, so we have established 𝑃(𝑘+ 1).",
    "Thus by the principle\nof mathematical induction 𝑃(𝑛) is true for all 𝑛≥4.\n",
    "■\n4.5.7.12.",
    "The only problem is that we never established the base case.",
    "Of course,\nwhen 𝑛= 0, 0 + 3 ≠0 + 7.\n4.5.7.13.\nProof.\n",
    "Let 𝑃(𝑛) be the statement that 𝑛+ 3 < 𝑛+ 7.",
    "We will prove that 𝑃(𝑛) is true\nfor all 𝑛∈ℕ. First, note that the base case holds: 0",
    "+ 3 < 0",
    "+ 7.",
    "Now assume for\ninduction that 𝑃(𝑘) is true.",
    "That is, 𝑘+ 3 < 𝑘+ 7.",
    "We must show that 𝑃(𝑘+ 1) is\ntrue.",
    "Now since 𝑘+ 3 < 𝑘+ 7, add 1 to both sides.",
    "This gives 𝑘+ 3 + 1 < 𝑘+ 7",
    "+ 1.\n",
    "Regrouping (𝑘+ 1) + 3 < (𝑘+ 1) + 7.",
    "But this is simply 𝑃(𝑘+ 1).",
    "Thus by the principle\nof mathematical induction 𝑃(𝑛) is true for all 𝑛∈ℕ.\n■\n4.5.7.14.",
    "The problem here is that while 𝑃(0) is true, and while 𝑃(𝑘) →𝑃(𝑘+ 1) for\nsome values of 𝑘, there is at least one value of 𝑘(namely 𝑘= 99) when that implication\nfails.",
    "For a valid proof by induction, 𝑃(𝑘) →𝑃(𝑘+ 1) must be true for all values of 𝑘\ngreater than or equal to the base case.\n",
    "4.5.7.16.",
    "We once again failed to establish the base case: When 𝑛= 0, 𝑛2 + 𝑛= 0\nwhich is even, not odd.\n",
    "4.5.7.22.",
    "The idea here is that if we take the logarithm of 𝑎𝑛, we can increase 𝑛by 1\nif we multiply by another 𝑎(inside the logarithm).",
    "This results in adding 1 more\nlog(𝑎) to the total.\nProof.\n",
    "Let 𝑃(𝑛) be the statement log(𝑎𝑛)",
    "= 𝑛log(𝑎).",
    "The base case, 𝑃(2) is true,\nbecause log(𝑎2) = log(𝑎· 𝑎) = log(𝑎)",
    "+ log(𝑎) = 2 log(𝑎), by the product rule for\nlogarithms.",
    "Now assume, for induction, that 𝑃(𝑘) is true.",
    "That is, log(𝑎𝑘) = 𝑘log(𝑎).\n",
    "Consider log(𝑎𝑘+1).",
    "We have\nlog(𝑎𝑘+1)",
    "= log(𝑎𝑘· 𝑎) = log(𝑎𝑘)",
    "+ log(𝑎) = 𝑘log(𝑎) + log(𝑎),\nwith the last equality due to the inductive hypothesis.\n",
    "But this simplifies to\n(𝑘+ 1) log(𝑎), establishing 𝑃(𝑘+ 1).",
    "Therefore by the principle of mathematical\ninduction, 𝑃(𝑛) is true for all 𝑛≥2.\n",
    "■\n4.6 · Strong Induction\n\nSelected Solutions\n507\n4.6.4 · Practice Problems\n4.6.4.1.\nA. Correct.\n",
    "B. Correct.\nC. Incorrect.\n",
    "D. Incorrect.\n",
    "E. Incorrect.\n",
    "4.6.4.2.\n",
    "• Let 𝑃(𝑛) be the statement that a chocolate bar that is 𝑛squares long can be\nbroken into 𝑛pieces by making 𝑛−1 breaks.\n",
    "• 𝑃(1) is true because a chocolate bar that is 1 square long is already in one piece.\n",
    "• Assume that 𝑃(𝑗) is true for all 𝑗≤𝑘for an arbitrary 𝑘≥1.\n",
    "• Consider a chocolate bar that is 𝑘+ 1 squares long.\n",
    "•",
    "Anywhere you break this bar will result in two smaller bars, say of length 𝑎\nand 𝑏.\n• Since 𝑎and 𝑏are no more than 𝑘, it will be possible to break these smaller bars\ninto single squares using 𝑎−1 and 𝑏−1 breaks, respectively.\n",
    "•",
    "The total number of breaks is therefore 𝑎−1 + 𝑏−1",
    "+ 1 = 𝑎+ 𝑏−1, which is\n𝑘+ 1 −1 = 𝑘.\n•",
    "Therefore, by the principle of strong induction, 𝑃(𝑛) is true for all 𝑛≥1.\n",
    "4.6.5 · Additional Exercises\n4.6.5.3.",
    "The proof will be by strong induction.\n",
    "Proof.\n",
    "Let 𝑃(𝑛) be the statement, “𝑛is either a power of 2 or can be written as the\nsum of distinct powers of 2.”",
    "We will show that 𝑃(𝑛) is true for all 𝑛≥1.\n",
    "Base case: 1 = 20 is a power of 2, so 𝑃(1) is true.\n",
    "Inductive case: Suppose 𝑃(𝑘) is true for all 𝑘< 𝑛. Now if 𝑛is a power of 2, we\nare done.",
    "If not, let 2𝑥be the largest power of 2 strictly less than 𝑛. Consider 𝑛−2𝑥,\nwhich is a smaller number, in fact smaller than both 𝑛and 2𝑥. Thus 𝑛−2𝑥is either a\npower of 2 or can be written as the sum of distinct powers of 2, but none of them are\ngoing to be 2𝑥, so together with 2𝑥we have written 𝑛as the sum of distinct powers\nof 2.\n",
    "Therefore, by the principle of (strong) mathematical induction, 𝑃(𝑛) is true for\nall 𝑛≥1.\n",
    "■\n4.7 · Chapter Summary\n\n508\nB. Selected Solutions\n· Chapter Review\n4.7.1. 1250·206\n2\n= 128750.\n",
    "4.7.2.\n",
    "a. 𝑛−3 terms.\n",
    "b. 10𝑛+ (−12).\n",
    "c. (10𝑛+ 26) ∗(𝑛−3)\n2\n.\n",
    "4.7.3.\na. 6, 30, 150, 750, . . .",
    "The sequence is geometric.\n",
    "b. 6 · 522 −6\n4\n= 3.57628 × 1015.\n",
    "4.7.5.",
    "𝑎𝑛= 𝑛2 + 8𝑛+ 2.",
    "Here we know that we are looking for a quadratic because\nthe second differences are constant.",
    "So 𝑎𝑛= 𝑎𝑛2 + 𝑏𝑛+ 𝑐.",
    "We can work backwards\nto find that 𝑎0 = 2, so we know 𝑐= 2.",
    "Then solve the system,\n11 = 𝑎+ 𝑏+ 2\n22 = 4𝑎+ 2𝑏+ 2\nto find 𝑎= 1 and 𝑏= 8.\n4.7.6.\n",
    "(a) The sequence of partial sums will be a degree 4 polynomial (its sequence of\ndifferences will be the original sequence).\n",
    "(b) The sequence of second differences will be a degree 1 polynomial (an arithmetic\nsequence).\n",
    "4.7.7.\n(a) 4, 6, 10, 16, 26, 42, . . ..\n(b) No, taking differences gives the original sequence back, so the differences will\nnever be constant.\n4.7.8.",
    "𝑏𝑛= (𝑛+ 3)𝑛.\n4.7.10.\n",
    "The sequence is 4, 9, 89, 269, 2049, . .",
    "..\n",
    "It has closed formula 𝑎𝑛\n=\n\u0000 11\n9\n\u0001\n(−4)𝑛+ \u0000 25\n9\n\u0001\n· 5𝑛, using the characteristic root technique.\n4.7.11.\n",
    "The sequence is 5, 7, 111, 459, 3375, . .",
    "..\n",
    "It has closed formula 𝑎𝑛=\n\u0000 23\n9\n\u0001\n(−3)𝑛+ \u0000 22\n9\n\u0001\n· 6𝑛, using the characteristic root technique.\n",
    "4.7.12.\n(a) On the first day, your 2 mini bunnies become 2 large bunnies.",
    "On day 2, your\n2 large bunnies produce 4 mini bunnies.",
    "On day 3, you have 4 mini bunnies\n\nSelected Solutions\n509\n(produced by your 2 large bunnies) plus 6 large bunnies (your original 2 plus\nthe 4 newly matured bunnies).",
    "On day 4, you will have 12 mini bunnies (2 for\neach of the 6 large bunnies) plus 10 large bunnies (your previous 6 plus the 4\nnewly matured).",
    "The sequence of total bunnies is 2, 2, 6, 10, 22, 42 . . .",
    "starting\nwith 𝑎0 = 2 and 𝑎1 = 2.\n(b) 𝑎𝑛= 𝑎𝑛−1+2𝑎𝑛−2.",
    "This is because the number of bunnies is equal to the number\nof bunnies you had the previous day (both mini and large) plus 2 times the\nnumber you had the day before that (since all bunnies you had 2 days ago are\nnow large and producing 2 new bunnies each).\n",
    "(c) Using the characteristic root technique, we find 𝑎𝑛= 𝑎2𝑛+ 𝑏(−1)𝑛, and we can\nfind 𝑎and 𝑏to give 𝑎𝑛= 4\n32𝑛+ 2\n3(−1)𝑛.\n4.7.17.",
    "Let 𝑃(𝑛) be the statement, “Every set containing 𝑛elements has 2𝑛different\nsubsets.”",
    "We will show 𝑃(𝑛) is true for all 𝑛≥1.",
    "Base case: Any set with 1 element\n{𝑎} has exactly 2 subsets: the empty set and the set itself.",
    "Thus the number of\nsubsets is 2 = 21.",
    "Thus 𝑃(1) is true.",
    "Inductive case: Suppose 𝑃(𝑘) is true for some\narbitrary 𝑘≥1.",
    "Thus every set containing exactly 𝑘elements has 2𝑘different subsets.\n",
    "Now consider a set containing 𝑘+ 1 elements: 𝐴= {𝑎1, 𝑎2, . .",
    ".",
    ", 𝑎𝑘, 𝑎𝑘+1}.",
    "Any subset\nof 𝐴must either contain 𝑎𝑘+1 or not.",
    "In other words, a subset of 𝐴is just a subset of\n{𝑎1, 𝑎2, . . .",
    ", 𝑎𝑘} with or without 𝑎𝑘+1.",
    "Thus there are 2𝑘subsets of 𝐴which contain\n𝑎𝑘+1 and another 2𝑘+1 subsets of 𝐴which do not contain 𝑎𝑘+1.",
    "This gives a total\nof 2𝑘+ 2𝑘= 2 · 2𝑘= 2𝑘+1 subsets of 𝐴.",
    "But our choice of 𝐴was arbitrary, so this\nworks for any subset containing 𝑘+ 1 elements, so 𝑃(𝑘+ 1) is true.",
    "Therefore, by the\nprinciple of mathematical induction, 𝑃(𝑛) is true for all 𝑛≥1.\n5 · Discrete Structures Revisited\n5.1 ·",
    "Sets\n5.1.5 · Exercises\n5.1.5.1.\na. 𝐴∪𝐵= {2, 4, 5, 6, 7, 8}.",
    "It includes everything that is in 𝐴or 𝐵or both.\nb. 𝐴∩𝐵= {2, 4, 5, 6}.",
    "It contains everything that is in both 𝐴and 𝐵.\nc. 𝐴\\ 𝐵= {7}.",
    "It contains everything that is in 𝐴except anything that is also in 𝐵.\nWe could also have written this set as 𝐴∩𝐵.\nd. 𝐵\\ 𝐴= {8}.",
    "It contains everything in 𝐵except anything that is also in 𝐴.\nAnother way to write this is 𝐵∩𝐴. Note that 𝐴\\ 𝐵≠𝐵\\ 𝐴.\n5.1.5.2.\na.",
    "This is the set {3, 4, 5, . . .",
    "}",
    "since we need each element to be a natural number\nwhose square is at least 3 more than 4.",
    "Since 32 −3 = 6 but 22 −3 = 1 we see\nthat the first such natural number is 3.\nb.",
    "We get the same set as the previous part, and the smallest non-negative number\n\n510\nB. Selected Solutions\nfor which 𝑛2 −7 is a natural number is 3.\n",
    "Note that if we didn’t specify 𝑛≥0 by saying that 𝑛∈ℕthen any integer less\nthan −3 would also be in the set, so there would not be a least element.\n",
    "c.",
    "This is the set {4, 5, 8, 13, . . .",
    "}, namely the set of numbers that are the result of\nsquaring and adding 4 to a natural number.",
    "(02 + 4 = 4, 12 + 4 = 5, 22 + 4 = 8\nand so on.)",
    "Thus the least element of the set is 4.\n",
    "d.",
    "Now we are looking for natural numbers that are equal to taking some natural\nnumber, squaring it and adding 4.",
    "That is, {4, 5, 8, 13, . . .",
    "}, the same set as the\nprevious part.",
    "So again, the least element is 4.\n5.1.5.4.",
    "The set of largest size that is a subset of both 𝐴and 𝐵is the intersection of\n𝐴and 𝐵, 𝐴∩𝐵= {8}.\n",
    "5.1.5.7.",
    "There will be exactly 4 such sets: {1, 4, 14},{1, 4, 12, 14}, {1, 4, 7, 14}, and\n{1, 4, 7, 12, 14}.\n",
    "5.1.5.8.\na. 𝐴∩𝐵= {4, 5, 6}.\n",
    "b. 𝐴∪𝐵= {2, 3, 4, 5, 6, 7, 8}.\n",
    "c. 𝐴\\ 𝐵= {2, 3}.\n",
    "d. 𝐴∩(𝐵∪𝐶) = {2}.\n",
    "5.1.5.11.",
    "For example, 𝐴= {2, 3, 5, 7, 8} and 𝐵= {3, 5} .\n5.1.5.12.",
    "For example, 𝐴= {1, 2, 3} and 𝐵= {1, 2, 3, 4, 5, {1, 2, 3}}\n5.1.5.13.\n(a) No.\n(b) No.\n(c) 2ℤ∩3ℤis the set of all integers which are multiples of both 2 and 3 (so\nmultiples of 6).",
    "Therefore 2ℤ∩3ℤ= {𝑥∈ℤ: ∃𝑦∈ℤ(𝑥= 6𝑦)}.\n",
    "(d) 2ℤ∪3ℤ.\n5.1.5.15.\n\n",
    "Selected Solutions\n511\n(a) 𝐴∪𝐵:\n𝐴\n𝐵\n(b) (𝐴∪𝐵):\n𝐴\n𝐵\n(c) 𝐴∩(𝐵∪𝐶):\n𝐴\n𝐵\n𝐶\n(d) (𝐴∩𝐵) ∪𝐶:\n𝐴\n𝐵\n𝐶\n(e) 𝐴∩𝐵∩𝐶:\n𝐴\n𝐵\n𝐶\n(f) (𝐴∪𝐵) \\ 𝐶:\n𝐴\n𝐵\n𝐶\n5.1.5.17.\n𝒫(𝐴) = {∅, {𝑎}, {𝑏}, {𝑐}, {𝑑}, {𝑎, 𝑏}, {𝑎, 𝑐}, {𝑎, 𝑑}, {𝑏, 𝑐}, {𝑏, 𝑑},\n{𝑐, 𝑑}{𝑎, 𝑏, 𝑐}, {𝑎, 𝑏, 𝑑}, {𝑎, 𝑐, 𝑑}, {𝑏, 𝑐, 𝑑}, {𝑎, 𝑏, 𝑐, 𝑑}}.\n",
    "5.1.5.18.",
    "Each of the 9 elements can be in a singleton set, so there are 9 of these.\n",
    "To count the number of doubletons, not that there are 8 sets that include 1, and\nthen 7 sets that include 2 and not 1, and then 6 that include 3 and not 1 or 2, and so\non.",
    "So you can find 36 by summing the numbers from 1 to 8.\n5.1.5.20.\n",
    "For example, 𝐴= {1, 2, 3, 4} and 𝐵= {5, 6, 7, 8, 9} gives 𝐴∪𝐵=\n{1, 2, 3, 4, 5, 6, 7, 8, 9}.\n5.1.5.28.",
    "We need to be a little careful here.",
    "If 𝐵contains 3 elements, then 𝐴contains\njust the number 3 (listed twice).",
    "So that would make |𝐴| = 1, which would make\n𝐵= {1, 3}, which only has 2 elements.",
    "Thus |𝐵| ≠3.",
    "This means that |𝐴| = 2, so 𝐵\ncontains at least the elements 1 and 2.",
    "Since |𝐵| ≠3, we must have |𝐵| = 2, which\nagrees with the definition of 𝐵.\nTherefore it must be that 𝐴= {2, 3} and 𝐵= {1, 2}\n5.2 · Functions\n5.2.4 · Exercises\n5.2.4.1.\n",
    "a. 𝑓(4)",
    "= 2, since 2 is the number below 4 in the two-line notation.\nb.",
    "Such an 𝑛is 𝑛= 3, since 𝑓(3) = 4.",
    "Note that 3 is above a 4 in the notation.\n",
    "c. 𝑛= 1 has this property.",
    "We say that 1 is a fixed point of 𝑓. Not all functions\nhave such a point.\n",
    "d.",
    "Such an element is 3 (in fact, that is the only element in the codomain that is\nnot in the range).",
    "In other words, 3 is not the image of any element under 𝑓;\nnothing is sent to 3.\n\n512\nB. Selected Solutions\n5.2.4.5.",
    "There are 16 different functions.",
    "None of the functions are injective.",
    "Exactly\n14 of the functions are surjective (there are 2 that are not: those that send everything\nto 𝑎or everything to 𝑏).",
    "No functions are both (since no functions here are injective).\n",
    "5.2.4.6.",
    "There are 16 functions: you have a choice of four outputs for 𝑓(1), and for\neach, you have four choices for the output 𝑓(2).",
    "Of these functions, 12 are injective, 0\nare surjective, and 0 are both (i.e., bĳective):\n𝑓=\n\u0012\n1\n2\n𝑎\n𝑎\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑏\n𝑏\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑐\n𝑐\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑑\n𝑑\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑎\n𝑏\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑎\n𝑐\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑎\n𝑑\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑏\n𝑐\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑏\n𝑎\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑐\n𝑎\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑑\n𝑎\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑐\n𝑏\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑏\n𝑑\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑑\n𝑏\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑐\n𝑑\n\u0013\n𝑓=\n\u0012\n1\n2\n𝑑\n𝑐\n\u0013\n5.2.4.7.\n",
    "(a) 𝑓is not injective, since 𝑓(2)",
    "= 𝑓(5); two different inputs have the same output.\n",
    "(b) 𝑓is surjective, since every element of the codomain is an element of the range.\n",
    "(c) 𝑓=\n\u0012\n1\n2\n3\n4\n5\n3\n2\n4\n1\n2\n\u0013\n.\n",
    "5.2.4.12.\n(a) 𝑓is injective, but not surjective (since 0, for example, is never an output).\n",
    "(b) 𝑓is injective and surjective.",
    "Unlike in the previous question, every integers is\nan output (of the integer 4 less than it).\n",
    "(c) 𝑓is injective, but not surjective (10 is not 8 less than a multiple of 5, for\nexample).\n",
    "(d) 𝑓is not injective, but is surjective.",
    "Every integer is an output (of twice itself, for\nexample) but some integers are outputs of more than one input: 𝑓(5)",
    "= 3 = 𝑓(6).\n",
    "5.2.4.13.\n(a) 𝑓is not injective.",
    "To prove this, we must simply find two different elements of\nthe domain which map to the same element of the codomain.",
    "Since 𝑓({1}) = 1\nand 𝑓({2})",
    "= 1, we see that 𝑓is not injective.\n",
    "(b) 𝑓is not surjective.",
    "The largest subset of 𝐴is 𝐴itself, and |𝐴| = 10.",
    "So no\nnatural number greater than 10 will ever be an output.\n",
    "(c) 𝑓−1(1) = {{1}, {2}, {3}, . . .",
    "{10}} (the set of all the singleton subsets of 𝐴).\n\n",
    "Selected Solutions\n513\n(d) 𝑓−1(0) = {∅}.",
    "Note that it would be wrong to write 𝑓−1(0) = ∅; that would\nclaim that there is no input which has 0 as an output.\n",
    "(e) 𝑓−1(12) = ∅, since there are no subsets of 𝐴with cardinality 12.\n",
    "5.2.4.16.\n(a) | 𝑓−1(3)| ≤1.",
    "In other words, either 𝑓−1(3) is the empty set or is a set containing\nexactly one element.",
    "Injective functions cannot have two elements from the\ndomain both map to 3.\n(b) | 𝑓−1(3)| ≥1.",
    "In other words, 𝑓−1(3) is a set containing at least one elements,\npossibly more.",
    "Surjective functions must have something map to 3.\n(c) | 𝑓−1(3)| = 1.",
    "There is exactly one element from 𝑋which gets mapped to 3, so\n𝑓−1(3) is the set containing that one element.\n",
    "5.2.4.17.",
    "𝑋can really be any set, as long as 𝑓(𝑥) = 0 or 𝑓(𝑥) = 1 for every 𝑥∈𝑋. For\nexample, 𝑋= ℕand 𝑓(𝑛) = 0 works.\n",
    "5.2.4.21.\n",
    "(a) 𝑓is injective.\n",
    "Proof.\n",
    "Let 𝑥and 𝑦be elements of the domain ℤ. Assume 𝑓(𝑥) = 𝑓(𝑦).",
    "If 𝑥\nand 𝑦are both even, then 𝑓(𝑥) = 𝑥+ 1 and 𝑓(𝑦) = 𝑦+ 1.",
    "Since 𝑓(𝑥) = 𝑓(𝑦), we\nhave 𝑥+ 1 = 𝑦+ 1 which implies that 𝑥= 𝑦.",
    "Similarly, if 𝑥and 𝑦are both odd,\nthen 𝑥−3 = 𝑦−3 so again 𝑥= 𝑦.",
    "The only other possibility is that 𝑥is even\nand 𝑦is odd (or vice-versa).",
    "But then 𝑥+ 1 would be odd, and 𝑦−3 would be\neven, so it cannot be that 𝑓(𝑥) = 𝑓(𝑦).",
    "Therefore if 𝑓(𝑥) = 𝑓(𝑦) we then have\n𝑥= 𝑦, which proves that 𝑓is injective.\n",
    "■\n(b) 𝑓is surjective.\n",
    "Proof.\n",
    "Let 𝑦be an element of the codomain ℤ. We will show there is an\nelement 𝑛of the domain (ℤ) such that 𝑓(𝑛) = 𝑦.",
    "There are two cases:",
    "First, if 𝑦\nis even, then let 𝑛= 𝑦+3.",
    "Since 𝑦is even, 𝑛is odd, so 𝑓(𝑛) = 𝑛−3 = 𝑦+3−3 = 𝑦\nas desired.",
    "Second, if 𝑦is odd, then let 𝑛= 𝑦−1.",
    "Since 𝑦is odd, 𝑛is even, so\n𝑓(𝑛) = 𝑛+ 1 = 𝑦−1 + 1 = 𝑦as needed.",
    "Therefore 𝑓is surjective.\n",
    "■\n5.2.4.22.",
    "Yes, this is a function, if you choose the domain and codomain correctly.\n",
    "The domain will be the set of students, and the codomain will be the set of possible\ngrades.",
    "The function is almost certainly not injective, because it is likely that two\nstudents will get the same grade.",
    "The function might be surjective – it will be if\nthere is at least one student who gets each grade.\n",
    "5.2.4.24.",
    "This is not a function.\n",
    "5.2.4.25.",
    "The recurrence relation is 𝑓(𝑛+ 1) = 𝑓(𝑛) + 𝑛.\n5.2.4.26.",
    "In general, |𝐴| ≥\n\f\f𝑓(𝐴)\n\f\f, since you cannot get more outputs than you have\ninputs (each input goes to exactly one output), but you could have fewer outputs if\n\n514\nB. Selected Solutions\nthe function is not injective.",
    "If the function is injective, then |𝐴| =\n\f\f𝑓(𝐴)\n\f\f, although\nyou can have equality even if 𝑓is not injective (it must be injective restricted to 𝐴).\n",
    "5.2.4.27.",
    "In general, there is no relationship between |𝐵| and\n\f\f𝑓−1(𝐵)\n\f\f.",
    "This is because\n𝐵might contain elements that are not in the range of 𝑓, so we might even have\n𝑓−1(𝐵) = ∅. On the other hand, there might be lots of elements from the domain that\nall get sent to a few elements in 𝐵, making 𝑓−1(𝐵) larger than 𝐵.\nMore specifically, if 𝑓is injective, then |𝐵| ≥\n\f\f𝑓−1(𝐵)\n\f\f (since every element in\n𝐵must come from at most one element from the domain).",
    "If 𝑓is surjective, then\n|𝐵| ≤\n\f\f𝑓−1(𝐵)\n\f\f (since every element in 𝐵must come from at least one element of the\ndomain).",
    "Thus if 𝑓is bĳective then |𝐵| =\n\f\f𝑓−1(𝐵)\n\f\f.\n",
    "6 · Additional Topics\n6.1 · Generating Functions\n6.1.5 · Exercises\n6.1.5.1.\n(a)\n4\n1 −𝑥.\n(b)\n2\n(1 −𝑥)2 .\n",
    "(c)\n2𝑥3\n(1 −𝑥)2 .\n",
    "(d)\n1\n1 −5𝑥.\n(e)\n1\n1 + 3𝑥.\n(f)\n1\n1 −5𝑥2 .\n",
    "(g)\n𝑥\n(1 −𝑥3)2 .\n",
    "6.1.5.2.\n(a) 0, 4, 4, 4, 4, 4, . .",
    "..\n(b) 1, 4, 16, 64, 256, . .",
    "..\n",
    "(c) 0, 1, −1, 1, −1, 1, −1, . .",
    "..\n(d) 0, 3, −6, 9, −12, 15, −18, . .",
    "..\n(e) 1, 3, 6, 9, 12, 15, . .",
    "..\n",
    "6.1.5.4.",
    "Call the generating function 𝐴. Compute 𝐴−𝑥𝐴= 4+𝑥+2𝑥2 +3𝑥3 +4𝑥4 +· · ·.\n",
    "Thus 𝐴−𝑥𝐴= 4 +\n𝑥\n(1 −𝑥)2 .",
    "Solving for 𝐴gives\n4\n1 −𝑥+\n𝑥\n(1 −𝑥)3 .\n",
    "6.1.5.5.\n1 + 2𝑥\n1 −3𝑥+ 𝑥2 .\n",
    "6.1.5.6.",
    "Compute 𝐴−𝑥𝐴−𝑥2𝐴and then solve for 𝐴.",
    "The generating function will\nbe\n𝑥\n1 −𝑥−𝑥2 .\n",
    "6.1.5.7.\n𝑥\n(1 −𝑥)(1 −𝑥−𝑥2).\n\n",
    "Selected Solutions\n515\n6.1.5.8.\n2\n1 −5𝑥+\n7\n1 + 3𝑥.\n6.1.5.9.",
    "𝑎𝑛= 3 · 4𝑛−1 + 1.\n6.1.5.12.\n(a)\n1\n(1−𝑥2)2 .\n(b)\n1\n(1+𝑥)2 .\n(c)\n3𝑥\n(1−𝑥)2 .\n",
    "(d)\n3𝑥\n(1−𝑥)3 .",
    "(partial sums).\n",
    "6.1.5.13.\n(a) 0, 0, 1, 1, 2, 3, 5, 8, . .",
    "..\n(b) 1, 0, 1, 0, 2, 0, 3, 0, 5, 0, 8, 0, . .",
    "..\n",
    "(c) 1, 3, 18, 81, 405, . .",
    "..\n(d) 1, 2, 4, 7, 12, 20, . .",
    "..\n",
    "6.1.5.15.\n",
    "𝑥3\n(1−𝑥)2 +\n1\n1−𝑥.\n6.2 · Introduction to Number Theory\n6.2.6 · Exercises\n6.2.6.1.\nProof.\n",
    "Suppose 𝑎| 𝑏. Then 𝑏is a multiple of 𝑎, or in other words, 𝑏= 𝑎𝑘for some 𝑘.\n",
    "But then 𝑏𝑐= 𝑎𝑘𝑐, and since 𝑘𝑐is an integer, this says 𝑏𝑐is a multiple of 𝑎.",
    "In other\nwords, 𝑎| 𝑏𝑐.\n■\n6.2.6.3. {. . .",
    ", −8, −4, 0, 4, 8, 12, . . .",
    "}, {. . .",
    ", −7, −3, 1, 5, 9, 13, . . .},\n{. . . , −6, −2, 2, 6, 10, 14, . . .}, and {. . .",
    ", −5, −1, 3, 7, 11, 15, . . .}.\n",
    "6.2.6.5.\nProof.\nAssume 𝑎≡𝑏(mod 𝑛) and 𝑐≡𝑑(mod 𝑛).",
    "This means 𝑎=",
    "𝑏+ 𝑘𝑛and\n𝑐= 𝑑+ 𝑗𝑛for some integers 𝑘and 𝑗. Consider",
    "𝑎−𝑐.",
    "We have:\n𝑎−𝑐= 𝑏+ 𝑘𝑛−(𝑑+ 𝑗𝑛)",
    "= 𝑏−𝑑+ (𝑘−𝑗)𝑛.\nIn other words, 𝑎−𝑐is 𝑏−𝑑more than some multiple of 𝑛, so 𝑎−𝑐≡𝑏−𝑑\n(mod 𝑛).\n",
    "■\n6.2.6.6.\n(a) 3456 ≡1456 = 1 (mod 2).\n",
    "(b) 3456",
    "= 9228 ≡(−1)228 = 1 (mod 5).\n\n",
    "516\nB. Selected Solutions\n(c) 3456 = 9228 ≡2228 = 876 ≡176 = 1 (mod 7).\n",
    "(d) 3456",
    "= 9228 ≡0228 = 0",
    "(mod 9).\n",
    "6.2.6.8.",
    "For all of these, just plug in all integers between 0 and the modulus to see\nwhich, if any, work.\n",
    "(a) No solutions.\n",
    "(b) 𝑥= 2, 𝑥= 5, 𝑥= 8.\n",
    "(c) No solutions.\n",
    "6.2.6.10. 𝑥= 5 + 22𝑘for 𝑘∈ℤ.\n6.2.6.12.",
    "𝑥= 6",
    "+ 15𝑘for 𝑘∈ℤ.\n6.2.6.14.",
    "We must solve 7𝑥+ 5 ≡2 (mod 11).",
    "This gives 𝑥≡9 (mod 11).",
    "In general,\n𝑥= 9 + 11𝑘, but when you divide any such 𝑥by 11, the remainder will be 9.\n6.2.6.15.",
    "Divide through by 2: 3𝑥+ 5𝑦= 16.",
    "Convert to a congruence, modulo 3:\n5𝑦≡16 (mod 3), which reduces to 2𝑦≡1 (mod 3).",
    "So 𝑦≡2 (mod 3) or 𝑦= 2",
    "+",
    "3𝑘.\nPlug this back into 3𝑥+ 5𝑦= 16, and solve for 𝑥, to get 𝑥= 2 −5𝑘. So the general\nsolution is 𝑥= 2 −5𝑘and 𝑦=",
    "2 +",
    "3𝑘for 𝑘∈ℤ.\n\nAppendix C\nList of Symbols\nSymbol\nDescription\nPage\n∴\n“therefore”\n15\n𝑃, 𝑄, 𝑅, 𝑆, . .",
    ".\n",
    "propositional (sentential) variables\n19\n∧\nlogical “and” (conjunction)\n19\n∨\nlogical “or” (disjunction)\n19\n¬\nlogical negation\n19\n𝐾𝑛\nthe complete graph on 𝑛vertices\n108\n𝐾𝑚,𝑛\nthe complete bipartite graph of 𝑚and 𝑛vertices\n109\n𝐶𝑛\nthe cycle on 𝑛vertices\n109\n𝑃𝑛\nthe path on 𝑛+ 1 vertices\n109\n𝜒(𝐺)\nthe chromatic number of 𝐺\n151\nΔ(𝐺)\nthe maximum degree in 𝐺\n156\n𝜒′(𝐺)\nthe chromatic index of 𝐺\n157\n𝑁(𝑆)\nthe set of neighbors of 𝑆\n182\nB𝑛\n𝑘\nthe set of length 𝑛bit strings with weight 𝑘.\n198\n(𝑎𝑛)𝑛∈ℕ\nthe sequence 𝑎0, 𝑎1, 𝑎2, . .",
    ".\n",
    "313\n𝑇𝑛\nthe 𝑛th triangular number\n318\n𝐹𝑛\nthe 𝑛th Fibonacci number\n324\nΔ𝑘\nthe 𝑘th differences of a sequence\n343\n∅\nthe empty set\n392\n𝒰\nuniverse set (domain of discourse)\n392\nℕ\nthe set of natural numbers\n392\nℤ\nthe set of integers\n392\nℚ\nthe set of rational numbers\n392\nℝ\nthe set of real numbers\n392\n𝒫(𝐴)\n",
    "the power set of 𝐴\n392\n{, }\nbraces, to contain set elements.\n",
    "392\n:\n“such that”\n392\n∈\n“is an element of”\n392\n⊆\n“is a subset of”\n392\n⊂\n“is a proper subset of”\n392\n∩\nset intersection\n392\n∪\nset union\n392\n×\nCartesian product\n392\n\\\nset difference\n392\n(Continued on next page)\n517\n\n518\nC. List of Symbols\nSymbol\nDescription\nPage\n𝐴\nthe complement of 𝐴\n392\n|𝐴|\ncardinality (size) of 𝐴\n392\n𝐴× 𝐵\nthe Cartesian product of 𝐴and 𝐵\n397\n𝑓(𝐴)\nthe image of 𝐴under 𝑓\n411\n𝑓−1(𝐵)\nthe inverse image of 𝐵under 𝑓\n411\n\nIndex\nadditive principle, See sum principle\nadjacent\nedges, 110\nvertices, 100, 110\nalternating path, 184\nancestor (in a rooted tree), 123\nand (logical connective), 19\ntruth condition for, 19\nantecedent, See hypothesis\nantisymmetric, 9\narbitrary, 66\nargument, 14\narithmetic sequence\nsumming, 340\natomic statement, 17\naugmenting path, 184\nballs and bins, See sticks and stones\nbase case, 365, 379\nbiconditional, 19\nbĳection, 409, 411, 413\nbinary connective, 18\nbinary digit, See bit\nbinary predicate, 28\nbinary relation, 9\nbinary representation, 383\nbinomial coefficient, 201, 202, 302\nclosed formula for, 236\nbinomial identity, 259\nexamples of, 258\nbinomial theorem, 202\nbipartite graph, 109, 110\nbirthday paradox, 274\nbit, 197\nbit string, 197, 198, 326\ncombinatorial proof involving,\n270\nlength, 197, 198\nweight, 197, 198\nBoolean variable, See propositional\nvariable\nbow ties, 268, 306, 494\nbreadth-first search, 125\nBrooks’ theorem, 156\nCanadians, set of, 369\ncannonball stacking, 352\ncardinality, 219, 395\nof a set, 392\nof a union, 219, 223\nof power set, 388\ncards, 205\nCartesian product, 392, 397\ncharacteristic equation, 357\ncharacteristic polynomial, 357\ncharacteristic roots, 356, 357, 359\nchessboard\ncounting squares on, 342\nmissing squares, 82\nrook paths, 192\ntiling, 326\nchild (in a rooted tree), 123\nchordal graph, 156\nChristmas, 387\nchromatic index, 157\nchromatic number, 110, 151\ncircuit, 141\nEuler, 141\nclique, 156\nclosed formula, 314\nfor a function, 7, 407\nfor a sequence, 8, 344\ncodomain, 6, 403, 413\ncoloring\nedges, 157\nvertices, 151\nvertices vs. edges, 161\ncombination, 230\nclosed formula for, 236\nvs. permutation, 236, 302, 306\ncombinatorial proof, 256, 262\n519\n\n520\nIndex\ncomplement (of an event), 278\ncomplement of a set, 392, 396\ncomplement, probability of, 278\ncomplete bipartite graph, 109, 110\ncomplete graph, 107, 109, 110\ncomplete inverse image, 411, 414\ncomplex numbers (as characteristic\nroots), 359\ncomposition of functions, 418\nconclusion, 14, 31\nconditional, 19, 31\nconditional probability, 283\ncongruence\nsolving, 441\nconjunction, 19\nconnected graph, 107, 110\nconnectives, 18, 19\nconsequent, See conclusion\ncontradiction, 71\ncontrapositive, 35\nproof by, 69\nconverse, 35\nconvex polyhedron, 134\ncorollary, 88\ncounting, 191\ndivisors, 217\nedges in a graph, 108\ncover (vertex), 185\ncube, 134\ncycle, 110\nHamilton, 141, 144\ntype of graph, 109\nDe Morgan’s laws, 49\ndeduction rule, 55\ndegree, 108, 110\ndegree sequence, 108\nmaximum, 156\nsum formula, 108\nΔ𝑘-constant, 343, 344\ndepth-first search, 125\nderangement, 295\nfraction of all permutations that\nare, 304\ndescendant (in a rooted tree), 123\ndesign, 10\ndifference of sets, 392, 396\ndifferences of a sequence, 342\ndifferentiable functions\ngeneralized product rule, 375\ngeneralized sum rule, 375\nDiophantine equation, 443\nsolution, 443\ndirect proof, 64\ndiscrete structures, See structures\ndisjoint, 219\ndisjoint events, 207\ndisjunction, 19\ndistribution (counting), 244\nwith upper bound restriction, 290\ndivides, 433\ndivisibility relation, 432, 433\ndivision algorithm, 434, 435\ndivision with remainder, See division\n",
    "algorithm\nDoctor Who, 82, 389\ndodecahedron, 137\ndomain, 6, 403, 413\ndomain of discourse, 23, See universe\nset\ndomino, 148, 326, 353\ndouble induction, See induction,\ndouble\ndouble negation, 50\nedge, 10, 100, 102, 110\nelement chasing, 86\nelement of a set, 389\nempty set, 219, 392\nenumeration, See counting\nequivalence relation, 9, 436\nEuclidean algorithm, 444\nEuler circuit, 110, 141\nEuler trail, 110, 141\nevent (counting), 206\nevent (probability), 276\nexclusive or, 20\nexistential quantifier, 23\nexists, 23\nface (planar graph), 129, 130\n\nIndex\n521\nfactorial, 232\nFibonacci sequence, 8, 315, 383\ndifferences, 346\nidentity, 383\npartial sums, 324, 373, 388\nrecurrence relation, 358\nfinite differences, 344\nfinite geometry, 10\nfinite sequence, 8\nfootball (American), 373, 382\nfor all, 23\nforest, 111, 117\nfour color theorem, 154\nfree variable, 22\nfunction, 6, 403, 413\ncounting, 252, 296, 301, 302\nhow to describe, 404\nincreasing\ncounting, 254\nnon-decreasing\ncounting, 254\nnotation, 413\ntwo-line notation, 405, 413\ngcd, See greatest common divisor\ngenerating function, 421\ndifferencing, 424\nmultiplication and partial sums,\n427\nrecurrence relation, 428\ngeometric sequence\nsumming, 354\ngirth, 134\nGoldbach, 63\nGoldbach conjecture, 96\ngolden ratio, 358\ngraph, 10, 100, 102, 110\nadjacent, 100, 110\nbipartite, 109, 110\nchordal, 156\nchromatic index, 157\nchromatic number, 110, 151, 154\nclique, 156\ncoloring vertices vs. edges, 161\ncomplete, 107, 109, 110\ncomplete bipartite, 109, 110\nconnected, 107, 110\ncycle, 109, 110\ndegree, 108, 110\ndegree sequence, 108\ndrawing, 103\nedge, 100, 102\nEuler circuit, 110\nEuler trail, 110\nforest, 111\ngirth, 134\ninduced subgraph, 111\nisomorphic (intuitive definition),\n104\nisomorphic (precise definition),\n104\nisomorphism class, 106\nleaf, 111\nmatching, 181, 182\nmaximum degree, 156\nmultigraph, 107, 110\nneighbors, 114, 182\npath, 109–111\nperfect, 156, 161\nPetersen, 139\nplanar, 111\nsimple, 107\nsubgraph, 106, 111\ntrail, 111\ntree, 111\nvertex, 100, 102\nvertex coloring, 111, 151\nwalk, 111\ngraph (of a function), 404\ngreatest common divisor, 440\nHall’s marriage theorem, 182\nHamilton cycle, 141, 144\nin bipartite graph, 149\nHamilton path, 141, 144\nin bipartite graph, 149\nhandshake lemma, 108\nhandshakes, 375\nconnection to graphs, 113\nHanoi, 311\n\n522\nIndex\nhockey stick theorem, 375\nhomogeneous\nrecurrence relation, 359\nhypothesis, 31\nicosahedron, 136\nif and only if (logical connective), 19\ntruth condition for, 19\nif. .",
    ".",
    ", then. . .",
    "(logical connective), 19\ntruth condition for, 19\niff, See if and only if\nimage, 411\nof a set, 411\nof a subset, 414\nof an element, 6, 403, 413\nimplication, 19, 31\nimplicit quantifier, 25\nimplies (logical connective), 19\ntruth condition for, 19\ninclusion/exclusion, See principle of\ninclusion/exclusion\ninclusive or, 20\nindependence, 281\ninduced subgraph, 106, 111\ninduction, 363, 365\nbase case, 365\nfor strong induction, 379\ncontrasting regular and strong,\n381\ndouble, 383\nincorrect use of, 369\ninductive case, 365\nfor strong induction, 379\ninductive case, 365, 379\ninductive hypothesis, 366, 367\ninitial condition, 314\nfor a function, 408\ninjection, 296, 409, 410, 413\ncounting, 302\ninteger lattice, 195\nintegers, set of, 391, 392\ninterior angles, 374, 382\nintersection, 219\nintersection of sets, 392, 395\ninverse, 35\ninverse image, 411, 414\ncomparison to inverse function,\n412\nof a subset, 414\nirreflexive, 9\nisomorphic\nintuitive definition, 104\nprecise definition, 104\nisomorphism class, 106\nisomorphism of graphs, 104\n𝑘-permutation of 𝑛elements, 233, 234\n𝐾𝑛, 107\nknights and knaves, 14, 58, 98\nKruskal’s algorithm, 123\nKönigsberg, Seven Bridges of, 100, 141\nlattice path, 195\nlength of, 196\nlattice, integer, See integer lattice\nlaw of logic, 54\nleaf, 111, 120\nlength of a bit string, 197, 198\nlogical connectives, 18, 19\nlogical equivalence, 48\nlogically valid, See law of logic\nmagic chocolate bunnies, 388\nmain connective, 46\nmarriage problem, See matching\nmatching, 181\npartial, 183\nmatching condition, 182\nmathematical induction, See induction\nmaximum degree, 156\nminimal criminal, 121\nminimum spanning tree, 123\nmod, 436\nmodular arithmetic, 438\nmodus ponens, 55\nmolecular statement, 17\nmonochromatic, 158\nMonty Hall problem, 283\nmultigraph, 107, 110\nmultiplicative principle, See product\nprinciple\n\nIndex\n523\nmultiset, 10\ncounting, 253\nrelation to multigraph, 107\nmultisets (counting), 244\nnatural numbers, set of, 392\nnecessary condition, 39\nnegation, 19\nneighbors of vertices, 114, 182\nnon-planar graph, 132\n𝐾3,3, 133\n𝐾5, 133\nPetersen graph, 139\nnot (logical connective), 19\ntruth condition for, 19\nNP-complete, 145\nnumber theory, 432\noctahedron, 136\none-to-one function, See injection\nonto function, See surjection\noperations on sets, 395\nor (logical connective), 19\ninclusive vs. exclusive, 20\ntruth condition for, 19\noutcome (counting), 206\noutcome (probability), 275\nparent (in a rooted tree), 123\npartial matching, 183\npartial sums, See sequence of partial\nsums\npartition, 436\nPascal’s triangle, 194, 326, 352\npatterns in, 258\nsum of row in, 375\npath, 110, 111\nalternating, 184\naugmenting, 184\nEuler, See Euler trail\nHamilton, 141, 144\ntype of graph, 109\nperfect graph, 156, 161\nperfect matching, See matching\npermutation, 230, 232, 234\nof 𝑘elements chosen from 𝑛, See\n𝑘-permutation of 𝑛elements\nof 𝑛elements, 232\nvs. combination, 236, 302, 306\nPetersen graph, 139\nPIE, See principle of\ninclusion/exclusion\npigeonhole principle, 74\nplanar graph, 111, 129\nchromatic number of, 154\nnon-planar graph, 132\n𝐾3,3, 133\n𝐾5, 133\nPetersen graph, 139\nplanar region, See face (planar graph)\nplanar representation, 130\nPlatonic solid, See regular polyhedron\nplaying cards, 81, 205\npolyhedron, 134\nregular, 134\npolynomial fitting, 338, 344\npower set, 392, 394\ncardinality of, 388\npowers of 2, 318\npredicate, 22\nbinary, 28\npremise, 14\npremises, 14\nPrim’s algorithm, 123\nprime numbers, 80, 81, 380\nprinciple of inclusion/exclusion, 219,\n290\nfor 2 sets, 223\nfor 3 sets, 223\nfor 4 or more sets, 293\nprobability, 276\nproduct notation, 325\nproduct principle, 205, 209\nproof, 14\nby contradiction, 71\nby contrapositive, 69\nby induction, 363\nby strong indcution, 377\ncombinatorial, 256, 262\nproper vertex coloring, 111\n\n524\nIndex\npropositional variable, 18, 19\npuzzle, 98\nbirthday, 274\ncardinality, 402\nchocolate bar, 378\ndomino trail, 148\nknights and knaves, 14, 58\nseven bridges, 100\nsquare division, 383\nTower of Hanoi, 311\nPythagorean theorem, 30\nPythagorean triple, 9, 443\nquantifier, 23\nimplicit, 25\nracetrack principle, 369\nRamsey theory, 158\nrandom experiment, 275\nrange of a function, 403, 413\nrational numbers, set of, 392\nreal numbers, set of, 392\nrecurrence relation, 314\nfor a function, 408\nfor number of bit strings, 198\ngenerating function, 428\nsolving, 353, 357, 359\nrecursive definition, 314\nfor a function, 7\nfor a sequence, 9\nreference, self, See self reference\nreflexive, 9\nregion (graph), See face (planar graph)\nregular polyhedron, 134\nrelation, 9\nremainder class, 435\nresidue class, See remainder class\nrook paths, 192\nroot (in a tree), 123\nrooted tree, 118, 123\nrule of four, 404\nsample space, 275\nscope (of quantifier), 23\nsearch\nbreadth-first, 125\ndepth-first, 125\nself reference, See reference, self\nsentence (compared to statement), 18\nsentential variable, See propositional\nvariable\nsequence, 8, 313\nas function, 313\nclosed formula for, 314, 315\ninductive definition for, 314\nnotation for, 313\nrecursive definition for, 314, 315\nsequence of partial sums, 320, 375, 388\nfor Fibonacci sequence, 324\nfor triangular numbers, 333\nsequence, finite, 8\nset, 5, 389\ncardinality, 392\ncomplement, 392\ndifference, 392, 396\nintersection, 392\nnotation for, 389\nof all subsets, See power set\nof integers, 391, 392\nof natural numbers, 392\nof rational numbers, 392\nof real numbers, 392\noperations, 395\nproduct, See Cartesian product\nrelationships between, 393\nunion, 392\nVenn diagram, 398\nset builder notation, 390\nSeven Bridges of Königsberg, 100, 141\nsibling (in a rooted tree), 124\nSigma notation, 320, 321\nsimple graph, 107\nsix color theorem, 161\nsize of a set\nsee cardinality, 392\nsolitary number, 43\nsound, 14\nspanning tree, 122\nminimum, 123\nstars and bars, See sticks and stones\nstatement, 16, 17\n\nIndex\n525\nsticks and stones, 244\nvs. combination, 306\nstring\nbinary, See bit string\nternary, 270, 326\nstrong induction, 377\nstructures, 5\nsubgraph, 106, 111\nsubset, 199, 393\ncounting, 199\nsudoku, 62, 65\nsufficient condition, 39\nsum principle, 205, 207\nusing sets, 219\nsum principle (probability), 280\nsummation notation, 320, 321, 325\nsurjection, 297, 409, 413\nsymmetric, 9\ntautology, 48, 63\nterm (of a sequence), 8\nternary string, 270, 326\ntetrahedron, 136\ntour, Euler, See Euler circuit\nTower of Hanoi, 311\ntrail, 111\nEuler, 141\ntransitive, 9\ntransitive sets, 402\ntree, 111, 117\nnumber of edges and vertices, 121\nrooted, 118, 123\nspanning, 122\ntriangular numbers, 8, 318, 332\ntruth condition, 19\nfor and, 19\nfor if and only if, 19\nfor if. .",
    ".",
    ", then. . .",
    ", 19\nfor not, 19\nfor or, 19\ntruth table, 19, 46\ntruth value, 18, 19\ntuple, See sequence, finite\nThe Twelve Days of Christmas, 387\ntwo-line notation, 405, 413\nunary connective, 18\nuniform probability distribution, 275\nunion, 219\nunion of sets, 392, 395\ncardinality of, 219\nuniversal generalization, 25\nuniversal quantifier, 23\nuniverse set, 392, 396\nvalid, 14\nvariable, propositional, 18\nVenn diagram, 398\nfor counting, 219\nintersection, 398\nset difference, 398\nvertex, 10, 100, 102, 110\nvertex coloring, 111, 151\nvertex cover, 185\nvertex degree, 108, 110\ndegree sequence, 108\nVizing’s theorem, 157\nwalk, 111, 141\nEuler, See Euler trail\nweight (bit string), 198\nweight of a bit string, 197, 198\nword (counting), 208\nzombies, 373\n\n\nColophon\n",
    "This book was authored in PreTeXt.\n\n",
    "LINEAR ALGEBRA\nJim Hefferon\nFourth edition\nhttp://joshua.smcvt.edu/linearalgebra\n\nNotation\nR, R+, Rn\nreal numbers, positive reals, n-tuples of reals\nN, C\nnatural numbers {0, 1, 2, . . .",
    "}, complex numbers\n(a .. b), [a .. b]\nopen interval, closed interval\n⟨. .",
    ".⟩\nsequence (a list in which order matters)\nhi,j\nrow i and column j entry of matrix H\nV, W, U\nvector spaces\n⃗v, ⃗0, ⃗0V\nvector, zero vector, zero vector of a space V\nPn, Mn×m\nspace of degree n polynomials, n×m matrices\n[S]\nspan of a set\n⟨B, D⟩, ⃗β,⃗δ\nbasis, basis vectors\nEn = ⟨⃗e1, . .",
    ".",
    ", ⃗en⟩\nstandard basis for Rn\nV ∼= W\nisomorphic spaces\nM ⊕N\ndirect sum of subspaces\nh, g\nhomomorphisms (linear maps)\nt, s\ntransformations (linear maps from a space to itself)\nRepB(⃗v), RepB,D(h)\nrepresentation of a vector, a map\nZn×m or Z, In×n or I\nzero matrix, identity matrix\n|T|\ndeterminant of the matrix\nR(h), N (h)\nrange space, null space of the map\nR∞(h), N∞(h)\ngeneralized range space and null space\nGreek letters with pronounciation\ncharacter\nname\ncharacter\nname\nα\nalpha AL-fuh\nν\nnu NEW\nβ\nbeta BAY-tuh\nξ, Ξ\nxi KSIGH\nγ, Γ\ngamma GAM-muh\no\nomicron OM-uh-CRON\nδ, ∆\ndelta DEL-tuh\nπ, Π\npi PIE\nϵ\nepsilon EP-suh-lon\nρ\nrho ROW\nζ\nzeta ZAY-tuh\nσ, Σ\nsigma SIG-muh\nη\neta AY-tuh\nτ\ntau TOW (as in cow)\nθ, Θ\ntheta THAY-tuh\nυ, Υ\nupsilon OOP-suh-LON\nι\niota eye-OH-tuh\nφ, Φ\nphi FEE, or FI (as in hi)\nκ\nkappa KAP-uh\nχ\nchi KI (as in hi)\nλ, Λ\nlambda LAM-duh\nψ, Ψ\npsi SIGH, or PSIGH\nµ\nmu MEW\nω, Ω\nomega oh-MAY-guh\nCapitals shown are the ones that diﬀer from Roman capitals.\n\n",
    "Preface\nThis book helps students to master the material of a standard US undergraduate\nﬁrst course in Linear Algebra.\n",
    "The material is standard in that the subjects covered are Gaussian reduction,\nvector spaces, linear maps, determinants, and eigenvalues and eigenvectors.\n",
    "Another standard is the book’s audience: sophomores or juniors, usually with\na background of at least one semester of calculus.",
    "The help that it gives to\nstudents comes from taking a developmental approach — this book’s presentation\nemphasizes motivation and naturalness, using many examples.\n",
    "The developmental approach is what most recommends this book so I will\nelaborate.",
    "Courses at the beginning of a mathematics program focus less on\ntheory and more on calculating.",
    "Later courses ask for mathematical maturity: the\nability to follow diﬀerent types of arguments, a familiarity with the themes that\nunderlie many mathematical investigations such as elementary set and function\nfacts, and a capacity for some independent reading and thinking.",
    "Some programs\nhave a separate course devoted to developing maturity but in any case a Linear\nAlgebra course is an ideal spot to work on this transition.",
    "It comes early in a\nprogram so that progress made here pays oﬀlater but it also comes late enough\nso that the classroom contains only students who are serious about mathematics.\n",
    "The material is accessible, coherent, and elegant.",
    "And, examples are plentiful.\n",
    "Helping readers with their transition requires taking the mathematics seri-\nously.",
    "All of the results here are proved.",
    "On the other hand, we cannot assume\nthat students have already arrived and so in contrast with more advanced\ntexts this book is ﬁlled with illustrations of the theory, often quite detailed\nillustrations.\n",
    "Some texts that assume a not-yet sophisticated reader begin with matrix\nmultiplication and determinants.",
    "Then, when vector spaces and linear maps\nﬁnally appear and deﬁnitions and proofs start, the abrupt change brings the\n\nstudents to an abrupt stop.",
    "While this book begins with linear reduction, from\nthe start we do more than compute.",
    "The ﬁrst chapter includes proofs, such as\nthe proof that linear reduction gives a correct and complete solution set.",
    "With\nthat as motivation the second chapter does vector spaces over the reals.",
    "In the\nschedule below this happens at the start of the third week.\n",
    "A student progresses most in mathematics by doing exercises.",
    "The problem\nsets start with routine checks and range up to reasonably involved proofs.",
    "I\nhave aimed to typically put two dozen in each set, thereby giving a selection.",
    "In\nparticular there is a good number of the medium-diﬃcult problems that stretch\na learner, but not too far.",
    "At the high end, there are a few that are puzzles taken\nfrom various journals, competitions, or problems collections, which are marked\nwith a ‘?’",
    "(as part of the fun I have worked to keep the original wording).\n",
    "That is, as with the rest of the book, the exercises are aimed to both build\nan ability at, and help students experience the pleasure of, doing mathematics.\n",
    "Students should see how the ideas arise and should be able to picture themselves\ndoing the same type of work.\n",
    "Applications.",
    "Applications and computing are interesting and vital aspects of the\nsubject.",
    "Consequently, each chapter closes with a selection of topics in those\nareas.",
    "These give a reader a taste of the subject, discuss how Linear Algebra\ncomes in, point to some further reading, and give a few exercises.",
    "They are\nbrief enough that an instructor can do one in a day’s class or can assign them\nas projects for individuals or small groups.",
    "Whether they ﬁgure formally in a\ncourse or not, they help readers see for themselves that Linear Algebra is a tool\nthat a professional must have.\nAvailability.",
    "This book is Free.",
    "See http://joshua.smcvt.edu/linearalgebra\nfor the license details.",
    "That page also has the latest version, exercise answers,\nbeamer slides, lab manual, additional material, and LATEX source.",
    "This book is\nalso available in hard copy from standard publishing sources, for very little cost.\n",
    "See the web page.\n",
    "Acknowledgments.",
    "A lesson of software development is that complex projects\nhave bugs and need a process to ﬁx them.",
    "I am grateful for reports from both\ninstructors and students.",
    "I periodically issue revisions and acknowledge in the\nbook’s repository all of the reports that I use.",
    "My current contact information\nis on the web page.\n",
    "I am grateful to Saint Michael’s College for supporting this project over many\nyears, even before the idea of open educational resources became familiar.\n",
    "And, I cannot thank my wife Lynne enough for her unﬂagging encouragement.\n\nAdvice.",
    "This book’s emphasis on motivation and development, and its availability,\nmake it widely used for self-study.",
    "If you are an independent student then good\nfor you, I admire your industry.",
    "However, you may ﬁnd some advice useful.\n",
    "While an experienced instructor knows what subjects and pace suit their\nclass, this semester’s timetable (graciously shared by G Ashline) may help you\nplan a sensible rate.",
    "It presumes that you have already studied the material of\nSection One.II, the elements of vectors.\n",
    "week\nMonday\nWednesday\nFriday\n1\nOne.",
    "I.1\nOne.",
    "I.1, 2\nOne.I.2, 3\n2\nOne.",
    "I.3\nOne.",
    "III.1\nOne.",
    "III.2\n3\nTwo.",
    "I.1\nTwo.",
    "I.1, 2\nTwo.",
    "I.2\n4\nTwo.II.1\nTwo.",
    "III.1\nTwo.",
    "III.2\n5\nTwo.III.2\n",
    "Two.III.2, 3\nTwo.III.3\n6\nexam\nThree.",
    "I.1\nThree.",
    "I.1\n7\nThree.",
    "I.2\nThree.",
    "I.2\nThree.II.1\n8\nThree.II.1\n",
    "Three.II.2\nThree.II.2\n9\nThree.",
    "III.1\nThree.III.2\nThree.IV.1, 2\n10\nThree.IV.2, 3\nThree.",
    "IV.4\nThree.V.1\n11\nThree.V.1\nThree.V.2\nFour.",
    "I.1\n12\nexam\nFour.",
    "I.2\nFour.",
    "III.1\n13\nFive.II.1\n–Thanksgiving break–\n14\nFive.II.1, 2\nFive.II.2\nFive.II.3\n",
    "As enrichment, you could pick one or two extra things that appeal to you, from\nthe lab manual or from the Topics from the end of each chapter.",
    "I like the Topics\non Voting Paradoxes, Geometry of Linear Maps, and Coupled Oscillators.",
    "You’ll\nget more from these if you have access to software for calculations such as Sage,\nfreely available from http://sagemath.org.\n",
    "In the table of contents I have marked a few subsections as optional if some\ninstructors will pass over them in favor of spending more time elsewhere.\n",
    "Note that in addition to the in-class exams, students in the above course do\ntake-home problem sets that include proofs, such as a veriﬁcation that a set is a\nvector space.",
    "Computations are important but so are the arguments.\n",
    "My main advice is: do many exercises.",
    "I have marked a good sample with\n✓’s in the margin.",
    "Do not simply read the answers — you must try the problems\nand possibly struggle with them.",
    "For all of the exercises, you must justify your\nanswer either with a computation or with a proof.",
    "Be aware that few people\ncan write correct proofs without training; try to ﬁnd a knowledgeable person to\nwork with you.\n\n",
    "Finally, a caution for all students, independent or not: I cannot overemphasize\nthat the statement, “I understand the material but it is only that I have trouble\nwith the problems” shows a misconception.",
    "Being able to do things with the\nideas is their entire point.",
    "The quotes below express this sentiment admirably (I\nhave taken the liberty of formatting them as poetry).",
    "They capture the essence\nof both the beauty and the power of mathematics and science in general, and of\nLinear Algebra in particular.\n",
    "I know of no better tactic\nthan the illustration of exciting principles\nby well-chosen particulars.\n",
    "–Stephen Jay Gould\nIf you really wish to learn\nyou must mount a machine\nand become acquainted with its tricks\nby actual trial.\n–Wilbur Wright\nIn the particular\nis contained the universal.\n",
    "–James Joyce\nJim Hefferon\nMathematics and Statistics, Saint Michael’s College\nColchester, Vermont USA 05439\nhttp://joshua.smcvt.edu/linearalgebra\n2020-Apr-26\nAuthor’s Note.",
    "Inventing a good exercise, one that enlightens as well as tests,\nis a creative act, and hard work.",
    "The inventor deserves recognition.",
    "But texts\nhave traditionally not given attributions for questions.",
    "I have changed that here\nwhere I was sure of the source.",
    "I would be glad to hear from anyone who can\nhelp me to correctly attribute others of the questions.\n\n",
    "Contents\nChapter One:\nLinear Systems\nI\nSolving Linear Systems . . . . . . . . . . . . . . . . . . . . . . .",
    ".\n",
    "1\nI.1\nGauss’s Method\n. . . . . . . . . . . . . . . . . . . . . . . . .\n",
    "2\nI.2\nDescribing the Solution Set . . . . . . . . . . . . . . . . . .",
    ".\n",
    "13\nI.3\nGeneral = Particular + Homogeneous . . . . . . . . . . . . .",
    ".\n23\nII\nLinear Geometry\n. . . . . . . . . . . . . . . . . . . . . . . . . .",
    ".\n",
    "35\nII.1\nVectors in Space*\n. . . . . . . . . . . . . . . . . . . . . . . .\n",
    "35\nII.2\nLength and Angle Measures* . . . . . . . . . . . . . . . . .",
    ".\n",
    "42\nIII Reduced Echelon Form . . . . . . . . . . . . . . . . . . . . . . . .\n",
    "50\nIII.1 Gauss-Jordan Reduction . . . . . . . . . . . . . . . . . . . . .\n",
    "50\nIII.2 The Linear Combination Lemma . . . . . . . . . . . . . . . .\n",
    "56\nTopic: Computer Algebra Systems\n. . . . . . . . . . . . . . . . . . .\n",
    "65\nTopic: Input-Output Analysis . . . . . . . . . . . . . . . . . . . . . .\n",
    "67\nTopic: Accuracy of Computations . . . . . . . . . . . . . . . . . . . .\n",
    "72\nTopic: Analyzing Networks . . . . . . . . . . . . . . . . . . . . . . . .\n",
    "76\nChapter Two:\nVector Spaces\nI\nDeﬁnition of Vector Space . . . . . . . . . . . . . . . . . . . . .",
    ".\n",
    "84\nI.1\nDeﬁnition and Examples\n. . . . . . . . . . . . . . . . . . .",
    ".\n",
    "84\nI.2\nSubspaces and Spanning Sets . . . . . . . . . . . . . . . . .",
    ".\n",
    "96\nII\nLinear Independence . . . . . . . . . . . . . . . . . . . . . . . . .",
    "108\nII.1\nDeﬁnition and Examples\n. . . . . . . . . . . . . . . . . . . .",
    "108\nIII Basis and Dimension . . . . . . . . . . . . . . . . . . . . . . . .",
    ".",
    "121\nIII.1 Basis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "121\nIII.2 Dimension\n. . . . . . . . . . . . . . . . . . . . . . . . . . .",
    ".",
    "129\nIII.3 Vector Spaces and Linear Systems . . . . . . . . . . . . . .",
    ".",
    "136\nIII.4 Combining Subspaces* . . . . . . . . . . . . . . . . . . . . . .",
    "144\n\nTopic: Fields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "153\nTopic: Crystals\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "155\nTopic: Voting Paradoxes . . . . . . . . . . . . . . . . . . . . . . . . .",
    "159\nTopic: Dimensional Analysis . . . . . . . . . . . . . . . . . . . . . . .",
    "165\nChapter Three:\nMaps Between Spaces\nI\nIsomorphisms . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "173\nI.1\nDefinition and Examples\n. . . . . . . . . . . . . . . . . . .",
    ".",
    "173\nI.2\nDimension Characterizes Isomorphism . . . . . . . . . . . .",
    ".",
    "183\nII\nHomomorphisms\n. . . . . . . . . . . . . . . . . . . . . . . . . .",
    ".",
    "191\nII.1\nDeﬁnition . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "191\nII.2\nRange Space and Null Space\n. . . . . . . . . . . . . . . . . .",
    "199\nIII Computing Linear Maps . . . . . . . . . . . . . . . . . . . . . . .",
    "212\nIII.1 Representing Linear Maps with Matrices\n. . . . . . . . . . .",
    "212\nIII.2 Any Matrix Represents a Linear Map\n. . . . . . . . . . . . .",
    "223\nIV Matrix Operations\n. . . . . . . . . . . . . . . . . . . . . . . . . .",
    "232\nIV.1 Sums and Scalar Products . . . . . . . . . . . . . . . . . . .",
    ".",
    "232\nIV.2",
    "Matrix Multiplication . . . . . . . . . . . . . . . . . . . . .",
    ".",
    "236\nIV.3 Mechanics of Matrix Multiplication\n. . . . . . . . . . . . .",
    ".",
    "244\nIV.4 Inverses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "254\nV\nChange of Basis . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "262\nV.1\nChanging Representations of Vectors . . . . . . . . . . . . .",
    ".",
    "262\nV.2\nChanging Map Representations . . . . . . . . . . . . . . . . .",
    "267\nVI Projection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "275\nVI.1",
    "Orthogonal Projection Into a Line*\n. . . . . . . . . . . . .",
    ".",
    "275\nVI.2 Gram-Schmidt Orthogonalization* . . . . . . . . . . . . . . .",
    "280\nVI.3 Projection Into a Subspace* . . . . . . . . . . . . . . . . . . .",
    "285\nTopic: Line of Best Fit . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "295\nTopic: Geometry of Linear Maps\n. . . . . . . . . . . . . . . . . . . .",
    "301\nTopic: Magic Squares . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "308\nTopic: Markov Chains\n. . . . . . . . . . . . . . . . . . . . . . . . . .",
    "313\nTopic: Orthonormal Matrices\n. . . . . . . . . . . . . . . . . . . . . .",
    "319\nChapter Four:\nDeterminants\nI\nDefinition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "326\nI.1\nExploration* . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "326\nI.2\nProperties of Determinants . . . . . . . . . . . . . . . . . .",
    ".",
    "331\nI.3\nThe Permutation Expansion\n. . . . . . . . . . . . . . . . .",
    ".",
    "337\nI.4\nDeterminants Exist* . . . . . . . . . . . . . . . . . . . . . . .",
    "346\nII\nGeometry of Determinants . . . . . . . . . . . . . . . . . . . . . .",
    "355\nII.1\nDeterminants as Size Functions . . . . . . . . . . . . . . . . .",
    "355\n\nIII Laplace’s Formula . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "363\nIII.1 Laplace’s Expansion*\n. . . . . . . . . . . . . . . . . . . . . .",
    "363\nTopic: Cramer’s Rule . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "369\nTopic: Speed of Calculating Determinants . . . . . . . . . . . . . . .",
    "372\nTopic: Chiò’s Method . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "376\nTopic: Projective Geometry . . . . . . . . . . . . . . . . . . . . . . .",
    "380\nTopic: Computer Graphics . . . . . . . . . . . . . . . . . . . . . . . .",
    "392\nChapter Five:\nSimilarity\nI\nComplex Vector Spaces . . . . . . . . . . . . . . . . . . . . . . . .",
    "397\nI.1\nPolynomial Factoring and Complex Numbers*\n. . . . . . . .",
    "398\nI.2\nComplex Representations . . . . . . . . . . . . . . . . . . . .",
    "400\nII\nSimilarity\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    ".",
    "402\nII.1\nDeﬁnition and Examples\n. . . . . . . . . . . . . . . . . . . .",
    "402\nII.2\nDiagonalizability . . . . . . . . . . . . . . . . . . . . . . . . .",
    "407\nII.3\nEigenvalues and Eigenvectors . . . . . . . . . . . . . . . . .",
    ".",
    "412\nIII Nilpotence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "424\nIII.1 Self-Composition* . . . . . . . . . . . . . . . . . . . . . . . .",
    "424\nIII.2 Strings* . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "428\nIV Jordan Form . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "440\nIV.1 Polynomials of Maps and Matrices*\n. . . . . . . . . . . . . .",
    "440\nIV.2",
    "Jordan Canonical Form* . . . . . . . . . . . . . . . . . . . . .",
    "448\nTopic: Method of Powers . . . . . . . . . . . . . . . . . . . . . . . . .",
    "464\nTopic: Stable Populations\n. . . . . . . . . . . . . . . . . . . . . . . .",
    "468\nTopic: Page Ranking . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "470\nTopic: Linear Recurrences . . . . . . . . . . . . . . . . . . . . . . . .",
    "474\nTopic: Coupled Oscillators . . . . . . . . . . . . . . . . . . . . . . . .",
    "482\nAppendix\nStatements\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "A-1\nQuantiﬁers\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .",
    "A-2\n",
    "Techniques of Proof\n. . . . . . . . . . . . . . . . . . . . . . . . .",
    ".",
    "A-3\nSets, Functions, and Relations . . . . . . . . . . . . . . . . . . . .",
    ".",
    "A-5\n∗Starred subsections are optional.\n\n\n",
    "Chapter One\nLinear Systems\nI\nSolving Linear Systems\nSystems of linear equations are common in science and mathematics.",
    "These two\nexamples from high school science [Onan] give a sense of how they arise.\n",
    "The ﬁrst example is from Statics.",
    "Suppose that we have three objects, we\nknow that one has a mass of 2 kg, and we want to ﬁnd the two unknown masses.\n",
    "Experimentation with a meter stick produces these two balances.\n",
    "c\nh\n2\n15\n40\n50\nc\nh\n2\n25\n50\n25\nFor the masses to balance we must have that the sum of moments on the left\nequals the sum of moments on the right, where the moment of an object is its\nmass times its distance from the balance point.",
    "That gives a system of two\nlinear equations.\n",
    "40h + 15c = 100\n25c = 50 + 50h\nThe second example is from Chemistry.\n",
    "We can mix, under controlled\nconditions, toluene C7H8 and nitric acid HNO3 to produce trinitrotoluene\nC7H5O6N3 along with the byproduct water (conditions have to be very well\ncontrolled — trinitrotoluene is better known as TNT).",
    "In what proportion should\nwe mix them?",
    "The number of atoms of each element present before the reaction\nx C7H8 + y HNO3\n−→\nz C7H5O6N3 + w H2O\n\n2\nChapter One.",
    "Linear Systems\nmust equal the number present afterward.",
    "Applying that in turn to the elements\nC, H, N, and O gives this system.\n",
    "7x = 7z\n8x + 1y = 5z + 2w\n1y = 3z\n3y = 6z + 1w\nBoth examples come down to solving a system of equations.",
    "In each system,\nthe equations involve only the ﬁrst power of each variable.",
    "This chapter shows\nhow to solve any such system of equations.\n",
    "I.1\nGauss’s Method\n1.1 Deﬁnition A linear combination of x1, . .",
    ".",
    ", xn has the form\na1x1",
    "+ a2x2",
    "+ a3x3 + · · · + anxn\nwhere the numbers a1, . .",
    ".",
    ", an ∈R are the combination’s coeﬃcients.",
    "A linear\nequation in the variables x1, . . .",
    ", xn has the form a1x1",
    "+ a2x2",
    "+ a3x3 + · · · +\nanxn = d where d ∈R is the constant.\n",
    "An n-tuple (s1, s2, . .",
    ".",
    ", sn) ∈Rn is a solution of, or satisﬁes, that equation\nif substituting the numbers s1, . . .",
    ", sn for the variables gives a true statement:\na1s1",
    "+ a2s2 + · · · + ansn = d. A system of linear equations\na1,1x1 + a1,2x2 + · · ·",
    "+ a1,nxn =\nd1\na2,1x1 + a2,2x2 + · · · + a2,nxn =\nd2\n...\nam,1x1 + am,2x2 + · · · + am,nxn = dm\nhas the solution (s1, s2, . . .",
    ", sn) if that n-tuple is a solution of all of the equations.\n",
    "1.2 Example The combination 3x1 + 2x2 of x1 and x2 is linear.",
    "The combination\n3x2\n1 + 2x2 is not a linear function of x1 and x2, nor is 3x1 + 2 sin(x2).\n",
    "We usually take x1, . . .",
    ", xn to be unequal to each other because in a\nsum with repeats we can rearrange to make the elements unique, as with\n2x + 3y + 4x = 6x + 3y.",
    "We sometimes include terms with a zero coeﬃcient, as\nin x −2y + 0z, and at other times omit them, depending on what is convenient.\n\n",
    "Section I. Solving Linear Systems\n3\n1.3 Example The ordered pair (−1, 5) is a solution of this system.\n",
    "3x1 + 2x2 = 7\n−x1 +",
    "x2 = 6\nIn contrast, (5, −1) is not a solution.\n",
    "Finding the set of all solutions is solving the system.",
    "We don’t need guesswork\nor good luck; there is an algorithm that always works.",
    "This algorithm is Gauss’s\nMethod (or Gaussian elimination or linear elimination).\n",
    "1.4 Example To solve this system\n3x3 = 9\nx1 + 5x2 −2x3 = 2\n1\n3x1 + 2x2\n= 3\nwe transform it, step by step, until it is in a form that we can easily solve.\n",
    "The ﬁrst transformation rewrites the system by interchanging the ﬁrst and\nthird row.\n",
    "swap row 1 with row 3\n−→\n1\n3x1 + 2x2\n= 3\nx1 + 5x2 −2x3 = 2\n3x3 = 9\nThe second transformation rescales the ﬁrst row by a factor of 3.\n",
    "multiply row 1 by 3\n−→\nx1 + 6x2\n= 9\nx1 + 5x2 −2x3 = 2\n3x3 = 9\nThe third transformation is the only nontrivial one in this example.",
    "We mentally\nmultiply both sides of the ﬁrst row by −1, mentally add that to the second row,\nand write the result in as the new second row.\n",
    "add −1 times row 1 to row 2\n−→\nx1 + 6x2\n=\n9\n−x2 −2x3 = −7\n3x3 =\n9\nThese steps have brought the system to a form where we can easily ﬁnd the\nvalue of each variable.",
    "The bottom equation shows that x3 = 3.",
    "Substituting 3\nfor x3 in the middle equation shows that x2 = 1.",
    "Substituting those two into\nthe top equation gives that x1 = 3.",
    "Thus the system has a unique solution; the\nsolution set is {(3, 1, 3)}.\n",
    "We will use Gauss’s Method throughout the book.",
    "It is fast and easy.",
    "We\nwill now show that it is also safe: Gauss’s Method never loses solutions nor does\nit ever pick up extraneous solutions, so that a tuple is a solution to the system\nbefore we apply the method if and only if it is a solution after.\n\n",
    "4\nChapter One.",
    "Linear Systems\n1.5 Theorem (Gauss’s Method)",
    "If a linear system is changed to another by one of\nthese operations\n(1) an equation is swapped with another\n(2) an equation has both sides multiplied by a nonzero constant\n(3) an equation is replaced by the sum of itself and a multiple of another\nthen the two systems have the same set of solutions.\n",
    "Each of the three operations has a restriction.",
    "Multiplying a row by 0 is not\nallowed because obviously that can change the solution set.",
    "Similarly, adding a\nmultiple of a row to itself is not allowed because adding −1 times the row to\nitself has the eﬀect of multiplying the row by 0.",
    "And we disallow swapping a\nrow with itself, to make some results in the fourth chapter easier.",
    "Besides, it’s\npointless.\n",
    "Proof We will cover the equation swap operation here.",
    "The other two cases\nare similar and are Exercise 33.\n",
    "Consider a linear system.\n",
    "a1,1x1 + a1,2x2 + · · ·",
    "+ a1,nxn = d1\n...\nai,1x1",
    "+ ai,2x2 + · · · + ai,nxn = di\n...\n",
    "aj,1x1 + aj,2x2 + · · · + aj,nxn = dj\n...\nam,1x1 + am,2x2 + · · · + am,nxn = dm\nThe tuple (s1, . . .",
    ", sn) satisﬁes this system if and only if substituting the values\nfor the variables, the s’s for the x’s, gives a conjunction of true statements:\na1,1s1+a1,2s2+· · ·+a1,nsn = d1 and . . .",
    "ai,1s1+ai,2s2+· · ·+ai,nsn = di and\n. . .",
    "aj,1s1",
    "+aj,2s2 +· · ·+aj,nsn = dj and . . .",
    "am,1s1",
    "+am,2s2 +· · ·+am,nsn =\ndm.\n",
    "In a list of statements joined with ‘and’ we can rearrange the order of the\nstatements.",
    "Thus this requirement is met if and only if a1,1s1 + a1,2s2 + · · · +\na1,nsn = d1 and . . .",
    "aj,1s1",
    "+aj,2s2 +· · ·+aj,nsn = dj and . . .",
    "ai,1s1",
    "+ai,2s2 +\n· · ·+ai,nsn = di and . . .",
    "am,1s1",
    "+am,2s2 +· · ·+am,nsn = dm.",
    "This is exactly\nthe requirement that (s1, . . .",
    ", sn) solves the system after the row swap.\n",
    "QED\n\nSection I. Solving Linear Systems\n5\n1.6 Deﬁnition The three operations from Theorem 1.5 are the elementary re-\nduction operations, or row operations, or Gaussian operations.",
    "They are\nswapping, multiplying by a scalar (or rescaling), and row combination.\n",
    "When writing out the calculations, we will abbreviate ‘row i’ by ‘ρi’ (this is\nthe Greek letter rho, pronounced aloud as “row”).",
    "For instance, we will denote\na row combination operation by kρi + ρj, with the row that changes written\nsecond.",
    "To save writing we will often combine addition steps when they use the\nsame ρi, as in the next example.\n",
    "1.7 Example Gauss’s Method systematically applies the row operations to solve\na system.",
    "Here is a typical case.\n",
    "x + y\n= 0\n2x −y + 3z = 3\nx −2y −z = 3\nWe begin by using the ﬁrst row to eliminate the 2x in the second row and the x\nin the third.",
    "To get rid of the 2x we mentally multiply the entire ﬁrst row by\n−2, add that to the second row, and write the result in as the new second row.\n",
    "To eliminate the x in the third row we multiply the ﬁrst row by −1, add that to\nthe third row, and write the result in as the new third row.\n",
    "−2ρ1+ρ2\n−→\n−ρ1+ρ3\nx +\ny\n= 0\n−3y + 3z = 3\n−3y −z",
    "= 3\nWe ﬁnish by transforming the second system into a third, where the bottom\nequation involves only one unknown.",
    "We do that by using the second row to\neliminate the y term from the third row.\n−ρ2+ρ3\n−→\nx +\ny\n= 0\n−3y +\n3z = 3\n−4z = 0\nNow ﬁnding the system’s solution is easy.",
    "The third row gives z = 0.",
    "Substitute\nthat back into the second row to get y = −1.",
    "Then substitute back into the ﬁrst\nrow to get x",
    "= 1.\n",
    "1.8 Example For the Physics problem from the start of this chapter, Gauss’s\nMethod gives this.\n40h + 15c = 100\n−50h + 25c = 50\n5/4ρ1+ρ2\n−→\n40h +\n15c = 100\n(175/4)c = 175\n",
    "So c = 4, and back-substitution gives that h =",
    "1.",
    "(We will solve the Chemistry\nproblem later.)\n\n",
    "6\nChapter One.",
    "Linear Systems\n1.9 Example",
    "The reduction\nx + y + z = 9\n2x + 4y −3z = 1\n3x + 6y −5z",
    "= 0\n−2ρ1+ρ2\n−→\n−3ρ1+ρ3\nx + y + z =\n9\n2y −5z = −17\n3y −8z = −27\n−(3/2)ρ2+ρ3\n−→\nx +",
    "y +\nz =\n9\n2y −\n5z =\n−17\n−(1/2)z",
    "= −(3/2)\nshows that z = 3, y = −1, and x = 7.\n",
    "As illustrated above, the point of Gauss’s Method is to use the elementary\nreduction operations to set up back-substitution.\n",
    "1.10 Deﬁnition In each row of a system, the ﬁrst variable with a nonzero coeﬃcient\nis the row’s leading variable.",
    "A system is in echelon form if each leading\nvariable is to the right of the leading variable in the row above it, except for the\nleading variable in the ﬁrst row, and any rows with all-zero coeﬃcients are at\nthe bottom.\n",
    "1.11 Example The prior three examples only used the operation of row combina-\ntion.",
    "This linear system requires the swap operation to get it into echelon form\nbecause after the ﬁrst combination\nx −y\n= 0\n2x −2y + z + 2w = 4\ny\n+ w = 0\n2z + w = 5\n−2ρ1+ρ2\n−→\nx −y\n= 0\nz + 2w = 4\ny\n+ w = 0\n2z + w = 5\nthe second equation has no leading y.",
    "We exchange it for a lower-down row that\nhas a leading y.\nρ2↔ρ3\n−→\nx −y\n= 0\ny\n+ w = 0\nz + 2w = 4\n2z + w = 5\n(Had there been more than one suitable row below the second then we could\nhave used any one.)",
    "With that, Gauss’s Method proceeds as before.\n",
    "−2ρ3+ρ4\n−→\nx −y\n=\n0\ny\n+\nw =\n0\nz +\n2w =\n4\n−3w = −3\nBack-substitution gives w = 1, z = 2 , y = −1, and x = −1.\n\n",
    "Section I. Solving Linear Systems\n7\nStrictly speaking, to solve linear systems we don’t need the row rescaling\noperation.",
    "We have introduced it here because it is convenient and because we\nwill use it later in this chapter as part of a variation of Gauss’s Method, the\nGauss-Jordan Method.\n",
    "All of the systems so far have the same number of equations as unknowns.\n",
    "All of them have a solution and for all of them there is only one solution.",
    "We\nﬁnish this subsection by seeing other things that can happen.\n",
    "1.12 Example This system has more equations than variables.\n",
    "x + 3y =\n1\n2x +",
    "y = −3\n2x + 2y = −2\nGauss’s Method helps us understand this system also, since this\n−2ρ1+ρ2\n−→\n−2ρ1+ρ3\nx +\n3y =\n1\n−5y = −5\n−4y = −4\nshows that one of the equations is redundant.",
    "Echelon form\n−(4/5)ρ2+ρ3\n−→\nx +\n3y =\n1\n−5y = −5\n0 =\n0\ngives that y = 1 and x = −2.",
    "The ‘0 = 0’ reﬂects the redundancy.\n",
    "Gauss’s Method is also useful on systems with more variables than equations.\n",
    "The next subsection has many examples.\n",
    "Another way that linear systems can diﬀer from the examples shown above\nis that some linear systems do not have a unique solution.",
    "This can happen in\ntwo ways.",
    "The ﬁrst is that a system can fail to have any solution at all.\n",
    "1.13 Example Contrast the system in the last example with this one.\n",
    "x + 3y =\n1\n2x +",
    "y = −3\n2x + 2y =\n0\n−2ρ1+ρ2\n−→\n−2ρ1+ρ3\nx +\n3y =\n1\n−5y = −5\n−4y = −2\nHere the system is inconsistent: no pair of numbers (s1, s2) satisﬁes all three\nequations simultaneously.",
    "Echelon form makes the inconsistency obvious.\n",
    "−(4/5)ρ2+ρ3\n−→\nx +\n3y =\n1\n−5y = −5\n0 =\n2\nThe solution set is empty.\n\n",
    "8\nChapter One.",
    "Linear Systems\n1.14 Example",
    "The prior system has more equations than unknowns but that\nis not what causes the inconsistency — Example 1.12 has more equations than\nunknowns and yet is consistent.",
    "Nor is having more equations than unknowns\nnecessary for inconsistency, as we see with this inconsistent system that has the\nsame number of equations as unknowns.\n",
    "x + 2y = 8\n2x +",
    "4y = 8\n−2ρ1+ρ2\n−→\nx + 2y =\n8\n0 = −8\nInstead, inconsistency has to do with the interaction of the left and right sides;\nin the ﬁrst system above the left side’s second equation is twice the ﬁrst but the\nright side’s second constant is not twice the ﬁrst.",
    "Later we will have more to\nsay about dependencies between a system’s parts.\n",
    "The other way that a linear system can fail to have a unique solution, besides\nhaving no solutions, is to have many solutions.\n",
    "1.15 Example In this system\nx + y = 4\n2x +",
    "2y = 8\nany pair of numbers satisfying the ﬁrst equation also satisﬁes the second.",
    "The\nsolution set {(x, y) | x",
    "+ y = 4} is inﬁnite; some example member pairs are (0, 4),\n(−1, 5), and (2.5, 1.5).\n",
    "The result of applying Gauss’s Method here contrasts with the prior example\nbecause we do not get a contradictory equation.\n",
    "−2ρ1+ρ2\n−→\nx + y = 4\n0 = 0\nDon’t be fooled by that example: a 0 = 0 equation is not the signal that a\nsystem has many solutions.\n",
    "1.16 Example",
    "The absence of a 0 = 0 equation does not keep a system from having\nmany diﬀerent solutions.",
    "This system is in echelon form, has no 0 = 0, but\nhas inﬁnitely many solutions, including (0, 1, −1), (0, 1/2, −1/2), (0, 0, 0), and\n(0, −π, π) (any triple whose ﬁrst component is 0 and whose second component\nis the negative of the third is a solution).\n",
    "x + y + z = 0\ny + z = 0\n",
    "Nor does the presence of 0 = 0 mean that the system must have many\nsolutions.",
    "Example 1.12 shows that.",
    "So does this system, which does not have\n\nSection I.",
    "Solving Linear Systems\n9\nany solutions at all despite that in echelon form it has a 0 = 0 row.\n",
    "2x\n−2z = 6\ny + z = 1\n2x +",
    "y −z = 7\n3y + 3z = 0\n−ρ1+ρ3\n−→\n2x\n−2z = 6\ny + z",
    "= 1\ny + z = 1\n3y + 3z = 0\n−ρ2+ρ3\n−→\n−3ρ2+ρ4\n2x\n−2z",
    "=\n6\ny + z =\n1\n0 =\n0\n0 = −3\n",
    "In summary, Gauss’s Method uses the row operations to set a system up for\nback substitution.",
    "If any step shows a contradictory equation then we can stop\nwith the conclusion that the system has no solutions.",
    "If we reach echelon form\nwithout a contradictory equation, and each variable is a leading variable in its\nrow, then the system has a unique solution and we ﬁnd it by back substitution.\n",
    "Finally, if we reach echelon form without a contradictory equation, and there is\nnot a unique solution — that is, at least one variable is not a leading variable —\nthen the system has many solutions.\n",
    "The next subsection explores the third case.",
    "We will see that such a system\nmust have inﬁnitely many solutions and we will describe the solution set.\n",
    "Note.",
    "In the exercises here, and in the rest of the book, you must justify all\nof your answers.",
    "For instance, if a question asks whether a system has a\nsolution then you must justify a yes response by producing the solution and\nmust justify a no response by showing that no solution exists.\n",
    "Exercises\n✓1.17 Use Gauss’s Method to ﬁnd the unique solution for each system.\n",
    "(a) 2x +",
    "3y = 13\nx −y = −1\n(b)\nx\n−z = 0\n3x + y\n= 1\n−x + y + z = 4\n1.18 Each system is in echelon form.",
    "For each, say whether the system has a unique\nsolution, no solution, or inﬁnitely many solutions.\n(a) −3x",
    "+\n2y = 0\n−2y = 0\n(b) x",
    "+ y\n= 4\ny −z = 0\n(c) x",
    "+ y\n= 4\ny −z = 0\n0",
    "= 0\n(d) x",
    "+ y = 4\n0 = 4\n(e) 3x + 6y +\nz = −0.5\n−z =\n2.5\n(f) x",
    "−3y = 2\n0 = 0\n(g) 2x +",
    "2y = 4\ny",
    "= 1\n0 = 4\n(h) 2x",
    "+",
    "y = 0\n(i) x −y = −1\n0 =\n0\n0",
    "=\n4\n(j) x + y −3z = −1\ny −z =\n2\nz =\n0\n0 =\n0\n\n10\nChapter One.",
    "Linear Systems\n✓1.19 Use Gauss’s Method to solve each system or conclude ‘many solutions’ or ‘no\nsolutions’.\n",
    "(a) 2x +",
    "2y = 5\nx −4y = 0\n(b) −x +",
    "y = 1\nx",
    "+ y",
    "= 2\n(c) x",
    "−3y + z = 1\nx + y + 2z = 14\n(d)\n−x −y = 1\n−3x −3y = 2\n(e)\n4y +",
    "z = 20\n2x −2y + z = 0\nx\n+ z = 5\nx + y −z = 10\n(f) 2x\n+ z + w =\n5\ny\n−w = −1\n3x\n−z −w =\n0\n4x + y + 2z + w",
    "=\n9\n1.20 Solve each system or conclude ‘many solutions’ or ‘no solutions’.",
    "Use Gauss’s\nMethod.\n",
    "(a) x",
    "+ y + z = 5\nx −y\n= 0\ny",
    "+ 2z",
    "= 7\n(b) 3x\n+ z =\n7\nx −y + 3z =\n4\nx + 2y −5z = −1\n(c)\nx + 3y + z = 0\n−x −y\n= 2\n−x + y + 2z = 8\n✓1.21 We can solve linear systems by methods other than Gauss’s.",
    "One often taught\nin high school is to solve one of the equations for a variable, then substitute the\nresulting expression into other equations.",
    "Then we repeat that step until there\nis an equation with only one variable.",
    "From that we get the ﬁrst number in the\nsolution and then we get the rest with back-substitution.",
    "This method takes longer\nthan Gauss’s Method, since it involves more arithmetic operations, and is also\nmore likely to lead to errors.",
    "To illustrate how it can lead to wrong conclusions,\nwe will use the system\nx",
    "+ 3y =\n1\n2x +",
    "y = −3\n2x + 2y =\n0\nfrom Example 1.13.\n(a) Solve the ﬁrst equation for x and substitute that expression into the second\nequation.",
    "Find the resulting y.\n(b) Again solve the ﬁrst equation for x, but this time substitute that expression\ninto the third equation.",
    "Find this y.\nWhat extra step must a user of this method take to avoid erroneously concluding a\nsystem has a solution?\n✓1.22 For which values of k are there no solutions, many solutions, or a unique\nsolution to this system?\nx −y = 1\n3x −3y = k\n1.23 This system is not linear in that it says sin α instead of α\n2 sin α −\ncos β",
    "+ 3 tan γ = 3\n4 sin α + 2 cos β −2 tan γ = 10\n6 sin α −3 cos β",
    "+\ntan γ = 9\nand yet we can apply Gauss’s Method.",
    "Do so.",
    "Does the system have a solution?\n✓1.24",
    "What conditions must the constants, the b’s, satisfy so that each of these\nsystems has a solution?",
    "Hint.",
    "Apply Gauss’s Method and see what happens to the\nright side.\n\n",
    "Section I. Solving Linear Systems\n11\n(a)\n",
    "x −3y = b1\n3x +",
    "y = b2\nx + 7y = b3\n2x +",
    "4y = b4\n(b)\nx1 + 2x2",
    "+ 3x3 = b1\n2x1",
    "+ 5x2 + 3x3 = b2\nx1\n+ 8x3 = b3\n1.25 True or false: a system with more unknowns than equations has at least one\nsolution.",
    "(As always, to say ‘true’ you must prove it, while to say ‘false’ you must\nproduce a counterexample.)\n",
    "1.26 Must any Chemistry problem like the one that starts this subsection — a balance\nthe reaction problem — have inﬁnitely many solutions?\n✓1.27 Find the coeﬃcients a, b, and c so that the graph of f(x) = ax2 + bx + c passes\nthrough the points (1, 2), (−1, 6), and (2, 3).\n",
    "1.28 After Theorem 1.5 we note that multiplying a row by 0 is not allowed because\nthat could change a solution set.",
    "Give an example of a system with solution set S0\nwhere after multiplying a row by 0 the new system has a solution set S1 and S0 is\na proper subset of S1, that is, S0 ̸= S1.",
    "Give an example where S0 = S1.\n",
    "1.29 Gauss’s Method works by combining the equations in a system to make new\nequations.\n",
    "(a) Can we derive the equation 3x −2y = 5 by a sequence of Gaussian reduction\nsteps from the equations in this system?\n",
    "x + y = 1\n4x −y = 6\n(b) Can we derive the equation 5x−3y = 2 with a sequence of Gaussian reduction\nsteps from the equations in this system?\n2x +",
    "2y = 5\n3x +",
    "y = 4\n(c) Can we derive 6x −9y +",
    "5z = −2 by a sequence of Gaussian reduction steps\nfrom the equations in the system?\n2x +",
    "y −z = 4\n6x −3y + z = 5\n1.30 Prove that, where a, b, c, d, e are real numbers with a ̸= 0,",
    "if this linear equation\nax + by = c\nhas the same solution set as this one\nax + dy = e\nthen they are the same equation.",
    "What if a = 0?\n1.31 Show that if ad −bc ̸= 0 then\nax +",
    "by = j\ncx + dy = k\nhas a unique solution.\n",
    "✓1.32 In the system\nax + by = c\ndx",
    "+",
    "ey =",
    "f\neach of the equations describes a line in the xy-plane.",
    "By geometrical reasoning,\nshow that there are three possibilities: there is a unique solution, there is no\nsolution, and there are inﬁnitely many solutions.\n\n",
    "12\nChapter One.",
    "Linear Systems\n1.33 Finish the proof of Theorem 1.5.\n",
    "1.34 Is there a two-unknowns linear system whose solution set is all of R2?\n✓1.35 Are any of the operations used in Gauss’s Method redundant?",
    "That is, can we\nmake any of the operations from a combination of the others?\n",
    "1.36 Prove that each operation of Gauss’s Method is reversible.",
    "That is, show that\nif two systems are related by a row operation S1 →S2 then there is a row operation\nto go back S2 →S1.\n?",
    "1.37",
    "[Anton] A box holding pennies, nickels and dimes contains thirteen coins with\na total value of 83 cents.",
    "How many coins of each type are in the box?",
    "(These are\nUS coins; a penny is 1 cent, a nickel is 5 cents, and a dime is 10 cents.)\n?",
    "1.38",
    "[Con. Prob.",
    "1955]",
    "Four positive integers are given.",
    "Select any three of the\nintegers, ﬁnd their arithmetic average, and add this result to the fourth integer.\n",
    "Thus the numbers 29, 23, 21, and 17 are obtained.",
    "One of the original integers\nis:\n(a) 19\n(b) 21\n(c) 23\n(d) 29\n(e) 17\n?",
    "1.39",
    "[Am.",
    "Math.",
    "Mon., Jan. 1935]",
    "Laugh at this: AHAHA + TEHE = TEHAW.",
    "It\nresulted from substituting a code letter for each digit of a simple example in\naddition, and it is required to identify the letters and prove the solution unique.\n?",
    "1.40",
    "[Wohascum no. 2] The Wohascum County Board of Commissioners, which has\n20 members, recently had to elect a President.",
    "There were three candidates (A, B,\nand C); on each ballot the three candidates were to be listed in order of preference,\nwith no abstentions.",
    "It was found that 11 members, a majority, preferred A over\nB (thus the other 9 preferred B over A).",
    "Similarly, it was found that 12 members\npreferred C over A. Given these results, it was suggested that B should withdraw,\nto enable a runoﬀelection between A and C.",
    "However, B protested, and it was\nthen found that 14 members preferred B over C!",
    "The Board has not yet recovered\nfrom the resulting confusion.",
    "Given that every possible order of A, B, C appeared\non at least one ballot, how many members voted for B as their ﬁrst choice?\n? 1.41",
    "[Am.",
    "Math.",
    "Mon., Jan. 1963]",
    "“This system of n linear equations with n un-\nknowns,” said the Great Mathematician, “has a curious property.”\n“Good heavens!” said the Poor Nut, “What is it?”\n“Note,” said the Great Mathematician, “that the constants are in arithmetic\nprogression.”\n",
    "“It’s all so clear when you explain it!” said the Poor Nut.",
    "“Do you mean like\n6x + 9y = 12 and 15x + 18y = 21?”\n“Quite so,” said the Great Mathematician, pulling out his bassoon.",
    "“Indeed,\nthe system has a unique solution.",
    "Can you ﬁnd it?”\n“Good heavens!” cried the Poor Nut, “I am baﬄed.”\n",
    "Are you?\n\nSection I. Solving Linear Systems\n13\nI.2\nDescribing the Solution Set\nA linear system with a unique solution has a solution set with one element.",
    "A\nlinear system with no solution has a solution set that is empty.",
    "In these cases\nthe solution set is easy to describe.",
    "Solution sets are a challenge to describe only\nwhen they contain many elements.\n",
    "2.1 Example This system has many solutions because in echelon form\n2x\n+ z = 3\nx −y −z = 1\n3x −y\n= 4\n−(1/2)ρ1+ρ2\n−→\n−(3/2)ρ1+ρ3\n2x\n+\nz =\n3\n−y −(3/2)z = −1/2\n−y −(3/2)z = −1/2\n−ρ2+ρ3\n−→\n2x\n+\nz =\n3\n−y −(3/2)z = −1/2\n0 =\n0\nnot all of the variables are leading variables.",
    "Theorem 1.5 shows that an (x, y, z)\nsatisﬁes the ﬁrst system if and only if it satisﬁes the third.",
    "So we can describe\nthe solution set {(x, y, z) | 2x + z = 3 and x −y −z = 1 and 3x −y = 4} in this\nway.\n",
    "{(x, y, z) | 2x + z = 3 and −y −3z/2 = −1/2}\n(∗)\n",
    "This description is better because it has two equations instead of three but it is\nnot optimal because it still has some hard to understand interactions among the\nvariables.\n",
    "To improve it, use the variable that does not lead any equation, z, to describe\nthe variables that do lead, x and y.",
    "The second equation gives y = (1/2)−(3/2)z\nand the ﬁrst equation gives x = (3/2)−(1/2)z.",
    "Thus we can describe the solution\nset as this set of triples.\n",
    "{((3/2) −(1/2)z, (1/2) −(3/2)z, z) | z ∈R}\n(∗∗)\nCompared with (∗), the advantage of (∗∗) is that z can be any real number.\n",
    "This makes the job of deciding which tuples are in the solution set much easier.\n",
    "For instance, taking z = 2 shows that (1/2, −5/2, 2) is a solution.\n",
    "2.2 Deﬁnition In an echelon form linear system the variables that are not leading\nare free.\n",
    "2.3 Example Reduction of a linear system can end with more than one variable\n\n14\nChapter One.",
    "Linear Systems\nfree.",
    "Gauss’s Method on this system\nx +\ny + z −w =\n1\ny −z + w = −1\n3x\n+ 6z −6w =\n6\n−y + z −w =\n1\n−3ρ1+ρ3\n−→\nx +\ny + z −w =\n1\ny −z + w = −1\n−3y + 3z −3w =\n3\n−y + z −w =\n1\n3ρ2+ρ3\n−→\nρ2+ρ4\nx + y + z −w =\n1\ny −z + w = −1\n0",
    "=\n0\n0 =\n0\nleaves x and y leading and both z and w free.",
    "To get the description that we\nprefer, we work from the bottom.",
    "We ﬁrst express the leading variable y in terms\nof z and w, as y = −1 + z −w.",
    "Moving up to the top equation, substituting for\ny gives x",
    "+ (−1 + z −w)",
    "+ z −w = 1 and solving for x leaves x = 2 −2z + 2w.\n",
    "The solution set\n{(2 −2z + 2w, −1 + z −w, z, w) | z, w ∈R}\n(∗∗)\nhas the leading variables expressed in terms of the variables that are free.\n",
    "2.4 Example The list of leading variables may skip over some columns.",
    "After\nthis reduction\n2x −2y\n= 0\nz + 3w = 2\n3x −3y\n= 0\nx −y + 2z +",
    "6w = 4\n−(3/2)ρ1+ρ3\n−→\n−(1/2)ρ1+ρ4\n2x −2y\n= 0\nz + 3w = 2\n0 = 0\n2z + 6w = 4\n−2ρ2+ρ4\n−→\n2x −2y\n= 0\nz + 3w = 2\n0",
    "= 0\n0",
    "= 0\nx and z are the leading variables, not x and y.",
    "The free variables are y and w\nand so we can describe the solution set as {(y, y, 2 −3w, w) | y, w ∈R}.",
    "For\ninstance, (1, 1, 2, 0) satisﬁes the system — take y = 1 and w = 0.",
    "The four-tuple\n(1, 0, 5, 4) is not a solution since its ﬁrst coordinate does not equal its second.\n",
    "A variable that we use to describe a family of solutions is a parameter.",
    "We\nsay that the solution set in the prior example is parametrized with y and w.\n",
    "The terms ‘parameter’ and ‘free variable’ do not mean the same thing.",
    "In the\nprior example y and w are free because in the echelon form system they do not\nlead.",
    "They are parameters because we used them to describe the set of solutions.\n",
    "Had we instead rewritten the second equation as w = 2/3 −(1/3)z then the free\nvariables would still be y and w but the parameters would be y and z.\n\nSection I. Solving Linear Systems\n15\nIn the rest of this book we will solve linear systems by bringing them to\nechelon form and then parametrizing with the free variables.\n",
    "2.5 Example This is another system with inﬁnitely many solutions.\n",
    "x",
    "+ 2y\n= 1\n2x\n+ z\n= 2\n3x + 2y + z −w = 4\n−2ρ1+ρ2\n−→\n−3ρ1+ρ3\nx +\n2y\n= 1\n−4y + z\n= 0\n−4y + z −w = 1\n−ρ2+ρ3\n−→\nx +\n2y\n= 1\n−4y + z\n= 0\n−w = 1\nThe leading variables are x, y, and w.",
    "The variable z is free.",
    "Notice that,\nalthough there are inﬁnitely many solutions, the value of w doesn’t vary but\nis constant w = −1.",
    "To parametrize, write w in terms of z with w = −1 + 0z.\n",
    "Then y = (1/4)z.",
    "Substitute for y in the ﬁrst equation to get x = 1 −(1/2)z.\n",
    "The solution set is {(1 −(1/2)z, (1/4)z, z, −1) | z ∈R}.\n",
    "Parametrizing solution sets shows that systems with free variables have\ninﬁnitely many solutions.",
    "For instance, above z takes on all of inﬁnitely many\nreal number values, each associated with a diﬀerent solution.\n",
    "We ﬁnish this subsection by developing a streamlined notation for linear\nsystems and their solution sets.\n",
    "2.6 Deﬁnition An m×n matrix is a rectangular array of numbers with m rows\nand n columns.",
    "Each number in the matrix is an entry.\n",
    "We usually denote a matrix with an upper case roman letter.",
    "For instance,\nA =\n \n1\n2.2\n5\n3\n4\n−7\n!\nhas 2 rows and 3 columns and so is a 2×3 matrix.",
    "Read that aloud as “two-by-\nthree”; the number of rows is always stated ﬁrst.",
    "(The matrix has parentheses\naround it so that when two matrices are adjacent we can tell where one ends and\nthe other begins.)",
    "We name matrix entries with the corresponding lower-case\nletter, so that the entry in the second row and ﬁrst column of the above array\nis a2,1 = 3.",
    "Note that the order of the subscripts matters: a1,2 ̸= a2,1 since\na1,2 = 2.2.",
    "We denote the set of all m×n matrices by Mm×n.\n",
    "We do Gauss’s Method using matrices in essentially the same way that we\ndid it for systems of equations: a matrix row’s leading entry is its ﬁrst nonzero\nentry (if it has one) and we perform row operations to arrive at matrix echelon\nform, where the leading entry in lower rows are to the right of those in the rows\n\n16\nChapter One.",
    "Linear Systems\nabove.",
    "We like matrix notation because it lightens the clerical load, the copying\nof variables and the writing of +’s and =’s.\n",
    "2.7 Example We can abbreviate this linear system\nx + 2y\n= 4\ny −z = 0\nx\n+ 2z = 4\nwith this matrix.\n",
    "\n\n\n1\n2\n0\n4\n0\n1\n−1\n0\n1\n0\n2\n4\n\n\n\n",
    "The vertical bar reminds a reader of the diﬀerence between the coeﬃcients on\nthe system’s left hand side and the constants on the right.",
    "With a bar, this is\nan augmented matrix.\n",
    "\n\n\n1\n2\n0\n4\n0\n1\n−1\n0\n1\n0\n2\n4\n\n\n\n−ρ1+ρ3\n−→\n\n\n\n1\n2\n0\n4\n0\n1\n−1\n0\n0\n−2\n2\n0\n\n\n\n2ρ2+ρ3\n−→\n\n\n\n1\n2\n0\n4\n0\n1\n−1\n0\n0\n0\n0\n0\n\n\n\n",
    "The second row stands for y −z = 0 and the ﬁrst row stands for x + 2y = 4 so\nthe solution set is {(4 −2z, z, z) | z ∈R}.\n",
    "Matrix notation also clariﬁes the descriptions of solution sets.",
    "Example 2.3’s\n{(2 −2z + 2w, −1 + z −w, z, w) | z, w ∈R} is hard to read.",
    "We will rewrite it\nto group all of the constants together, all of the coeﬃcients of z together, and\nall of the coeﬃcients of w together.",
    "We write them vertically, in one-column\nmatrices.\n",
    "{\n\n\n\n\n\n2\n−1\n0\n0\n\n\n\n\n+\n\n\n\n\n\n−2\n1\n1\n0\n\n\n\n\n·",
    "z +\n\n\n\n\n\n2\n−1\n0\n1\n\n\n\n\n· w | z, w ∈R}\n",
    "For instance, the top line says that x = 2 −2z + 2w and the second line says\nthat y = −1 + z −w.",
    "(Our next section gives a geometric interpretation that\nwill help us picture the solution sets.)\n",
    "2.8 Deﬁnition A column vector, often just called a vector, is a matrix with a\nsingle column.",
    "A matrix with a single row is a row vector.",
    "The entries of\na vector are sometimes called components.",
    "A column or row vector whose\ncomponents are all zeros is a zero vector.\n",
    "Vectors are an exception to the convention of representing matrices with\ncapital roman letters.",
    "We use lower-case roman or greek letters overlined with an\n\nSection I. Solving Linear Systems\n17\narrow: ⃗a, ⃗b, . . .",
    "or ⃗α, ⃗β, . . .",
    "(boldface is also common: a or α).",
    "For instance,\nthis is a column vector with a third component of 7.\n⃗v =\n\n\n\n1\n3\n7\n\n\n\nA zero vector is denoted ⃗0.",
    "There are many diﬀerent zero vectors — the one-tall\nzero vector, the two-tall zero vector, etc. — but nonetheless we will often say\n“the” zero vector, expecting that the size will be clear from the context.\n",
    "2.9 Deﬁnition The linear equation a1x1",
    "+a2x2 + · · · +anxn = d with unknowns\nx1, . . .",
    ", xn is satisﬁed by\n⃗s =\n\n\n\ns1\n...\nsn\n\n",
    "\n\n",
    "if a1s1 + a2s2 + · · · + ansn = d. A vector satisﬁes a linear system if it satisﬁes\neach equation in the system.\n",
    "The style of description of solution sets that we use involves adding the\nvectors, and also multiplying them by real numbers.",
    "Before we give the examples\nshowing the style we ﬁrst need to deﬁne these operations.\n",
    "2.10 Deﬁnition The vector sum of ⃗u and ⃗v is the vector of the sums.\n",
    "⃗u +⃗v =\n\n\n\nu1\n...\nun\n\n\n+\n\n\n\nv1\n...\n",
    "vn\n\n\n=\n\n\n\nu1 + v1\n...\nun",
    "+ vn\n\n",
    "\n\nNote that for the addition to be deﬁned the vectors must have the same\nnumber of entries.",
    "This entry-by-entry addition works for any pair of matrices,\nnot just vectors, provided that they have the same number of rows and columns.\n",
    "2.11 Deﬁnition The scalar multiplication of the real number r and the vector ⃗v\nis the vector of the multiples.\n",
    "r ·⃗v = r ·\n\n\n\nv1\n...\nvn\n\n\n=\n\n\n\nrv1\n...\nrvn\n\n",
    "\n\n",
    "As with the addition operation, the entry-by-entry scalar multiplication\noperation extends beyond vectors to apply to any matrix.\n\n18\nChapter One.",
    "Linear Systems\nWe write scalar multiplication either as r · ⃗v or ⃗v · r, and sometimes even\nomit the ‘·’ symbol: r⃗v.",
    "(Do not refer to scalar multiplication as ‘scalar product’\nbecause that name is for a diﬀerent operation.)\n",
    "2.12 Example\n\n\n\n2\n3\n1\n\n\n+\n\n\n\n3\n−1\n4\n\n\n=\n\n\n\n2 + 3\n3 −1\n1 + 4\n\n\n=\n\n\n\n5\n2\n5\n\n\n\n7 ·\n\n\n\n\n\n1\n4\n−1\n−3\n\n\n\n\n=\n\n\n\n\n\n7\n28\n−7\n−21\n\n\n\n\n\nObserve that the deﬁnitions of addition and scalar multiplication agree where\nthey overlap; for instance, ⃗v +⃗v = 2⃗v.\n",
    "With these deﬁnitions, we are set to use matrix and vector notation to both\nsolve systems and express the solution.\n",
    "2.13 Example This system\n2x + y\n−w\n= 4\ny\n+ w",
    "+ u = 4\nx\n−z + 2w\n= 0\nreduces in this way.\n",
    "\n\n\n2\n1\n0\n−1\n0\n4\n0\n1\n0\n1\n1\n4\n1\n0\n−1\n2\n0\n0\n\n\n\n−(1/2)ρ1+ρ3\n−→\n\n\n\n2\n1\n0\n−1\n0\n4\n0\n1\n0\n1\n1\n4\n0\n−1/2\n−1\n5/2\n0\n−2\n\n\n\n(1/2)ρ2+ρ3\n−→\n\n\n\n2\n1\n0\n−1\n0\n4\n0\n1\n0\n1\n1\n4\n0\n0\n−1\n3\n1/2\n0\n\n\n\n",
    "The solution set is {(w + (1/2)u, 4 −w −u, 3w + (1/2)u, w, u) | w, u ∈R}.",
    "We\nwrite that in vector form.\n",
    "{\n\n\n\n\n\n\n\nx\ny\nz\nw\nu\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n0\n4\n0\n0\n0\n\n\n\n\n\n\n\n+\n\n\n\n\n\n\n\n1\n−1\n3\n1\n0\n\n\n\n\n\n\n\nw +\n\n\n\n\n\n\n\n1/2\n−1\n1/2\n0\n1\n\n\n\n\n\n\n\nu | w, u ∈R}\nNote how well vector notation sets oﬀthe coeﬃcients of each parameter.",
    "For\ninstance, the third row of the vector form shows plainly that if u is ﬁxed then z\nincreases three times as fast as w. Another thing shown plainly is that setting\n\nSection I. Solving Linear Systems\n19\nboth w and u to zero gives that\n\n\n\n\n\n\n\nx\ny\nz\nw\nu\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n0\n4\n0\n0\n0\n\n\n\n\n\n\n\nis a particular solution of the linear system.\n",
    "2.14 Example",
    "In the same way, the system\nx −y + z = 1\n3x\n+ z = 3\n5x −2y + 3z = 5\nreduces\n\n\n\n1\n−1\n1\n1\n3\n0\n1\n3\n5\n−2\n3\n5\n\n",
    "\n\n−3ρ1+ρ2\n−→\n−5ρ1+ρ3\n\n\n\n1\n−1\n1\n1\n0\n3\n−2\n0\n0\n3\n−2\n0\n\n\n\n−ρ2+ρ3\n−→\n\n\n\n1\n−1\n1\n1\n0\n3\n−2\n0\n0\n0\n0\n0\n\n\n\nto give a one-parameter solution set.\n",
    "{\n\n\n\n1\n0\n0\n\n\n+\n\n\n\n−1/3\n2/3\n1\n\n\nz | z ∈R}\nAs in the prior example, the vector not associated with the parameter\n\n\n\n1\n0\n0\n\n\n\nis a particular solution of the system.\n",
    "Before the exercises, we will consider what we have accomplished and what\nwe will do in the remainder of the chapter.",
    "So far we have done the mechanics\nof Gauss’s Method.",
    "We have not stopped to consider any of the questions that\narise, except for proving Theorem 1.5 — which justiﬁes the method by showing\nthat it gives the right answers.\n",
    "For example, can we always describe solution sets as above, with a particular\nsolution vector added to an unrestricted linear combination of some other vectors?\n\n20\nChapter One.",
    "Linear Systems\nWe’ve noted that the solution sets described in this way have inﬁnitely many\nmembers so answering this question would tell us about the size of solution sets.\n",
    "The following subsection shows that the answer is “yes.”",
    "This chapter’s second\nsection then uses that answer to describe the geometry of solution sets.\n",
    "Other questions arise from the observation that we can do Gauss’s Method\nin more than one way (for instance, when swapping rows we may have a choice\nof rows to swap with).",
    "Theorem 1.5 says that we must get the same solution set\nno matter how we proceed but if we do Gauss’s Method in two ways must we\nget the same number of free variables in each echelon form system?",
    "Must those\nbe the same variables, that is, is it impossible to solve a problem one way to get\ny and w free and solve it another way to get y and z free?",
    "The third section\nof this chapter answers “yes,” that from any starting linear system, all derived\nechelon form versions have the same free variables.\n",
    "Thus, by the end of the chapter we will not only have a solid grounding in\nthe practice of Gauss’s Method but we will also have a solid grounding in the\ntheory.",
    "We will know exactly what can and cannot happen in a reduction.\n",
    "Exercises\n✓2.15 Find the indicated entry of the matrix, if it is deﬁned.\n",
    "A =\n\u00121\n3\n1\n2\n−1\n4\n\u0013\n(a) a2,1\n(b) a1,2\n(c) a2,2\n(d) a3,1\n✓2.16 Give the size of each matrix.\n",
    "(a)\n\u00121\n0\n4\n2\n1\n5\n\u0013\n(b)\n\n\n1\n1\n−1\n1\n3\n−1\n\n\n(c)\n",
    "\u0012 5\n10\n10\n5\n\u0013\n✓2.17 Do the indicated vector operation, if it is deﬁned.\n",
    "(a)\n\n\n2\n1\n1\n\n+\n\n\n3\n0\n4\n\n\n(b) 5\n\u0012 4\n−1\n\u0013\n(c)\n\n\n1\n5\n1\n\n−\n\n\n3\n1\n1\n\n\n(d) 7\n\u00122\n1\n\u0013\n",
    "+ 9\n\u00123\n5\n\u0013\n(e)\n\u00121\n2\n\u0013\n+\n\n\n1\n2\n3\n\n\n(f) 6\n\n\n3\n1\n1\n\n−4\n\n\n2\n0\n3\n\n+ 2\n\n\n1\n1\n5\n\n\n✓2.18 Solve each system using matrix notation.\n",
    "Express the solution using vec-\ntors.\n",
    "(a) 3x + 6y",
    "= 18\nx + 2y = 6\n(b) x",
    "+ y =\n1\nx −y = −1\n(c)\nx1\n+ x3 = 4\nx1 −x2 + 2x3 = 5\n4x1",
    "−x2 + 5x3 = 17\n(d) 2a +",
    "b −c = 2\n2a\n+ c = 3\na −b\n= 0\n(e)\nx + 2y −z\n= 3\n2x + y\n+ w = 4\nx −y + z + w = 1\n(f)\nx\n+ z + w = 4\n2x + y\n−w = 2\n3x + y + z\n= 7\n2.19 Solve each system using matrix notation.",
    "Give each solution set in vector\nnotation.\n\n",
    "Section I. Solving Linear Systems\n21\n(a) 2x +",
    "y −z = 1\n4x −y\n= 3\n(b) x\n−z\n= 1\ny",
    "+ 2z −w = 3\nx + 2y + 3z −w = 7\n(c)\nx −\ny + z\n= 0\ny\n+ w = 0\n3x −2y + 3z + w = 0\n−y\n−w = 0\n(d)\na + 2b + 3c + d −e = 1\n3a −b",
    "+ c",
    "+ d",
    "+ e = 3\n2.20 Solve each system using matrix notation.\n",
    "Express the solution set using\nvectors.\n",
    "(a)\n3x + 2y + z = 1\nx −y + z = 2\n5x + 5y +",
    "z = 0\n(b)\nx + y −2z =\n0\nx −y\n= −3\n3x −y −2z = −6\n2y −2z =\n3\n(c) 2x −y −z + w =\n4\nx + y + z\n= −1\n(d)\n",
    "x + y −2z =\n0\nx −y\n= −3\n3x −y −2z =\n0\n✓2.21 The vector is in the set.",
    "What value of the parameters produces that vec-\ntor?\n(a)\n\u0012 5\n−5\n\u0013\n, {\n\u0012 1\n−1\n\u0013\nk | k ∈R}\n(b)\n\n\n−1\n2\n1\n\n, {\n\n\n−2\n1\n0\n\n",
    "i +\n\n\n3\n0\n1\n\nj | i, j ∈R}\n(c)\n\n\n0\n−4\n2\n\n, {\n\n\n1\n1\n0\n\n",
    "m +\n\n\n2\n0\n1\n\nn | m, n ∈R}\n2.22 Decide if the vector is in the set.\n",
    "(a)\n\u0012 3\n−1\n\u0013\n, {\n\u0012−6\n2\n\u0013\n",
    "k | k ∈R}\n(b)\n\u00125\n4\n\u0013\n, {\n\u0012 5\n−4\n\u0013\nj | j ∈R}\n(c)\n\n\n2\n1\n−1\n\n, {\n\n\n0\n3\n−7\n\n+\n\n\n1\n−1\n3\n\nr | r ∈R}\n(d)\n\n\n1\n0\n1\n\n, {\n\n\n2\n0\n1\n\nj +\n\n\n−3\n−1\n1\n\nk | j, k ∈R}\n2.23",
    "[Cleary] A farmer with 1200 acres is considering planting three diﬀerent crops,\ncorn, soybeans, and oats.",
    "The farmer wants to use all 1200 acres.",
    "Seed corn costs\n$20 per acre, while soybean and oat seed cost $50 and $12 per acre respectively.\n",
    "The farmer has $40 000 available to buy seed and intends to spend it all.\n",
    "(a) Use the information above to formulate two linear equations with three\nunknowns and solve it.\n",
    "(b) Solutions to the system are choices that the farmer can make.",
    "Write down\ntwo reasonable solutions.\n",
    "(c) Suppose that in the fall when the crops mature, the farmer can bring in\n\n22\nChapter One.",
    "Linear Systems\nrevenue of $100 per acre for corn, $300 per acre for soybeans and $80 per acre\nfor oats.",
    "Which of your two solutions in the prior part would have resulted in a\nlarger revenue?\n2.24 Parametrize the solution set of this one-equation system.\n",
    "x1",
    "+ x2 + · · · + xn = 0\n✓2.25\n(a) Apply Gauss’s Method to the left-hand side to solve\nx + 2y\n−w = a\n2x\n+ z\n= b\nx + y\n+ 2w = c\nfor x, y, z, and w, in terms of the constants a, b, and c.\n(b) Use your answer from the prior part to solve this.\n",
    "x",
    "+ 2y\n−w =\n3\n2x\n+ z\n=\n1\nx + y\n+ 2w = −2\n2.26 Why is the comma needed in the notation ‘ai,j’ for matrix entries?\n✓2.27 Give the 4×4 matrix whose i, j-th entry is\n(a) i + j;\n(b) −1 to the i +",
    "j power.\n",
    "2.28 For any matrix A, the transpose of A, written AT, is the matrix whose columns\nare the rows of A. Find the transpose of each of these.\n",
    "(a)\n\u00121\n2\n3\n4\n5\n6\n\u0013\n(b)\n",
    "\u00122\n−3\n1\n1\n\u0013\n(c)\n\u0012 5\n10\n10\n5\n\u0013\n(d)\n\n\n1\n1\n0\n\n\n✓2.29\n(a) Describe all functions f(x) = ax2 +bx+c such that f(1)",
    "= 2 and f(−1)",
    "= 6.\n(b) Describe all functions f(x) = ax2 + bx + c such that f(1)",
    "= 2.\n2.30 Show that any set of ﬁve points from the plane R2 lie on a common conic section,\nthat is, they all satisfy some equation of the form ax2 + by2 + cxy + dx +",
    "ey",
    "+ f = 0\nwhere some of a, . . .",
    ", f are nonzero.\n",
    "2.31 Make up a four equations/four unknowns system having\n(a) a one-parameter solution set;\n(b) a two-parameter solution set;\n(c) a three-parameter solution set.\n?",
    "2.32",
    "[Shepelev] This puzzle is from a Russian web-site http://www.arbuz.uz/ and\nthere are many solutions to it, but mine uses linear algebra and is very naive.\n",
    "There’s a planet inhabited by arbuzoids (watermeloners, to translate from Russian).\n",
    "Those creatures are found in three colors: red, green and blue.",
    "There are 13 red\narbuzoids, 15 blue ones, and 17 green.",
    "When two diﬀerently colored arbuzoids\nmeet, they both change to the third color.\n",
    "The question is, can it ever happen that all of them assume the same color?\n?",
    "2.33",
    "[USSR Olympiad no. 174]\n(a) Solve the system of equations.\n",
    "ax +\ny = a2\nx + ay =\n1\n",
    "For what values of a does the system fail to have solutions, and for what values\nof a are there inﬁnitely many solutions?\n\nSection I.",
    "Solving Linear Systems\n23\n(b) Answer the above question for the system.\n",
    "ax +\ny = a3\nx",
    "+ ay =\n1\n?",
    "2.34",
    "[Math. Mag., Sept. 1952]",
    "In air a gold-surfaced sphere weighs 7588 grams.",
    "It\nis known that it may contain one or more of the metals aluminum, copper, silver,\nor lead.",
    "When weighed successively under standard conditions in water, benzene,\nalcohol, and glycerin its respective weights are 6588, 6688, 6778, and 6328 grams.\n",
    "How much, if any, of the forenamed metals does it contain if the speciﬁc gravities\nof the designated substances are taken to be as follows?\n",
    "Aluminum\n2.7\nAlcohol\n0.81\nCopper\n8.9\nBenzene\n0.90\nGold\n19.3\nGlycerin\n1.26\nLead\n11.3\nWater\n1.00\nSilver\n10.8\nI.3\nGeneral = Particular + Homogeneous\n",
    "In the prior subsection the descriptions of solution sets all ﬁt a pattern.",
    "They\nhave a vector that is a particular solution of the system added to an unre-\nstricted combination of some other vectors.",
    "The solution set from Example 2.13\nillustrates.\n",
    "{\n\n\n\n\n\n\n\n0\n4\n0\n0\n0\n\n\n\n\n\n\n\nparticular\nsolution\n+ w\n\n\n\n\n\n\n\n1\n−1\n3\n1\n0\n\n\n\n\n\n\n\n+ u\n\n\n\n\n\n\n\n1/2\n−1\n1/2\n0\n1\n\n\n\n\n\n\n\nunrestricted\ncombination\n| w, u ∈R}\nThe combination is unrestricted in that w and u can be any real numbers —\nthere is no condition like “such that 2w −u = 0” to restrict which pairs w, u we\ncan use.\n",
    "That example shows an inﬁnite solution set ﬁtting the pattern.",
    "The other\ntwo kinds of solution sets also ﬁt.",
    "A one-element solution set ﬁts because it has\na particular solution and the unrestricted combination part is trivial.",
    "That is,\ninstead of being a combination of two vectors or of one vector, it is a combination\nof no vectors.",
    "(By convention the sum of an empty set of vectors is the zero\nvector.)",
    "An empty solution set ﬁts the pattern because there is no particular\nsolution and thus there are no sums of that form.\n\n",
    "24\nChapter One.",
    "Linear Systems\n3.1 Theorem Any linear system’s solution set has the form\n{⃗p + c1⃗β1 + · · · + ck⃗βk | c1, . .",
    ". , ck ∈R}\nwhere ⃗p is any particular solution and where the number of vectors ⃗β1, . .",
    ".",
    ",\n⃗βk equals the number of free variables that the system has after a Gaussian\nreduction.\n",
    "The solution description has two parts, the particular solution ⃗p and the\nunrestricted linear combination of the ⃗β’s.",
    "We shall prove the theorem with two\ncorresponding lemmas.\n",
    "We will focus ﬁrst on the unrestricted combination.",
    "For that we consider\nsystems that have the vector of zeroes as a particular solution so that we can\nshorten ⃗p + c1⃗β1 + · · · + ck⃗βk to c1⃗β1 + · · · + ck⃗βk.\n",
    "3.2 Deﬁnition A linear equation is homogeneous if it has a constant of zero, so\nthat it can be written as a1x1",
    "+ a2x2",
    "+ · · ·",
    "+ anxn = 0.\n3.3 Example With any linear system like\n3x +",
    "4y = 3\n2x −y = 1\nwe associate a system of homogeneous equations by setting the right side to\nzeros.\n",
    "3x +",
    "4y = 0\n2x −y = 0\nCompare the reduction of the original system\n3x +",
    "4y = 3\n2x −y = 1\n−(2/3)ρ1+ρ2\n−→\n3x +\n4y = 3\n−(11/3)y = −1\nwith the reduction of the associated homogeneous system.\n",
    "3x +",
    "4y = 0\n2x −y = 0\n−(2/3)ρ1+ρ2\n−→\n3x +\n4y = 0\n−(11/3)y = 0\nObviously the two reductions go in the same way.",
    "We can study how to reduce\na linear system by instead studying how to reduce the associated homogeneous\nsystem.\n",
    "Studying the associated homogeneous system has a great advantage over\nstudying the original system.",
    "Nonhomogeneous systems can be inconsistent.\n",
    "But a homogeneous system must be consistent since there is always at least one\nsolution, the zero vector.\n\n",
    "Section I. Solving Linear Systems\n25\n3.4 Example Some homogeneous systems have the zero vector as their only\nsolution.\n",
    "3x + 2y + z = 0\n6x + 4y\n= 0\ny + z = 0\n−2ρ1+ρ2\n−→\n3x + 2y +\nz = 0\n−2z = 0\ny",
    "+\nz = 0\nρ2↔ρ3\n−→\n3x + 2y +\nz = 0\ny +\nz = 0\n−2z = 0\n3.5 Example Some homogeneous systems have many solutions.\n",
    "One is the\nChemistry problem from the ﬁrst page of the ﬁrst subsection.\n",
    "7x\n−7z\n= 0\n8x +",
    "y −5z −2w = 0\ny −3z\n= 0\n3y −6z −w = 0\n−(8/7)ρ1+ρ2\n−→\n7x\n−7z\n= 0\ny + 3z −2w = 0\ny −3z\n= 0\n3y −6z −w = 0\n−ρ2+ρ3\n−→\n−3ρ2+ρ4\n7x\n−\n7z\n= 0\ny +\n3z −2w = 0\n−6z + 2w = 0\n−15z +",
    "5w = 0\n−(5/2)ρ3+ρ4\n−→\n7x\n−\n7z\n= 0\ny +\n3z −2w = 0\n−6z + 2w = 0\n0",
    "= 0\n",
    "The solution set\n{\n\n\n\n\n\n1/3\n1\n1/3\n1\n\n\n\n\nw | w ∈R}\nhas many vectors besides the zero vector (if we take w to be a number of\nmolecules then solutions make sense only when w is a nonnegative multiple of\n3).\n",
    "3.6 Lemma For any homogeneous linear system there exist vectors ⃗β1, . . .",
    ", ⃗βk\nsuch that the solution set of the system is\n{c1⃗β1 + · · · + ck⃗βk | c1, . .",
    ". , ck ∈R}\nwhere k is the number of free variables in an echelon form version of the system.\n",
    "We will make two points before the proof.",
    "The ﬁrst is that the basic idea of\nthe proof is straightforward.",
    "Consider this system of homogeneous equations in\n\n26\nChapter One.",
    "Linear Systems\nechelon form.\n",
    "x + y + 2z + u + v = 0\ny + z + u −v = 0\nu + v = 0\nStart with the bottom equation.",
    "Express its leading variable in terms of the\nfree variables with u = −v.",
    "For the next row up, substitute for the leading\nvariable u of the row below y + z + (−v) −v = 0 and solve for this row’s leading\nvariable y = −z + 2v.",
    "Iterate: on the next row up, substitute expressions found\nin lower rows x",
    "+ (−z + 2v)",
    "+ 2z + (−v)",
    "+ v = 0 and solve for the leading variable\nx = −z −2v.",
    "To ﬁnish, write the solution in vector notation\n\n\n\n\n\n\n\nx\ny\nz\nu\nv\n\n",
    "\n\n\n\n\n\n=\n\n\n\n\n\n\n\n−1\n−1\n1\n0\n0\n\n\n\n\n\n\n\nz +\n\n\n\n\n\n\n\n−2\n2\n0\n−1\n1\n\n\n\n\n\n\n\nv\nfor z, v ∈R\nand recognize that the ⃗β1 and ⃗β2 of the lemma are the vectors associated with\nthe free variables z and v.\n",
    "The prior paragraph is an example, not a proof.",
    "But it does suggest the\nsecond point about the proof, its approach.",
    "The example moves row-by-row up\nthe system, using the equations from lower rows to do the next row.",
    "This points\nto doing the proof by mathematical induction.∗\nInduction is an important and non-obvious proof technique that we shall\nuse a number of times in this book.",
    "We will do proofs by induction in two\nsteps, a base step and an inductive step.",
    "In the base step we verify that the\nstatement is true for some ﬁrst instance, here that for the bottom equation we\ncan write the leading variable in terms of free variables.",
    "In the inductive step\nwe must establish an implication, that if the statement is true for all prior cases\nthen it follows for the present case also.",
    "Here we will establish that if for the\nbottom-most t rows we can express the leading variables in terms of the free\nvariables, then for the t + 1-th row from the bottom we can also express the\nleading variable in terms of those that are free.\n",
    "Those two steps together prove the statement for all the rows because by\nthe base step it is true for the bottom equation, and by the inductive step the\nfact that it is true for the bottom equation shows that it is true for the next one\nup.",
    "Then another application of the inductive step implies that it is true for the\nthird equation up, etc.\n",
    "Proof Apply Gauss’s Method to get to echelon form.",
    "There may be some 0 = 0\nequations; we ignore these (if the system consists only of 0 = 0 equations then\n∗More information on mathematical induction is in the appendix.\n\n",
    "Section I. Solving Linear Systems\n27\nthe lemma is trivially true because there are no leading variables).",
    "But because\nthe system is homogeneous there are no contradictory equations.\n",
    "We will use induction to verify that each leading variable can be expressed\nin terms of free variables.",
    "That will ﬁnish the proof because we can use the free\nvariables as parameters and the ⃗β’s are the vectors of coeﬃcients of those free\nvariables.\n",
    "For the base step consider the bottom-most equation\nam,ℓmxℓm + am,ℓm+1xℓm+1 + · · · + am,nxn = 0\n(∗)\nwhere am,ℓm ̸= 0.",
    "(Here ‘ℓ’ stands for “leading” so that xℓm is the leading\nvariable in row m.)",
    "This is the bottom row so any variables after the leading\none must be free.",
    "Move these to the right hand side and divide by am,ℓm\nxℓm = (−am,ℓm+1/am,ℓm)xℓm+1 + · · · + (−am,n/am,ℓm)xn\nto express the leading variable in terms of free variables.",
    "(There is a tricky\ntechnical point here: if in the bottom equation (∗) there are no variables to\nthe right of xlm then xℓm",
    "= 0.",
    "This satisﬁes the statement we are verifying\nbecause, as alluded to at the start of this subsection, it has xℓm written as a\nsum of a number of the free variables, namely as the sum of zero many, under\nthe convention that a trivial sum totals to 0.)\n",
    "For the inductive step assume that the statement holds for the bottom-most\nt rows, with 0 ⩽t < m −1.",
    "That is, assume that for the m-th equation, and\nthe (m −1)-th equation, etc., up to and including the (m −t)-th equation, we\ncan express the leading variable in terms of free ones.",
    "We must verify that\nthis then also holds for the next equation up, the (m −(t + 1))-th equation.\n",
    "For that, take each variable that leads in a lower equation xℓm, . . . , xℓm−t and\nsubstitute its expression in terms of free variables.",
    "We only need expressions\nfor leading variables from lower equations because the system is in echelon\nform, so the leading variables in equations above this one do not appear in\nthis equation.",
    "The result has a leading term of am−(t+1),ℓm−(t+1)xℓm−(t+1)\nwith am−(t+1),ℓm−(t+1) ̸= 0, and the rest of the left hand side is a linear\ncombination of free variables.",
    "Move the free variables to the right side and divide\nby am−(t+1),ℓm−(t+1) to end with this equation’s leading variable xℓm−(t+1) in\nterms of free variables.\n",
    "We have done both the base step and the inductive step so by the principle\nof mathematical induction the proposition is true.\n",
    "QED\n",
    "This shows, as discussed between the lemma and its proof, that we can\nparametrize solution sets using the free variables.\n",
    "We say that the set of\nvectors {c1⃗β1 + · · · + ck⃗βk | c1, . .",
    ". , ck ∈R} is generated by or spanned by the\nset {⃗β1, . . .",
    ", ⃗βk }.\n\n",
    "28\nChapter One.",
    "Linear Systems\nTo ﬁnish the proof of Theorem 3.1 the next lemma considers the particular\nsolution part of the solution set’s description.\n",
    "3.7 Lemma For a linear system and for any particular solution ⃗p, the solution\nset equals {⃗p + ⃗h | ⃗h satisﬁes the associated homogeneous system}.\n",
    "Proof We will show mutual set inclusion, that any solution to the system is in\nthe above set and that anything in the set is a solution of the system.∗\nFor set inclusion the ﬁrst way, that if a vector solves the system then it is in\nthe set described above, assume that ⃗s solves the system.",
    "Then ⃗s −⃗p solves the\nassociated homogeneous system since for each equation index i,\nai,1(s1 −p1) + · · · + ai,n(sn −pn)\n",
    "= (ai,1s1 + · · · + ai,nsn) −(ai,1p1 + · · · + ai,npn) = di −di = 0\nwhere pj and sj are the j-th components of ⃗p and ⃗s.",
    "Express ⃗s in the required\n⃗p + ⃗h form by writing ⃗s −⃗p as ⃗h.\n",
    "For set inclusion the other way, take a vector of the form ⃗p + ⃗h, where ⃗p\nsolves the system and ⃗h solves the associated homogeneous system and note\nthat ⃗p + ⃗h solves the given system since for any equation index i,\nai,1(p1 + h1) + · · · + ai,n(pn + hn)\n= (ai,1p1 + · · · + ai,npn)",
    "+ (ai,1h1 + · · · + ai,nhn) = di + 0 = di\nwhere as earlier pj and hj are the j-th components of ⃗p and ⃗h.\n",
    "QED\nThe two lemmas together establish Theorem 3.1.",
    "Remember that theorem\nwith the slogan, “General = Particular + Homogeneous”.\n",
    "3.8 Example This system illustrates Theorem 3.1.\n",
    "x + 2y −z = 1\n2x + 4y\n= 2\ny −3z = 0\nGauss’s Method\n−2ρ1+ρ2\n−→\nx + 2y −z = 1\n2z = 0\ny −3z = 0\nρ2↔ρ3\n−→\nx + 2y −z = 1\ny −3z = 0\n2z = 0\nshows that the general solution is a singleton set.\n",
    "{\n\n\n\n1\n0\n0\n\n\n}\n∗More information on set equality is in the appendix.\n\n",
    "Section I. Solving Linear Systems\n29\n",
    "That single vector is obviously a particular solution.",
    "The associated homogeneous\nsystem reduces via the same row operations\nx + 2y −z = 0\n2x +",
    "4y\n= 0\ny −3z = 0\n−2ρ1+ρ2\n−→\nρ2↔ρ3\n−→\nx + 2y −z = 0\ny −3z = 0\n2z = 0\nto also give a singleton set.\n",
    "{\n\n\n\n0\n0\n0\n\n\n}\n",
    "So, as discussed at the start of this subsection, in this single-solution case the\ngeneral solution results from taking the particular solution and adding to it the\nunique solution of the associated homogeneous system.\n",
    "3.9 Example The start of this subsection also discusses that the case where\nthe general solution set is empty ﬁts the General = Particular + Homogeneous\npattern too.",
    "This system illustrates.\n",
    "x\n+ z + w = −1\n2x −y\n+ w =\n3\nx + y + 3z + 2w =\n1\n−2ρ1+ρ2\n−→\n−ρ1+ρ3\nx\n+ z + w = −1\n−y −2z −w =\n5\ny + 2z + w =\n2\nIt has no solutions because the ﬁnal two equations conﬂict.",
    "But the associated\nhomogeneous system does have a solution, as do all homogeneous systems.\n",
    "x\n+ z + w = 0\n2x −y\n+ w = 0\nx + y + 3z + 2w = 0\n−2ρ1+ρ2\n−→\n−ρ1+ρ3\nρ2+ρ3\n−→\nx\n+ z + w = 0\n−y −2z −w = 0\n0",
    "= 0\n",
    "In fact, the solution set is inﬁnite.\n{\n\n\n\n\n\n−1\n−2\n1\n0\n\n\n\n\nz +\n\n\n\n\n\n−1\n−1\n0\n1\n\n\n\n\nw | z, w ∈R}\nNonetheless, because the original system has no particular solution, its general\nsolution set is empty — there are no vectors of the form ⃗p + ⃗h because there are\nno ⃗p ’s.\n3.10 Corollary Solution sets of linear systems are either empty, have one element,\nor have inﬁnitely many elements.\n\n",
    "30\nChapter One.",
    "Linear Systems\nProof We’ve seen examples of all three happening so we need only prove that\nthere are no other possibilities.\n",
    "First observe a homogeneous system with at least one non-⃗0 solution ⃗v has\ninﬁnitely many solutions.",
    "This is because any scalar multiple of ⃗v also solves the\nhomogeneous system and there are inﬁnitely many vectors in the set of scalar\nmultiples of ⃗v: if s, t ∈R are unequal then s⃗v ̸= t⃗v, since s⃗v −t⃗v = (s −t)⃗v is\nnon-⃗0 as any non-0 component of ⃗v, when rescaled by the non-0 factor s −t, will\ngive a non-0 value.\n",
    "Now apply Lemma 3.7 to conclude that a solution set\n{⃗p + ⃗h | ⃗h solves the associated homogeneous system}\nis either empty (if there is no particular solution ⃗p), or has one element (if there\nis a ⃗p and the homogeneous system has the unique solution ⃗0), or is inﬁnite (if\nthere is a ⃗p and the homogeneous system has a non-⃗0 solution, and thus by the\nprior paragraph has inﬁnitely many solutions).\n",
    "QED\n",
    "This table summarizes the factors aﬀecting the size of a general solution.\n",
    "number of solutions of the\nhomogeneous system\nparticular\nsolution\nexists?\none\ninﬁnitely many\nyes\nunique\nsolution\ninﬁnitely many\nsolutions\nno\nno\nsolutions\nno\nsolutions\n",
    "The dimension on the top of the table is the simpler one.",
    "When we perform\nGauss’s Method on a linear system, ignoring the constants on the right side and\nso paying attention only to the coeﬃcients on the left-hand side, we either end\nwith every variable leading some row or else we ﬁnd some variable that does not\nlead a row, that is, we ﬁnd some variable that is free.",
    "(We formalize “ignoring\nthe constants on the right” by considering the associated homogeneous system.)\n",
    "A notable special case is systems having the same number of equations as\nunknowns.",
    "Such a system will have a solution, and that solution will be unique,\nif and only if it reduces to an echelon form system where every variable leads its\nrow (since there are the same number of variables as rows), which will happen if\nand only if the associated homogeneous system has a unique solution.\n",
    "3.11 Deﬁnition A square matrix is nonsingular if it is the matrix of coeﬃcients\nof a homogeneous system with a unique solution.",
    "It is singular otherwise, that\nis, if it is the matrix of coeﬃcients of a homogeneous system with inﬁnitely many\nsolutions.\n\n",
    "Section I. Solving Linear Systems\n31\n3.12 Example",
    "The ﬁrst of these matrices is nonsingular while the second is\nsingular\n \n1\n2\n3\n4\n!\n \n1\n2\n3\n6\n!\n",
    "because the ﬁrst of these homogeneous systems has a unique solution while the\nsecond has inﬁnitely many solutions.\n",
    "x + 2y = 0\n3x + 4y = 0\nx + 2y = 0\n3x + 6y",
    "= 0\nWe have made the distinction in the deﬁnition because a system with the same\nnumber of equations as variables behaves in one of two ways, depending on\nwhether its matrix of coeﬃcients is nonsingular or singular.",
    "Where the matrix\nof coeﬃcients is nonsingular the system has a unique solution for any constants\non the right side: for instance, Gauss’s Method shows that this system\nx + 2y = a\n3x +",
    "4y = b\nhas the unique solution x = b−2a and y = (3a−b)/2.",
    "On the other hand, where\nthe matrix of coeﬃcients is singular the system never has a unique solution — it\nhas either no solutions or else has inﬁnitely many, as with these.\n",
    "x + 2y = 1\n3x + 6y = 2\nx + 2y = 1\n3x + 6y",
    "= 3\nThe deﬁnition uses the word ‘singular’ because it means “departing from\ngeneral expectation.”",
    "People often, naively, expect that systems with the same\nnumber of variables as equations will have a unique solution.",
    "Thus, we can think\nof the word as connoting “troublesome,” or at least “not ideal.”",
    "(That ‘singular’\napplies to those systems that never have exactly one solution is ironic but it is\nthe standard term.)\n",
    "3.13 Example The systems from Example 3.3, Example 3.4, and Example 3.8\neach have an associated homogeneous system with a unique solution.",
    "Thus these\nmatrices are nonsingular.\n \n",
    "3\n4\n2\n−1\n!\n\n\n\n3\n2\n1\n6\n−4\n0\n0\n1\n1\n\n\n\n\n\n\n1\n2\n−1\n2\n4\n0\n0\n1\n−3\n\n\n\n",
    "The Chemistry problem from Example 3.5 is a homogeneous system with more\n\n32\nChapter One.",
    "Linear Systems\nthan one solution so its matrix is singular.\n",
    "\n\n\n\n\n7\n0\n−7\n0\n8\n1\n−5\n−2\n0\n1\n−3\n0\n0\n3\n−6\n−1\n\n\n\n\n\nThe table above has two dimensions.",
    "We have considered the one on top: we\ncan tell into which column a given linear system goes solely by considering the\nsystem’s left-hand side; the constants on the right-hand side play no role in this.\n",
    "The table’s other dimension, determining whether a particular solution exists,\nis tougher.",
    "Consider these two systems with the same left side but diﬀerent\nright sides.\n",
    "3x +",
    "2y = 5\n3x + 2y = 5\n3x + 2y = 5\n3x + 2y = 4\nThe ﬁrst has a solution while the second does not, so here the constants on the\nright side decide if the system has a solution.",
    "We could conjecture that the left\nside of a linear system determines the number of solutions while the right side\ndetermines if solutions exist but that guess is not correct.",
    "Compare these two,\nwith the same right sides but diﬀerent left sides.\n",
    "3x +",
    "2y = 5\n4x + 2y = 4\n3x + 2y = 5\n3x + 2y = 4\nThe ﬁrst has a solution but the second does not.",
    "Thus the constants on the\nright side of a system don’t alone determine whether a solution exists.",
    "Rather,\nthat depends on some interaction between the left and right.\n",
    "For some intuition about that interaction, consider this system with one of\nthe coeﬃcients left unspeciﬁed, as the variable c.\nx + 2y + 3z = 1\nx + y + z = 1\ncx + 3y + 4z = 0\n",
    "If c = 2 then this system has no solution because the left-hand side has the\nthird row as the sum of the ﬁrst two, while the right-hand does not.",
    "If c ̸= 2\nthen this system has a unique solution (try it with c = 1).",
    "For a system to\nhave a solution, if one row of the matrix of coeﬃcients on the left is a linear\ncombination of other rows then on the right the constant from that row must be\nthe same combination of constants from the same rows.\n",
    "More intuition about the interaction comes from studying linear combinations.\n",
    "That will be our focus in the second chapter, after we ﬁnish the study of Gauss’s\nMethod itself in the rest of this chapter.\n\n",
    "Section I. Solving Linear Systems\n33\nExercises\n3.14 Solve this system.",
    "Then solve the associated homogeneous system.\n",
    "x + y −2z =\n0\nx −y\n= −3\n3x −y −2z = −6\n2y −2z =\n3\n✓3.15 Solve each system.",
    "Express the solution set using vectors.",
    "Identify a particular\nsolution and the solution set of the homogeneous system.\n",
    "(a) 3x + 6y",
    "= 18\nx + 2y = 6\n(b) x",
    "+ y =\n1\nx −y = −1\n(c)\nx1\n+ x3 = 4\nx1 −x2 + 2x3 = 5\n4x1",
    "−x2 + 5x3 = 17\n(d) 2a +",
    "b −c = 2\n2a\n+ c = 3\na −b\n= 0\n(e)\nx + 2y −z\n= 3\n2x + y\n+ w = 4\nx −y + z + w = 1\n(f)\nx\n+ z + w = 4\n2x + y\n−w = 2\n3x + y + z\n= 7\n3.16 Solve each system, giving the solution set in vector notation.\n",
    "Identify a\nparticular solution and the solution of the homogeneous system.\n",
    "(a) 2x +",
    "y −z",
    "=",
    "1\n4x −y\n= 3\n(b) x\n−z\n= 1\ny + 2z −w = 3\nx + 2y + 3z −w = 7\n(c)\nx −\ny + z\n= 0\ny\n+ w = 0\n3x −2y + 3z + w = 0\n−y\n−w = 0\n(d)\na + 2b + 3c + d −e = 1\n3a −b",
    "+ c",
    "+ d",
    "+ e = 3\n✓3.17 For the system\n2x −y\n−w =\n3\ny + z + 2w =\n2\nx −2y −z\n= −1\nwhich of these can be used as the particular solution part of some general solu-\ntion?\n(a)\n\n\n\n\n0\n−3\n5\n0\n\n",
    "\n\n\n(b)\n\n\n\n\n2\n1\n1\n0\n\n\n\n\n(c)\n\n\n\n\n−1\n−4\n8\n−1\n\n\n\n\n✓3.18 Lemma 3.7 says that we can use any particular solution for ⃗p.",
    "Find, if possible,\na general solution to this system\nx −y\n+ w = 4\n2x + 3y −z\n= 0\ny + z",
    "+ w = 4\nthat uses the given vector as its particular solution.\n",
    "(a)\n\n\n\n\n0\n0\n0\n4\n\n\n\n\n(b)\n\n\n\n\n−5\n1\n−7\n10\n\n\n\n\n(c)\n\n\n\n\n2\n−1\n1\n1\n\n\n\n\n3.19 One is nonsingular while the other is singular.",
    "Which is which?\n(a)\n\u00121\n3\n4\n−12\n\u0013\n(b)\n\u00121\n3\n4\n12\n\u0013\n✓3.20 Singular or nonsingular?\n\n34\nChapter One.",
    "Linear Systems\n(a)\n\u00121\n2\n1\n3\n\u0013\n(b)\n\u0012 1\n2\n−3\n−6\n\u0013\n(c)\n\u00121\n2\n1\n1\n3\n1\n\u0013\n(d)\n\n\n1\n2\n1\n1\n1\n3\n3\n4\n7\n\n\n(e)\n\n\n2\n2\n1\n1\n0\n5\n−1\n1\n4\n\n\n✓3.21 Is the given vector in the set generated by the given set?\n(a)\n\u00122\n3\n\u0013\n, {\n\u00121\n4\n\u0013\n,\n\u00121\n5\n\u0013\n}\n(b)\n\n\n−1\n0\n1\n\n, {\n\n\n2\n1\n0\n\n,\n\n\n1\n0\n1\n\n}\n(c)\n\n\n1\n3\n0\n\n, {\n\n\n1\n0\n4\n\n,\n\n\n2\n1\n5\n\n,\n\n\n3\n3\n0\n\n,\n\n\n4\n2\n1\n\n}\n(d)\n\n\n\n\n1\n0\n1\n1\n\n\n\n, {\n\n\n\n\n2\n1\n0\n1\n\n\n\n,\n\n\n\n\n3\n0\n0\n2\n\n\n\n}\n3.22 Prove that any linear system with a nonsingular matrix of coeﬃcients has a\nsolution, and that the solution is unique.\n",
    "3.23 In the proof of Lemma 3.6, what happens if there are no non-0 = 0 equations?\n",
    "✓3.24 Prove that if ⃗s and ⃗t satisfy a homogeneous system then so do these vec-\ntors.\n",
    "(a) ⃗s +⃗t\n(b) 3⃗s\n(c) k⃗s + m⃗t for k, m ∈R\nWhat’s wrong with this argument: “These three show that if a homogeneous system\nhas one solution then it has many solutions — any multiple of a solution is another\nsolution, and any sum of solutions is a solution also — so there are no homogeneous\nsystems with exactly one solution.”?\n",
    "3.25 Prove that if a system with only rational coeﬃcients and constants has a\nsolution then it has at least one all-rational solution.",
    "Must it have inﬁnitely many?\n\nSection II.",
    "Linear Geometry\n35\nII\nLinear Geometry\nIf you have seen the elements of vectors then this section is an optional\nreview.",
    "However, later work will refer to this material so if this is not a\nreview then it is not optional.\n",
    "In the ﬁrst section we had to do a bit of work to show that there are only\nthree types of solution sets — singleton, empty, and inﬁnite.",
    "But this is easy to\nsee geometrically in the case of systems with two equations and two unknowns.\n",
    "Draw each two-unknowns equation as a line in the plane and then the two lines\ncould have a unique intersection, be parallel, or be the same line.\n",
    "Unique solution\n3x +",
    "2y =\n7\nx −y = −1\nNo solutions\n3x + 2y = 7\n3x + 2y = 4\nInﬁnitely many\nsolutions\n3x + 2y = 7\n6x + 4y = 14\n",
    "These pictures aren’t a short way to prove the results from the prior section,\nbecause those results apply to linear systems with any number of variables.",
    "But\nthey do provide a visual insight, another way of seeing those results.\n",
    "This section develops what we need to express our results geometrically.",
    "In\nparticular, while the two-dimensional case is familiar, to extend to systems with\nmore than two unknowns we shall need some higher-dimensional geometry.\n",
    "II.1\nVectors in Space\n“Higher-dimensional geometry” sounds exotic.",
    "It is exotic — interesting and\neye-opening.",
    "But it isn’t distant or unreachable.\n",
    "We begin by deﬁning one-dimensional space to be R. To see that the deﬁnition\nis reasonable, picture a one-dimensional space\nand pick a point to label 0 and another to label 1.\n0\n1\nNow, with a scale and a direction, we have a correspondence with R. For instance,\n\n36\nChapter One.",
    "Linear Systems\nto ﬁnd the point matching +2.17, start at 0 and head in the direction of 1, and\ngo 2.17 times as far.\n",
    "The basic idea here, combining magnitude with direction, is the key to\nextending to higher dimensions.\n",
    "An object in an Rn that is comprised of a magnitude and a direction is a\nvector (we use the same word as in the prior section because we shall show\nbelow how to describe such an object with a column vector).",
    "We can draw a\nvector as having some length and pointing in some direction.\n",
    "There is a subtlety involved in the deﬁnition of a vector as consisting of a\nmagnitude and a direction — these\nare equal, even though they start in diﬀerent places They are equal because they\nhave equal lengths and equal directions.",
    "Again: those vectors are not just alike,\nthey are equal.\n",
    "How can things that are in diﬀerent places be equal?",
    "Think of a vector as\nrepresenting a displacement (the word ‘vector’ is Latin for “carrier” or “traveler”).\n",
    "These two squares undergo displacements that are equal despite that they start\nin diﬀerent places.\n",
    "When we want to emphasize this property vectors have of not being anchored\nwe refer to them as free vectors.",
    "Thus, these free vectors are equal, as each is a\ndisplacement of one over and two up.\n",
    "More generally, vectors in the plane are the same if and only if they have the\nsame change in ﬁrst components and the same change in second components: the\nvector extending from (a1, a2) to (b1, b2) equals the vector from (c1, c2) to\n(d1, d2)",
    "if and only if b1 −a1 = d1 −c1 and b2 −a2 = d2 −c2.\n",
    "Saying ‘the vector that, were it to start at (a1, a2), would extend to (b1, b2)’\nwould be unwieldy.",
    "We instead describe that vector as\n \nb1 −a1\nb2 −a2\n!\n\nSection II.",
    "Linear Geometry\n37\nso that we represent the ‘one over and two up’ arrows shown above in this way.\n \n",
    "1\n2\n!\n",
    "We often draw the arrow as starting at the origin, and we then say it is in the\ncanonical position (or natural position or standard position).",
    "When\n⃗v =\n \nv1\nv2\n!\nis in canonical position then it extends from the origin to the endpoint (v1, v2).\n",
    "We will typically say “the point\n \n1\n2\n!\n”\nrather than “the endpoint of the canonical position of” that vector.",
    "Thus, we\nwill call each of these R2.\n",
    "{(x1, x2) | x1, x2 ∈R}\n{\n \nx1\nx2\n!\n",
    "| x1, x2 ∈R}\nIn the prior section we deﬁned vectors and vector operations with an algebraic\nmotivation;\nr ·\n \nv1\nv2\n!\n",
    "=\n \nrv1\nrv2\n!\n \nv1\nv2\n!\n+\n \nw1\nw2\n!\n=\n \nv1 + w1\nv2 + w2\n!\n",
    "we can now understand those operations geometrically.\n",
    "For instance, if ⃗v\nrepresents a displacement then 3⃗v represents a displacement in the same direction\nbut three times as far and −1⃗v represents a displacement of the same distance\nas ⃗v but in the opposite direction.\n",
    "⃗v\n−⃗v\n3⃗v\n",
    "And, where ⃗v and ⃗w represent displacements, ⃗v+⃗w represents those displacements\ncombined.\n",
    "⃗v\n⃗w\n⃗v + ⃗w\n\n38\nChapter One.",
    "Linear Systems\nThe long arrow is the combined displacement in this sense: imagine that you are\nwalking on a ship’s deck.",
    "Suppose that in one minute the ship’s motion gives it\na displacement relative to the sea of ⃗v, and in the same minute your walking\ngives you a displacement relative to the ship’s deck of ⃗w.",
    "Then ⃗v + ⃗w is your\ndisplacement relative to the sea.\n",
    "Another way to understand the vector sum is with the parallelogram rule.\n",
    "Draw the parallelogram formed by the vectors ⃗v and ⃗w.",
    "Then the sum ⃗v + ⃗w\nextends along the diagonal to the far corner.\n",
    "⃗v + ⃗w\n⃗v\n⃗w\nThe above drawings show how vectors and vector operations behave in R2.\n",
    "We can extend to R3, or to even higher-dimensional spaces where we have no\npictures, with the obvious generalization: the free vector that, if it starts at\n(a1, . .",
    ". , an), ends at (b1, . .",
    ".",
    ", bn), is represented by this column.\n",
    "\n\n\nb1 −a1\n...\nbn −an\n\n\n\nVectors are equal if they have the same representation.",
    "We aren’t too careful\nabout distinguishing between a point and the vector whose canonical representa-\ntion ends at that point.\n",
    "Rn = {\n\n\n\nv1\n...\n",
    "vn\n\n\n| v1, . . .",
    ", vn ∈R}\n",
    "And, we do addition and scalar multiplication component-wise.\n",
    "Having considered points, we next turn to lines.",
    "In R2, the line through\n(1, 2) and (3, 1) is comprised of (the endpoints of) the vectors in this set.\n",
    "{\n\u00121\n2\n\u0013\n+ t\n\u0012 2\n−1\n\u0013\n| t ∈R}\nIn the description",
    "the vector that is associated with the parameter t\n \n2\n−1\n!\n=\n \n3\n1\n!\n−\n \n1\n2\n!\n\nSection II.",
    "Linear Geometry\n39\nis the one shown in the picture as having its whole body in the line — it is a\ndirection vector for the line.",
    "Note that points on the line to the left of x",
    "= 1\nare described using negative values of t.\n",
    "In R3, the line through (1, 2, 1) and (0, 3, 2) is the set of (endpoints of) vectors\nof this form\n{\n\n\n1\n2\n1\n\n",
    "+ t ·\n\n\n−1\n1\n1\n\n|",
    "t ∈R}\nx\ny\nz\nand lines in even higher-dimensional spaces work in the same way.\n",
    "In R3, a line uses one parameter so that a particle on that line would be\nfree to move back and forth in one dimension.",
    "A plane involves two parameters.\n",
    "For example, the plane through the points (1, 0, 5), (2, 1, −3), and (−2, 4, 0.5)\nconsists of (endpoints of) the vectors in this set.\n",
    "{\n\n\n\n1\n0\n5\n\n\n+ t\n\n\n\n1\n1\n−8\n\n\n+ s\n\n\n\n−3\n4\n−4.5\n\n\n| t, s ∈R}\nThe column vectors associated with the parameters come from these calculations.\n",
    "\n\n\n1\n1\n−8\n\n\n=\n\n\n\n2\n1\n−3\n\n",
    "\n−\n\n\n\n1\n0\n5\n\n\n\n\n\n\n−3\n4\n−4.5\n\n\n=\n\n\n\n−2\n4\n0.5\n\n\n−\n\n\n\n1\n0\n5\n\n\n\n",
    "As with the line, note that we describe some points in this plane with negative\nt’s or negative s’s or both.\n",
    "Calculus books often describe a plane by using a single linear equation.\n",
    "P = {\n\n\nx\ny\nz\n\n| 2x",
    "+",
    "y + z = 4}\nTo translate from this to the vector description, think of this as a one-equation\n\n40\nChapter One.",
    "Linear Systems\nlinear system and parametrize: x = 2 −y/2 −z/2.\n",
    "P = {\n\n\n2\n0\n0\n\n+ y ·\n\n\n−1/2\n1\n0\n\n+ z ·\n\n\n−1/2\n0\n1\n\n|",
    "y, z ∈R}\nShown in grey are the vectors associated with y and z, oﬀset from the origin\nby 2 units along the x-axis, so that their entire body lies in the plane.",
    "Thus the\nvector sum of the two, shown in black, has its entire body in the plane along\nwith the rest of the parallelogram.\n",
    "Generalizing, a set of the form {⃗p + t1⃗v1 + t2⃗v2 + · · · + tk⃗vk | t1, . . . , tk ∈R}\nwhere ⃗v1, . . .",
    ",⃗vk ∈Rn and k ⩽n is a k-dimensional linear surface (or k-ﬂat).\n",
    "For example, in R4\n{\n\n\n\n\n\n2\nπ\n3\n−0.5\n\n\n\n\n+ t\n\n\n\n\n\n1\n0\n0\n0\n\n\n\n\n| t ∈R}\nis a line,\n{\n\n\n\n\n\n0\n0\n0\n0\n\n\n\n\n",
    "+ t\n\n\n\n\n\n1\n1\n0\n−1\n\n\n\n\n+ s\n\n\n\n\n\n2\n0\n1\n0\n\n\n\n\n| t, s ∈R}\nis a plane, and\n{\n\n\n\n\n\n3\n1\n−2\n0.5\n\n\n\n\n+ r\n\n\n\n\n\n0\n0\n0\n−1\n\n\n\n\n+ s\n\n\n\n\n\n1\n0\n1\n0\n\n\n\n\n",
    "+ t\n\n\n\n\n\n2\n0\n1\n0\n\n\n\n\n| r, s, t ∈R}\nis a three-dimensional linear surface.",
    "Again, the intuition is that a line permits\nmotion in one direction, a plane permits motion in combinations of two directions,\netc.",
    "When the dimension of the linear surface is one less than the dimension of\nthe space, that is, when in Rn we have an (n −1)-ﬂat, the surface is called a\nhyperplane.\n",
    "A description of a linear surface can be misleading about the dimension.",
    "For\nexample, this\nL = {\n\n\n\n\n\n1\n0\n−1\n−2\n\n\n\n\n+ t\n\n\n\n\n\n1\n1\n0\n−1\n\n\n\n\n+ s\n\n\n\n\n\n2\n2\n0\n−2\n\n\n\n\n| t, s ∈R}\n\nSection II.",
    "Linear Geometry\n41\nis a degenerate plane because it is actually a line, since the vectors are multiples\nof each other and we can omit one.\n",
    "L = {\n\n\n\n\n\n1\n0\n−1\n−2\n\n\n\n\n+ r\n\n\n\n\n\n1\n1\n0\n−1\n\n\n\n\n|",
    "r ∈R}\nWe shall see in the Linear Independence section of Chapter Two what relation-\nships among vectors causes the linear surface they generate to be degenerate.\n",
    "We now can restate in geometric terms our conclusions from earlier.",
    "First,\nthe solution set of a linear system with n unknowns is a linear surface in Rn.\n",
    "Speciﬁcally, it is a k-dimensional linear surface, where k is the number of free\nvariables in an echelon form version of the system.",
    "For instance, in the single\nequation case the solution set is an n −1-dimensional hyperplane in Rn, where\nn ⩾1.",
    "Second, the solution set of a homogeneous linear system is a linear\nsurface passing through the origin.",
    "Finally, we can view the general solution\nset of any linear system as being the solution set of its associated homogeneous\nsystem oﬀset from the origin by a vector, namely by any particular solution.\n",
    "Exercises\n✓1.1 Find the canonical name for each vector.\n",
    "(a) the vector from (2, 1) to (4, 2) in R2\n(b) the vector from (3, 3) to (2, 5) in R2\n(c) the vector from (1, 0, 6) to (5, 0, 3) in R3\n(d) the vector from (6, 8, 8) to (6, 8, 8) in R3\n✓1.2 Decide if the two vectors are equal.\n",
    "(a) the vector from (5, 3) to (6, 2) and the vector from (1, −2) to (1, 1)\n(b) the vector from (2, 1, 1) to (3, 0, 4) and the vector from (5, 1, 4) to (6, 0, 7)\n✓1.3 Does (1, 0, 2, 1) lie on the line through (−2, 1, 1, 0) and (5, 10, −1, 4)?\n",
    "✓1.4\n(a) Describe the plane through (1, 1, 5, −1), (2, 2, 2, 0), and (3, 1, 0, 4).\n",
    "(b) Is the origin in that plane?\n1.5 Give a vector description of each.\n",
    "(a) the plane subset of R3 with equation x −2y + z = 4\n(b) the plane in R3 with equation 2x + y + 4z = −1\n(c) the hyperplane subset of R4 with equation x + y + z + w = 10\n1.6 Describe the plane that contains this point and line.\n",
    "\n\n2\n0\n3\n\n\n{\n\n\n−1\n0\n−4\n\n+\n\n\n1\n1\n2\n\n",
    "t | t ∈R}\n✓1.7 Intersect these planes.\n",
    "{\n\n\n1\n1\n1\n\n",
    "t +\n\n\n0\n1\n3\n\ns | t, s ∈R}\n{\n\n\n1\n1\n0\n\n",
    "+\n\n\n0\n3\n0\n\nk +\n\n\n2\n0\n4\n\nm | k, m ∈R}\n\n42\nChapter One.",
    "Linear Systems\n✓1.8 Intersect each pair, if possible.\n",
    "(a) {\n\n\n1\n1\n2\n\n+ t\n\n\n0\n1\n1\n\n|",
    "t ∈R}, {\n\n\n1\n3\n−2\n\n",
    "+ s\n\n\n0\n1\n2\n\n| s ∈R}\n(b) {\n\n\n2\n0\n1\n\n+ t\n\n\n1\n1\n−1\n\n",
    "| t ∈R}, {s\n\n\n0\n1\n2\n\n+ w\n\n\n0\n4\n1\n\n| s, w ∈R}\n1.9 How should we deﬁne R0?\n?",
    "1.10",
    "[Math. Mag., Jan. 1957]",
    "A person traveling eastward at a rate of 3 miles per\nhour ﬁnds that the wind appears to blow directly from the north.",
    "On doubling his\nspeed it appears to come from the north east.",
    "What was the wind’s velocity?\n1.11 Euclid describes a plane as “a surface which lies evenly with the straight lines\non itself”.",
    "Commentators such as Heron have interpreted this to mean, “(A plane\nsurface is) such that, if a straight line pass through two points on it, the line\ncoincides wholly with it at every spot, all ways”.",
    "(Translations from [Heath], pp.\n171-172.)",
    "Do planes, as described in this section, have that property?",
    "Does this\ndescription adequately deﬁne planes?\nII.2\nLength and Angle Measures\nWe’ve translated the ﬁrst section’s results about solution sets into geometric\nterms, to better understand those sets.",
    "But we must be careful not to be misled\nby our own terms — labeling subsets of Rk of the forms {⃗p + t⃗v | t ∈R} and\n{⃗p + t⃗v + s⃗w | t, s ∈R} as ‘lines’ and ‘planes’ doesn’t make them act like the\nlines and planes of our past experience.",
    "Rather, we must ensure that the names\nsuit the sets.",
    "While we can’t prove that the sets satisfy our intuition — we\ncan’t prove anything about intuition — in this subsection we’ll observe that a\nresult familiar from R2 and R3, when generalized to arbitrary Rn, supports the\nidea that a line is straight and a plane is ﬂat.",
    "Speciﬁcally, we’ll see how to do\nEuclidean geometry in a ‘plane’ by giving a deﬁnition of the angle between two\nRn vectors, in the plane that they generate.\n",
    "2.1 Deﬁnition The length of a vector ⃗v ∈Rn is the square root of the sum of the\nsquares of its components.\n",
    "|⃗v | =\nq\nv2\n1 + · · · + v2n\n2.2 Remark",
    "This is a natural generalization of the Pythagorean Theorem.",
    "A\nclassic motivating discussion is in [Polya].\n\nSection II.",
    "Linear Geometry\n43\nFor any nonzero ⃗v, the vector ⃗v/|⃗v| has length one.",
    "We say that the second\nnormalizes ⃗v to length one.\n",
    "We can use that to get a formula for the angle between two vectors.",
    "Consider\ntwo vectors in R3 where neither is a multiple of the other\n⃗v\n⃗u\n(the special case of multiples will turn out below not to be an exception).",
    "They\ndetermine a two-dimensional plane — for instance, put them in canonical position\nand take the plane formed by the origin and the endpoints.",
    "In that plane consider\nthe triangle with sides ⃗u, ⃗v, and ⃗u −⃗v.\n",
    "Apply the Law of Cosines: |⃗u −⃗v |2 = |⃗u |2 + |⃗v |2 −2 |⃗u | |⃗v | cos θ where θ is the\nangle between the vectors.",
    "The left side gives\n(u1 −v1)2 + (u2 −v2)2 + (u3 −v3)2\n= (u2\n1 −2u1v1 + v2\n1)",
    "+",
    "(u2\n2 −2u2v2 + v2\n2) + (u2\n3 −2u3v3 + v2\n3)\nwhile the right side gives this.\n",
    "(u2\n1 + u2\n2 + u2\n3)",
    "+ (v2\n1 + v2\n2 + v2\n3) −2 |⃗u | |⃗v | cos θ\nCanceling squares u2\n1, . . .",
    ", v2\n3 and dividing by 2 gives a formula for the angle.\n",
    "θ = arccos( u1v1 + u2v2 + u3v3\n|⃗u | |⃗v |\n)\n",
    "In higher dimensions we cannot draw pictures as above but we can instead\nmake the argument analytically.",
    "First, the form of the numerator is clear; it\ncomes from the middle terms of (ui −vi)2.\n",
    "2.3 Deﬁnition The dot product (or inner product or scalar product) of two\nn-component real vectors is the linear combination of their components.\n",
    "⃗u •⃗v = u1v1 + u2v2 + · · ·",
    "+ unvn\n\n44\nChapter One.",
    "Linear Systems\nNote that the dot product of two vectors is a real number, not a vector, and\nthat the dot product is only deﬁned if the two vectors have the same number\nof components.\n",
    "Note also that dot product is related to length: ⃗u • ⃗u =\nu1u1 + · · ·",
    "+ unun = |⃗u |2.\n2.4 Remark Some authors require that the ﬁrst vector be a row vector and that\nthe second vector be a column vector.",
    "We shall not be that strict and will allow\nthe dot product operation between two column vectors.\n",
    "Still reasoning analytically but guided by the pictures, we use the next\ntheorem to argue that the triangle formed by the line segments making the\nbodies of ⃗u, ⃗v, and ⃗u +⃗v in Rn lies in the planar subset of Rn generated by ⃗u\nand ⃗v (see the ﬁgure below).\n",
    "2.5 Theorem (Triangle Inequality)",
    "For any ⃗u,⃗v ∈Rn,\n|⃗u +⃗v | ⩽|⃗u | + |⃗v |\nwith equality if and only if one of the vectors is a nonnegative scalar multiple of\nthe other one.\n",
    "This is the source of the familiar saying, “The shortest distance between two\npoints is in a straight line.”\n⃗u\n⃗v\n⃗u +⃗v\nstart\nﬁnish\nProof (We’ll use some algebraic properties of dot product that we have not yet\nchecked, for instance that ⃗u • (⃗a + ⃗b) = ⃗u • ⃗a + ⃗u • ⃗b and that ⃗u •⃗v = ⃗v • ⃗u.",
    "See\nExercise 18.)",
    "Since all the numbers are positive, the inequality holds if and only\nif its square holds.\n",
    "|⃗u +⃗v |2 ⩽( |⃗u | + |⃗v | )2\n( ⃗u +⃗v ) • ( ⃗u +⃗v )",
    "⩽|⃗u |2 + 2 |⃗u | |⃗v | + |⃗v |2\n⃗u • ⃗u + ⃗u •⃗v +⃗v • ⃗u +⃗v •⃗v ⩽⃗u • ⃗u + 2 |⃗u | |⃗v | +⃗v •⃗v\n2 ⃗u •⃗v ⩽2 |⃗u | |⃗v |\nThat, in turn, holds if and only if the relationship obtained by multiplying both\nsides by the nonnegative numbers |⃗u | and |⃗v |\n2 ( |⃗v | ⃗u ) • ( |⃗u |⃗v ) ⩽2 |⃗u |2 |⃗v |2\n\nSection II.",
    "Linear Geometry\n45\nand rewriting\n0 ⩽|⃗u |2 |⃗v |2 −2 ( |⃗v | ⃗u ) • ( |⃗u |⃗v )",
    "+ |⃗u |2 |⃗v |2\nis true.",
    "But factoring shows that it is true\n0",
    "⩽( |⃗u |⃗v −|⃗v | ⃗u ) •",
    "( |⃗u |⃗v −|⃗v | ⃗u )\nsince it only says that the square of the length of the vector |⃗u |⃗v −|⃗v | ⃗u is not\nnegative.",
    "As for equality, it holds when, and only when, |⃗u |⃗v −|⃗v | ⃗u is ⃗0.",
    "The\ncheck that |⃗u |⃗v = |⃗v | ⃗u if and only if one vector is a nonnegative real scalar\nmultiple of the other is easy.\n",
    "QED\n",
    "This result supports the intuition that even in higher-dimensional spaces,\nlines are straight and planes are ﬂat.",
    "We can easily check from the deﬁnition\nthat linear surfaces have the property that for any two points in that surface,\nthe line segment between them is contained in that surface.",
    "But if the linear\nsurface were not ﬂat then that would allow for a shortcut.\n",
    "P\nQ\nBecause the Triangle Inequality says that in any Rn the shortest cut between\ntwo endpoints is simply the line segment connecting them, linear surfaces have\nno bends.\n",
    "Back to the deﬁnition of angle measure.",
    "The heart of the Triangle Inequality’s\nproof is the ⃗u •⃗v ⩽|⃗u | |⃗v | line.",
    "We might wonder if some pairs of vectors satisfy\nthe inequality in this way: while ⃗u • ⃗v is a large number, with absolute value\nbigger than the right-hand side, it is a negative large number.",
    "The next result\nsays that does not happen.\n",
    "2.6 Corollary (Cauchy-Schwarz Inequality)",
    "For any ⃗u,⃗v ∈Rn,\n| ⃗u •⃗v | ⩽| ⃗u | |⃗v |\nwith equality if and only if one vector is a scalar multiple of the other.\n",
    "Proof The Triangle Inequality’s proof shows that ⃗u • ⃗v ⩽|⃗u | |⃗v | so if ⃗u • ⃗v is\npositive or zero then we are done.",
    "If ⃗u •⃗v is negative then this holds.\n",
    "| ⃗u •⃗v | = −( ⃗u •⃗v ) = (−⃗u ) •⃗v ⩽|−⃗u | |⃗v | = |⃗u | |⃗v |\n",
    "The equality condition is Exercise 19.\n",
    "QED\nThe Cauchy-Schwarz inequality assures us that the next deﬁnition makes\nsense because the fraction has absolute value less than or equal to one.\n\n",
    "46\nChapter One.",
    "Linear Systems\n2.7 Deﬁnition",
    "The angle between two nonzero vectors ⃗u,⃗v ∈Rn is\nθ = arccos( ⃗u •⃗v\n|⃗u | |⃗v | )\n",
    "(if either is the zero vector then we take the angle to be a right angle).\n",
    "2.8 Corollary Vectors from Rn are orthogonal, that is, perpendicular, if and only\nif their dot product is zero.",
    "They are parallel if and only if their dot product\nequals the product of their lengths.\n",
    "2.9 Example These vectors are orthogonal.\n \n",
    "1\n−1\n!\n•\n \n1\n1\n!\n= 0\nWe’ve drawn the arrows away from canonical position but nevertheless the\nvectors are orthogonal.\n",
    "2.10 Example The R3 angle formula given at the start of this subsection is a\nspecial case of the deﬁnition.",
    "Between these two\n\n\n0\n3\n2\n\n\n\n\n1\n1\n0\n\n\nthe angle is\narccos(\n(1)(0) + (1)(3) + (0)(2)\n√\n12 + 12 + 02√\n02 + 32 + 22 ) = arccos(\n3\n√\n2\n√\n13\n)\napproximately 0.94 radians.",
    "Notice that these vectors are not orthogonal.",
    "Al-\nthough the yz-plane may appear to be perpendicular to the xy-plane, in fact\nthe two planes are that way only in the weak sense that there are vectors in each\northogonal to all vectors in the other.",
    "Not every vector in each is orthogonal to\nall vectors in the other.\n",
    "Exercises\n✓2.11 Find the length of each vector.\n\nSection II.",
    "Linear Geometry\n47\n(a)\n\u00123\n1\n\u0013\n(b)\n\u0012−1\n2\n\u0013\n(c)\n\n\n4\n1\n1\n\n\n(d)\n\n\n0\n0\n0\n\n\n(e)\n\n\n\n\n1\n−1\n1\n0\n\n\n\n\n✓2.12 Find the angle between each two, if it is deﬁned.\n",
    "(a)\n\u00121\n2\n\u0013\n,\n\u00121\n4\n\u0013\n(b)\n\n\n1\n2\n0\n\n,\n\n\n0\n4\n1\n\n\n(c)\n\u00121\n2\n\u0013\n,\n\n\n1\n4\n−1\n\n\n✓2.13 [Ohanian] During maneuvers preceding the Battle of Jutland, the British battle\ncruiser Lion moved as follows (in nautical miles): 1.2 miles north, 6.1 miles 38\ndegrees east of south, 4.0 miles at 89 degrees east of north, and 6.5 miles at 31\ndegrees east of north.",
    "Find the distance between starting and ending positions.\n",
    "(Ignore the earth’s curvature.)\n",
    "2.14 Find k so that these two vectors are perpendicular.\n",
    "\u0012k\n1\n\u0013\n\u00124\n3\n\u0013\n2.15 Describe the set of vectors in R3 orthogonal to the one with entries 1, 3, and −1.\n",
    "✓2.16\n(a) Find the angle between the diagonal of the unit square in R2 and any one\nof the axes.\n",
    "(b) Find the angle between the diagonal of the unit cube in R3 and one of the\naxes.\n",
    "(c) Find the angle between the diagonal of the unit cube in Rn and one of the\naxes.\n",
    "(d)",
    "What is the limit, as n goes to ∞, of the angle between the diagonal of the\nunit cube in Rn and any one of the axes?\n2.17 Is any vector perpendicular to itself?\n",
    "2.18 Describe the algebraic properties of dot product.\n",
    "(a) Is it right-distributive over addition: (⃗u +⃗v) • ⃗w = ⃗u • ⃗w +⃗v • ⃗w?\n(b) Is it left-distributive (over addition)?\n(c) Does it commute?\n(d) Associate?\n(e) How does it interact with scalar multiplication?\n",
    "As always, you must back any assertion with a suitable argument.\n",
    "2.19 Verify the equality condition in Corollary 2.6, the Cauchy-Schwarz Inequal-\nity.\n",
    "(a) Show that if ⃗u is a negative scalar multiple of ⃗v then ⃗u •⃗v and ⃗v • ⃗u are less\nthan or equal to zero.\n",
    "(b) Show that |⃗u •⃗v| = |⃗u | |⃗v | if and only if one vector is a scalar multiple of the\nother.\n",
    "2.20 Suppose that ⃗u •⃗v = ⃗u • ⃗w and ⃗u ̸= ⃗0.",
    "Must ⃗v = ⃗w?\n✓2.21 Does any vector have length zero except a zero vector?",
    "(If “yes”, produce an\nexample.",
    "If “no”, prove it.)\n✓2.22 Find the midpoint of the line segment connecting (x1, y1) with (x2, y2) in R2.\n",
    "Generalize to Rn.\n\n48\nChapter One.",
    "Linear Systems\n2.23 Show that if ⃗v ̸= ⃗0 then ⃗v/|⃗v | has length one.",
    "What if ⃗v = ⃗0?\n2.24 Show that if r ⩾0 then r⃗v is r times as long as ⃗v.",
    "What if r < 0?\n✓2.25",
    "A vector ⃗v ∈Rn of length one is a unit vector.",
    "Show that the dot product\nof two unit vectors has absolute value less than or equal to one.",
    "Can ‘less than’\nhappen?",
    "Can ‘equal to’?\n2.26 When a plane does not pass through the origin, performing operations on\nvectors whose bodies lie in it is more complicated than when the plane does pass\nthrough the origin.",
    "Consider the picture in this subsection of the plane\n{\n\n\n2\n0\n0\n\n+\n\n\n−0.5\n1\n0\n\ny +\n\n\n−0.5\n0\n1\n\nz | y, z ∈R}\nand the three vectors with endpoints (2, 0, 0), (1.5, 1, 0), and (1.5, 0, 1).\n",
    "(a) Redraw the picture, including the vector starting at (2, 0, 0) whose body is\nin the plane, and that is twice as long as the vector shown in the plane whose\nendpoint is (1.5, 1, 0).",
    "The endpoint of this vector is not (3, 2, 0); what is it?\n(b) Redraw the picture, including the parallelogram in the plane that shows the\nsum of the vectors ending at (1.5, 0, 1) and (1.5, 1, 0).",
    "The endpoint of the sum,\non the diagonal, is not (3, 1, 1); what is it?\n2.27 Show that the line segments (a1, a2)(b1, b2) and (c1, c2)(d1, d2) have the same\nlengths and slopes if b1 −a1 = d1 −c1 and b2 −a2 = d2 −c2.",
    "Is that only if?\n2.28 Is |⃗u1 + · · · + ⃗un| ⩽|⃗u1| + · · · + |⃗un|?",
    "If it is true then it would generalize the\nTriangle Inequality.\n",
    "2.29 What is the ratio between the sides in the Cauchy-Schwarz inequality?\n2.30 Why is the zero vector deﬁned to be perpendicular to every vector?\n2.31 Describe the angle between two vectors in R1.\n",
    "2.32 Give a simple necessary and suﬃcient condition to determine whether the angle\nbetween two vectors is acute, right, or obtuse.\n",
    "2.33 Generalize to Rn the converse of the Pythagorean Theorem, that if ⃗u and ⃗v are\nperpendicular then |⃗u +⃗v |2 = |⃗u |2 + |⃗v |2.\n2.34 Show that |⃗u | = |⃗v | if and only if ⃗u +⃗v and ⃗u −⃗v are perpendicular.",
    "Give an\nexample in R2.\n",
    "2.35 Show that if a vector is perpendicular to each of two others then it is perpen-\ndicular to each vector in the plane they generate.",
    "(Remark.",
    "They could generate a\ndegenerate plane — a line or a point — but the statement remains true.)\n",
    "2.36 Prove that, where ⃗u,⃗v ∈Rn are nonzero vectors, the vector\n⃗u\n|⃗u | + ⃗v\n|⃗v |\nbisects the angle between them.",
    "Illustrate in R2.\n",
    "2.37 Verify that the deﬁnition of angle is dimensionally correct: (1) if k > 0",
    "then the\ncosine of the angle between k⃗u and ⃗v equals the cosine of the angle between ⃗u and\n⃗v, and (2) if k < 0 then the cosine of the angle between k⃗u and ⃗v is the negative of\nthe cosine of the angle between ⃗u and ⃗v.\n",
    "✓2.38 Show that the inner product operation is linear: for ⃗u,⃗v, ⃗w ∈Rn and k, m ∈R,\n⃗u • (k⃗v + m⃗w) = k(⃗u •⃗v)",
    "+",
    "m(⃗u • ⃗w).\n\n",
    "Section II.",
    "Linear Geometry\n49\n?",
    "2.39",
    "[Cleary] Astrologers claim to be able to recognize trends in personality and\nfortune that depend on an individual’s birthday by incorporating where the stars\nwere 2000 years ago.",
    "Suppose that instead of star-gazers coming up with stuﬀ, math\nteachers who like linear algebra (we’ll call them vectologers) had come up with a\nsimilar system as follows: Consider your birthday as a row vector (month day).\n",
    "For instance, I was born on July 12 so my vector would be (7 12).",
    "Vectologers\nhave made the rule that how well individuals get along with each other depends\non the angle between vectors.",
    "The smaller the angle, the more harmonious the\nrelationship.\n",
    "(a) Find the angle between your vector and mine, in radians.\n",
    "(b) Would you get along better with me, or with a professor born on September 19?\n(c) For maximum harmony in a relationship, when should the other person be\nborn?\n",
    "(d) Is there a person with whom you have a “worst case” relationship, i.e., your\nvector and theirs are orthogonal?",
    "If so, what are the birthdate(s) for such people?\n",
    "If not, explain why not.\n?",
    "2.40",
    "[Am.",
    "Math.",
    "Mon., Feb. 1933]",
    "A ship is sailing with speed and direction ⃗v1; the\nwind blows apparently (judging by the vane on the mast) in the direction of a\nvector ⃗a; on changing the direction and speed of the ship from ⃗v1 to ⃗v2 the apparent\nwind is in the direction of a vector ⃗b.\n",
    "Find the vector velocity of the wind.\n",
    "2.41 Verify the Cauchy-Schwarz inequality by ﬁrst proving Lagrange’s identity:\n X\n1⩽j⩽n\najbj\n!2\n=\n X\n1⩽j⩽n\na2\nj\n!  ",
    "X\n1⩽j⩽n\nb2\nj\n!\n−\nX\n1⩽k<j⩽n\n(akbj −ajbk)2\nand then noting that the ﬁnal term is positive.",
    "This result is an improvement over\nCauchy-Schwarz because it gives a formula for the diﬀerence between the two sides.\n",
    "Interpret that diﬀerence in R2.\n\n",
    "50\nChapter One.",
    "Linear Systems\nIII\nReduced Echelon Form\nAfter developing the mechanics of Gauss’s Method, we observed that it can be\ndone in more than one way.",
    "For example, from this matrix\n \n2\n2\n4\n3\n!\nwe could derive any of these three echelon form matrices.\n \n2\n2\n0\n−1\n!\n \n1\n1\n0\n−1\n!\n \n2\n0\n0\n−1\n!\n",
    "The ﬁrst results from −2ρ1 + ρ2.",
    "The second comes from doing (1/2)ρ1 and\nthen −4ρ1",
    "+ρ2.",
    "The third comes from −2ρ1 +ρ2 followed by 2ρ2 +ρ1 (after the\nﬁrst row combination the matrix is already in echelon form but it is nonetheless\na legal row operation).\n",
    "In this chapter’s ﬁrst section we noted that this raises questions.",
    "Will any two\nechelon form versions of a linear system have the same number of free variables?\n",
    "If yes, will the two have exactly the same free variables?",
    "In this section we will\ngive a way to decide if one linear system can be derived from another by row\noperations.",
    "The answers to both questions, both “yes,” will follow from that.\n",
    "III.1\nGauss-Jordan Reduction\nHere is an extension of Gauss’s Method that has some advantages.\n",
    "1.1 Example To solve\nx + y −2z = −2\ny + 3z =\n7\nx\n−z = −1\nwe can start as usual by reducing it to echelon form.\n",
    "−ρ1+ρ3\n−→\n\n\n\n1\n1\n−2\n−2\n0\n1\n3\n7\n0\n−1\n1\n1\n\n\n\nρ2+ρ3\n−→\n\n\n\n1\n1\n−2\n−2\n0\n1\n3\n7\n0\n0\n4\n8\n\n\n\n",
    "We can keep going to a second stage by making the leading entries into 1’s\n(1/4)ρ3\n−→\n\n\n\n1\n1\n−2\n−2\n0\n1\n3\n7\n0\n0\n1\n2\n\n\n\n\nSection III.",
    "Reduced Echelon Form\n51\nand then to a third stage that uses the leading entries to eliminate all of the\nother entries in each column by combining upwards.\n",
    "−3ρ3+ρ2\n−→\n2ρ3+ρ1\n\n\n\n1\n1\n0\n2\n0\n1\n0\n1\n0\n0\n1\n2\n\n\n\n−ρ2+ρ1\n−→\n\n\n\n1\n0\n0\n1\n0\n1\n0\n1\n0\n0\n1\n2\n\n\n\n",
    "The answer is x = 1, y = 1, and z = 2.\nUsing one entry to clear out the rest of a column is pivoting on that entry.\n",
    "Notice that the row combination operations in the ﬁrst stage move left to\nright while the combination operations in the third stage move right to left.\n",
    "1.2 Example The middle stage operations that turn the leading entries into 1’s\ndon’t interact so we can combine multiple ones into a single step.\n \n",
    "2\n1\n7\n4\n−2\n6\n!\n",
    "−2ρ1+ρ2\n−→\n \n2\n1\n7\n0\n−4\n−8\n!\n(1/2)ρ1\n−→\n(−1/4)ρ2\n \n1\n1/2\n7/2\n0\n1\n2\n!\n−(1/2)ρ2+ρ1\n−→\n \n1\n0\n5/2\n0\n1\n2\n!\n",
    "The answer is x = 5/2 and y = 2.\n",
    "This extension of Gauss’s Method is the Gauss-Jordan Method or Gauss-\nJordan reduction.\n",
    "1.3 Deﬁnition A matrix or linear system is in reduced echelon form if, in addition\nto being in echelon form, each leading entry is a 1 and is the only nonzero entry\nin its column.\n",
    "The cost of using Gauss-Jordan reduction to solve a system is the additional\narithmetic.",
    "The beneﬁt is that we can just read oﬀthe solution set description.\n",
    "In any echelon form system, reduced or not, we can read oﬀwhen the system\nhas an empty solution set because there is a contradictory equation.",
    "We can\nread oﬀwhen the system has a one-element solution set because there is no\ncontradiction and every variable is the leading variable in some row.",
    "And, we\ncan read oﬀwhen the system has an inﬁnite solution set because there is no\ncontradiction and at least one variable is free.\n",
    "However, in reduced echelon form we can read oﬀnot just the size of the\nsolution set but also its description.",
    "We have no trouble describing the solution\nset when it is empty, of course.",
    "Example 1.1 and 1.2 show how in a single\n\n52\nChapter One.",
    "Linear Systems\nelement solution set case the single element is in the column of constants.",
    "The\nnext example shows how to read the parametrization of an inﬁnite solution set.\n",
    "1.4 Example\n\n\n\n2\n6\n1\n2\n5\n0\n3\n1\n4\n1\n0\n3\n1\n2\n5\n\n\n\n−ρ2+ρ3\n−→\n\n\n\n2\n6\n1\n2\n5\n0\n3\n1\n4\n1\n0\n0\n0\n−2\n4\n\n\n\n(1/2)ρ1\n−→\n(1/3)ρ2\n−(1/2)ρ3\n−(4/3)ρ3+ρ2\n−→\n−ρ3+ρ1\n−3ρ2+ρ1\n−→\n\n\n\n1\n0\n−1/2\n0\n−9/2\n0\n1\n1/3\n0\n3\n0\n0\n0\n1\n−2\n\n\n\nAs a linear system this is\nx1\n−1/2x3\n= −9/2\nx2 + 1/3x3\n=\n3\nx4 =\n−2\nso a solution set description is this.\n",
    "S = {\n\n\n\n\n\nx1\nx2\nx3\nx4\n\n\n\n\n=\n\n\n\n\n\n−9/2\n3\n0\n−2\n\n\n\n\n+\n\n\n\n\n\n1/2\n−1/3\n1\n0\n\n\n\n\nx3 | x3 ∈R}\n",
    "Thus, echelon form isn’t some kind of one best form for systems.",
    "Other\nforms, such as reduced echelon form, have advantages and disadvantages.",
    "Instead\nof picturing linear systems (and the associated matrices) as things we operate\non, always directed toward the goal of echelon form, we can think of them as\ninterrelated, where we can get from one to another by row operations.",
    "The rest\nof this subsection develops this thought.\n",
    "1.5 Lemma Elementary row operations are reversible.\n",
    "Proof For any matrix A, the eﬀect of swapping rows is reversed by swapping\nthem back, multiplying a row by a nonzero k is undone by multiplying by 1/k,\nand adding a multiple of row i to row j (with i ̸= j) is undone by subtracting\nthe same multiple of row i from row j.\nA\nρi↔ρj\n−→\nρj↔ρi\n−→\nA\nA\nkρi\n−→\n(1/k)ρi\n−→\nA\nA\nkρi+ρj\n−→\n−kρi+ρj\n−→\nA\n(We need the i ̸= j condition; see Exercise 18.)\n",
    "QED\n\nSection III.",
    "Reduced Echelon Form\n53\nAgain, the point of view that we are developing, supported now by the lemma,\nis that the term ‘reduces to’ is misleading: where A −→B, we shouldn’t think\nof B as after A or simpler than A. Instead we should think of the two matrices\nas interrelated.",
    "Below is a picture.",
    "It shows the matrices from the start of this\nsection and their reduced echelon form version in a cluster, as interreducible.\n",
    "\u00121\n0\n0\n1\n\u0013\n",
    "\u00122\n2\n4\n3\n\u0013\n\u00122\n0\n0\n−1\n\u0013\n\u00121\n1\n0\n−1\n\u0013\n\u00122\n2\n0\n−1\n\u0013\nWe say that matrices that reduce to each other are equivalent with respect\nto the relationship of row reducibility.",
    "The next result justiﬁes this, using the\ndeﬁnition of an equivalence.∗\n1.6 Lemma Between matrices, ‘reduces to’ is an equivalence relation.\n",
    "Proof We must check the conditions (i) reﬂexivity, that any matrix reduces\nto itself, (ii) symmetry, that if A reduces to B then B reduces to A, and\n(iii) transitivity, that if A reduces to B and B reduces to C then A reduces to C.\nReﬂexivity is easy; any matrix reduces to itself in zero-many operations.\n",
    "The relationship is symmetric by the prior lemma — if A reduces to B by\nsome row operations then also B reduces to A by reversing those operations.\n",
    "For transitivity, suppose that A reduces to B and that B reduces to C.\nFollowing the reduction steps from A →· · · →B with those from B →· · · →C\ngives a reduction from A to C.\nQED\n1.7 Deﬁnition Two matrices that are interreducible by elementary row operations\nare row equivalent.\n",
    "The diagram below shows the collection of all matrices as a box.",
    "Inside that\nbox each matrix lies in a class.",
    "Matrices are in the same class if and only if they\nare interreducible.",
    "The classes are disjoint — no matrix is in two distinct classes.\n",
    "We have partitioned the collection of matrices into row equivalence classes.†\n. . .\n",
    "A\nB\n∗More information on equivalence relations is in the appendix.\n",
    "† More information on partitions and class representatives is in the appendix.\n\n",
    "54\nChapter One.",
    "Linear Systems\nOne of the classes is the cluster of interrelated matrices from the start of this\nsection sketched above (it includes all of the nonsingular 2×2 matrices).\n",
    "The next subsection proves that the reduced echelon form of a matrix is\nunique.",
    "Rephrased in terms of the row-equivalence relationship, we shall prove\nthat every matrix is row equivalent to one and only one reduced echelon form\nmatrix.",
    "In terms of the partition what we shall prove is: every equivalence class\ncontains one and only one reduced echelon form matrix.",
    "So each reduced echelon\nform matrix serves as a representative of its class.\n",
    "Exercises\n✓1.8 Use Gauss-Jordan reduction to solve each system.\n",
    "(a) x",
    "+ y = 2\nx −y = 0\n(b)\nx\n−z = 4\n2x +",
    "2y\n= 1\n(c) 3x −2y =\n1\n6x + y = 1/2\n(d) 2x −y\n= −1\nx + 3y −z",
    "=\n5\ny + 2z =\n5\n1.9 Do Gauss-Jordan reduction.\n",
    "(a)\nx + y −z",
    "= 3\n2x −y −z = 1\n3x +",
    "y + 2z = 0\n(b)\n",
    "x",
    "+ y + 2z = 0\n2x −y + z = 1\n4x + y + 5z = 1\n✓1.10 Find the reduced echelon form of each matrix.\n",
    "(a)\n\u00122\n1\n1\n3\n\u0013\n(b)\n\n\n1\n3\n1\n2\n0\n4\n−1\n−3\n−3\n\n\n(c)\n\n\n1\n0\n3\n1\n2\n1\n4\n2\n1\n5\n3\n4\n8\n1\n2\n\n\n(d)\n\n\n0\n1\n3\n2\n0\n0\n5\n6\n1\n5\n1\n5\n\n\n1.11 Get the reduced echelon form of each.\n",
    "(a)\n\n\n0\n2\n1\n2\n−1\n1\n−2\n−1\n0\n\n\n(b)\n\n\n1\n3\n1\n2\n6\n2\n−1\n0\n0\n\n\n✓1.12 Find each solution set by using Gauss-Jordan reduction and then reading oﬀ\nthe parametrization.\n",
    "(a) 2x + y −z",
    "= 1\n4x −y\n= 3\n(b) x\n−z\n= 1\ny + 2z −w = 3\nx + 2y + 3z −w = 7\n(c)\nx −\ny + z\n= 0\ny\n+ w = 0\n3x −2y + 3z + w = 0\n−y\n−w = 0\n(d)\na + 2b + 3c + d −e = 1\n3a −b",
    "+ c",
    "+ d",
    "+ e = 3\n\nSection III.",
    "Reduced Echelon Form\n55\n1.13 Give two distinct echelon form versions of this matrix.\n",
    "\n\n2\n1\n1\n3\n6\n4\n1\n2\n1\n5\n1\n5\n\n\n✓1.14 List the reduced echelon forms possible for each size.\n(a) 2×2\n(b) 2×3\n(c) 3×2\n(d) 3×3\n✓1.15 What results from applying Gauss-Jordan reduction to a nonsingular matrix?\n1.16 Decide whether each relation is an equivalence on the set of 2 × 2 matri-\nces.\n(a) two matrices are related if they have the same entry in the ﬁrst row and ﬁrst\ncolumn\n(b) two matrices are related if they have the same entry in the ﬁrst row and ﬁrst\ncolumn, or the same entry in the second row and second column\n1.17",
    "[Cleary] Consider the following relationship on the set of 2×2 matrices: we say\nthat A is sum-what like B if the sum of all of the entries in A is the same as the\nsum of all the entries in B.",
    "For instance, the zero matrix would be sum-what like\nthe matrix whose ﬁrst row had two sevens, and whose second row had two negative\nsevens.",
    "Prove or disprove that this is an equivalence relation on the set of 2×2\nmatrices.\n",
    "1.18",
    "The proof of Lemma 1.5 contains a reference to the i ̸= j condition on the row\ncombination operation.\n",
    "(a) Write down a 2×2 matrix with nonzero entries, and show that the −1 · ρ1 + ρ1\noperation is not reversed by 1 · ρ1 + ρ1.\n",
    "(b) Expand the proof of that lemma to make explicit exactly where it uses the\ni ̸= j condition on combining.\n✓1.19",
    "[Cleary] Consider the set of students in a class.",
    "Which of the following re-\nlationships are equivalence relations?\n",
    "Explain each answer in at least a sen-\ntence.\n",
    "(a) Two students x, y are related if x has taken at least as many math classes as y.\n(b) Students x, y are related if they have names that start with the same letter.\n",
    "1.20 Show that each of these is an equivalence on the set of 2×2 matrices.",
    "Describe\nthe equivalence classes.\n",
    "(a) Two matrices are related if they have the same product down the diagonal,\nthat is, if the product of the entries in the upper left and lower right are equal.\n",
    "(b) Two matrices are related if they both have at least one entry that is a 1, or if\nneither does.\n1.21 Show that each is not an equivalence on the set of 2×2 matrices.\n",
    "(a) Two matrices A, B are related if a1,1 = −b1,1.\n(b) Two matrices are related if the sum of their entries are within 5, that is, A is\nrelated to B if |(a1,1 + · · · + a2,2) −(b1,1 + · · ·",
    "+ b2,2)| <",
    "5.\n\n56\nChapter One.",
    "Linear Systems\nIII.2\nThe Linear Combination Lemma\n",
    "We will close this chapter by proving that every matrix is row equivalent to one\nand only one reduced echelon form matrix.",
    "The ideas here will reappear, and be\nfurther developed, in the next chapter.\n",
    "The crucial observation concerns how row operations act to transform one\nmatrix into another: the new rows are linear combinations of the old.\n",
    "2.1 Example Consider this Gauss-Jordan reduction.\n \n",
    "2\n1\n0\n1\n3\n5\n!\n−(1/2)ρ1+ρ2\n−→\n \n2\n1\n0\n0\n5/2\n5\n!\n(1/2)ρ1\n−→\n(2/5)ρ2\n \n1\n1/2\n0\n0\n1\n2\n!\n",
    "−(1/2)ρ2+ρ1\n−→\n \n1\n0\n−1\n0\n1\n2\n!\n",
    "Denoting those matrices A →D →G →B and writing the rows of A as α1 and\nα2, etc., we have this.\n \n",
    "α1\nα2\n!\n−(1/2)ρ1+ρ2\n−→\n \nδ1 = α1\nδ2 = −(1/2)α1 + α2\n!\n",
    "(1/2)ρ1\n−→\n(2/5)ρ2\n \nγ1 = (1/2)α1\nγ2 = −(1/5)α1 + (2/5)α2\n!\n",
    "−(1/2)ρ2+ρ1\n−→\n \nβ1 = (3/5)α1 −(1/5)α2\nβ2 = −(1/5)α1 + (2/5)α2\n!\n",
    "2.2 Example The fact that Gaussian operations combine rows linearly also holds\nif there is a row swap.",
    "With this A, D, G, and B\n \n0\n2\n1\n1\n!\nρ1↔ρ2\n−→\n \n1\n1\n0\n2\n!\n(1/2)ρ2\n−→\n \n1\n1\n0\n1\n!\n−ρ2+ρ1\n−→\n \n1\n0\n0\n1\n!\nwe get these linear relationships.\n \n⃗α1\n⃗α2\n!\nρ1↔ρ2\n−→\n \n⃗δ1 = ⃗α2\n⃗δ2 = ⃗α1\n!\n(1/2)ρ2\n−→\n \n⃗γ1 = ⃗α2\n⃗γ2 = (1/2)⃗α1\n!\n−ρ2+ρ1\n−→\n \n⃗β1 = (−1/2)⃗α1 + 1 · ⃗α2\n⃗β2 = (1/2)⃗α1\n!\n",
    "In summary, Gauss’s Method systematically ﬁnds a suitable sequence of\nlinear combinations of the rows.\n\nSection III.",
    "Reduced Echelon Form\n57\n2.3 Lemma (Linear Combination Lemma)",
    "A linear combination of linear combina-\ntions is a linear combination.\n",
    "Proof Given the set c1,1x1 + · · · + c1,nxn through cm,1x1 + · · · + cm,nxn of\nlinear combinations of the x’s, consider a combination of those\nd1(c1,1x1 + · · · + c1,nxn) + · · · + dm(cm,1x1 + · · · + cm,nxn)\nwhere the d’s are scalars along with the c’s.",
    "Distributing those d’s and regrouping\ngives\n= (d1c1,1 + · · ·",
    "+ dmcm,1)x1",
    "+ · · · + (d1c1,n + · · · + dmcm,n)xn\nwhich is also a linear combination of the x’s.\n",
    "QED\n2.4 Corollary Where one matrix reduces to another",
    ", each row of the second is a\nlinear combination of the rows of the ﬁrst.\n",
    "Proof For any two interreducible matrices A and B there is some minimum\nnumber of row operations that will take one to the other.\n",
    "We proceed by\ninduction on that number.\n",
    "In the base step, that we can go from one matrix to another using zero\nreduction operations, the two are equal.",
    "Then each row of B is trivially a\ncombination of A’s rows ⃗βi = 0 · ⃗α1 + · · ·",
    "+ 1 · ⃗αi + · · · + 0 · ⃗αm.\n",
    "For the inductive step assume the inductive hypothesis: with k ⩾0, any\nmatrix that can be derived from A in k or fewer operations has rows that are\nlinear combinations of A’s rows.",
    "Consider a matrix B such that reducing A to B\nrequires k + 1 operations.",
    "In that reduction there is a next-to-last matrix G, so\nthat A −→· · ·",
    "−→G",
    "−→B. The inductive hypothesis applies to this G because\nit is only k steps away from A. That is, each row of G is a linear combination of\nthe rows of A.\nWe will verify that the rows of B are linear combinations of the rows of G.\n",
    "Then the Linear Combination Lemma, Lemma 2.3, applies to show that the\nrows of B are linear combinations of the rows of A.\n",
    "If the row operation taking G to B is a swap then the rows of B are just the\nrows of G reordered and each row of B is a linear combination of the rows of G.\n",
    "If the operation taking G to B is multiplication of a row by a scalar cρi then\n⃗βi = c⃗γi and the other rows are unchanged.",
    "Finally, if the row operation is\nadding a multiple of one row to another rρi +ρj then only row j of B diﬀers from\nthe matching row of G, and ⃗βj = rγi + γj, which is indeed a linear combinations\nof the rows of G.\nBecause we have proved both a base step and an inductive step, the proposi-\ntion follows by the principle of mathematical induction.\n",
    "QED\n\n58\nChapter One.",
    "Linear Systems\nWe now have the insight that Gauss’s Method builds linear combinations\nof the rows.",
    "But of course its goal is to end in echelon form, since that is a\nparticularly basic version of a linear system, as it has isolated the variables.",
    "For\ninstance, in this matrix\nR =\n\n\n\n\n\n2\n3\n7\n8\n0\n0\n0\n0\n1\n5\n1\n1\n0\n0\n0\n3\n3\n0\n0\n0\n0\n0\n2\n1\n\n\n\n\n\nx1 has been removed from x5’s equation.",
    "That is, Gauss’s Method has made\nx5’s row in some way independent of x1’s row.\n",
    "The following result makes this intuition precise.",
    "We sometimes refer to\nGauss’s Method as Gaussian elimination.",
    "What it eliminates is linear relation-\nships among the rows.\n",
    "2.5 Lemma In an echelon form matrix, no nonzero row is a linear combination\nof the other nonzero rows.\n",
    "Proof Let R be an echelon form matrix and consider its non-⃗0 rows.",
    "First\nobserve that if we have a row written as a combination of the others ⃗ρi =\nc1⃗ρ1 +· · ·+ci−1⃗ρi−1 +ci+1⃗ρi+1 +· · ·+cm⃗ρm then we can rewrite that equation\nas\n⃗0 = c1⃗ρ1 + · · ·",
    "+ ci−1⃗ρi−1 + ci⃗ρi + ci+1⃗ρi+1 + · · ·",
    "+ cm⃗ρm\n(∗)\nwhere not all the coeﬃcients are zero; speciﬁcally, ci = −1.",
    "The converse holds\nalso: given equation (∗) where some ci ̸= 0 we could express ⃗ρi as a combination\nof the other rows by moving ci⃗ρi to the left and dividing by −ci.",
    "Therefore we\nwill have proved the theorem if we show that in (∗) all of the coeﬃcients are 0.\n",
    "For that we use induction on the row number i.\n",
    "The base case is the ﬁrst row",
    "i = 1 (if there is no such nonzero row, so that\nR is the zero matrix, then the lemma holds vacuously).",
    "Let ℓi be the column\nnumber of the leading entry in row i. Consider the entry of each row that is in\ncolumn ℓ1.",
    "Equation (∗) gives this.\n0",
    "= c1r1,ℓ1 + c2r2,ℓ1 + · · ·",
    "+ cmrm,ℓ1\n(∗∗)\n",
    "The matrix is in echelon form so every row after the ﬁrst has a zero entry in that\ncolumn r2,ℓ1 = · · · = rm,ℓ1 = 0.",
    "Thus equation (∗∗) shows that c1 = 0, because\nr1,ℓ1 ̸= 0 as it leads the row.\n",
    "The inductive step is much the same as the base step.\n",
    "Again consider\nequation (∗).",
    "We will prove that if the coeﬃcient ci is 0 for each row index\ni ∈{1, . . .",
    ", k} then ck+1 is also 0.",
    "We focus on the entries from column ℓk+1.\n0",
    "= c1r1,ℓk+1 + · · · + ck+1rk+1,ℓk+1 + · · · + cmrm,ℓk+1\n\nSection III.",
    "Reduced Echelon Form\n59\nBy the inductive hypothesis c1, . . .",
    "ck are all 0",
    "so this reduces to the equation\n0 = ck+1rk+1,ℓk+1 + · · · + cmrm,ℓk+1.",
    "The matrix is in echelon form so the\nentries rk+2,ℓk+1, . . .",
    ", rm,ℓk+1 are all 0.",
    "Thus ck+1 = 0, because rk+1,ℓk+1 ̸= 0\nas it is the leading entry.\n",
    "QED\nWith that, we are ready to show that the end product of Gauss-Jordan\nreduction is unique.\n",
    "2.6 Theorem Each matrix is row equivalent to a unique reduced echelon form\nmatrix.\n",
    "Proof",
    "[Yuster] Fix a number of rows m.",
    "We will proceed by induction on the\nnumber of columns n.\n",
    "The base case is that the matrix has n = 1 column.",
    "If this is the zero matrix\nthen its echelon form is the zero matrix.",
    "If instead it has any nonzero entries\nthen when the matrix is brought to reduced echelon form it must have at least\none nonzero entry, which must be a 1 in the ﬁrst row.",
    "Either way, its reduced\nechelon form is unique.\n",
    "For the inductive step we assume that n > 1 and that all m row matrices\nhaving fewer than n columns have a unique reduced echelon form.",
    "Consider\nan m×n matrix A and suppose that B and C are two reduced echelon form\nmatrices derived from A. We will show that these two must be equal.\n",
    "Let ˆA be the matrix consisting of the ﬁrst n −1 columns of A. Observe\nthat any sequence of row operations that bring A to reduced echelon form will\nalso bring ˆA to reduced echelon form.",
    "By the inductive hypothesis this reduced\nechelon form of ˆA is unique, so if B and C diﬀer then the diﬀerence must occur\nin column n.\n",
    "We ﬁnish the inductive step and the argument by showing that the two\ncannot diﬀer only in that column.",
    "Consider a homogeneous system of equations\nfor which A is the matrix of coeﬃcients.\n",
    "a1,1x1 + a1,2x2 + · · ·",
    "+ a1,nxn = 0\na2,1x1 + a2,2x2 + · · · + a2,nxn = 0\n...\nam,1x1 + am,2x2 + · · · + am,nxn = 0\n(∗)\n",
    "By Theorem One.",
    "I.1.5 the set of solutions to that system is the same as the set\nof solutions to B’s system\nb1,1x1 + b1,2x2 + · · · + b1,nxn = 0\nb2,1x1 + b2,2x2 + · · · + b2,nxn = 0\n...\nbm,1x1 + bm,2x2 + · · ·",
    "+ bm,nxn = 0\n(∗∗)\n\n60\nChapter One.",
    "Linear Systems\nand to C’s.\n",
    "c1,1x1 + c1,2x2 + · · ·",
    "+ c1,nxn = 0\nc2,1x1 + c2,2x2 + · · · + c2,nxn = 0\n...\ncm,1x1 + cm,2x2 + · · · + cm,nxn = 0\n(∗∗∗)\nWith B and C diﬀerent only in column n, suppose that they diﬀer in row i.\nSubtract row i of (∗∗∗) from row i of (∗∗) to get the equation (bi,n−ci,n)·xn = 0.\n",
    "We’ve assumed that bi,n ̸= ci,n and so we get xn = 0.",
    "Thus xn is not a free\nvariable and so in (∗∗) and (∗∗∗) the n-th column contains the leading entry of\nsome row, since in an echelon form matrix any column that does not contain a\nleading entry is associated with a free variable.\n",
    "But now, with B and C equal on the ﬁrst n −1 columns, by the deﬁnition of\nreduced echeleon form their leading entries in the n-th column are in the same\nrow.",
    "And, both leading entries would have to be 1, and would have to be the\nonly nonzero entries in that column.",
    "Therefore B = C.\nQED\nWe have asked whether any two echelon form versions of a linear system have\nthe same number of free variables, and if so are they exactly the same variables?\n",
    "With the prior result we can answer both questions “yes.”",
    "There is no linear\nsystem such that, say, we could apply Gauss’s Method one way and get y and z\nfree but apply it another way and get y and w free.\n",
    "Before the proof, recall the distinction between free variables and parameters.\n",
    "This system\nx + y\n= 1\ny + z = 2\nhas one free variable, z, because it is the only variable not leading a row.",
    "We\nhave the habit of parametrizing using the free variable y",
    "= 2−z, x = −1+z, but\nwe could also parametrize using another variable, such as z = 2 −y, x = 1 −y.\n",
    "So the set of parameters is not unique, it is the set of free variables that is\nunique.\n",
    "2.7 Corollary If from a starting linear systems we derive by Gauss’s Method two\ndiﬀerent echelon form systems, then the two have the same free variables.\n",
    "Proof The prior result says that the reduced echelon form is unique.",
    "We get\nfrom any echelon form version to the reduced echelon form by eliminating up, so\nany echelon form version of a system has the same free variables as the reduced\nechelon form version.\n",
    "QED\nWe close with a recap.",
    "In Gauss’s Method we start with a matrix and then\nderive a sequence of other matrices.",
    "We deﬁned two matrices to be related if we\n\nSection III.",
    "Reduced Echelon Form\n61\ncan derive one from the other.",
    "That relation is an equivalence relation, called\nrow equivalence, and so partitions the set of all matrices into row equivalence\nclasses.\n. . .\n",
    "\u0012\n2\n1\n7\n3\u0013\n\u0012\n0\n1\n1\n3\u0013\n(There are inﬁnitely many matrices in the pictured class, but we’ve only got\nroom to show two.)",
    "We have proved there is one and only one reduced echelon\nform matrix in each row equivalence class.",
    "So the reduced echelon form is a\ncanonical form∗for row equivalence: the reduced echelon form matrices are\nrepresentatives of the classes.\n. .",
    ".\n",
    "⋆\n⋆\n⋆\n⋆\n\u0012\n0\n1\n1\n0\u0013\n",
    "The idea here is that one way to understand a mathematical situation is\nby being able to classify the cases that can happen.",
    "This is a theme in this\nbook and we have seen this several times already.",
    "We classiﬁed solution sets of\nlinear systems into the no-elements, one-element, and inﬁnitely-many elements\ncases.",
    "We also classiﬁed linear systems with the same number of equations as\nunknowns into the nonsingular and singular cases.\n",
    "Here, where we are investigating row equivalence, we know that the set of all\nmatrices breaks into the row equivalence classes and we now have a way to put\nour ﬁnger on each of those classes — we can think of the matrices in a class as\nderived by row operations from the unique reduced echelon form matrix in that\nclass.\nPut in more operational terms, uniqueness of reduced echelon form lets us\nanswer questions about the classes by translating them into questions about\nthe representatives.",
    "For instance, as promised in this section’s opening, we now\ncan decide whether one matrix can be derived from another by row reduction.\n",
    "We apply the Gauss-Jordan procedure to both and see if they yield the same\nreduced echelon form.\n",
    "∗More information on canonical representatives is in the appendix.\n\n",
    "62\nChapter One.",
    "Linear Systems\n2.8 Example",
    "These matrices are not row equivalent\n \n1\n−3\n−2\n6\n!\n \n1\n−3\n−2\n5\n!\n",
    "because their reduced echelon forms are not equal.\n \n1\n−3\n0\n0\n!\n \n1\n0\n0\n1\n!\n2.9 Example Any nonsingular 3×3 matrix Gauss-Jordan reduces to this.\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n\n2.10 Example We can describe all the classes by listing all possible reduced\nechelon form matrices.",
    "Any 2×2 matrix lies in one of these: the class of matrices\nrow equivalent to this,\n \n0\n0\n0\n0\n!\n",
    "the inﬁnitely many classes of matrices row equivalent to one of this type\n \n1\na\n0\n0\n!\nwhere a ∈R (including a = 0), the class of matrices row equivalent to this,\n \n0\n1\n0\n0\n!\nand the class of matrices row equivalent to this\n \n1\n0\n0\n1\n!\n(this is the class of nonsingular 2×2 matrices).\n",
    "Exercises\n✓2.11 Decide if the matrices are row equivalent.\n",
    "(a)\n\u00121\n2\n4\n8\n\u0013\n,\n\u00120\n1\n1\n2\n\u0013\n(b)\n\n\n1\n0\n2\n3\n−1\n1\n5\n−1\n5\n\n,\n\n\n1\n0\n2\n0\n2\n10\n2\n0\n4\n\n\n(c)\n\n\n2\n1\n−1\n1\n1\n0\n4\n3\n−1\n\n",
    ",\n\u00121\n0\n2\n0\n2\n10\n\u0013\n(d)\n\u0012 1\n1\n1\n−1\n2\n2\n\u0013\n,\n\u00120\n3\n−1\n2\n2\n5\n\u0013\n(e)\n\u00121\n1\n1\n0\n0\n3\n\u0013\n,\n\u00120\n1\n2\n1\n−1\n1\n\u0013\n2.12 Which of these matrices are row equivalent to each other?\n\nSection III.",
    "Reduced Echelon Form\n63\n(a)\n\u00121\n3\n2\n4\n\u0013\n(b)\n\u00121\n5\n2\n10\n\u0013\n(c)\n\u00121\n−1\n3\n0\n\u0013\n(d)\n",
    "\u00122\n6\n4\n10\n\u0013\n(e)\n\u0012 0\n1\n−1\n0\n\u0013\n(f)\n\u00123\n3\n2\n2\n\u0013\n2.13 Produce three other matrices row equivalent to the given one.\n(a)\n\u00121\n3\n4\n−1\n\u0013\n(b)\n\n\n0\n1\n2\n1\n1\n1\n2\n3\n4\n\n\n✓2.14 Perform Gauss’s Method on this matrix.",
    "Express each row of the ﬁnal matrix\nas a linear combination of the rows of the starting matrix.\n\n\n1\n2\n1\n3\n−1\n0\n0\n4\n0\n\n\n2.15 Describe the matrices in each of the classes represented in Example 2.10.\n",
    "2.16 Describe all matrices in the row equivalence class of these.\n",
    "(a)\n\u00121\n0\n0\n0\n\u0013\n(b)\n\u00121\n2\n2\n4\n\u0013\n(c)\n\u00121\n1\n1\n3\n\u0013\n2.17 How many row equivalence classes are there?\n2.18 Can row equivalence classes contain diﬀerent-sized matrices?\n",
    "2.19 How big are the row equivalence classes?\n(a) Show that for any matrix of all zeros, the class is ﬁnite.\n",
    "(b) Do any other classes contain only ﬁnitely many members?\n✓2.20 Give two reduced echelon form matrices that have their leading entries in the\nsame columns, but that are not row equivalent.\n",
    "✓2.21 Show that any two n×n nonsingular matrices are row equivalent.",
    "Are any two\nsingular matrices row equivalent?\n✓2.22 Describe all of the row equivalence classes containing these.\n",
    "(a) 2×2 matrices\n(b) 2×3 matrices\n(c) 3×2 matrices\n(d) 3×3 matrices\n2.23\n(a) Show that a vector ⃗β0 is a linear combination of members of the set\n{⃗β1, . . .",
    ", ⃗βn } if and only if there is a linear relationship ⃗0 = c0⃗β0 + · · · + cn⃗βn\nwhere c0 is not zero.",
    "(Hint.",
    "Watch out for the ⃗β0 = ⃗0 case.)\n",
    "(b) Use that to simplify the proof of Lemma 2.5.\n",
    "✓2.24",
    "[Trono] Three truck drivers went into a roadside cafe.",
    "One truck driver pur-\nchased four sandwiches, a cup of coﬀee, and ten doughnuts for $8.45.",
    "Another\ndriver purchased three sandwiches, a cup of coﬀee, and seven doughnuts for $6.30.\n",
    "What did the third truck driver pay for a sandwich, a cup of coﬀee, and a doughnut?\n",
    "2.25",
    "The Linear Combination Lemma says which equations can be gotten from\nGaussian reduction of a given linear system.\n",
    "(1) Produce an equation not implied by this system.\n",
    "3x +",
    "4y = 8\n2x +",
    "y = 3\n(2) Can any equation be derived from an inconsistent system?\n\n64\nChapter One.",
    "Linear Systems\n2.26",
    "[Hoﬀman & Kunze] Extend the deﬁnition of row equivalence to linear systems.\n",
    "Under your deﬁnition, do equivalent systems have the same solution set?\n2.27",
    "In this matrix\n\n\n1\n2\n3\n3\n0\n3\n1\n4\n5\n\n\nthe ﬁrst and second columns add to the third.\n",
    "(a) Show that remains true under any row operation.\n",
    "(b) Make a conjecture.\n",
    "(c) Prove that it holds.\n\n",
    "Topic\nComputer Algebra Systems\nThe linear systems in this chapter are small enough that their solution by hand\nis easy.",
    "For large systems, including those involving thousands of equations,\nwe need a computer.",
    "There are special purpose programs such as LINPACK\nfor this.",
    "Also popular are general purpose computer algebra systems including\nMaple, Mathematica, or MATLAB, and Sage.\n",
    "For example, in the Topic on Networks, we need to solve this.\n",
    "i0 −i1 −i2\n= 0\ni1\n−\ni3\n−\ni5\n= 0\ni2\n−i4 +\ni5\n= 0\ni3 + i4\n−i6 = 0\n5i1\n+ 10i3\n= 10\n2i2\n+ 4i4\n= 10\n5i1 −2i2\n+ 50i5\n= 0\nDoing this by hand would take time and be error-prone.",
    "A computer is better.\n",
    "Here is that system solved with Sage.",
    "(There are many ways to do this; the\none here has the advantage of simplicity.)\nsage: var('i0,i1,i2,i3,i4,i5,i6')\n",
    "(i0, i1, i2, i3, i4, i5, i6)\nsage: network_system=[i0-i1-i2==0, i1-i3-i5==0,\n....:\ni2-i4+i5==0, i3+i4-i6==0, 5*i1+10*i3==10,\n....:\n2*i2",
    "+4*i4==10, 5*i1-2*i2+50*i5==0]\nsage: solve(network_system, i0,i1,i2,i3,i4,i5,i6)\n",
    "[[i0 == (7/3), i1 == (2/3), i2 == (5/3), i3 == (2/3),\ni4 == (5/3), i5 == 0, i6 == (7/3)]]\nMagic.\n",
    "Here is the same system solved under Maple.",
    "We enter the array of coeﬃcients\nand the vector of constants, and then we get the solution.\n> A:=array( [[1,-1,-1,0,0,0,0],\n[0,1,0,-1,0,-1,0],\n[0,0,1,0,-1,1,0],\n[0,0,0,1,1,0,-1],\n",
    "[0,5,0,10,0,0,0],\n\n66\nChapter One.",
    "Linear Systems\n[0,0,2,0,4,0,0],\n",
    "[0,5,-2,0,0,50,0]] );\n> u:=array( [0,0,0,0,10,10,0] );\n> linsolve(A,u);\n7\n2\n5\n2\n5\n7\n[ -, -, -, -, -, 0, - ]\n3\n3\n3\n3\n3\n3\nIf a system has inﬁnitely many solutions then the program will return a\nparametrization.\n",
    "Exercises\n1 Use the computer to solve the two problems that opened this chapter.\n",
    "(a) This is the Statics problem.\n",
    "40h + 15c = 100\n25c = 50 + 50h\n(b)",
    "This is the Chemistry problem.\n",
    "7h = 7j\n8h + 1i = 5j + 2k\n1i = 3j\n3i = 6j + 1k\n2 Use the computer to solve these systems from the ﬁrst subsection, or conclude\n‘many solutions’ or ‘no solutions’.\n",
    "(a) 2x +",
    "2y = 5\nx −4y = 0\n(b) −x +",
    "y = 1\nx",
    "+ y",
    "= 2\n(c) x",
    "−3y + z = 1\nx + y + 2z = 14\n(d)\n−x −y = 1\n−3x −3y = 2\n(e)\n4y +",
    "z = 20\n2x −2y + z = 0\nx\n+ z = 5\nx + y −z = 10\n(f) 2x\n+ z + w =\n5\ny\n−w = −1\n3x\n−z −w =\n0\n4x + y + 2z + w =\n9\n3",
    "Use the computer to solve these systems from the second subsection.\n",
    "(a) 3x + 6y",
    "= 18\nx + 2y = 6\n(b) x",
    "+ y =\n1\nx −y = −1\n(c)\nx1\n+ x3 = 4\nx1 −x2 + 2x3 = 5\n4x1",
    "−x2 + 5x3 = 17\n(d) 2a +",
    "b −c = 2\n2a\n+ c = 3\na −b\n= 0\n(e)\nx + 2y −z\n= 3\n2x + y\n+ w = 4\nx −y + z + w = 1\n(f)\nx\n+ z + w = 4\n2x + y\n−w = 2\n3x + y + z\n= 7\n4",
    "What does the computer give for the solution of the general 2×2 system?\n",
    "ax",
    "+ cy = p\nbx + dy = q\n\nTopic\nInput-Output Analysis\nAn economy is an immensely complicated network of interdependence.",
    "Changes\nin one part can ripple out to aﬀect other parts.",
    "Economists have struggled to\nbe able to describe, and to make predictions about, such a complicated object.\n",
    "Mathematical models using systems of linear equations are a key tool.",
    "One\nexample is Input-Output Analysis, pioneered by W. Leontief, who won the 1973\nNobel Prize in Economics.\n",
    "Consider an economy with many parts, two of which are the steel industry\nand the auto industry.",
    "These two interact tightly as they work to meet the\ndemand for their product from other parts of the economy, from users external\nto the steel and auto sectors.",
    "For instance, should the external demand for autos\ngo up, that would increase in the auto industry’s usage of steel.",
    "Or should the\nexternal demand for steel fall, then it would lower steel’s purchase of trucks.\n",
    "The model that we consider here takes in the external demands and predicts\nhow the two interact to meet those demands.\n",
    "We start with production and consumption statistics.\n",
    "(These numbers,\ngiving dollar values in millions, are from [Leontief 1965] describing the 1958 U.S.\neconomy.",
    "Today’s statistics would be diﬀerent because of inﬂation and because\nof technical changes in the industries.)\nused by\nsteel\nused by\nauto\nused by\nothers\ntotal\nvalue of\nsteel\n",
    "5 395\n2 664\n25 448\nvalue of\nauto\n48\n9 030\n30 346\nFor instance, the dollar value of steel used by the auto industry in this year is\n2, 664 million.",
    "Note that industries may consume some of their own output.\n",
    "We can ﬁll in the external demands.",
    "This year’s value of the steel used by\nothers is 17, 389 and the external value of autos is 21, 268.",
    "With that we have a\ncomplete description of how auto and steel interact to meet their demands.\n\n",
    "68\nChapter One.",
    "Linear Systems\nNow imagine that the external demand for steel has recently been going up\nby 200 per year and so we estimate that next year it will be 17, 589.",
    "We also\nestimate that next year’s external demand for autos will be down 25 to 21, 243.\n",
    "We wish to predict next year’s total outputs.\n",
    "That prediction isn’t as simple as adding 200 to this year’s steel total and\nsubtracting 25 from this year’s auto total.",
    "For one thing, a rise in steel will\ncause that industry to have an increased demand for autos, which will mitigate\nthe loss in external demand for autos.",
    "On the other hand, the drop in external\ndemand for autos will cause the auto industry to use less steel and so lessen\nsomewhat the upswing in steel’s business.",
    "In short, these two industries form a\nsystem.",
    "We must predict where the system as a whole will settle.\n",
    "Here are the equations.\n",
    "next year’s production of steel = next year’s use of steel by steel\n+ next year’s use of steel by auto\n+ next year’s use of steel by others\nnext year’s production of autos = next year’s use of autos by steel\n+ next year’s use of autos by auto\n+ next year’s use of autos by others\nFor the left side let s be next years total production of steel and let a be next\nyear’s total output of autos.",
    "For the right side, as discussed above, our external\ndemand estimates are 17, 589 and 21, 243.\n",
    "For next year’s use of steel by steel, note that this year the steel industry\nused 5, 395 units of steel input to produce 25, 448 units of steel output.",
    "So next\nyear, when the steel industry will produce s units out, we guess that doing so\nwill take s · (5 395)/(25 448) units of steel input — this is simply the assumption\nthat input is proportional to output.",
    "(We are assuming that the ratio of input to\noutput remains constant over time; in practice, models may try to take account\nof trends of change in the ratios.)\n",
    "Next year’s use of steel by the auto industry is similar.",
    "This year the auto\nindustry uses 2, 664 units of steel input to produce 30, 346 units of auto output.\n",
    "So next year, when the auto industry’s total output is a, we expect it to consume\na · (2 664)/(30 346) units of steel.\n",
    "Filling in the other equation in the same way gives this system of linear\nequations.\n",
    "(5 395/25 448) · s + (2 664/30 346) · a + 17 589 = s\n(48/25 448) · s",
    "+ (9 030/30 346) · a + 21 243 = a\nMoving the variables to one side and the constants to the other\n(20 053/25 448)s −(2 664/30 346)a = 17 589\n−(48/25 448)s",
    "+ (21 316/30 346)a = 21 243\n\nTopic: Input-Output Analysis\n69\nand applying Gauss’s Method or using Sage, as here\nsage: var('a,s')\n(a, s)\nsage: eqns=[(20053/25448)*s - (2664/30346)*a == 17589,\n....:\n(-48/25448)*s + (21316/30346)*a == 21243]\nsage: solve(eqns, s, a)\n",
    "[[s == (2745320544312/106830469), a == (6476293881123/213660938)]]\nsage: n(2745320544312/106830469)\n25697.9171767186\nsage: n(6476293881123/213660938)\n30311.0804517904\ngives our prediction: s = 25, 698 and a = 30, 311.\n",
    "Above, we discussed that the prediction of next year’s totals isn’t as simple\nas adding 200 to last year’s steel total and subtracting 25 from last year’s auto\ntotal.",
    "Comparing these predictions to the numbers for the current year shows\nthat the total production of the steel industry should rise by 250 while auto’s\ntotal drops by 35.",
    "The increase in external demand for steel causes an increase\nin internal demand by the steel industry, which is lessened somewhat by the\ndrop in autos, but results in a total that is more than 200 higher.",
    "Similarly,\nauto’s total drops more than 25 despite the help that it gets from steel.\n",
    "One of the advantages of having a mathematical model is that we can ask\n“What if . . . ?”",
    "questions.",
    "For instance, we can ask, “What if our estimates for\nnext year’s external demands are somewhat oﬀ?”",
    "To try to understand how\nmuch the model’s predictions change in reaction to changes in our estimates,\nwe can revise the estimate of next year’s external steel demand from 17, 589\ndown to 17, 489, while keeping the assumption of next year’s external demand\nfor autos ﬁxed at 21, 243.",
    "The resulting system\n(20 053/25 448)s −(2 664/30 346)a = 17 489\n−(48/25 448)s",
    "+ (21 316/30 346)a = 21 243\ngives s = 25, 571 and a = 30, 311.",
    "This is sensitivity analysis.",
    "We are seeing\nhow sensitive the predictions of our model are to the accuracy of the assumptions.\n",
    "Naturally, we can consider larger models that detail the interactions among\nmore sectors of an economy; these models are typically solved on a computer.\n",
    "Naturally also, a single model does not suit every case and assuring that the\nassumptions underlying a model are reasonable for a particular prediction\nrequires the judgments of experts.",
    "With those caveats however, this model has\nproven in practice to be a useful and accurate tool for economic analysis.",
    "For\nfurther reading, try [Leontief 1951] and [Leontief 1965].\n",
    "Exercises\n1 With the steel-auto system given above, estimate next year’s total productions in\nthese cases.\n",
    "(a) Next year’s external demands are up 200 from this year for steel and are\nunchanged for autos.\n\n",
    "70\nChapter One.",
    "Linear Systems\n(b) Next year’s external demands are up 100 for steel and are up 200 for autos.\n",
    "(c) Next year’s external demands are up 200 for steel and are up 200 for autos.\n",
    "2 For the steel-auto system, with the external demand estimates of 17, 589 and\n21, 243 discussed above, what will be the value of steel used by steel, the value of\nsteel used by auto, etc.?\n",
    "3 In the steel-auto system, the ratio for the use of steel by the auto industry is\n2, 664/30, 346, about 0.0878.",
    "Imagine that a new process for making autos reduces\nthis ratio to .0500.\n",
    "(a) How will the predictions for next year’s total productions change compared\nto the ﬁrst example discussed above (i.e., taking next year’s external demands\nto be 17, 589 for steel and 21, 243 for autos)?\n(b) Predict next year’s totals if, in addition, the external demand for autos rises\nto be 21, 500 because the new cars are cheaper.\n",
    "4 This table gives the numbers for the auto-steel system from a diﬀerent year, 1947\n(see [Leontief 1951]).",
    "The units here are billions of 1947 dollars.\n",
    "used by\nsteel\nused by\nauto\nused by\nothers\ntotal\nvalue of\nsteel\n6.90\n1.28\n18.69\nvalue of\nautos\n0\n4.40\n14.27\n(a) Solve for total output if next year’s external demands are: steel’s demand up\n10% and auto’s demand up 15%.\n",
    "(b) How do the ratios compare to those given above in the discussion for the 1958\neconomy?\n(c) Solve the 1947 equations with the 1958 external demands (note the diﬀerence\nin units; a 1947 dollar buys about what $1.30 in 1958 dollars buys).",
    "How far oﬀ\nare the predictions for total output?\n5 Predict next year’s total productions of each of the three sectors of the hypothetical\neconomy shown below\nused by\nfarm\nused by\nrail\nused by\nshipping\nused by\nothers\ntotal\nvalue of\nfarm\n25\n50\n100\n800\nvalue of\nrail\n25\n50\n50\n300\nvalue of\nshipping\n15\n10\n0\n500\nif next year’s external demands are as stated.\n",
    "(a) 625 for farm, 200 for rail, 475 for shipping\n(b) 650 for farm, 150 for rail, 450 for shipping\n6",
    "This table gives the interrelationships among three segments of an economy (see\n\nTopic: Input-Output Analysis\n71\n[Clark & Coupe]).\n",
    "used by\nfood\nused by\nwholesale\nused by\nretail\nused by\nothers\ntotal\nvalue of\nfood\n0\n2 318\n4 679\n11 869\nvalue of\nwholesale\n393\n1 089\n22 459\n122 242\nvalue of\nretail\n3\n53\n75\n116 041\nWe will do an Input-Output analysis on this system.\n",
    "(a) Fill in the numbers for this year’s external demands.\n",
    "(b) Set up the linear system, leaving next year’s external demands blank.\n",
    "(c) Solve the system where we get next year’s external demands by taking this\nyear’s external demands and inﬂating them 10%.",
    "Do all three sectors increase\ntheir total business by 10%?",
    "Do they all even increase at the same rate?\n(d) Solve the system where we get next year’s external demands by taking this\nyear’s external demands and reducing them 7%.",
    "(The study from which these\nnumbers come concluded that because of the closing of a local military facility,\noverall personal income in the area would fall 7%, so this might be a ﬁrst guess\nat what would actually happen.)\n\n",
    "Topic\nAccuracy of Computations\nGauss’s Method lends itself to computerization.",
    "The code below illustrates.",
    "It\noperates on an n×n matrix named a, doing row combinations using the ﬁrst\nrow, then the second row, etc.\nfor(row=1; row<=n-1; row++){\nfor(row_below=row+1; row_below<=n; row_below++){\nmultiplier=a[row_below,row]/a[row,row];\nfor(col=row; col<=n; col++){\na[row_below,col]-=multiplier*a[row,col];\n}\n}\n}\n",
    "This is in the C language.",
    "The for(row=1; row<=n-1; row++){ .. } loop initial-\nizes row at 1 and then iterates while row is less than or equal to n −1, each\ntime through incrementing row by one with the ++ operation.",
    "The other non-\nobvious language construct is that the -= in the innermost loop has the eﬀect of\na[row_below,col]=-1*multiplier*a[row,col]+a[row_below,col].\n",
    "While that code is a ﬁrst take on mechanizing Gauss’s Method, it is naive.\n",
    "For one thing, it assumes that the entry in the row,row position is nonzero.",
    "So\none way that it needs to be extended is to cover the case where ﬁnding a zero\nin that location leads to a row swap or to the conclusion that the matrix is\nsingular.\n",
    "We could add some if statements to cover those cases but we will instead\nconsider another way in which this code is naive.",
    "It is prone to pitfalls arising\nfrom the computer’s reliance on ﬂoating point arithmetic.\n",
    "For example, above we have seen that we must handle a singular system as a\nseparate case.",
    "But systems that are nearly singular also require care.",
    "Consider\nthis one (the extra digits are in the ninth signiﬁcant place).\n",
    "x + 2y = 3\n1.000 000 01x + 2y = 3.000 000 01\n(∗)\n",
    "By eye we easily spot the solution x = 1, y = 1.",
    "A computer has more trouble.",
    "If\nit represents real numbers to eight signiﬁcant places, called single precision, then\n\nTopic: Accuracy of Computations\n73\nit will represent the second equation internally as 1.000 000 0x+2y = 3.000 000 0,\nlosing the digits in the ninth place.",
    "Instead of reporting the correct solution,\nthis computer will think that the two equations are equal and it will report that\nthe system is singular.\n",
    "For some intuition about how the computer could come up with something\nthat far oﬀ, consider this graph of the system.\n",
    "(1, 1)\nWe cannot tell the two lines apart; this system is nearly singular in the sense that\nthe two lines are nearly the same line.",
    "This gives the system (∗) the property\nthat a small change in an equation can cause a large change in the solution.",
    "For\ninstance, changing the 3.000 000 01 to 3.000 000 03 changes the intersection point\nfrom (1, 1) to (3, 0).",
    "The solution changes radically depending on the ninth digit,\nwhich explains why an eight-place computer has trouble.",
    "A problem that is very\nsensitive to inaccuracy or uncertainties in the input values is ill-conditioned.\n",
    "The above example gives one way in which a system can be diﬃcult to\nsolve on a computer.",
    "It has the advantage that the picture of nearly-equal lines\ngives a memorable insight into one way for numerical diﬃculties to happen.\n",
    "Unfortunately this insight isn’t useful when we wish to solve some large system.\n",
    "We typically will not understand the geometry of an arbitrary large system.\n",
    "There are other ways that a computer’s results may be unreliable, besides\nthat the angle between some of the linear surfaces is small.",
    "For example, consider\nthis system (from [Hamming]).\n",
    "0.001x +",
    "y = 1\nx −y = 0\n(∗∗)\n",
    "The second equation gives x = y, so x = y = 1/1.001 and thus both variables\nhave values that are just less than 1.",
    "A computer using two digits represents\nthe system internally in this way (we will do this example in two-digit ﬂoating\npoint arithmetic for clarity but inventing a similar one with eight or more digits\nis easy).\n",
    "(1.0 × 10−3) ·",
    "x + (1.0 × 100) ·",
    "y = 1.0 × 100\n(1.0 × 100) ·",
    "x −(1.0 × 100) ·",
    "y = 0.0 × 100\nThe row reduction step −1000ρ1",
    "+ ρ2 produces a second equation −1001y =\n−1000, which this computer rounds to two places as (−1.0×103)y = −1.0×103.\n\n",
    "74\nChapter One.",
    "Linear Systems\n",
    "The computer decides from the second equation that y = 1 and with that it\nconcludes from the ﬁrst equation that x = 0.",
    "The y value is close but the x is\nbad — the ratio of the actual answer to the computer’s answer is inﬁnite.",
    "In\nshort, another cause of unreliable output is the computer’s reliance on ﬂoating\npoint arithmetic when the system-solving code leads to using leading entries\nthat are small.\n",
    "An experienced programmer may respond by using double precision, which\nretains sixteen signiﬁcant digits, or perhaps using some even larger size.",
    "This\nwill indeed solve many problems.",
    "However, double precision has greater memory\nrequirements and besides we can obviously tweak the above to give the same\ntrouble in the seventeenth digit, so double precision isn’t a panacea.",
    "We need a\nstrategy to minimize numerical trouble as well as some guidance about how far\nwe can trust the reported solutions.\n",
    "A basic improvement on the naive code above is to not determine the factor\nto use for row combinations by simply taking the entry in the row,row position,\nbut rather to look at all of the entries in the row column below the row,row entry\nand take one that is likely to give reliable results because it is not too small.\n",
    "This is partial pivoting.\n",
    "For example, to solve the troublesome system (∗∗) above we start by looking\nat both equations for a best entry to use, and take the 1 in the second equation\nas more likely to give good results.",
    "The combination step of −.001ρ2 + ρ1\ngives a ﬁrst equation of 1.001y = 1, which the computer will represent as\n(1.0 × 100)y = 1.0 × 100, leading to the conclusion that y = 1 and, after back-\nsubstitution, that x = 1, both of which are close to right.",
    "We can adapt the\ncode from above to do this.\n",
    "for(row=1; row<=n-1; row++){\n/* find the largest entry in this column (in row max) */\nmax=row;\nfor(row_below=row+1; row_below<=n; row_below++){\nif (abs(a[row_below,row]) > abs(a[max,row]));\nmax = row_below;\n}\n/* swap rows to move that best entry up */\nfor(col=row; col<=n; col++){\ntemp=a[row,col];\na[row,col]=a[max,col];\na[max,col]=temp;\n}\n/* proceed as before */\nfor(row_below=row+1; row_below<=n; row_below++){\nmultiplier=a[row_below,row]/a[row,row];\nfor(col=row; col<=n; col++){\na[row_below,col]-=multiplier*a[row,col];\n}\n}\n}\nA full analysis of the best way to implement Gauss’s Method is beyond the\nscope of this book (see [Wilkinson 1965]), but the method recommended by\n\nTopic: Accuracy of Computations\n75\nmost experts ﬁrst ﬁnds the best entry among the candidates and then scales it\nto a number that is less likely to give trouble.",
    "This is scaled partial pivoting.\n",
    "In addition to returning a result that is likely to be reliable, most well-done\ncode will return a conditioning number that describes the factor by which\nuncertainties in the input numbers could be magniﬁed to become inaccuracies\nin the results returned (see [Rice]).\n",
    "The lesson is that just because Gauss’s Method always works in theory, and\njust because computer code correctly implements that method, doesn’t mean\nthat the answer is reliable.",
    "In practice, always use a package where experts have\nworked hard to counter what can go wrong.\n",
    "Exercises\n1 Using two decimal places, add 253 and 2/3.\n",
    "2",
    "This intersect-the-lines problem contrasts with the example discussed above.\n",
    "(1, 1)\nx + 2y = 3\n3x −2y = 1\nIllustrate that in this system some small change in the numbers will produce only\na small change in the solution by changing the constant in the bottom equation to\n1.008 and solving.",
    "Compare it to the solution of the unchanged system.\n",
    "3 Consider this system ([Rice]).\n",
    "0.000 3x + 1.556y = 1.559\n0.345 4x −2.346y = 1.108\n(a) Solve it.\n",
    "(b) Solve it by rounding at each step to four digits.\n",
    "4 Rounding inside the computer often has an eﬀect on the result.",
    "Assume that your\nmachine has eight signiﬁcant digits.\n",
    "(a) Show that the machine will compute (2/3) + ((2/3) −(1/3))",
    "as unequal to\n((2/3) + (2/3)) −(1/3).",
    "Thus, computer arithmetic is not associative.\n",
    "(b) Compare the computer’s version of (1/3)x + y = 0",
    "and (2/3)x + 2y = 0.",
    "Is\ntwice the ﬁrst equation the same as the second?\n5 Ill-conditioning is not only dependent on the matrix of coeﬃcients.",
    "This example\n[Hamming] shows that it can arise from an interaction between the left and right\nsides of the system.",
    "Let ε be a small real.\n",
    "3x + 2y +\nz =\n6\n2x + 2εy + 2εz = 2 + 4ε\nx + 2εy −εz = 1 + ε\n(a) Solve the system by hand.",
    "Notice that the ε’s divide out only because there is\nan exact cancellation of the integer parts on the right side as well as on the left.\n",
    "(b) Solve the system by hand, rounding to two decimal places, and with ε = 0.001.\n\n",
    "Topic\nAnalyzing Networks\nThe diagram below shows some of a car’s electrical network.",
    "The battery is on\nthe left, drawn as stacked line segments.",
    "The wires are lines, shown straight and\nwith sharp right angles for neatness.",
    "Each light is a circle enclosing a loop.\n12V\nDome\nLight\nDoor\nActuated\nSwitch\nBrake\nLights\nL\nR\nBrake\nActuated\nSwitch\nLight\nSwitch\nOﬀ\nDimmer\nHi\nLo\nL\nR\nL\nR\nHeadlights\nL\nR\nRear\nLights\nL\nR\nParking\nLights\nThe designer of such a network needs to answer questions such as: how much\nelectricity ﬂows when both the hi-beam headlights and the brake lights are on?\n",
    "We will use linear systems to analyze simple electrical networks.\n",
    "For the analysis we need two facts about electricity and two facts about\nelectrical networks.\n",
    "The ﬁrst fact is that a battery is like a pump, providing a force impelling\nthe electricity to ﬂow, if there is a path.",
    "We say that the battery provides a\npotential.",
    "For instance, when the driver steps on the brake then the switch\nmakes contact and so makes a circuit on the left side of the diagram, which\nincludes the brake lights.",
    "Once the circuit exists, the battery’s force creates a\nﬂow through that circuit, called a current, lighting the lights.\n",
    "The second electrical fact is that in some kinds of network components the\namount of ﬂow is proportional to the force provided by the battery.",
    "That is, for\neach such component there is a number, its resistance, such that the potential\n\nTopic: Analyzing Networks\n77\nis equal to the ﬂow times the resistance.",
    "Potential is measured in volts, the\nrate of ﬂow is in amperes, and resistance to the ﬂow is in ohms; these units are\ndeﬁned so that volts = amperes · ohms.\n",
    "Components with this property, that the voltage-amperage response curve is\na line through the origin, are resistors.",
    "(Not every component has this property.\n",
    "For instance, as the light bulbs shown above heat up, their ohmage changes.)",
    "An\nexample is that if a resistor measures 2 ohms then wiring it to a 12 volt battery\nresults in a ﬂow of 6 amperes.",
    "Conversely, if electrical current of 2 amperes ﬂows\nthrough that resistor then there must be a 4 volt potential diﬀerence between\nits ends.",
    "This is the voltage drop across the resistor.",
    "One way to think of the\nelectrical circuits that we consider here is that the battery provides a voltage\nrise while the other components are voltage drops.\n",
    "The facts that we need about networks are Kirchoﬀ’s Current Law, that for\nany point in a network the ﬂow in equals the ﬂow out and Kirchoﬀ’s Voltage\nLaw, that around any circuit the total drop equals the total rise.\n",
    "We start with the network below.",
    "It has a battery that provides the potential\nto ﬂow and three resistors, shown as zig-zags.",
    "When components are wired one\nafter another, as here, they are in series.\n20 volt\npotential\n2 ohm\nresistance\n5 ohm\nresistance\n3 ohm\nresistance\nBy Kirchoﬀ’s Voltage Law, because the voltage rise is 20 volts, the total voltage\ndrop must also be 20 volts.",
    "Since the resistance from start to ﬁnish is 10 ohms\n(the resistance of the wire connecting the components is negligible), the current\nis (20/10) = 2 amperes.",
    "Now, by Kirchhoﬀ’s Current Law, there are 2 amperes\nthrough each resistor.",
    "Therefore the voltage drops are: 4 volts across the 2 ohm\nresistor, 10 volts across the 5 ohm resistor, and 6 volts across the 3 ohm resistor.\n",
    "The prior network is simple enough that we didn’t use a linear system but\nthe next one is more complicated.",
    "Here the resistors are in parallel.\n",
    "20 volt\n12 ohm\n8 ohm\nWe begin by labeling the branches as below.",
    "Let the current through the left\nbranch of the parallel portion be i1 and that through the right branch be i2,\n\n78\nChapter One.",
    "Linear Systems\nand also let the current through the battery be i0.",
    "Note that we don’t need to\nknow the actual direction of ﬂow — if current ﬂows in the direction opposite to\nour arrow then we will get a negative number in the solution.\n",
    "↑i0\ni1 ↓\n↓i2\nThe Current Law, applied to the split point in the upper right, gives that\ni0 = i1 + i2.",
    "Applied to the split point lower right it gives i1 + i2 = i0.",
    "In\nthe circuit that loops out of the top of the battery, down the left branch of the\nparallel portion, and back into the bottom of the battery, the voltage rise is\n20 while the voltage drop is i1 · 12, so the Voltage Law gives that 12i1 = 20.\n",
    "Similarly, the circuit from the battery to the right branch and back to the\nbattery gives that 8i2 = 20.",
    "And, in the circuit that simply loops around in the\nleft and right branches of the parallel portion (we arbitrarily take the direction\nof clockwise), there is a voltage rise of 0 and a voltage drop of 8i2 −12i1 so\n8i2 −12i1 = 0.\ni0 −\ni1 −i2 = 0\n−i0 +\ni1 + i2 = 0\n12i1\n= 20\n8i2 = 20\n−12i1 + 8i2 = 0\n",
    "The solution is i0 = 25/6, i1 = 5/3, and i2 = 5/2, all in amperes.",
    "(Incidentally,\nthis illustrates that redundant equations can arise in practice.)\n",
    "Kirchhoﬀ’s laws can establish the electrical properties of very complex net-\nworks.",
    "The next diagram shows ﬁve resistors, whose values are in ohms, wired\nin series-parallel.\n",
    "10 volt\n5\n2\n50\n10\n4\nThis is a Wheatstone bridge (see Exercise 3).",
    "To analyze it, we can place the\narrows in this way.\n\n",
    "Topic: Analyzing Networks\n79\n↑i0\ni1 ↙\n↘i2\ni5 →\ni3 ↘\n↙i4\nKirchhoﬀ’s Current Law, applied to the top node, the left node, the right node,\nand the bottom node gives these.\n",
    "i0 = i1 + i2\ni1 = i3 + i5\ni2 + i5 = i4\ni3 + i4 = i0\nKirchhoﬀ’s Voltage Law, applied to the inside loop (the i0 to i1 to i3 to i0 loop),\nthe outside loop, and the upper loop not involving the battery, gives these.\n5i1 + 10i3 = 10\n2i2 + 4i4 = 10\n5i1 + 50i5 −2i2 = 0\n",
    "Those suﬃce to determine the solution i0 = 7/3, i1 = 2/3, i2 = 5/3, i3 = 2/3,\ni4 = 5/3, and i5 = 0.\n",
    "We can understand many kinds of networks in this way.",
    "For instance, the\nexercises analyze some networks of streets.\n",
    "Exercises\n1 Calculate the amperages in each part of each network.\n",
    "(a) This is a simple network.\n",
    "9 volt\n3 ohm\n2 ohm\n2 ohm\n(b) Compare this one with the parallel case discussed above.\n",
    "9 volt\n3 ohm\n2 ohm\n2 ohm\n2 ohm\n\n80\nChapter One.",
    "Linear Systems\n(c)",
    "This is a reasonably complicated network.\n",
    "9 volt\n3 ohm\n3 ohm\n2 ohm\n2 ohm\n3 ohm\n4 ohm\n2 ohm\n2 In the ﬁrst network that we analyzed, with the three resistors in series, we just\nadded to get that they acted together like a single resistor of 10 ohms.",
    "We can do\na similar thing for parallel circuits.",
    "In the second circuit analyzed,\n20 volt\n12 ohm\n8 ohm\nthe electric current through the battery is 25/6 amperes.",
    "Thus, the parallel portion\nis equivalent to a single resistor of 20/(25/6) = 4.8 ohms.\n",
    "(a) What is the equivalent resistance if we change the 12 ohm resistor to 5 ohms?\n(b) What is the equivalent resistance if the two are each 8 ohms?\n",
    "(c) Find the formula for the equivalent resistance if the two resistors in parallel\nare r1 ohms and r2 ohms.\n",
    "3 A Wheatstone bridge is used to measure resistance.\n",
    "r1\nr3\nrg\nr2\nr4\nShow that in this circuit if the current ﬂowing through rg is zero then r4 = r2r3/r1.\n",
    "(To operate the device, put the unknown resistance at r4.",
    "At rg is a meter that\nshows the current.",
    "We vary the three resistances r1, r2, and r3 — typically they\neach have a calibrated knob — until the current in the middle reads 0.",
    "Then the\nequation gives the value of r4.)\n",
    "4 Consider this traﬃc circle.\n",
    "Main Street\nNorth Avenue\nPier Boulevard\n\nTopic: Analyzing Networks\n81\n",
    "This is the traﬃc volume, in units of cars per ten minutes.\n",
    "North\nPier\nMain\ninto\nout of\n100\n75\n150\n150\n25\n50\n",
    "We can set up equations to model how the traﬃc ﬂows.\n",
    "(a) Adapt Kirchhoﬀ’s Current Law to this circumstance.\n",
    "Is it a reasonable\nmodeling assumption?\n(b) Label the three between-road arcs in the circle with a variable: let i1 be the\nnumber of cars going from North Avenue to Main, let i2 be the number of cars\nbetween Main and Pier, and let i3 be the number between Pier and North.",
    "Using\nthe adapted law, for each of the three in-out intersections state an equation\ndescribing the traﬃc ﬂow at that node.\n",
    "(c) Solve that system.\n",
    "(d) Interpret your solution.\n",
    "(e) Restate the Voltage Law for this circumstance.",
    "How reasonable is it?\n5",
    "This is a network of streets.\n",
    "Shelburne St\nWillow\nWinooski Ave\nwest\neast\nJay Ln\nWe can observe the hourly ﬂow of cars into this network’s entrances, and out of its\nexits.\n",
    "east Winooski\nwest Winooski\nWillow\nJay\nShelburne\ninto\nout of\n80\n30\n50\n5\n65\n70\n–\n55\n40\n75\n(Note that to reach Jay a car must enter the network via some other road ﬁrst,\nwhich is why there is no ‘into Jay’ entry in the table.",
    "Note also that over a long\nperiod of time, the total in must approximately equal the total out, which is why\nboth rows add to 235 cars.)",
    "Once inside the network, the traﬃc may ﬂow in diﬀerent\nways, perhaps ﬁlling Willow and leaving Jay mostly empty, or perhaps ﬂowing in\nsome other way.",
    "Kirchhoﬀ’s Laws give the limits on that freedom.\n",
    "(a) Determine the restrictions on the ﬂow inside this network of streets by setting\nup a variable for each block, establishing the equations, and solving them.",
    "Notice\nthat some streets are one-way only.",
    "(Hint: this will not yield a unique solution,\nsince traﬃc can ﬂow through this network in various ways; you should get at\nleast one free variable.)\n",
    "(b) Suppose that someone proposes construction for Winooski Avenue East be-\ntween Willow and Jay, and traﬃc on that block will be reduced.",
    "What is the least\namount of traﬃc ﬂow that can we can allow on that block without disrupting\nthe hourly ﬂow into and out of the network?\n\n\n",
    "Chapter Two\nVector Spaces\nThe ﬁrst chapter ﬁnished with a fair understanding of how Gauss’s Method\nsolves a linear system.",
    "It systematically takes linear combinations of the rows.\n",
    "Here we move to a general study of linear combinations.\n",
    "We need a setting.",
    "At times in the ﬁrst chapter we’ve combined vectors from\nR2, at other times vectors from R3, and at other times vectors from higher-\ndimensional spaces.",
    "So our ﬁrst impulse might be to work in Rn, leaving n\nunspeciﬁed.",
    "This would have the advantage that any of the results would hold\nfor R2 and for R3 and for many other spaces, simultaneously.\n",
    "But if having the results apply to many spaces at once is advantageous then\nsticking only to Rn’s is restrictive.",
    "We’d like our results to apply to combinations\nof row vectors, as in the ﬁnal section of the ﬁrst chapter.",
    "We’ve even seen some\nspaces that are not simply a collection of all of the same-sized column vectors or\nrow vectors.",
    "For instance, we’ve seen a homogeneous system’s solution set that\nis a plane inside of R3.",
    "This set is a closed system in that a linear combination\nof these solutions is also a solution.",
    "But it does not contain all of the three-tall\ncolumn vectors, only some of them.\n",
    "We want the results about linear combinations to apply anywhere that linear\ncombinations make sense.",
    "We shall call any such set a vector space.",
    "Our results,\ninstead of being phrased as “Whenever we have a collection in which we can\nsensibly take linear combinations . . .",
    "”, will be stated “In any vector space . . .",
    "”\n",
    "Such a statement describes at once what happens in many spaces.\n",
    "To\nunderstand the advantages of moving from studying a single space to studying\na class of spaces, consider this analogy.",
    "Imagine that the government made\nlaws one person at a time: “Leslie Jones can’t jay walk.”",
    "That would be bad;\nstatements have the virtue of economy when they apply to many cases at once.\nOr suppose that they said, “Kim Ke must stop when passing an accident.”\n",
    "Contrast that with, “Any doctor must stop when passing an accident.”",
    "More\ngeneral statements, in some ways, are clearer.\n\n",
    "84\nChapter Two.",
    "Vector Spaces\nI\nDeﬁnition of Vector Space\n",
    "We shall study structures with two operations, an addition and a scalar multi-\nplication, that are subject to some simple conditions.",
    "We will reﬂect more on\nthe conditions later but on ﬁrst reading notice how reasonable they are.",
    "For\ninstance, surely any operation that can be called an addition (e.g., column vector\naddition, row vector addition, or real number addition) will satisfy conditions\n(1) through (5) below.\n",
    "I.1\nDeﬁnition and Examples\n1.1 Deﬁnition\nA vector space (over R) consists of a set V along with two\noperations ‘+’ and ‘·’ subject to the conditions that for all vectors ⃗v, ⃗w, ⃗u ∈V\nand all scalars r, s ∈R:\n(1) the set V is closed under vector addition, that is, ⃗v + ⃗w ∈V\n(2) vector addition is commutative, ⃗v + ⃗w = ⃗w +⃗v\n(3) vector addition is associative, (⃗v + ⃗w)",
    "+ ⃗u = ⃗v + (⃗w + ⃗u)\n(4) there is a zero vector ⃗0 ∈V such that ⃗v +⃗0 = ⃗v for all ⃗v ∈V\n(5) each ⃗v ∈V has an additive inverse ⃗w ∈V such that ⃗w +⃗v = ⃗0\n(6) the set V is closed under scalar multiplication, that is, r ·⃗v ∈V\n(7) scalar multiplication distributes over scalar addition, (r+s)·⃗v = r·⃗v+s·⃗v\n(8) scalar multiplication distributes over vector addition, r·(⃗v+ ⃗w) = r·⃗v+r· ⃗w\n(9) ordinary multiplication of scalars associates with scalar multiplication,\n(rs) ·⃗v = r · (s ·⃗v)\n(10) multiplication by the scalar 1 is the identity operation, 1 ·⃗v = ⃗v.\n",
    "1.2 Remark The deﬁnition involves two kinds of addition and two kinds of\nmultiplication, and so may at ﬁrst seem confused.",
    "For instance, in condition (7)\nthe ‘+’ on the left is addition of two real numbers while the ‘+’ on the right\nis addition of two vectors in V. These expressions aren’t ambiguous because\nof context; for example, r and s are real numbers so ‘r + s’ can only mean\nreal number addition.",
    "In the same way, item (9)’s left side ‘rs’ is ordinary real\nnumber multiplication, while its right side ‘s · ⃗v’ is the scalar multiplication\ndeﬁned for this vector space.\n",
    "The best way to understand the deﬁnition is to go through the examples below\nand for each, check all ten conditions.",
    "The ﬁrst example includes that check,\nwritten out at length.",
    "Use it as a model for the others.",
    "Especially important are\nthe closure conditions, (1) and (6).",
    "They specify that the addition and scalar\n\nSection I. Deﬁnition of Vector Space\n85\nmultiplication operations are always sensible — they are deﬁned for every pair of\nvectors and every scalar and vector, and the result of the operation is a member\nof the set.\n",
    "1.3 Example This subset of R2 is a line through the origin.\n",
    "L = {\n \nx\ny\n!\n",
    "| y = 3x}\nWe shall verify that it is a vector space under the usual meaning of ‘+’ and ‘·’.\n \n",
    "x1\ny1\n!\n",
    "+\n \nx2\ny2\n!\n=\n \nx1 + x2\ny1 + y2\n!\nr ·\n \nx\ny\n!\n=\n \nrx\nry\n!\n",
    "These operations are just the ordinary ones, reused on its subset L.",
    "We say that\nL inherits these operations from R2.\n",
    "We shall check all ten conditions.",
    "The paragraph having to do with addition\nhas ﬁve conditions.",
    "For condition (1), closure under addition, suppose that we\nstart with two vectors from the line L,\n⃗v1 =\n \nx1\ny1\n!\n⃗v2 =\n \nx2\ny2\n!\n",
    "so that they satisfy the restrictions that y1 = 3x1 and y2 = 3x2.",
    "Their sum\n⃗v1",
    "+⃗v2 =\n \nx1 + x2\ny1 + y2\n!\nis also a member of the line L because the fact that its second component is\nthree times its ﬁrst y1 + y2 = 3(x1 + x2) follows from the restrictions on ⃗v1\nand ⃗v2.",
    "For (2), that addition of vectors commutes, just compare\n⃗v1",
    "+⃗v2 =\n \nx1 + x2\ny1 + y2\n!\n",
    "⃗v2 +⃗v1 =\n \nx2 + x1\ny2 + y1\n!\nand note that they are equal since their entries are real numbers and real numbers\ncommute.",
    "(That the vectors satisfy the restriction of lying in the line is not\nrelevant for this condition; they commute just because all vectors in the plane\ncommute.)",
    "Condition (3), associativity of vector addition, is similar.\n",
    "(\n \nx1\ny1\n!\n",
    "+\n \nx2\ny2\n!\n)",
    "+\n \nx3\ny3\n!\n",
    "=\n \n(x1 + x2)",
    "+ x3\n(y1 + y2)",
    "+",
    "y3\n!\n=\n \nx1 + (x2 + x3)\ny1 + (y2 + y3)\n!\n=\n \nx1\ny1\n!\n",
    "+ (\n \nx2\ny2\n!\n",
    "+\n \nx3\ny3\n!\n)\n\n86\nChapter Two.",
    "Vector Spaces\nFor the fourth condition we must produce a vector that acts as the zero element.\n",
    "The vector of zero entries will do.\n \n",
    "x\ny\n!\n",
    "+\n \n0\n0\n!\n=\n \nx\ny\n!\nNote that ⃗0 ∈L as its second component is triple its ﬁrst.",
    "For (5), that given\nany ⃗v ∈L we can produce an additive inverse, we have\n \n−x\n−y\n!\n",
    "+\n \nx\ny\n!\n=\n \n0\n0\n!\n",
    "and so the vector −⃗v is the desired inverse.",
    "As with the prior condition, observe\nhere that if ⃗v ∈L, so that y = 3x, then −⃗v ∈L also, since −y = 3(−x).\n",
    "The checks for the ﬁve conditions having to do with scalar multiplication\nare similar.",
    "For (6), closure under scalar multiplication, suppose that r ∈R and\n⃗v ∈L, that is,\n⃗v =\n \nx\ny\n!\nsatisﬁes that y = 3x.",
    "Then\nr ·⃗v = r ·\n \nx\ny\n!\n=\n \nrx\nry\n!\nis also a member of L: the relation ry = 3 · rx holds because y = 3x.",
    "Next, this\nchecks (7).\n",
    "(r + s) ·\n \nx\ny\n!\n",
    "=\n \n(r + s)x\n(r + s)y\n!\n",
    "=\n \nrx + sx\nry + sy\n!\n",
    "= r ·\n \nx\ny\n!\n",
    "+ s ·\n \nx\ny\n!\n",
    "For (8) we have this.\nr · (\n \nx1\ny1\n!\n",
    "+\n \nx2\ny2\n!\n)",
    "=\n \nr(x1 + x2)\nr(y1 + y2)\n!\n=\n \nrx1 + rx2\nry1 + ry2\n!\n",
    "= r ·\n \nx1\ny1\n!\n+ r ·\n \nx2\ny2\n!\n",
    "The ninth\n(rs) ·\n \nx\ny\n!\n=\n \n(rs)x\n(rs)y\n!\n=\n \nr(sx)\nr(sy)\n!\n",
    "= r · (s ·\n \nx\ny\n!\n)\nand tenth conditions are also straightforward.\n",
    "1 ·\n \nx\ny\n!\n=\n \n1x\n1y\n!\n=\n \nx\ny\n!\n\nSection I. Deﬁnition of Vector Space\n87\n1.4 Example",
    "The whole plane, the set R2, is a vector space where the operations\n‘+’ and ‘·’ have their usual meaning.\n \n",
    "x1\ny1\n!\n",
    "+\n \nx2\ny2\n!\n=\n \nx1 + x2\ny1 + y2\n!\nr ·\n \nx\ny\n!\n=\n \nrx\nry\n!\n",
    "We shall check just two of the conditions, the closure conditions.\n",
    "For (1) observe that the result of the vector sum\n \nx1\ny1\n!\n",
    "+\n \nx2\ny2\n!\n=\n \nx1 + x2\ny1 + y2\n!\nis a column array with two real entries, and so is a member of the plane R2.",
    "In\ncontrast with the prior example, here there is no restriction on the ﬁrst and\nsecond components of the vectors.\n",
    "Condition (6) is similar.",
    "The vector\nr ·\n \nx\ny\n!\n=\n \nrx\nry\n!\nhas two real entries, and so is a member of R2.\n",
    "In a similar way, each Rn is a vector space with the usual operations of vector\naddition and scalar multiplication.",
    "(In R1, we usually do not write the members\nas column vectors, i.e., we usually do not write ‘(π)’.",
    "Instead we just write ‘π’.)\n",
    "1.5 Example Example 1.3 gives a subset of R2 that is a vector space.",
    "For contrast,\nconsider the set of two-tall columns with entries that are integers, under the\nsame operations of component-wise addition and scalar multiplication.",
    "This\nis a subset of R2 but it is not a vector space: it is not closed under scalar\nmultiplication, that is, it does not satisfy condition (6).",
    "For instance, on the left\nbelow is a vector with integer entries, and a scalar.\n",
    "0.5 ·\n \n4\n3\n!\n=\n \n2\n1.5\n!\n",
    "On the right is a column vector that is not a member of the set, since its entries\nare not all integers.\n",
    "1.6 Example The one-element set\n{\n\n\n\n\n\n0\n0\n0\n0\n\n\n\n\n}\n\n88\nChapter Two.",
    "Vector Spaces\nis a vector space under the operations\n\n\n\n\n\n0\n0\n0\n0\n\n\n\n\n+\n\n\n\n\n\n0\n0\n0\n0\n\n\n\n\n=\n\n\n\n\n\n0\n0\n0\n0\n\n\n\n\n\nr ·\n\n\n\n\n\n0\n0\n0\n0\n\n\n\n\n=\n\n\n\n\n\n0\n0\n0\n0\n\n\n\n\n\nthat it inherits from R4.\n",
    "A vector space must have at least one element, its zero vector.",
    "Thus a\none-element vector space is the smallest possible.\n",
    "1.7 Deﬁnition A one-element vector space is a trivial space.\n",
    "The examples so far involve sets of column vectors with the usual operations.\n",
    "But vector spaces need not be collections of column vectors, or even of row\nvectors.",
    "Below are some other types of vector spaces.",
    "The term ‘vector space’\ndoes not mean ‘collection of columns of reals’.",
    "It means something more like\n‘collection in which any linear combination is sensible’.\n",
    "1.8 Example Consider P3 = {a0 + a1x",
    "+ a2x2",
    "+ a3x3 | a0, . . .",
    ", a3 ∈R}, the set\nof polynomials of degree three or less (in this book, we’ll take constant polyno-\nmials, including the zero polynomial, to be of degree zero).",
    "It is a vector space\nunder the operations\n(a0 + a1x",
    "+ a2x2",
    "+ a3x3) + (b0 + b1x + b2x2 + b3x3)\n",
    "= (a0 + b0)",
    "+ (a1 + b1)x + (a2 + b2)x2 + (a3 + b3)x3\nand\nr · (a0 + a1x",
    "+ a2x2",
    "+ a3x3) = (ra0)",
    "+ (ra1)x + (ra2)x2 + (ra3)x3\n(the veriﬁcation is easy).",
    "This vector space is worthy of attention because these\nare the polynomial operations familiar from high school algebra.",
    "For instance,\n3 · (1 −2x + 3x2 −4x3) −2 · (2 −3x + x2 −(1/2)x3) = −1 +",
    "7x2 −11x3.\n",
    "Although this space is not a subset of any Rn, there is a sense in which we\ncan think of P3 as “the same” as R4.",
    "If we identify these two space’s elements in\nthis way\na0 +",
    "a1x",
    "+ a2x2",
    "+ a3x3\ncorresponds to\n\n\n\n\n\na0\na1\na2\na3\n\n\n\n\n\n\nSection I. Deﬁnition of Vector Space\n89\nthen the operations also correspond.\n",
    "Here is an example of corresponding\nadditions.\n",
    "1 −2x + 0x2 + 1x3\n+\n2 + 3x + 7x2 −4x3\n3 + 1x +",
    "7x2 −3x3\ncorresponds to\n\n\n\n\n\n1\n−2\n0\n1\n\n\n\n\n+\n\n\n\n\n\n2\n3\n7\n−4\n\n\n\n\n=\n\n\n\n\n\n3\n1\n7\n−3\n\n\n\n\n\n",
    "Things we are thinking of as “the same” add to “the same” sum.",
    "Chapter Three\nmakes precise this idea of vector space correspondence.",
    "For now we shall just\nleave it as an intuition.\n",
    "In general we write Pn for the vector space of polynomials of degree n or\nless {a0 +",
    "a1x",
    "+ a2x2",
    "+ · · · + anxn | a0, . .",
    ".",
    ", an ∈R}, under the operations of\nthe usual polynomial addition and scalar multiplication.",
    "We will often use these\nspaces as examples.\n",
    "1.9 Example The set M2×2 of 2×2 matrices with real number entries is a vector\nspace under the natural entry-by-entry operations.\n \n",
    "a\nb\nc\nd\n!\n",
    "+\n \nw\nx\ny\nz\n!\n",
    "=\n \na + w\nb",
    "+ x\nc + y\nd + z\n!\n",
    "r ·\n \na\nb\nc\nd\n!\n=\n \nra\nrb\nrc\nrd\n!\n",
    "As in the prior example, we can think of this space as “the same” as R4.\n",
    "We write Mn×m for the vector space of n×m matrices under the natural\noperations of matrix addition and scalar multiplication.",
    "As with the polynomial\nspaces, we will often use these as examples.\n",
    "1.10 Example The set {f | f: N →R} of all real-valued functions of one natural\nnumber variable is a vector space under the operations\n(f1 + f2) (n) = f1(n) + f2(n)\n(r · f) (n) = r f(n)\n",
    "so that if, for example, f1(n) = n2 + 2 sin(n) and f2(n) = −sin(n) + 0.5 then\n(f1 + 2f2) (n) = n2 + 1.\n",
    "We can view this space as a generalization of Example 1.4 — instead of 2-tall\nvectors, these functions are like inﬁnitely-tall vectors.\n",
    "n\nf(n)",
    "= n2 + 1\n0\n1\n1\n2\n2\n5\n3\n10\n...\n...\ncorresponds to\n\n\n\n\n\n\n\n\n1\n2\n5\n10\n...\n\n\n\n\n\n\n\n\n\n90\nChapter Two.",
    "Vector Spaces\nAddition and scalar multiplication are component-wise, as in Example 1.4.",
    "(We\ncan formalize “inﬁnitely-tall” by saying that it means an inﬁnite sequence, or\nthat it means a function from N to R.)\n1.11 Example The set of polynomials with real coeﬃcients\n{a0 + a1x",
    "+ · ·",
    "·",
    "+ anxn | n ∈N and a0, . .",
    ".",
    ", an ∈R}\nmakes a vector space when given the natural ‘+’\n(a0 + a1x + · · · + anxn)",
    "+",
    "(b0 + b1x + · · ·",
    "+ bnxn)\n= (a0 + b0) +",
    "(a1 + b1)x + · · · + (an + bn)xn\nand ‘·’.\n",
    "r · (a0 + a1x",
    "+ . . .",
    "anxn)",
    "= (ra0) + (ra1)x + . . .",
    "(ran)xn\nThis space diﬀers from the space P3 of Example 1.8.\n",
    "This space contains\nnot just degree three polynomials, but degree thirty polynomials and degree\nthree hundred polynomials, too.",
    "Each individual polynomial of course is of a\nﬁnite degree, but the set has no single bound on the degree of all of its members.\n",
    "We can think of this example, like the prior one, in terms of inﬁnite-tuples.\n",
    "For instance, we can think of 1 + 3x + 5x2 as corresponding to (1, 3, 5, 0, 0, . . .).\n",
    "However, this space diﬀers from the one in Example 1.10.",
    "Here, each member of\nthe set has a ﬁnite degree, that is, under the correspondence there is no element\nfrom this space matching (1, 2, 5, 10, . . . ).",
    "Vectors in this space correspond to\ninﬁnite-tuples that end in zeroes.\n",
    "1.12 Example The set {f | f: R →R} of all real-valued functions of one real\nvariable is a vector space under these.\n",
    "(f1 + f2) (x) = f1(x) + f2(x)\n(r · f) (x) = r f(x)\n",
    "The diﬀerence between this and Example 1.10 is the domain of the functions.\n",
    "1.13 Example The set F = {a cos θ + b sin θ | a, b ∈R} of real-valued functions of\nthe real variable θ is a vector space under the operations\n(a1 cos θ + b1 sin θ)",
    "+ (a2 cos θ + b2 sin θ) = (a1 + a2) cos θ + (b1 + b2) sin θ\nand\nr · (a cos θ + b sin θ) = (ra) cos θ",
    "+ (rb) sin θ\ninherited from the space in the prior example.",
    "(We can think of F as “the same”\nas R2 in that a cos θ + b sin θ corresponds to the vector with components a and\nb.)\n\nSection I. Deﬁnition of Vector Space\n91\n1.14 Example",
    "The set\n{f: R →R | d2f\ndx2 + f = 0}\nis a vector space under the, by now natural, interpretation.\n",
    "(f + g) (x) = f(x) + g(x)\n(r · f) (x) = r f(x)\n",
    "In particular, notice that basic Calculus gives\nd2(f",
    "+ g)\ndx2\n+ (f + g) = ( d2f\ndx2 + f)",
    "+",
    "(d2g\ndx2 + g)\nand\nd2(rf)\ndx2\n+ (rf) = r( d2f\ndx2 + f)\n",
    "and so the space is closed under addition and scalar multiplication.\n",
    "This\nturns out to equal the space from the prior example — functions satisfying\nthis diﬀerential equation have the form a cos θ + b sin θ — but this description\nsuggests an extension to solutions sets of other diﬀerential equations.\n",
    "1.15 Example The set of solutions of a homogeneous linear system in n variables is\na vector space under the operations inherited from Rn.",
    "For example, for closure\nunder addition consider a typical equation in that system c1x1 + · · ·",
    "+ cnxn = 0\nand suppose that both these vectors\n⃗v =\n\n\n\nv1\n...\nvn\n\n\n\n⃗w =\n\n\n\nw1\n...\n",
    "wn\n\n\n\nsatisfy the equation.",
    "Then their sum ⃗v + ⃗w also satisﬁes that equation: c1(v1 +\nw1) + · · · + cn(vn + wn) = (c1v1 + · · · + cnvn)",
    "+ (c1w1 + · · · + cnwn) = 0.",
    "The\nchecks of the other vector space conditions are just as routine.\n",
    "We often omit the multiplication symbol ‘·’ between the scalar and the vector.\n",
    "We distinguish the multiplication in c1v1 from that in r⃗v by context, since if\nboth multiplicands are real numbers then it must be real-real multiplication\nwhile if one is a vector then it must be scalar-vector multiplication.\n",
    "Example 1.15 has brought us full circle since it is one of our motivating\nexamples.",
    "Now, with some feel for the kinds of structures that satisfy the\ndeﬁnition of a vector space, we can reﬂect on that deﬁnition.",
    "For example, why\nspecify in the deﬁnition the condition that 1 · ⃗v = ⃗v but not a condition that\n0 ·⃗v = ⃗0?\n",
    "One answer is that this is just a deﬁnition — it gives the rules and you need\nto follow those rules to continue.\n\n",
    "92\nChapter Two.",
    "Vector Spaces\nAnother answer is perhaps more satisfying.",
    "People in this area have worked\nto develop the right balance of power and generality.",
    "This deﬁnition is shaped\nso that it contains the conditions needed to prove all of the interesting and\nimportant properties of spaces of linear combinations.",
    "As we proceed, we shall\nderive all of the properties natural to collections of linear combinations from the\nconditions given in the deﬁnition.\n",
    "The next result is an example.",
    "We do not need to include these properties\nin the deﬁnition of vector space because they follow from the properties already\nlisted there.\n",
    "1.16 Lemma In any vector space V, for any ⃗v ∈V and r ∈R, we have (1) 0·⃗v",
    "= ⃗0,\n(2) (−1 ·⃗v) +⃗v = ⃗0, and (3) r ·⃗0 = ⃗0.\n",
    "Proof For (1) note that ⃗v = (1 + 0) ·",
    "⃗v = ⃗v + (0 · ⃗v).",
    "Add to both sides the\nadditive inverse of ⃗v, the vector ⃗w such that ⃗w +⃗v = ⃗0.\n",
    "⃗w +⃗v = ⃗w +⃗v + 0 ·⃗v\n⃗0 = ⃗0 + 0 ·⃗v\n⃗0 = 0 ·⃗v\nItem (2) is easy: (−1 ·⃗v)",
    "+⃗v = (−1 + 1) ·⃗v = 0 ·⃗v = ⃗0.",
    "For (3), r ·⃗0 = r · (0 ·⃗0) =\n(r · 0) ·⃗0 = ⃗0 will do.\n",
    "QED\n",
    "The second item shows that we can write the additive inverse of ⃗v as ‘−⃗v ’\nwithout worrying about any confusion with (−1) ·",
    "⃗v.\n",
    "A recap: our study in Chapter One of Gaussian reduction led us to consider\ncollections of linear combinations.",
    "So in this chapter we have deﬁned a vector\nspace to be a structure in which we can form such combinations, subject to\nsimple conditions on the addition and scalar multiplication operations.",
    "In a\nphrase: vector spaces are the right context in which to study linearity.\n",
    "From the fact that it forms a whole chapter, and especially because that\nchapter is the ﬁrst one, a reader could suppose that our purpose in this book is\nthe study of linear systems.",
    "The truth is that we will not so much use vector\nspaces in the study of linear systems as we instead have linear systems start us\non the study of vector spaces.",
    "The wide variety of examples from this subsection\nshows that the study of vector spaces is interesting and important in its own\nright.",
    "Linear systems won’t go away.",
    "But from now on our primary objects of\nstudy will be vector spaces.\n",
    "Exercises\n1.17 Name the zero vector for each of these vector spaces.\n",
    "(a) The space of degree three polynomials under the natural operations.\n\n",
    "Section I. Deﬁnition of Vector Space\n93\n(b)",
    "The space of 2×4 matrices.\n",
    "(c)",
    "The space {f: [0..1] →R | f is continuous}.\n",
    "(d)",
    "The space of real-valued functions of one natural number variable.\n",
    "✓1.18 Find the additive inverse, in the vector space, of the vector.\n",
    "(a) In P3, the vector −3",
    "−2x + x2.\n",
    "(b) In the space 2×2,\n\u00121\n−1\n0\n3\n\u0013\n.\n",
    "(c) In {aex + be−x | a, b ∈R}, the space of functions of the real variable x under\nthe natural operations, the vector 3ex −2e−x.\n✓1.19 For each, list three elements and then show it is a vector space.\n",
    "(a) The set of linear polynomials P1 = {a0 + a1x | a0, a1 ∈R} under the usual\npolynomial addition and scalar multiplication operations.\n",
    "(b) The set of linear polynomials {a0 + a1x | a0 −2a1 = 0}, under the usual poly-\nnomial addition and scalar multiplication operations.\n",
    "Hint.",
    "Use Example 1.3 as a guide.",
    "Most of the ten conditions are just veriﬁcations.\n",
    "1.20 For each, list three elements and then show it is a vector space.\n",
    "(a) The set of 2×2 matrices with real entries under the usual matrix operations.\n",
    "(b) The set of 2×2 matrices with real entries where the 2, 1 entry is zero, under\nthe usual matrix operations.\n",
    "✓1.21 For each, list three elements and then show it is a vector space.\n",
    "(a) The set of three-component row vectors with their usual operations.\n",
    "(b) The set\n{\n\n\n\n\nx\ny\nz\nw\n\n\n\n∈R4",
    "| x",
    "+ y −z + w = 0}\nunder the operations inherited from R4.\n",
    "✓1.22 Show that each of these is not a vector space.",
    "(Hint.",
    "Check closure by listing\ntwo members of each set and trying some operations on them.)\n",
    "(a) Under the operations inherited from R3, this set\n{\n\n\nx\ny\nz\n\n∈R3 | x",
    "+ y + z = 1}\n(b) Under the operations inherited from R3, this set\n{\n\n\nx\ny\nz\n\n∈R3",
    "| x2 + y2 +",
    "z2 = 1}\n(c) Under the usual matrix operations,\n{\n\u0012a\n1\nb\nc\n\u0013\n| a, b, c ∈R}\n(d) Under the usual polynomial operations,\n{a0 + a1x + a2x2 | a0, a1, a2 ∈R+ }\nwhere R+ is the set of reals greater than zero\n\n94\nChapter Two.",
    "Vector Spaces\n(e) Under the inherited operations,\n{\n\u0012x\ny\n\u0013\n∈R2 | x + 3y = 4 and 2x −y = 3 and 6x +",
    "4y = 10}\n1.23 Deﬁne addition and scalar multiplication operations to make the complex\nnumbers a vector space over R.\n1.24 Is the set of rational numbers a vector space over R under the usual addition\nand scalar multiplication operations?\n1.25 Show that the set of linear combinations of the variables x, y, z is a vector space\nunder the natural addition and scalar multiplication operations.\n",
    "1.26 Prove that this is not a vector space: the set of two-tall column vectors with\nreal entries subject to these operations.\n",
    "\u0012x1\ny1\n\u0013\n+\n\u0012x2\ny2\n\u0013\n=\n\u0012x1 −x2\ny1 −y2\n\u0013\nr ·\n\u0012x\ny\n\u0013\n=\n\u0012rx\nry\n\u0013\n1.27 Prove or disprove that R3 is a vector space under these operations.\n",
    "(a)\n\n\nx1\ny1\nz1\n\n+\n\n\nx2\ny2\nz2\n\n",
    "=\n\n\n0\n0\n0\n\n\nand\nr\n\n\nx\ny\nz\n\n=\n\n\nrx\nry\nrz\n\n\n(b)\n\n\nx1\ny1\nz1\n\n+\n\n\nx2\ny2\nz2\n\n",
    "=\n\n\n0\n0\n0\n\n\nand\nr\n\n\nx\ny\nz\n\n=\n\n\n0\n0\n0\n\n\n✓1.28 For each, decide if it is a vector space; the intended operations are the natural\nones.\n",
    "(a) The diagonal 2×2 matrices\n{\n\u0012a\n0\n0\nb\n\u0013\n| a, b ∈R}\n(b)",
    "This set of 2×2 matrices\n{\n\u0012\nx\nx + y\nx + y\ny\n\u0013\n| x, y ∈R}\n(c)",
    "This set\n{\n\n\n\n\nx\ny\nz\nw\n\n\n\n∈R4",
    "| x",
    "+ y + z + w = 1}\n(d)",
    "The set of functions {f: R →R | df/dx + 2f = 0}\n(e) The set of functions {f: R →R | df/dx + 2f = 1}\n✓1.29 Prove or disprove that this is a vector space: the real-valued functions f of one\nreal variable such that f(7) = 0.\n✓1.30 Show that the set R+ of positive reals is a vector space when we interpret ‘x+y’\nto mean the product of x and y (so that 2 + 3 is 6), and we interpret ‘r · x’ as the\nr-th power of x.\n1.31 Is {(x, y) | x, y ∈R} a vector space under these operations?\n(a) (x1, y1) +",
    "(x2, y2) = (x1 + x2, y1 + y2) and r · (x, y) = (rx, y)\n(b) (x1, y1) + (x2, y2) = (x1 + x2, y1 + y2) and r · (x, y) = (rx, 0)\n\nSection I. Deﬁnition of Vector Space\n95\n1.32 Prove or disprove that this is a vector space: the set of polynomials of degree\ngreater than or equal to two, along with the zero polynomial.\n",
    "1.33 At this point “the same” is only an intuition, but nonetheless for each vector\nspace identify the k for which the space is “the same” as Rk.\n(a) The 2×3 matrices under the usual operations\n(b) The n×m matrices (under their usual operations)\n(c)",
    "This set of 2×2 matrices\n{\n\u0012a\n0\nb\nc\n\u0013\n| a, b, c ∈R}\n(d) This set of 2×2 matrices\n{\n\u0012a\n0\nb\nc\n\u0013\n| a + b + c = 0}\n1.34 Using ⃗+ to represent vector addition and ⃗· for scalar multiplication, restate\nthe deﬁnition of vector space.\n",
    "1.35 Prove these.\n",
    "(a) For any ⃗v ∈V, if ⃗w ∈V is an additive inverse of ⃗v, then ⃗v is an additive\ninverse of ⃗w.",
    "So a vector is an additive inverse of any additive inverse of itself.\n",
    "(b) Vector addition left-cancels: if ⃗v,⃗s,⃗t ∈V then ⃗v +⃗s = ⃗v +⃗t implies that ⃗s = ⃗t.\n",
    "1.36",
    "The deﬁnition of vector spaces does not explicitly say that ⃗0 +⃗v = ⃗v (it instead\nsays that ⃗v +⃗0 = ⃗v).",
    "Show that it must nonetheless hold in any vector space.\n",
    "✓1.37 Prove or disprove that this is a vector space: the set of all matrices, under the\nusual operations.\n",
    "1.38",
    "In a vector space every element has an additive inverse.",
    "Can some elements\nhave two or more?\n1.39\n(a) Prove that every point, line, or plane through the origin in R3 is a vector\nspace under the inherited operations.\n",
    "(b)",
    "What if it doesn’t contain the origin?\n1.40 Using the idea of a vector space we can easily reprove that the solution set of\na homogeneous linear system has either one element or inﬁnitely many elements.\n",
    "Assume that ⃗v ∈V is not ⃗0.\n",
    "(a) Prove that r ·⃗v = ⃗0 if and only if r = 0.\n",
    "(b) Prove that r1 ·⃗v = r2 ·⃗v if and only if r1 = r2.\n",
    "(c) Prove that any nontrivial vector space is inﬁnite.\n",
    "(d) Use the fact that a nonempty solution set of a homogeneous linear system is\na vector space to draw the conclusion.\n",
    "1.41 Is this a vector space under the natural operations: the real-valued functions of\none real variable that are diﬀerentiable?\n1.42",
    "A vector space over the complex numbers C has the same deﬁnition as a vector\nspace over the reals except that scalars are drawn from C instead of from R. Show\nthat each of these is a vector space over the complex numbers.",
    "(Recall how complex\nnumbers add and multiply: (a0 + a1i)",
    "+ (b0 + b1i) = (a0 + b0)",
    "+ (a1 + b1)i and\n(a0 + a1i)(b0 + b1i)",
    "= (a0b0 −a1b1)",
    "+ (a0b1 + a1b0)i.)\n(a) The set of degree two polynomials with complex coeﬃcients\n\n96\nChapter Two.",
    "Vector Spaces\n(b)",
    "This set\n{\n\u00120\na\nb\n0\n\u0013\n| a, b ∈C and a + b = 0 + 0i}\n1.43 Name a property shared by all of the Rn’s but not listed as a requirement for a\nvector space.\n",
    "1.44\n(a) Prove that for any four vectors ⃗v1, . . .",
    ",⃗v4 ∈V we can associate their sum\nin any way without changing the result.\n",
    "((⃗v1 +⃗v2) +⃗v3)",
    "+⃗v4 = (⃗v1 + (⃗v2 +⃗v3))",
    "+⃗v4 = (⃗v1 +⃗v2)",
    "+ (⃗v3 +⃗v4)\n= ⃗v1",
    "+ ((⃗v2 +⃗v3)",
    "+⃗v4) = ⃗v1",
    "+ (⃗v2 + (⃗v3 +⃗v4))\n",
    "This allows us to write ‘⃗v1 +⃗v2 +⃗v3 +⃗v4’ without ambiguity.\n",
    "(b) Prove that any two ways of associating a sum of any number of vectors give\nthe same sum.",
    "(Hint.",
    "Use induction on the number of vectors.)\n",
    "1.45 Example 1.5 gives a subset of R2 that is not a vector space, under the obvious\noperations, because while it is closed under addition, it is not closed under scalar\nmultiplication.",
    "Consider the set of vectors in the plane whose components have\nthe same sign or are 0.",
    "Show that this set is closed under scalar multiplication but\nnot addition.\n",
    "I.2\nSubspaces and Spanning Sets\n",
    "In Example 1.3 we saw a vector space that is a subset of R2, a line through the\norigin.",
    "There, the vector space R2 contains inside it another vector space, the\nline.\n2.1 Deﬁnition For any vector space, a subspace is a subset that is itself a vector\nspace, under the inherited operations.\n",
    "2.2 Example This plane through the origin\nP = {\n\n\n\nx\ny\nz\n\n\n|",
    "x + y + z = 0}\nis a subspace of R3.",
    "As required by the deﬁnition the plane’s operations are\ninherited from the larger space, that is, vectors add in P as they add in R3\n\n\n\nx1\ny1\nz1\n\n",
    "\n+\n\n\n\nx2\ny2\nz2\n\n\n=\n\n\n\nx1 + x2\ny1 + y2\nz1 + z2\n\n\n\n\nSection I. Deﬁnition of Vector Space\n97\nand scalar multiplication is also the same as in R3.\nTo show that P is a\nsubspace we need only note that it is a subset and then verify that it is a\nspace.",
    "We won’t check all ten conditions, just the two closure ones.",
    "For closure\nunder addition, note that if the summands satisfy that x1 + y1 + z1 = 0 and\nx2 + y2 + z2 = 0",
    "then the sum satisﬁes that (x1 + x2)",
    "+ (y1 + y2)",
    "+",
    "(z1 + z2) =\n(x1 + y1 + z1)",
    "+ (x2 + y2 + z2)",
    "= 0.",
    "For closure under scalar multiplication, if\nx + y + z = 0 then the scalar multiple has rx + ry + rz = r(x + y + z) = 0.\n2.3 Example",
    "The x-axis in R2 is a subspace, where the addition and scalar\nmultiplication operations are the inherited ones.\n \n",
    "x1\n0\n!\n+\n \nx2\n0\n!\n",
    "=\n \nx1 + x2\n0\n!\nr ·\n \nx\n0\n!\n=\n \nrx\n0\n!\n",
    "As in the prior example, to verify directly from the deﬁnition that this is a\nsubspace we simply note that it is a subset and then check that it satisﬁes the\nconditions in deﬁnition of a vector space.",
    "For instance the two closure conditions\nare satisﬁed: adding two vectors with a second component of zero results in a\nvector with a second component of zero and multiplying a scalar times a vector\nwith a second component of zero results in a vector with a second component of\nzero.\n",
    "2.4 Example Another subspace of R2 is its trivial subspace.\n",
    "{\n \n0\n0\n!\n}\nAny vector space has a trivial subspace {⃗0 }.",
    "At the opposite extreme, any\nvector space has itself for a subspace.",
    "A subspace that is not the entire space is\na proper subspace.\n",
    "2.5 Example Vector spaces that are not Rn’s also have subspaces.",
    "The space of\ncubic polynomials {a + bx + cx2 + dx3 | a, b, c, d ∈R} has a subspace comprised\nof all linear polynomials {m + nx | m, n ∈R}.\n",
    "2.6 Example Another example of a subspace that is not a subset of an Rn followed\nthe deﬁnition of a vector space.",
    "The space in Example 1.12 of all real-valued\nfunctions of one real variable {f | f: R →R} has the subspace in Example 1.14\nof functions satisfying the restriction (d2 f/dx2)",
    "+",
    "f = 0.\n",
    "2.7 Example The deﬁnition requires that the addition and scalar multiplication\noperations must be the ones inherited from the larger space.",
    "The set S = {1} is\na subset of R1.",
    "And, under the operations 1 + 1 = 1 and r · 1 = 1 the set S is\na vector space, speciﬁcally, a trivial space.",
    "However, S is not a subspace of R1\nbecause those aren’t the inherited operations, since of course R1 has 1 + 1 = 2.\n\n98\nChapter Two.",
    "Vector Spaces\n2.8 Example Being vector spaces themselves",
    ", subspaces must satisfy the closure\nconditions.",
    "The set R+ is not a subspace of the vector space R1 because with\nthe inherited operations it is not closed under scalar multiplication: if ⃗v = 1\nthen −1 ·⃗v ̸∈R+.\n",
    "The next result says that Example 2.8 is prototypical.",
    "The only way that\na subset can fail to be a subspace, if it is nonempty and uses the inherited\noperations, is if it isn’t closed.\n",
    "2.9 Lemma For a nonempty subset S of a vector space, under the inherited\noperations the following are equivalent statements.∗\n(1) S is a subspace of that vector space\n(2) S is closed under linear combinations of pairs of vectors: for any vectors\n⃗s1,⃗s2 ∈S and scalars r1, r2 the vector r1⃗s1",
    "+ r2⃗s2 is in S\n(3) S is closed under linear combinations of any number of vectors: for any\nvectors ⃗s1, . . .",
    ",⃗sn ∈S and scalars r1, . .",
    ".",
    ", rn the vector r1⃗s1 + · · · + rn⃗sn is\nan element of S.\nBrieﬂy, a subset is a subspace if and only if it is closed under linear combinations.\n",
    "Proof ‘The following are equivalent’ means that each pair of statements are\nequivalent.\n",
    "(1) ⇐⇒(2)\n(2) ⇐⇒(3)\n(3) ⇐⇒(1)\n",
    "We will prove the equivalence by establishing that (1) =⇒(3) =⇒(2) =⇒(1).\n",
    "This strategy is suggested by the observation that the implications (1) =⇒(3)\nand (3) =⇒(2) are easy and so we need only argue that (2) =⇒(1).\n",
    "Assume that S is a nonempty subset of a vector space V that is closed under\ncombinations of pairs of vectors.",
    "We will show that S is a vector space by\nchecking the conditions.\n",
    "The vector space deﬁnition has ﬁve conditions on addition.",
    "First, for closure\nunder addition, if ⃗s1,⃗s2 ∈S then ⃗s1 + ⃗s2 ∈S, as it is a combination of a pair\nof vectors and we are assuming that S is closed under those.",
    "Second, for any\n⃗s1,⃗s2 ∈S, because addition is inherited from V, the sum ⃗s1 +⃗s2 in S equals the\nsum ⃗s1 + ⃗s2 in V, and that equals the sum ⃗s2",
    "+ ⃗s1 in V (because V is a vector\nspace, its addition is commutative), and that in turn equals the sum ⃗s2",
    "+ ⃗s1 in\nS. The argument for the third condition is similar to that for the second.",
    "For\nthe fourth, consider the zero vector of V and note that closure of S under linear\ncombinations of pairs of vectors gives that 0 · ⃗s + 0 · ⃗s = ⃗0 is an element of S\n(where ⃗s is any member of the nonempty set S); checking that ⃗0 acts under the\ninherited operations as the additive identity of S is easy.",
    "The ﬁfth condition\n∗More information on equivalence of statements is in the appendix.\n\nSection I. Deﬁnition of Vector Space\n99\nis satisﬁed because for any ⃗s ∈S, closure under linear combinations of pairs of\nvectors shows that 0 · ⃗0 + (−1) ·",
    "⃗s is an element of S, and it is obviously the\nadditive inverse of ⃗s under the inherited operations.",
    "The veriﬁcations for the\nscalar multiplication conditions are similar; see Exercise 35.\n",
    "QED\n",
    "We will usually verify that a subset is a subspace by checking that it satisﬁes\nstatement (2).\n",
    "2.10 Remark At the start of this chapter we introduced vector spaces as collections\nin which linear combinations “make sense.”",
    "Lemma 2.9’s statements (1)-(3) say\nthat we can always make sense of an expression like r1⃗s1 + r2⃗s2 in that the\nvector described is in the set S.\n",
    "As a contrast, consider the set T of two-tall vectors whose entries add to\na number greater than or equal to zero.",
    "Here we cannot just write any linear\ncombination such as 2⃗t1 −3⃗t2 and be conﬁdent the result is an element of T.\nLemma 2.9 suggests that a good way to think of a vector space is as a\ncollection of unrestricted linear combinations.",
    "The next two examples take some\nspaces and recasts their descriptions to be in that form.\n",
    "2.11 Example We can show that this plane through the origin subset of R3\nS = {\n\n\n\nx\ny\nz\n\n\n|",
    "x",
    "−2y + z = 0}\nis a subspace under the usual addition and scalar multiplication operations\nof column vectors by checking that it is nonempty and closed under linear\ncombinations of two vectors.",
    "But there is another way.",
    "Think of x −2y + z = 0\nas a one-equation linear system and parametrize it by expressing the leading\nvariable in terms of the free variables x",
    "= 2y −z.\n",
    "S = {\n\n\n\n2y −z\ny\nz\n\n\n| y, z ∈R} = {y\n\n\n\n2\n1\n0\n\n\n+ z\n\n\n\n−1\n0\n1\n\n\n| y, z ∈R}\n(∗)\n",
    "Now, to show that this is a subspace consider r1⃗s1 + r2⃗s2.",
    "Each ⃗si is a linear\ncombination of the two vectors in (∗) so this is a linear combination of linear\ncombinations.\nr1 · (y1\n\n\n\n2\n1\n0\n\n\n+ z1\n\n\n\n−1\n0\n1\n\n\n) + r2 · (y2\n\n\n\n2\n1\n0\n\n\n+ z2\n\n\n\n−1\n0\n1\n\n\n)\n",
    "The Linear Combination Lemma, Lemma One.III.2.3, shows that the total is\na linear combination of the two vectors and so Lemma 2.9’s statement (2) is\nsatisﬁed.\n\n100\nChapter Two.",
    "Vector Spaces\n2.12 Example",
    "This is a subspace of the 2×2 matrices M2×2.\n",
    "L = {\n \na\n0\nb\nc\n!\n",
    "| a + b + c = 0}\nTo parametrize, express the condition as a = −b −c.\n",
    "L = {\n \n−b −c\n0\nb\nc\n!\n| b, c ∈R} = {b\n \n−1\n0\n1\n0\n!\n",
    "+ c\n \n−1\n0\n0\n1\n!\n| b, c ∈R}\nAs above, we’ve described the subspace as a collection of unrestricted linear\ncombinations.",
    "To show it is a subspace, note that a linear combination of vectors\nfrom L is a linear combination of linear combinations and so statement (2) is\ntrue.\n",
    "2.13 Deﬁnition The span (or linear closure) of a nonempty subset S of a vector\nspace is the set of all linear combinations of vectors from S.\n",
    "[S] = {c1⃗s1 + · · ·",
    "+ cn⃗sn | c1, . . .",
    ", cn ∈R and ⃗s1, . . .",
    ",⃗sn ∈S}\n",
    "The span of the empty subset of a vector space is its trivial subspace.\n",
    "No notation for the span is completely standard.",
    "The square brackets used here\nare common but so are ‘span(S)’ and ‘sp(S)’.\n",
    "2.14 Remark In Chapter One, after we showed that we can write the solution\nset of a homogeneous linear system as {c1⃗β1 + · · · + ck⃗βk | c1, . . .",
    ", ck ∈R}, we\ndescribed that as the set ‘generated’ by the ⃗β’s.",
    "We now call that the span of\n{⃗β1, . . .",
    ", ⃗βk}.\n",
    "Recall also from that proof that the span of the empty set is deﬁned to\nbe the set {⃗0} because of the convention that a trivial linear combination, a\ncombination of zero-many vectors, adds to ⃗0.",
    "Besides, deﬁning the empty set’s\nspan to be the trivial subspace is convenient because it keeps results like the\nnext one from needing exceptions for the empty set.\n",
    "2.15 Lemma In a vector space, the span of any subset is a subspace.\n",
    "Proof If the subset S is empty then by deﬁnition its span is the trivial subspace.\n",
    "If S is not empty then by Lemma 2.9 we need only check that the span",
    "[S] is\nclosed under linear combinations of pairs of elements.",
    "For a pair of vectors from\nthat span, ⃗v = c1⃗s1 + · · · + cn⃗sn and ⃗w = cn+1⃗sn+1 + · · · + cm⃗sm, a linear\ncombination\np · (c1⃗s1 + · · · + cn⃗sn) + r · (cn+1⃗sn+1 + · · · + cm⃗sm)\n= pc1⃗s1 + · · · + pcn⃗sn + rcn+1⃗sn+1 + · · ·",
    "+ rcm⃗sm\n\nSection I. Deﬁnition of Vector Space\n101\nis a linear combination of elements of S and so is an element of [S] (possibly\nsome of the ⃗si’s from ⃗v equal some of the ⃗sj’s from ⃗w but that does not matter).\n",
    "QED\nThe converse of the lemma holds: any subspace is the span of some set,\nbecause a subspace is obviously the span of itself, the set of all of its members.\n",
    "Thus a subset of a vector space is a subspace if and only if it is a span.",
    "This\nﬁts the intuition that a good way to think of a vector space is as a collection in\nwhich linear combinations are sensible.\n",
    "Taken together, Lemma 2.9 and Lemma 2.15 show that the span of a subset\nS of a vector space is the smallest subspace containing all of the members of S.\n",
    "2.16 Example",
    "In any vector space V, for any vector ⃗v ∈V, the set {r ·⃗v | r ∈R}\nis a subspace of V. For instance, for any vector ⃗v ∈R3 the line through the\norigin containing that vector {k⃗v | k ∈R} is a subspace of R3.",
    "This is true even\nif ⃗v is the zero vector, in which case it is the degenerate line, the trivial subspace.\n",
    "2.17 Example",
    "The span of this set is all of R2.\n",
    "{\n \n1\n1\n!\n,\n \n1\n−1\n!\n",
    "}\nWe know that the span is some subspace of R2.",
    "To check that it is all of R2 we\nmust show that any member of R2 is a linear combination of these two vectors.\n",
    "So we ask: for which vectors with real components x and y are there scalars c1\nand c2 such that this holds?\n",
    "c1\n \n1\n1\n!\n",
    "+ c2\n \n1\n−1\n!\n=\n \nx\ny\n!\n",
    "(∗)\nGauss’s Method\nc1 + c2 = x\nc1 −c2 = y\n−ρ1+ρ2\n−→\nc1 +\nc2 =\nx\n−2c2 = −x",
    "+",
    "y\nwith back substitution gives c2 = (x −y)/2 and c1 = (x + y)/2.",
    "This shows\nthat for any x, y there are appropriate coeﬃcients c1, c2 making (∗) true — we\ncan write any element of R2 as a linear combination of the two given ones.",
    "For\ninstance, for x = 1 and y = 2 the coeﬃcients c2 = −1/2 and c1 = 3/2 will do.\n",
    "Since spans are subspaces, and we know that a good way to understand a\nsubspace is to parametrize its description, we can try to understand a set’s span\nin that way.\n",
    "2.18 Example Consider, in the vector space of quadratic polynomials P2, the\nspan of the set S = {3x −x2, 2x}.",
    "By the deﬁnition of span, it is the set of\n\n102\nChapter Two.",
    "Vector Spaces\nunrestricted linear combinations of the two {c1(3x −x2)",
    "+ c2(2x) | c1, c2 ∈R}.\n",
    "Clearly polynomials in this span must have a constant term of zero.",
    "Is that\nnecessary condition also suﬃcient?\n",
    "We are asking: for which members a2x2",
    "+",
    "a1x + a0 of P2 are there c1 and c2\nsuch that a2x2",
    "+ a1x",
    "+ a0 = c1(3x −x2)",
    "+ c2(2x)?",
    "Polynomials are equal when\ntheir coeﬃcients are equal so we want conditions on a2, a1, and a0 making that\ntriple a solution of this system.\n",
    "−c1\n= a2\n3c1 + 2c2 = a1\n0 = a0\nGauss’s Method and back-substitution gives c1 = −a2, and c2 = (3/2)a2 +\n(1/2)a1, and 0 = a0.",
    "Thus as long as there is no constant term a0 = 0 we can\ngive coeﬃcients c1 and c2 to describe that polynomial as an element of the\nspan.",
    "For instance, for the polynomial 0 −4x + 3x2, the coeﬃcients c1 = −3 and\nc2 = 5/2 will do.",
    "So the span of the given set is [S] = {a1x + a2x2 | a1, a2 ∈R}.\n",
    "Incidentally, this shows that the set {x, x2} spans the same subspace.",
    "A space\ncan have more than one spanning set.",
    "Two other sets spanning this subspace\nare {x, x2, −x + 2x2 } and {x, x + x2, x + 2x2, . . .",
    "}.\n",
    "2.19 Example The picture below shows the subspaces of R3 that we now know\nof: the trivial subspace, lines through the origin, planes through the origin, and\nthe whole space.",
    "(Of course, the picture shows only a few of the inﬁnitely many\ncases.",
    "Line segments connect subsets with their supersets.)",
    "In the next section\nwe will prove that R3 has no other kind of subspace, so in fact this lists them all.\n",
    "This describes each subspace as the span of a set with a minimal number\nof members.",
    "With this, the subspaces fall naturally into levels — planes on one\nlevel, lines on another, etc.\n{x\n\n\n1\n0\n0\n\n+ y\n\n\n0\n1\n0\n\n",
    "+ z\n\n\n0\n0\n1\n\n}\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\n\u0018\n{x\n\n\n1\n0\n0\n\n+ y\n\n\n0\n1\n0\n\n}\n\u0010\n\u0010\n\u0010\n\u0010\n\u0010\n{x\n\n\n1\n0\n0\n\n+ z\n\n\n0\n0\n1\n\n}\n\u0000\u0000{x\n\n\n1\n1\n0\n\n+ z\n\n\n0\n0\n1\n\n}\n· · ·\n\u0003\u0003\n\u0010\n\u0010\n\u0010\n\u0010\n\u0010\n\u0010\n{x\n\n\n1\n0\n0\n\n}\nAA\n{y\n\n\n0\n1\n0\n\n}\nHHHH\n{y\n\n\n2\n1\n0\n\n}\n\u0000\u0000{y\n\n\n1\n1\n1\n\n}\n· · ·\nXXXXXXXXXXXX\nPPPPPPPP\nHHHH AA\n{\n\n\n0\n0\n0\n\n}\n\nSection I. Deﬁnition of Vector Space\n103\nSo far in this chapter we have seen that to study the properties of linear\ncombinations, the right setting is a collection that is closed under these combi-\nnations.",
    "In the ﬁrst subsection we introduced such collections, vector spaces,\nand we saw a great variety of examples.",
    "In this subsection we saw still more\nspaces, ones that are subspaces of others.",
    "In all of the variety there is a com-\nmonality.",
    "Example 2.19 above brings it out: vector spaces and subspaces are\nbest understood as a span, and especially as a span of a small number of vectors.\n",
    "The next section studies spanning sets that are minimal.\n",
    "Exercises\n✓2.20 Which of these subsets of the vector space of 2×2 matrices are subspaces\nunder the inherited operations?",
    "For each one that is a subspace, parametrize its\ndescription.",
    "For each that is not, give a condition that fails.\n",
    "(a) {\n\u0012a\n0\n0\nb\n\u0013\n| a, b ∈R}\n(b) {\n\u0012a\n0\n0\nb\n\u0013\n| a + b = 0}\n(c) {\n\u0012a\n0\n0\nb\n\u0013\n| a + b = 5}\n(d) {\n\u0012a\nc\n0\nb\n\u0013\n| a + b = 0, c ∈R}\n✓2.21 Is this a subspace of P2: {a0 +",
    "a1x",
    "+ a2x2",
    "| a0 + 2a1 + a2 = 4}?",
    "If it is then\nparametrize its description.\n",
    "2.22 Is the vector in the span of the set?\n",
    "\n\n1\n0\n3\n\n\n{\n\n\n2\n1\n−1\n\n,\n\n\n1\n−1\n1\n\n}\n✓2.23 Decide if the vector lies in the span of the set, inside of the space.\n",
    "(a)\n\n\n2\n0\n1\n\n, {\n\n\n1\n0\n0\n\n,\n\n\n0\n0\n1\n\n}, in R3\n(b) x −x3, {x2, 2x + x2, x + x3 }, in P3\n(c)\n\u00120\n1\n4\n2\n\u0013\n, {\n\u00121\n0\n1\n1\n\u0013\n,\n\u00122\n0\n2\n3\n\u0013\n}, in M2×2\n2.24",
    "[Cleary]",
    "A superhero is at the origin of a two dimensional plane.",
    "The superhero\nhas two devices, a hoverboard that moves any distance in the direction\n\u00003\n1\n\u0001\nand a\nmagic carpet that moves any distance in the direction\n\u00001\n2\n\u0001\n.\n",
    "(a) An evil villain is hiding out in the plane at the point (−5, 7).",
    "How many\nhoverboard units and magic carpet units does the superhero have to move to get\nto the villain?\n(b) Is there anywhere in the plane that the villain could safely hide and not be\nreached?",
    "If so, give one such location.",
    "If not, explain why not.\n\n",
    "104\nChapter Two.",
    "Vector Spaces\n(c)",
    "The superhero and the villain are transported to a three dimensional space\nwhere the superhero now has three devices.\n",
    "hoverboard:\n\n\n−1\n0\n3\n\n\nmagic carpet:\n\n\n2\n1\n0\n\n\nscooter:\n\n\n5\n4\n−9\n\n\nIs there anywhere that the villain could safely hide?",
    "If so, give one such location\nand if not, explain why not.\n2.25",
    "Which of these are members of the span",
    "[{cos2 x, sin2 x}] in the vector space of\nreal-valued functions of one real variable?\n(a) f(x) = 1\n(b) f(x)",
    "= 3 + x2\n(c) f(x)",
    "= sin x\n(d) f(x) = cos(2x)\n✓2.26 Which of these sets spans R3?",
    "That is, which of these sets has the property\nthat any three-tall vector can be expressed as a suitable linear combination of the\nset’s elements?\n(a) {\n\n\n1\n0\n0\n\n,\n\n\n0\n2\n0\n\n,\n\n\n0\n0\n3\n\n}\n(b) {\n\n\n2\n0\n1\n\n,\n\n\n1\n1\n0\n\n,\n\n\n0\n0\n1\n\n}\n(c) {\n\n\n1\n1\n0\n\n,\n\n\n3\n0\n0\n\n}\n(d) {\n\n\n1\n0\n1\n\n,\n\n\n3\n1\n0\n\n,\n\n\n−1\n0\n0\n\n,\n\n\n2\n1\n5\n\n}\n(e) {\n\n\n2\n1\n1\n\n,\n\n\n3\n0\n1\n\n,\n\n\n5\n1\n2\n\n,\n\n\n6\n0\n2\n\n}\n✓2.27 Parametrize each subspace’s description.",
    "Then express each subspace as a\nspan.\n",
    "(a) The subset {(a b c) | a −c = 0} of the three-wide row vectors\n(b) This subset of M2×2\n{\n\u0012a\nb\nc\nd\n\u0013\n| a + d = 0}\n(c) This subset of M2×2\n{\n\u0012a\nb\nc\nd\n\u0013\n| 2a −c −d = 0 and a + 3b = 0}\n(d)",
    "The subset {a + bx + cx3 | a −2b + c = 0} of P3\n(e) The subset of P2 of quadratic polynomials p such that p(7)",
    "= 0\n✓2.28 Find a set to span the given subspace of the given space.",
    "(Hint.",
    "Parametrize\neach.)\n",
    "(a) the xz-plane in R3\n(b) {\n\n\nx\ny\nz\n\n|",
    "3x +",
    "2y + z = 0} in R3\n(c) {\n\n\n\n\nx\ny\nz\nw\n\n\n\n| 2x +",
    "y + w = 0 and y + 2z = 0} in R4\n(d) {a0 +",
    "a1x",
    "+ a2x2",
    "+ a3x3 | a0 + a1 = 0 and a2 −a3 = 0} in P3\n(e) The set P4 in the space P4\n(f) M2×2 in M2×2\n2.29 Is R2 a subspace of R3?\n\nSection I. Deﬁnition of Vector Space\n105\n✓2.30 Decide if each is a subspace of the vector space of real-valued functions of one\nreal variable.\n",
    "(a) The even functions {f: R →R | f(−x) = f(x) for all x}.",
    "For example, two mem-\nbers of this set are f1(x) = x2 and f2(x)",
    "= cos(x).\n",
    "(b) The odd functions {f: R →R | f(−x)",
    "= −f(x) for all x}.\n",
    "Two members are\nf3(x) = x3 and f4(x) = sin(x).\n",
    "2.31 Example 2.16 says that for any vector ⃗v that is an element of a vector space V,\nthe set {r ·⃗v | r ∈R} is a subspace of V. (This is simply the span of the singleton\nset {⃗v}.)",
    "Must any such subspace be a proper subspace?\n",
    "2.32",
    "An example following the deﬁnition of a vector space shows that the solution\nset of a homogeneous linear system is a vector space.",
    "In the terminology of this\nsubsection, it is a subspace of Rn where the system has n variables.",
    "What about\na non-homogeneous linear system; do its solutions form a subspace (under the\ninherited operations)?\n",
    "2.33",
    "[Cleary] Give an example of each or explain why it would be impossible to do\nso.\n(a) A nonempty subset of M2×2 that is not a subspace.\n",
    "(b) A set of two vectors in R2 that does not span the space.\n",
    "2.34 Example 2.19 shows that R3 has inﬁnitely many subspaces.",
    "Does every non-\ntrivial space have inﬁnitely many subspaces?\n2.35 Finish the proof of Lemma 2.9.\n2.36 Show that each vector space has only one trivial subspace.\n",
    "2.37 Show that for any subset S of a vector space, the span of the span equals the\nspan",
    "[[S]] = [S].",
    "(Hint.",
    "Members of [S] are linear combinations of members of S.\nMembers of [[S]] are linear combinations of linear combinations of members of S.)\n",
    "2.38 All of the subspaces that we’ve seen in some way use zero in their description.\n",
    "For example, the subspace in Example 2.3 consists of all the vectors from R2 with\na second component of zero.",
    "In contrast, the collection of vectors from R2 with a\nsecond component of one does not form a subspace (it is not closed under scalar\nmultiplication).",
    "Another example is Example 2.2, where the condition on the\nvectors is that the three components add to zero.",
    "If the condition there were that\nthe three components add to one then it would not be a subspace (again, it would\nfail to be closed).",
    "However, a reliance on zero is not strictly necessary.",
    "Consider\nthe set\n{\n\n\nx\ny\nz\n\n",
    "|",
    "x + y + z = 1}\nunder these operations.\n\n\nx1\ny1\nz1\n\n+\n\n\nx2\ny2\nz2\n\n=\n\n\nx1 + x2 −1\ny1 + y2\nz1 + z2\n\n\nr\n\n\nx\ny\nz\n\n=\n\n\nrx −r + 1\nry\nrz\n\n\n(a) Show that it is not a subspace of R3.",
    "(Hint.",
    "See Example 2.7).\n",
    "(b) Show that it is a vector space.",
    "Note that by the prior item, Lemma 2.9 can\nnot apply.\n\n",
    "106\nChapter Two.",
    "Vector Spaces\n(c) Show that any subspace of R3 must pass through the origin, and so any\nsubspace of R3 must involve zero in its description.",
    "Does the converse hold?\n",
    "Does any subset of R3 that contains the origin become a subspace when given\nthe inherited operations?\n2.39 We can give a justiﬁcation for the convention that the sum of zero-many vectors\nequals the zero vector.",
    "Consider this sum of three vectors ⃗v1",
    "+⃗v2 +⃗v3.\n(a)",
    "What is the diﬀerence between this sum of three vectors and the sum of the\nﬁrst two of these three?\n(b) What is the diﬀerence between the prior sum and the sum of just the ﬁrst\none vector?\n",
    "(c) What should be the diﬀerence between the prior sum of one vector and the\nsum of no vectors?\n(d)",
    "So what should be the deﬁnition of the sum of no vectors?\n2.40 Is a space determined by its subspaces?",
    "That is, if two vector spaces have the\nsame subspaces, must the two be equal?\n2.41\n(a) Give a set that is closed under scalar multiplication but not addition.\n",
    "(b) Give a set closed under addition but not scalar multiplication.\n",
    "(c) Give a set closed under neither.\n",
    "2.42 Show that the span of a set of vectors does not depend on the order in which\nthe vectors are listed in that set.\n",
    "2.43 Which trivial subspace is the span of the empty set?",
    "Is it\n{\n\n\n0\n0\n0\n\n} ⊆R3,\nor\n{0 + 0x} ⊆P1,\nor some other subspace?\n2.44 Show that if a vector is in the span of a set then adding that vector to the set\nwon’t make the span any bigger.",
    "Is that also ‘only if’?\n✓2.45 Subspaces are subsets and so we naturally consider how ‘is a subspace of’\ninteracts with the usual set operations.\n",
    "(a) If A, B are subspaces of a vector space, must their intersection A ∩B be a\nsubspace?",
    "Always?",
    "Sometimes?",
    "Never?\n(b) Must the union A ∪B be a subspace?\n(c)",
    "If A is a subspace of some V, must its set complement V −A be a subspace?\n(Hint.",
    "Try some test subspaces from Example 2.19.)\n",
    "2.46 Does the span of a set depend on the enclosing space?",
    "That is, if W is a\nsubspace of V and S is a subset of W (and so also a subset of V), might the span\nof S in W diﬀer from the span of S in V?\n2.47 Is the relation ‘is a subspace of’ transitive?",
    "That is, if V is a subspace of W\nand W is a subspace of X, must V be a subspace of X?\n2.48 Because ‘span of’ is an operation on sets we naturally consider how it interacts\nwith the usual set operations.\n",
    "(a) If S ⊆T are subsets of a vector space, is [S] ⊆[T]?",
    "Always?",
    "Sometimes?\nNever?\n(b) If S, T are subsets of a vector space, is [S ∪T]",
    "= [S] ∪[T]?\n\nSection I. Deﬁnition of Vector Space\n107\n(c) If S, T are subsets of a vector space, is [S ∩T]",
    "= [S] ∩[T]?\n(d) Is the span of the complement equal to the complement of the span?\n2.49 Find a structure that is closed under linear combinations, and yet is not a\nvector space.\n\n",
    "108\nChapter Two.",
    "Vector Spaces\nII\nLinear Independence\nThe prior section shows how to understand a vector space as a span, as an\nunrestricted linear combination of some of its elements.",
    "For example, the space\nof linear polynomials {a + bx | a, b ∈R} is spanned by the set {1, x}.",
    "The prior\nsection also showed that a space can have many sets that span it.",
    "Two more\nsets that span the space of linear polynomials are {1, 2x} and {1, x, 2x}.\n",
    "At the end of that section we described some spanning sets as ‘minimal’\nbut we never precisely deﬁned that word.",
    "We could mean that a spanning\nset is minimal if it contains the smallest number of members of any set with\nthe same span, so that {1, x, 2x} is not minimal because it has three members\nwhile we can give two-element sets spanning the same space.",
    "Or we could mean\nthat a spanning set is minimal when it has no elements that we can remove\nwithout changing the span.",
    "Under this meaning {1, x, 2x} is not minimal because\nremoving the 2x to get {1, x} leaves the span unchanged.\n",
    "The ﬁrst sense of minimality appears to be a global requirement, in that\nto check if a spanning set is minimal we seemingly must look at all the sets\nthat span and ﬁnd one with the least number of elements.",
    "The second sense\nof minimality is local since we need to look only at the set and consider the\nspan with and without various elements.",
    "For instance, using the second sense\nwe could compare the span of {1, x, 2x} with the span of {1, x} and note that 2x\nis a “repeat” in that its removal doesn’t shrink the span.\n",
    "In this section we will use the second sense of ‘minimal spanning set’ because\nof this technical convenience.",
    "However, the most important result of this book\nis that the two senses coincide.",
    "We will prove that in the next section.\n",
    "II.1\nDeﬁnition and Examples\nWe saw “repeats” in the ﬁrst chapter.",
    "There, Gauss’s Method turned them into\n0 = 0 equations.\n",
    "1.1 Example Recall the Statics example from Chapter One’s opening.",
    "We got\ntwo balances with the pair of unknown-mass objects, one at 40 cm and 15 cm\nand another at −50 cm and 25 cm, and we then computed the value of those\nmasses.",
    "Had we instead gotten the second balance at 20 cm and 7.5 cm then\nGauss’s Method on the resulting two-equations, two-unknowns system would\nnot have yielded a solution, it would have yielded a 0 = 0 equation along with\nan equation containing a free variable.",
    "Intuitively, the problem is that (20 7.5)\nis half of (40 15), that is, (20 7.5) is in the span of the set {(40 15)} and so is\n\nSection II.",
    "Linear Independence\n109\nrepeated data.",
    "We would have been trying to solve a two-unknowns problem\nwith essentially only one piece of information.\n",
    "We take ⃗v to be a “repeat” of the vectors in a set S if ⃗v ∈[S]",
    "so that it depends\non, that is, is expressible in terms of, elements of the set ⃗v = c1⃗s1 + · · ·",
    "+ cn⃗sn.\n",
    "1.2 Lemma Where V is a vector space, S is a subset of that space, and ⃗v is an\nelement of that space, [S ∪{⃗v}]",
    "=",
    "[S] if and only if ⃗v ∈[S].\nProof Half of the if and only if is immediate: if ⃗v /∈[S]",
    "then the sets are not\nequal because ⃗v ∈[S ∪{⃗v}].\n",
    "For the other half assume that ⃗v ∈[S]",
    "so that ⃗v = c1⃗s1 + · · · + cn⃗sn for some\nscalars ci and vectors ⃗si ∈S. We will use mutual containment to show that the\nsets [S ∪{⃗v}] and [S] are equal.",
    "The containment [S ∪{⃗v}] ⊇[S] is clear.\n",
    "To show containment in the other direction let ⃗w be an element of [S ∪{⃗v}].\n",
    "Then ⃗w is a linear combination of elements of S ∪{⃗v}, which we can write as\n⃗w = cn+1⃗sn+1 + · · · + cn+k⃗sn+k + cn+k+1⃗v.",
    "(Possibly some of the ⃗si’s from\n⃗w’s equation are the same as some of those from ⃗v’s equation but that does not\nmatter.)",
    "Expand ⃗v.\n",
    "⃗w = cn+1⃗sn+1 + · · · + cn+k⃗sn+k + cn+k+1 · (c1⃗s1 + · · · + cn⃗sn)\nRecognize the right hand side as a linear combination of linear combinations of\nvectors from S. Thus ⃗w ∈[S].\n",
    "QED\n",
    "The discussion at the section’s opening involved removing vectors instead of\nadding them.\n",
    "1.3 Corollary For ⃗v ∈S, omitting that vector does not shrink the span",
    "[S] =\n[S −{⃗v}] if and only if it is dependent on other vectors in the set ⃗v ∈[S].\n",
    "The corollary says that to know whether removing a vector will decrease the\nspan, we need to know whether the vector is a linear combination of others in\nthe set.\n",
    "1.4 Deﬁnition In any vector space, a set of vectors is linearly independent if none\nof its elements is a linear combination of the others from the set.∗Otherwise\nthe set is linearly dependent.\n",
    "Thus the set {⃗s0, . . .",
    ",⃗sn } is independent if there is no equality ⃗si = c0⃗s0 +\n. . .",
    "+",
    "ci−1⃗si−1 + ci+1⃗si+1 + . . .",
    "+",
    "cn⃗sn.",
    "The deﬁnition’s use of the word ‘others’\nmeans that writing ⃗si as a linear combination via ⃗si = 1 · ⃗si does not count.\n",
    "∗See also Remark 1.13.\n\n",
    "110\nChapter Two.",
    "Vector Spaces\nObserve that, although this way of writing one vector as a combination of\nthe others\n⃗s0 = c1⃗s1 + c2⃗s2 + · · · + cn⃗sn\nvisually sets oﬀ⃗s0, algebraically there is nothing special about that vector in\nthat equation.",
    "For any ⃗si with a coeﬃcient ci that is non-0 we can rewrite to\nisolate ⃗si.\n",
    "⃗si = (1/ci)⃗s0 + · · · + (−ci−1/ci)⃗si−1 + (−ci+1/ci)⃗si+1 + · · · + (−cn/ci)⃗sn\nWhen we don’t want to single out any vector we will instead say that ⃗s0,⃗s1, . . .",
    ",⃗sn\nare in a linear relationship and put all of the vectors on the same side.",
    "The\nnext result rephrases the linear independence deﬁnition in this style.",
    "It is how\nwe usually compute whether a ﬁnite set is dependent or independent.\n",
    "1.5 Lemma A subset S of a vector space is linearly independent if and only if\namong its elements the only linear relationship c1⃗s1 + · · ·",
    "+ cn⃗sn = ⃗0 is the\ntrivial one, c1 = 0, . . .",
    ", cn = 0 (where ⃗si ̸= ⃗sj when i ̸= j) .\n",
    "Proof If S is linearly independent then no vector ⃗si is a linear combination\nof other vectors from S so there is no linear relationship where some of the ⃗s ’s\nhave nonzero coeﬃcients.\n",
    "If S is not linearly independent then some ⃗si is a linear combination ⃗si =\nc1⃗s1 +· · ·+ci−1⃗si−1 +ci+1⃗si+1 +· · ·+cn⃗sn of other vectors from S. Subtracting\n⃗si from both sides gives a relationship involving a nonzero coeﬃcient, the −1 in\nfront of ⃗si.\nQED\n1.6 Example In the vector space of two-wide row vectors, the two-element set\n{(40 15), (−50 25)} is linearly independent.",
    "To check this, take\nc1 · (40 15) + c2 · (−50 25) = (0 0)\nand solve the resulting system.\n",
    "40c1 −50c2 = 0\n15c1 +",
    "25c2 = 0\n−(15/40)ρ1+ρ2\n−→\n40c1 −\n50c2 = 0\n(175/4)c2 = 0\nBoth c1 and c2 are zero.",
    "So the only linear relationship between the two given\nrow vectors is the trivial relationship.\n",
    "In the same vector space, the set {(40 15), (20 7.5)} is linearly dependent\nsince we can satisfy c1 ·(40 15)+c2 ·(20 7.5) = (0 0) with c1 = 1 and c2 = −2.\n",
    "1.7 Example The set {1 + x, 1 −x} is linearly independent in P2, the space of\nquadratic polynomials with real coeﬃcients, because\n0 + 0x + 0x2 = c1(1 + x) + c2(1 −x) = (c1 + c2)",
    "+",
    "(c1 −c2)x + 0x2\n\nSection II.",
    "Linear Independence\n111\ngives\nc1 + c2 = 0\nc1 −c2 = 0\n−ρ1+ρ2\n−→\nc1 +",
    "c2 = 0\n2c2 = 0\nsince polynomials are equal only if their coeﬃcients are equal.",
    "Thus, the only\nlinear relationship between these two members of P2 is the trivial one.\n1.8 Remark The lemma speciﬁes that ⃗si ̸= ⃗sj when i ̸= j because of course if some\nvector ⃗s appears twice then we can get a nontrivial c1⃗s1 + · · ·",
    "+ cn⃗sn = ⃗0, by\ntaking the associated coeﬃcients to be 1 and −1.",
    "Besides, if some vector appears\nmore than once in an expression then we can always combine the coeﬃcients.\n",
    "Note that the lemma allows the opposite of appearing more than once, that\nsome vectors from S don’t appear at all.",
    "For instance, if S is inﬁnite then because\nlinear relationships involve only ﬁnitely many vectors, any such relationship\nleaves out many of S’s vectors.",
    "However, note also that if S is ﬁnite then where\nconvenient we can take a combination c1⃗s1 + · · ·",
    "+ cn⃗sn to contain each of S’s\nvectors once and only once.",
    "If a vector is missing then we can add it by using a\ncoeﬃcient of 0.\n",
    "1.9 Example The rows of this matrix\nA =\n\n\n\n2\n3\n1\n0\n0\n−1\n0\n−2\n0\n0\n0\n1\n\n\n\nform a linearly independent set.",
    "This is easy to check for this case but also recall\nthat Lemma One.",
    "III.2.5 shows that the rows of any echelon form matrix form a\nlinearly independent set.\n",
    "1.10 Example In R3,",
    "where\n⃗v1 =\n\n\n\n3\n4\n5\n\n\n\n⃗v2 =\n\n\n\n2\n9\n2\n\n\n\n⃗v3 =\n\n\n\n4\n18\n4\n\n\n\nthe set S = {⃗v1,⃗v2,⃗v3 } is linearly dependent because this is a relationship\n0 ·⃗v1 + 2 ·⃗v2 −1 ·⃗v3 = ⃗0\nwhere not all of the scalars are zero (the fact that some of the scalars are zero\ndoesn’t matter).\n",
    "That example illustrates why, although Deﬁnition 1.4 is a clearer statement\nof what independence means, Lemma 1.5 is better for computations.",
    "Working\nstraight from the deﬁnition, someone trying to compute whether S is linearly\nindependent would start by setting ⃗v1 = c2⃗v2 + c3⃗v3 and concluding that there\n\n112\nChapter Two.",
    "Vector Spaces\nare no such c2 and c3.",
    "But knowing that the ﬁrst vector is not dependent on the\nother two is not enough.",
    "This person would have to go on to try ⃗v2 = c1⃗v1+c3⃗v3,\nin order to ﬁnd the dependence c1 = 0, c3 = 1/2.",
    "Lemma 1.5 gets the same\nconclusion with only one computation.\n",
    "1.11 Example The empty subset of a vector space is linearly independent.",
    "There\nis no nontrivial linear relationship among its members as it has no members.\n",
    "1.12 Example",
    "In any vector space, any subset containing the zero vector is linearly\ndependent.",
    "One example is, in the space P2 of quadratic polynomials, the subset\n{1 + x, x + x2, 0}.",
    "It is linearly dependent because 0 ·⃗v1 + 0 ·⃗v2 + 1 ·⃗0 = ⃗0 is a\nnontrivial relationship, since not all of the coeﬃcients are zero.\n",
    "There is a subtle point that we shall see a number of times and that bears\non the prior example.",
    "It is about the trivial sum, the sum of the empty set.\n",
    "One way to see how to deﬁne the trivial sum is to consider the progression\n⃗v1",
    "+ ⃗v2 + ⃗v3, followed by ⃗v1 + ⃗v2, followed by ⃗v1.",
    "The diﬀerence between the\nsum of three vectors and the sum of two is ⃗v3.",
    "Then the diﬀerence between the\nsum of two and the sum of one is ⃗v2.",
    "In next passing to the trivial sum, the\nsum of zero-many vectors, we can expect to subtract ⃗v1.",
    "So we deﬁne the sum\nof zero-many vectors to be the zero vector.\n",
    "The relation with the prior example is that if the zero vector is in a set then\nthat set has an element that is a combination of a subset of other vectors from\nthe set, speciﬁcally, the zero vector is a combination of the empty subset.",
    "Even\nthe set S = {⃗0} is linearly dependent, because ⃗0 is the sum of the empty set and\nthe empty set is a subset of S.\n1.13 Remark",
    "The deﬁnition of linear independence, Deﬁnition 1.4, refers to a\n‘set’ of vectors.",
    "Sets are the most familiar kind of collection and in practice\neveryone refers to these collections as sets.",
    "But to be complete we will note that\nsets are not quite the right kind of collection for this purpose.\n",
    "Recall that a set is a collection with two properties: (i) order does not matter,\nso that the set {1, 2} equals the set {2, 1}, and (ii) duplicates collapse, so that\nthe set {1, 1, 2} equals the set {1, 2}.\n",
    "Now consider this matrix reduction.\n\n\n\n1\n1\n1\n2\n2\n2\n1\n2\n3\n\n\n\n(1/2)ρ2\n−→\n\n\n\n1\n1\n1\n1\n1\n1\n1\n2\n3\n\n\n\nOn the left the set of matrix rows {(1 1 1), (2 2 2), (1 2 3)} is linearly de-\npendent.",
    "On the right the set of rows is {(1 1 1), (1 1 1), (1 2 3)}.",
    "Because\nduplicates collapse, that equals the set {(1 1 1), (1 2 3)}, which is linearly\nindependent.",
    "That’s a problem because Gauss’s Method should preserve linear\ndependence.\n\nSection II.",
    "Linear Independence\n113\nThat is, strictly speaking, we need a type of collection where duplicates do\nnot collapse.",
    "A collection where order does not matter and duplicates don’t\ncollapse is a multiset.\n",
    "However, the standard terminology here is ‘set’ and departing from a standard\nhas its own pitfalls, so we will use that word also.",
    "Later we shall occasionally\nneed to take combinations without letting duplicates collapse and we shall do\nthat without further comment.\n",
    "1.14 Corollary A set S is linearly independent if and only if for any ⃗v ∈S, its\nremoval shrinks the span",
    "[S −{v}] ⊊[S].\n",
    "Proof This follows from Corollary 1.3.",
    "If S is linearly independent then none\nof its vectors is dependent on the other elements, so removal of any vector will\nshrink the span.",
    "If S is not linearly independent then it contains a vector that\nis dependent on other elements of the set, and removal of that vector will not\nshrink the span.\n",
    "QED\n",
    "So a spanning set is minimal if and only if it is linearly independent.\n",
    "The prior result addresses removing elements from a linearly independent\nset.",
    "The next one adds elements.\n",
    "1.15 Lemma Suppose that S is linearly independent and that ⃗v /∈S.",
    "Then the\nset S ∪{⃗v} is linearly independent if and only if ⃗v /∈[S].\n",
    "Proof We will show that S ∪{⃗v} is not linearly independent if and only if\n⃗v ∈[S].\n",
    "Suppose ﬁrst that ⃗v ∈[S].",
    "Express ⃗v as a combination ⃗v = c1⃗s1 + · · ·",
    "+ cn⃗sn.\n",
    "Rewrite that ⃗0 = c1⃗s1 + · · ·",
    "+ cn⃗sn −1 ·⃗v.",
    "Since ⃗v /∈S, it does not equal any of\nthe ⃗si so this is a nontrivial linear dependence among the elements of S ∪{⃗v}.\n",
    "Thus that set is not linearly independent.\n",
    "Now suppose that S∪{⃗v} is not linearly independent and consider a nontrivial\ndependence among its members ⃗0 = c1⃗s1 + · · · + cn⃗sn + cn+1 · ⃗v.",
    "If cn+1 = 0\nthen that is a dependence among the elements of S, but we are assuming that S\nis independent, so cn+1 ̸= 0.",
    "Rewrite the equation as ⃗v = (c1/cn+1)⃗s1 + · · · +\n(cn/cn+1)⃗sn to get ⃗v ∈[S]\nQED\n1.16 Example This subset of R3 is linearly independent.\n",
    "S = {\n\n\n\n1\n0\n0\n\n\n}\n",
    "The span of S is the x-axis.",
    "Here are two supersets, one that is linearly dependent\nand the other independent.\n\n",
    "114\nChapter Two.",
    "Vector Spaces\ndependent: {\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n−3\n0\n0\n\n\n}\nindependent: {\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n1\n0\n\n\n}\n",
    "We got the dependent superset by adding a vector from the x-axis and so the\nspan did not grow.",
    "We got the independent superset by adding a vector that\nisn’t in [S], because it has a nonzero y component, causing the span to grow.\n",
    "For the independent set\nS = {\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n1\n0\n\n\n}\nthe span",
    "[S] is the xy-plane.",
    "Here are two supersets.\n",
    "dependent: {\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n1\n0\n\n\n,\n\n\n\n3\n−2\n0\n\n\n}\nindependent: {\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n1\n0\n\n\n,\n\n\n\n0\n0\n1\n\n\n}\nAs above, the additional member of the dependent superset comes from [S],\nthe xy-plane, while the added member of the independent superset comes from\noutside of that span.\n",
    "Finally, consider this independent set\nS = {\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n1\n0\n\n\n,\n\n\n\n0\n0\n1\n\n\n}\nwith [S] = R3.",
    "We can get a linearly dependent superset.\n",
    "dependent: {\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n1\n0\n\n\n,\n\n\n\n0\n0\n1\n\n\n,\n\n\n\n2\n−1\n3\n\n\n}\n",
    "But there is no linearly independent superset of S. One way to see that is to\nnote that for any vector that we would add to S, the equation\n\n\n\nx\ny\nz\n\n\n= c1\n\n\n\n1\n0\n0\n\n\n+ c2\n\n\n\n0\n1\n0\n\n\n+ c3\n\n\n\n0\n0\n1\n\n\n\nhas a solution c1 = x, c2 = y, and c3 = z.",
    "Another way to see it is that we\ncannot add any vectors from outside of the span",
    "[S] because that span is R3.\n\nSection II.",
    "Linear Independence\n115\n1.17 Corollary",
    "In a vector space, any ﬁnite set has a linearly independent subset\nwith the same span.\n",
    "Proof If S = {⃗s1, . .",
    ".",
    ",⃗sn} is linearly independent then S itself satisﬁes the\nstatement, so assume that it is linearly dependent.\n",
    "By the deﬁnition of dependent, S contains a vector ⃗v1 that is a linear\ncombination of the others.",
    "Deﬁne the set S1 = S −{⃗v1}.",
    "By Corollary 1.3 the\nspan does not shrink",
    "[S1] =",
    "[S].\n",
    "If S1 is linearly independent then we are done.",
    "Otherwise iterate: take a\nvector ⃗v2 that is a linear combination of other members of S1 and discard it\nto derive S2 = S1 −{⃗v2 } such that [S2] =",
    "[S1].",
    "Repeat this until a linearly\nindependent set Sj appears; one must appear eventually because S is ﬁnite and\nthe empty set is linearly independent.",
    "(Formally, this argument uses induction\non the number of elements in S. Exercise 42 asks for the details.)\n",
    "QED\n",
    "Thus if we have a set that is linearly dependent then we can, without changing\nthe span, pare down by discarding what we have called “repeat” vectors.\n1.18 Example This set spans R3 (the check is routine) but is not linearly inde-\npendent.\n",
    "S = {\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n2\n0\n\n\n,\n\n\n\n1\n2\n0\n\n\n,\n\n\n\n0\n−1\n1\n\n\n,\n\n\n\n3\n3\n0\n\n\n}\nWe will calculate which vectors to drop in order to get a subset that is independent\nbut has the same span.",
    "This linear relationship\nc1\n\n\n\n1\n0\n0\n\n\n+ c2\n\n\n\n0\n2\n0\n\n\n+ c3\n\n\n\n1\n2\n0\n\n\n+ c4\n\n\n\n0\n−1\n1\n\n\n+ c5\n\n\n\n3\n3\n0\n\n\n=\n\n\n\n0\n0\n0\n\n\n\n(∗)\ngives a system\nc1\n+ c3 +\n+ 3c5 = 0\n2c2 + 2c3 −c4",
    "+ 3c5 = 0\nc4\n= 0\nwhose solution set has this parametrization.\n",
    "{\n\n\n\n\n\n\n\nc1\nc2\nc3\nc4\nc5\n\n\n\n\n\n\n\n= c3\n\n\n\n\n\n\n\n−1\n−1\n1\n0\n0\n\n\n\n\n\n\n\n+ c5\n\n\n\n\n\n\n\n−3\n−3/2\n0\n0\n1\n\n\n\n\n\n\n\n| c3, c5 ∈R}\n\n116\nChapter Two.",
    "Vector Spaces\nSet c5 = 1 and c3 = 0 to get an instance of (∗).\n",
    "−3 ·\n\n\n\n1\n0\n0\n\n\n−3\n2 ·\n\n\n\n0\n2\n0\n\n\n+ 0 ·\n\n\n\n1\n2\n0\n\n\n+ 0 ·\n\n\n\n0\n−1\n1\n\n\n+ 1 ·\n\n\n\n3\n3\n0\n\n\n=\n\n\n\n0\n0\n0\n\n\n\n",
    "This shows that the vector from S that we’ve associated with c5 is in the span\nof the set of c1’s vector and c2’s vector.",
    "We can discard S’s ﬁfth vector without\nshrinking the span.\n",
    "Similarly, set c3 = 1, and c5 = 0 to get an instance of (∗) that shows we can\ndiscard S’s third vector without shrinking the span.",
    "Thus this set has the same\nspan as S.\n{\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n2\n0\n\n\n,\n\n\n\n0\n−1\n1\n\n\n}\nThe check that it is linearly independent is routine.\n",
    "1.19 Corollary A subset S = {⃗s1, . . .",
    ",⃗sn } of a vector space is linearly dependent\nif and only if some ⃗si is a linear combination of the vectors ⃗s1, . . .",
    ", ⃗si−1 listed\nbefore it.\n",
    "Proof Consider S0 = { }, S1 = { ⃗s1 }, S2 = {⃗s1,⃗s2 }, etc.",
    "Some index i ⩾1 is the\nﬁrst one with Si−1 ∪{⃗si } linearly dependent, and there ⃗si ∈[Si−1].\n",
    "QED\n",
    "The proof of Corollary 1.17 describes producing a linearly independent set\nby shrinking, by taking subsets.",
    "And the proof of Corollary 1.19 describes\nﬁnding a linearly dependent set by taking supersets.",
    "We ﬁnish this subsection\nby considering how linear independence and dependence interact with the subset\nrelation between sets.\n",
    "1.20 Lemma Any subset of a linearly independent set is also linearly independent.\n",
    "Any superset of a linearly dependent set is also linearly dependent.\n",
    "Proof Both are clear.\n",
    "QED\nRestated, subset preserves independence and superset preserves dependence.\n",
    "Those are two of the four possible cases.",
    "The third case, whether subset\npreserves linear dependence, is covered by Example 1.18, which gives a linearly\ndependent set S with one subset that is linearly dependent and another that is\nindependent.",
    "The fourth case, whether superset preserves linear independence,\nis covered by Example 1.16, which gives cases where a linearly independent set\nhas both an independent and a dependent superset.",
    "This table summarizes.\n\nSection II.",
    "Linear Independence\n117\nˆS ⊂S\nˆS ⊃S\nS independent\nˆS must be independent\nˆS may be either\nS dependent\nˆS may be either\nˆS must be dependent\nExample 1.16 has something else to say about the interaction between linear\nindependence and superset.",
    "It names a linearly independent set that is maximal\nin that it has no supersets that are linearly independent.",
    "By Lemma 1.15 a\nlinearly independent set is maximal if and only if it spans the entire space,\nbecause that is when all the vectors in the space are already in the span.",
    "This\nnicely complements Lemma 1.14, that a spanning set is minimal if and only if it\nis linearly independent.\n",
    "Exercises\n✓1.21 Decide whether each subset of R3 is linearly dependent or linearly indepen-\ndent.\n(a) {\n\n\n1\n−3\n5\n\n,\n\n\n2\n2\n4\n\n,\n\n\n4\n−4\n14\n\n}\n(b) {\n\n\n1\n7\n7\n\n,\n\n\n2\n7\n7\n\n,\n\n\n3\n7\n7\n\n}\n(c) {\n\n\n0\n0\n−1\n\n,\n\n\n1\n0\n4\n\n}\n(d) {\n\n\n9\n9\n0\n\n,\n\n\n2\n0\n1\n\n,\n\n\n3\n5\n−4\n\n,\n\n\n12\n12\n−1\n\n}\n✓1.22 Which of these subsets of P3 are linearly dependent and which are indepen-\ndent?\n(a) {3 −x + 9x2, 5 −6x + 3x2, 1 + 1x −5x2 }\n(b) {−x2, 1 + 4x2 }\n(c) {2 + x + 7x2, 3 −x + 2x2, 4 −3x2 }\n(d) {8 + 3x + 3x2, x + 2x2, 2 + 2x + 2x2, 8 −2x + 5x2 }\n1.23 Determine if each set is linearly independent in the natural space.\n(a) {\n\n\n1\n2\n0\n\n,\n\n\n−1\n1\n0\n\n}\n(b) {(1 3 1), (−1 4 3), (−1 11 7)}\n(c) {\n\u00125\n4\n1\n2\n\u0013\n,\n\u00120\n0\n0\n0\n\u0013\n,\n\u0012 1\n0\n−1\n4\n\u0013\n}\n✓1.24 Prove that each set {f, g} is linearly independent in the vector space of all\nfunctions from R+ to R.\n(a) f(x)",
    "= x and g(x)",
    "= 1/x\n(b) f(x)",
    "= cos(x) and g(x) = sin(x)\n(c) f(x) = ex and g(x) = ln(x)\n",
    "✓1.25 Which of these subsets of the space of real-valued functions of one real variable\nis linearly dependent and which is linearly independent?",
    "(We have abbreviated\nsome constant functions; e.g., in the ﬁrst item, the ‘2’ stands for the constant\nfunction f(x)",
    "= 2.)\n\n118\nChapter Two.",
    "Vector Spaces\n(a) {2, 4 sin2(x), cos2(x)}\n(b) {1, sin(x), sin(2x)}\n(c) {x, cos(x)}\n(d) {(1 + x)2, x2 + 2x, 3}\n(e) {cos(2x), sin2(x), cos2(x)}\n(f) {0, x, x2 }\n1.26 Does the equation sin2(x)/ cos2(x) = tan2(x) show that this set of functions\n{sin2(x), cos2(x), tan2(x)} is a linearly dependent subset of the set of all real-valued\nfunctions with domain the interval (−π/2..π/2) of real numbers between −π/2 and\nπ/2)?\n1.27 Is the xy-plane subset of the vector space R3 linearly independent?\n✓1.28 Show that the nonzero rows of an echelon form matrix form a linearly indepen-\ndent set.\n",
    "1.29\n(a) Show that if the set {⃗u,⃗v, ⃗w} is linearly independent then so is the set\n{⃗u, ⃗u +⃗v, ⃗u +⃗v + ⃗w}.\n",
    "(b) What is the relationship between the linear independence or dependence of\n{⃗u,⃗v, ⃗w} and the independence or dependence of {⃗u −⃗v,⃗v −⃗w, ⃗w −⃗u}?\n1.30 Example 1.11 shows that the empty set is linearly independent.\n",
    "(a) When is a one-element set linearly independent?\n(b) How about a set with two elements?\n1.31 In any vector space V, the empty set is linearly independent.",
    "What about all\nof V?\n1.32 Show that if {⃗x,⃗y,⃗z} is linearly independent then so are all of its proper\nsubsets: {",
    "⃗x,⃗y}, {⃗x,⃗z}, {⃗y,⃗z}, {⃗x},{⃗y}, {⃗z}, and { }.",
    "Is that ‘only if’ also?\n1.33\n(a) Show that this\nS = {\n\n\n1\n1\n0\n\n,\n\n\n−1\n2\n0\n\n}\nis a linearly independent subset of R3.\n(b) Show that\n\n\n3\n2\n0\n\n\nis in the span of S by ﬁnding c1 and c2 giving a linear relationship.\n",
    "c1\n\n\n1\n1\n0\n\n+ c2\n\n\n−1\n2\n0\n\n",
    "=\n\n\n3\n2\n0\n\n\nShow that the pair c1, c2 is unique.\n",
    "(c) Assume that S is a subset of a vector space and that ⃗v is in [S], so that ⃗v is a\nlinear combination of vectors from S.",
    "Prove that if S is linearly independent then\na linear combination of vectors from S adding to ⃗v is unique (that is, unique up\nto reordering and adding or taking away terms of the form 0 · ⃗s).",
    "Thus S as a\nspanning set is minimal in this strong sense: each vector in [S] is a combination\nof elements of S a minimum number of times — only once.\n",
    "(d) Prove that it can happen when S is not linearly independent that distinct\nlinear combinations sum to the same vector.\n",
    "1.34 Prove that a polynomial gives rise to the zero function if and only if it is\nthe zero polynomial.",
    "(Comment.",
    "This question is not a Linear Algebra matter\n\nSection II.",
    "Linear Independence\n119\n",
    "but we often use the result.",
    "A polynomial gives rise to a function in the natural\nway: x 7→cnxn + · · · + c1x + c0.)\n",
    "1.35 Return to Section 1.2 and redeﬁne point, line, plane, and other linear surfaces\nto avoid degenerate cases.\n",
    "1.36\n(a) Show that any set of four vectors in R2 is linearly dependent.\n",
    "(b) Is this true for any set of ﬁve?",
    "Any set of three?\n(c) What is the most number of elements that a linearly independent subset of\nR2 can have?\n1.37 Is there a set of four vectors in R3 such that any three form a linearly independent\nset?\n1.38 Must every linearly dependent set have a subset that is dependent and a subset\nthat is independent?\n1.39 In R4 what is the biggest linearly independent set you can ﬁnd?",
    "The smallest?\n",
    "The biggest linearly dependent set?",
    "The smallest?",
    "(‘Biggest’ and ‘smallest’ mean\nthat there are no supersets or subsets with the same property.)\n",
    "✓1.40 Linear independence and linear dependence are properties of sets.",
    "We can thus\nnaturally ask how the properties of linear independence and dependence act with\nrespect to the familiar elementary set relations and operations.",
    "In this body of this\nsubsection we have covered the subset and superset relations.",
    "We can also consider\nthe operations of intersection, complementation, and union.\n",
    "(a) How does linear independence relate to intersection: can an intersection of\nlinearly independent sets be independent?",
    "Must it be?\n(b) How does linear independence relate to complementation?\n(c) Show that the union of two linearly independent sets can be linearly indepen-\ndent.\n",
    "(d) Show that the union of two linearly independent sets need not be linearly\nindependent.\n",
    "1.41 Continued from prior exercise.",
    "What is the interaction between the property\nof linear independence and the operation of union?\n(a) We might conjecture that the union S∪T of linearly independent sets is linearly\nindependent if and only if their spans have a trivial intersection [S] ∩[T] = {⃗0}.\n",
    "What is wrong with this argument for the ‘if’ direction of that conjecture?",
    "“If\nthe union S ∪T is linearly independent then the only solution to c1⃗s1 + · · · +\ncn⃗sn + d1⃗t1 + · · · + dm⃗tm = ⃗0 is the trivial one c1 = 0, . . .",
    ", dm = 0.",
    "So any\nmember of the intersection of the spans must be the zero vector because in\nc1⃗s1 + · · ·",
    "+ cn⃗sn = d1⃗t1 + · · · + dm⃗tm each scalar is zero.”\n(b) Give an example showing that the conjecture is false.\n",
    "(c) Find linearly independent sets S and T so that the union of S −(S ∩T) and\nT −(S∩T) is linearly independent, but the union S∪T is not linearly independent.\n",
    "(d) Characterize when the union of two linearly independent sets is linearly\nindependent, in terms of the intersection of spans.\n",
    "1.42 For Corollary 1.17,\n(a) ﬁll in the induction for the proof;\n(b) give an alternate proof that starts with the empty set and builds a sequence\n\n120\nChapter Two.",
    "Vector Spaces\nof linearly independent subsets of the given ﬁnite set until one appears with the\nsame span as the given set.\n",
    "1.43 With a some calculation we can get formulas to determine whether or not a set\nof vectors is linearly independent.\n",
    "(a) Show that this subset of R2\n{\n\u0012a\nc\n\u0013\n,\n\u0012b\nd\n\u0013\n}\nis linearly independent if and only if ad −bc ̸= 0.\n",
    "(b) Show that this subset of R3\n{\n\n\na\nd\ng\n\n,\n\n\nb\ne\nh\n\n,\n\n\nc\nf\ni\n\n}\nis linearly independent iﬀaei + bfg + cdh −hfa −idb −gec ̸= 0.\n",
    "(c) When is this subset of R3\n{\n\n\na\nd\ng\n\n,\n\n\nb\ne\nh\n\n}\nlinearly independent?\n(d)",
    "This is an opinion question: for a set of four vectors from R4, must there be a\nformula involving the sixteen entries that determines independence of the set?\n",
    "(You needn’t produce such a formula, just decide if one exists.)\n✓1.44\n(a) Prove that a set of two perpendicular nonzero vectors from Rn is linearly\nindependent when n > 1.\n(b)",
    "What if n = 1? n",
    "= 0?\n(c) Generalize to more than two vectors.\n",
    "1.45 Consider the set of functions from the interval (−1 . . .",
    "1) ⊆R to R.\n(a) Show that this set is a vector space under the usual operations.\n",
    "(b) Recall the formula for the sum of an inﬁnite geometric series: 1+x+x2 +· · ·",
    "=\n1/(1 −x) for all x ∈(−1..1).",
    "Why does this not express a dependence inside of\nthe set {g(x) = 1/(1 −x), f0(x)",
    "= 1, f1(x) = x, f2(x) = x2, . . .}",
    "(in the vector space\nthat we are considering)?",
    "(Hint. Review the deﬁnition of linear combination.)\n",
    "(c) Show that the set in the prior item is linearly independent.\n",
    "This shows that some vector spaces exist with linearly independent subsets that\nare inﬁnite.\n1.46 Show that, where S is a subspace of V, if a subset T of S is linearly independent\nin S then T is also linearly independent in V.",
    "Is that ‘only if’?\n\nSection III.",
    "Basis and Dimension\n121\nIII\nBasis and Dimension\n",
    "The prior section ends with the observation that a spanning set is minimal when\nit is linearly independent and a linearly independent set is maximal when it spans\nthe space.",
    "So the notions of minimal spanning set and maximal independent set\ncoincide.",
    "In this section we will name this idea and study its properties.\n",
    "III.1\nBasis\n1.1 Deﬁnition A basis for a vector space is a sequence of vectors that is linearly\nindependent and that spans the space.\n",
    "Because a basis is a sequence, meaning that bases are diﬀerent if they contain\nthe same elements but in diﬀerent orders, we denote it with angle brackets\n⟨⃗β1, ⃗β2, . .",
    ".⟩.∗\n",
    "(A sequence is linearly independent if the multiset consisting of\nthe elements of the sequence is independent.",
    "Similarly, a sequence spans the\nspace if the set of elements of the sequence spans the space.)\n",
    "1.2 Example This is a basis for R2.\n",
    "⟨\n \n2\n4\n!\n,\n \n1\n1\n!\n",
    "⟩\nIt is linearly independent\nc1\n \n2\n4\n!\n",
    "+ c2\n \n1\n1\n!\n",
    "=\n \n0\n0\n!\n=⇒\n2c1 + 1c2 = 0\n4c1",
    "+ 1c2 = 0\n=⇒\nc1 = c2 = 0\nand it spans R2.\n",
    "2c1 + 1c2 = x\n4c1 + 1c2",
    "= y\n=⇒\nc2 = 2x −y and c1 = (y −x)/2\n1.3 Example This basis for R2 diﬀers from the prior one\n⟨\n \n1\n1\n!\n,\n \n2\n4\n!\n",
    "⟩\nbecause it is in a diﬀerent order.",
    "The veriﬁcation that it is a basis is just as in\nthe prior example.\n",
    "∗More",
    "information on sequences is in the appendix.\n\n122\nChapter Two.",
    "Vector Spaces\n1.4 Example",
    "The space R2 has many bases.",
    "Another one is this.\n⟨\n \n1\n0\n!\n,\n \n0\n1\n!\n",
    "⟩\n",
    "The veriﬁcation is easy.\n",
    "1.5 Deﬁnition For any Rn\nEn = ⟨\n\n\n\n\n\n\n1\n0\n...\n0\n\n\n\n\n\n\n,\n\n\n\n\n\n\n0\n1\n...\n0\n\n\n\n\n\n\n, . . .",
    ",\n\n\n\n\n\n\n0\n0\n...\n1\n\n\n\n\n\n\n⟩\nis the standard (or natural) basis.",
    "We denote these vectors ⃗e1, . . .",
    ",⃗en.\n",
    "Calculus books denote R2’s standard basis vectors as ⃗ı and ⃗instead of ⃗e1 and\n⃗e2",
    "and they denote to R3’s standard basis vectors as ⃗ı, ⃗, and ⃗k instead of ⃗e1,\n⃗e2, and ⃗e3.",
    "Note that ⃗e1 means something diﬀerent in a discussion of R3 than\nit means in a discussion of R2.\n",
    "1.6 Example Consider the space {a · cos θ + b · sin θ | a, b ∈R} of functions of the\nreal variable θ.",
    "This is a natural basis ⟨cos θ, sin θ⟩= ⟨1·cos θ+0·sin θ, 0·cos θ+\n1 · sin θ⟩. A more generic basis for this space is ⟨cos θ −sin θ, 2 cos θ + 3 sin θ⟩.\nVeriﬁcation that these two are bases is Exercise 29.\n1.7 Example",
    "A natural basis for the vector space of cubic polynomials P3 is\n⟨1, x, x2, x3⟩.",
    "Two other bases for this space are ⟨x3, 3x2, 6x, 6⟩and ⟨1, 1 + x, 1 +\nx + x2, 1 +",
    "x + x2",
    "+ x3⟩.",
    "Checking that each is linearly independent and spans\nthe space is easy.\n",
    "1.8 Example The trivial space {⃗0} has only one basis, the empty one ⟨⟩.\n1.9 Example The space of ﬁnite-degree polynomials has a basis with inﬁnitely\nmany elements ⟨1, x, x2, . .",
    ".⟩.\n",
    "1.10 Example We have seen bases before.",
    "In the ﬁrst chapter we described the\nsolution set of homogeneous systems such as this one\nx + y\n−w = 0\nz + w = 0\nby parametrizing.\n",
    "{\n\n\n\n\n\n−1\n1\n0\n0\n\n\n\n\ny +\n\n\n\n\n\n1\n0\n−1\n1\n\n\n\n\nw | y, w ∈R}\n\nSection III.",
    "Basis and Dimension\n123\n",
    "Thus the vector space of solutions is the span of a two-element set.",
    "This two-\nvector set is also linearly independent, which is easy to check.",
    "Therefore the\nsolution set is a subspace of R4 with a basis comprised of these two vectors.\n",
    "1.11 Example Parametrization ﬁnds bases for other vector spaces, not just for\nsolution sets of homogeneous systems.",
    "To ﬁnd a basis for this subspace of M2×2\n{\n \na\nb\nc\n0\n!\n| a + b −2c = 0}\nwe rewrite the condition as a = −b + 2c.\n",
    "{\n \n−b + 2c\nb\nc\n0\n!\n| b, c ∈R} = {b\n \n−1\n1\n0\n0\n!\n",
    "+ c\n \n2\n0\n1\n0\n!\n| b, c ∈R}\n",
    "Thus, this is a natural candidate for a basis.\n",
    "⟨\n \n−1\n1\n0\n0\n!\n,\n \n2\n0\n1\n0\n!\n",
    "⟩\nThe above work shows that it spans the space.",
    "Linear independence is also easy.\n",
    "Consider again Example 1.2.",
    "To verify that the set spans the space we looked\nat linear combinations that total to a member of the space c1⃗β1 + c2⃗β2 =\n\u0000x\ny\n\u0001\n.\n",
    "We only noted in that example that such a combination exists, that for each x, y\nthere exists a c1, c2, but in fact the calculation also shows that the combination\nis unique: c1 must be (y −x)/2 and c2 must be 2x −y.\n",
    "1.12 Theorem In any vector space, a subset is a basis if and only if each vector\nin the space can be expressed as a linear combination of elements of the subset\nin one and only one way.\n",
    "We consider linear combinations to be the same if they have the same summands\nbut in a diﬀerent order, or if they diﬀer only in the addition or deletion of terms\nof the form ‘0 · ⃗β’.\n",
    "Proof A sequence is a basis if and only if its vectors form a set that spans and\nthat is linearly independent.",
    "A subset is a spanning set if and only if each vector\nin the space is a linear combination of elements of that subset in at least one\nway.",
    "Thus we need only show that a spanning subset is linearly independent if\nand only if every vector in the space is a linear combination of elements from\nthe subset in at most one way.\nConsider two expressions of a vector as a linear combination of the members\nof the subset.\n",
    "Rearrange the two sums, and if necessary add some 0 ·",
    "⃗βi\n\n124\nChapter Two.",
    "Vector Spaces\nterms, so that the two sums combine the same ⃗β’s in the same order: ⃗v =\nc1⃗β1 + c2⃗β2 + · · · + cn⃗βn and ⃗v = d1⃗β1 + d2⃗β2 + · · · + dn⃗βn.",
    "Now\nc1⃗β1 + c2⃗β2 + · · · + cn⃗βn = d1⃗β1 + d2⃗β2 + · · · + dn⃗βn\nholds if and only if\n(c1 −d1)⃗β1 + · · · + (cn −dn)⃗βn",
    "= ⃗0\nholds.",
    "So, asserting that each coeﬃcient in the lower equation is zero is the same\nthing as asserting that ci = di for each i, that is, that every vector is expressible\nas a linear combination of the ⃗β’s in a unique way.\n",
    "QED\n1.13 Deﬁnition In a vector space with basis B the representation of ⃗v with\nrespect to B is the column vector of the coeﬃcients used to express ⃗v as a linear\ncombination of the basis vectors:\nRepB(⃗v) =\n\n\n\n\n\n\nc1\nc2\n...\ncn\n\n\n\n\n\n\nB\nwhere B = ⟨⃗β1, . . .",
    ", ⃗βn⟩and ⃗v = c1⃗β1 + c2⃗β2 + · · · + cn⃗βn.",
    "The c’s are the\ncoordinates of ⃗v with respect to B.\n1.14 Example In P3, with respect to the basis B = ⟨1, 2x, 2x2, 2x3⟩, the represen-\ntation of x",
    "+ x2 is\nRepB(x + x2)",
    "=\n\n\n\n\n\n0\n1/2\n1/2\n0\n\n\n\n\n\nB\n",
    "because x + x2 = 0 · 1 + (1/2) · 2x + (1/2) · 2x2 + 0 · 2x3.",
    "With respect to a\ndiﬀerent basis D = ⟨1 + x, 1 −x, x + x2, x + x3⟩, the representation is diﬀerent.\n",
    "RepD(x + x2)",
    "=\n\n\n\n\n\n0\n0\n1\n0\n\n\n\n\n\nD\n1.15 Remark Deﬁnition 1.1 requires that a basis be a sequence so that we can\nwrite these coordinates in an order.\n",
    "When there is only one basis around, we often omit the subscript naming\nthat basis.\n\nSection III.",
    "Basis and Dimension\n125\n1.16 Example In R2, to ﬁnd the coordinates of the vector ⃗v =\n\u00003\n2\n\u0001\nwith respect\nto the basis\nB = ⟨\n \n1\n1\n!\n,\n \n0\n2\n!\n⟩\nsolve\nc1\n \n1\n1\n!\n",
    "+ c2\n \n0\n2\n!\n=\n \n3\n2\n!\n",
    "and get that c1 = 3 and c2 = −1/2.\nRepB(⃗v) =\n \n3\n−1/2\n!\n",
    "Writing the representation as a column generalizes the familiar case: in Rn\nand with respect to the standard basis En, the vector starting at the origin and\nending at (v1, . .",
    ". , vn) has this representation.\n",
    "RepEn(\n\n\n\nv1\n...\nvn\n\n\n) =\n\n\n\nv1\n...\nvn\n\n\n\n",
    "En\nThis is an example.\n",
    "RepEn(\n \n−1\n1\n!\n)",
    "=\n \n−1\n1\n!\n1.17 Remark The RepB(⃗v) notation is not standard.",
    "The most common notation\nis [⃗v]B but one advantage that RepB(⃗v) has is that it is harder to misinterpret\nor overlook.\n",
    "The column represent the vector in the sense that a linear relationship holds\namong a set of vectors if and only if that relationship holds among the set of\nrepresentations.\n",
    "1.18 Lemma Where B is a basis with n elements, for any set of vectors a1⃗v1",
    "+\n· · ·",
    "+ ak⃗vk = ⃗0V if and only if a1RepB(⃗v1)",
    "+ · · · + akRepB(⃗vk) = ⃗0Rn.\n",
    "Proof Fix a basis B = ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩and suppose\nRepB(⃗v1) =\n\n\n\nc1,1\n...\ncn,1\n\n\n\n. . .\n",
    "RepB(⃗vk)",
    "=\n\n\n\nc1,k\n...\ncn,k\n\n",
    "\n\n\n126\nChapter Two.",
    "Vector Spaces\nso that ⃗v1 = c1,1⃗β1 +· · ·+cn,1⃗βn, etc.",
    "Then a1⃗v1 +· · ·",
    "+ak⃗vk = ⃗0 is equivalent\nto these.\n",
    "⃗0 = a1 · (c1,1⃗β1 + · · · + cn,1⃗βn) + · · · + ak · (c1,k⃗β1 + · · · + cn,k⃗βn)\n= (a1c1,1 + · · · + akc1,k) · ⃗β1 + · · · + (a1cn,1 + · · · + akcn,k) ·",
    "⃗βn\nObviously the bottom equation is true if the coeﬃcients are zero.",
    "But, because\nB is a basis, Theorem 1.12 says that the bottom equation is true if and only if\nthe coeﬃcients are zero.",
    "So the relation is equivalent to this.\n",
    "a1c1,1 + · · · + akc1,k = 0\n...\n",
    "a1cn,1 + · · · + akcn,k = 0\n",
    "This is the equivalent recast into column vectors.\n",
    "a1\n\n\n\nc1,1\n...\ncn,1\n\n\n+ · · · + ak\n\n\n\nc1,k\n...\ncn,k\n\n\n=\n\n\n\n0\n...\n0\n\n\n\nNote that not only does a relationship hold for one set if and only if it holds for\nthe other, but it is the same relationship — the ai are the same.\n",
    "QED\n1.19 Example Example 1.14 ﬁnds the representation of x + x2 ∈P3 with respect\nto B = ⟨1, 2x, 2x2, 2x3⟩.\nRepB(x + x2)",
    "=\n\n\n\n\n\n0\n1/2\n1/2\n0\n\n\n\n\n\nB\n",
    "This relationship\n2 · (x + x2) −1 · (2x) −2 · (x2) = 0 + 0x + 0x2 + 0x3\nis represented by this one.\n",
    "2·RepB(x+x2)−RepB(2x)−2·RepB(x2) = 2·\n\n\n\n\n\n0\n1/2\n1/2\n0\n\n\n\n\n−\n\n\n\n\n\n0\n1\n0\n0\n\n\n\n\n−2·\n\n\n\n\n\n0\n0\n1/2\n0\n\n\n\n\n=\n\n\n\n\n\n0\n0\n0\n0\n\n\n\n\n\nOur main use of representations will come later but the deﬁnition appears\nhere because the fact that every vector is a linear combination of basis vectors in\na unique way is a crucial property of bases, and also to help make a point.",
    "For\ncalculation of coordinates among other things, we shall restrict our attention\nto spaces with bases having only ﬁnitely many elements.",
    "That will start in the\nnext subsection.\n\nSection III.",
    "Basis and Dimension\n127\nExercises\n✓1.20 Decide if each is a basis for P2.\n(a) ⟨x2 −x + 1, 2x + 1, 2x −1⟩\n(b) ⟨x + x2, x −x2⟩\n✓1.21 Decide if each is a basis for R3.\n(a) ⟨\n\n\n1\n2\n3\n\n,\n\n\n3\n2\n1\n\n,\n\n\n0\n0\n1\n\n⟩\n(b) ⟨\n\n\n1\n2\n3\n\n,\n\n\n3\n2\n1\n\n⟩\n(c) ⟨\n\n\n0\n2\n−1\n\n,\n\n\n1\n1\n1\n\n,\n\n\n2\n5\n0\n\n⟩\n(d) ⟨\n\n\n0\n2\n−1\n\n,\n\n\n1\n1\n1\n\n,\n\n\n1\n3\n0\n\n⟩\n✓1.22 Represent the vector with respect to the basis.\n",
    "(a)\n\u00121\n2\n\u0013\n, B = ⟨\n\u00121\n1\n\u0013\n,\n\u0012−1\n1\n\u0013\n⟩⊆R2\n(b) x2 + x3, D = ⟨1, 1 + x, 1 + x + x2, 1 + x + x2 + x3⟩⊆P3\n(c)\n\n\n\n\n0\n−1\n0\n1\n\n\n\n, E4 ⊆R4\n1.23 Represent the vector with respect to each of the two bases.\n",
    "⃗v =\n\u0012 3\n−1\n\u0013\n",
    "B1 = ⟨\n\u0012 1\n−1\n\u0013\n,\n\u00121\n1\n\u0013\n⟩, B2 = ⟨\n\u00121\n2\n\u0013\n,\n\u00121\n3\n\u0013\n⟩\n1.24 Find a basis for P2, the space of all quadratic polynomials.",
    "Must any such\nbasis contain a polynomial of each degree: degree zero, degree one, and degree two?\n",
    "1.25 Find a basis for the solution set of this system.\n",
    "x1 −4x2 + 3x3 −x4 = 0\n2x1 −8x2",
    "+ 6x3 −2x4 = 0\n✓1.26 Find a basis for M2×2, the space of 2×2 matrices.\n",
    "✓1.27 Find a basis for each.\n",
    "(a) The subspace {a2x2 + a1x + a0 | a2 −2a1 = a0 } of P2\n(b) The space of three-wide row vectors whose ﬁrst and second components add\nto zero\n(c) This subspace of the 2×2 matrices\n{\n\u0012a\nb\n0\nc\n\u0013\n| c −2b = 0}\n1.28 Find a basis for each space, and verify that it is a basis.\n",
    "(a) The subspace M = {a + bx + cx2 + dx3 | a −2b + c −d = 0} of P3.\n(b) This subspace of M2×2.\n",
    "W = {\n\u0012a\nb\nc\nd\n\u0013\n| a −c = 0}\n1.29 Check Example 1.6.\n✓1.30 Find the span of each set and then ﬁnd a basis for that span.\n\n",
    "128\nChapter Two.",
    "Vector Spaces\n(a) {1 + x, 1 + 2x} in P2\n(b) {2 −2x, 3 + 4x2 } in P2\n✓1.31 Find a basis for each of these subspaces of the space P3 of cubic polynomi-\nals.\n",
    "(a) The subspace of cubic polynomials p(x) such that p(7) = 0\n(b) The subspace of polynomials p(x) such that p(7) = 0 and p(5)",
    "= 0\n(c)",
    "The subspace of polynomials p(x) such that p(7) = 0, p(5) = 0, and p(3)",
    "= 0\n(d)",
    "The space of polynomials p(x) such that p(7) = 0, p(5) = 0, p(3) = 0,\nand p(1)",
    "= 0\n1.32",
    "We’ve seen that the result of reordering a basis can be another basis.",
    "Must it\nbe?\n",
    "1.33 Can a basis contain a zero vector?\n✓1.34 Let ⟨⃗β1, ⃗β2, ⃗β3⟩be a basis for a vector space.\n",
    "(a) Show that ⟨c1⃗β1, c2⃗β2, c3⃗β3⟩is a basis when c1, c2, c3 ̸= 0.",
    "What happens\nwhen at least one ci is 0?\n(b) Prove that ⟨⃗α1, ⃗α2, ⃗α3⟩is a basis where ⃗αi = ⃗β1 + ⃗βi.\n",
    "1.35 Find one vector ⃗v that will make each into a basis for the space.\n",
    "(a) ⟨\n\u00121\n1\n\u0013\n,⃗v⟩in R2\n(b) ⟨\n\n\n1\n1\n0\n\n,\n\n\n0\n1\n0\n\n,⃗v⟩in",
    "R3\n(c) ⟨x, 1 + x2,⃗v⟩in P2\n✓1.36 Consider 2 + 4x2, 1 + 3x2, 1 + 5x2 ∈P2.\n(a) Find a linear relationship among the three.\n(b) Represent them with respect to B = ⟨1 −x, 1 + x, x2⟩.\n(c) Check that the same linear relationship holds among the representations, as\nin Lemma 1.18.\n✓1.37 Where ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis, show that in this equation\nc1⃗β1 + · · · + ck⃗βk = ck+1⃗βk+1 + · · ·",
    "+ cn⃗βn\neach of the ci’s is zero.",
    "Generalize.\n",
    "1.38",
    "A basis contains some of the vectors from a vector space; can it contain them\nall?\n1.39 Theorem 1.12 shows that, with respect to a basis, every linear combination is\nunique.",
    "If a subset is not a basis, can linear combinations be not unique?",
    "If so,\nmust they be?\n",
    "1.40 A square matrix is symmetric if for all indices i and j, entry i, j equals entry\nj, i.\n(a) Find a basis for the vector space of symmetric 2×2 matrices.\n",
    "(b) Find a basis for the space of symmetric 3×3 matrices.\n",
    "(c) Find a basis for the space of symmetric n×n matrices.\n",
    "1.41 We can show that every basis for R3 contains the same number of vec-\ntors.\n",
    "(a) Show that no linearly independent subset of R3 contains more than three\nvectors.\n",
    "(b) Show that no spanning subset of R3 contains fewer than three vectors.",
    "Hint:\nrecall how to calculate the span of a set and show that this method cannot yield\nall of R3 when we apply it to fewer than three vectors.\n\nSection III.",
    "Basis and Dimension\n129\n1.42 One of the exercises in the Subspaces subsection shows that the set\n{\n\n\nx\ny\nz\n\n",
    "|",
    "x + y + z = 1}\nis a vector space under these operations.\n",
    "\n\nx1\ny1\nz1\n\n+\n\n\nx2\ny2\nz2\n\n=\n\n\nx1 + x2 −1\ny1 + y2\nz1 + z2\n\n\nr\n\n\nx\ny\nz\n\n=\n\n\nrx −r + 1\nry\nrz\n\n\nFind a basis.\n",
    "III.2\nDimension\nThe previous subsection deﬁnes a basis of a vector space and shows that a space\ncan have many diﬀerent bases.",
    "So we cannot talk about “the” basis for a vector\nspace.",
    "True, some vector spaces have bases that strike us as more natural than\nothers, for instance, R2’s basis E2 or P2’s basis ⟨1, x, x2⟩.",
    "But for the vector\nspace {a2x2 + a1x + a0 | 2a2 −a0 = a1 }, no particular basis leaps out at us as\nthe natural one.",
    "We cannot, in general, associate with a space any single basis\nthat best describes it.\n",
    "We can however ﬁnd something about the bases that is uniquely associated\nwith the space.",
    "This subsection shows that any two bases for a space have the\nsame number of elements.",
    "So with each space we can associate a number, the\nnumber of vectors in any of its bases.\n",
    "Before we start, we ﬁrst limit our attention to spaces where at least one basis\nhas only ﬁnitely many members.\n",
    "2.1 Deﬁnition A vector space is ﬁnite-dimensional if it has a basis with only\nﬁnitely many vectors.\n",
    "One space that is not ﬁnite-dimensional is the set of polynomials with real\ncoeﬃcients, Example 1.11.",
    "This is not spanned by any ﬁnite subset since that\nwould contain a polynomial of largest degree but this space has polynomials\nof all degrees.",
    "Such spaces are interesting and important but we will focus\nin a diﬀerent direction.",
    "From now on we will study only ﬁnite-dimensional\nvector spaces.",
    "In the rest of this book we shall take ‘vector space’ to mean\n‘ﬁnite-dimensional vector space’.\n",
    "To prove the main theorem we shall use a technical result, the Exchange\nLemma.",
    "We ﬁrst illustrate it with an example.\n\n",
    "130\nChapter Two.",
    "Vector Spaces\n2.2 Example Here is a basis for R3 and a vector given as a linear combination of\nmembers of that basis.\n",
    "B = ⟨\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n1\n1\n0\n\n\n,\n\n\n\n0\n0\n2\n\n\n⟩\n\n\n\n1\n2\n0\n\n\n= (−1) ·\n\n\n\n1\n0\n0\n\n\n+ 2\n\n\n\n1\n1\n0\n\n\n+ 0 ·\n\n\n\n0\n0\n2\n\n\n\nTwo of the basis vectors have non-zero coeﬃcients.",
    "Pick one, for instance the\nﬁrst.",
    "Replace it with the vector that we’ve expressed as the combination\nˆB = ⟨\n\n\n\n1\n2\n0\n\n\n,\n\n\n\n1\n1\n0\n\n\n,\n\n\n\n0\n0\n2\n\n\n⟩\nand the result is another basis for R3.\n",
    "2.3 Lemma (Exchange Lemma) Assume that B = ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis for a\nvector space, and that for the vector ⃗v the relationship ⃗v = c1⃗β1 + c2⃗β2 + · · · +\ncn⃗βn has ci ̸= 0.",
    "Then exchanging ⃗βi for ⃗v yields another basis for the space.\n",
    "Proof Call the outcome of the exchange ˆB = ⟨⃗β1, . . .",
    ", ⃗βi−1,⃗v, ⃗βi+1, . . . , ⃗βn⟩.\nWe ﬁrst show that ˆB is linearly independent.",
    "Any relationship d1⃗β1 + · · · +\ndi⃗v + · · · + dn⃗βn = ⃗0 among the members of ˆB, after substitution for ⃗v,\nd1⃗β1 + · · · + di · (c1⃗β1 + · · · + ci⃗βi + · · · + cn⃗βn) + · · · + dn⃗βn = ⃗0\n(∗)\ngives a linear relationship among the members of B. The basis B is linearly\nindependent so the coeﬃcient dici of ⃗βi is zero.",
    "Because we assumed that ci is\nnonzero, di = 0.",
    "Using this in equation (∗) gives that all of the other d’s are\nalso zero.",
    "Therefore ˆB is linearly independent.\n",
    "We ﬁnish by showing that ˆB has the same span as B. Half of this argument,\nthat [ˆB] ⊆[B], is easy; we can write any member d1⃗β1+· · ·+di⃗v+· · ·+dn⃗βn of [ˆB]\nas d1⃗β1+· · ·+di·(c1⃗β1+· · ·+cn⃗βn)+· · ·+dn⃗βn, which is a linear combination\nof linear combinations of members of B, and hence is in [B].",
    "For the [B] ⊆[ˆB]\nhalf of the argument, recall that if ⃗v = c1⃗β1+· · ·+cn⃗βn with ci ̸= 0",
    "then we can\nrearrange the equation to ⃗βi = (−c1/ci)⃗β1 + · · · + (1/ci)⃗v + · · · + (−cn/ci)⃗βn.\n",
    "Now, consider any member d1⃗β1 + · · ·",
    "+ di⃗βi + · · · + dn⃗βn of [B], substitute for\n⃗βi its expression as a linear combination of the members of ˆB, and recognize,\nas in the ﬁrst half of this argument, that the result is a linear combination of\nlinear combinations of members of ˆB, and hence is in [ˆB].\nQED\n\nSection III.",
    "Basis and Dimension\n131\n2.4 Theorem In any ﬁnite-dimensional vector space, all bases have the same\nnumber of elements.\n",
    "Proof Fix a vector space with at least one ﬁnite basis.",
    "Choose, from among\nall of this space’s bases, one B = ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩of minimal size.",
    "We will show\nthat any other basis D = ⟨⃗δ1,⃗δ2, . .",
    ".⟩also has the same number of members, n.\n",
    "Because B has minimal size, D has no fewer than n vectors.",
    "We will argue that\nit cannot have more than n vectors.\n",
    "The basis B spans the space and ⃗δ1 is in the space, so ⃗δ1 is a nontrivial linear\ncombination of elements of B. By the Exchange Lemma, we can swap ⃗δ1 for a\nvector from B, resulting in a basis B1, where one element is ⃗δ1 and all of the\nn −1 other elements are ⃗β’s.\n",
    "The prior paragraph forms the basis step for an induction argument.",
    "The\ninductive step starts with a basis Bk (for 1 ⩽k < n) containing k members of D\nand n −k members of B.",
    "We know that D has at least n members so there is a\n⃗δk+1.",
    "Represent it as a linear combination of elements of Bk.",
    "The key point: in\nthat representation, at least one of the nonzero scalars must be associated with\na ⃗βi or else that representation would be a nontrivial linear relationship among\nelements of the linearly independent set D. Exchange ⃗δk+1 for ⃗βi to get a new\nbasis Bk+1 with one ⃗δ more and one ⃗β fewer than the previous basis Bk.\n",
    "Repeat that until no ⃗β’s remain, so that Bn contains ⃗δ1, . . .",
    ",⃗δn.",
    "Now, D\ncannot have more than these n vectors because any ⃗δn+1 that remains would be\nin the span of Bn (since it is a basis) and hence would be a linear combination\nof the other ⃗δ’s, contradicting that D is linearly independent.\n",
    "QED\n2.5 Deﬁnition The dimension of a vector space is the number of vectors in any\nof its bases.\n",
    "2.6 Example Any basis for Rn has n vectors since the standard basis En has n\nvectors.",
    "Thus, this deﬁnition of ‘dimension’ generalizes the most familiar use of\nterm, that Rn is n-dimensional.\n",
    "2.7 Example The space Pn of polynomials of degree at most n has dimension\nn+1.",
    "We can show this by exhibiting any basis — ⟨1, x, . . .",
    ", xn⟩comes to mind —\nand counting its members.\n",
    "2.8 Example The space of functions {a · cos θ + b · sin θ | a, b ∈R} of the real\nvariable θ has dimension 2 since this space has the basis ⟨cos θ, sin θ⟩.\n2.9 Example A trivial space is zero-dimensional since its basis is empty.\n",
    "Again, although we sometimes say ‘ﬁnite-dimensional’ for emphasis, from\nnow on we take all vector spaces to be ﬁnite-dimensional.",
    "So in the next result\nthe word ‘space’ means ‘ﬁnite-dimensional vector space’.\n\n",
    "132\nChapter Two.",
    "Vector Spaces\n2.10 Corollary No linearly independent set can have a size greater than the\ndimension of the enclosing space.\n",
    "Proof The proof of Theorem 2.4 never uses that D spans the space, only that\nit is linearly independent.\n",
    "QED\n2.11 Example Recall the diagram from Example I.2.19 showing the subspaces\nof R3.",
    "Each subspace is described with a minimal spanning set, a basis.",
    "The\nwhole space has a basis with three members, the plane subspaces have bases\nwith two members, the line subspaces have bases with one member, and the\ntrivial subspace has a basis with zero members.\n",
    "In that section we could not show that these are R3’s only subspaces.",
    "We can\nshow it now.",
    "The prior corollary proves that There are no, say, ﬁve-dimensional\nsubspaces of three-space.",
    "Further, by Deﬁnition 2.5 the dimension of every\nspace is a whole number so there are no subspaces of R3 that are somehow\n1.5-dimensional, between lines and planes.",
    "Thus the list of subspaces that we\ngave is exhaustive; the only subspaces of R3 are either three-, two-, one-, or\nzero-dimensional.\n",
    "2.12 Corollary Any linearly independent set can be expanded to make a basis.\n",
    "Proof If a linearly independent set is not already a basis then it must not span\nthe space.",
    "Adding to the set a vector that is not in the span will preserve linear\nindependence by Lemma II.1.15.",
    "Keep adding until the resulting set does span\nthe space, which the prior corollary shows will happen after only a ﬁnite number\nof steps.\n",
    "QED\n2.13 Corollary Any spanning set can be shrunk to a basis.\n",
    "Proof Call the spanning set S.",
    "If S is empty then it is already a basis (the\nspace must be a trivial space).",
    "If S = {⃗0} then it can be shrunk to the empty\nbasis, thereby making it linearly independent, without changing its span.\n",
    "Otherwise, S contains a vector ⃗s1 with ⃗s1 ̸= ⃗0 and we can form a basis\nB1 = ⟨⃗s1⟩.",
    "If [B1] = [S] then we are done.",
    "If not then there is a ⃗s2 ∈[S] such\nthat ⃗s2 ̸∈[B1].",
    "Let B2 = ⟨⃗s1, ⃗s2⟩; by Lemma II.1.15 this is linearly independent\nso if [B2",
    "] =",
    "[S] then we are done.\n",
    "We can repeat this process until the spans are equal, which must happen in\nat most ﬁnitely many steps.\n",
    "QED\n2.14 Corollary",
    "In an n-dimensional space, a set composed of n vectors is linearly\nindependent if and only if it spans the space.\n\nSection III.",
    "Basis and Dimension\n133\nProof First we will show that a subset with n vectors is linearly independent if\nand only if it is a basis.",
    "The ‘if’ is trivially true — bases are linearly independent.\n",
    "‘Only if’ holds because a linearly independent set can be expanded to a basis,\nbut a basis has n elements, so this expansion is actually the set that we began\nwith.\n",
    "To ﬁnish, we will show that any subset with n vectors spans the space if and\nonly if it is a basis.",
    "Again, ‘if’ is trivial.",
    "‘Only if’ holds because any spanning\nset can be shrunk to a basis, but a basis has n elements and so this shrunken\nset is just the one we started with.\n",
    "QED\nThe main result of this subsection, that all of the bases in a ﬁnite-dimensional\nvector space have the same number of elements, is the single most important\nresult in this book.",
    "As Example 2.11 shows, it describes what vector spaces and\nsubspaces there can be.\n",
    "One immediate consequence brings us back to when we considered the two\nthings that could be meant by the term ‘minimal spanning set’.",
    "At that point we\ndeﬁned ‘minimal’ as linearly independent but we noted that another reasonable\ninterpretation of the term is that a spanning set is ‘minimal’ when it has the\nfewest number of elements of any set with the same span.",
    "Now that we have\nshown that all bases have the same number of elements, we know that the two\nsenses of ‘minimal’ are equivalent.\n",
    "Exercises\nAssume that all spaces are ﬁnite-dimensional unless otherwise stated.\n",
    "✓2.15 Find a basis for, and the dimension of, P2.\n",
    "2.16 Find a basis for, and the dimension of, the solution set of this system.\n",
    "x1 −4x2 + 3x3 −x4 = 0\n2x1 −8x2",
    "+ 6x3 −2x4 = 0\n✓2.17 Find a basis for, and the dimension of, each space.\n",
    "(a) {\n\n\n\n\nx\ny\nz\nw\n\n\n\n∈R4",
    "| x",
    "−w + z = 0}\n(b) the set of 5×5 matrices whose only nonzero entries are on the diagonal (e.g.,\nin entry 1, 1 and 2, 2, etc.)\n",
    "(c) {a0 +",
    "a1x",
    "+ a2x2",
    "+ a3x3 | a0 + a1 = 0 and a2 −2a3 = 0} ⊆P3\n2.18 Find a basis for, and the dimension of, M2×2, the vector space of 2×2 matrices.\n",
    "2.19 Find the dimension of the vector space of matrices\n\u0012a\nb\nc\nd\n\u0013\nsubject to each condition.\n",
    "(a) a, b, c, d ∈R\n(b) a −b + 2c = 0 and d ∈R\n\n134\nChapter Two.",
    "Vector Spaces\n(c) a + b + c",
    "= 0, a + b −c = 0, and d ∈R\n✓2.20 Find the dimension of this subspace of R2.\n",
    "S = {\n\u0012a + b\na + c\n\u0013\n| a, b, c ∈R}\n✓2.21 Find the dimension of each.\n",
    "(a) The space of cubic polynomials p(x) such that p(7) = 0\n(b) The space of cubic polynomials p(x) such that p(7) = 0 and p(5)",
    "= 0\n(c)",
    "The space of cubic polynomials p(x) such that p(7) = 0, p(5) = 0, and p(3)",
    "= 0\n(d)",
    "The space of cubic polynomials p(x) such that p(7) = 0, p(5) = 0, p(3) = 0,\nand p(1)",
    "= 0\n2.22",
    "What is the dimension of the span of the set {cos2 θ, sin2 θ, cos 2θ, sin 2θ}?",
    "This\nspan is a subspace of the space of all real-valued functions of one real variable.\n",
    "2.23 Find the dimension of C47, the vector space of 47-tuples of complex numbers.\n",
    "2.24",
    "What is the dimension of the vector space M3×5 of 3×5 matrices?\n✓2.25 Show that this is a basis for R4.\n",
    "⟨\n\n\n\n\n1\n0\n0\n0\n\n\n\n,\n\n\n\n\n1\n1\n0\n0\n\n\n\n,\n\n\n\n\n1\n1\n1\n0\n\n\n\n,\n\n\n\n\n1\n1\n1\n1\n\n\n\n⟩\n(We can use the results of this subsection to simplify this job.)\n2.26 Decide if each is a basis for P2.\n(a) {1, x2, x2 −x}\n(b) {x2 + x, x2 −x}\n(c) {2x2 + x + 1, 2x + 1, 2}\n(d) {3x2, −1, 3x, x2 −x}\n2.27 Refer to Example 2.11.\n",
    "(a) Sketch a similar subspace diagram for P2.\n(b) Sketch one for M2×2.\n",
    "✓2.28 Where S is a set, the functions f: S →R form a vector space under the natural\noperations: the sum f",
    "+ g is the function given by f + g (s) = f(s)",
    "+ g(s) and the\nscalar product is r · f (s) =",
    "r · f(s).",
    "What is the dimension of the space resulting for\neach domain?\n(a) S = {1}\n(b) S = {1, 2}\n(c) S = {1, . . .",
    ", n}\n2.29 (See Exercise 28.)",
    "Prove that this is an inﬁnite-dimensional space: the set of\nall functions f: R →R under the natural operations.\n",
    "2.30 (See Exercise 28.)",
    "What is the dimension of the vector space of functions\nf: S →R, under the natural operations, where the domain S is the empty set?\n2.31 Show that any set of four vectors in R2 is linearly dependent.\n",
    "2.32 Show that ⟨⃗α1, ⃗α2, ⃗α3⟩⊂R3 is a basis if and only if there is no plane through\nthe origin containing all three vectors.\n",
    "2.33 Prove that any subspace of a ﬁnite dimensional space is ﬁnite dimensional.\n",
    "2.34 Where is the ﬁniteness of B used in Theorem 2.4?\n",
    "2.35 Prove that if U and W are both three-dimensional subspaces of R5 then U ∩W\nis non-trivial.",
    "Generalize.\n\nSection III.",
    "Basis and Dimension\n135\n2.36 A basis for a space consists of elements of that space.",
    "So we are naturally led to\nhow the property ‘is a basis’ interacts with operations ⊆and ∩and ∪. (Of course,\na basis is actually a sequence that it is ordered, but there is a natural extension of\nthese operations.)\n",
    "(a) Consider ﬁrst how bases might be related by ⊆.\nAssume that U, W are\nsubspaces of some vector space and that U ⊆W. Can there exist bases BU for U\nand BW for W such that BU ⊆BW?",
    "Must such bases exist?\n",
    "For any basis BU for U, must there be a basis BW for W such that BU ⊆BW?\n",
    "For any basis BW for W, must there be a basis BU for U such that BU ⊆BW?\n",
    "For any bases BU, BW for U and W, must BU be a subset of BW?\n(b) Is the ∩of bases a basis?",
    "For what space?\n(c) Is the ∪of bases a basis?",
    "For what space?\n(d) What about the complement operation?\n(Hint.",
    "Test any conjectures against some subspaces of R3.)\n",
    "✓2.37 Consider how ‘dimension’ interacts with ‘subset’.",
    "Assume U and W are both\nsubspaces of some vector space, and that U ⊆W.\n(a) Prove that dim(U) ⩽dim(W).\n",
    "(b) Prove that equality of dimension holds if and only if U = W.\n(c) Show that the prior item does not hold if they are inﬁnite-dimensional.\n",
    "2.38 Here is an alternative proof of this section’s main result, Theorem 2.4.",
    "First is\nan example, then a lemma, then the theorem.\n",
    "(a) Express this vector from R3 a as a linear combination of members of the basis.\n",
    "B = ⟨\n\n\n1\n0\n0\n\n,\n\n\n1\n1\n0\n\n,\n\n\n0\n0\n2\n\n⟩\n⃗v =\n\n\n1\n2\n0\n\n\n(b)",
    "In that combination pick a basis vector with a non-zero coeﬃcient.",
    "Alter B\nby exchanging ⃗v for that basis vector, to get a new sequence ˆB. Check that ˆB is\nalso a basis for R3.\n",
    "(c) (Exchange Lemma) Assume that B = ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis for a vector space,\nand that for the vector ⃗v the relationship ⃗v = c1⃗β1 +c2⃗β2 +· · ·+cn⃗βn has ci ̸= 0.\nProve that exchanging ⃗v for ⃗βi yields another basis for the space.\n",
    "(d) Use that, with induction, to prove Theorem 2.4.\n?",
    "2.39",
    "[Sheﬀer] A library has n books and n + 1 subscribers.",
    "Each subscriber read at\nleast one book from the library.",
    "Prove that there must exist two disjoint sets of\nsubscribers who read exactly the same books (that is, the union of the books read\nby the subscribers in each set is the same).\n?",
    "2.40",
    "[Wohascum no. 47] For any vector ⃗v in Rn and any permutation σ of the\nnumbers 1, 2, . . . , n (that is, σ is a rearrangement of those numbers into a new\norder), deﬁne σ(⃗v) to be the vector whose components are vσ(1), vσ(2), . . .",
    ", and\nvσ(n) (where σ(1) is the ﬁrst number in the rearrangement, etc.).",
    "Now ﬁx ⃗v and let\nV be the span of {σ(⃗v) | σ permutes 1, . .",
    ". , n}.",
    "What are the possibilities for the\ndimension of V?\n\n136\nChapter Two.",
    "Vector Spaces\nIII.3\nVector Spaces and Linear Systems\n",
    "We will now reconsider linear systems and Gauss’s Method, aided by the tools\nand terms of this chapter.",
    "We will make three points.\n",
    "For the ﬁrst, recall the insight from the Chapter One that Gauss’s Method\nworks by taking linear combinations of rows — if two matrices are related by\nrow operations A −→· · · −→B then each row of B is a linear combination of\nthe rows of A. Therefore, the right setting in which to study row operations in\ngeneral, and Gauss’s Method in particular, is the following vector space.\n",
    "3.1 Deﬁnition The row space of a matrix is the span of the set of its rows.",
    "The\nrow rank is the dimension of this space, the number of linearly independent\nrows.\n",
    "3.2 Example",
    "If\nA =\n \n2\n3\n4\n6\n!\nthen Rowspace(A) is this subspace of the space of two-component row vectors.\n",
    "{c1 · (2 3) + c2 · (4 6) | c1, c2 ∈R}\nThe second row vector is linearly dependent on the ﬁrst and so we can simplify\nthe above description to {c · (2 3) | c ∈R}.\n",
    "3.3 Lemma If two matrices A and B are related by a row operation\nA\nρi↔ρj\n−→\nB\nor\nA\nkρi\n−→\nB\nor\nA\nkρi+ρj\n−→\nB\n(for i ̸= j and k ̸= 0) then their row spaces are equal.",
    "Hence, row-equivalent\nmatrices have the same row space and therefore the same row rank.\n",
    "Proof Corollary One.III.2.4 shows that when A −→B then each row of B is a\nlinear combination of the rows of A. That is, in the above terminology, each row\nof B is an element of the row space of A. Then Rowspace(B) ⊆Rowspace(A)\nfollows because a member of the set Rowspace(B) is a linear combination of the\nrows of B, so it is a combination of combinations of the rows of A, and by the\nLinear Combination Lemma is also a member of Rowspace(A).\n",
    "For the other set containment, recall Lemma One.III.1.5, that row opera-\ntions are reversible",
    "so A −→B if and only if B −→A. Then Rowspace(A) ⊆\nRowspace(B) follows as in the previous paragraph.\n",
    "QED\nOf course, Gauss’s Method performs the row operations systematically, with\nthe goal of echelon form.\n\n",
    "Section III.",
    "Basis and Dimension\n137\n3.4 Lemma The nonzero rows of an echelon form matrix make up a linearly\nindependent set.\n",
    "Proof Lemma One.III.2.5 says that no nonzero row of an echelon form matrix\nis a linear combination of the other rows.",
    "This result restates that using this\nchapter’s terminology.\n",
    "QED\nThus, in the language of this chapter, Gaussian reduction works by eliminating\nlinear dependences among rows, leaving the span unchanged, until no nontrivial\nlinear relationships remain among the nonzero rows.",
    "In short, Gauss’s Method\nproduces a basis for the row space.\n",
    "3.5 Example From any matrix, we can produce a basis for the row space by\nperforming Gauss’s Method and taking the nonzero rows of the resulting echelon\nform matrix.",
    "For instance,\n\n\n\n1\n3\n1\n1\n4\n1\n2\n0\n5\n\n\n\n−ρ1+ρ2\n−→\n−2ρ1+ρ3\n6ρ2+ρ3\n−→\n\n\n\n1\n3\n1\n0\n1\n0\n0\n0\n3\n\n\n\nproduces the basis ⟨(1 3 1), (0 1 0), (0 0 3)⟩for the row space.",
    "This is a basis\nfor the row space of both the starting and ending matrices, since the two row\nspaces are equal.\n",
    "Using this technique, we can also ﬁnd bases for spans not directly involving\nrow vectors.\n",
    "3.6 Deﬁnition The column space of a matrix is the span of the set of its columns.\n",
    "The column rank is the dimension of the column space, the number of linearly\nindependent columns.\n",
    "Our interest in column spaces stems from our study of linear systems.",
    "An\nexample is that this system\nc1 +",
    "3c2 + 7c3 = d1\n2c1",
    "+ 3c2 + 8c3 = d2\nc2 + 2c3 = d3\n4c1\n+ 4c3",
    "= d4\nhas a solution if and only if the vector of d’s is a linear combination of the other\ncolumn vectors,\nc1\n\n\n\n\n\n1\n2\n0\n4\n\n\n\n\n+ c2\n\n\n\n\n\n3\n3\n1\n0\n\n\n\n\n+ c3\n\n\n\n\n\n7\n8\n2\n4\n\n\n\n\n=\n\n\n\n\n\nd1\nd2\nd3\nd4\n\n\n\n\n\n\n138\nChapter Two.",
    "Vector Spaces\nmeaning that the vector of d’s is in the column space of the matrix of coeﬃcients.\n",
    "3.7 Example Given this matrix,\n\n\n\n\n\n1\n3\n7\n2\n3\n8\n0\n1\n2\n4\n0\n4\n\n\n\n\n\nto get a basis for the column space, temporarily turn the columns into rows and\nreduce.\n",
    "\n\n\n1\n2\n0\n4\n3\n3\n1\n0\n7\n8\n2\n4\n\n\n\n−3ρ1+ρ2\n−→\n−7ρ1+ρ3\n−2ρ2+ρ3\n−→\n\n\n\n1\n2\n0\n4\n0\n−3\n1\n−12\n0\n0\n0\n0\n\n\n\nNow turn the rows back to columns.\n",
    "⟨\n\n\n\n\n\n1\n2\n0\n4\n\n\n\n\n,\n\n\n\n\n\n0\n−3\n1\n−12\n\n\n\n\n⟩\nThe result is a basis for the column space of the given matrix.\n",
    "3.8 Deﬁnition The transpose of a matrix is the result of interchanging its rows\nand columns, so that column j of the matrix A is row j of AT and vice versa.\n",
    "So we can summarize the prior example as “transpose, reduce, and transpose\nback.”\n",
    "We can even, at the price of tolerating the as-yet-vague idea of vector spaces\nbeing “the same,” use Gauss’s Method to ﬁnd bases for spans in other types of\nvector spaces.\n",
    "3.9 Example To get a basis for the span of {x2 + x4, 2x2 + 3x4, −x2 −3x4} in\nthe space P4, think of these three polynomials as “the same” as the row vectors\n(0 0 1 0 1), (0 0 2 0 3), and (0 0 −1 0",
    "−3",
    "), apply Gauss’s Method\n\n\n\n0\n0\n1\n0\n1\n0\n0\n2\n0\n3\n0\n0\n−1\n0\n−3\n\n\n\n−2ρ1+ρ2\n−→\nρ1+ρ3\n2ρ2+ρ3\n−→\n\n\n\n0\n0\n1\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n\nand translate back to get the basis ⟨x2 + x4, x4⟩. (As mentioned earlier, we will\nmake the phrase “the same” precise at the start of the next chapter.)\n\nSection III.",
    "Basis and Dimension\n139\n",
    "Thus, the ﬁrst point for this subsection is that the tools of this chapter give\nus a more conceptual understanding of Gaussian reduction.\n",
    "For the second point observe that row operations on a matrix can change its\ncolumn space.\n \n1\n2\n2\n4\n!\n−2ρ1+ρ2\n−→\n \n1\n2\n0\n0\n!\n",
    "The column space of the left-hand matrix contains vectors with a second compo-\nnent that is nonzero but the column space of the right-hand matrix contains\nonly vectors whose second component is zero, so the two spaces are diﬀerent.\n",
    "This observation makes next result surprising.\n",
    "3.10 Lemma Row operations do not change the column rank.\n",
    "Proof Restated, if A reduces to B then the column rank of B equals the column\nrank of A.\n",
    "This proof will be ﬁnished if we show that row operations do not aﬀect linear\nrelationships among columns, because the column rank is the size of the largest\nset of unrelated columns.",
    "That is, we will show that a relationship exists among\ncolumns (such as that the ﬁfth column is twice the second plus the fourth) if and\nonly if that relationship exists after the row operation.",
    "But this is exactly the\nﬁrst theorem of this book, Theorem One.I.1.5: in a relationship among columns,\nc1 ·\n\n\n\n\n\n\na1,1\na2,1\n...\n",
    "am,1\n\n\n\n\n\n\n+ · · · + cn ·\n\n\n\n\n\n\na1,n\na2,n\n...\nam,n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n0\n0\n...\n0\n\n\n\n\n\n\nrow operations leave unchanged the set of solutions (c1, . . .",
    ", cn).\n",
    "QED\nAnother way to make the point that Gauss’s Method has something to say\nabout the column space as well as about the row space is with Gauss-Jordan\nreduction.",
    "It ends with the reduced echelon form of a matrix, as here.\n",
    "\n\n\n1\n3\n1\n6\n2\n6\n3\n16\n1\n3\n1\n6\n\n\n\n−→\n· · ·\n−→\n\n\n\n1\n3\n0\n2\n0\n0\n1\n4\n0\n0\n0\n0\n\n\n\nConsider the row space and the column space of this result.\n",
    "The ﬁrst point made earlier in this subsection says that to get a basis for the\nrow space we can just collect the rows with leading entries.",
    "However, because\nthis is in reduced echelon form, a basis for the column space is just as easy: collect\nthe columns containing the leading entries, ⟨⃗e1,⃗e2⟩. Thus, for a reduced echelon\n\n140\nChapter Two.",
    "Vector Spaces\nform matrix we can ﬁnd bases for the row and column spaces in essentially the\nsame way, by taking the parts of the matrix, the rows or columns, containing\nthe leading entries.\n",
    "3.11 Theorem For any matrix, the row rank and column rank are equal.\n",
    "Proof Bring the matrix to reduced echelon form.",
    "Then the row rank equals\nthe number of leading entries since that equals the number of nonzero rows.\n",
    "Then also, the number of leading entries equals the column rank because the\nset of columns containing leading entries consists of some of the ⃗ei’s from a\nstandard basis, and that set is linearly independent and spans the set of columns.\n",
    "Hence, in the reduced echelon form matrix, the row rank equals the column\nrank, because each equals the number of leading entries.\n",
    "But Lemma 3.3 and Lemma 3.10 show that the row rank and column rank\nare not changed by using row operations to get to reduced echelon form.",
    "Thus\nthe row rank and the column rank of the original matrix are also equal.\n",
    "QED\n3.12 Deﬁnition The rank of a matrix is its row rank or column rank.\n",
    "So the second point that we have made in this subsection is that the column\nspace and row space of a matrix have the same dimension.\n",
    "Our ﬁnal point is that the concepts that we’ve seen arising naturally in the\nstudy of vector spaces are exactly the ones that we have studied with linear\nsystems.\n",
    "3.13 Theorem For linear systems with n unknowns and with matrix of coeﬃcients\nA, the statements\n(1) the rank of A is r\n(2) the vector space of solutions of the associated homogeneous system has\ndimension n −r\nare equivalent.\n",
    "So if the system has at least one particular solution then for the set of solutions,\nthe number of parameters equals n −r, the number of variables minus the rank\nof the matrix of coeﬃcients.\n",
    "Proof The rank of A is r if and only if Gaussian reduction on A ends with r\nnonzero rows.",
    "That’s true if and only if echelon form matrices row equivalent\nto A have r-many leading variables.",
    "That in turn holds if and only if there are\nn −r free variables.\n",
    "QED\n\nSection III.",
    "Basis and Dimension\n141\n3.14 Corollary Where the matrix A is n×n, these statements\n(1) the rank of A is n\n(2) A is nonsingular\n(3) the rows of A form a linearly independent set\n(4) the columns of A form a linearly independent set\n(5) any linear system whose matrix of coeﬃcients is A has one and only one\nsolution\nare equivalent.\n",
    "Proof Clearly (1) ⇐⇒(2) ⇐⇒(3) ⇐⇒(4).",
    "The last, (4) ⇐⇒(5), holds\nbecause a set of n column vectors is linearly independent if and only if it is a\nbasis for Rn, but the system\nc1\n\n\n\n\n\n\na1,1\na2,1\n...\n",
    "am,1\n\n\n\n\n\n\n+ · · · + cn\n\n\n\n\n\n\na1,n\na2,n\n...\nam,n\n\n\n\n\n\n\n=\n\n\n\n\n\n\nd1\nd2\n...\n",
    "dm\n\n\n\n\n\n\nhas a unique solution for all choices of d1, . .",
    ".",
    ", dn ∈R if and only if the vectors\nof a’s on the left form a basis.\n",
    "QED\n3.15 Remark [Munkres] Sometimes the results of this subsection are mistakenly\nremembered to say that the general solution of an m equations, n unknowns\nsystem uses n −m parameters.",
    "The number of equations is not the relevant\nnumber; rather, what matters is the number of independent equations, the num-\nber of equations in a maximal independent set.",
    "Where there are r independent\nequations, the general solution involves n −r parameters.\n",
    "Exercises\n3.16 Transpose each.\n(a)\n\u00122\n1\n3\n1\n\u0013\n(b)\n\u00122\n1\n1\n3\n\u0013\n(c)\n\u00121\n4\n3\n6\n7\n8\n\u0013\n(d)\n\n\n0\n0\n0\n\n\n(e) (−1 −2)\n✓3.17 Decide if the vector is in the row space of the matrix.\n(a)\n\u00122\n1\n3\n1\n\u0013\n, (1 0)\n(b)\n\n\n0\n1\n3\n−1\n0\n1\n−1\n2\n7\n\n, (1 1 1)\n✓3.18 Decide if the vector is in the column space.\n",
    "(a)\n\u00121\n1\n1\n1\n\u0013\n,\n\u00121\n3\n\u0013\n(b)\n\n\n1\n3\n1\n2\n0\n4\n1\n−3\n−3\n\n,\n\n\n1\n0\n0\n\n\n✓3.19 Decide if the vector is in the column space of the matrix.\n\n142\nChapter Two.",
    "Vector Spaces\n(a)\n\u00122\n1\n2\n5\n\u0013\n,\n\u0012 1\n−3\n\u0013\n(b)\n\u00124\n−8\n2\n−4\n\u0013\n,\n\u00120\n1\n\u0013\n(c)\n\n\n1\n−1\n1\n1\n1\n−1\n−1\n−1\n1\n\n,\n\n\n2\n0\n0\n\n\n✓3.20 Find a basis for the row space of this matrix.\n\n\n\n\n2\n0\n3\n4\n0\n1\n1\n−1\n3\n1\n0\n2\n1\n0\n−4\n−1\n\n\n\n\n✓3.21 Find the rank of each matrix.\n(a)\n\n\n2\n1\n3\n1\n−1\n2\n1\n0\n3\n\n\n(b)\n\n\n1\n−1\n2\n3\n−3\n6\n−2\n2\n−4\n\n\n(c)\n\n\n1\n3\n2\n5\n1\n1\n6\n4\n3\n\n\n(d)\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3.22 Give a basis for the column space of this matrix.",
    "Give the matrix’s rank.\n",
    "\n\n1\n3\n−1\n2\n2\n1\n1\n0\n0\n1\n1\n4\n\n\n✓3.23 Find a basis for the span of each set.\n",
    "(a) {(1 3), (−1 3), (1 4), (2 1)} ⊆M1×2\n(b) {\n\n\n1\n2\n1\n\n,\n\n\n3\n1\n−1\n\n,\n\n\n1\n−3\n−3\n\n} ⊆R3\n(c) {1 + x, 1 −x2, 3 + 2x −x2 } ⊆P3\n(d) {\n\u00121\n0\n1\n3\n1\n−1\n\u0013\n,\n\u00121\n0\n3\n2\n1\n4\n\u0013\n,\n\u0012−1\n0\n−5\n−1\n−1\n−9\n\u0013\n} ⊆M2×3\n3.24 Give a basis for the span of each set, in the natural vector space.\n",
    "(a) {\n\n\n1\n1\n3\n\n,\n\n\n−1\n2\n0\n\n,\n\n\n0\n12\n6\n\n}\n(b) {",
    "x + x2, 2 −2x, 7, 4 + 3x + 2x2 }\n3.25 Which matrices have rank zero?",
    "Rank one?\n✓3.26 Given a, b, c ∈R, what choice of d will cause this matrix to have the rank of\none?\n\u0012a\nb\nc\nd\n\u0013\n3.27 Find the column rank of this matrix.\n",
    "\u00121\n3\n−1\n5\n0\n4\n2\n0\n1\n0\n4\n1\n\u0013\n3.28 Show that a linear system with at least one solution has at most one solution if\nand only if the matrix of coeﬃcients has rank equal to the number of its columns.\n",
    "✓3.29 If a matrix is 5×9, which set must be dependent, its set of rows or its set of\ncolumns?\n\nSection III.",
    "Basis and Dimension\n143\n3.30 Give an example to show that, despite that they have the same dimension, the\nrow space and column space of a matrix need not be equal.",
    "Are they ever equal?\n3.31 Show that the set {(1, −1, 2, −3), (1, 1, 2, 0), (3, −1, 6, −6)} does not have the\nsame span as {(1, 0, 1, 0), (0, 2, 0, 3)}.",
    "What, by the way, is the vector space?\n✓3.32 Show that this set of column vectors\n{\n\n\nd1\nd2\nd3\n\n",
    "| there are x, y, and z such that:\n3x + 2y + 4z = d1\nx\n−z = d2\n2x + 2y + 5z = d3\n}\nis a subspace of R3.",
    "Find a basis.\n",
    "3.33 Show that the transpose operation is linear:\n(rA + sB)T = rAT + sBT\nfor r, s ∈R and A, B ∈Mm×n.\n✓3.34 In this subsection we have shown that Gaussian reduction ﬁnds a basis for the\nrow space.\n",
    "(a) Show that this basis is not unique — diﬀerent reductions may yield diﬀerent\nbases.\n",
    "(b) Produce matrices with equal row spaces but unequal numbers of rows.\n",
    "(c) Prove that two matrices have equal row spaces if and only if after Gauss-Jordan\nreduction they have the same nonzero rows.\n",
    "3.35 Why is there not a problem with Remark 3.15 in the case that r is bigger than\nn?\n3.36 Show that the row rank of an m×n matrix is at most m. Is there a better\nbound?\n3.37 Show that the rank of a matrix equals the rank of its transpose.\n",
    "3.38 True or false",
    ": the column space of a matrix equals the row space of its transpose.\n",
    "✓3.39 We have seen that a row operation may change the column space.",
    "Must it?\n",
    "3.40 Prove that a linear system has a solution if and only if that system’s matrix of\ncoeﬃcients has the same rank as its augmented matrix.\n",
    "3.41 An m×n matrix has full row rank if its row rank is m, and it has full column\nrank if its column rank is n.\n(a) Show that a matrix can have both full row rank and full column rank only if\nit is square.\n",
    "(b) Prove that the linear system with matrix of coeﬃcients A has a solution for\nany d1, . .",
    ".",
    ", dn’s on the right side if and only if A has full row rank.\n",
    "(c) Prove that a homogeneous system has a unique solution if and only if its\nmatrix of coeﬃcients A has full column rank.\n",
    "(d) Prove that the statement “if a system with matrix of coeﬃcients A has any\nsolution then it has a unique solution” holds if and only if A has full column\nrank.\n",
    "3.42 How would the conclusion of Lemma 3.3 change if Gauss’s Method were changed\nto allow multiplying a row by zero?\n3.43",
    "What is the relationship between rank(A) and rank(−A)?",
    "Between rank(A)\nand rank(kA)?",
    "What, if any, is the relationship between rank(A), rank(B), and\nrank(A + B)?\n\n144\nChapter Two.",
    "Vector Spaces\nIII.4\nCombining Subspaces\nThis subsection is optional.\n",
    "It is required only for the last sections of\nChapter Three and Chapter Five and for occasional exercises.",
    "You can\npass it over without loss of continuity.\n",
    "One way to understand something is to see how to build it from component\nparts.",
    "For instance, we sometimes think of R3 put together from the x-axis,\nthe y-axis, and z-axis.",
    "In this subsection we will describe how to decompose a\nvector space into a combination of some of its subspaces.",
    "In developing this idea\nof subspace combination, we will keep the R3 example in mind as a prototype.\n",
    "Subspaces are subsets and sets combine via union.",
    "But taking the combination\noperation for subspaces to be the simple set union operation isn’t what we want.\n",
    "For instance, the union of the x-axis, the y-axis, and z-axis is not all of R3.",
    "In\nfact this union is not a subspace because it is not closed under addition",
    ": this\nvector\n\n\n\n1\n0\n0\n\n\n+\n\n\n\n0\n1\n0\n\n\n+\n\n\n\n0\n0\n1\n\n\n=\n\n\n\n1\n1\n1\n\n\n\nis in none of the three axes and hence is not in the union.",
    "Therefore to combine\nsubspaces, in addition to the members of those subspaces, we must at least also\ninclude all of their linear combinations.\n",
    "4.1 Deﬁnition Where W1, . . .",
    ", Wk are subspaces of a vector space, their sum is\nthe span of their union W1 + W2 + · · ·",
    "+",
    "Wk =",
    "[W1 ∪W2 ∪· · · Wk].\nWriting ‘+’ ﬁts with the conventional practice of using this symbol for a natural\naccumulation operation.\n",
    "4.2 Example Our R3 prototype works with this.",
    "Any vector ⃗w ∈R3 is a linear\ncombination c1⃗v1 + c2⃗v2",
    "+ c3⃗v3 where ⃗v1 is a member of the x-axis, etc., in this\nway\n\n\n\nw1\nw2\nw3\n\n\n= 1 ·\n\n\n\nw1\n0\n0\n\n\n+ 1 ·\n\n\n\n0\nw2\n0\n\n\n+ 1 ·\n\n\n\n0\n0\nw3\n\n\n\nand so x-axis + y-axis +",
    "z-axis = R3.\n",
    "4.3 Example A sum of subspaces can be less than the entire space.",
    "Inside of P4,\nlet L be the subspace of linear polynomials {a + bx | a, b ∈R} and let C be the\nsubspace of purely-cubic polynomials {cx3 | c ∈R}.",
    "Then L + C is not all of P4.\n",
    "Instead, L + C = {a + bx + cx3 | a, b, c ∈R}.\n",
    "4.4 Example A space can be described as a combination of subspaces in more\nthan one way.",
    "Besides the decomposition R3 = x-axis + y-axis + z-axis, we can\n\nSection III.",
    "Basis and Dimension\n145\nalso write R3 = xy-plane + yz-plane.",
    "To check this, note that any ⃗w ∈R3 can\nbe written as a linear combination of a member of the xy-plane and a member\nof the yz-plane; here are two such combinations.\n",
    "\n\n\nw1\nw2\nw3\n\n\n= 1 ·\n\n\n\nw1\nw2\n0\n\n\n+ 1 ·\n\n\n\n0\n0\nw3\n\n\n\n\n\n\nw1\nw2\nw3\n\n\n= 1 ·\n\n\n\nw1\nw2/2\n0\n\n\n+ 1 ·\n\n\n\n0\nw2/2\nw3\n\n\n\n",
    "The above deﬁnition gives one way in which we can think of a space as a\ncombination of some of its parts.",
    "However, the prior example shows that there is\nat least one interesting property of our benchmark model that is not captured by\nthe deﬁnition of the sum of subspaces.",
    "In the familiar decomposition of R3, we\noften speak of a vector’s ‘x part’ or ‘y part’ or ‘z part’.",
    "That is, in our prototype\neach vector has a unique decomposition into pieces from the parts making up\nthe whole space.",
    "But in the decomposition used in Example 4.4, we cannot refer\nto the “xy part” of a vector — these three sums\n\n\n\n1\n2\n3\n\n\n=\n\n\n\n1\n2\n0\n\n",
    "\n+\n\n\n\n0\n0\n3\n\n\n=\n\n\n\n1\n0\n0\n\n\n+\n\n\n\n0\n2\n3\n\n\n=\n\n\n\n1\n1\n0\n\n\n+\n\n\n\n0\n1\n3\n\n\n\nall describe the vector as comprised of something from the ﬁrst plane plus\nsomething from the second plane, but the “xy part” is diﬀerent in each.\n",
    "That is, when we consider how R3 is put together from the three axes we\nmight mean “in such a way that every vector has at least one decomposition,”\nwhich gives the deﬁnition above.",
    "But if we take it to mean “in such a way\nthat every vector has one and only one decomposition” then we need another\ncondition on combinations.",
    "To see what this condition is, recall that vectors are\nuniquely represented in terms of a basis.",
    "We can use this to break a space into a\nsum of subspaces such that any vector in the space breaks uniquely into a sum\nof members of those subspaces.\n",
    "4.5 Example Consider R3 with its standard basis E3 = ⟨⃗e1,⃗e2,⃗e3⟩.",
    "The subspace\nwith the basis B1 = ⟨⃗e1⟩is the x-axis, the subspace with the basis B2 = ⟨⃗e2⟩is\nthe y-axis, and the subspace with the basis B3 = ⟨⃗e3⟩is the z-axis.",
    "The fact\nthat any member of R3 is expressible as a sum of vectors from these subspaces\n\n\n\nx\ny\nz\n\n\n=\n\n\n\nx\n0\n0\n\n\n+\n\n\n\n0\ny\n0\n\n\n+\n\n\n\n0\n0\nz\n\n\n\nreﬂects the fact that E3 spans the space — this equation\n\n\n\nx\ny\nz\n\n\n= c1\n\n\n\n1\n0\n0\n\n\n+ c2\n\n\n\n0\n1\n0\n\n",
    "\n+ c3\n\n\n\n0\n0\n1\n\n\n\n\n146\nChapter Two.",
    "Vector Spaces\nhas a solution for any x, y, z ∈R.",
    "And the fact that each such expression is\nunique reﬂects that fact that E3 is linearly independent, so any equation like\nthe one above has a unique solution.\n",
    "4.6 Example We don’t have to take the basis vectors one at a time, we can\nconglomerate them into larger sequences.",
    "Consider again the space R3 and the\nvectors from the standard basis E3.",
    "The subspace with the basis B1 = ⟨⃗e1,⃗e3⟩\nis the xz-plane.",
    "The subspace with the basis B2 = ⟨⃗e2⟩is the y-axis.",
    "As in the\nprior example, the fact that any member of the space is a sum of members of\nthe two subspaces in one and only one way\n\n\n\nx\ny\nz\n\n\n=\n\n\n\nx\n0\nz\n\n\n+\n\n\n\n0\ny\n0\n\n\n\nis a reﬂection of the fact that these vectors form a basis — this equation\n\n\n\nx\ny\nz\n\n\n= (c1\n\n\n\n1\n0\n0\n\n",
    "\n+ c3\n\n\n\n0\n0\n1\n\n\n)",
    "+ c2\n\n\n\n0\n1\n0\n\n",
    "\n\nhas one and only one solution for any x, y, z ∈R.\n4.7 Deﬁnition The concatenation of the sequences B1 = ⟨⃗β1,1, . .",
    ".",
    ", ⃗β1,n1⟩, . . .",
    ",\n",
    "Bk = ⟨⃗βk,1, . . .",
    ", ⃗βk,nk⟩adjoins them into a single sequence.\n",
    "B1\n⌢B2\n⌢· · ·\n⌢Bk = ⟨⃗β1,1, . . .",
    ", ⃗β1,n1, ⃗β2,1, . . .",
    ", ⃗βk,nk⟩\n4.8 Lemma Let V be a vector space that is the sum of some of its subspaces\nV = W1 + · · · + Wk.",
    "Let B1, . .",
    ".",
    ",",
    "Bk be bases for these subspaces.",
    "The following\nare equivalent.\n",
    "(1) The expression of any ⃗v ∈V as a combination ⃗v = ⃗w1 + · · · + ⃗wk with\n⃗wi ∈Wi is unique.\n",
    "(2) The concatenation B1\n⌢· · ·\n⌢Bk is a basis for V.\n(3) Among nonzero vectors from diﬀerent Wi’s every linear relationship is\ntrivial.\n",
    "Proof We will show that (1) =⇒(2), that (2) =⇒(3), and ﬁnally that\n(3) =⇒(1).",
    "For these arguments, observe that we can pass from a combination\nof ⃗w’s to a combination of ⃗β’s\nd1⃗w1 + · · · + dk⃗wk = d1(c1,1⃗β1,1 + · · · + c1,n1⃗β1,n1)\n+ · · ·",
    "+ dk(ck,1⃗βk,1 + · · · + ck,nk⃗βk,nk)\n= d1c1,1 · ⃗β1,1 + · · · + dkck,nk · ⃗βk,nk\n(∗)\n\nSection III.",
    "Basis and Dimension\n147\nand vice versa (we can move from the bottom to the top by taking each di to\nbe 1).\n",
    "For (1) =⇒(2), assume that all decompositions are unique.",
    "We will show\nthat B1\n⌢· · ·\n⌢Bk spans the space and is linearly independent.",
    "It spans the\nspace because the assumption that V = W1 + · · ·",
    "+",
    "Wk means that every ⃗v\ncan be expressed as ⃗v = ⃗w1 + · · · + ⃗wk, which translates by equation (∗) to an\nexpression of ⃗v as a linear combination of the ⃗β’s from the concatenation.",
    "For\nlinear independence, consider this linear relationship.\n",
    "⃗0 = c1,1⃗β1,1 + · · · + ck,nk⃗βk,nk\nRegroup as in (∗) (that is, move from bottom to top) to get the decomposition\n⃗0 = ⃗w1 + · · · + ⃗wk.",
    "Because the zero vector obviously has the decomposition\n⃗0 = ⃗0 + · · · +⃗0, the assumption that decompositions are unique shows that each\n⃗wi is the zero vector.",
    "This means that ci,1⃗βi,1 + · · · + ci,ni⃗βi,ni = ⃗0, and since\neach Bi is a basis we have the desired conclusion that all of the c’s are zero.\n",
    "For (2) =⇒(3) assume that the concatenation of the bases is a basis for the\nentire space.",
    "Consider a linear relationship among nonzero vectors from diﬀerent\nWi’s.",
    "This might or might not involve a vector from W1, or one from W2, etc.,\nso we write it ⃗0 = · · ·",
    "+ di⃗wi + · · · .",
    "As in equation (∗) expand the vector.\n",
    "⃗0 = · · · + di(ci,1⃗βi,1 + · · · + ci,ni⃗βi,ni) + · · ·\n= · · · + dici,1 · ⃗βi,1 + · · · + dici,ni · ⃗βi,ni + · · ·\nThe linear independence of B1\n⌢· · ·\n⌢Bk gives that each coeﬃcient dici,j is zero.\n",
    "Since ⃗wi is nonzero vector, at least one of the ci,j’s is not zero, and thus di is\nzero.",
    "This holds for each di, and therefore the linear relationship is trivial.\n",
    "Finally, for (3) =⇒(1), assume that among nonzero vectors from diﬀerent\nWi’s any linear relationship is trivial.",
    "Consider two decompositions of a vector\n⃗v = · · ·+ ⃗wi +· · · and ⃗v = · · ·+⃗uj +· · · where ⃗wi ∈Wi and ⃗uj ∈Wj.",
    "Subtract\none from the other to get a linear relationship, something like this (if there is no\n⃗ui or ⃗wj then leave those out).\n",
    "⃗0 = · · · + (⃗wi −⃗ui) + · · · + (⃗wj −⃗uj) + · · ·\nThe case assumption that statement (3) holds implies that the terms each equal\nthe zero vector ⃗wi −⃗ui = ⃗0.",
    "Hence decompositions are unique.\n",
    "QED\n4.9 Deﬁnition A collection of subspaces {W1, . .",
    ".",
    ", Wk} is independent if no\nnonzero vector from any Wi is a linear combination of vectors from the other\nsubspaces W1, . . .",
    ", Wi−1, Wi+1, . . .",
    ", Wk.\n\n148\nChapter Two.",
    "Vector Spaces\n4.10 Deﬁnition A vector space V is the direct sum (or internal direct sum)\nof its subspaces W1, . . .",
    ",",
    "Wk if V = W1 + W2 + · · ·",
    "+ Wk and the collection\n{W1, . . .",
    ", Wk} is independent.",
    "We write V = W1 ⊕W2 ⊕· · · ⊕Wk.\n",
    "4.11 Example Our prototype works: R3 = x-axis ⊕y-axis ⊕z-axis.\n",
    "4.12 Example The space of 2×2 matrices is this direct sum.\n",
    "{\n \na\n0\n0\nd\n!\n",
    "| a, d ∈R} ⊕{\n \n0\nb\n0\n0\n!\n| b ∈R} ⊕{\n \n0\n0\nc\n0\n!\n| c ∈R}\nIt is the direct sum of subspaces in many other ways as well; direct sum\ndecompositions are not unique.\n",
    "4.13 Corollary The dimension of a direct sum is the sum of the dimensions of its\nsummands.\n",
    "Proof In Lemma 4.8, the number of basis vectors in the concatenation equals\nthe sum of the number of vectors in the sub-bases.\n",
    "QED\nThe special case of two subspaces is worth its own mention.\n",
    "4.14 Deﬁnition When a vector space is the direct sum of two of its subspaces\nthen they are complements.\n",
    "4.15 Lemma A vector space V is the direct sum of two of its subspaces W1 and\nW2 if and only if it is the sum of the two V = W1 + W2 and their intersection\nis trivial W1 ∩W2",
    "= {⃗0 }.\n",
    "Proof Suppose ﬁrst that V = W1 ⊕W2.",
    "By deﬁnition, V is the sum of the\ntwo V = W1 + W2.",
    "To show that their intersection is trivial let ⃗v be a vector\nfrom W1 ∩W2 and consider the equation ⃗v = ⃗v.",
    "On that equation’s left side is\na member of W1 and on the right is a member of W2, which we can think of as\na linear combination of members of W2.",
    "But the two spaces are independent so\nthe only way that a member of W1 can be a linear combination of vectors from\nW2 is if that member is the zero vector ⃗v = ⃗0.\n",
    "For the other direction, suppose that V is the sum of two spaces with a\ntrivial intersection.",
    "To show that V is a direct sum of the two we need only\nshow that the spaces are independent — that no nonzero member of the ﬁrst is\nexpressible as a linear combination of members of the second, and vice versa.\n",
    "This holds because any relationship ⃗w1 = c1⃗w2,1 + · · · + ck⃗w2,k (with ⃗w1 ∈W1\nand ⃗w2,j ∈W2 for all j) shows that the vector on the left is also in W2, since\nthe right side is a combination of members of W2.",
    "The intersection of these two\nspaces is trivial, so ⃗w1 = ⃗0.",
    "The same argument works for any ⃗w2.\n",
    "QED\n\nSection III.",
    "Basis and Dimension\n149\n4.16 Example In R2 the x-axis and the y-axis are complements, that is, R2 =\nx-axis ⊕y-axis.",
    "This points out that subspace complement is slightly diﬀerent\nthan set complement; the x and y axes are not set complements because their\nintersection is not the empty set.\n",
    "A space can have more than one pair of complementary subspaces; another\npair for R2 are the subspaces consisting of the lines y = x and y = 2x.\n",
    "4.17 Example In the space F = {a cos θ + b sin θ | a, b ∈R}, the subspaces W1 =\n{a cos θ | a ∈R} and W2 = {b sin θ | b ∈R} are complements.",
    "The prior exam-\nple noted that a space can be decomposed into more than one pair of comple-\nments.",
    "In addition note that F can has more than one pair of complementary\nsubspaces where the ﬁrst in the pair is W1 — another complement of W1 is\nW3 = {b sin θ",
    "+ b cos θ | b ∈R}.\n",
    "4.18 Example In R3, the xy-plane and the yz-planes are not complements, which\nis the point of the discussion following Example 4.4.",
    "One complement of the\nxy-plane is the z-axis.\n",
    "Here is a natural question that arises from Lemma 4.15: for k > 2 is the\nsimple sum V = W1 + · · ·",
    "+",
    "Wk also a direct sum if and only if the intersection\nof the subspaces is trivial?\n4.19 Example If there are more than two subspaces then having a trivial inter-\nsection is not enough to guarantee unique decomposition (i.e., is not enough to\nensure that the spaces are independent).",
    "In R3, let W1 be the x-axis, let W2 be\nthe y-axis, and let W3 be this.\n",
    "W3 = {\n\n\n\nq\nq\nr\n\n\n| q, r ∈R}\nThe check that R3 = W1 + W2 + W3 is easy.",
    "The intersection W1 ∩W2",
    "∩W3 is\ntrivial, but decompositions aren’t unique.\n",
    "\n\n\nx\ny\nz\n\n\n=\n\n\n\n0\n0\n0\n\n\n+\n\n\n\n0\ny −x\n0\n\n\n+\n\n\n\nx\nx\nz\n\n\n=\n\n\n\nx −y\n0\n0\n\n\n+\n\n\n\n0\n0\n0\n\n\n+\n\n\n\ny\ny\nz\n\n\n\n(This example also shows that this requirement is also not enough: that all\npairwise intersections of the subspaces be trivial.",
    "See Exercise 30.)\n",
    "In this subsection we have seen two ways to regard a space as built up from\ncomponent parts.",
    "Both are useful; in particular we will use the direct sum\ndeﬁnition at the end of the Chapter Five.\n\n150\nChapter Two.",
    "Vector Spaces\nExercises\n✓4.20 Decide if R2 is the direct sum of each W1 and W2.\n",
    "(a) W1 = {\n\u0012x\n0\n\u0013\n| x ∈R}, W2 = {\n\u0012x\nx\n\u0013\n| x ∈R}\n(b) W1 = {\n\u0012s\ns\n\u0013\n",
    "| s ∈R}, W2 = {\n\u0012 s\n1.1s\n\u0013\n| s ∈R}\n(c) W1 = R2, W2 = {⃗0}\n(d) W1 = W2 = {\n\u0012t\nt\n\u0013\n| t ∈R}\n(e) W1 = {\n\u00121\n0\n\u0013\n+\n\u0012x\n0\n\u0013\n| x ∈R}, W2 = {\n\u0012−1\n0\n\u0013\n+\n\u00120\ny\n\u0013\n| y ∈R}\n✓4.21 Show that R3 is the direct sum of the xy-plane with each of these.\n",
    "(a) the z-axis\n(b) the line\n{\n\n\nz\nz\nz\n\n| z ∈R}\n4.22 Is P2 the direct sum of {a + bx2 | a, b ∈R} and {cx | c ∈R}?\n✓4.23 In Pn, the even polynomials are the members of this set\nE = {p ∈Pn | p(−x) = p(x) for all x}\nand the odd polynomials are the members of this set.\n",
    "O = {p ∈Pn | p(−x) = −p(x) for all x}\nShow that these are complementary subspaces.\n",
    "4.24 Which of these subspaces of R3\nW1: the x-axis,\nW2: the y-axis,\nW3: the z-axis,\nW4: the plane x + y + z = 0,\nW5: the yz-plane\ncan be combined to\n(a) sum to R3?\n(b) direct sum to R3?\n✓4.25 Show that Pn = {a0 | a0 ∈R} ⊕. . .",
    "⊕{anxn | an ∈R}.\n",
    "4.26 What is W1 + W2 if W1 ⊆W2?\n4.27 Does Example 4.5 generalize?",
    "That is, is this true or false: if a vector space V\nhas a basis ⟨⃗β1, . . .",
    ", ⃗βn⟩then it is the direct sum of the spans of the one-dimensional\nsubspaces V =",
    "[{⃗β1 }] ⊕. . .",
    "⊕[{⃗βn }]?\n4.28 Can R4 be decomposed as a direct sum in two diﬀerent ways?",
    "Can R1?\n4.29",
    "This exercise makes the notation of writing ‘+’ between sets more natural.\n",
    "Prove that, where W1, . .",
    ".",
    ", Wk are subspaces of a vector space,\nW1 + · · ·",
    "+",
    "Wk = { ⃗w1 + ⃗w2 + · · · + ⃗wk | ⃗w1 ∈W1, . . .",
    ", ⃗wk ∈Wk },\nand so the sum of subspaces is the subspace of all sums.\n",
    "4.30 (Refer to Example 4.19.",
    "This exercise shows that the requirement that pairwise\nintersections be trivial is genuinely stronger than the requirement only that the\nintersection of all of the subspaces be trivial.)",
    "Give a vector space and three\nsubspaces W1, W2, and W3 such that the space is the sum of the subspaces,\nthe intersection of all three subspaces W1 ∩W2",
    "∩W3 is trivial, but the pairwise\nintersections W1 ∩W2, W1 ∩W3, and W2 ∩W3 are nontrivial.\n\nSection III.",
    "Basis and Dimension\n151\n4.31 Prove that if V = W1 ⊕. . .",
    "⊕Wk",
    "then Wi ∩Wj is trivial whenever i ̸= j.",
    "This\nshows that the ﬁrst half of the proof of Lemma 4.15 extends to the case of more\nthan two subspaces.",
    "(Example 4.19 shows that this implication does not reverse;\nthe other half does not extend.)\n",
    "4.32 Recall that no linearly independent set contains the zero vector.\n",
    "Can an\nindependent set of subspaces contain the trivial subspace?\n✓4.33 Does every subspace have a complement?\n✓4.34 Let W1, W2 be subspaces of a vector space.\n",
    "(a) Assume that the set S1 spans W1, and that the set S2 spans W2.",
    "Can S1 ∪S2\nspan W1 + W2?",
    "Must it?\n(b) Assume that S1 is a linearly independent subset of W1 and that S2 is a linearly\nindependent subset of W2.",
    "Can S1 ∪S2 be a linearly independent subset of\nW1 + W2?",
    "Must it?\n4.35 When we decompose a vector space as a direct sum, the dimensions of the\nsubspaces add to the dimension of the space.",
    "The situation with a space that is\ngiven as the sum of its subspaces is not as simple.",
    "This exercise considers the\ntwo-subspace special case.\n",
    "(a) For these subspaces of M2×2 ﬁnd W1 ∩W2, dim(W1 ∩W2), W1 + W2, and\ndim(W1 + W2).\n",
    "W1 = {\n\u00120\n0\nc\nd\n\u0013\n| c, d ∈R}\nW2 = {\n\u00120\nb\nc\n0\n\u0013\n| b, c ∈R}\n(b) Suppose that U and W are subspaces of a vector space.",
    "Suppose that the\nsequence ⟨⃗β1, . . .",
    ", ⃗βk⟩is a basis for U ∩W.\nFinally, suppose that the prior\nsequence has been expanded to give a sequence ⟨⃗µ1, . . .",
    ",⃗µj, ⃗β1, . .",
    ".",
    ", ⃗βk⟩that is a\nbasis for U, and a sequence ⟨⃗β1, . . .",
    ", ⃗βk, ⃗ω1, . . .",
    ", ⃗ωp⟩that is a basis for W. Prove\nthat this sequence\n⟨⃗µ1, . . .",
    ",⃗µj, ⃗β1, . . . , ⃗βk, ⃗ω1, . . .",
    ", ⃗ωp⟩\nis a basis for the sum U + W.\n(c) Conclude that dim(U + W) = dim(U) + dim(W) −dim(U ∩W).\n",
    "(d) Let W1 and W2 be eight-dimensional subspaces of a ten-dimensional space.\n",
    "List all values possible for dim(W1 ∩W2).\n",
    "4.36 Let V = W1 ⊕· · · ⊕Wk and for each index i suppose that Si is a linearly\nindependent subset of Wi.",
    "Prove that the union of the Si’s is linearly independent.\n",
    "4.37",
    "A matrix is symmetric if for each pair of indices i and j, the i, j entry equals\nthe j, i entry.",
    "A matrix is antisymmetric if each i, j entry is the negative of the j, i\nentry.\n",
    "(a) Give a symmetric 2×2 matrix and an antisymmetric 2×2 matrix.",
    "(Remark.\n",
    "For the second one, be careful about the entries on the diagonal.)\n",
    "(b) What is the relationship between a square symmetric matrix and its transpose?\nBetween a square antisymmetric matrix and its transpose?\n(c) Show that Mn×n is the direct sum of the space of symmetric matrices and the\nspace of antisymmetric matrices.\n",
    "4.38 Let W1, W2, W3 be subspaces of a vector space.",
    "Prove that (W1 ∩W2)",
    "+ (W1 ∩\nW3) ⊆W1",
    "∩(W2 + W3).",
    "Does the inclusion reverse?\n\n152\nChapter Two.",
    "Vector Spaces\n4.39 The example of the x-axis and the y-axis in R2 shows that W1 ⊕W2 = V does\nnot imply that W1 ∪W2 = V. Can W1 ⊕W2 = V and W1 ∪W2 = V happen?\n4.40 Consider Corollary 4.13.",
    "Does it work both ways — that is, supposing that V =\nW1+· · ·+Wk, is V = W1⊕· ·",
    "·⊕Wk if and only if dim(V) = dim(W1)+· · ·+dim(Wk)?\n",
    "4.41 We know that if V = W1 ⊕W2 then there is a basis for V that splits into a\nbasis for W1 and a basis for W2.",
    "Can we make the stronger statement that every\nbasis for V splits into a basis for W1 and a basis for W2?\n4.42 We can ask about the algebra of the ‘+’ operation.\n",
    "(a) Is it commutative; is W1 + W2 = W2 + W1?\n(b) Is it associative; is (W1 + W2) +",
    "W3 = W1 + (W2 + W3)?\n(c) Let W be a subspace of some vector space.",
    "Show that W + W = W.\n(d) Must there be an identity element, a subspace I such that I + W = W +",
    "I = W\nfor all subspaces W?\n(e) Does left-cancellation hold:",
    "if W1 + W2 = W1 +",
    "W3 then W2 = W3?",
    "Right\ncancellation?\n\nTopic\nFields\nComputations involving only integers or only rational numbers are much easier\nthan those with real numbers.",
    "Could other algebraic structures, such as the\nintegers or the rationals, work in the place of R in the deﬁnition of a vector\nspace?\n",
    "If we take “work” to mean that the results of this chapter remain true then\nthere is a natural list of conditions that a structure (that is, number system)\nmust have in order to work in the place of R. A ﬁeld is a set F with operations\n‘+’ and ‘·’ such that\n(1) for any a, b ∈F the result of a + b is in F, and a + b = b + a, and if c ∈F\nthen a + (b + c) = (a + b)",
    "+ c\n(2) for any a, b ∈F the result of a · b is in F, and a · b = b · a, and if c ∈F then\na · (b · c) = (a · b) ·",
    "c\n(3) if a, b, c ∈F then a · (b + c) = a · b + a · c\n(4) there is an element 0 ∈F such that if a ∈F then a + 0 = a, and for each\na ∈F there is an element −a ∈F such that (−a) + a = 0\n(5) there is an element 1 ∈F such that if a ∈F then a · 1 = a, and for each\nelement a ̸= 0 of F there is an element a−1 ∈F such that a−1 · a = 1.\nFor example, the algebraic structure consisting of the set of real numbers\nalong with its usual addition and multiplication operation is a ﬁeld.",
    "Another\nﬁeld is the set of rational numbers with its usual addition and multiplication\noperations.",
    "An example of an algebraic structure that is not a ﬁeld is the integers,\nbecause it fails the ﬁnal condition.\n",
    "Some examples are more surprising.",
    "The set B = {0, 1} under these opera-\ntions:\n+\n0\n1\n0\n0\n1\n1\n1\n0\n·\n0\n1\n0\n0\n0\n1\n0\n1\nis a ﬁeld; see Exercise 4.\n\n154\nChapter Two.",
    "Vector Spaces\nWe could in this book develop Linear Algebra as the theory of vector spaces\nwith scalars from an arbitrary ﬁeld.",
    "In that case, almost all of the statements here\nwould carry over by replacing ‘R’ with ‘F’, that is, by taking coeﬃcients, vector\nentries, and matrix entries to be elements of F (the exceptions are statements\ninvolving distances or angles, which would need additional development).",
    "Here\nare some examples; each applies to a vector space V over a ﬁeld F.\n∗For any ⃗v ∈V and a ∈F, (i) 0",
    "·⃗v = ⃗0, (ii) −1 ·⃗v +⃗v = ⃗0, and (iii) a ·⃗0 = ⃗0.\n",
    "∗The span, the set of linear combinations, of a subset of V is a subspace of\nV.\n∗Any subset of a linearly independent set is also linearly independent.\n",
    "∗In a ﬁnite-dimensional vector space, any two bases have the same number\nof elements.\n",
    "(Even statements that don’t explicitly mention F use ﬁeld properties in their\nproof.)\n",
    "We will not develop vector spaces in this more general setting because the\nadditional abstraction can be a distraction.",
    "The ideas we want to bring out\nalready appear when we stick to the reals.\n",
    "The exception is Chapter Five.",
    "There we must factor polynomials, so we\nwill switch to considering vector spaces over the ﬁeld of complex numbers.\n",
    "Exercises\n1 Check that the real numbers form a ﬁeld.\n",
    "2 Prove that these are ﬁelds.\n",
    "(a) The rational numbers Q\n(b)",
    "The complex numbers C\n3 Give an example that shows that the integer number system is not a ﬁeld.\n",
    "4 Check that the set B = {0, 1} is a ﬁeld under the operations listed above,\n5 Give suitable operations to make the set {0, 1, 2} a ﬁeld.\n\n",
    "Topic\nCrystals\nEveryone has noticed that table salt comes in little cubes.\n",
    "This orderly outside arises from an orderly inside — the way the atoms lie is\nalso cubical, these cubes stack in neat rows and columns, and the salt faces tend\nto be just an outer layer of cubes.",
    "One cube of atoms is shown below.",
    "Salt is\nsodium chloride and the small spheres shown are sodium while the big ones are\nchloride.",
    "To simplify the view, it only shows the sodiums and chlorides on the\nfront, top, and right.\n",
    "The specks of salt that we see above have many repetitions of this fundamental\nunit.",
    "A solid, such as table salt, with a regular internal structure is a crystal.\n",
    "We can restrict our attention to the front face.",
    "There we have a square\nrepeated many times giving a lattice of atoms.\n\n",
    "156\nChapter Two.",
    "Vector Spaces\nThe distance along the sides of each square cell is about 3.34 Ångstroms (an\nÅngstrom is 10−10 meters).",
    "When we want to refer to atoms in the lattice that\nnumber is unwieldy, and so we take the square’s side length as a unit.",
    "That is,\nwe naturally adopt this basis.\n",
    "⟨\n \n3.34\n0\n!\n,\n \n0\n3.34\n!\n",
    "⟩\nNow we can describe, say, the atom in the upper right of the lattice picture\nabove as 3⃗β1",
    "+ 2⃗β2, instead of 10.02 Ångstroms over and 6.68 up.\n",
    "Another crystal from everyday experience is pencil lead.",
    "It is graphite,\nformed from carbon atoms arranged in this shape.\n",
    "This is a single plane of graphite, called graphene.",
    "A piece of graphite consists of\nmany of these planes, layered.",
    "The chemical bonds between the planes are much\nweaker than the bonds inside the planes, which explains why pencils write — the\ngraphite can be sheared so that the planes slide oﬀand are left on the paper.\n",
    "We can get a convenient unit of length by decomposing the hexagonal ring\ninto three regions that are rotations of this unit cell.\n",
    "The vectors that form the sides of that unit cell make a convenient basis.",
    "The\ndistance along the bottom and slant is 1.42 Ångstroms, so this\n⟨\n \n1.42\n0\n!\n,\n \n0.71\n1.23\n!\n⟩\n\nTopic: Crystals\n157\nis a good basis.\n",
    "Another familiar crystal formed from carbon is diamond.",
    "Like table salt it\nis built from cubes but the structure inside each cube is more complicated.",
    "In\naddition to carbons at each corner,\nthere are carbons in the middle of each face.\n",
    "(To show the new face carbons clearly, the corner carbons are reduced to dots.)\n",
    "There are also four more carbons inside the cube, two that are a quarter of the\nway up from the bottom and two that are a quarter of the way down from the\ntop.\n",
    "(As before, carbons shown earlier are reduced here to dots.)",
    "The distance along\nany edge of the cube is 2.18 Ångstroms.",
    "Thus, a natural basis for describing the\nlocations of the carbons and the bonds between them, is this.\n⟨\n\n\n\n2.18\n0\n0\n\n\n,\n\n\n\n0\n2.18\n0\n\n\n,\n\n\n\n0\n0\n2.18\n\n\n⟩\nThe examples here show that the structures of crystals is complicated enough\nto need some organized system to give the locations of the atoms and how they\nare chemically bound.",
    "One tool for that organization is a convenient basis.",
    "This\napplication of bases is simple but it shows a science context where the idea arises\nnaturally.\n",
    "Exercises\n1 How many fundamental regions are there in one face of a speck of salt?",
    "(With a\nruler, we can estimate that face is a square that is 0.1 cm on a side.)\n\n",
    "158\nChapter Two.",
    "Vector Spaces\n2",
    "In the graphite picture, imagine that we are interested in a point 5.67 Ångstroms\nover and 3.14 Ångstroms up from the origin.\n",
    "(a) Express that point in terms of the basis given for graphite.\n",
    "(b) How many hexagonal shapes away is this point from the origin?\n(c) Express that point in terms of a second basis, where the ﬁrst basis vector is\nthe same, but the second is perpendicular to the ﬁrst (going up the plane) and\nof the same length.\n",
    "3 Give the locations of the atoms in the diamond cube both in terms of the basis,\nand in Ångstroms.\n",
    "4",
    "This illustrates how we could compute the dimensions of a unit cell from the\nshape in which a substance crystallizes ([Ebbing], p. 462).\n",
    "(a) Recall that there are 6.022 × 1023 atoms in a mole (this is Avogadro’s number).\n",
    "From that, and the fact that platinum has a mass of 195.08 grams per mole,\ncalculate the mass of each atom.\n",
    "(b) Platinum crystallizes in a face-centered cubic lattice with atoms at each lattice\npoint, that is, it looks like the middle picture given above for the diamond crystal.\n",
    "Find the number of platinum’s per unit cell (hint: sum the fractions of platinum’s\nthat are inside of a single cell).\n",
    "(c) From that, ﬁnd the mass of a unit cell.\n",
    "(d) Platinum crystal has a density of 21.45 grams per cubic centimeter.",
    "From\nthis, and the mass of a unit cell, calculate the volume of a unit cell.\n",
    "(e) Find the length of each edge.\n",
    "(f) Describe a natural three-dimensional basis.\n\n",
    "Topic\nVoting Paradoxes\nImagine that a Political Science class studying the American presidential process\nholds a mock election.\n",
    "The 29 class members rank the Democratic Party,\nRepublican Party, and Third Party nominees, from most preferred to least\npreferred (> means ‘is preferred to’).\n",
    "preference order\nnumber with\nthat preference\nDemocrat",
    "> Republican >",
    "Third\nDemocrat > Third > Republican\nRepublican > Democrat >",
    "Third\nRepublican >",
    "Third > Democrat\nThird > Democrat > Republican\nThird > Republican > Democrat\n5\n4\n2\n8\n8\n2\n",
    "What is the preference of the group as a whole?\n",
    "Overall, the group prefers the Democrat to the Republican by ﬁve votes;\nseventeen voters ranked the Democrat above the Republican versus twelve the\nother way.",
    "And the group prefers the Republican to the Third’s nominee, ﬁfteen\nto fourteen.",
    "But, strangely enough, the group also prefers the Third to the\nDemocrat, eighteen to eleven.\nDemocrat\nThird\nRepublican\n7 voters\n1 voter\n5 voters\n",
    "This is a voting paradox, speciﬁcally, a majority cycle.\n",
    "Mathematicians study voting paradoxes in part because of their implications\nfor practical politics.",
    "For instance, the instructor can manipulate this class into\n\n160\nChapter Two.",
    "Vector Spaces\nchoosing the Democrat as the overall winner by ﬁrst asking for a vote between\nthe Republican and the Third, and then asking for a vote between the winner\nof that contest, who will be the Republican, and the Democrat.",
    "By similar\nmanipulations the instructor can make any of the other two candidates come out\nas the winner.",
    "(We will stick to three-candidate elections but the same thing\nhappens in larger elections.)\n",
    "Mathematicians also study voting paradoxes simply because they are inter-\nesting.",
    "One interesting aspect is that the group’s overall majority cycle occurs\ndespite that each single voter’s preference list is rational, in a straight-line order.\n",
    "That is, the majority cycle seems to arise in the aggregate without being present\nin the components of that aggregate, the preference lists.",
    "However we can use\nlinear algebra to argue that a tendency toward cyclic preference is actually\npresent in each voter’s list and that it surfaces when there is more adding of the\ntendency than canceling.\n",
    "For this, abbreviating the choices as D, R, and T, we can describe how a\nvoter with preference order D > R > T contributes to the above cycle.\n",
    "D\nT\nR\n−1 voter\n1 voter\n1 voter\n(The negative sign is here because the arrow describes T as preferred to D, but\nthis voter likes them the other way.)",
    "The descriptions for the other preference\nlists are in the table on page 162.\n",
    "Now, to conduct the election we linearly combine these descriptions; for\ninstance, the Political Science mock election\n5 ·\nD\nT\nR\n−1\n1\n1\n+ 4 ·\nD\nT\nR\n−1\n−1\n1\n+ · · · + 2 ·\nD\nT\nR\n1\n−1\n−1\nyields the circular group preference shown earlier.\n",
    "Of course, taking linear combinations is linear algebra.",
    "The graphical cycle\nnotation is suggestive but inconvenient so we use column vectors by starting at\nthe D and taking the numbers from the cycle in counterclockwise order.",
    "Thus,\nwe represent the mock election and a single D > R > T vote in this way.\n",
    "\n\n\n7\n1\n5\n\n\n\nand\n\n\n\n−1\n1\n1\n\n\n\n",
    "We will decompose vote vectors into two parts, one cyclic and the other\nacyclic.",
    "For the ﬁrst part, we say that a vector is purely cyclic if it is in this\n\nTopic: Voting Paradoxes\n161\nsubspace of R3.\n",
    "C = {\n\n\n\nk\nk\nk\n\n\n|",
    "k ∈R} = {k ·\n\n\n\n1\n1\n1\n\n\n|",
    "k ∈R}\nFor the second part, consider the set of vectors that are perpendicular to all of\nthe vectors in C. Exercise 6 shows that this is a subspace\nC⊥= {\n\n\n\nc1\nc2\nc3\n\n\n|\n\n\n\nc1\nc2\nc3\n\n",
    "\n•\n\n\n\nk\nk\nk\n\n\n= 0 for all k ∈R}\n= {\n\n\n\nc1\nc2\nc3\n\n\n| c1 + c2 + c3 = 0} = {c2\n\n\n\n−1\n1\n0\n\n\n+ c3\n\n\n\n−1\n0\n1\n\n\n|",
    "c2, c3 ∈R}\n(read that aloud as “C perp”).",
    "So we are led to this basis for R3.\n⟨\n\n\n\n1\n1\n1\n\n\n,\n\n\n\n−1\n1\n0\n\n\n,\n\n\n\n−1\n0\n1\n\n\n⟩\nWe can represent votes with respect to this basis, and thereby decompose them\ninto a cyclic part and an acyclic part.",
    "(Note for readers who have covered the\noptional section in this chapter: that is, the space is the direct sum of C\nand C⊥.)\n",
    "For example, consider the D > R > T voter discussed above.",
    "We represent\nthat voter with respect to the basis\nc1 −c2 −c3 = −1\nc1 + c2\n=\n1\nc1\n+ c3 =\n1\n−ρ1+ρ2\n−→\n−ρ1+ρ3\n(−1/2)ρ2+ρ3\n−→\nc1 −c2 −\nc3 = −1\n2c2 +\nc3 =\n2\n(3/2)c3 =\n1\nusing the coordinates c1 = 1/3, c2 = 2/3, and c3 = 2/3.",
    "Then\n\n\n\n−1\n1\n1\n\n\n= 1\n3 ·\n\n\n\n1\n1\n1\n\n\n+ 2\n3 ·\n\n\n\n−1\n1\n0\n\n\n+ 2\n3 ·\n\n\n\n−1\n0\n1\n\n\n=\n\n\n\n1/3\n1/3\n1/3\n\n",
    "\n+\n\n\n\n−4/3\n2/3\n2/3\n\n\n\ngives the desired decomposition into a cyclic part and an acyclic part.\n",
    "D\nT\nR\n−1\n1\n1\n=\nD\nT\nR\n1/3\n1/3\n1/3\n+\nD\nT\nR\n−4/3\n2/3\n2/3\n\n162\nChapter Two.",
    "Vector Spaces\n",
    "Thus we can see that this D >",
    "R >",
    "T voter’s rational preference list does have a\ncyclic part.\n",
    "The T > R > D voter is opposite to the one just considered in that the ‘>’\nsymbols are reversed.",
    "This voter’s decomposition\nD\nT\nR\n1\n−1\n−1\n=\nD\nT\nR\n−1/3\n−1/3\n−1/3\n+\nD\nT\nR\n4/3\n−2/3\n−2/3\nshows that these opposite preferences have decompositions that are opposite.\n",
    "We say that the ﬁrst voter has positive spin since the cycle part is with the\ndirection that we have chosen for the arrows, while the second voter’s spin is\nnegative.\n",
    "The fact that these opposite voters cancel each other is reﬂected in the fact\nthat their vote vectors add to zero.",
    "This suggests an alternate way to tally an\nelection.",
    "We could ﬁrst cancel as many opposite preference lists as possible and\nthen determine the outcome by adding the remaining lists.\n",
    "The table below contains the three pairs of opposite preference lists.",
    "For\ninstance, the top line contains the voters discussed above.\n",
    "positive spin\nnegative spin\nDemocrat > Republican >",
    "Third\nD\nT\nR\n−1\n1\n1\n=\nD\nT\nR\n1/3\n1/3\n1/3\n+\nD\nT\nR\n−4/3\n2/3\n2/3\nThird > Republican > Democrat\nD\nT\nR\n1\n−1\n−1\n=\nD\nT\nR\n−1/3\n−1/3\n−1/3\n+\nD\nT\nR\n4/3\n−2/3\n−2/3\nRepublican >",
    "Third > Democrat\nD\nT\nR\n1\n1\n−1\n=\nD\nT\nR\n1/3\n1/3\n1/3\n+\nD\nT\nR\n2/3\n2/3\n−4/3\nDemocrat >",
    "Third > Republican\nD\nT\nR\n−1\n−1\n1\n=\nD\nT\nR\n−1/3\n−1/3\n−1/3\n+\nD\nT\nR\n−2/3\n−2/3\n4/3\nThird > Democrat > Republican\nD\nT\nR\n1\n−1\n1\n=\nD\nT\nR\n1/3\n1/3\n1/3\n+\nD\nT\nR\n2/3\n−4/3\n2/3\nRepublican > Democrat >",
    "Third\nD\nT\nR\n−1\n1\n−1\n=\nD\nT\nR\n−1/3\n−1/3\n−1/3\n+\nD\nT\nR\n−2/3\n4/3\n−2/3\nIf we conduct the election as just described then after the cancellation of as many\nopposite pairs of voters as possible there will remain three sets of preference\nlists: one set from the ﬁrst row, one from the second row, and one from the third\nrow.",
    "We will ﬁnish by proving that a voting paradox can happen only if the\nspins of these three sets are in the same direction.",
    "That is, for a voting paradox\nto occur the three remaining sets must all come from the left of the table or all\ncome from the right (see Exercise 3).",
    "This shows that there is some connection\n\nTopic: Voting Paradoxes\n163\nbetween the majority cycle and the decomposition that we are using — a voting\nparadox can happen only when the tendencies toward cyclic preference reinforce\neach other.\n",
    "For the proof, assume that we have canceled opposite preference orders and\nare left with one set of preference lists for each of the three rows.",
    "Consider the\nﬁrst row’s remaining preference lists.",
    "They could be from the ﬁrst row’s left or\nright (or between, since the lists could have canceled exactly).",
    "We shall write\nD\nT\nR\n−a\na\na\nwhere a is an integer that is positive if the remaining lists are on the left, where\na is negative if the lists are on the right, and zero if the cancellation was perfect.\n",
    "Similarly we have integers b and c for the second and third rows, which can\neach be positive, negative, or zero.\n",
    "Then the election is determined by this sum.\n",
    "D\nT\nR\n−a\na\na\n+\nD\nT\nR\nb\nb\n−b\n+\nD\nT\nR\nc\n−c\nc\n=\nD\nT\nR\n−a + b + c\na + b −c\na −b + c\nA voting paradox occurs when the three numbers in the total cycle on the right,\n−a+b+c and a−b+c and a+b−c, are all nonnegative or all nonpositive.",
    "We\nwill prove this occurs only when either all three of a, b, and c are nonnegative\nor all three are nonpositive.\n",
    "Let the total cycle numbers be nonnegative; the other case is similar.\n",
    "−a + b + c ⩾0\na −b + c",
    "⩾0\na + b −c ⩾0\nAdd the ﬁrst two rows to see that c ⩾0.",
    "Add the ﬁrst and third rows for b ⩾0.\n",
    "And, the second and third rows together give a ⩾0.",
    "Thus if the total cycle is\nnonnegative then in each row the remaining preference lists are from the table’s\nleft.",
    "That ends the proof.\n",
    "This result says only that having all three spin in the same direction is a\nnecessary condition for a majority cycle.",
    "It is not suﬃcient; see Exercise 4.\n",
    "Voting theory and associated topics are the subject of current research.",
    "There\nare many intriguing results, notably those produced by K Arrow [Arrow] who\nwon the Nobel Prize in part for this work, showing that no voting system is\nentirely fair (for a reasonable deﬁnition of “fair”).",
    "Some good introductory arti-\ncles are [Gardner, 1970], [Gardner, 1974], [Gardner, 1980], and [Neimi & Riker].\n",
    "[Taylor] is a readable text.",
    "The long list of cases from recent American political\n\n164\nChapter Two.",
    "Vector Spaces\nhistory in [Poundstone] shows these paradoxes are routinely manipulated in\npractice.",
    "(On the other hand, quite recent research shows that computing how\nto manipulate elections can in general be unfeasible, but this is beyond our\nscope.)",
    "This Topic is drawn from [Zwicker].",
    "(Author’s Note: I would like to\nthank Professor Zwicker for his kind and illuminating discussions.)\n",
    "Exercises\n1 Here is a reasonable way in which a voter could have a cyclic preference.",
    "Suppose\nthat this voter ranks each candidate on each of three criteria.\n",
    "(a) Draw up a table with the rows labeled ‘Democrat’, ‘Republican’, and ‘Third’,\nand the columns labeled ‘character’, ‘experience’, and ‘policies’.",
    "Inside each\ncolumn, rank some candidate as most preferred, rank another as in the middle,\nand rank the remaining one as least preferred.\n",
    "(b) In this ranking, is the Democrat preferred to the Republican in (at least) two\nout of three criteria, or vice versa?",
    "Is the Republican preferred to the Third?\n(c) Does the table that was just constructed have a cyclic preference order?",
    "If\nnot, make one that does.\n",
    "So it is possible for a voter to have a cyclic preference among candidates.",
    "The\nparadox described above, however, is that even if each voter has a straight-line\npreference list, a cyclic preference can still arise for the entire group.\n",
    "2 Compute the values in the table of decompositions.\n",
    "3 Perform the cancellations of opposite preference orders for the Political Science\nclass’s mock election.",
    "Are all the remaining preferences from the left three rows of\nthe table or from the right?\n4",
    "The necessary condition that a voting paradox can happen only if all three\npreference lists remaining after cancellation have the same spin is not also suﬃ-\ncient.\n",
    "(a) Give an example of a vote where there is a majority cycle and addition of one\nmore voter with the same spin causes the cycle to go away.\n",
    "(b) Can the opposite happen; can addition of one voter with a “wrong” spin cause\na cycle to appear?\n",
    "(c) Give a condition that is both necessary and suﬃcient to get a majority cycle.\n",
    "5 A one-voter election cannot have a majority cycle because of the requirement that\nwe’ve imposed that the voter’s list must be rational.\n",
    "(a) Show that a two-voter election may have a majority cycle.",
    "(We consider the\ngroup preference a majority cycle if all three group totals are nonnegative or if\nall three are nonpositive—that is, we allow some zero’s in the group preference.)\n",
    "(b) Show that for any number of voters greater than one, there is an election\ninvolving that many voters that results in a majority cycle.\n",
    "6 Let U be a subspace of R3.",
    "Prove that the set U⊥= {⃗v | ⃗v • ⃗u = 0 for all ⃗u ∈U}\nof vectors that are perpendicular to each vector in U is also subspace of R3.",
    "Does\nthis hold if U is not a subspace?\n\n",
    "Topic\nDimensional Analysis\n“You can’t add apples and oranges,” the old saying goes.",
    "It reﬂects our experience\nthat in applications the quantities have units and keeping track of those units\ncan help.",
    "Everyone has done calculations such as this one that use the units as\na check.\n",
    "60 sec\nmin · 60 min\nhr · 24 hr\nday · 365 day\nyear = 31 536 000 sec\nyear\nWe can take the idea of including the units beyond bookkeeping.",
    "We can use\nunits to draw conclusions about what relationships are possible among the\nphysical quantities.\n",
    "To start, consider the falling body equation distance = 16 · (time)2.",
    "If the\ndistance is in feet and the time is in seconds then this is a true statement.\n",
    "However it is not correct in other unit systems, such as meters and seconds,\nbecause 16 isn’t the right constant in those systems.",
    "We can ﬁx that by attaching\nunits to the 16, making it a dimensional constant.\n",
    "dist = 16\nft\nsec2 · (time)2\nNow the equation holds also in the meter-second system because when we align\nthe units (a foot is approximately 0.30 meters),\ndistance in meters = 16 0.30 m\nsec2\n· (time in sec)2 = 4.8 m\nsec2 · (time in sec)2\nthe constant gets adjusted.",
    "So in order to have equations that are correct across\nunit systems, we restrict our attention to those that use dimensional constants.\n",
    "Such an equation is complete.\n",
    "Moving away from a particular unit system allows us to just measure quan-\ntities in combinations of some units of length L, mass M, and time T. These\nthree are our physical dimensions.",
    "For instance, we could measure velocity in\nfeet/second or fathoms/hour but at all events it involves a unit of length divided\nby a unit of time so the dimensional formula of velocity is L/T. Similarly,\ndensity’s dimensional formula is M/L3.\n\n166\nChapter Two.",
    "Vector Spaces\nTo write the dimensional formula we shall use negative exponents instead of\nfractions and we shall include the dimensions with a zero exponent.",
    "Thus we\nwill write the dimensional formula of velocity as L1M0T −1 and that of density\nas L−3M1T 0.\n",
    "With that, “you can’t add apples and oranges” becomes the advice to check\nthat all of an equation’s terms have the same dimensional formula.",
    "An example\nis this version of the falling body equation d−gt2 = 0.",
    "The dimensional formula\nof the d term is L1M0T 0.",
    "For the other term, the dimensional formula of g\nis L1M0T −2 (g is given above as 16 ft/sec2) and the dimensional formula of t\nis L0M0T 1",
    "so that of the entire gt2 term is L1M0T −2(L0M0T 1)2 = L1M0T 0.\n",
    "Thus the two terms have the same dimensional formula.",
    "An equation with this\nproperty is dimensionally homogeneous.\n",
    "Quantities with dimensional formula L0M0T 0 are dimensionless.",
    "For ex-\nample, we measure an angle by taking the ratio of the subtended arc to the\nradius\nr\narc\nwhich is the ratio of a length to a length (L1M0T 0)(L1M0T 0)−1 and thus angles\nhave the dimensional formula L0M0T 0.\n",
    "The classic example of using the units for more than bookkeeping, using\nthem to draw conclusions, considers the formula for the period of a pendulum.\n",
    "p = –some expression involving the length of the string, etc.–\n",
    "The period is in units of time L0M0T 1.",
    "So the quantities on the other side of\nthe equation must have dimensional formulas that combine in such a way that\ntheir L’s and M’s cancel and only a single T remains.",
    "The table on page 167 has\nthe quantities that an experienced investigator would consider possibly relevant\nto the period of a pendulum.",
    "The only dimensional formulas involving L are for\nthe length of the string and the acceleration due to gravity.",
    "For the L’s of these\ntwo to cancel when they appear in the equation they must be in ratio, e.g., as\n(ℓ/g)2, or as cos(ℓ/g), or as (ℓ/g)−1.",
    "Therefore the period is a function of ℓ/g.\n",
    "This is a remarkable result: with a pencil and paper analysis, before we ever\ntook out the pendulum and made measurements, we have determined something\nabout what makes up its period.\n",
    "To do dimensional analysis systematically, we need two facts (arguments\nfor these are in [Bridgman], Chapter II and IV).",
    "The ﬁrst is that each equation\nrelating physical quantities that we shall see involves a sum of terms, where each\nterm has the form\nmp1\n1 mp2\n2 · · · mpk\nk\n\nTopic: Dimensional Analysis\n167\nfor numbers m1, . . .",
    ", mk that measure the quantities.\n",
    "For the second fact, observe that an easy way to construct a dimensionally\nhomogeneous expression is by taking a product of dimensionless quantities\nor by adding such dimensionless terms.",
    "Buckingham’s Theorem states that\nany complete relationship among quantities with dimensional formulas can be\nalgebraically manipulated into a form where there is some function f such that\nf(Π1, . . .",
    ", Πn) = 0\nfor a complete set {Π1, . . .",
    ", Πn} of dimensionless products.",
    "(The ﬁrst example\nbelow describes what makes a set of dimensionless products ‘complete’.)",
    "We\nusually want to express one of the quantities, m1 for instance, in terms of the\nothers.",
    "For that we will assume that the above equality can be rewritten\nm1 = m−p2\n2\n· · · m−pk\nk\n· ˆf(Π2, . . .",
    ", Πn)\nwhere Π1 = m1mp2\n2 · · · mpk\nk\nis dimensionless and the products Π2, . . .",
    ", Πn\ndon’t involve m1 (as with f, here ˆf is an arbitrary function, this time of n −1\narguments).",
    "Thus, to do dimensional analysis we should ﬁnd which dimensionless\nproducts are possible.\n",
    "For example, again consider the formula for a pendulum’s period.\n",
    "quantity\ndimensional\nformula\nperiod p\nL0M0T 1\nlength of string ℓ\nL1M0T 0\nmass of bob m\nL0M1T 0\nacceleration due to gravity g\nL1M0T −2\narc of swing θ\nL0M0T 0\nBy the ﬁrst fact cited above, we expect the formula to have (possibly sums of\nterms of) the form pp1ℓp2mp3gp4θp5.",
    "To use the second fact, to ﬁnd which\ncombinations of the powers p1, . .",
    ".",
    ", p5 yield dimensionless products, consider\nthis equation.\n",
    "(L0M0T 1)p1(L1M0T 0)p2(L0M1T 0)p3(L1M0T −2)p4(L0M0T 0)p5 = L0M0T 0\n",
    "It gives three conditions on the powers.\n",
    "p2\n+ p4 = 0\np3\n= 0\np1\n−2p4 = 0\n\n168\nChapter Two.",
    "Vector Spaces\nNote that p3 = 0",
    "so the mass of the bob does not aﬀect the period.",
    "Gaussian\nreduction and parametrization of that system gives this\n{\n\n\n\n\n\n\n\np1\np2\np3\np4\np5\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n1\n−1/2\n0\n1/2\n0\n\n\n\n\n\n\n\np1 +\n\n\n\n\n\n\n\n0\n0\n0\n0\n1\n\n\n\n\n\n\n\np5 | p1, p5 ∈R}\n(we’ve taken p1 as one of the parameters in order to express the period in terms\nof the other quantities).\n",
    "The set of dimensionless products contains all terms pp1ℓp2mp3ap4θp5\nsubject to the conditions above.",
    "This set forms a vector space under the ‘+’\noperation of multiplying two such products and the ‘·’ operation of raising such\na product to the power of the scalar (see Exercise 5).",
    "The term ‘complete set of\ndimensionless products’ in Buckingham’s Theorem means a basis for this vector\nspace.\n",
    "We can get a basis by ﬁrst taking p1 = 1, p5 = 0, and then taking p1 = 0,\np5 = 1.",
    "The associated dimensionless products are Π1 = pℓ−1/2g1/2 and Π2 = θ.\n",
    "Because the set {Π1, Π2 } is complete, Buckingham’s Theorem says that\np = ℓ1/2g−1/2 · ˆf(θ) =\np\nℓ/g · ˆf(θ)\nwhere ˆf is a function that we cannot determine from this analysis (a ﬁrst year\nphysics text will show by other means that for small angles it is approximately\nthe constant function ˆf(θ) = 2π).\n",
    "Thus, analysis of the relationships that are possible between the quantities\nwith the given dimensional formulas has given us a fair amount of information: a\npendulum’s period does not depend on the mass of the bob, and it rises with\nthe square root of the length of the string.\n",
    "For the next example we try to determine the period of revolution of two\nbodies in space orbiting each other under mutual gravitational attraction.",
    "An\nexperienced investigator could expect that these are the relevant quantities.\n",
    "quantity\ndimensional\nformula\nperiod p\nL0M0T 1\nmean separation r\nL1M0T 0\nﬁrst mass m1\nL0M1T 0\nsecond mass m2\nL0M1T 0\ngravitational constant G\nL3M−1T −2\nTo get the complete set of dimensionless products we consider the equation\n(L0M0T 1)p1(L1M0T 0)p2(L0M1T 0)p3(L0M1T 0)p4(L3M−1T −2)p5 = L0M0T 0\n\nTopic: Dimensional Analysis\n169\nwhich results in a system\np2\n+ 3p5 = 0\np3 + p4 −p5 = 0\np1\n−2p5 = 0\nwith this solution.\n{\n\n\n\n\n\n\n\n1\n−3/2\n1/2\n0\n1/2\n\n\n\n\n\n\n\np1 +\n\n\n\n\n\n\n\n0\n0\n−1\n1\n0\n\n\n\n\n\n\n\np4 | p1, p4 ∈R}\nAs earlier, the set of dimensionless products of these quantities forms a\nvector space and we want to produce a basis for that space, a ‘complete’ set of\ndimensionless products.",
    "One such set, gotten from setting p1 = 1 and p4 = 0\nand also setting p1 = 0 and p4 = 1 is {Π1 = pr−3/2m1/2\n1\nG1/2, Π2 = m−1\n1 m2}.\n",
    "With that, Buckingham’s Theorem says that any complete relationship among\nthese quantities is stateable this form.\n",
    "p = r3/2m−1/2\n1\nG−1/2 · ˆf(m−1\n1 m2) =\nr3/2\n√Gm1\n· ˆf(m2/m1)\nRemark.",
    "An important application of the prior formula is when m1 is the\nmass of the sun and m2 is the mass of a planet.",
    "Because m1 is very much greater\nthan m2, the argument to ˆf is approximately 0, and we can wonder whether\nthis part of the formula remains approximately constant as m2 varies.",
    "One way\nto see that it does is this.",
    "The sun is so much larger than the planet that the\nmutual rotation is approximately about the sun’s center.",
    "If we vary the planet’s\nmass m2 by a factor of x (e.g., Venus’s mass is x = 0.815 times Earth’s mass),\nthen the force of attraction is multiplied by x, and x times the force acting on\nx times the mass gives, since F = ma, the same acceleration, about the same\ncenter (approximately).",
    "Hence, the orbit will be the same and so its period\nwill be the same, and thus the right side of the above equation also remains\nunchanged (approximately).",
    "Therefore, ˆf(m2/m1) is approximately constant as\nm2 varies.",
    "This is Kepler’s Third Law: the square of the period of a planet is\nproportional to the cube of the mean radius of its orbit about the sun.\n",
    "The ﬁnal example was one of the ﬁrst explicit applications of dimensional\nanalysis.\n",
    "Lord Raleigh considered the speed of a wave in deep water and\nsuggested these as the relevant quantities.\n\n",
    "170\nChapter Two.",
    "Vector Spaces\nquantity\ndimensional\nformula\nvelocity of the wave v\nL1M0T −1\ndensity of the water d\nL−3M1T 0\nacceleration due to gravity g\nL1M0T −2\nwavelength λ\nL1M0T 0\n",
    "The equation\n(L1M0T −1)p1(L−3M1T 0)p2(L1M0T −2)p3(L1M0T 0)p4 = L0M0T 0\ngives this system\np1 −3p2 + p3 + p4 = 0\np2\n= 0\n−p1\n−2p3\n= 0\nwith this solution space.\n{\n\n\n\n\n\n1\n0\n−1/2\n−1/2\n\n\n\n\np1 | p1 ∈R}\nThere is one dimensionless product, Π1 = vg−1/2λ−1/2, and so v is √λg times\na constant; ˆf is constant since it is a function of no arguments.",
    "The quantity d\nis not involved in the relationship.\n",
    "The three examples above show that dimensional analysis can bring us far\ntoward expressing the relationship among the quantities.",
    "For further reading,\nthe classic reference is [Bridgman] — this brief book is delightful.",
    "Another source\nis [Giordano, Wells, Wilde].",
    "A description of dimensional analysis’s place in\nmodeling is in [Giordano, Jaye, Weir].\n",
    "Exercises\n1 [de Mestre] Consider a projectile, launched with initial velocity v0, at an angle θ.\n",
    "To study its motion we may guess that these are the relevant quantities.\n",
    "quantity\ndimensional\nformula\nhorizontal position x\nL1M0T 0\nvertical position y\nL1M0T 0\ninitial speed v0\nL1M0T −1\nangle of launch θ\nL0M0T 0\nacceleration due to gravity g\nL1M0T −2\ntime t\nL0M0T 1\n(a) Show that {gt/v0, gx/v2\n0, gy/v2\n0, θ} is a complete set of dimensionless products.\n",
    "(Hint.",
    "One way to go is to ﬁnd the appropriate free variables in the linear system\nthat arises but there is a shortcut that uses the properties of a basis.)\n\n",
    "Topic: Dimensional Analysis\n171\n(b) These two equations of motion for projectiles are familiar: x = v0 cos(θ)t and\ny = v0 sin(θ)t −(g/2)t2.",
    "Manipulate each to rewrite it as a relationship among\nthe dimensionless products of the prior item.\n",
    "2",
    "[Einstein] conjectured that the infrared characteristic frequencies of a solid might\nbe determined by the same forces between atoms as determine the solid’s ordinary\nelastic behavior.",
    "The relevant quantities are these.\n",
    "quantity\ndimensional\nformula\ncharacteristic frequency ν\n",
    "L0M0T −1\ncompressibility k\nL1M−1T 2\nnumber of atoms per cubic cm N\nL−3M0T 0\nmass of an atom m\nL0M1T 0\nShow that there is one dimensionless product.",
    "Conclude that, in any complete\nrelationship among quantities with these dimensional formulas, k is a constant\ntimes ν−2N−1/3m−1.",
    "This conclusion played an important role in the early study\nof quantum phenomena.\n",
    "3",
    "[Giordano, Wells, Wilde]",
    "The torque produced by an engine has dimensional\nformula L2M1T −2.",
    "We may ﬁrst guess that it depends on the engine’s rotation\nrate (with dimensional formula L0M0T −1), and the volume of air displaced (with\ndimensional formula L3M0T 0).\n",
    "(a) Try to ﬁnd a complete set of dimensionless products.",
    "What goes wrong?\n(b) Adjust the guess by adding the density of the air (with dimensional formula\nL−3M1T 0).",
    "Now ﬁnd a complete set of dimensionless products.\n4",
    "[Tilley] Dominoes falling make a wave.",
    "We may conjecture that the wave speed v\ndepends on the spacing d between the dominoes, the height h of each domino, and\nthe acceleration due to gravity g.\n(a) Find the dimensional formula for each of the four quantities.\n",
    "(b) Show that {Π1 = h/d, Π2 = dg/v2 } is a complete set of dimensionless products.\n",
    "(c) Show that if h/d is ﬁxed then the propagation speed is proportional to the\nsquare root of d.\n5 Prove that the dimensionless products form a vector space under the ⃗+ operation\nof multiplying two such products and the ⃗· operation of raising such the product\nto the power of the scalar.",
    "(The vector arrows are a precaution against confusion.)\n",
    "That is, prove that, for any particular homogeneous system, this set of products of\npowers of m1, . .",
    ".",
    ", mk\n{mp1\n1 . . .",
    "mpk\nk\n| p1, . . .",
    ", pk satisfy the system}\nis a vector space under:\nmp1\n1 . . .",
    "mpk\nk ⃗+mq1\n1 . .",
    ".",
    "mqk\nk\n= mp1+q1\n1\n. . .",
    "mpk+qk\nk\nand\nr⃗·(mp1\n1 . .",
    ".",
    "mpk\nk ) = mrp1\n1\n. . .",
    "mrpk\nk\n(assume that all variables represent real numbers).\n",
    "6",
    "The advice about apples and oranges is not right.",
    "Consider the familiar equations\nfor a circle C = 2πr and A = πr2.\n",
    "(a) Check that C and A have diﬀerent dimensional formulas.\n\n",
    "172\nChapter Two.",
    "Vector Spaces\n(b) Produce an equation that is not dimensionally homogeneous (i.e., it adds\napples and oranges) but is nonetheless true of any circle.\n",
    "(c)",
    "The prior item asks for an equation that is complete but not dimensionally\nhomogeneous.",
    "Produce an equation that is dimensionally homogeneous but not\ncomplete.\n",
    "(Just because the old saying isn’t strictly right doesn’t keep it from being a\nuseful strategy.",
    "Dimensional homogeneity is often used to check the plausibility\nof equations used in models.",
    "For an argument that any complete equation can\neasily be made dimensionally homogeneous, see [Bridgman], Chapter I, especially\npage 15.)\n\n",
    "Chapter Three\nMaps Between Spaces\nI\nIsomorphisms\nIn the examples following the deﬁnition of a vector space we expressed the\nintuition that some spaces are “the same” as others.",
    "For instance, the space of\ntwo-tall column vectors and the space of two-wide row vectors are not equal\nbecause their elements — column vectors and row vectors — are not equal, but\nwe feel that these spaces diﬀer only in how their elements appear.",
    "We will now\nmake this precise.\n",
    "This section illustrates a common phase of a mathematical investigation.\n",
    "With the help of some examples we’ve gotten an idea.",
    "We will next give a formal\ndeﬁnition and then we will produce some results backing our contention that\nthe deﬁnition captures the idea.",
    "We’ve seen this happen already, for instance in\nthe ﬁrst section of the Vector Space chapter.",
    "There, the study of linear systems\nled us to consider collections closed under linear combinations.",
    "We deﬁned such\na collection as a vector space and we followed it with some supporting results.\n",
    "That wasn’t an end point, instead it led to new insights such as the idea of a\nbasis.",
    "Here also, after producing a deﬁnition and supporting it, we will get two\nsurprises (pleasant ones).",
    "First, we will ﬁnd that the deﬁnition applies to some\nunforeseen, and interesting, cases.",
    "Second, the study of the deﬁnition will lead\nto new ideas.",
    "In this way, our investigation will build momentum.\n",
    "I.1\nDefinition and Examples\nWe start with two examples that suggest the right deﬁnition.\n\n",
    "174\nChapter Three.",
    "Maps Between Spaces\n1.1 Example",
    "The space of two-wide row vectors and the space of two-tall column\nvectors are “the same” in that if we associate the vectors that have the same\ncomponents, e.g.,\n(1 2)\n←→\n \n1\n2\n!\n(read the double arrow as “corresponds to”) then this association respects the\noperations.",
    "For instance these corresponding vectors add to corresponding totals\n(1 2) + (3 4) = (4 6)\n←→\n \n1\n2\n!\n+\n \n3\n4\n!\n=\n \n4\n6\n!\nand here is an example of the correspondence respecting scalar multiplication.\n",
    "5 · (1 2) = (5 10)\n←→\n5 ·\n \n1\n2\n!\n=\n \n5\n10\n!\n",
    "Stated generally, under the correspondence\n(a0 a1)\n←→\n \na0\na1\n!\n",
    "both operations are preserved:\n(a0 a1)",
    "+",
    "(b0 b1)",
    "= (a0 + b0 a1 + b1) ←→\n \na0\na1\n!\n+\n \nb0\nb1\n!\n=\n \na0 + b0\na1 + b1\n!\nand\nr · (a0 a1) = (ra0 ra1)\n",
    "←→\nr ·\n \na0\na1\n!\n=\n \nra0\nra1\n!\n",
    "(all of the variables are scalars).\n",
    "1.2 Example Another two spaces that we can think of as “the same” are P2, the\nspace of quadratic polynomials, and R3.",
    "A natural correspondence is this.\n",
    "a0 +",
    "a1x",
    "+ a2x2\n←→\n\n\n\na0\na1\na2\n\n",
    "\n\n(e.g., 1 + 2x + 3x2 ←→\n\n\n\n1\n2\n3\n\n\n)\n",
    "This preserves structure: corresponding elements add in a corresponding way\na0 +",
    "a1x",
    "+ a2x2\n",
    "+ b0 + b1x",
    "+ b2x2\n(a0 + b0)",
    "+ (a1 + b1)x + (a2 + b2)x2\n←→\n\n\n\na0\na1\na2\n\n",
    "\n+\n\n\n\nb0\nb1\nb2\n\n\n=\n\n\n\na0 + b0\na1 + b1\na2 + b2\n\n\n\n\nSection I. Isomorphisms\n175\nand scalar multiplication corresponds also.\n",
    "r · (a0 + a1x",
    "+ a2x2) = (ra0) + (ra1)x + (ra2)x2\n←→\nr ·\n\n\n\na0\na1\na2\n\n\n=\n\n\n\nra0\nra1\nra2\n\n\n\n1.3 Deﬁnition An isomorphism between two vector spaces V and W is a map\nf: V →W that\n(1) is a correspondence: f is one-to-one and onto;∗\n(2) preserves structure: if ⃗v1,⃗v2 ∈V then\nf(⃗v1 +⃗v2) = f(⃗v1)",
    "+ f(⃗v2)\n",
    "and if ⃗v ∈V and r ∈R then\nf(r⃗v) = rf(⃗v)\n(we write V ∼= W, read “V is isomorphic to W”, when such a map exists).\n",
    "“Morphism” means map, so “isomorphism” means a map expressing sameness.\n",
    "1.4 Example The vector space G = {c1 cos θ + c2 sin θ | c1, c2 ∈R} of functions\nof θ is isomorphic to R2 under this map.\n",
    "c1",
    "cos θ + c2 sin θ\nf\n7−→\n \nc1\nc2\n!\n",
    "We will check this by going through the conditions in the deﬁnition.",
    "We will\nﬁrst verify condition (1), that the map is a correspondence between the sets\nunderlying the spaces.\n",
    "To establish that f is one-to-one we must prove that f(⃗a)",
    "= f(⃗b)",
    "only when\n⃗a = ⃗b.",
    "If\nf(a1 cos θ + a2 sin θ) = f(b1 cos θ + b2 sin θ)\nthen by the deﬁnition of f\n \na1\na2\n!\n=\n \nb1\nb2\n!\nfrom which we conclude that a1 = b1 and a2 = b2, because column vectors\nare equal only when they have equal components.",
    "Thus a1 cos θ + a2 sin θ =\nb1 cos θ + b2 sin θ, and as required we’ve veriﬁed that f(⃗a)",
    "= f(⃗b) implies that\n⃗a = ⃗b.\n",
    "∗More",
    "information on correspondences is in the appendix.\n\n",
    "176\nChapter Three.",
    "Maps Between Spaces\nTo prove that f is onto we must check that any member of the codomain R2\nis the image of some member of the domain",
    "G. So, consider a member of the\ncodomain\n \nx\ny\n!\nand note that it is the image under f of x cos θ",
    "+ y sin θ.\n",
    "Next we will verify condition (2), that f preserves structure.",
    "This computation\nshows that f preserves addition.\n",
    "f\n\u0000(a1 cos θ + a2 sin θ)",
    "+",
    "(b1 cos θ + b2 sin θ)\n\u0001\n= f\n\u0000(a1 + b1) cos θ + (a2 + b2) sin θ\n\u0001\n=\n \na1 + b1\na2 + b2\n!\n=\n \na1\na2\n!\n+\n \nb1\nb2\n!\n= f(a1 cos θ + a2 sin θ)",
    "+ f(b1 cos θ + b2 sin θ)\n",
    "The computation showing that f preserves scalar multiplication is similar.\n",
    "f\n\u0000r · (a1 cos θ + a2 sin θ)\n\u0001\n= f( ra1 cos θ + ra2 sin θ )\n=\n \nra1\nra2\n!\n",
    "= r ·\n \na1\na2\n!\n",
    "= r · f(a1 cos θ + a2 sin θ)\nWith both (1) and (2) veriﬁed, we know that f is an isomorphism and we\ncan say that the spaces are isomorphic G ∼= R2.\n",
    "1.5 Example Let V be the space {c1x + c2y + c3z | c1, c2, c3 ∈R} of linear combi-\nnations of the three variables under the natural addition and scalar multiplication\noperations.",
    "Then V is isomorphic to P2, the space of quadratic polynomials.\n",
    "To show this we must produce an isomorphism map.",
    "There is more than one\npossibility; for instance, here are four to choose among.\n",
    "c1x +",
    "c2y + c3z\nf1\n7−→\nc1 + c2x",
    "+ c3x2\nf2\n7−→\nc2 + c3x + c1x2\nf3\n7−→\n−c1 −c2x −c3x2\nf4\n7−→\nc1 + (c1 + c2)x + (c1 + c3)x2\n\nSection I. Isomorphisms\n177\n",
    "The ﬁrst map is the more natural correspondence in that it just carries the\ncoeﬃcients over.",
    "However we shall do f2 to underline that there are isomorphisms\nother than the obvious one.",
    "(Checking that f1 is an isomorphism is Exercise 14.)\n",
    "To show that f2 is one-to-one we will prove that if f2(c1x +",
    "c2y + c3z)",
    "=\nf2(d1x",
    "+ d2y + d3z) then c1x +",
    "c2y +",
    "c3z = d1x + d2y + d3z.",
    "The assumption\nthat f2(c1x+c2y+c3z) = f2(d1x+d2y+d3z) gives, by the deﬁnition of f2, that\nc2 + c3x + c1x2 = d2 + d3x + d1x2.",
    "Equal polynomials have equal coeﬃcients so\nc2 = d2, c3 = d3, and c1 = d1.",
    "Hence f2(c1x+c2y+c3z) = f2(d1x+d2y+d3z)\nimplies that c1x +",
    "c2y +",
    "c3z = d1x + d2y + d3z, and f2 is one-to-one.\n",
    "The map f2 is onto because a member a + bx + cx2 of the codomain is the\nimage of a member of the domain, namely it is f2(cx",
    "+ ay + bz).",
    "For instance,\n2 + 3x −4x2 is f2(−4x",
    "+ 2y + 3z).\n",
    "The computations for structure preservation are like those in the prior\nexample.",
    "The map f2 preserves addition\nf2\n\u0000(c1x +",
    "c2y + c3z)",
    "+ (d1x + d2y + d3z)\n\u0001\n= f2\n\u0000(c1",
    "+ d1)x + (c2 + d2)y + (c3 + d3)z\n\u0001\n= (c2 + d2)",
    "+ (c3 + d3)x + (c1 + d1)x2\n= (c2 + c3x + c1x2) + (d2 + d3x + d1x2)\n= f2(c1x +",
    "c2y + c3z)",
    "+",
    "f2(d1x + d2y + d3z)\nand scalar multiplication.\n",
    "f2\n\u0000r · (c1x + c2y + c3z)\n",
    "\u0001\n= f2(rc1x + rc2y + rc3z)\n= rc2 +",
    "rc3x + rc1x2\n= r · (c2 + c3x + c1x2)\n",
    "= r · f2(c1x + c2y + c3z)\n",
    "Thus f2 is an isomorphism.",
    "We write V ∼= P2.\n",
    "1.6 Example Every space is isomorphic to itself under the identity map.",
    "The\ncheck is easy.\n",
    "1.7 Deﬁnition An automorphism is an isomorphism of a space with itself.\n",
    "1.8 Example A dilation map ds : R2 →R2 that multiplies all vectors by a nonzero\nscalar s is an automorphism of R2.\n⃗u\n⃗v\nd1.5(⃗u)\nd1.5(⃗v)\nd1.5\n−→\n\n178\nChapter Three.",
    "Maps Between Spaces\nAnother automorphism is a rotation or turning map, tθ : R2 →R2 that rotates\nall vectors through an angle θ.\n⃗u\ntπ/6(⃗u)\ntπ/6\n−→\nA third type of automorphism of R2 is a map fℓ: R2 →R2 that ﬂips or reﬂects\nall vectors over a line ℓthrough the origin.\n",
    "ℓ\n⃗u\nfℓ(⃗u)\nfℓ\n−→\nChecking that these are automorphisms is Exercise 33.\n",
    "1.9 Example Consider the space P5 of polynomials of degree 5 or less and the\nmap f that sends a polynomial p(x) to p(x −1).",
    "For instance, under this map\nx2 7→(x−1)2 = x2 −2x+1 and x3 +2x 7→(x−1)3 +2(x−1) = x3 −3x2 +5x−3.\n",
    "This map is an automorphism of this space; the check is Exercise 25.\n",
    "This isomorphism of P5 with itself does more than just tell us that the space\nis “the same” as itself.",
    "It gives us some insight into the space’s structure.",
    "Below\nis a family of parabolas, graphs of members of P5.",
    "Each has a vertex at y = −1,\nand the left-most one has zeroes at −2.25 and −1.75, the next one has zeroes at\n−1.25 and −0.75, etc.\np0\np1\nSubstitution of x −1 for x in any function’s argument shifts its graph to the\nright by one.",
    "Thus, f(p0)",
    "= p1, and f’s action is to shift all of the parabolas\nto the right by one.",
    "Notice that the picture before f is applied is the same as\nthe picture after f is applied because while each parabola moves to the right,\nanother one comes in from the left to take its place.",
    "This also holds true for\ncubics, etc.",
    "So the automorphism f expresses the idea that P5 has a certain\nhorizontal-homogeneity: if we draw two pictures showing all members of P5, one\n\nSection I. Isomorphisms\n179\npicture centered at x = 0 and the other centered at x",
    "= 1, then the two pictures\nwould be indistinguishable.\n",
    "As described in the opening to this section, having given the deﬁnition of\nisomorphism, we next look to support the thesis that it captures our intuition of\nvector spaces being the same.",
    "First, the deﬁnition itself is persuasive: a vector\nspace consists of a set and some structure and the deﬁnition simply requires that\nthe sets correspond and that the structures correspond also.",
    "Also persuasive\nare the examples above, such as Example 1.1, which dramatize that isomorphic\nspaces are the same in all relevant respects.",
    "Sometimes people say, where V ∼= W,\nthat “W is just V painted green” — diﬀerences are merely cosmetic.\n",
    "The results below further support our contention that under an isomorphism\nall the things of interest in the two vector spaces correspond.\n",
    "Because we\nintroduced vector spaces to study linear combinations, “of interest” means\n“pertaining to linear combinations.”",
    "Not of interest is the way that the vectors\nare presented typographically (or their color!).\n",
    "1.10 Lemma An isomorphism maps a zero vector to a zero vector.\n",
    "Proof Where f: V →W is an isomorphism, ﬁx some ⃗v ∈V.",
    "Then f(⃗0V)",
    "=\nf(0 ·⃗v) = 0 · f(⃗v) = ⃗0W.\nQED\n1.11 Lemma For any map f: V →W between vector spaces these statements are\nequivalent.\n",
    "(1) f preserves structure\nf(⃗v1 +⃗v2) = f(⃗v1)",
    "+ f(⃗v2)\nand\nf(c⃗v) = c f(⃗v)\n(2) f preserves linear combinations of two vectors\nf(c1⃗v1 + c2⃗v2) = c1f(⃗v1)",
    "+ c2f(⃗v2)\n(3) f preserves linear combinations of any ﬁnite number of vectors\nf(c1⃗v1 + · · ·",
    "+ cn⃗vn) = c1f(⃗v1) + · · · + cnf(⃗vn)\nProof Since the implications (3) =⇒(2) and (2) =⇒(1) are clear, we need\nonly show that (1) =⇒(3).",
    "So assume statement (1).",
    "We will prove (3) by\ninduction on the number of summands n.\nThe one-summand base case, that f(c⃗v1) = c f(⃗v1), is covered by the second\nclause of statement (1).\n",
    "For the inductive step assume that statement (3) holds whenever there are k\nor fewer summands.",
    "Consider the k + 1-summand case.",
    "Use the ﬁrst half of (1)\n\n180\nChapter Three.",
    "Maps Between Spaces\nto break the sum along the ﬁnal ‘+’.\n",
    "f(c1⃗v1 + · · · + ck⃗vk + ck+1⃗vk+1) = f(c1⃗v1 + · · ·",
    "+ ck⃗vk) + f(ck+1⃗vk+1)\nUse the inductive hypothesis to break up the k-term sum on the left.\n",
    "= f(c1⃗v1) + · · · + f(ck⃗vk)",
    "+ f(ck+1⃗vk+1)\n",
    "Now the second half of (1) gives\n= c1 f(⃗v1)",
    "+ · · · + ck f(⃗vk)",
    "+ ck+1 f(⃗vk+1)\nwhen applied k + 1 times.\n",
    "QED\nWe often use item (2) to simplify the veriﬁcation that a map preserves structure.\n",
    "Finally, a summary.",
    "In the prior chapter, after giving the deﬁnition of a\nvector space, we looked at examples and noted that some spaces seemed to be\nessentially the same as others.",
    "Here we have deﬁned the relation ‘∼=’ and have\nargued that it is the right way to precisely say what we mean by “the same”\nbecause it preserves the features of interest in a vector space — in particular, it\npreserves linear combinations.",
    "In the next section we will show that isomorphism\nis an equivalence relation and so partitions the collection of vector spaces.\n",
    "Exercises\n✓1.12 Verify, using Example 1.4 as a model, that the two correspondences given before\nthe deﬁnition are isomorphisms.\n",
    "(a) Example 1.1\n(b) Example 1.2\n✓1.13 For the map",
    "f: P1 →R2 given by\na + bx\nf\n7−→\n\u0012a −b\nb\n\u0013\nFind the image of each of these elements of the domain.\n",
    "(a) 3",
    "−2x\n(b) 2 + 2x\n(c) x\nShow that this map is an isomorphism.\n",
    "1.14 Show that the natural map f1 from Example 1.5 is an isomorphism.\n",
    "1.15 Show that the map t: P2 →P2 given by t(ax2 + bx + c) = bx2 −(a + c)x",
    "+ a is\nan isomorphism.\n",
    "✓1.16 Verify that this map is an isomorphism: h: R4 →M2×2 given by\n\n\n\n\na\nb\nc\nd\n\n\n\n7→\n\u0012c\na + d\nb\nd\n\u0013\n✓1.17 Decide whether each map is an isomorphism.",
    "If it is an isomorphism then prove\nit and if it isn’t then state a condition that it fails to satisfy.\n",
    "(a) f: M2×2 →R given by\n\u0012a\nb\nc\nd\n\u0013\n7→ad −bc\n\nSection I. Isomorphisms\n181\n(b) f: M2×2 →R4 given by\n\u0012a\nb\nc\nd\n\u0013\n",
    "7→\n\n\n\n\na + b + c + d\na + b + c\na + b\na\n\n\n\n\n(c) f: M2×2 →P3 given by\n\u0012a\nb\nc\nd\n\u0013\n7→c",
    "+ (d + c)x + (b + a)x2 + ax3\n(d) f:",
    "M2×2 →P3 given by\n\u0012a\nb\nc\nd\n\u0013\n",
    "7→c",
    "+ (d + c)x + (b + a + 1)x2 + ax3\n1.18 Show that the map f:",
    "R1 →R1 given by f(x)",
    "= x3 is one-to-one and onto.",
    "Is it\nan isomorphism?\n✓1.19 Refer to Example 1.1.",
    "Produce two more isomorphisms (of course, you must\nalso verify that they satisfy the conditions in the deﬁnition of isomorphism).\n",
    "1.20 Refer to Example 1.2.",
    "Produce two more isomorphisms (and verify that they\nsatisfy the conditions).\n",
    "✓1.21 Show that, although R2 is not itself a subspace of R3, it is isomorphic to the\nxy-plane subspace of R3.\n1.22 Find two isomorphisms between R16 and M4×4.\n",
    "✓1.23 For what k is Mm×n isomorphic to Rk?\n1.24 For what k is Pk isomorphic to Rn?\n1.25 Prove that the map in Example 1.9, from P5 to P5 given by p(x) 7→p(x −1),\nis a vector space isomorphism.\n",
    "1.26 Why, in Lemma 1.10, must there be a ⃗v ∈V?\nThat is, why must V be\nnonempty?\n1.27 Are any two trivial spaces isomorphic?\n",
    "1.28",
    "In the proof of Lemma 1.11, what about the zero-summands case (that is, if n\nis zero)?\n1.29 Show that any isomorphism f: P0 →R1 has the form a 7→ka for some nonzero\nreal number k.\n1.30 These prove that isomorphism is an equivalence relation.\n",
    "(a) Show that the identity map id: V →V is an isomorphism.",
    "Thus, any vector\nspace is isomorphic to itself.\n",
    "(b) Show that if f: V →W is an isomorphism then so is its inverse f−1 : W →V.\nThus, if V is isomorphic to W then also W is isomorphic to V.\n(c) Show that a composition of isomorphisms is an isomorphism: if f: V →W is\nan isomorphism and g: W →U is an isomorphism then so also is g ◦f",
    ": V →U.\nThus, if V is isomorphic to W and W is isomorphic to U, then also V is isomorphic\nto U.\n1.31 Suppose that f: V →W preserves structure.",
    "Show that f is one-to-one if and\nonly if the unique member of V mapped by f to ⃗0W is ⃗0V.\n\n182\nChapter Three.",
    "Maps Between Spaces\n1.32 Suppose that f: V →W is an isomorphism.",
    "Prove that the set {⃗v1, . . .",
    ",⃗vk } ⊆V\nis linearly dependent if and only if the set of images {f(⃗v1), . . .",
    ", f(⃗vk)} ⊆W is\nlinearly dependent.\n",
    "✓1.33 Show that each type of map from Example 1.8 is an automorphism.\n",
    "(a) Dilation ds by a nonzero scalar s.\n(b) Rotation tθ through an angle θ.\n(c) Reﬂection fℓover a line through the origin.\n",
    "Hint.",
    "For the second and third items, polar coordinates are useful.\n",
    "1.34 Produce an automorphism of P2 other than the identity map, and other than a\nshift map p(x)",
    "7→p(x −k).\n",
    "1.35\n(a) Show that a function f: R1 →R1 is an automorphism if and only if it has\nthe form x 7→kx for some k ̸= 0.\n(b) Let f be an automorphism of R1 such that f(3)",
    "= 7.",
    "Find f(−2).\n",
    "(c) Show that a function f: R2 →R2 is an automorphism if and only if it has the\nform\n\u0012x\ny\n\u0013\n7→\n\u0012ax",
    "+ by\ncx + dy\n\u0013\nfor some a, b, c, d ∈R with ad −bc ̸= 0.",
    "Hint.",
    "Exercises in prior subsections\nhave shown that\n\u0012b\nd\n\u0013\nis not a multiple of\n\u0012a\nc\n\u0013\nif and only if ad −bc ̸= 0.\n",
    "(d) Let f be an automorphism of R2 with\nf(\n\u00121\n3\n\u0013\n)",
    "=\n\u0012 2\n−1\n\u0013\nand\nf(\n\u00121\n4\n\u0013\n)",
    "=\n\u00120\n1\n\u0013\n.\n",
    "Find\nf(\n\u0012 0\n−1\n\u0013\n).\n",
    "1.36 Refer to Lemma 1.10 and Lemma 1.11.",
    "Find two more things preserved by\nisomorphism.\n",
    "1.37",
    "We show that isomorphisms can be tailored to ﬁt in that, sometimes, given\nvectors in the domain and in the range we can produce an isomorphism associating\nthose vectors.\n",
    "(a) Let B = ⟨⃗β1, ⃗β2, ⃗β3⟩be a basis for P2 so that any ⃗p ∈P2 has a unique\nrepresentation as ⃗p = c1⃗β1 + c2⃗β2 + c3⃗β3, which we denote in this way.\nRepB(⃗p)",
    "=\n\n\nc1\nc2\nc3\n\n\nShow that the RepB(·) operation is a function from P2 to R3 (this entails showing\nthat with every domain vector ⃗v ∈P2 there is an associated image vector in R3,\nand further, that with every domain vector ⃗v ∈P2 there is at most one associated\nimage vector).\n",
    "(b) Show that this RepB(·) function is one-to-one and onto.\n",
    "(c) Show that it preserves structure.\n\n",
    "Section I. Isomorphisms\n183\n(d) Produce an isomorphism from P2 to R3 that ﬁts these speciﬁcations.\n",
    "x + x2 7→\n\n\n1\n0\n0\n\n\nand\n",
    "1 −x 7→\n\n\n0\n1\n0\n\n\n1.38 Prove that a space is n-dimensional if and only if it is isomorphic to Rn. Hint.\n",
    "Fix a basis B for the space and consider the map sending a vector over to its\nrepresentation with respect to B.\n1.39 (Requires the subsection on Combining Subspaces, which is optional.)",
    "Let\nU and W be vector spaces.\n",
    "Deﬁne a new vector space, consisting of the set\nU ×",
    "W = {(⃗u, ⃗w) | ⃗u ∈U and ⃗w ∈W } along with these operations.\n",
    "(⃗u1, ⃗w1) + (⃗u2, ⃗w2) = (⃗u1 + ⃗u2, ⃗w1 + ⃗w2)\nand\nr · (⃗u, ⃗w) = (r⃗u, r⃗w)\n",
    "This is a vector space, the external direct sum of U and W.\n(a) Check that it is a vector space.\n",
    "(b) Find a basis for, and the dimension of, the external direct sum P2 × R2.\n",
    "(c) What is the relationship among dim(U), dim(W), and dim(U × W)?\n",
    "(d) Suppose that U and W are subspaces of a vector space V such that V = U⊕W\n(in this case we say that V is the internal direct sum of U and W).",
    "Show that\nthe map",
    "f: U × W →V given by\n(⃗u, ⃗w)\nf\n7−→⃗u + ⃗w\nis an isomorphism.",
    "Thus if the internal direct sum is deﬁned then the internal\nand external direct sums are isomorphic.\n",
    "I.2\nDimension Characterizes Isomorphism\n",
    "In the prior subsection, after stating the deﬁnition of isomorphism, we gave some\nresults supporting our sense that such a map describes spaces as “the same.”\n",
    "Here we will develop this intuition.",
    "When two (unequal) spaces are isomorphic\nwe think of them as almost equal, as equivalent.",
    "We shall make that precise by\nproving that the relationship ‘is isomorphic to’ is an equivalence relation.\n",
    "2.1 Lemma The inverse of an isomorphism is also an isomorphism.\n",
    "Proof Suppose that V is isomorphic to W via f: V →W. An isomorphism is a\ncorrespondence between the sets so f has an inverse function f−1 : W →V that\nis also a correspondence.∗\nWe will show that because f preserves linear combinations, so also does f−1.\n",
    "Suppose that ⃗w1, ⃗w2 ∈W. Because it is an isomorphism, f is onto and there\n∗More information on inverse functions is in the appendix.\n\n",
    "184\nChapter Three.",
    "Maps Between Spaces\nare ⃗v1,⃗v2 ∈V such that ⃗w1 = f(⃗v1) and ⃗w2 = f(⃗v2).",
    "Then\nf−1(c1 ·",
    "⃗w1",
    "+ c2 · ⃗w2) = f−1\u0000c1 · f(⃗v1)",
    "+ c2 · f(⃗v2)\n\u0001\n= f−1( f\n\u0000c1⃗v1 + c2⃗v2)\n\u0001\n= c1⃗v1 + c2⃗v2",
    "=",
    "c1 · f−1(⃗w1) + c2 · f−1(⃗w2)\nsince f−1(⃗w1) = ⃗v1 and f−1(⃗w2)",
    "= ⃗v2.",
    "With that, by Lemma 1.11’s second\nstatement, this map preserves structure.\n",
    "QED\n2.2 Theorem Isomorphism is an equivalence relation between vector spaces.\n",
    "Proof We must prove that the relation is symmetric, reﬂexive, and transitive.\n",
    "To check reﬂexivity, that any space is isomorphic to itself, consider the\nidentity map.",
    "It is clearly one-to-one and onto.",
    "This shows that it preserves\nlinear combinations.\n",
    "id(c1 ·⃗v1 + c2 ·⃗v2)",
    "= c1⃗v1 + c2⃗v2 = c1 · id(⃗v1)",
    "+ c2 · id(⃗v2)\nSymmetry, that if V is isomorphic to W then also W is isomorphic to V,\nholds by Lemma 2.1 since each isomorphism map from V to W is paired with\nan isomorphism from W to V.\n",
    "To ﬁnish we must check transitivity, that if V is isomorphic to W and W\nis isomorphic to U then V is isomorphic to U. Let f: V →W and g: W →U\nbe isomorphisms.",
    "Consider their composition g ◦f",
    ":",
    "V",
    "→U.",
    "Because the com-\nposition of correspondences is a correspondence, we need only check that the\ncomposition preserves linear combinations.\n",
    "g ◦f\n\u0000c1 ·⃗v1 + c2 ·⃗v2\n\u0001\n= g\n\u0000f( c1 ·⃗v1",
    "+ c2 ·⃗v2 )\n\u0001\n= g\n\u0000c1 · f(⃗v1)",
    "+ c2 · f(⃗v2)\n\u0001\n= c1 · g\n\u0000f(⃗v1))",
    "+ c2 · g(f(⃗v2)\n\u0001\n= c1 · (g ◦f) (⃗v1) + c2 · (g ◦f) (⃗v2)\n",
    "Thus the composition is an isomorphism.\n",
    "QED\nSince it is an equivalence, isomorphism partitions the universe of vector\nspaces into classes: each space is in one and only one isomorphism class.\n",
    "All ﬁnite dimensional\nvector spaces:\n. . .\n",
    "V\nW\nV ∼= W\nThe next result characterizes these classes by dimension.",
    "That is, we can describe\neach class simply by giving the number that is the dimension of all of the spaces\nin that class.\n\n",
    "Section I. Isomorphisms\n185\n2.3 Theorem Vector spaces are isomorphic if and only if they have the same\ndimension.\n",
    "In this double implication statement the proof of each half involves a signiﬁ-\ncant idea so we will do the two separately.\n",
    "2.4 Lemma If spaces are isomorphic then they have the same dimension.\n",
    "Proof We shall show that an isomorphism of two spaces gives a correspon-\ndence between their bases.\n",
    "That is, we shall show that if f: V →W is an\nisomorphism and a basis for the domain V is B = ⟨⃗β1, . . .",
    ", ⃗βn⟩then its image\nD = ⟨f(⃗β1), . .",
    ".",
    ", f(⃗βn)⟩is a basis for the codomain W. (The other half of the\ncorrespondence, that for any basis of W the inverse image is a basis for V, follows\nfrom the fact that f−1 is also an isomorphism and so we can apply the prior\nsentence to f−1.)\n",
    "To see that D spans W, ﬁx any ⃗w ∈W. Because f is an isomorphism it is\nonto and so there is a ⃗v ∈V with ⃗w = f(⃗v).",
    "Expand ⃗v as a combination of basis\nvectors.\n",
    "⃗w = f(⃗v)",
    "= f(v1⃗β1",
    "+ · · · + vn⃗βn) = v1 · f(⃗β1) + · · · + vn · f(⃗βn)\n",
    "For linear independence of D, if\n⃗0W = c1f(⃗β1) + · · · + cnf(⃗βn) = f(c1⃗β1 + · · · + cn⃗βn)\nthen, since f is one-to-one and so the only vector sent to ⃗0W is ⃗0V, we have that\n⃗0V = c1⃗β1 + · · · + cn⃗βn, which implies that all of the c’s are zero.\n",
    "QED\n2.5 Lemma",
    "If spaces have the same dimension then they are isomorphic.\n",
    "Proof We will prove that any space of dimension n is isomorphic to Rn.",
    "Then\nwe will have that all such spaces are isomorphic to each other by transitivity,\nwhich was shown in Theorem 2.2.\n",
    "Let V be n-dimensional.",
    "Fix a basis B = ⟨⃗β1, . . .",
    ", ⃗βn⟩for the domain V.\nConsider the operation of representing the members of V with respect to B as a\nfunction from V to Rn.\n⃗v",
    "= v1⃗β1 + · · · + vn⃗βn\nRepB\n7−→\n\n\n\nv1\n...\n",
    "vn\n\n\n\n",
    "It is well-deﬁned∗since every ⃗v has one and only one such representation (see\nRemark 2.7 following this proof).\n",
    "∗More",
    "information on well-deﬁned is in the appendix.\n\n186\nChapter Three.",
    "Maps Between Spaces\nThis function is one-to-one because if\nRepB(u1⃗β1 + · · · + un⃗βn) = RepB(v1⃗β1",
    "+ · · · + vn⃗βn)\nthen\n\n\n\nu1\n...\nun\n\n\n=\n\n\n\nv1\n...\nvn\n\n\n\nand so u1 = v1, . . .",
    ", un = vn, implying that the original arguments u1⃗β1 +\n· · · + un⃗βn and v1⃗β1 + · · · + vn⃗βn are equal.\n",
    "This function is onto; any member of Rn\n⃗w =\n\n\n\nw1\n...\nwn\n\n\n\nis the image of some ⃗v ∈V, namely ⃗w = RepB(w1⃗β1 + · · · + wn⃗βn).\n",
    "Finally, this function preserves structure.\nRepB(r · ⃗u + s ·⃗v) = RepB( (ru1 + sv1)⃗β1 + · · · + (run + svn)⃗βn )\n=\n\n\n\nru1 + sv1\n...\nrun + svn\n\n\n\n= r ·\n\n\n\nu1\n...\nun\n\n\n+ s ·\n\n\n\nv1\n...\nvn\n\n\n\n= r · RepB(⃗u) + s · RepB(⃗v)\n",
    "Therefore RepB is an isomorphism.",
    "Consequently any n-dimensional space\nis isomorphic to Rn.\nQED\n2.6 Remark When we introduced the RepB notation for vectors on page 125, we\nnoted that it is not standard and said that one advantage it has is that it is\nharder to overlook.",
    "Here we see its other advantage: this notation makes explicit\nthat RepB is a function from V to Rn.\n2.7 Remark",
    "The proof has a sentence about ‘well-deﬁned.’",
    "Its point is that to be\nan isomorphism RepB must be a function.",
    "The deﬁnition of function requires\nthat for all inputs the associated output must exists and must be determined by\nthe input.",
    "So we must check that every ⃗v is associated with at least one RepB(⃗v),\nand with no more than one.\n\nSection I. Isomorphisms\n187\nIn the proof we express elements ⃗v of the domain space as combinations\nof members of the basis B and then associate ⃗v with the column vector of\ncoeﬃcients.",
    "That there is at least one expansion of each ⃗v holds because B is a\nbasis and so spans the space.\n",
    "The worry that there is no more than one associated member of the codomain\nis subtler.",
    "A contrasting example, where an association fails this unique output\nrequirement, illuminates the issue.",
    "Let the domain be P2 and consider a set that\nis not a basis (it is not linearly independent, although it does span the space).\n",
    "A = {1 + 0x + 0x2, 0 + 1x + 0x2, 0 + 0x + 1x2, 1 + 1x + 2x2}\nCall those polynomials ⃗α1, . . .",
    ", ⃗α4.",
    "In contrast to the situation when the set\nis a basis, here there can be more than one expression of a domain vector in\nterms of members of the set.",
    "For instance, consider ⃗v = 1",
    "+ x + x2.",
    "Here are\ntwo diﬀerent expansions.\n",
    "⃗v = 1⃗α1 + 1⃗α2 + 1⃗α3",
    "+ 0⃗α4\n⃗v =",
    "0⃗α1 + 0⃗α2 −1⃗α3 + 1⃗α4\n",
    "So this input vector ⃗v is associated with more than one column.\n",
    "\n\n\n\n\n1\n1\n1\n0\n\n\n\n\n\n\n\n\n\n\n0\n0\n−1\n1\n\n\n\n\n\nThus, with A the association is not well-deﬁned.",
    "(The issue is that A is not\nlinearly independent; to show uniqueness Theorem Two.",
    "III.1.12’s proof uses only\nlinear independence.)\n",
    "In general, any time that we deﬁne a function we must check that output\nvalues are well-deﬁned.",
    "Most of the time that condition is perfectly obvious but\nin the above proof it needs veriﬁcation.",
    "See Exercise 22.\n",
    "2.8 Corollary Each ﬁnite-dimensional vector space is isomorphic to one and only\none of the Rn.\n",
    "This gives us a collection of representatives of the isomorphism classes.\n",
    "All ﬁnite dimensional\nvector spaces:\n. . .\n",
    "⋆R2\n⋆R0\n⋆R3\n⋆R1\n",
    "One representative\nper class\nThe proofs above pack many ideas into a small space.",
    "Through the rest of\nthis chapter we’ll consider these ideas again, and ﬁll them out.",
    "As a taste of\nthis we will expand here on the proof of Lemma 2.5.\n\n188\nChapter Three.",
    "Maps Between Spaces\n2.9 Example The space M2×2 of 2×2 matrices is isomorphic to R4.",
    "With this\nbasis for the domain\nB = ⟨\n \n1\n0\n0\n0\n!\n,\n \n0\n1\n0\n0\n!\n,\n \n0\n0\n1\n0\n!\n,\n \n0\n0\n0\n1\n!\n",
    "⟩\nthe isomorphism given in the lemma, the representation map f1 = RepB, carries\nthe entries over.\n \na\nb\nc\nd\n!\nf1\n7−→\n\n\n\n\n\na\nb\nc\nd\n\n\n\n\n\nOne way to think of the map f1 is: ﬁx the basis B for the domain, use the\nstandard basis E4 for the codomain, and associate ⃗β1 with ⃗e1, ⃗β2 with ⃗e2, etc.\nThen extend this association to all of the members of two spaces.\n \na\nb\nc\nd\n!\n",
    "= a⃗β1 + b⃗β2 + c⃗β3 + d⃗β4\nf1\n7−→\na⃗e1 + b⃗e2 + c⃗e3 + d⃗e4 =\n\n\n\n\n\na\nb\nc\nd\n\n\n\n\n\nWe can do the same thing with diﬀerent bases, for instance, taking this basis\nfor the domain.\n",
    "A = ⟨\n \n2\n0\n0\n0\n!\n,\n \n0\n2\n0\n0\n!\n,\n \n0\n0\n2\n0\n!\n,\n \n0\n0\n0\n2\n!\n⟩\nAssociating corresponding members of A and E4 gives this.\n \na\nb\nc\nd\n!\n",
    "= (a/2)⃗α1 + (b/2)⃗α2 + (c/2)⃗α3 + (d/2)⃗α4\nf2\n7−→\n(a/2)⃗e1 + (b/2)⃗e2 + (c/2)⃗e3 + (d/2)⃗e4 =\n\n\n\n\n\na/2\nb/2\nc/2\nd/2\n\n\n\n\n\ngives rise to an isomorphism that is diﬀerent than f1.\n",
    "The prior map arose by changing the basis for the domain.",
    "We can also\nchange the basis for the codomain.",
    "Go back to the basis B above and use this\nbasis for the codomain.\n",
    "D = ⟨\n\n\n\n\n\n1\n0\n0\n0\n\n\n\n\n,\n\n\n\n\n\n0\n1\n0\n0\n\n\n\n\n,\n\n\n\n\n\n0\n0\n0\n1\n\n\n\n\n,\n\n\n\n\n\n0\n0\n1\n0\n\n\n\n\n⟩\n\nSection I. Isomorphisms\n189\nAssociate ⃗β1 with ⃗δ1, etc.",
    "Extending that gives another isomorphism.\n \n",
    "a\nb\nc\nd\n!\n",
    "= a⃗β1 + b⃗β2 + c⃗β3 + d⃗β4\nf3\n7−→\na⃗δ1 + b⃗δ2 + c⃗δ3 + d⃗δ4 =\n\n\n\n\n\na\nb\nd\nc\n\n\n\n\n\n",
    "We close with a recap.",
    "Recall that the ﬁrst chapter deﬁnes two matrices to be\nrow equivalent if they can be derived from each other by row operations.",
    "There\nwe showed that relation is an equivalence and so the collection of matrices is\npartitioned into classes, where all the matrices that are row equivalent together\nfall into a single class.",
    "Then for insight into which matrices are in each class we\ngave representatives for the classes, the reduced echelon form matrices.\n",
    "In this section we have followed that pattern except that the notion here\nof “the same” is vector space isomorphism.",
    "We deﬁned it and established some\nproperties, including that it is an equivalence.",
    "Then, as before, we developed\na list of class representatives to help us understand the partition — it classiﬁes\nvector spaces by dimension.\n",
    "In Chapter Two, with the deﬁnition of vector spaces, we seemed to have\nopened up our studies to many examples of new structures besides the familiar\nRn’s.",
    "We now know that isn’t the case.",
    "Any ﬁnite-dimensional vector space is\nactually “the same” as a real space.\n",
    "Exercises\n✓2.10 Decide if the spaces are isomorphic.\n",
    "(a) R2, R4\n(b) P5, R5\n(c) M2×3, R6\n(d) P5, M2×3\n(e) M2×k, Mk×2\n2.11 Which of these spaces are isomorphic to each other?\n(a) R3\n(b) M2×2\n(c) P3\n(d) R4\n(e) P2\n✓2.12 Consider the isomorphism RepB(·): P1 →R2 where B = ⟨1, 1 + x⟩.",
    "Find the\nimage of each of these elements of the domain.\n",
    "(a) 3 −2x;\n(b) 2 + 2x;\n(c) x\n2.13 For which n is the space isomorphic to Rn?\n(a) P4\n(b) P1\n(c) M2×3\n(d) the plane 2x −y + z = 0 subset of R3\n(e) the vector space of linear combinations of three letters {ax + by + cz | a, b, c ∈R}\n✓2.14 Show that if m ̸= n then Rm ̸∼= Rn.\n",
    "✓2.15 Is Mm×n ∼= Mn×m?\n✓2.16 Are any two planes through the origin in R3 isomorphic?\n2.17 Find a set of equivalence class representatives other than the set of Rn’s.\n\n",
    "190\nChapter Three.",
    "Maps Between Spaces\n2.18 True or false: between any n-dimensional space and",
    "Rn there is exactly one\nisomorphism.\n",
    "2.19 Can a vector space be isomorphic to one of its proper subspaces?\n",
    "✓2.20 This subsection shows that for any isomorphism, the inverse map is also an\nisomorphism.",
    "This subsection also shows that for a ﬁxed basis B of an n-dimensional\nvector space V, the map RepB : V →Rn is an isomorphism.",
    "Find the inverse of\nthis map.\n",
    "✓2.21 Prove these facts about matrices.\n",
    "(a) The row space of a matrix is isomorphic to the column space of its transpose.\n",
    "(b) The row space of a matrix is isomorphic to its column space.\n",
    "2.22 Show that the function from Theorem 2.3 is well-deﬁned.\n",
    "2.23 Is the proof of Theorem 2.3 valid when n = 0?\n2.24 For each, decide if it is a set of isomorphism class representatives.\n",
    "(a) {Ck | k ∈N}\n(b) {Pk | k ∈{−1, 0, 1, . . .}}\n(c) {Mm×n | m, n ∈N}\n2.25 Let f be a correspondence between vector spaces V and W (that is, a map that\nis one-to-one and onto).",
    "Show that the spaces V and W are isomorphic via f",
    "if and\nonly if there are bases B ⊂V and D ⊂W such that corresponding vectors have the\nsame coordinates: RepB(⃗v) = RepD(f(⃗v)).\n",
    "2.26 Consider the isomorphism RepB : P3 →R4.\n(a) Vectors in a real space are orthogonal if and only if their dot product is zero.\n",
    "Give a deﬁnition of orthogonality for polynomials.\n",
    "(b) The derivative of a member of P3 is in P3.",
    "Give a deﬁnition of the derivative\nof a vector in R4.\n",
    "✓2.27 Does every correspondence between bases, when extended to the spaces, give an\nisomorphism?",
    "That is, suppose that V is a vector space with basis B = ⟨⃗β1, . . .",
    ", ⃗βn⟩\nand that f: B →W is a correspondence such that D = ⟨f(⃗β1), . . .",
    ", f(⃗βn)⟩is basis\nfor W. Must ˆf: V →W sending⃗v = c1⃗β1+· · ·",
    "+cn⃗βn to ˆf(⃗v) = c1f(⃗β1)+· · ·+cnf(⃗βn)\nbe an isomorphism?\n2.28 (Requires the subsection on Combining Subspaces, which is optional.)",
    "Sup-\npose that V = V1 ⊕V2 and that V is isomorphic to the space U under the map f.\nShow that U = f(V1) ⊕f(V2).\n",
    "2.29 Show that this is not a well-deﬁned function from the rational numbers to the\nintegers: with each fraction, associate the value of its numerator.\n\nSection II.",
    "Homomorphisms\n191\nII\nHomomorphisms\nThe deﬁnition of isomorphism has two conditions.",
    "In this section we will consider\nthe second one.",
    "We will study maps that are required only to preserve structure,\nmaps that are not also required to be correspondences.\n",
    "Experience shows that these maps are tremendously useful.",
    "For one thing\nwe shall see in the second subsection below that while isomorphisms describe\nhow spaces are the same, we can think of these maps as describing how spaces\nare alike.\n",
    "II.1\nDeﬁnition\n1.1 Deﬁnition A function between vector spaces h: V →W that preserves addition\nif ⃗v1,⃗v2 ∈V then h(⃗v1 +⃗v2) = h(⃗v1)",
    "+ h(⃗v2)\nand scalar multiplication\nif ⃗v ∈V and r ∈R then h(r ·⃗v)",
    "= r · h(⃗v)\nis a homomorphism or linear map.\n",
    "1.2 Example The projection map π: R3 →R2\n\n\n\nx\ny\nz\n\n\n\nπ\n7−→\n \nx\ny\n!\nis a homomorphism.",
    "It preserves addition\nπ(\n\n\n\nx1\ny1\nz1\n\n\n+\n\n\n\nx2\ny2\nz2\n\n\n) = π(\n\n\n\nx1 + x2\ny1 + y2\nz1 + z2\n\n\n)",
    "=\n \nx1 + x2\ny1 + y2\n!\n",
    "= π(\n\n\n\nx1\ny1\nz1\n\n\n)",
    "+ π(\n\n\n\nx2\ny2\nz2\n\n\n)\nand scalar multiplication.\n",
    "π(r ·\n\n\n\nx1\ny1\nz1\n\n\n) = π(\n\n\n\nrx1\nry1\nrz1\n\n\n) =\n \nrx1\nry1\n!\n",
    "= r · π(\n\n\n\nx1\ny1\nz1\n\n\n)\n",
    "This is not an isomorphism since it is not one-to-one.",
    "For instance, both ⃗0 and\n⃗e3 in R3 map to the zero vector in R2.\n\n",
    "192\nChapter Three.",
    "Maps Between Spaces\n1.3 Example The domain and codomain can be other than spaces of column\nvectors.",
    "Both of these are homomorphisms; the veriﬁcations are straightforward.\n",
    "(1) f1 :",
    "P2 →P3 given by\na0 + a1x",
    "+ a2x2",
    "7→a0x + (a1/2)x2 + (a2/3)x3\n(2) f2 :",
    "M2×2 →R given by\n \na\nb\nc\nd\n!\n",
    "7→a",
    "+ d\n1.4 Example Between any two spaces there is a zero homomorphism, mapping\nevery vector in the domain to the zero vector in the codomain.\n",
    "We shall use the two terms ‘homomorphism’ and ‘linear map’ interchangably.\n",
    "1.5 Example These two suggest why we say ‘linear map’.\n",
    "(1) The map g: R3 →R given by\n\n\n\nx\ny\nz\n\n\n\ng\n7−→3x + 2y −4.5z\nis linear, that is, is a homomorphism.",
    "The check is easy.",
    "In contrast, the\nmap ˆg: R3 →R given by\n\n\n\nx\ny\nz\n\n\n\nˆg\n7−→3x + 2y −4.5z + 1\nis not linear.",
    "To show this we need only produce a single linear combination\nthat the map does not preserve.",
    "Here is one.\n",
    "ˆg(\n\n\n\n0\n0\n0\n\n\n+\n\n\n\n1\n0\n0\n\n\n) = 4\nˆg(\n\n\n\n0\n0\n0\n\n\n)",
    "+ ˆg(\n\n\n\n1\n0\n0\n\n\n)",
    "= 5\n(2) The ﬁrst of these two maps t1, t2 : R3 →R2 is linear while the second is\nnot.\n",
    "\n\n\nx\ny\nz\n\n\n\nt1\n7−→\n \n5x −2y\nx + y\n!\n\n\n\nx\ny\nz\n\n\n\nt2\n7−→\n \n5x −2y\nxy\n!\n",
    "Finding a linear combination that the second map does not preserve is\neasy.\n\n",
    "Section II.",
    "Homomorphisms\n193\nSo one way to think of ‘homomorphism’ is that we are generalizing ‘isomor-\nphism’ (by dropping the condition that the map is a correspondence), motivated\nby the observation that many of the properties of isomorphisms have only to\ndo with the map’s structure-preservation property.",
    "The next two results are\nexamples of this motivation.",
    "In the prior section we saw a proof for each that\nonly uses preservation of addition and preservation of scalar multiplication, and\ntherefore applies to homomorphisms.\n",
    "1.6 Lemma A linear map sends the zero vector to the zero vector.\n",
    "1.7 Lemma",
    "The following are equivalent for any map f: V →W between vector\nspaces.\n",
    "(1) f is a homomorphism\n(2) f(c1 ·",
    "⃗v1 + c2 ·⃗v2) =",
    "c1 · f(⃗v1)",
    "+ c2 · f(⃗v2) for any c1, c2 ∈R and ⃗v1,⃗v2 ∈V\n(3) f(c1 ·⃗v1 +· · ·+cn ·⃗vn) = c1 ·f(⃗v1)+· · ·+cn ·f(⃗vn) for any c1, . . . , cn ∈R\nand ⃗v1, . . .",
    ",⃗vn ∈V\n1.8 Example",
    "The function f: R2 →R4 given by\n \nx\ny\n!\n",
    "f\n7−→\n\n\n\n\n\nx/2\n0\nx + y\n3y\n\n\n\n\n\nis linear since it satisﬁes item (2).\n",
    "\n\n\n\n\nr1(x1/2) + r2(x2/2)\n0\nr1(x1 + y1) + r2(x2 + y2)\nr1(3y1) + r2(3y2)\n\n\n\n\n= r1\n\n\n\n\n\nx1/2\n0\nx1",
    "+ y1\n3y1\n\n\n\n\n+ r2\n\n\n\n\n\nx2/2\n0\n",
    "x2 + y2\n3y2\n\n\n\n\n\n",
    "However, some things that hold for isomorphisms fail to hold for homo-\nmorphisms.",
    "One example is in the proof of Lemma I.2.4, which shows that\nan isomorphism between spaces gives a correspondence between their bases.\n",
    "Homomorphisms do not give any such correspondence; Example 1.2 shows this\nand another example is the zero map between two nontrivial spaces.",
    "Instead,\nfor homomorphisms we have a weaker but still very useful result.\n",
    "1.9 Theorem A homomorphism is determined by its action on a basis: if V is a vec-\ntor space with basis ⟨⃗β1, . . .",
    ", ⃗βn⟩, if W is a vector space, and if ⃗w1, . . .",
    ", ⃗wn ∈W\n(these codomain elements need not be distinct) then there exists a homomor-\nphism from V to W sending each ⃗βi to ⃗wi, and that homomorphism is unique.\n\n",
    "194\nChapter Three.",
    "Maps Between Spaces\nProof For any input ⃗v ∈V let its expression with respect to the basis be\n⃗v = c1⃗β1+· · ·+cn⃗βn.",
    "Deﬁne the associated output by using the same coordinates\nh(⃗v) = c1⃗w1 + · · · + cn⃗wn.",
    "This is well deﬁned because, with respect to the\nbasis, the representation of each domain vector ⃗v is unique.\n",
    "This map is a homomorphism because it preserves linear combinations: where\n⃗v1 = c1⃗β1 + · · · + cn⃗βn and ⃗v2 = d1⃗β1 + · · · + dn⃗βn, here is the calculation.\n",
    "h(r1⃗v1 + r2⃗v2) = h( (r1c1 + r2d1)⃗β1 + · · · + (r1cn + r2dn)⃗βn )\n= (r1c1 + r2d1)⃗w1 + · · · + (r1cn + r2dn)⃗wn\n= r1h(⃗v1) + r2h(⃗v2)\n",
    "This map is unique because if ˆh: V →W is another homomorphism satisfying\nthat ˆh(⃗βi) = ⃗wi for each i then h and ˆh have the same eﬀect on all of the\nvectors in the domain.\nˆh(⃗v)",
    "= ˆh(c1⃗β1 + · · · + cn⃗βn) = c1ˆh(⃗β1)",
    "+ · · · + cnˆh(⃗βn)\n= c1⃗w1 + · · ·",
    "+ cn⃗wn = h(⃗v)\n",
    "They have the same action so they are the same function.\n",
    "QED\n1.10 Deﬁnition Let V and W be vector spaces and let B = ⟨⃗β1, . . .",
    ", ⃗βn⟩be a\nbasis for V. A function deﬁned on that basis f: B →W is extended linearly\nto a function ˆf: V →W if for all ⃗v ∈V such that ⃗v = c1⃗β1 + · · · + cn⃗βn, the\naction of the map is ˆf(⃗v)",
    "= c1 · f(⃗β1) + · · ·",
    "+ cn · f(⃗βn).\n",
    "1.11 Example If we specify a map h: R2 →R2 that acts on the standard basis\nE2 in this way\nh(\n \n1\n0\n!\n)",
    "=\n \n−1\n1\n!\nh(\n \n0\n1\n!\n)",
    "=\n \n−4\n4\n!\nthen we have also speciﬁed the action of h on any other member of the domain.\n",
    "For instance, the value of h on this argument\nh(\n \n3\n−2\n!\n) = h(3 ·\n \n1\n0\n!\n−2 ·\n \n0\n1\n!\n)",
    "= 3 · h(\n \n1\n0\n!\n) −2 · h(\n \n0\n1\n!\n)",
    "=\n \n5\n−5\n!\nis a direct consequence of the value of h on the basis vectors.\n",
    "Later in this chapter we shall develop a convenient scheme for computations\nlike this one, using matrices.\n\nSection II.",
    "Homomorphisms\n195\n1.12 Deﬁnition A linear map from a space into itself t: V →V is a linear trans-\nformation.\n",
    "1.13 Remark In this book we use ‘linear transformation’ only in the case where\nthe codomain equals the domain.",
    "Be aware that some sources instead use it as a\nsynonym for ‘linear map’.",
    "Still another synonym is ‘linear operator’.\n",
    "1.14 Example The map on R2 that projects all vectors down to the x-axis is a\nlinear transformation.\n \n",
    "x\ny\n!\n7→\n \nx\n0\n!\n",
    "1.15 Example The derivative map d/dx: Pn →Pn\na0 + a1x + · · · + anxn d/dx\n7−→a1 + 2a2x + 3a3x2 + · · · + nanxn−1\nis a linear transformation as this result from calculus shows: d(c1f + c2g)/dx =\nc1 (df/dx) + c2 (dg/dx).\n",
    "1.16 Example",
    "The matrix transpose operation\n \na\nb\nc\nd\n!\n",
    "7→\n \na\nc\nb\nd\n!\nis a linear transformation of M2×2.",
    "(Transpose is one-to-one and onto and so is\nin fact an automorphism.)\n",
    "We ﬁnish this subsection about maps by recalling that we can linearly combine\nmaps.",
    "For instance, for these maps from R2 to itself\n \nx\ny\n!\nf\n7−→\n \n2x\n3x −2y\n!\nand\n \nx\ny\n!\ng\n7−→\n \n0\n5x\n!\n",
    "the linear combination 5f −2g is also a transformation of R2.\n \n",
    "x\ny\n!\n5f−2g\n7−→\n \n10x\n5x −10y\n!\n",
    "1.17 Lemma For vector spaces V and W, the set of linear functions from V to\nW is itself a vector space, a subspace of the space of all functions from V to W.\n",
    "We denote the space of linear maps from V to W by L(V, W).\n",
    "Proof This set is non-empty because it contains the zero homomorphism.",
    "So\nto show that it is a subspace we need only check that it is closed under the\n\n196\nChapter Three.",
    "Maps Between Spaces\noperations.",
    "Let f, g: V →W be linear.",
    "Then the operation of function addition\nis preserved\n(f + g)(c1⃗v1 + c2⃗v2) = f(c1⃗v1 + c2⃗v2)",
    "+ g(c1⃗v1 + c2⃗v2)\n= c1f(⃗v1) + c2f(⃗v2) + c1g(⃗v1) +",
    "c2g(⃗v2)\n= c1\n\u0000f",
    "+ g\n\u0001\n(⃗v1) + c2\n\u0000f",
    "+ g\n\u0001\n(⃗v2)\nas is the operation of scalar multiplication of a function.\n",
    "(r · f)(c1⃗v1 + c2⃗v2) = r(c1f(⃗v1) + c2f(⃗v2))\n",
    "= c1(r · f)(⃗v1)",
    "+",
    "c2(r · f)(⃗v2)\n",
    "Hence L(V, W) is a subspace.\n",
    "QED\n",
    "We started this section by deﬁning ‘homomorphism’ as a generalization of\n‘isomorphism’, by isolating the structure preservation property.",
    "Some of the\npoints about isomorphisms carried over unchanged, while we adapted others.\n",
    "Note, however, that the idea of ‘homomorphism’ is in no way somehow\nsecondary to that of ‘isomorphism’.",
    "In the rest of this chapter we shall work\nmostly with homomorphisms.",
    "This is partly because any statement made about\nhomomorphisms is automatically true about isomorphisms but more because,\nwhile the isomorphism concept is more natural, our experience will show that\nthe homomorphism concept is more fruitful and more central to progress.\n",
    "Exercises\n✓1.18 Decide if each h: R3 →R2 is linear.\n",
    "(a) h(\n\n\nx\ny\nz\n\n)",
    "=\n\u0012\nx\nx + y + z\n\u0013\n(b) h(\n\n\nx\ny\nz\n\n) =\n\u00120\n0\n\u0013\n(c) h(\n\n\nx\ny\nz\n\n) =\n\u00121\n1\n\u0013\n(d) h(\n\n\nx\ny\nz\n\n) =\n\u0012 2x",
    "+ y\n3y −4z\n\u0013\n✓1.19 Decide if each map h: M2×2 →R is linear.\n",
    "(a) h(\n\u0012a\nb\nc\nd\n\u0013\n) = a + d\n(b) h(\n\u0012a\nb\nc\nd\n\u0013\n)",
    "= ad −bc\n(c) h(\n\u0012a\nb\nc\nd\n\u0013\n)",
    "= 2a +",
    "3b + c −d\n(d) h(\n\u0012a\nb\nc\nd\n\u0013\n)",
    "= a2 + b2\n✓1.20 Show that these are homomorphisms.",
    "Are they inverse to each other?\n(a) d/dx: P3 →P2 given by a0 +",
    "a1x",
    "+ a2x2",
    "+ a3x3 maps to a1 +",
    "2a2x",
    "+ 3a3x2\n(b)\nR\n:",
    "P2 →P3 given by b0 + b1x + b2x2 maps to b0x + (b1/2)x2 + (b2/3)x3\n\nSection II.",
    "Homomorphisms\n197\n1.21 Is (perpendicular) projection from R3 to the xz-plane a homomorphism?",
    "Pro-\njection to the yz-plane?",
    "To the x-axis?",
    "The y-axis?",
    "The z-axis?",
    "Projection to the\norigin?\n1.22 Verify that each map is a homomorphism.\n",
    "(a) h: P3 →R2 given by\nax2 + bx + c 7→\n\u0012a",
    "+ b\na",
    "+ c\n\u0013\n(b) f: R2 →R3 given by\n\u0012x\ny\n\u0013\n",
    "7→\n\n\n0\nx −y\n3y\n\n\n1.23 Show that, while the maps from Example 1.3 preserve linear operations, they\nare not isomorphisms.\n1.24 Is an identity map a linear transformation?\n",
    "✓1.25 Stating that a function is ‘linear’ is diﬀerent than stating that its graph is a\nline.\n",
    "(a) The function f1 : R →R given by f1(x) = 2x −1 has a graph that is a line.\n",
    "Show that it is not a linear function.\n",
    "(b) The function f2 :",
    "R2 →R given by\n\u0012x\ny\n\u0013\n",
    "7→x",
    "+ 2y\ndoes not have a graph that is a line.",
    "Show that it is a linear function.\n",
    "✓1.26 Part of the deﬁnition of a linear function is that it respects addition.",
    "Does a\nlinear function respect subtraction?\n1.27 Assume that h is a linear transformation of V and that ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis\nof V. Prove each statement.\n",
    "(a) If h(⃗βi) = ⃗0 for each basis vector then h is the zero map.\n",
    "(b) If h(⃗βi) = ⃗βi for each basis vector then h is the identity map.\n",
    "(c) If there is a scalar r such that h(⃗βi) = r·⃗βi for each basis vector then h(⃗v) = r·⃗v\nfor all vectors in V.\n1.28 Consider the vector space R+ where vector addition and scalar multiplication\nare not the ones inherited from R but rather are these: a + b is the product of\na and b, and r · a is the r-th power of a.",
    "(This was shown to be a vector space\nin an earlier exercise.)",
    "Verify that the natural logarithm map ln: R+ →R is a\nhomomorphism between these two spaces.",
    "Is it an isomorphism?\n",
    "1.29 Consider this transformation of the plane R2.\n",
    "\u0012x\ny\n\u0013\n7→\n\u0012x/2\ny/3\n\u0013\nFind the image under this map of this ellipse.\n",
    "{\n\u0012x\ny\n\u0013\n| (x2/4) + (y2/9) = 1}\n✓1.30 Imagine a rope wound around the earth’s equator so that it ﬁts snugly (suppose\nthat the earth is a sphere).",
    "How much extra rope must we add so that around the\nentire world the rope will now be six feet oﬀthe ground?\n\n198\nChapter Three.",
    "Maps Between Spaces\n✓1.31 Verify that this map h: R3 →R\n\n\nx\ny\nz\n\n7→\n\n\nx\ny\nz\n\n•\n\n\n3\n−1\n−1\n\n= 3x −y −z\nis linear.",
    "Generalize.\n",
    "1.32 Show that every homomorphism from R1 to R1 acts via multiplication by a\nscalar.",
    "Conclude that every nontrivial linear transformation of R1 is an isomorphism.\n",
    "Is that true for transformations of R2?",
    "Rn?\n1.33 Show that for any scalars a1,1, . . .",
    ", am,n this map h:",
    "Rn →Rm is a homomor-\nphism.\n",
    "\n\n\n\nx1\n...\nxn\n\n\n\n7→\n\n\n\n\na1,1x1 + · · · + a1,nxn\n...\nam,1x1 + · · · + am,nxn\n\n\n\n\n1.34 Consider the space of polynomials Pn.\n(a) Show that for each i, the i-th derivative operator di/dxi is a linear transfor-\nmation of that space.\n",
    "(b) Conclude that for any scalars ck, . . .",
    ", c0 this map is a linear transformation of\nthat space.\n",
    "f 7→ck\ndk\ndxk f + ck−1\ndk−1\ndxk−1 f + · · · + c1\nd\ndxf + c0f\n1.35 Lemma 1.17 shows that a sum of linear functions is linear and that a scalar\nmultiple of a linear function is linear.",
    "Show also that a composition of linear\nfunctions is linear.\n",
    "1.36 Where f: V →W is linear, suppose that f(⃗v1) = ⃗w1, . . .",
    ", f(⃗vn) = ⃗wn for some\nvectors ⃗w1, . . .",
    ", ⃗wn from W.\n(a) If the set of ⃗w ’s is independent, must the set of ⃗v ’s also be independent?\n(b) If the set of ⃗v ’s is independent, must the set of ⃗w ’s also be independent?\n",
    "(c) If the set of ⃗w ’s spans W, must the set of ⃗v ’s span V?\n(d)",
    "If the set of ⃗v ’s spans V, must the set of ⃗w ’s span W?\n1.37 Generalize Example 1.16 by proving that for every appropriate domain and\ncodomain the matrix transpose map is linear.",
    "What are the appropriate domains\nand codomains?\n1.38\n(a) Where ⃗u,⃗v ∈Rn, by deﬁnition the line segment connecting them is the set\nℓ= {t · ⃗u + (1 −t) ·⃗v | t ∈[0..1]}.",
    "Show that the image, under a homomorphism\nh, of the segment between ⃗u and ⃗v is the segment between h(⃗u) and h(⃗v).\n",
    "(b) A subset of Rn is convex if, for any two points in that set, the line segment\njoining them lies entirely in that set.",
    "(The inside of a sphere is convex while the\nskin of a sphere is not.)",
    "Prove that linear maps from Rn to Rm preserve the\nproperty of set convexity.\n",
    "✓1.39 Let h: Rn →Rm be a homomorphism.\n",
    "(a) Show that the image under h of a line in Rn is a (possibly degenerate) line in\nRm.\n",
    "(b) What happens to a k-dimensional linear surface?\n\nSection II.",
    "Homomorphisms\n199\n1.40 Prove that the restriction of a homomorphism to a subspace of its domain is\nanother homomorphism.\n",
    "1.41 Assume that h: V →W is linear.\n",
    "(a) Show that the range space of this map {h(⃗v) | ⃗v ∈V } is a subspace of the\ncodomain W.\n(b) Show that the null space of this map {⃗v ∈V | h(⃗v) = ⃗0W } is a subspace of the\ndomain V.\n(c) Show that if U is a subspace of the domain V then its image {h(⃗u) | ⃗u ∈U} is\na subspace of the codomain W. This generalizes the ﬁrst item.\n",
    "(d) Generalize the second item.\n",
    "1.42 Consider the set of isomorphisms from a vector space to itself.",
    "Is this a subspace\nof the space L(V, V) of homomorphisms from the space to itself?\n1.43 Does Theorem 1.9 need that ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis?",
    "That is, can we still get a\nwell-deﬁned and unique homomorphism if we drop either the condition that the\nset of ⃗β’s be linearly independent, or the condition that it span the domain?\n1.44 Let V be a vector space and assume that the maps f1, f2 : V →R1 are lin-\near.\n",
    "(a) Deﬁne a map F: V →R2 whose component functions are the given linear ones.\n",
    "⃗v 7→\n\u0012f1(⃗v)\nf2(⃗v)\n\u0013\nShow that F is linear.\n",
    "(b) Does the converse hold — is any linear map from V to R2 made up of two\nlinear component maps to R1?\n(c) Generalize.\nII.2\nRange Space and Null Space\nIsomorphisms and homomorphisms both preserve structure.",
    "The diﬀerence is\nthat homomorphisms have fewer restrictions, since they needn’t be onto and\nneedn’t be one-to-one.",
    "We will examine what can happen with homomorphisms\nthat cannot happen with isomorphisms.\n",
    "First consider the fact that homomorphisms need not be onto.",
    "Of course,\neach function is onto some set, namely its range.",
    "For example, the injection\nmap ι: R2 →R3\n \nx\ny\n!\n7→\n\n\n\nx\ny\n0\n\n\n\nis a homomorphism, and is not onto R3.",
    "But it is onto the xy-plane.\n\n",
    "200\nChapter Three.",
    "Maps Between Spaces\n2.1 Lemma Under a homomorphism, the image of any subspace of the domain is\na subspace of the codomain.",
    "In particular, the image of the entire space, the\nrange of the homomorphism, is a subspace of the codomain.\n",
    "Proof Let h: V →W be linear and let S be a subspace of the domain V.",
    "The\nimage h(S) is a subset of the codomain W, which is nonempty because S is\nnonempty.",
    "Thus, to show that h(S) is a subspace of W we need only show that\nit is closed under linear combinations of two vectors.",
    "If h(⃗s1) and h(⃗s2) are\nmembers of h(S) then c1·h(⃗s1)+c2·h(⃗s2) = h(c1·⃗s1)+h(c2·⃗s2)",
    "= h(c1·⃗s1+c2·⃗s2)\nis also a member of h(S) because it is the image of c1 ·⃗s1 + c2 ·⃗s2 from S. QED\n2.2 Deﬁnition The range space of a homomorphism h: V →W is\nR(h)",
    "= {h(⃗v) | ⃗v ∈V }\nsometimes denoted h(V).",
    "The dimension of the range space is the map’s rank.\n",
    "We shall soon see the connection between the rank of a map and the rank of a\nmatrix.\n",
    "2.3 Example For the derivative map d/dx: P3 →P3 given by a0 +",
    "a1x",
    "+ a2x2",
    "+\na3x3 7→a1 + 2a2x",
    "+ 3a3x2 the range space R(d/dx) is the set of quadratic\npolynomials {r + sx + tx2 | r, s, t ∈R}.",
    "Thus, this map’s rank is 3.\n2.4 Example With this homomorphism h: M2×2 →P3\n \na\nb\nc\nd\n!\n7→(a + b + 2d) + cx2 + cx3\nan image vector in the range can have any constant term, must have an x\ncoeﬃcient of zero, and must have the same coeﬃcient of x2 as of x3.",
    "That is,\nthe range space is R(h)",
    "= {r + sx2 + sx3 | r, s ∈R} and so the rank is 2.\n",
    "The prior result shows that, in passing from the deﬁnition of isomorphism to\nthe more general deﬁnition of homomorphism, omitting the onto requirement\ndoesn’t make an essential diﬀerence.",
    "Any homomorphism is onto some space,\nnamely its range.\n",
    "However, omitting the one-to-one condition does make a diﬀerence.\n",
    "A\nhomomorphism may have many elements of the domain that map to one element\nof the codomain.",
    "Below is a bean sketch of a many-to-one map between sets.∗It\nshows three elements of the codomain that are each the image of many members\nof the domain.",
    "(Rather than picture lots of individual 7→arrows, each association\nof many inputs with one output shows only one such arrow.)\n",
    "∗More",
    "information on many-to-one maps is in the appendix.\n\nSection II.",
    "Homomorphisms\n201\nRecall that for any function h: V →W, the set of elements of V that map to\n⃗w ∈W is the inverse image h−1(⃗w) = {⃗v ∈V | h(⃗v) = ⃗w}.",
    "Above, the left side\nshows three inverse image sets.\n",
    "2.5 Example Consider the projection π: R3 →R2\n\n\n\nx\ny\nz\n\n\n\nπ\n7−→\n \nx\ny\n!\nwhich is a homomorphism that is many-to-one.",
    "An inverse image set is a vertical\nline of vectors in the domain.\n",
    "R3\nR2\n⃗w\nOne example is this.\n",
    "π−1(\n \n1\n3\n!\n)",
    "= {\n\n\n\n1\n3\nz\n\n\n| z ∈R}\n2.6 Example This homomorphism h: R2 →R1\n \nx\ny\n!\n",
    "h\n7−→x + y\nis also many-to-one.",
    "For a ﬁxed w ∈R1 the inverse image h−1(w)\nR2\nR1\nw\nis the set of plane vectors whose components add to w.\n\n202\nChapter Three.",
    "Maps Between Spaces\nIn generalizing from isomorphisms to homomorphisms by dropping the one-\nto-one condition we lose the property that, intuitively, the domain is “the same”\nas the range.",
    "We lose, that is, that the domain corresponds perfectly to the range.\n",
    "The examples below illustrate that what we retain is that a homomorphism\ndescribes how the domain is “analogous to” or “like” the range.\n",
    "2.7 Example\nWe think of R3 as like R2 except that vectors have an extra\ncomponent.",
    "That is, we think of the vector with components x, y, and z as\nlike the vector with components x and y. Deﬁning the projection map π makes\nprecise which members of the domain we are thinking of as related to which\nmembers of the codomain.\n",
    "To understanding how the preservation conditions in the deﬁnition of homo-\nmorphism show that the domain elements are like the codomain elements, start\nby picturing R2 as the xy-plane inside of R3 (the xy plane inside of R3 is a set\nof three-tall vectors with a third component of zero and so does not precisely\nequal the set of two-tall vectors R2, but this embedding makes the picture much\nclearer).",
    "The preservation of addition property says that vectors in R3 act like\ntheir shadows in the plane.\n\n\nx1\ny1\nz1\n\nabove\n\u0012x1\ny1\n\u0013\nplus\n\n\nx2\ny2\nz2\n\nabove\n\u0012x2\ny2\n\u0013\nequals\n\n\nx1 + y1\ny1 + y2\nz1 + z2\n\nabove\n\u0012x1 + x2\ny1 + y2\n\u0013\nThinking of π(⃗v) as the “shadow” of ⃗v in the plane gives this restatement: the\nsum of the shadows π(⃗v1) + π(⃗v2) equals the shadow of the sum π(⃗v1 + ⃗v2).\n",
    "Preservation of scalar multiplication is similar.\n",
    "Drawing the codomain R2 on the right gives a picture that is uglier but is\nmore faithful to the bean sketch above.\n",
    "⃗w1\n⃗w2\n⃗w1 + ⃗w2\n",
    "Again, the domain vectors that map to ⃗w1 lie in a vertical line; one is drawn, in\ngray.",
    "Call any member of this inverse image π−1(⃗w1) a “ ⃗w1 vector.”",
    "Similarly,\nthere is a vertical line of “ ⃗w2 vectors” and a vertical line of “ ⃗w1 + ⃗w2 vectors.”\n\nSection II.",
    "Homomorphisms\n203\nNow, saying that π is a homomorphism is recognizing that if π(⃗v1) = ⃗w1\nand π(⃗v2)",
    "= ⃗w2",
    "then",
    "π(⃗v1 + ⃗v2) = π(⃗v1) + π(⃗v2) = ⃗w1",
    "+ ⃗w2.",
    "That is, the\nclasses add: any ⃗w1 vector plus any ⃗w2 vector equals a ⃗w1 + ⃗w2 vector.",
    "Scalar\nmultiplication is similar.\n",
    "So although R3 and R2 are not isomorphic π describes a way in which they\nare alike: vectors in R3 add as do the associated vectors in R2 — vectors add as\ntheir shadows add.\n",
    "2.8 Example A homomorphism can express an analogy between spaces that is\nmore subtle than the prior one.",
    "For the map from Example 2.6\n \nx\ny\n!\nh\n7−→x + y\nﬁx two numbers in the range w1, w2 ∈R.",
    "A ⃗v1 that maps to w1 has components\nthat add to w1, so the inverse image h−1(w1) is the set of vectors with endpoint\non the diagonal line x",
    "+ y = w1.",
    "Think of these as “w1 vectors.”",
    "Similarly we\nhave “w2 vectors” and “w1 + w2 vectors.”",
    "The addition preservation property\nsays this.\n",
    "⃗v1\n⃗v2\n⃗v1",
    "+⃗v2\na “w1 vector”\nplus\na “w2 vector”\nequals\na “w1 + w2 vector”\nRestated, if we add a w1 vector to a w2 vector then h maps the result to a\nw1 + w2 vector.",
    "Brieﬂy, the sum of the images is the image of the sum.",
    "Even\nmore brieﬂy, h(⃗v1)",
    "+ h(⃗v2)",
    "= h(⃗v1 +⃗v2).\n",
    "2.9 Example The inverse images can be structures other than lines.",
    "For the linear\nmap h: R3 →R2\n\n\n\nx\ny\nz\n\n\n7→\n \nx\nx\n!\n",
    "the inverse image sets are planes x = 0, x = 1, etc., perpendicular to the x-axis.\n\n",
    "204\nChapter Three.",
    "Maps Between Spaces\nWe won’t describe how every homomorphism that we will use is an analogy\nbecause the formal sense that we make of “alike in that . . .",
    "” is ‘a homomorphism\nexists such that . . . ’.",
    "Nonetheless, the idea that a homomorphism between two\nspaces expresses how the domain’s vectors fall into classes that act like the\nrange’s vectors is a good way to view homomorphisms.\n",
    "Another reason that we won’t treat all of the homomorphisms that we see as\nabove is that many vector spaces are hard to draw, e.g., a space of polynomials.\n",
    "But there is nothing wrong with leveraging spaces that we can draw: from the\nthree examples 2.7, 2.8, and 2.9 we draw two insights.\n",
    "The ﬁrst insight is that in all three examples the inverse image of the range’s\nzero vector is a line or plane through the origin.",
    "It is therefore a subspace of the\ndomain.\n",
    "2.10 Lemma For any homomorphism the inverse image of a subspace of the\nrange is a subspace of the domain.",
    "In particular, the inverse image of the trivial\nsubspace of the range is a subspace of the domain.\n",
    "(The examples above consider inverse images of single vectors but this result\nis about inverse images of sets h−1(S) = {⃗v ∈V | h(⃗v) ∈S}.",
    "We use the same\nterm for both by taking the inverse image of a single element h−1(⃗w) to be the\ninverse image of the one-element set h−1({ ⃗w}).)\n",
    "Proof Let h: V →W be a homomorphism and let S be a subspace of the range\nspace of h. Consider the inverse image of S.",
    "It is nonempty because it contains\n⃗0V, since h(⃗0V) = ⃗0W and ⃗0W is an element of S as S is a subspace.",
    "To ﬁnish we\nshow that h−1(S) is closed under linear combinations.",
    "Let ⃗v1 and ⃗v2 be two of\nits elements, so that h(⃗v1) and h(⃗v2) are elements of S. Then c1⃗v1 + c2⃗v2 is an\nelement of the inverse image h−1(S) because h(c1⃗v1 +c2⃗v2) = c1h(⃗v1)+c2h(⃗v2)\nis a member of S.\nQED\n2.11 Deﬁnition The null space or kernel of a linear map h: V →W is the inverse\nimage of ⃗0W.\nN (h) = h−1(⃗0W)",
    "= {⃗v ∈V | h(⃗v) = ⃗0W }\n",
    "The dimension of the null space is the map’s nullity.\n",
    "0V\n0W\n\nSection II.",
    "Homomorphisms\n205\n2.12 Example\nThe map from Example 2.3 has this null space N (d/dx) =\n{a0 + 0x + 0x2 + 0x3 | a0 ∈R} so its nullity is 1.\n2.13 Example",
    "The map from Example 2.4 has this null space, and nullity 2.\nN (h) = {\n \na\nb\n0\n−(a + b)/2\n!\n",
    "| a, b ∈R}\nNow for the second insight from the above examples.",
    "In Example 2.7 each of\nthe vertical lines squashes down to a single point — in passing from the domain to\nthe range, π takes all of these one-dimensional vertical lines and maps them to a\npoint, leaving the range smaller than the domain by one dimension.",
    "Similarly, in\nExample 2.8 the two-dimensional domain compresses to a one-dimensional range\nby breaking the domain into the diagonal lines and maps each of those to a single\nmember of the range.",
    "Finally, in Example 2.9 the domain breaks into planes\nwhich get squashed to a point and so the map starts with a three-dimensional\ndomain but ends two smaller, with a one-dimensional range.",
    "(The codomain\nis two-dimensional but the range is one-dimensional and the dimension of the\nrange is what matters.)\n",
    "2.14",
    "Theorem A linear map’s rank plus its nullity equals the dimension of its\ndomain.\n",
    "Proof Let h: V →W be linear and let BN = ⟨⃗β1, . . .",
    ", ⃗βk⟩be a basis for\nthe null space.",
    "Expand that to a basis BV = ⟨⃗β1, . . .",
    ", ⃗βk, ⃗βk+1, . . .",
    ", ⃗βn⟩for\nthe entire domain, using Corollary Two.III.2.12.",
    "We shall show that BR =\n⟨h(⃗βk+1), . . .",
    ", h(⃗βn)⟩is a basis for the range space.",
    "Then counting the size of\nthe bases gives the result.\n",
    "To see that BR is linearly independent, consider ⃗0W = ck+1h(⃗βk+1)",
    "+ · · · +\ncnh(⃗βn).",
    "We have ⃗0W = h(ck+1⃗βk+1+· · ·+cn⃗βn) and so ck+1⃗βk+1+· · ·+cn⃗βn\nis in the null space of h. As BN is a basis for the null space there are scalars\nc1, . . .",
    ", ck satisfying this relationship.\n",
    "c1⃗β1 + · · · + ck⃗βk = ck+1⃗βk+1 + · · · + cn⃗βn\n",
    "But this is an equation among members of BV, which is a basis for V, so each\nci equals 0.",
    "Therefore BR is linearly independent.\n",
    "To show that BR spans the range space consider a member of the range space\nh(⃗v).",
    "Express ⃗v as a linear combination ⃗v = c1⃗β1 + · · ·",
    "+ cn⃗βn of members\nof BV.",
    "This gives h(⃗v) =",
    "h(c1⃗β1 + · · · + cn⃗βn) = c1h(⃗β1)",
    "+ · · · + ckh(⃗βk)",
    "+\nck+1h(⃗βk+1)",
    "+ · · · + cnh(⃗βn)",
    "and since ⃗β1, . . .",
    ", ⃗βk are in the null space, we\nhave that h(⃗v) = ⃗0 + · · · + ⃗0 + ck+1h(⃗βk+1) + · · · + cnh(⃗βn).",
    "Thus, h(⃗v) is a\nlinear combination of members of BR, and so BR spans the range space.\n",
    "QED\n\n206\nChapter Three.",
    "Maps Between Spaces\n2.15 Example Where h: R3 →R4 is\n\n\n\nx\ny\nz\n\n\n\nh\n7−→\n",
    "\n\n\n\n\nx\n0\ny\n0\n\n\n\n\n\nthe range space and null space are\nR(h)",
    "= {\n\n\n\n\n\na\n0\nb\n0\n\n\n\n\n|",
    "a, b ∈R}\nand\nN (h) = {\n\n\n\n0\n0\nz\n\n\n| z ∈R}\nand so the rank of h is 2 while the nullity is 1.\n",
    "2.16 Example",
    "If t: R →R is the linear transformation x 7→−4x, then the range\nis R(t)",
    "= R. The rank is 1 and the nullity is 0.\n",
    "2.17 Corollary The rank of a linear map is less than or equal to the dimension of\nthe domain.",
    "Equality holds if and only if the nullity of the map is 0.\n",
    "We know that an isomorphism exists between two spaces if and only if the\ndimension of the range equals the dimension of the domain.",
    "We have now seen\nthat for a homomorphism to exist a necessary condition is that the dimension of\nthe range must be less than or equal to the dimension of the domain.",
    "For instance,\nthere is no homomorphism from R2 onto R3.",
    "There are many homomorphisms\nfrom R2 into R3, but none onto.\n",
    "The range space of a linear map can be of dimension strictly less than the\ndimension of the domain and so linearly independent sets in the domain may\nmap to linearly dependent sets in the range.",
    "(Example 2.3’s derivative transfor-\nmation on P3 has a domain of dimension 4 but a range of dimension 3 and the\nderivative sends {1, x, x2, x3 } to {0, 1, 2x, 3x2}).",
    "That is, under a homomorphism\nindependence may be lost.",
    "In contrast, dependence stays.\n",
    "2.18 Lemma Under a linear map, the image of a linearly dependent set is linearly\ndependent.\n",
    "Proof Suppose that c1⃗v1 + · · · + cn⃗vn = ⃗0V with some ci nonzero.",
    "Apply h to\nboth sides: h(c1⃗v1 + · · ·",
    "+ cn⃗vn) = c1h(⃗v1) + · · · + cnh(⃗vn) and h(⃗0V) = ⃗0W.\nThus we have c1h(⃗v1)",
    "+ · · · + cnh(⃗vn)",
    "= ⃗0W with some ci nonzero.\n",
    "QED\n",
    "When is independence not lost?",
    "The obvious suﬃcient condition is when\nthe homomorphism is an isomorphism.",
    "This condition is also necessary; see\n\nSection II.",
    "Homomorphisms\n207\nExercise 37.",
    "We will ﬁnish this subsection comparing homomorphisms with\nisomorphisms by observing that a one-to-one homomorphism is an isomorphism\nfrom its domain onto its range.\n",
    "2.19 Example This one-to-one homomorphism ι: R2 →R3\n \nx\ny\n!\nι\n7−→\n\n\n\nx\ny\n0\n\n\n\ngives a correspondence between R2 and the xy-plane subset of R3.\n",
    "2.20 Theorem Where V is an n-dimensional vector space, these are equivalent\nstatements about a linear map h: V →W.\n(1) h is one-to-one\n(2) h has an inverse from its range to its domain that is a linear map\n(3) N (h) = {⃗0 }, that is, nullity(h) = 0\n(4) rank(h) = n\n(5) if ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis for V then ⟨h(⃗β1), . . .",
    ", h(⃗βn)⟩is a basis for R(h)\n",
    "Proof We will ﬁrst show that (1) ⇐⇒(2).",
    "We will then show that (1) =⇒\n(3) =⇒(4) =⇒(5) =⇒(2).\n",
    "For (1) =⇒(2), suppose that the linear map h is one-to-one, and therefore\nhas an inverse h−1 : R(h)",
    "→V. The domain of that inverse is the range of h and\nthus a linear combination of two members of it has the form c1h(⃗v1)",
    "+ c2h(⃗v2).\n",
    "On that combination, the inverse h−1 gives this.\nh−1(c1h(⃗v1)",
    "+ c2h(⃗v2))",
    "= h−1(h(c1⃗v1 + c2⃗v2))\n= h−1 ◦h (c1⃗v1 + c2⃗v2)\n= c1⃗v1 + c2⃗v2\n= c1 · h−1(h(⃗v1))",
    "+",
    "c2 · h−1(h(⃗v2))\n",
    "Thus if a linear map has an inverse then the inverse must be linear.",
    "But this also\ngives the (2) =⇒(1) implication, because the inverse itself must be one-to-one.\n",
    "Of the remaining implications, (1) =⇒(3) holds because any homomorphism\nmaps ⃗0V to ⃗0W, but a one-to-one map sends at most one member of V to ⃗0W.\nNext, (3) =⇒(4) is true since rank plus nullity equals the dimension of the\ndomain.\n",
    "For (4) =⇒(5), to show that ⟨h(⃗β1), . .",
    ".",
    ", h(⃗βn)⟩is a basis for the range\nspace we need only show that it is a spanning set, because by assumption\nthe range has dimension n. Consider h(⃗v) ∈R(h).",
    "Expressing ⃗v as a linear\n\n208\nChapter Three.",
    "Maps Between Spaces\ncombination of basis elements produces h(⃗v)",
    "= h(c1⃗β1 + c2⃗β2 + · · · + cn⃗βn),\nwhich gives that h(⃗v) = c1h(⃗β1)",
    "+ · · ·",
    "+ cnh(⃗βn), as desired.\n",
    "Finally, for the (5) =⇒(2) implication, assume that ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis\nfor V so that ⟨h(⃗β1), . .",
    ".",
    ", h(⃗βn)⟩is a basis for R(h).",
    "Then every ⃗w ∈R(h) has\nthe unique representation ⃗w = c1h(⃗β1)",
    "+ · · · + cnh(⃗βn).",
    "Deﬁne a map from\nR(h) to V by\n⃗w 7→c1⃗β1 + c2⃗β2 + · · · + cn⃗βn\n(uniqueness of the representation makes this well-deﬁned).",
    "Checking that it is\nlinear and that it is the inverse of h are easy.\n",
    "QED\nWe have seen that a linear map expresses how the structure of the domain is\nlike that of the range.",
    "We can think of such a map as organizing the domain\nspace into inverse images of points in the range.",
    "In the special case that the map\nis one-to-one, each inverse image is a single point and the map is an isomorphism\nbetween the domain and the range.\n",
    "Exercises\n✓2.21 Let h: P3 →P4 be given by p(x)",
    "7→x · p(x).",
    "Which of these are in the null\nspace?",
    "Which are in the range space?\n(a) x3\n(b) 0\n(c) 7\n(d) 12x −0.5x3\n(e) 1 + 3x2 −x3\n2.22 Find the range space and the rank of each homomorphism.\n",
    "(a) h: P3 →R2 given by\nax2 + bx + c 7→\n\u0012a",
    "+ b\na",
    "+ c\n\u0013\n(b) f: R2 →R3 given by\n\u0012x\ny\n\u0013\n",
    "7→\n\n\n0\nx −y\n3y\n\n\n✓2.23 Find the range space and rank of each map.\n",
    "(a) h: R2 →P3 given by\n\u0012a\nb\n\u0013\n",
    "7→a + ax + ax2\n(b) h: M2×2 →R given by\n\u0012a\nb\nc\nd\n\u0013\n7→a",
    "+ d\n(c) h: M2×2 →P2 given by\n\u0012a\nb\nc\nd\n\u0013\n",
    "7→a + b + c",
    "+ dx2\n(d) the zero map Z: R3 →R4\n✓2.24 For each linear map in the prior exercise, ﬁnd the null space and nullity.\n",
    "✓2.25 Find the nullity of each map below.\n\n",
    "Section II.",
    "Homomorphisms\n209\n(a) h: R5 →R8 of rank ﬁve\n(b) h: P3 →P3 of rank one\n(c) h: R6 →R3, an onto map\n(d) h: M3×3 →M3×3, onto\n✓2.26 What is the null space of the diﬀerentiation transformation d/dx: Pn →Pn?\n",
    "What is the null space of the second derivative, as a transformation of Pn?",
    "The\nk-th derivative?\n2.27",
    "For the map h: R3 →R2 given by\n\n\nx\ny\nz\n\n7→\n\u0012x + y\nx + z\n\u0013\nﬁnd the range space, rank, null space, and nullity.\n",
    "2.28 Example 2.7 restates the ﬁrst condition in the deﬁnition of homomorphism as\n‘the shadow of a sum is the sum of the shadows’.",
    "Restate the second condition in\nthe same style.\n",
    "2.29 For the homomorphism h: P3 →P3 given by h(a0 +",
    "a1x",
    "+ a2x2",
    "+ a3x3) =\na0 + (a0 + a1)x + (a2 + a3)x3 ﬁnd these.\n",
    "(a) N (h)\n(b) h−1(2 −x3)\n(c) h−1(1 + x2)\n✓2.30 For the map f: R2 →R given by\nf(\n\u0012x\ny\n\u0013\n)",
    "= 2x + y\nsketch these inverse image sets: f−1(−3), f−1(0), and f−1(1).\n",
    "✓2.31 Each of these transformations of P3 is one-to-one.\n",
    "For each, ﬁnd the in-\nverse.\n(a) a0 + a1x",
    "+ a2x2",
    "+",
    "a3x3 7→a0 + a1x",
    "+ 2a2x2 + 3a3x3\n(b) a0",
    "+",
    "a1x",
    "+ a2x2",
    "+",
    "a3x3 7→a0 + a2x + a1x2",
    "+ a3x3\n(c) a0",
    "+",
    "a1x",
    "+ a2x2",
    "+ a3x3 7→a1 + a2x + a3x2",
    "+ a0x3\n(d) a0+a1x+a2x2+a3x3",
    "7→a0+(a0+a1)x+(a0+a1+a2)x2+(a0+a1+a2+a3)x3\n2.32 Describe the null space and range space of a transformation given by ⃗v 7→2⃗v.\n",
    "2.33 List all pairs (rank(h), nullity(h)) that are possible for linear maps from R5 to\nR3.\n2.34 Does the diﬀerentiation map d/dx: Pn →Pn have an inverse?\n",
    "✓2.35 Find the nullity of this map h:",
    "Pn →R.\na0 + a1x + · · ·",
    "+ anxn 7→\nZ x=1\nx=0\na0 + a1x + · · · + anxn dx\n2.36\n(a) Prove that a homomorphism is onto if and only if its rank equals the\ndimension of its codomain.\n",
    "(b) Conclude that a homomorphism between vector spaces with the same dimen-\nsion is one-to-one if and only if it is onto.\n",
    "2.37 Show that a linear map is one-to-one if and only if it preserves linear indepen-\ndence.\n",
    "2.38 Corollary 2.17 says that for there to be an onto homomorphism from a vector\nspace V to a vector space W, it is necessary that the dimension of W be less\nthan or equal to the dimension of V. Prove that this condition is also suﬃcient;\nuse Theorem 1.9 to show that if the dimension of W is less than or equal to the\ndimension of V, then there is a homomorphism from V to W that is onto.\n\n210\nChapter Three.",
    "Maps Between Spaces\n✓2.39 Recall that the null space is a subset of the domain and the range space is a\nsubset of the codomain.",
    "Are they necessarily distinct?",
    "Is there a homomorphism\nthat has a nontrivial intersection of its null space and its range space?\n2.40 Prove that the image of a span equals the span of the images.",
    "That is, where\nh: V →W is linear, prove that if S is a subset of V then h([S]) equals [h(S)].",
    "This\ngeneralizes Lemma 2.1 since it shows that if U is any subspace of V then its image\n{h(⃗u) | ⃗u ∈U} is a subspace of W, because the span of the set U is U.\n2.41\n(a) Prove that for any linear map h: V →W and any ⃗w ∈W, the set h−1(⃗w)\nhas the form\nh−1(⃗w) = {⃗v + ⃗n | ⃗v, ⃗n ∈V and ⃗n ∈N (h) and h(⃗v)",
    "= ⃗w}\n(if h is not onto and ⃗w is not in the range of h then this set is empty since its\nthird condition cannot be satisﬁed).",
    "Such a set is a coset of N (h) and we denote\nit as ⃗v + N (h).\n",
    "(b) Consider the map t: R2 →R2 given by\n\u0012x\ny\n\u0013\nt\n7−→\n\u0012ax",
    "+ by\ncx + dy\n\u0013\nfor some scalars a, b, c, and",
    "d. Prove that t is linear.\n",
    "(c) Conclude from the prior two items that for any linear system of the form\nax + by = e\ncx + dy = f\nwe can write the solution set (the vectors are members of R2)\n{⃗p + ⃗h | ⃗h satisﬁes the associated homogeneous system}\nwhere ⃗p is a particular solution of that linear system (if there is no particular\nsolution then the above set is empty).\n",
    "(d) Show that this map h:",
    "Rn →Rm is linear\n\n\n\n\nx1\n...\nxn\n\n\n\n7→\n\n\n\n\na1,1x1 + · · ·",
    "+ a1,nxn\n...\nam,1x1 + · · · + am,nxn\n\n\n\n\nfor any scalars a1,1, . .",
    ".",
    ", am,n. Extend the conclusion made in the prior item.\n",
    "(e) Show that the k-th derivative map is a linear transformation of Pn for each k.\n",
    "Prove that this map is a linear transformation of the space\nf 7→dk\ndxk f + ck−1\ndk−1\n",
    "dxk−1 f + · · · + c1\nd\ndxf + c0f\nfor any scalars ck, . .",
    ".",
    ", c0.",
    "Draw a conclusion as above.\n",
    "2.42 Prove that for any transformation t: V →V that is rank one, the map given by\ncomposing the operator with itself t ◦t: V →V satisﬁes t ◦t = r · t for some real\nnumber r.\n2.43 Let h: V →R be a homomorphism, but not the zero homomorphism.",
    "Prove\nthat if ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis for the null space and if ⃗v ∈V is not in the null space\nthen ⟨⃗v, ⃗β1, . .",
    ".",
    ", ⃗βn⟩is a basis for the entire domain V.\n2.44 Show that for any space V of dimension n, the dual space\nL(V, R) = {h: V →R | h is linear}\nis isomorphic to Rn.",
    "It is often denoted V∗. Conclude that V∗∼= V.\n\nSection II.",
    "Homomorphisms\n211\n2.45 Show that any linear map is the sum of maps of rank one.\n",
    "2.46 Is ‘is homomorphic to’ an equivalence relation?",
    "(Hint: the diﬃculty is to decide\non an appropriate meaning for the quoted phrase.)\n",
    "2.47 Show that the range spaces and null spaces of powers of linear maps t: V →V\nform descending\nV ⊇R(t) ⊇R(t2) ⊇. .",
    ".\n",
    "and ascending\n{⃗0} ⊆N (t) ⊆N (t2) ⊆. . .\nchains.",
    "Also show that if k is such that R(tk) = R(tk+1) then all following range\nspaces are equal: R(tk)",
    "= R(tk+1) = R(tk+2) . . . .",
    "Similarly, if N (tk) = N (tk+1)\nthen N (tk) = N (tk+1) = N (tk+2) = . . . .\n\n",
    "212\nChapter Three.",
    "Maps Between Spaces\nIII\nComputing Linear Maps\nThe prior section shows that a linear map is determined by its action on a basis.\n",
    "The equation\nh(⃗v) = h(c1 · ⃗β1 + · · · + cn · ⃗βn) = c1 · h(⃗β1)",
    "+ · · · + cn · h(⃗βn)\ndescribes how we get the value of the map on any vector ⃗v by starting from the\nvalue of the map on the vectors ⃗βi in a basis and extending linearly.\n",
    "This section gives a convenient scheme based on matrices to use the represen-\ntations of h(⃗β1), . .",
    ".",
    ", h(⃗βn) to compute, from the representation of a vector in\nthe domain RepB(⃗v), the representation of that vector’s image in the codomain\nRepD(h(⃗v)).\n",
    "III.1\nRepresenting Linear Maps with Matrices\n1.1 Example",
    "For the spaces R2 and R3 ﬁx these bases.\n",
    "B = ⟨\n \n2\n0\n!\n,\n \n1\n4\n!\n⟩\nD = ⟨\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n−2\n0\n\n\n,\n\n\n\n1\n0\n1\n\n\n⟩\nConsider the map h: R2 →R3 that is determined by this association.\n \n",
    "2\n0\n!\nh\n7−→\n\n\n\n1\n1\n1\n\n\n\n \n1\n4\n!\n",
    "h\n7−→\n\n\n\n1\n2\n0\n\n\n\nTo compute the action of this map on any vector at all from the domain we ﬁrst\nrepresent the vector h(⃗β1)\n\n\n\n1\n1\n1\n\n\n= 0\n\n\n\n1\n0\n0\n\n\n−1\n2\n\n\n\n0\n−2\n0\n\n\n+ 1\n\n\n\n1\n0\n1\n\n\n\nRepD(h(⃗β1))",
    "=\n\n\n\n0\n−1/2\n1\n\n\n\nD\nand h(⃗β2).\n",
    "\n\n\n1\n2\n0\n\n\n= 1\n\n\n\n1\n0\n0\n\n\n−1\n\n\n\n0\n−2\n0\n\n\n+ 0\n\n\n\n1\n0\n1\n\n\n\nRepD(h(⃗β2))",
    "=\n\n\n\n1\n−1\n0\n\n\n\nD\n\nSection III.",
    "Computing Linear Maps\n213\nWith these, for any member ⃗v of the domain we can compute h(⃗v).\n",
    "h(⃗v) = h(c1 ·\n \n2\n0\n!\n",
    "+ c2 ·\n \n1\n4\n!\n)\n= c1 · h(\n \n2\n0\n!\n)",
    "+ c2 · h(\n \n1\n4\n!\n)\n",
    "= c1 · (0\n\n\n\n1\n0\n0\n\n\n−1\n2\n\n\n\n0\n−2\n0\n\n\n+ 1\n\n\n\n1\n0\n1\n\n\n)",
    "+ c2 · (1\n\n\n\n1\n0\n0\n\n\n−1\n\n\n\n0\n−2\n0\n\n\n+ 0\n\n\n\n1\n0\n1\n\n\n)\n",
    "= (0c1 + 1c2) ·\n\n\n\n1\n0\n0\n\n\n+ (−1\n2c1 −1c2) ·\n\n\n\n0\n−2\n0\n\n\n+ (1c1 + 0c2) ·\n\n\n\n1\n0\n1\n\n\n\n",
    "Thus,\nif RepB(⃗v) =\n \nc1\nc2\n!\nthen RepD( h(⃗v) )",
    "=\n\n\n\n0c1 + 1c2\n−(1/2)c1 −1c2\n1c1 + 0c2\n\n\n.\nFor instance,\nsince RepB(\n \n4\n8\n!\n)",
    "=\n \n1\n2\n!\n",
    "B\nwe have RepD( h(\n \n4\n8\n!\n) )",
    "=\n\n\n\n2\n−5/2\n1\n\n\n.\n",
    "We express computations like the one above with a matrix notation.\n",
    "\n\n\n0\n1\n−1/2\n−1\n1\n0\n\n\n\nB,D\n \nc1\nc2\n!\nB\n=\n\n\n\n0c1 + 1c2\n(−1/2)c1 −1c2\n1c1 + 0c2\n\n\n\nD\nIn the middle is the argument ⃗v to the map, represented with respect to the\ndomain’s basis B by the column vector with components c1 and c2.",
    "On the\nright is the value of the map on that argument h(⃗v), represented with respect to\nthe codomain’s basis D.",
    "The matrix on the left is the new thing.",
    "We will use it\nto represent the map and we will think of the above equation as representing an\napplication of the map to the matrix.\n",
    "That matrix consists of the coeﬃcients from the vector on the right, 0 and\n1 from the ﬁrst row, −1/2 and −1 from the second row, and 1 and 0 from the\nthird row.",
    "That is, we make it by adjoining the vectors representing the h(⃗βi)’s.\n",
    "\n\n\n\n...\n...\nRepD( h(⃗β1) )\nRepD( h(⃗β2) )\n...\n...\n\n\n\n\n\n214\nChapter Three.",
    "Maps Between Spaces\n1.2 Deﬁnition Suppose that V and W are vector spaces of dimensions n and m\nwith bases B and D, and that h: V →W is a linear map.",
    "If\nRepD(h(⃗β1))",
    "=\n\n\n\n\n\n\nh1,1\nh2,1\n...\nhm,1\n\n\n\n\n\n\nD\n. . .\nRepD(h(⃗βn))",
    "=\n\n\n\n\n\n\nh1,n\nh2,n\n...\nhm,n\n\n\n\n\n\n\nD\nthen\nRepB,D(h) =\n\n\n\n\n\n\nh1,1\nh1,2\n. . .\n",
    "h1,n\nh2,1\nh2,2\n. . .\n",
    "h2,n\n...\nhm,1\nhm,2\n. .",
    ".\n",
    "hm,n\n\n\n\n\n\n\nB,D\nis the matrix representation of h with respect to B, D.\n",
    "In that matrix the number of columns n is the dimension of the map’s domain\nwhile the number of rows m is the dimension of the codomain.\n",
    "1.3 Remark As with the notation for represenation of a vector, the RepB,D\nnotation here is not standard.",
    "The most common alternative is [h]B,D.\nWe use lower case letters for a map, upper case for the matrix, and lower case\nagain for the entries of the matrix.",
    "Thus for the map h, the matrix representing\nit is H, with entries hi,j.\n1.4 Example",
    "If h: R3 →P1 is\n\n\n\na1\na2\na3\n\n\n\nh\n7−→(2a1 + a2)",
    "+",
    "(−a3)x\nthen where\nB = ⟨\n\n\n\n0\n0\n1\n\n\n,\n\n\n\n0\n2\n0\n\n\n,\n\n\n\n2\n0\n0\n\n\n⟩\nD = ⟨1 + x, −1 +",
    "x⟩\nthe action of h on B is this.\n\n\n\n0\n0\n1\n\n\n\nh\n7−→−x\n\n\n\n0\n2\n0\n\n\n\nh\n7−→2\n\n\n\n2\n0\n0\n\n\n\nh\n7−→4\n",
    "A simple calculation\nRepD(−x) =\n \n−1/2\n−1/2\n!\nD\nRepD(2) =\n \n1\n−1\n!\n",
    "D\nRepD(4)",
    "=\n \n2\n−2\n!\nD\n\nSection III.",
    "Computing Linear Maps\n215\nshows that this is the matrix representing h with respect to the bases.\n",
    "RepB,D(h) =\n \n−1/2\n1\n2\n−1/2\n−1\n−2\n!\n",
    "B,D\n1.5 Theorem Assume that V and W are vector spaces of dimensions n and m\nwith bases B and D, and that h: V →W is a linear map.",
    "If h is represented by\nRepB,D(h) =\n\n\n\n\n\n\nh1,1\nh1,2\n. . .\n",
    "h1,n\nh2,1\nh2,2\n. . .\n",
    "h2,n\n...\nhm,1\nhm,2\n. .",
    ".\n",
    "hm,n\n\n\n\n\n\n\nB,D\nand ⃗v ∈V is represented by\nRepB(⃗v) =\n\n\n\n\n\n\nc1\nc2\n...\n",
    "cn\n\n\n\n\n\n\nB\nthen the representation of the image of ⃗v is this.\n",
    "RepD( h(⃗v) )",
    "=\n\n\n\n\n\n\nh1,1c1 + h1,2c2 + · · · + h1,ncn\nh2,1c1 + h2,2c2 + · · · + h2,ncn\n...\nhm,1c1 + hm,2c2 + · · · + hm,ncn\n\n\n\n\n\n\nD\nProof This formalizes Example 1.1.",
    "See Exercise 33.\n",
    "QED\n1.6 Deﬁnition The matrix-vector product of a m×n matrix and a n×1 vector\nis this.\n\n\n\n\n\n\na1,1\na1,2\n. . .\n",
    "a1,n\na2,1\na2,2\n. . .\n",
    "a2,n\n...\nam,1\nam,2\n. .",
    ".\n",
    "am,n\n\n\n\n\n\n\n\n\n\nc1\n...\n",
    "cn\n\n\n=\n\n\n\n\n\n\na1,1c1 + · · · + a1,ncn\na2,1c1 + · · · + a2,ncn\n...\nam,1c1 + · · · + am,ncn\n\n\n\n\n\n\nBrieﬂy, application of a linear map is represented by the matrix-vector\nproduct of the map’s representative and the vector’s representative.\n1.7 Remark Theorem 1.5 is not surprising, because we chose the matrix repre-\nsentative in Deﬁnition 1.2 precisely to make the theorem true — if the theorem\n\n216\nChapter Three.",
    "Maps Between Spaces\nwere not true then we would adjust the deﬁnition to make it so.",
    "Nonetheless,\nwe need the veriﬁcation.\n",
    "1.8 Example For the matrix from Example 1.4 we can calculate where that map\nsends this vector.\n",
    "⃗v =\n\n\n\n4\n1\n0\n\n\n\nWith respect to the domain basis B the representation of this vector is\nRepB(⃗v) =\n\n\n\n0\n1/2\n2\n\n\n\nB\nand so the matrix-vector product gives the representation of the value h(⃗v) with\nrespect to the codomain basis D.\nRepD(h(⃗v))",
    "=\n \n−1/2\n1\n2\n−1/2\n−1\n−2\n!\n",
    "B,D\n\n\n\n0\n1/2\n2\n\n\n\nB\n=\n \n(−1/2) · 0",
    "+ 1 · (1/2) + 2 · 2\n(−1/2) · 0 −1 · (1/2) −2 · 2\n!\nD\n=\n \n9/2\n−9/2\n!\n",
    "D\nTo ﬁnd h(⃗v) itself, not its representation, take (9/2)(1 + x) −(9/2)(−1 + x) = 9.\n1.9 Example Let π: R3 →R2 be projection onto the xy-plane.",
    "To give a matrix\nrepresenting this map, we ﬁrst ﬁx some bases.\n",
    "B = ⟨\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n1\n1\n0\n\n\n,\n\n\n\n−1\n0\n1\n\n\n⟩\nD = ⟨\n \n2\n1\n!\n,\n \n1\n1\n!\n",
    "⟩\nFor each vector in the domain’s basis, ﬁnd its image under the map.\n\n\n\n1\n0\n0\n\n\n\nπ\n7−→\n \n1\n0\n!\n\n\n\n1\n1\n0\n\n\n\nπ\n7−→\n \n1\n1\n!\n\n\n\n−1\n0\n1\n\n\n\nπ\n7−→\n \n−1\n0\n!\n",
    "Then ﬁnd the representation of each image with respect to the codomain’s basis.\n",
    "RepD(\n \n1\n0\n!\n)",
    "=\n \n1\n−1\n!\nRepD(\n \n1\n1\n!\n)",
    "=\n \n0\n1\n!\nRepD(\n \n−1\n0\n!\n)",
    "=\n \n−1\n1\n!\n",
    "Finally, adjoining these representations gives the matrix representing π with\nrespect to B, D.\nRepB,D(π) =\n \n1\n0\n−1\n−1\n1\n1\n!\nB,D\n\nSection III.",
    "Computing Linear Maps\n217\n",
    "We can illustrate Theorem 1.5 by computing the matrix-vector product repre-\nsenting this action by the projection map.\n",
    "π(\n\n\n\n2\n2\n1\n\n\n)",
    "=\n \n2\n2\n!\n",
    "Represent the domain vector with respect to the domain’s basis\nRepB(\n\n\n\n2\n2\n1\n\n\n) =\n\n\n\n1\n2\n1\n\n\n\nB\nto get this matrix-vector product.\n",
    "RepD( π(\n\n\n\n2\n2\n1\n\n\n) )",
    "=\n \n1\n0\n−1\n−1\n1\n1\n!\nB,D\n\n\n\n1\n2\n1\n\n\n\nB\n=\n \n0\n2\n!\nD\nExpanding this into a linear combination of vectors from D\n0 ·\n \n2\n1\n!\n",
    "+ 2 ·\n \n1\n1\n!\n=\n \n2\n2\n!\nchecks that the map’s action is indeed reﬂected in the operation of the matrix.\n",
    "We will sometimes compress these three displayed equations into one.\n\n\n\n2\n2\n1\n\n\n=\n\n\n\n1\n2\n1\n\n\n\nB\nh\n7−→\nH\n \n0\n2\n!\n",
    "D\n=\n \n2\n2\n!\n",
    "We now have two ways to compute the eﬀect of projection, the straightforward\nformula that drops each three-tall vector’s third component to make a two-tall\nvector, and the above formula that uses representations and matrix-vector\nmultiplication.",
    "The second way may seem complicated compared to the ﬁrst,\nbut it has advantages.",
    "The next example shows that for some maps this new\nscheme simpliﬁes the formula.\n",
    "1.10 Example To represent a rotation map tθ : R2 →R2 that turns all vectors in\nthe plane counterclockwise through an angle θ\n⃗u\ntπ/6(⃗u)\ntπ/6\n−→\n\n218\nChapter Three.",
    "Maps Between Spaces\nwe start by ﬁxing the standard bases E2 for both the domain and codomain\nbasis, Now ﬁnd the image under the map of each vector in the domain’s basis.\n \n",
    "1\n0\n!\ntθ\n7−→\n \ncos θ\nsin θ\n!\n \n0\n1\n!\ntθ\n7−→\n \n−sin θ\ncos θ\n!\n",
    "(∗)\nRepresent these images with respect to the codomain’s basis.",
    "Because this basis\nis E2, vectors represent themselves.",
    "Adjoin the representations to get the matrix\nrepresenting the map.\nRepE2,E2(tθ) =\n \ncos θ\n−sin θ\nsin θ\ncos θ\n!\n",
    "The advantage of this scheme is that we get a formula for the image of any\nvector at all just by knowing in (∗) how to represent the image of the two basis\nvectors.",
    "For instance, here we rotate a vector by θ = π/6.\n \n",
    "3\n−2\n!\n=\n \n3\n−2\n!\nE2\ntπ/6\n7−→\n √\n3/2\n−1/2\n1/2\n√\n3/2\n!  \n",
    "3\n−2\n!\n",
    "≈\n \n3.598\n−0.232\n!\nE2\n=\n \n3.598\n−0.232\n!\n",
    "More generally, we have a formula for rotation by θ = π/6.\n \n",
    "x\ny\n!\ntπ/6\n7−→\n √\n3/2\n−1/2\n1/2\n√\n3/2\n!  \n",
    "x\ny\n!\n",
    "=\n \n(\n√\n3/2)x −(1/2)y\n(1/2)x + (\n√\n3/2)y\n!\n1.11 Example",
    "In the deﬁnition of matrix-vector product the width of the matrix\nequals the height of the vector.",
    "Hence, this product is not deﬁned.\n \n",
    "1\n0\n0\n4\n3\n1\n!  \n",
    "1\n0\n!\n",
    "It is undeﬁned for a reason: the three-wide matrix represents a map with a\nthree-dimensional domain while the two-tall vector represents a member of a\ntwo-dimensional space.",
    "So the vector cannot be in the domain of the map.\n",
    "Nothing in Deﬁnition 1.6 forces us to view matrix-vector product in terms\nof representations.",
    "We can get some insights by focusing on how the entries\ncombine.\n",
    "A good way to view matrix-vector product is that it is formed from the dot\nproducts of the rows of the matrix with the column vector.\n",
    "\n\n\n\n...\nai,1\nai,2\n. .",
    ".\n",
    "ai,n\n...\n\n\n\n\n\n\n\n\n\n\nc1\nc2\n...\ncn\n\n\n\n\n\n\n=\n\n\n\n\n...\nai,1c1",
    "+",
    "ai,2c2 + · · · + ai,ncn\n...\n\n\n\n\n\nSection III.",
    "Computing Linear Maps\n219\nLooked at in this row-by-row way, this new operation generalizes dot product.\n",
    "We can also view the operation column-by-column.\n",
    "\n\n\n\n\n\nh1,1\nh1,2\n. . .\n",
    "h1,n\nh2,1\nh2,2\n. . .\n",
    "h2,n\n...\nhm,1\nhm,2\n. .",
    ".\n",
    "hm,n\n\n\n\n\n\n\n\n\n\n\n\n\nc1\nc2\n...\ncn\n\n\n\n\n\n\n=\n\n\n\n\n\n\nh1,1c1 + h1,2c2 + · · · + h1,ncn\nh2,1c1 + h2,2c2 + · · · + h2,ncn\n...\nhm,1c1 + hm,2c2",
    "+ · · · + hm,ncn\n\n\n\n\n\n\n= c1\n\n\n\n\n\n\nh1,1\nh2,1\n...\n",
    "hm,1\n\n\n\n\n\n\n+ · · · + cn\n\n\n\n\n\n\nh1,n\nh2,n\n...\nhm,n\n\n\n\n\n\n\n",
    "The result is the columns of the matrix weighted by the entries of the vector.\n",
    "1.12 Example\n \n1\n0\n−1\n2\n0\n3\n!",
    "\n\n\n2\n−1\n1\n\n\n= 2\n \n1\n2\n!\n−1\n \n0\n0\n!\n",
    "+ 1\n \n−1\n3\n!\n=\n \n1\n7\n!\n",
    "This way of looking at matrix-vector product brings us back to the objective\nstated at the start of this section, to compute h(c1⃗β1 +· · ·+cn⃗βn) as c1h(⃗β1)+\n· · · + cnh(⃗βn).\n",
    "We began this section by noting that the equality of these two enables us\nto compute the action of h on any argument knowing only h(⃗β1), . . .",
    ", h(⃗βn).\n",
    "We have developed this into a scheme to compute the action of the map by\ntaking the matrix-vector product of the matrix representing the map with the\nvector representing the argument.",
    "In this way, with respect to any bases, for any\nlinear map there is a matrix representation.",
    "The next subsection will show the\nconverse, that if we ﬁx bases then for any matrix there is an associated linear\nmap.\n",
    "Exercises\n✓1.13 Multiply the matrix\n\n\n1\n3\n1\n0\n−1\n2\n1\n1\n0\n\n\nby each vector, or state “not deﬁned.”\n(a)\n\n\n2\n1\n0\n\n\n(b)\n\u0012−2\n−2\n\u0013\n(c)\n\n\n0\n0\n0\n\n\n1.14 Multiply this matrix by each vector or state “not deﬁned.”\n",
    "\u00123\n1\n2\n4\n\u0013\n\n220\nChapter Three.",
    "Maps Between Spaces\n(a)\n\n\n1\n2\n1\n\n\n(b)\n\u0012 0\n−1\n\u0013\n(c)\n\n\n0\n0\n0\n\n\n1.15 Perform, if possible, each matrix-vector multiplication.\n",
    "(a)\n\u00122\n1\n3\n−1/2\n\u0013 \u00124\n2\n\u0013\n(b)\n\u0012 1\n1\n0\n−2\n1\n0\n\u0013 \n\n1\n3\n1\n\n\n(c)\n",
    "\u0012 1\n1\n−2\n1\n\u0013 \n\n1\n3\n1\n\n\n1.16",
    "This matrix equation expresses a linear system.",
    "Solve it.\n",
    "\n\n2\n1\n1\n0\n1\n3\n1\n−1\n2\n\n\n\n\nx\ny\nz\n\n=\n\n\n8\n4\n4\n\n\n✓1.17 For a homomorphism from P2 to P3 that sends\n1 7→1 + x,\nx 7→1 + 2x,\nand\nx2 7→x −x3\nwhere does 1 −3x + 2x2 go?\n1.18 Let h: R2 →M2×2 be the linear transformation with this action.\n",
    "\u00121\n0\n\u0013\n7→\n\u00121\n2\n0\n1\n\u0013\n\u00120\n1\n\u0013\n7→\n\u00120\n−1\n1\n0\n\u0013\n",
    "What is its eﬀect on the general vector with entries x and y?\n✓1.19 Assume that h: R2 →R3 is determined by this action.\n",
    "\u00121\n0\n\u0013\n7→\n\n\n2\n2\n0\n\n\n\u00120\n1\n\u0013\n7→\n\n\n0\n1\n−1\n\n\nUsing the standard bases, ﬁnd\n(a) the matrix representing this map;\n(b) a general formula for h(⃗v).\n",
    "1.20 Represent the homomorphism h: R3 →R2 given by this formula and with\nrespect to these bases.\n",
    "\n\nx\ny\nz\n\n7→\n\u0012x",
    "+ y\nx + z\n\u0013\nB = ⟨\n\n\n1\n1\n1\n\n,\n\n\n1\n1\n0\n\n,\n\n\n1\n0\n0\n\n⟩\nD = ⟨\n\u00121\n0\n\u0013\n,\n\u00120\n2\n\u0013\n⟩\n✓1.21 Let d/dx: P3 →P3 be the derivative transformation.\n",
    "(a) Represent d/dx with respect to B, B where B = ⟨1, x, x2, x3⟩.\n(b) Represent d/dx with respect to B, D where D = ⟨1, 2x, 3x2, 4x3⟩.\n✓1.22 Represent each linear map with respect to each pair of bases.\n(a) d/dx: Pn →Pn with respect to B, B where B = ⟨1, x, . . .",
    ", xn⟩, given by\na0 +",
    "a1x",
    "+ a2x2",
    "+ · · ·",
    "+ anxn 7→a1 + 2a2x + · · · + nanxn−1\n(b)\nR\n: Pn →Pn+1 with respect to Bn, Bn+1 where Bi = ⟨1, x, . . .",
    ", xi⟩, given by\na0 +",
    "a1x",
    "+ a2x2",
    "+ · · ·",
    "+ anxn 7→a0x + a1\n2 x2 + · · · +\nan\nn + 1xn+1\n(c)\nR1\n0 :",
    "Pn →R with respect to B, E1 where B = ⟨1, x, . . .",
    ", xn⟩and E1 = ⟨1⟩, given\nby\na0 +",
    "a1x",
    "+ a2x2",
    "+ · · ·",
    "+ anxn 7→a0 + a1\n2 + · · · +\nan\nn + 1\n\nSection III.",
    "Computing Linear Maps\n221\n(d) eval3 :",
    "Pn →R with respect to B, E1 where B = ⟨1, x, . . .",
    ", xn⟩and E1 = ⟨1⟩,\ngiven by\na0 +",
    "a1x",
    "+ a2x2",
    "+ · · ·",
    "+ anxn 7→a0 + a1 · 3 + a2 · 32 + · · · + an · 3n\n(e) slide−1 :",
    "Pn →Pn with respect to B, B where B = ⟨1, x, . . .",
    ", xn⟩, given by\na0 +",
    "a1x",
    "+ a2x2",
    "+ · · ·",
    "+ anxn 7→a0 + a1 · (x + 1) + · · · +",
    "an · (x + 1)n\n1.23 Represent the identity map on any nontrivial space with respect to B, B, where\nB is any basis.\n",
    "1.24 Represent, with respect to the natural basis, the transpose transformation on\nthe space M2×2 of 2×2 matrices.\n",
    "1.25 Assume that B = ⟨⃗β1, ⃗β2, ⃗β3, ⃗β4⟩is a basis for a vector space.",
    "Represent with\nrespect to B, B the transformation that is determined by each.\n",
    "(a) ⃗β1 7→⃗β2, ⃗β2 7→⃗β3, ⃗β3 7→⃗β4, ⃗β4 7→⃗0\n(b) ⃗β1 7→⃗β2, ⃗β2 7→⃗0, ⃗β3 7→⃗β4, ⃗β4 7→⃗0\n(c) ⃗β1 7→⃗β2, ⃗β2 7→⃗β3, ⃗β3 7→⃗0, ⃗β4 7→⃗0\n1.26 Example 1.10 shows how to represent the rotation transformation of the plane\nwith respect to the standard basis.",
    "Express these other transformations also with\nrespect to the standard basis.\n",
    "(a) the dilation map ds, which multiplies all vectors by the same scalar s\n(b) the reﬂection map fℓ, which reﬂects all all vectors across a line ℓthrough the\norigin\n✓1.27 Consider a linear transformation of R2 determined by these two.\n",
    "\u00121\n1\n\u0013\n7→\n\u00122\n0\n\u0013\n\u00121\n0\n\u0013\n7→\n\u0012−1\n0\n\u0013\n(a) Represent this transformation with respect to the standard bases.\n",
    "(b) Where does the transformation send this vector?\n\u00120\n5\n\u0013\n(c) Represent this transformation with respect to these bases.\n",
    "B = ⟨\n\u0012 1\n−1\n\u0013\n,\n\u00121\n1\n\u0013\n⟩\nD = ⟨\n\u00122\n2\n\u0013\n,\n\u0012−1\n1\n\u0013\n⟩\n(d)",
    "Using B from the prior item, represent the transformation with respect to\nB, B.\n1.28 Suppose that h: V →W is one-to-one",
    "so that by Theorem 2.20, for any basis\nB = ⟨⃗β1, . . . , ⃗βn⟩⊂V the image h(B)",
    "= ⟨h(⃗β1), . . .",
    ", h(⃗βn)⟩is a basis for h(V).",
    "(If\nh is onto then h(V) = W.)\n(a)",
    "Represent the map h with respect to ⟨B, h(B)⟩.\n(b) For a member ⃗v of the domain, where the representation of ⃗v has components\nc1, . .",
    ".",
    ", cn, represent the image vector h(⃗v) with respect to the image basis h(B).\n",
    "1.29 Give a formula for the product of a matrix and ⃗ei, the column vector that is\nall zeroes except for a single one in the i-th position.\n",
    "✓1.30 For each vector space of functions of one real variable, represent the derivative\ntransformation with respect to B, B.\n(a) {a cos x + b sin x | a, b ∈R}, B = ⟨cos x, sin x⟩\n\n222\nChapter Three.",
    "Maps Between Spaces\n(b) {aex + be2x | a, b ∈R}, B = ⟨ex, e2x⟩\n(c) {a + bx + cex + dxex | a, b, c, d ∈R}, B = ⟨1, x, ex, xex⟩\n1.31 Find the range of the linear transformation of R2 represented with respect to\nthe standard bases by each matrix.\n",
    "(a)\n\u00121\n0\n0\n0\n\u0013\n(b)\n\u00120\n0\n3\n2\n\u0013\n(c) a matrix of the form\n\u0012 a\nb\n2a\n",
    "2b\n\u0013\n✓1.32 Can one matrix represent two diﬀerent linear maps?",
    "That is, can RepB,D(h) =\nRepˆB, ˆD(ˆh)?\n",
    "1.33 Prove Theorem 1.5.\n",
    "✓1.34 Example 1.10 shows how to represent rotation of all vectors in the plane through\nan angle θ about the origin, with respect to the standard bases.\n",
    "(a) Rotation of all vectors in three-space through an angle θ about the x-axis is a\ntransformation of R3.",
    "Represent it with respect to the standard bases.",
    "Arrange\nthe rotation so that to someone whose feet are at the origin and whose head is\nat (1, 0, 0), the movement appears clockwise.\n",
    "(b) Repeat the prior item, only rotate about the y-axis instead.",
    "(Put the person’s\nhead at ⃗e2.)\n",
    "(c) Repeat, about the z-axis.\n",
    "(d) Extend the prior item to R4.",
    "(Hint: we can restate ‘rotate about the z-axis’\nas ‘rotate parallel to the xy-plane’.)\n",
    "1.35 (Schur’s Triangularization Lemma)\n(a) Let U be a subspace of V and ﬁx bases BU ⊆BV.",
    "What is the relationship\nbetween the representation of a vector from U with respect to BU and the\nrepresentation of that vector (viewed as a member of V) with respect to BV?\n(b) What about maps?\n(c) Fix a basis B = ⟨⃗β1, . . .",
    ", ⃗βn⟩for V and observe that the spans\n[∅] = {⃗0} ⊂[{⃗β1 }] ⊂[{⃗β1, ⃗β2 }] ⊂\n· · ·\n⊂[B] = V\nform a strictly increasing chain of subspaces.",
    "Show that for any linear map\nh: V →W there is a chain W0 = {⃗0} ⊆W1 ⊆· · · ⊆Wm = W of subspaces of W\nsuch that\nh([{⃗β1, . . .",
    ", ⃗βi }]) ⊆Wi\nfor each i.\n(d) Conclude that for every linear map h: V →W there are bases B, D",
    "so the\nmatrix representing h with respect to B, D is upper-triangular (that is, each\nentry hi,j with i >",
    "j is zero).\n",
    "(e) Is an upper-triangular representation unique?\n\nSection III.",
    "Computing Linear Maps\n223\nIII.2\nAny Matrix Represents a Linear Map\nThe prior subsection shows that the action of a linear map h is described by a\nmatrix H, with respect to appropriate bases, in this way.\n",
    "⃗v =\n\n\n\nv1\n...\n",
    "vn\n\n\n\nB\nh\n7−→\nH\nh(⃗v) =\n\n\n\nh1,1v1 + · · · + h1,nvn\n...\nhm,1v1 + · · ·",
    "+ hm,nvn\n\n\n\nD\n(∗)\n",
    "Here we will show the converse, that each matrix represents a linear map.\n",
    "So we start with a matrix\nH =\n\n\n\n\n\n\nh1,1\nh1,2\n. . .\n",
    "h1,n\nh2,1\nh2,2\n. . .\n",
    "h2,n\n...\nhm,1\nhm,2\n. .",
    ".\n",
    "hm,n\n\n\n\n\n\n\nand we will describe how it deﬁnes a map",
    "h. We require that the map be\nrepresented by the matrix so ﬁrst note that in (∗) the dimension of the map’s\ndomain is the number of columns n of the matrix and the dimension of the\ncodomain is the number of rows",
    "m.",
    "Thus, for h’s domain ﬁx an n-dimensional\nvector space V and for the codomain ﬁx an m-dimensional space W. Also ﬁx\nbases B = ⟨⃗β1, . . .",
    ", ⃗βn⟩and D = ⟨⃗δ1, . . .",
    ",⃗δm⟩for those spaces.\n",
    "Now let h: V →W be: where ⃗v in the domain has the representation\nRepB(⃗v) =\n\n\n\nv1\n...\nvn\n\n\n\nB\nthen its image h(⃗v) is the member of the codomain with this representation.\n",
    "RepD( h(⃗v) )",
    "=\n\n\n\nh1,1v1 + · · · + h1,nvn\n...\nhm,1v1 + · · · + hm,nvn\n\n\n\nD\nThat is, to compute the action of h on any ⃗v ∈V, ﬁrst express ⃗v with respect to\nthe basis ⃗v = v1⃗β1 + · · · + vn⃗βn and then h(⃗v) = (h1,1v1 + · · · + h1,nvn) ·⃗δ1",
    "+\n· · · + (hm,1v1 + · · ·",
    "+ hm,nvn) ·⃗δm.\n",
    "Above we have made some choices; for instance V can be any n-dimensional\nspace and B could be any basis for V, so H does not deﬁne a unique function.\n",
    "However, note once we have ﬁxed V, B, W, and D then h is well-deﬁned since ⃗v\nhas a unique representation with respect to the basis B and the calculation of ⃗w\nfrom its representation is also uniquely determined.\n\n224\nChapter Three.",
    "Maps Between Spaces\n2.1 Example Consider this matrix.\n",
    "H =\n\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n",
    "It is 3×2 so any map that it deﬁnes must carry a dimension 2 domain to a\ndimension 3 codomain.",
    "We can choose the domain and codomain to be R2 and\nP2, with these bases.\n",
    "B = ⟨\n \n1\n1\n!\n,\n \n1\n−1\n!\n",
    "⟩\nD = ⟨x2, x2 + x, x2 + x + 1⟩\nThen let h: R2 →P2 be the function deﬁned by H.",
    "We will compute the image\nunder h of this member of the domain.\n",
    "⃗v =\n \n−3\n2\n!\n",
    "The computation is straightforward.\n",
    "RepD(h(⃗v))",
    "= H · RepB(⃗v) =\n\n\n\n1\n2\n3\n4\n5\n6\n\n\n\n \n−1/2\n−5/2\n!\n=\n\n\n\n−11/2\n−23/2\n−35/2\n\n\n\nFrom its representation, computation of h(⃗v) is routine (−11/2)(x2)−(23/2)(x2+\nx) −(35/2)(x2",
    "+ x",
    "+ 1) = (−69/2)x2 −(58/2)x −(35/2).\n",
    "2.2 Theorem Any matrix represents a homomorphism between vector spaces of\nappropriate dimensions, with respect to any pair of bases.\n",
    "Proof We must check that for any matrix H and any domain and codomain\nbases B, D, the deﬁned map h is linear.",
    "If ⃗v, ⃗u ∈V are such that\nRepB(⃗v) =\n\n\n\nv1\n...\nvn\n\n\n\nRepB(⃗u) =\n\n\n\nu1\n...\nun\n\n\n\nand c, d ∈R then the calculation\nh(c⃗v + d⃗u) =\n\u0000h1,1(cv1 + du1) + · · · + h1,n(cvn + dun)\n\u0001\n·⃗δ1+\n· · · +\n\u0000hm,1(cv1 + du1) + · · · + hm,n(cvn + dun)\n\u0001\n·⃗δm\n= c · h(⃗v)",
    "+ d · h(⃗u)\nsupplies that check.\n",
    "QED\n\nSection III.",
    "Computing Linear Maps\n225\n2.3 Example Even if the domain and codomain are the same, the map that the\nmatrix represents depends on the bases that we choose.",
    "If\nH =\n \n1\n0\n0\n0\n!\n,\nB1 = D1 = ⟨\n \n1\n0\n!\n,\n \n0\n1\n!\n",
    "⟩,\nand\nB2 = D2 = ⟨\n \n0\n1\n!\n,\n \n1\n0\n!\n",
    "⟩,\nthen h1 : R2 →R2 represented by H with respect to B1, D1 maps\n \nc1\nc2\n!\n=\n \nc1\nc2\n!\nB1\n7→\n \nc1\n0\n!\nD1\n=\n \nc1\n0\n!\nwhile h2 : R2 →R2 represented by H with respect to B2, D2 is this map.\n \n",
    "c1\nc2\n!\n=\n \nc2\nc1\n!\nB2\n7→\n \nc2\n0\n!\n",
    "D2\n=\n \n0\nc2\n!\n",
    "These are diﬀerent functions.",
    "The ﬁrst is projection onto the x-axis while the\nsecond is projection onto the y-axis.\n",
    "This result means that when convenient we can work solely with matrices,\njust doing the computations without having to worry whether a matrix of interest\nrepresents a linear map on some pair of spaces.\n",
    "When we are working with a matrix but we do not have particular spaces or\nbases in mind then we can take the domain and codomain to be Rn and Rm,\nwith the standard bases.",
    "This is convenient because with the standard bases\nvector representation is transparent — the representation of ⃗v is ⃗v.",
    "(In this case\nthe column space of the matrix equals the range of the map and consequently\nthe column space of H is often denoted by R(H).)\n",
    "Given a matrix, to come up with an associated map we can choose among\nmany domain and codomain spaces, and many bases for those.",
    "So a matrix can\nrepresent many maps.",
    "We ﬁnish this section by illustrating how the matrix can\ngive us information about the associated maps.\n",
    "2.4 Theorem The rank of a matrix equals the rank of any map that it represents.\n",
    "Proof Suppose that the matrix H is m×n.",
    "Fix domain and codomain spaces\nV and W of dimension n and m with bases B = ⟨⃗β1, . .",
    ".",
    ", ⃗βn⟩and D. Then H\nrepresents some linear map h between those spaces with respect to these bases\nwhose range space\n{h(⃗v) | ⃗v ∈V } = {h(c1⃗β1 + · · · + cn⃗βn) | c1, . . .",
    ", cn ∈R}\n= {c1h(⃗β1) + · · · + cnh(⃗βn) | c1, . . .",
    ", cn ∈R}\n\n226\nChapter Three.",
    "Maps Between Spaces\nis the span [{h(⃗β1), . . .",
    ", h(⃗βn)}].",
    "The rank of the map h is the dimension of this\nrange space.\n",
    "The rank of the matrix is the dimension of its column space, the span of the\nset of its columns [ {RepD(h(⃗β1)), . . . , RepD(h(⃗βn))}",
    "].\n",
    "To see that the two spans have the same dimension, recall from the proof\nof Lemma I.2.5 that if we ﬁx a basis then representation with respect to that\nbasis gives an isomorphism RepD : W →Rm.",
    "Under this isomorphism there is a\nlinear relationship among members of the range space if and only if the same\nrelationship holds in the column space, e.g, ⃗0 = c1 · h(⃗β1) + · · · + cn · h(⃗βn) if\nand only if ⃗0 = c1 · RepD(h(⃗β1))",
    "+ · · · + cn · RepD(h(⃗βn)).",
    "Hence, a subset of\nthe range space is linearly independent if and only if the corresponding subset\nof the column space is linearly independent.",
    "Therefore the size of the largest\nlinearly independent subset of the range space equals the size of the largest\nlinearly independent subset of the column space, and so the two spaces have the\nsame dimension.\n",
    "QED\nThat settles the apparent ambiguity in our use of the same word ‘rank’ to\napply both to matrices and to maps.\n",
    "2.5 Example Any map represented by\n\n\n\n\n\n1\n2\n2\n1\n2\n1\n0\n0\n3\n0\n0\n2\n\n\n\n\n\nmust have three-dimensional domain and a four-dimensional codomain.",
    "In\naddition, because the rank of this matrix is two (we can spot this by eye or get it\nwith Gauss’s Method), any map represented by this matrix has a two-dimensional\nrange space.\n",
    "2.6 Corollary Let h be a linear map represented by a matrix H. Then h is onto\nif and only if the rank of H equals the number of its rows, and h is one-to-one if\nand only if the rank of H equals the number of its columns.\n",
    "Proof For the onto half, the dimension of the range space of h is the rank\nof h, which equals the rank of H by the theorem.",
    "Since the dimension of the\ncodomain of h equals the number of rows in H, if the rank of H equals the\nnumber of rows then the dimension of the range space equals the dimension\nof the codomain.",
    "But a subspace with the same dimension as its superspace\nmust equal that superspace (because any basis for the range space is a linearly\nindependent subset of the codomain whose size is equal to the dimension of the\n\nSection III.",
    "Computing Linear Maps\n227\ncodomain, and thus this basis for the range space must also be a basis for the\ncodomain).\n",
    "For the other half, a linear map is one-to-one if and only if it is an isomorphism\nbetween its domain and its range, that is, if and only if its domain has the same\ndimension as its range.",
    "The number of columns in H is the dimension of h’s\ndomain and by the theorem the rank of H equals the dimension of h’s range.\n",
    "QED\n2.7 Deﬁnition A linear map that is one-to-one and onto is nonsingular, otherwise\nit is singular.\n",
    "That is, a linear map is nonsingular if and only if it is an\nisomorphism.\n",
    "2.8 Remark Some authors use ‘nonsingular’ as a synonym for one-to-one while\nothers use it the way that we have here.",
    "The diﬀerence is slight because any\nmap is onto its range space, so a one-to-one map is an isomorphism with its\nrange.\n",
    "In the ﬁrst chapter we deﬁned a matrix to be nonsingular if it is square and\nis the matrix of coeﬃcients of a linear system with a unique solution.",
    "The next\nresult justiﬁes our dual use of the term.\n",
    "2.9 Lemma A nonsingular linear map is represented by a square matrix.",
    "A\nsquare matrix represents nonsingular maps if and only if it is a nonsingular\nmatrix.",
    "Thus, a matrix represents isomorphisms if and only if it is square and\nnonsingular.\n",
    "Proof Assume that the map h: V →W is nonsingular.",
    "Corollary 2.6 says that\nfor any matrix H representing that map, because h is onto the number of rows\nof H equals the rank of H, and because h is one-to-one the number of columns\nof H is also equal to the rank of H. Hence H is square.\n",
    "Next assume that H is square, n × n.\n",
    "The matrix H is nonsingular if\nand only if its row rank is n, which is true if and only if H’s rank is n by\nTheorem Two.",
    "III.3.11, which is true if and only if h’s rank is n by Theorem 2.4,\nwhich is true if and only if h is an isomorphism by Theorem I.2.3.",
    "(This last\nholds because the domain of h is n-dimensional as it is the number of columns\nin H.)\n",
    "QED\n2.10 Example",
    "Any map from R2 to P1 represented with respect to any pair of\nbases by\n \n1\n2\n0\n3\n!\nis nonsingular because this matrix has rank two.\n\n228\nChapter Three.",
    "Maps Between Spaces\n2.11 Example",
    "Any map g: V →W represented by\n \n1\n2\n3\n6\n!\nis singular because this matrix is singular.\n",
    "We’ve now seen that the relationship between maps and matrices goes both\nways: for a particular pair of bases, any linear map is represented by a matrix\nand any matrix describes a linear map.",
    "That is, by ﬁxing spaces and bases we\nget a correspondence between maps and matrices.",
    "In the rest of this chapter\nwe will explore this correspondence.",
    "For instance, we’ve deﬁned for linear maps\nthe operations of addition and scalar multiplication and we shall see what the\ncorresponding matrix operations are.",
    "We shall also see the matrix operation\nthat represent the map operation of composition.",
    "And, we shall see how to ﬁnd\nthe matrix that represents a map’s inverse.\n",
    "Exercises\n2.12 For each matrix, state the dimension of the domain and codomain of any map\nthat the matrix represents.\n",
    "(a)\n\u00122\n1\n3\n4\n\u0013\n(b)\n\u00121\n1\n−3\n2\n5\n0\n\u0013\n(c)\n\n\n1\n3\n1\n4\n1\n−1\n\n\n(d)\n",
    "\u00120\n0\n0\n0\n0\n0\n\u0013\n(e)\n\u00121\n−1\n4\n5\n0\n0\n0\n0\n\u0013\n",
    "2.13 Consider a linear map f: V →W represented with respect to some bases B, D\nby the matrix.",
    "Decide if that map is nonsingular.\n",
    "(a)\n\u00122\n1\n3\n4\n\u0013\n(b)\n\u0012 1\n1\n−3\n−3\n\u0013\n(c)\n\n\n3\n0\n0\n2\n1\n0\n4\n4\n4\n\n\n(d)\n\n\n2\n0\n−2\n1\n1\n0\n4\n1\n−4\n\n\n✓2.14 Let h be the linear map deﬁned by this matrix on the domain P1 and\ncodomain R2 with respect to the given bases.\n",
    "H =\n\u00122\n1\n4\n2\n\u0013\nB = ⟨1 + x, x⟩, D = ⟨\n\u00121\n1\n\u0013\n,\n\u00121\n0\n\u0013\n",
    "⟩\nWhat is the image under h of the vector ⃗v = 2x −1?\n✓2.15 Decide if each vector lies in the range of the map from R3 to R2 represented\nwith respect to the standard bases by the matrix.\n",
    "(a)\n\u00121\n1\n3\n0\n1\n4\n\u0013\n,\n\u00121\n3\n\u0013\n(b)\n",
    "\u00122\n0\n3\n4\n0\n6\n\u0013\n,\n\u00121\n1\n\u0013\n✓2.16 Consider this matrix, representing a transformation of R2 with respect to the\nbases.\n1\n2 ·\n\u0012 1\n1\n−1\n1\n\u0013\nB = ⟨\n\u00120\n1\n\u0013\n,\n\u00121\n0\n\u0013\n⟩\nD = ⟨\n\u00121\n1\n\u0013\n,\n\u0012 1\n−1\n\u0013\n⟩\n(a) To what vector in the codomain is the ﬁrst member of B mapped?\n\nSection III.",
    "Computing Linear Maps\n229\n(b) The second member?\n",
    "(c) Where is a general vector from the domain (a vector with components x and\ny) mapped?",
    "That is, what transformation of R2 is represented with respect to\nB, D by this matrix?\n2.17 Consider a homomorphism h: R2 →R2 represented with respect to the standard\nbases E2, E2 by this matrix.\n",
    "\u00121\n3\n2\n4\n\u0013\nFind the image under h of each vector.\n",
    "(a)\n\u00122\n3\n\u0013\n(b)\n\u00120\n1\n\u0013\n(c)\n\u0012−1\n1\n\u0013\n2.18",
    "What transformation of F = {a cos θ + b sin θ | a, b ∈R} is represented with\nrespect to B = ⟨cos θ −sin θ, sin θ⟩and D = ⟨cos θ + sin θ, cos θ⟩by this matrix?\n\u00120\n0\n1\n0\n\u0013\n✓2.19 Decide whether 1 + 2x is in the range of the map from R3 to P2 represented\nwith respect to E3 and ⟨1, 1 + x2, x⟩by this matrix.\n\n\n1\n3\n0\n0\n1\n0\n1\n0\n1\n\n\n2.20 Find the map that this matrix represents with respect to B, B.\n\u0012 2\n1\n−1\n0\n\u0013\n",
    "B = ⟨\n\u00121\n0\n\u0013\n,\n\u00121\n1\n\u0013\n⟩\n2.21 Example 2.11 gives a matrix that is singular and is therefore associated with\nmaps that are singular.",
    "We cannot state the action of the associated map g on\ndomain elements ⃗v ∈V, because do not know the domain V or codomain W or\nthe starting and ending bases B and D.",
    "But we can compute what happens to the\nrepresentations RepB,D(⃗v).\n",
    "(a) Find the set of column vectors representing the members of the null space of\nany map g represented by this matrix.\n",
    "(b) Find the nullity of any such map g.\n(c) Find the set of column vectors representing the members of the range space\nof any map g represented by the matrix.\n",
    "(d) Find the rank of any such map g.\n(e) Check that rank plus nullity equals the dimension of the domain.\n",
    "✓2.22 Take each matrix to represent h: Rm →Rn with respect to the standard bases.\n",
    "For each (i) state m and n. Then set up an augmented matrix with the given\nmatrix on the left and a vector representing a range space element on the right\n(e.g., if the codomain is R3 then in the right-hand column put the three entries a,\nb, and c).",
    "Perform Gauss-Jordan reduction.",
    "Use that to (ii) ﬁnd R(h) and rank(h)\n(and state whether the underlying map is onto), and (iii) ﬁnd N (h) and nullity(h)\n(and state whether the underlying map is one-to-one).\n",
    "(a)\n\u0012 2\n1\n−1\n3\n\u0013\n\n230\nChapter Three.",
    "Maps Between Spaces\n(b)\n\n\n0\n1\n3\n2\n3\n4\n−2\n−1\n2\n\n\n(c)\n\n\n1\n1\n2\n1\n3\n1\n\n\n2.23 Use the method from the prior exercise on this matrix.\n",
    "\n\n1\n0\n−1\n2\n1\n0\n2\n2\n2\n\n\n2.24 Verify that the map represented by this matrix is an isomorphism.\n",
    "\n\n2\n1\n0\n3\n1\n1\n7\n2\n1\n\n\n2.25",
    "This is an alternative proof of Lemma 2.9.",
    "Given an n×n matrix H, ﬁx a\ndomain V and codomain W of appropriate dimension n, and bases B, D for those\nspaces, and consider the map h represented by the matrix.\n",
    "(a) Show that h is onto if and only if there is at least one RepB(⃗v) associated by\nH with each RepD(⃗w).\n",
    "(b) Show that h is one-to-one if and only if there is at most one RepB(⃗v) associated\nby H with each RepD(⃗w).\n",
    "(c) Consider the linear system H·RepB(⃗v)",
    "= RepD(⃗w).",
    "Show that H is nonsingular\nif and only if there is exactly one solution RepB(⃗v) for each RepD(⃗w).\n",
    "✓2.26 Because the rank of a matrix equals the rank of any map it represents, if\none matrix represents two diﬀerent maps H = RepB,D(h) = RepˆB, ˆD(ˆh) (where\nh, ˆh: V →W) then the dimension of the range space of h equals the dimension of\nthe range space of ˆh.",
    "Must these equal-dimensional range spaces actually be the\nsame?\n2.27 Let V be an n-dimensional space with bases B and D. Consider a map that\nsends, for ⃗v ∈V, the column vector representing ⃗v with respect to B to the column\nvector representing ⃗v with respect to D. Show that map is a linear transformation\nof Rn.\n2.28 Example 2.3 shows that changing the pair of bases can change the map that\na matrix represents, even though the domain and codomain remain the same.\n",
    "Could the map ever not change?",
    "Is there a matrix H, vector spaces V and W,\nand associated pairs of bases B1, D1 and B2, D2 (with B1 ̸= B2 or D1 ̸= D2 or\nboth) such that the map represented by H with respect to B1, D1 equals the map\nrepresented by H with respect to B2, D2?\n✓2.29 A square matrix is a diagonal matrix if it is all zeroes except possibly for the\nentries on its upper-left to lower-right diagonal — its 1, 1 entry,",
    "its 2, 2 entry, etc.\nShow that a linear map is an isomorphism if there are bases such that, with respect\nto those bases, the map is represented by a diagonal matrix with no zeroes on the\ndiagonal.\n\nSection III.",
    "Computing Linear Maps\n231\n2.30 Describe geometrically the action on R2 of the map represented with respect\nto the standard bases E2, E2 by this matrix.\n",
    "\u00123\n0\n0\n2\n\u0013\nDo the same for these.\n",
    "\u00121\n0\n0\n0\n\u0013\n\u00120\n1\n1\n0\n\u0013\n\u00121\n3\n0\n1\n\u0013\n2.31",
    "The fact that for any linear map the rank plus the nullity equals the dimension\nof the domain shows that a necessary condition for the existence of a homomorphism\nbetween two spaces, onto the second space, is that there be no gain in dimension.\n",
    "That is, where h: V →W is onto, the dimension of W must be less than or equal\nto the dimension of V.\n(a) Show that this (strong) converse holds: no gain in dimension implies that\nthere is a homomorphism and, further, any matrix with the correct size and\ncorrect rank represents such a map.\n",
    "(b) Are there bases for R3 such that this matrix\nH =\n\n\n1\n0\n0\n2\n0\n0\n0\n1\n0\n\n\nrepresents a map from R3 to R3 whose range is the xy plane subspace of R3?\n2.32 Let V be an n-dimensional space and suppose that ⃗x ∈Rn.\n",
    "Fix a basis\nB for V and consider the map h⃗x : V →R given ⃗v 7→⃗x • RepB(⃗v) by the dot\nproduct.\n",
    "(a) Show that this map is linear.\n",
    "(b) Show that for any linear map g: V →R there is an ⃗x ∈Rn such that g = h⃗x.\n",
    "(c) In the prior item we ﬁxed the basis and varied the ⃗x to get all possible linear\nmaps.",
    "Can we get all possible linear maps by ﬁxing an ⃗x and varying the basis?\n2.33 Let V, W, X be vector spaces with bases B, C, D.\n(a) Suppose that h: V →W is represented with respect to B, C by the matrix H.\nGive the matrix representing the scalar multiple rh (where r ∈R) with respect\nto B, C by expressing it in terms of H.\n(b) Suppose that h, g: V →W are represented with respect to B, C by H and G.\n",
    "Give the matrix representing h",
    "+ g with respect to B, C by expressing it in terms\nof H and G.\n(c) Suppose that h: V →W is represented with respect to B, C by H and g: W →X\nis represented with respect to C, D by G. Give the matrix representing g ◦h\nwith respect to B, D by expressing it in terms of H and G.\n\n232\nChapter Three.",
    "Maps Between Spaces\nIV\nMatrix Operations\n",
    "The prior section shows how matrices represent linear maps.",
    "We now explore\nhow this representation interacts with things that we already know.",
    "First we\nwill see how the representation of a scalar product r · f of a linear map relates to\nthe representation of f, and also how the representation of a sum f + g relates to\nthe representations of the two summands.",
    "Later we will do the same comparison\nfor the map operations of composition and inverse.\nIV.1\nSums and Scalar Products\n1.1 Example Let f: V →W be a linear function represented with respect to some\nbases by this matrix.\n",
    "RepB,D(f) =\n \n1\n0\n1\n1\n!\nConsider the map that is the scalar multiple 5f:",
    "V →W. We will relate the\nrepresentation RepB,D(5f) with RepB,D(f).\n",
    "Let f associate ⃗v 7→⃗w with these representations.\n",
    "RepB(⃗v) =\n \nv1\nv2\n!\nRepD(⃗w)",
    "=\n \nw1\nw2\n!\n",
    "Where the codomain’s basis is D = ⟨⃗δ1,⃗δ2⟩, that representation gives that the\noutput vector is ⃗w = w1⃗δ1 + w2⃗δ2.\n",
    "The action of the map 5f is ⃗v 7→5⃗w and 5⃗w = 5 · (w1⃗δ1 + w2⃗δ2) =\n(5w1)⃗δ1 + (5w2)⃗δ2.",
    "So 5f associates the input vector ⃗v with the output vector\nhaving this representation.\nRepD(5⃗w) =\n \n5w1\n5w2\n!\nChanging from the map f to the map 5f has the eﬀect on the representation of\nthe output vector of multiplying each entry by 5.\nBecause of that, RepB,D(5f) is this matrix.\nRepB,D(5f) ·\n \nv1\nv2\n!\n=\n \n5v1\n5v1 + 5v2\n!\n",
    "RepB,D(5f) =\n \n5\n0\n5\n5\n!\n",
    "Therefore, going from the matrix representing f to the one representing 5f means\nmultiplying all the matrix entries by 5.\n\nSection IV.",
    "Matrix Operations\n",
    "233\n1.2 Example",
    "We can do a similar exploration for the sum of two maps.",
    "Suppose\nthat two linear maps with the same domain and codomain f, g: R2 →R2 are\nrepresented with respect to bases B and D by these matrices.\nRepB,D(f) =\n \n1\n3\n2\n0\n!\n",
    "RepB,D(g) =\n \n−2\n−1\n2\n4\n!\n",
    "Recall the deﬁnition of sum: if f does ⃗v 7→⃗u and g does ⃗v 7→⃗w then f + g is\nthe function whose action is ⃗v 7→⃗u + ⃗w.",
    "Let these be the representations of the\ninput and output vectors.\n",
    "RepB(⃗v) =\n \nv1\nv2\n!\n",
    "RepD(⃗u) =\n \nu1\nu2\n!\nRepD(⃗w) =\n \nw1\nw2\n!\n",
    "Where D = ⟨⃗δ1,⃗δ2⟩we have ⃗u + ⃗w = (u1⃗δ1 + u2⃗δ2)",
    "+ (w1⃗δ1 + w2⃗δ2) =\n(u1 + w1)⃗δ1 + (u2 + w2)⃗δ2 and so this is the representation of the vector sum.\n",
    "RepD(⃗u + ⃗w) =\n \nu1 + w1\nu2 + w2\n!\n",
    "Thus, since these represent the actions of of the maps f and g on the input ⃗v\n \n1\n3\n2\n0\n!  \nv1\nv2\n!\n=\n \nv1 + 3v2\n2v1\n!\n \n−2\n−1\n2\n4\n!  \n",
    "v1\nv2\n!\n=\n \n−2v1 −v2\n2v1 + 4v2\n!\nadding the entries represents the action of the map f + g.\nRepB,D(f + g) ·\n \nv1\nv2\n!\n=\n \n−v1 + 2v2\n4v1",
    "+ 4v2\n!\n",
    "Therefore, we compute the matrix representing the function sum by adding the\nentries of the matrices representing the functions.\nRepB,D(f + g) =\n \n−1\n2\n4\n4\n!\n",
    "1.3 Deﬁnition The scalar multiple of a matrix is the result of entry-by-entry\nscalar multiplication.",
    "The sum of two same-sized matrices is their entry-by-entry\nsum.\n",
    "These operations extend the ﬁrst chapter’s operations of addition and scalar\nmultiplication of vectors.\n",
    "We need a result that proves these matrix operations do what the examples\nsuggest that they do.\n\n",
    "234\nChapter Three.",
    "Maps Between Spaces\n1.4 Theorem Let h, g: V →W be linear maps represented with respect to bases\nB, D by the matrices H and G and let r be a scalar.",
    "Then with respect to\nB, D the map r · h: V →W is represented by rH and the map h",
    "+ g: V →W is\nrepresented by H + G.\nProof Generalize the examples.",
    "This is Exercise 10.\nQED\n1.5 Remark These two operations on matrices are simple, but we did not deﬁne\nthem in this way because they are simple.",
    "We deﬁned them this way because\nthey represent function addition and function scalar multiplication.",
    "That is,\nour program is to deﬁne matrix operations by referencing function operations.\n",
    "Simplicity is a bonus.\n",
    "We will see this again in the next subsection, where we will deﬁne the\noperation of multiplying matrices.",
    "Since we’ve just deﬁned matrix scalar multi-\nplication and matrix sum to be entry-by-entry operations, a naive thought is\nto deﬁne matrix multiplication to be the entry-by-entry product.",
    "In theory we\ncould do whatever we please",
    "but we will instead be practical and combine the\nentries in the way that represents the function operation of composition.\n",
    "A special case of scalar multiplication is multiplication by zero.",
    "For any map\n0 · h is the zero homomorphism and for any matrix 0 ·",
    "H is the matrix with all\nentries zero.\n",
    "1.6 Deﬁnition A zero matrix has all entries 0.",
    "We write Zn×m or simply Z\n(another common notation is 0n×m or just 0).\n",
    "1.7 Example\nThe zero map from any three-dimensional space to any two-\ndimensional space is represented by the 2×3 zero matrix\nZ =\n \n0\n0\n0\n0\n0\n0\n!\n",
    "no matter what domain and codomain bases we use.\n",
    "Exercises\n✓1.8 Perform the indicated operations, if deﬁned, or state “not deﬁned.”\n(a)\n\u00125\n−1\n2\n6\n1\n1\n\u0013\n+\n\u00122\n1\n4\n3\n0\n5\n\u0013\n(b) 6 ·\n\u00122\n−1\n−1\n1\n2\n3\n\u0013\n(c)\n",
    "\u00122\n1\n0\n3\n\u0013\n+\n\u00122\n1\n0\n3\n\u0013\n(d) 4\n\u00121\n2\n3\n−1\n\u0013\n",
    "+ 5\n\u0012−1\n4\n−2\n1\n\u0013\n\nSection IV.",
    "Matrix Operations\n235\n(e) 3\n\u00122\n1\n3\n0\n\u0013\n",
    "+ 2\n\u00121\n1\n4\n3\n0\n5\n\u0013\n1.9 Give the matrix representing the zero map from R4 to R2, with respect to the\nstandard bases.\n",
    "1.10 Prove Theorem 1.4.\n(a) Prove that matrix addition represents addition of linear maps.\n",
    "(b) Prove that matrix scalar multiplication represents scalar multiplication of\nlinear maps.\n",
    "✓1.11 Prove each, assuming that the operations are deﬁned, where G, H, and J are\nmatrices, where Z is the zero matrix, and where r and s are scalars.\n",
    "(a) Matrix addition is commutative G + H = H + G.\n(b) Matrix addition is associative G",
    "+ (H + J) = (G + H) + J.\n(c)",
    "The zero matrix is an additive identity G + Z = G.\n(d) 0 ·",
    "G = Z\n(e) (r + s)G = rG + sG\n(f) Matrices have an additive inverse G + (−1) ·",
    "G = Z.\n(g) r(G + H) = rG + rH\n(h) (rs)G = r(sG)\n1.12 Fix domain and codomain spaces.",
    "In general, one matrix can represent many\ndiﬀerent maps with respect to diﬀerent bases.",
    "However, prove that a zero matrix\nrepresents only a zero map.",
    "Are there other such matrices?\n✓1.13 Let V and W be vector spaces of dimensions n and m. Show that the space\nL(V, W) of linear maps from V to W is isomorphic to Mm×n.\n",
    "✓1.14 Show that it follows from the prior question that for any six transformations\nt1, . . . , t6 : R2 →R2 there are scalars c1, . . .",
    ", c6 ∈R such that not every ci equals 0\nbut c1t1 + · · · + c6t6 is the zero map.",
    "(Hint: the six is slightly misleading.)\n",
    "1.15 The trace of a square matrix is the sum of the entries on the main diagonal\n(the 1, 1 entry plus the 2, 2 entry, etc.; we will see the signiﬁcance of the trace in\nChapter Five).",
    "Show that trace(H + G) = trace(H) + trace(G).",
    "Is there a similar\nresult for scalar multiplication?\n",
    "1.16 Recall that the transpose of a matrix M is another matrix, whose i, j entry is\nthe j, i entry of M. Verify these identities.\n",
    "(a) (G + H)T = GT + HT\n(b) (r · H)T = r · HT\n✓1.17",
    "A square matrix is symmetric if each i, j entry equals the j, i entry, that is, if\nthe matrix equals its transpose.\n",
    "(a) Prove that for any square H, the matrix H + HT is symmetric.",
    "Does every\nsymmetric matrix have this form?\n(b) Prove that the set of n×n symmetric matrices is a subspace of Mn×n.\n",
    "✓1.18\n(a) How does matrix rank interact with scalar multiplication — can a scalar\nproduct of a rank n matrix have rank less than n?",
    "Greater?\n(b) How does matrix rank interact with matrix addition — can a sum of rank n\nmatrices have rank less than n?",
    "Greater?\n\n236\nChapter Three.",
    "Maps Between Spaces\nIV.2\nMatrix Multiplication\nAfter representing addition and scalar multiplication of linear maps in the prior\nsubsection, the natural next operation to consider is function composition.\n",
    "2.1 Lemma The composition of linear maps is linear.\n",
    "Proof (Note: this argument has already appeared, as part of the proof of\nTheorem I.2.2.)",
    "Let h: V →W and g: W →U be linear.",
    "The calculation\ng ◦h\n\u0000c1 ·⃗v1 + c2 ·⃗v2\n\u0001\n= g\n\u0000h(c1 ·⃗v1 + c2 ·⃗v2)\n\u0001\n= g\n\u0000c1 · h(⃗v1)",
    "+ c2 · h(⃗v2)\n\u0001\n= c1 · g\n\u0000h(⃗v1))",
    "+ c2 · g(h(⃗v2)\n\u0001\n= c1 · (g ◦h)(⃗v1)",
    "+",
    "c2 · (g ◦h)(⃗v2)\nshows that g ◦h: V →U preserves linear combinations, and so is linear.",
    "QED\nAs we did with the operation of matrix addition and scalar multiplication,\nwe will see how the representation of the composite relates to the representations\nof the compositors by ﬁrst considering an example.\n",
    "2.2 Example Let h: R4 →R2 and g: R2 →R3, ﬁx bases B ⊂R4, C ⊂R2,\nD ⊂R3, and let these be the representations.\n",
    "H = RepB,C(h) =\n \n4\n6\n8\n2\n5\n7\n9\n3\n!\n",
    "B,C\nG = RepC,D(g) =\n\n\n\n1\n1\n0\n1\n1\n0\n\n\n\nC,D\nTo represent the composition g ◦h: R4 →R3 we start with a ⃗v, represent h of\n⃗v, and then represent g of that.",
    "The representation of h(⃗v) is the product of h’s\nmatrix and ⃗v’s vector.\n",
    "RepC( h(⃗v) )",
    "=\n \n4\n6\n8\n2\n5\n7\n9\n3\n!\nB,C\n\n\n\n\n\nv1\nv2\nv3\nv4\n\n\n\n\n\nB\n=\n \n4v1",
    "+ 6v2 + 8v3 + 2v4\n5v1 + 7v2 + 9v3 +",
    "3v4\n!\n",
    "C\nThe representation of g( h(⃗v) ) is the product of g’s matrix and h(⃗v)’s",
    "vector.\n",
    "RepD( g(h(⃗v)) )",
    "=\n\n\n\n1\n1\n0\n1\n1\n0\n\n\n\nC,D\n \n4v1",
    "+ 6v2 + 8v3 + 2v4\n5v1 + 7v2 + 9v3 +",
    "3v4\n!\nC\n=\n\n\n\n1 · (4v1 + 6v2 + 8v3 + 2v4) + 1 · (5v1 + 7v2 + 9v3 + 3v4)\n0 · (4v1 + 6v2 + 8v3 + 2v4) + 1 · (5v1 + 7v2 + 9v3 + 3v4)\n1 · (4v1 + 6v2 + 8v3 + 2v4) + 0 · (5v1 + 7v2 + 9v3 + 3v4)\n\n\n\nD\n\nSection IV.",
    "Matrix Operations\n237\nDistributing and regrouping on the v’s gives\n=\n\n\n\n(",
    "1 · 4 + 1 · 5)v1 + (1 · 6 + 1 · 7)v2 + (1 · 8 + 1 · 9)v3 + (1 · 2 + 1 · 3)v4\n(0 · 4 + 1 · 5)v1 + (0 · 6 + 1 · 7)v2 + (0 · 8 + 1 · 9)v3 + (0 · 2 + 1 · 3)v4\n(1 · 4 + 0 ·",
    "5)v1 + (1 · 6 + 0 ·",
    "7)v2 + (1 · 8 + 0 · 9)v3 + (1 · 2 + 0 · 3)v4\n\n\n\nD\nwhich is this matrix-vector product.\n",
    "=\n\n\n\n1 · 4 + 1 · 5\n1 · 6 + 1 · 7\n1 · 8 + 1 · 9\n1 · 2 + 1 · 3\n0 · 4 + 1 · 5\n0 · 6 + 1 · 7\n0 · 8 + 1 · 9\n0 · 2 + 1 · 3\n1 · 4 + 0 · 5\n1 · 6 + 0 · 7\n1 · 8 + 0 · 9\n1 · 2 + 0 · 3\n\n\n\nB,D\n\n\n\n\n\nv1\nv2\nv3\nv4\n\n\n\n\n\nB\nThe matrix representing g ◦h has the rows of G combined with the columns of\nH.\n2.3 Deﬁnition The matrix-multiplicative product of the m×r matrix G and",
    "the\nr×n matrix H is the m×n matrix P, where\npi,j = gi,1h1,j + gi,2h2,j + · · ·",
    "+ gi,rhr,j\nso that the i, j-th entry of the product is the dot product of the i-th row of the\nﬁrst matrix with the j-th column of the second.\n",
    "GH =\n\n\n\n\n...\ngi,1\ngi,2\n· · ·\ngi,r\n...\n\n\n\n\n\n\n\n\n\n\nh1,j\n· · ·\nh2,j\n· · ·\n...\nhr,j\n\n\n\n\n\n\n=\n\n\n\n\n...\n· · ·\npi,j\n· · ·\n...\n\n\n\n\n2.4 Example\n\n\n\n2\n0\n4\n6\n8\n2\n\n\n\n \n1\n3\n5\n7\n!\n=\n\n\n\n2 · 1 + 0 · 5\n2 · 3 + 0 · 7\n4 · 1 + 6 · 5\n4 · 3 + 6 · 7\n8 · 1 + 2 · 5\n8 · 3 + 2 · 7\n\n\n=\n\n\n\n2\n6\n34\n54\n18\n38\n\n\n\n2.5 Example",
    "Some products are not deﬁned, such as the product of a 2×3 matrix\nwith a 2×2, because the number of columns in the ﬁrst matrix must equal the\nnumber of rows in the second.",
    "But the product of two n×n matrices is always\ndeﬁned.",
    "Here are two 2×2’s.\n \n",
    "1\n2\n3\n4\n!  \n−1\n0\n2\n−2\n!\n=\n \n1 · (−1) +",
    "2 · 2\n1 · 0 + 2 · (−2)\n3 · (−1) + 4 · 2\n3 · 0",
    "+ 4 · (−2)\n!\n=\n \n3\n−4\n5\n−8\n!\n\n238\nChapter Three.",
    "Maps Between Spaces\n2.6 Example",
    "The matrices from Example 2.2 combine in this way.\n",
    "\n\n\n1\n1\n0\n1\n1\n0\n\n\n\n \n4\n6\n8\n2\n5\n7\n9\n3\n!\n=\n\n\n\n1 · 4 + 1 · 5\n1 · 6 + 1 · 7\n1 · 8 + 1 · 9\n1 · 2 + 1 · 3\n0 · 4 + 1 · 5\n0 · 6 + 1 · 7\n0 · 8 + 1 · 9\n0 · 2 + 1 · 3\n1 · 4 + 0 · 5\n1 · 6 + 0 · 7\n1 · 8 + 0 · 9\n1 · 2 + 0 · 3\n\n\n\n=\n\n\n\n9\n13\n17\n5\n5\n7\n9\n3\n4\n6\n8\n2\n\n\n\n2.7 Theorem A composition of linear maps is represented by the matrix product\nof the representatives.\n",
    "Proof This argument generalizes Example 2.2.",
    "Let h: V →W and g: W →X\nbe represented by H and G with respect to bases B ⊂V, C ⊂W, and D ⊂X, of\nsizes n, r, and m.",
    "For any ⃗v ∈V the k-th component of RepC( h(⃗v) ) is\nhk,1v1 + · · ·",
    "+ hk,nvn\nand so the i-th component of RepD( g ◦h (⃗v) ) is this.\ngi,1 · (h1,1v1 + · · · + h1,nvn) + gi,2 · (h2,1v1 + · · ·",
    "+ h2,nvn)\n",
    "+ · · · + gi,r · (hr,1v1 + · · · + hr,nvn)\nDistribute and regroup on the v’s.\n",
    "= (gi,1h1,1 + gi,2h2,1 + · · · + gi,rhr,1) ·",
    "v1\n+ · · · + (gi,1h1,n + gi,2h2,n + · · · + gi,rhr,n) · vn\nFinish by recognizing that the coeﬃcient of each vj\ngi,1h1,j + gi,2h2,j + · · · + gi,rhr,j\nmatches the deﬁnition of the i, j entry of the product GH.\n",
    "QED\n",
    "This arrow diagram pictures the relationship between maps and matrices\n(‘wrt’ abbreviates ‘with respect to’).\n",
    "Vwrt B\nWwrt C\nXwrt D\nh\nH\ng\nG\ng ◦h\nGH\n\nSection IV.",
    "Matrix Operations\n239\nAbove the arrows",
    ", the maps show that the two ways of going from V to X,\nstraight over via the composition or else in two steps by way of W, have the\nsame eﬀect\n⃗v\ng◦h\n7−→g(h(⃗v))\n",
    "⃗v\nh\n7−→h(⃗v)\ng\n7−→g(h(⃗v))\n(this is just the deﬁnition of composition).",
    "Below the arrows, the matrices\nindicate that multiplying GH into the column vector RepB(⃗v) has the same\neﬀect as multiplying the column vector ﬁrst by H and then multiplying the\nresult by G.\nRepB,D(g ◦h) = GH\nRepC,D(g) RepB,C(h) = GH\n",
    "As mentioned in Example 2.5, because the number of columns on the left\ndoes not equal the number of rows on the right, the product as here of a 2×3\nmatrix with a 2×2 matrix is not deﬁned.\n \n",
    "−1\n2\n0\n0\n10\n1.1\n!  \n",
    "0\n0\n0\n2\n!\n",
    "The deﬁnition requires that the sizes match because we want that the underlying\nfunction composition is possible.\n",
    "dimension n space\nh\n−→dimension r space\ng\n−→dimension m space\n(∗)\n",
    "Thus, matrix product combines the m×r matrix G with the r×n matrix F to\nyield the m×n result GF.",
    "Brieﬂy: m×r times r×n equals m×n.\n",
    "2.8 Remark The order of the dimensions can be confusing.",
    "In ‘m×r times r×\nn equals m×n’ the number written ﬁrst is m.",
    "But m appears last in the map\ndimension description line (∗) above, and the other dimensions also appear in\nreverse.",
    "The explanation is that while h is done ﬁrst, followed by g, we write\nthe composition as g ◦h, with g on the left (arising from the notation g(h(⃗v))).\n",
    "That carries over to matrices, so that g ◦h is represented by GH.\n",
    "We can get insight into matrix-matrix product operation by studying how\nthe entries combine.",
    "For instance, an alternative way to understand why we\nrequire above that the sizes match is that the row of the left-hand matrix must\nhave the same number of entries as the column of the right-hand matrix, or else\nsome entry will be left without a matching entry from the other matrix.\n",
    "Another aspect of the combinatorics of matrix multiplication, in the sum\ndeﬁning the i, j entry, is brought out here by the boxing the equal subscripts.\n",
    "pi,j = gi, 1 h 1 ,j + gi, 2 h 2 ,j + · · · + gi, r h r ,j\nThe highlighted subscripts on the g’s are column indices while those on the h’s\nare for rows.",
    "That is, the summation takes place over the columns of G but\n\n240\nChapter Three.",
    "Maps Between Spaces\nover the rows of H — the deﬁnition treats left diﬀerently than right.",
    "So we may\nreasonably suspect that GH can be unequal to HG.\n2.9 Example Matrix multiplication is not commutative.\n \n1\n2\n3\n4\n!  \n",
    "5\n6\n7\n8\n!\n=\n \n19\n22\n43\n50\n!\n \n5\n6\n7\n8\n!  \n1\n2\n3\n4\n!\n=\n \n23\n34\n31\n46\n!\n",
    "2.10 Example Commutativity can fail more dramatically:\n \n5\n6\n7\n8\n!  \n1\n2\n0\n3\n4\n0\n!\n",
    "=\n \n23\n34\n0\n31\n46\n0\n!\n",
    "while\n \n1\n2\n0\n3\n4\n0\n!  \n5\n6\n7\n8\n!\nisn’t even deﬁned.\n",
    "2.11 Remark The fact that matrix multiplication is not commutative can seem\nodd at ﬁrst, perhaps because most mathematical operations in prior courses are\ncommutative.",
    "But matrix multiplication represents function composition and\nfunction composition is not commutative: if f(x) = 2x and g(x)",
    "= x + 1 then\ng ◦f(x) = 2x +",
    "1",
    "while f ◦g(x) = 2(x",
    "+ 1) = 2x +",
    "2.\nExcept for the lack of commutativity, matrix multiplication is algebraically\nwell-behaved.\n",
    "The next result gives some nice properties and more are in\nExercise 25 and Exercise 26.\n2.12 Theorem If F, G, and H are matrices, and the matrix products are deﬁned,\nthen the product is associative (FG)H = F(GH) and distributes over matrix\naddition F(G + H) = FG + FH",
    "and (G + H)F = GF + HF.\nProof Associativity holds because matrix multiplication represents function\ncomposition, which is associative: the maps (f ◦g) ◦h and f ◦(g ◦h) are equal\nas both send ⃗v to f(g(h(⃗v))).\n",
    "Distributivity is similar.",
    "For instance, the ﬁrst one goes f ◦(g + h) (⃗v) =\nf\n\u0000(g + h)(⃗v)\n",
    "\u0001\n= f\n\u0000g(⃗v) + h(⃗v)\n\u0001\n= f(g(⃗v))",
    "+ f(h(⃗v))",
    "= f ◦g(⃗v)",
    "+ f ◦h(⃗v) (the\nthird equality uses the linearity of f).",
    "Right-distributivity goes the same way.\n",
    "QED\n2.13 Remark We could instead prove that result by slogging through indices.",
    "For\n\nSection IV.",
    "Matrix Operations\n241\nexample, for associativity the i, j entry of (FG)H is\n(fi,1g1,1 + fi,2g2,1 + · · ·",
    "+ fi,rgr,1)h1,j\n+ (fi,1g1,2 + fi,2g2,2 + · · · + fi,rgr,2)h2,j\n...\n",
    "+ (fi,1g1,s + fi,2g2,s + · · · + fi,rgr,s)hs,j\nwhere F, G, and H are m×r, r×s, and s×n matrices.",
    "Distribute\nfi,1g1,1h1,j + fi,2g2,1h1,j + · · ·",
    "+ fi,rgr,1h1,j\n+ fi,1g1,2h2,j + fi,2g2,2h2,j + · · · + fi,rgr,2h2,j\n...\n+ fi,1g1,shs,j + fi,2g2,shs,j + · · · + fi,rgr,shs,j\nand regroup around the f’s\nfi,1(g1,1h1,j + g1,2h2,j + · · · + g1,shs,j)\n+ fi,2(g2,1h1,j + g2,2h2,j + · · · + g2,shs,j)\n...\n",
    "+ fi,r(gr,1h1,j + gr,2h2,j + · · · + gr,shs,j)\nto get the i, j entry of F(GH).\n",
    "Contrast the two proofs.",
    "The index-heavy argument is hard to understand in\nthat while the calculations are easy to check, the arithmetic seems unconnected\nto any idea.",
    "The argument in the proof is shorter and also says why this property\n“really” holds.",
    "This illustrates the comments made at the start of the chapter on\nvector spaces — at least sometimes an argument from higher-level constructs is\nclearer.\n",
    "We have now seen how to represent the composition of linear maps.",
    "The\nnext subsection will continue to explore this operation.\n",
    "Exercises\n✓2.14 Compute, or state “not deﬁned”.\n",
    "(a)\n\u0012 3\n1\n−4\n2\n\u0013 \u00120\n5\n0\n0.5\n\u0013\n(b)\n\u00121\n1\n−1\n4\n0\n3\n\u0013 \n\n2\n−1\n−1\n3\n1\n1\n3\n1\n1\n\n\n(c)\n",
    "\u00122\n−7\n7\n4\n\u0013 \n\n1\n0\n5\n−1\n1\n1\n3\n8\n4\n\n\n(d)\n\u00125\n2\n3\n1\n\u0013 \u0012−1\n2\n3\n−5\n\u0013\n\n242\nChapter Three.",
    "Maps Between Spaces\n✓2.15 Where\n",
    "A =\n\u00121\n−1\n2\n0\n\u0013\nB =\n\u00125\n2\n4\n4\n\u0013\nC =\n\u0012−2\n3\n−4\n1\n\u0013\ncompute or state “not deﬁned.”\n(a) AB\n(b) (AB)C\n(c) BC\n(d) A(BC)\n2.16",
    "Which products are deﬁned?\n(a) 3×2 times 2×3\n(b) 2×3 times 3×2\n(c) 2×2 times 3×3\n(d) 3×3 times 2×2\n✓2.17 Give the size of the product or state “not deﬁned”.\n",
    "(a) a 2×3 matrix times a 3×1 matrix\n(b) a 1×12 matrix times a 12×1 matrix\n(c) a 2×3 matrix times a 2×1 matrix\n(d) a 2×2 matrix times a 2×2 matrix\n✓2.18 Find the system of equations resulting from starting with\nh1,1x1 + h1,2x2 + h1,3x3 = d1\nh2,1x1 + h2,2x2 + h2,3x3 = d2\nand making this change of variable (i.e., substitution).\n",
    "x1 = g1,1y1 + g1,2y2\nx2 = g2,1y1 + g2,2y2\nx3 = g3,1y1 + g3,2y2\n✓2.19 Consider the two linear functions h: R3 →P2 and g: P2 →M2×2 given as here.\n",
    "\n\na\nb\nc\n\n7→(a +",
    "b)x2 + (2a + 2b)x + c\npx2 + qx + r 7→\n\u0012p\np −2q\nq\n0\n\u0013\nUse these bases for the spaces.\n",
    "B = ⟨\n\n\n1\n1\n1\n\n,\n\n\n0\n1\n1\n\n,\n\n\n0\n0\n1\n\n⟩\nC = ⟨1 + x, 1 −x, x2⟩\n",
    "D = ⟨\n\u00121\n0\n0\n0\n\u0013\n,\n\u00120\n2\n0\n0\n\u0013\n,\n\u00120\n0\n3\n0\n\u0013\n,\n\u00120\n0\n0\n4\n\u0013\n⟩\n(a) Give the formula for the composition map g ◦h: R3 →M2×2 derived directly\nfrom the above deﬁnition.\n",
    "(b) Represent h and g with respect to the appropriate bases.\n",
    "(c) Represent the map g ◦h computed in the ﬁrst part with respect to the\nappropriate bases.\n",
    "(d) Check that the product of the two matrices from the second part is the matrix\nfrom the third part.\n",
    "2.20",
    "As Deﬁnition 2.3 points out, the matrix product operation generalizes the dot\nproduct.",
    "Is the dot product of a 1×n row vector and a n×1 column vector the\nsame as their matrix-multiplicative product?\n✓2.21 Represent the derivative map on Pn with respect to B, B where B is the natural\nbasis ⟨1, x, . . .",
    ", xn⟩. Show that the product of this matrix with itself is deﬁned;\nwhat map does it represent?\n\nSection IV.",
    "Matrix Operations\n243\n2.22",
    "[Cleary] Match each type of matrix with all these descriptions that could ﬁt,\nsay ‘None’ if it applies: (i) can be multiplied by its transpose to make a 1×1 matrix,\n(ii) can represent a linear map from R3 to R2 that is not onto, (iii) can represent\nan isomorphism from R3 to P2.\n(a) a 2×3 matrix whose rank is 1\n(b) a 3×3 matrix that is nonsingular\n(c) a 2×2 matrix that is singular\n(d) an n×1 column vector\n2.23 Show that composition of linear transformations on R1 is commutative.",
    "Is this\ntrue for any one-dimensional space?\n2.24 Why is matrix multiplication not deﬁned as entry-wise multiplication?",
    "That\nwould be easier, and commutative too.\n",
    "2.25\n(a) Prove that HpHq = Hp+q and (Hp)q = Hpq for positive integers p, q.\n(b) Prove that (rH)p = rp ·",
    "Hp for any positive integer p and scalar r ∈R.\n✓2.26\n(a) How does matrix multiplication interact with scalar multiplication: is\nr(GH) = (rG)H?",
    "Is G(rH) = r(GH)?\n(b) How does matrix multiplication interact with linear combinations: is F(rG +\nsH) = r(FG) + s(FH)?",
    "Is (rF + sG)H = rFH + sGH?\n2.27",
    "We can ask how the matrix product operation interacts with the transpose\noperation.\n",
    "(a) Show that (GH)T = HTGT.\n",
    "(b) A square matrix is symmetric if each i, j entry equals the j, i entry, that is, if\nthe matrix equals its own transpose.",
    "Show that the matrices HHT and HTH are\nsymmetric.\n",
    "✓2.28 Rotation of vectors in R3 about an axis is a linear map.",
    "Show that linear maps\ndo not commute by showing geometrically that rotations do not commute.\n2.29",
    "In the proof of Theorem 2.12 we used some maps.",
    "What are the domains and\ncodomains?\n2.30 How does matrix rank interact with matrix multiplication?\n(a) Can the product of rank n matrices have rank less than n?",
    "Greater?\n(b) Show that the rank of the product of two matrices is less than or equal to the\nminimum of the rank of each factor.\n",
    "2.31 Is ‘commutes with’ an equivalence relation among n×n matrices?\n2.32 (We will use this exercise in the Matrix Inverses exercises.)",
    "Here is another\nproperty of matrix multiplication that might be puzzling at ﬁrst sight.\n",
    "(a) Prove that the composition of the projections πx, πy : R3 →R3 onto the x and\ny axes is the zero map despite that neither one is itself the zero map.\n",
    "(b) Prove that the composition of the derivatives d2/dx2, d3/dx3 : P4 →P4 is the\nzero map despite that neither is the zero map.\n",
    "(c) Give a matrix equation representing the ﬁrst fact.\n",
    "(d) Give a matrix equation representing the second.\n",
    "When two things multiply to give zero despite that neither is zero we say that each\nis a zero divisor.\n",
    "2.33 Show that, for square matrices, (S + T)(S −T) need not equal S2 −T 2.\n\n244\nChapter Three.",
    "Maps Between Spaces\n✓2.34 Represent the identity transformation id: V →V with respect to B, B for any\nbasis B.",
    "This is the identity matrix I. Show that this matrix plays the role in matrix\nmultiplication that the number 1 plays in real number multiplication: HI = IH = H\n(for all matrices H for which the product is deﬁned).\n",
    "2.35\n(a) Prove that for any 2×2 matrix T there are scalars c0, . . .",
    ", c4 that are not\nall 0 such that the combination c4T 4 + c3T 3 + c2T 2 + c1T + c0I is the zero matrix\n(where I is the 2×2 identity matrix, with 1’s in its 1, 1 and 2, 2 entries and zeroes\nelsewhere; see Exercise 34).\n",
    "(b) Let p(x) be a polynomial p(x)",
    "= cnxn + · · ·",
    "+ c1x + c0.\n",
    "If T is a square\nmatrix we deﬁne p(T) to be the matrix cnT n + · · · + c1T + c0I (where I is the\nappropriately-sized identity matrix).",
    "Prove that for any square matrix there is a\npolynomial such that p(T) is the zero matrix.\n",
    "(c) The minimal polynomial m(x) of a square matrix is the polynomial of least\ndegree, and with leading coeﬃcient 1, such that m(T) is the zero matrix.",
    "Find\nthe minimal polynomial of this matrix.\n",
    "\u0012√\n3/2\n−1/2\n1/2\n√\n3/2\n\u0013\n(This is the representation with respect to E2, E2, the standard basis, of a rotation\nthrough π/6 radians counterclockwise.)\n",
    "2.36",
    "The inﬁnite-dimensional space P of all ﬁnite-degree polynomials gives a memo-\nrable example of the non-commutativity of linear maps.",
    "Let d/dx: P",
    "→P be the\nusual derivative and let s: P →P be the shift map.\n",
    "a0 + a1x + · · ·",
    "+ anxn\ns\n7−→0 + a0x",
    "+ a1x2",
    "+ · · · + anxn+1\nShow that the two maps don’t commute d/dx ◦s ̸= s ◦d/dx; in fact, not only is\n(d/dx ◦s) −(s ◦d/dx) not the zero map, it is the identity map.\n",
    "2.37 Recall the notation for the sum of the sequence of numbers a1, a2, . . .",
    ", an.\nn\nX\ni=1\nai = a1 + a2 + · · · + an\nIn this notation, the i, j entry of the product of G and H is this.\n",
    "pi,j =\nr\nX\nk=1\ngi,khk,j\nUsing this notation,\n(a) reprove that matrix multiplication is associative;\n(b) reprove Theorem 2.7.\n",
    "IV.3\nMechanics of Matrix Multiplication\nWe can consider matrix multiplication as a mechanical process, putting aside for\nthe moment any implications about the underlying maps.\n\nSection IV.",
    "Matrix Operations\n245\nThe striking thing about this operation is the way that rows and columns\ncombine.",
    "The i, j entry of the matrix product is the dot product of row i of the\nleft matrix with column j of the right one.",
    "For instance, here a second row and\na third column combine to make a 2, 3 entry.\n\n\n\n1\n1\n0\n1\n1\n0\n\n\n\n \n4\n5\n6\n7\n8\n9\n2\n3\n!\n=\n\n\n\n9\n13\n17\n5\n5\n7\n9\n3\n4\n6\n8\n2\n\n\n\n",
    "We can view this as the left matrix acting by multiplying its rows into the\ncolumns of the right matrix.",
    "Or, it is the right matrix using its columns to act\non the rows of the left matrix.",
    "Below, we will examine actions from the left and\nfrom the right for some simple matrices.\n",
    "Simplest is the zero matrix.\n",
    "3.1 Example Multiplying by a zero matrix from the left or from the right results\nin a zero matrix.\n \n0\n0\n0\n0\n!  \n",
    "1\n3\n2\n−1\n1\n−1\n!\n",
    "=\n \n0\n0\n0\n0\n0\n0\n!\n \n2\n3\n1\n4\n!  \n",
    "0\n0\n0\n0\n!\n",
    "=\n \n0\n0\n0\n0\n!\n",
    "The next easiest matrices are the ones with a single nonzero entry.\n",
    "3.2 Deﬁnition A matrix with all 0’s except for a 1 in the i, j entry is an i, j unit\nmatrix (or matrix unit).\n",
    "3.3 Example This is the 1, 2 unit matrix with three rows and two columns,\nmultiplying from the left.\n",
    "\n\n\n0\n1\n0\n0\n0\n0\n\n\n\n \n5\n6\n7\n8\n!\n=\n\n\n\n7\n8\n0\n0\n0\n0\n\n\n\nActing from the left, an i, j unit matrix copies row j of the multiplicand into\nrow i of the result.",
    "From the right an i, j unit matrix picks out column i of the\nmultiplicand and copies it into column j of the result.\n",
    "\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n\n\n\n0\n1\n0\n0\n0\n0\n\n\n=\n\n\n\n0\n1\n0\n4\n0\n7\n\n\n\n3.4 Example Rescaling unit matrices simply rescales the result.",
    "This is the action\nfrom the left of the matrix that is twice the one in the prior example.\n",
    "\n\n\n0\n2\n0\n0\n0\n0\n\n\n\n \n5\n6\n7\n8\n!\n=\n\n\n\n14\n16\n0\n0\n0\n0\n\n\n\n\n246\nChapter Three.",
    "Maps Between Spaces\nNext in complication are matrices with two nonzero entries.\n",
    "3.5 Example There are two cases.",
    "If a left-multiplier has entries in diﬀerent rows\nthen their actions don’t interact.\n\n\n\n1\n0\n0\n0\n0\n2\n0\n0\n0\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n= (\n\n\n\n1\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n+\n\n\n\n0\n0\n0\n0\n0\n2\n0\n0\n0\n\n\n)\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n=\n\n\n\n1\n2\n3\n0\n0\n0\n0\n0\n0\n\n\n+\n\n\n\n0\n0\n0\n14\n16\n18\n0\n0\n0\n\n\n\n=\n\n\n\n1\n2\n3\n14\n16\n18\n0\n0\n0\n\n\n\n",
    "But if the left-multiplier’s nonzero entries are in the same row then that row of\nthe result is a combination.\n",
    "\n\n\n1\n0\n2\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n= (\n\n\n\n1\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n+\n\n\n\n0\n0\n2\n0\n0\n0\n0\n0\n0\n\n\n)\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n=\n\n\n\n1\n2\n3\n0\n0\n0\n0\n0\n0\n\n\n+\n\n\n\n14\n16\n18\n0\n0\n0\n0\n0\n0\n\n\n\n=\n\n\n\n15\n18\n21\n0\n0\n0\n0\n0\n0\n\n\n\nRight-multiplication acts in the same way, but with columns.\n",
    "3.6 Example Consider the columns of the product of two 2×2 matrices.\n \n",
    "g1,1\ng1,2\ng2,1\ng2,2\n!  \n",
    "h1,1\nh1,2\nh2,1\nh2,2\n!\n",
    "=\n \ng1,1h1,1 + g1,2h2,1\ng1,1h1,2",
    "+",
    "g1,2h2,2\ng2,1h1,1",
    "+ g2,2h2,1\ng2,1h1,2",
    "+ g2,2h2,2\n!\n",
    "Each column is the result of multiplying G by the corresponding column of H.\nG\n \nh1,1\nh2,1\n!\n=\n \ng1,1h1,1 + g1,2h2,1\ng2,1h1,1 + g2,2h2,1\n!\nG\n \nh1,2\nh2,2\n!\n",
    "=\n \ng1,1h1,2",
    "+ g1,2h2,2\ng2,1h1,2",
    "+ g2,2h2,2\n!\n",
    "3.7 Lemma In a product of two matrices G and H, the columns of GH are formed\nby taking G times the columns of H\nG ·\n\n\n\n\n...\n...\n⃗h1\n· · ·\n⃗hn\n...\n...\n\n\n\n=\n\n\n\n\n...\n...\nG · ⃗h1\n· · ·\nG · ⃗hn\n...\n...\n\n\n\n\n\nSection IV.",
    "Matrix Operations\n247\nand the rows of GH are formed by taking the rows of G times H\n\n\n\n\n· · · ⃗g1 · · ·\n...\n· · · ⃗gr · · ·\n\n\n\n· H =\n\n\n\n\n· · · ⃗g1 ·",
    "H · · ·\n...\n· · · ⃗gr · H · · ·\n\n\n\n\n(ignoring the extra parentheses).\n",
    "Proof We will check that in a product of 2×2 matrices, the rows of the product\nequal the product of the rows of G with the entire matrix H.\n \ng1,1\ng1,2\ng2,1\ng2,2\n!  \n",
    "h1,1\nh1,2\nh2,1\nh2,2\n!\n=\n \n(g1,1 g1,2)H\n(g2,1 g2,2)H\n!\n",
    "=\n \n(g1,1h1,1 + g1,2h2,1 g1,1h1,2",
    "+ g1,2h2,2)\n(g2,1h1,1 + g2,2h2,1 g2,1h1,2",
    "+ g2,2h2,2)\n!\n",
    "We leave the more general check as an exercise.\n",
    "QED\nAn application of those observations is that there is a matrix that just copies\nout the rows and columns.\n",
    "3.8 Deﬁnition The main diagonal (or principal diagonal or simply diagonal)\nof a square matrix goes from the upper left to the lower right.\n",
    "3.9 Deﬁnition An identity matrix is square and every entry is 0 except for 1’s\nin the main diagonal.\n",
    "In×n =\n\n\n\n\n\n\n1\n0\n. .",
    ".\n",
    "0\n0\n1\n. .",
    ".\n",
    "0\n...\n0\n0\n. .",
    ".\n",
    "1\n\n\n\n\n\n\n3.10 Example Here is the 2×2 identity matrix leaving its multiplicand unchanged\nwhen it acts from the right.\n",
    "\n\n\n\n\n1\n−2\n0\n−2\n1\n−1\n4\n3\n\n\n\n\n\n \n1\n0\n0\n1\n!\n=\n\n\n\n\n\n1\n−2\n0\n−2\n1\n−1\n4\n3\n\n\n\n\n\n\n248\nChapter Three.",
    "Maps Between Spaces\n3.11 Example Here the 3×3 identity leaves its multiplicand unchanged both from\nthe left\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n\n\n\n\n2\n3\n6\n1\n3\n8\n−7\n1\n0\n\n\n=\n\n\n\n2\n3\n6\n1\n3\n8\n−7\n1\n0\n\n\n\nand from the right.\n",
    "\n\n\n2\n3\n6\n1\n3\n8\n−7\n1\n0\n\n\n\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n=\n\n\n\n2\n3\n6\n1\n3\n8\n−7\n1\n0\n\n\n\nIn short, an identity matrix is the identity element of the set of n×n matrices\nwith respect to the operation of matrix multiplication.\n",
    "We can generalize the identity matrix by relaxing the ones to arbitrary reals.\n",
    "The resulting matrix rescales whole rows or columns.\n",
    "3.12 Deﬁnition A diagonal matrix is square and has 0’s oﬀthe main diagonal.\n",
    "\n\n\n\n\n\na1,1\n0\n. . .\n",
    "0\n0\na2,2\n. .",
    ".\n",
    "0\n...\n0\n0\n. .",
    ".\n",
    "an,n\n\n\n\n\n\n\n3.13 Example From the left, the action of multiplication by a diagonal matrix is\nto rescales the rows.\n \n",
    "2\n0\n0\n−1\n!  \n",
    "2\n1\n4\n−1\n−1\n3\n4\n4\n!\n",
    "=\n \n4\n2\n8\n−2\n1\n−3\n−4\n−4\n!\nFrom the right such a matrix rescales the columns.\n \n1\n2\n1\n2\n2\n2\n!",
    "\n\n\n3\n0\n0\n0\n2\n0\n0\n0\n−2\n\n\n=\n \n3\n4\n−2\n6\n4\n−4\n!\n",
    "We can also generalize identity matrices by putting a single one in each row\nand column in ways other than putting them down the diagonal.\n",
    "3.14 Deﬁnition A permutation matrix is square and is all 0’s except for a single 1\nin each row and column.\n\n",
    "Section IV.",
    "Matrix Operations\n249\n3.15 Example From the left these matrices permute rows.\n",
    "\n\n\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n=\n\n\n\n7\n8\n9\n1\n2\n3\n4\n5\n6\n\n\n\nFrom the right they permute columns.\n",
    "\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n\n\n\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\n\n=\n\n\n\n2\n3\n1\n5\n6\n4\n8\n9\n7\n\n\n\n",
    "We ﬁnish this subsection by applying these observations to get matrices that\nperform Gauss’s Method and Gauss-Jordan reduction.",
    "We have already seen\nhow to produce a matrix that rescales rows, and a row swapper.\n",
    "3.16 Example Multiplying by this matrix rescales the second row by three.\n\n\n\n1\n0\n0\n0\n3\n0\n0\n0\n1\n\n\n\n\n\n\n0\n",
    "2\n1\n1\n0\n1/3\n1\n−1\n1\n0\n2\n0\n\n\n=\n\n\n\n0\n2\n1\n1\n0\n1\n3\n−3\n1\n0\n2\n0\n\n\n\n3.17 Example",
    "This multiplication swaps the ﬁrst and third rows.\n",
    "\n\n\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\n\n\n\n\n\n0\n2\n1\n1\n0\n1\n3\n−3\n1\n0\n2\n0\n\n\n=\n\n\n\n1\n0\n2\n0\n0\n1\n3\n−3\n0\n2\n1\n1\n\n\n\nTo see how to perform a row combination",
    ", we observe something about those\ntwo examples.",
    "The matrix that rescales the second row by a factor of three\narises in this way from the identity.\n",
    "\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n\n3ρ2\n−→\n\n\n\n1\n0\n0\n0\n3\n0\n0\n0\n1\n\n\n\nSimilarly, the matrix that swaps ﬁrst and third rows arises in this way.\n",
    "\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n\nρ1↔ρ3\n−→\n\n\n\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\n\n\n3.18 Example The 3×3 matrix that arises as\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n\n−2ρ2+ρ3\n−→\n\n\n\n1\n0\n0\n0\n1\n0\n0\n−2\n1\n\n\n\n\n250\nChapter Three.",
    "Maps Between Spaces\nwill, when it acts from the left, perform the combination operation −2ρ2 + ρ3.\n",
    "\n\n\n1\n0\n0\n0\n1\n0\n0\n−2\n1\n\n\n\n\n\n\n1\n0\n2\n0\n0\n1\n3\n−3\n0\n2\n1\n1\n\n\n=\n\n\n\n1\n0\n2\n0\n0\n1\n3\n−3\n0\n0\n−5\n7\n\n\n\n3.19 Deﬁnition",
    "The elementary reduction matrices (or just elementary matri-\nces) result from applying a single Gaussian operation to an identity matrix.\n",
    "(1) I\nkρi\n−→\nMi(k) for k ̸= 0\n(2) I\nρi↔ρj\n−→\nPi,j for i ̸= j\n(3) I\nkρi+ρj\n−→\nCi,j(k) for i ̸= j\n3.20 Lemma Matrix multiplication can do Gaussian reduction.\n",
    "(1) If H\nkρi\n−→\nG then Mi(k)H = G.\n(2) If H\nρi↔ρj\n−→\nG then Pi,jH = G.\n(3) If H\nkρi+ρj\n−→\nG then Ci,j(k)H = G.\nProof Clear.\n",
    "QED\n3.21 Example",
    "This is the ﬁrst system, from the ﬁrst chapter, on which we\nperformed Gauss’s Method.\n",
    "3x3 = 9\nx1 + 5x2 −2x3 = 2\n(1/3)x1 + 2x2\n= 3\nWe can reduce it with matrix multiplication.",
    "Swap the ﬁrst and third rows,\n\n\n\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\n\n\n\n\n\n0\n0\n3\n9\n1\n5\n−2\n2\n1/3\n2\n0\n3\n\n\n=\n\n\n\n1/3\n2\n0\n3\n1\n5\n−2\n2\n0\n0\n3\n9\n\n\n\ntriple the ﬁrst row,\n\n\n\n3\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n\n\n\n\n1/3\n2\n0\n3\n1\n5\n−2\n2\n0\n0\n3\n9\n\n\n=\n\n\n\n1\n6\n0\n9\n1\n5\n−2\n2\n0\n0\n3\n9\n\n\n\n\nSection IV.",
    "Matrix Operations\n251\nand then add −1 times the ﬁrst row to the second.\n",
    "\n\n\n1\n0\n0\n−1\n1\n0\n0\n0\n1\n\n\n\n\n\n\n1\n6\n0\n9\n1\n5\n−2\n2\n0\n0\n3\n9\n\n\n=\n\n\n\n1\n6\n0\n9\n0\n−1\n−2\n−7\n0\n0\n3\n9\n\n\n\nNow back substitution will give the solution.\n",
    "3.22 Example Gauss-Jordan reduction works the same way.",
    "For the matrix ending\nthe prior example, ﬁrst turn the leading entries to ones,\n\n\n\n1\n0\n0\n0\n−1\n0\n0\n0\n1/3\n\n\n\n\n\n\n1\n6\n0\n9\n0\n−1\n−2\n−7\n0\n0\n3\n9\n\n\n=\n\n\n\n1\n6\n0\n9\n0\n1\n2\n7\n0\n0\n1\n3\n\n\n\nthen clear the third column, and then the second column.\n",
    "\n\n\n1\n−6\n0\n0\n1\n0\n0\n0\n1\n\n\n\n\n\n\n1\n0\n0\n0\n1\n−2\n0\n0\n1\n\n\n\n\n\n\n1\n6\n0\n9\n0\n1\n2\n7\n0\n0\n1\n3\n\n\n=\n\n\n\n1\n0\n0\n3\n0\n1\n0\n1\n0\n0\n1\n3\n\n\n\n3.23 Corollary",
    "For any matrix H there are elementary reduction matrices R1, . . .",
    ",\nRr such that Rr · Rr−1 · · · R1 · H is in reduced echelon form.\n",
    "Until now we have taken the point of view that our primary objects of study\nare vector spaces and the maps between them, and we seemed to have adopted\nmatrices only for computational convenience.",
    "This subsection shows that this\nisn’t the entire story.\n",
    "Understanding matrix operations by understanding the mechanics of how\nthe entries combine is also useful.",
    "In the rest of this book we shall continue to\nfocus on maps as the primary objects but we will be pragmatic — if the matrix\npoint of view gives some clearer idea then we will go with it.\n",
    "Exercises\n✓3.24 Predict the result of each product with a permutation matrix and then check\nby multiplying it out.\n",
    "(a)\n\u00120\n1\n1\n0\n\u0013 \u00121\n2\n3\n4\n\u0013\n(b)\n\u00121\n2\n3\n4\n\u0013 \u00120\n1\n1\n0\n\u0013\n(c)\n\n\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\n",
    "\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n✓3.25 Predict the result of each multiplication by an elementary reduction matrix,\nand then check by multiplying it out.\n",
    "(a)\n\u00123\n0\n0\n1\n\u0013 \u00121\n2\n3\n4\n\u0013\n(b)\n\u00121\n0\n0\n2\n\u0013 \u00121\n2\n3\n4\n\u0013\n(c)\n\u0012 1\n0\n−2\n1\n\u0013 \u00121\n2\n3\n4\n\u0013\n(d)\n\u00121\n2\n3\n4\n\u0013 \u00121\n−1\n0\n1\n\u0013\n(e)\n\u00121\n2\n3\n4\n\u0013 \u00120\n1\n1\n0\n\u0013\n3.26 Predict the result of each multiplication by a diagonal matrix, and then check\nby multiplying it out.\n\n",
    "252\nChapter Three.",
    "Maps Between Spaces\n(a)\n\u0012−3\n0\n0\n0\n\u0013 \u00121\n2\n3\n4\n\u0013\n(b)\n\u00124\n0\n0\n2\n\u0013 \u00121\n2\n3\n4\n\u0013\n3.27 Produce each.\n",
    "(a) a 3×3 matrix that, acting from the left, swaps rows one and two\n(b) a 2×2 matrix that, acting from the right, swaps column one and two\n✓3.28 Show how to use matrix multiplication to bring this matrix to echelon form.\n",
    "\n\n1\n2\n1\n0\n2\n3\n1\n−1\n7\n11\n4\n−3\n\n\n3.29 Find the product of this matrix with its transpose.\n",
    "\u0012cos θ\n−sin θ\nsin θ\ncos θ\n\u0013\n3.30",
    "The need to take linear combinations of rows and columns in tables of numbers\narises often in practice.",
    "For instance, this is a map of part of Vermont and New\nYork.\n",
    "In part because of Lake Champlain,\nthere are no roads directly connect-\ning some pairs of towns.\n",
    "For in-\nstance, there is no way to go from\nWinooski to Grand Isle without go-\ning through Colchester.\n",
    "(To sim-\nplify the graph many other roads\nand towns have been omitted.",
    "From\ntop to bottom of this map is about\nforty miles.)\n",
    "Burlington\nColchester\nGrand Isle\nSwanton\nWinooski\n(a)",
    "The adjacency matrix of a map is the square matrix whose i, j entry is the\nnumber of roads from city i to city j (all (i, i) entries are 0).\n",
    "Produce the\nadjacency matrix of this map, taking the cities in alphabetical order.\n",
    "(b) A matrix is symmetric if it equals its transpose.",
    "Show that an adjacency\nmatrix is symmetric.",
    "(These are all two-way streets.",
    "Vermont doesn’t have many\none-way streets.)\n",
    "(c) What is the signiﬁcance of the square of the incidence matrix?",
    "The cube?\n✓3.31 This table gives the number of hours of each type done by each worker, and\nthe associated pay rates.",
    "Use matrices to compute the wages due.\nregular\novertime\nAlan\n40\n12\nBetty\n35\n6\nCatherine\n40\n18\nDonald\n28\n0\nwage\nregular\n$25.00\novertime\n$45.00\n\nSection IV.",
    "Matrix Operations\n253\nRemark.",
    "This illustrates that in practice we often want to compute linear combi-\nnations of rows and columns in a context where we really aren’t interested in any\nassociated linear maps.\n3.32 Express this nonsingular matrix as a product of elementary reduction matrices.\n",
    "T =\n\n\n1\n2\n0\n2\n−1\n0\n3\n1\n2\n\n\n3.33 Express\n\u0012 1\n0\n−3\n3\n\u0013\nas the product of two elementary reduction matrices.\n",
    "✓3.34 Prove that the diagonal matrices form a subspace of Mn×n.\n",
    "What is its\ndimension?\n3.35 Does the identity matrix represent the identity map if the bases are unequal?\n",
    "3.36 Show that every multiple of the identity commutes with every square matrix.\n",
    "Are there other matrices that commute with all square matrices?\n3.37 Prove or disprove: nonsingular matrices commute.\n",
    "✓3.38 Show that the product of a permutation matrix and its transpose is an identity\nmatrix.\n3.39 Show that if the ﬁrst and second rows of G are equal then so are the ﬁrst and\nsecond rows of GH.",
    "Generalize.\n",
    "3.40 Describe the product of two diagonal matrices.\n",
    "✓3.41 Show that if G has a row of zeros then GH (if deﬁned) has a row of zeros.",
    "Does\nthat work for columns?\n3.42 Show that the set of unit matrices forms a basis for Mn×m.\n",
    "3.43 Find the formula for the n-th power of this matrix.\n",
    "\u00121\n1\n1\n0\n\u0013\n✓3.44 The trace of a square matrix is the sum of the entries on its diagonal (its\nsigniﬁcance appears in Chapter Five).",
    "Show that Tr(GH) = Tr(HG).\n",
    "3.45",
    "A square matrix is upper triangular if its only nonzero entries lie above, or\non, the diagonal.",
    "Show that the product of two upper triangular matrices is upper\ntriangular.",
    "Does this hold for lower triangular also?\n",
    "3.46 A square matrix is a Markov matrix if each entry is between zero and one and\nthe sum along each row is one.",
    "Prove that a product of Markov matrices is Markov.\n",
    "3.47 Give an example of two matrices of the same rank and size with squares of\ndiﬀering rank.\n",
    "3.48 Matrix multiplication is performed often on computers.",
    "Researchers trying to\nunderstand its performance, and improve on it, count the number of operations\nthat it takes.\n",
    "(a) Deﬁnition 2.3 gives pi,j = gi,1h1,j + gi,2h2,j + · · ·",
    "+ gi,rhr,j. How many real\nnumber multiplications are in that expression?",
    "Using it, how many do we need\nfor the product of a m×r matrix and a r×n matrix?\n\n254\nChapter Three.",
    "Maps Between Spaces\n(b) Matrix multiplication is associative, so in computing H1H2H3H4 we can expect\nto get the same answer no matter where we put the parentheses.",
    "The cost in\nnumber of multiplications, however, varies.",
    "Find the association requiring the\nfewest real number multiplications to compute the matrix product of a 5×10\nmatrix, a 10×20 matrix, a 20×5 matrix, and a 5×1 matrix.",
    "Use the same formula\nas in the prior part.\n",
    "(c) (Very hard.)",
    "Find a way to multiply two 2×2 matrices using only seven\nmultiplications instead of the eight suggested by the prior approach.\n?",
    "3.49",
    "[Putnam, 1990, A-5]",
    "If A and B are square matrices of the same size such that\nABAB = 0, does it follow that BABA = 0?\n3.50",
    "[Am.",
    "Math.",
    "Mon., Dec. 1966]",
    "Demonstrate these four assertions to get an al-\nternate proof that column rank equals row rank.\n",
    "(a) ⃗y ·",
    "⃗y = 0 iﬀ⃗y = ⃗0.\n",
    "(b) A⃗x",
    "= ⃗0 iﬀATA⃗x = ⃗0.\n",
    "(c) dim(R(A))",
    "= dim(R(ATA)).\n",
    "(d) col rank(A) = col rank(AT)",
    "= row rank(A).\n",
    "3.51",
    "[Ackerson] Prove (where A is an n×n matrix and so deﬁnes a transformation of\nany n-dimensional space V with respect to B, B where B is a basis) that dim(R(A)∩\nN (A))",
    "= dim(R(A))",
    "−dim(R(A2)).",
    "Conclude\n(a) N (A) ⊂R(A) iﬀdim(N (A))",
    "= dim(R(A))",
    "−dim(R(A2));\n(b) R(A) ⊆N (A) iﬀA2 = 0;\n(c) R(A)",
    "= N (A) iﬀA2 = 0 and dim(N (A))",
    "= dim(R(A)) ;\n(d) dim(R(A) ∩N",
    "(A))",
    "= 0 iﬀdim(R(A))",
    "= dim(R(A2)) ;\n(e) (Requires the Direct Sum subsection, which is optional.)",
    "V = R(A) ⊕N (A)\niﬀdim(R(A))",
    "= dim(R(A2)).\n",
    "IV.4\nInverses\nWe ﬁnish this section by considering how to represent the inverse of a linear map.\n",
    "We ﬁrst recall some things about inverses.",
    "Where π: R3 →R2 is the projection\nmap and ι: R2 →R3 is the embedding\n\n\n\nx\ny\nz\n\n\n\nπ\n7−→\n \nx\ny\n!\n \n",
    "x\ny\n!\nι\n7−→\n\n\n\nx\ny\n0\n\n\n\nthen the composition π ◦ι is the identity map π ◦ι",
    "= id on R2.\n \n",
    "x\ny\n!\nι\n7−→\n\n\n\nx\ny\n0\n\n\n\nπ\n7−→\n \nx\ny\n!\n\nSection IV.",
    "Matrix Operations\n255\n",
    "We say that ι is a right inverse of π or, what is the same thing, that π is a\nleft inverse of ι.",
    "However, composition in the other order ι ◦π doesn’t give the\nidentity map — here is a vector that is not sent to itself under ι ◦π.\n",
    "\n\n\n0\n0\n1\n\n\n\nπ\n7−→\n \n0\n0\n!\nι\n7−→\n\n\n\n0\n0\n0\n\n\n\n",
    "In fact, π has no left inverse at all.",
    "For, if f were to be a left inverse of π then\nwe would have\n\n\n\nx\ny\nz\n\n\n\nπ\n7−→\n \nx\ny\n!\nf\n7−→\n\n\n\nx\ny\nz\n\n\n\nfor all of the inﬁnitely many z’s.",
    "But a function f cannot send a single argument\n\u0000x\ny\n\u0001\nto more than one value.\n",
    "So a function can have a right inverse",
    "but no left inverse, or a left inverse\nbut no right inverse.",
    "A function can also fail to have an inverse on either side;\none example is the zero transformation on R2.\n",
    "Some functions have a two-sided inverse, another function that is the inverse\nboth from the left and from the right.",
    "For instance, the transformation given by\n⃗v 7→2 · ⃗v has the two-sided inverse ⃗v 7→(1/2) · ⃗v.",
    "The appendix shows that a\nfunction has a two-sided inverse if and only if it is both one-to-one and onto.\n",
    "The appendix also shows that if a function f has a two-sided inverse then it is\nunique, so we call it ‘the’ inverse and write f−1.\n",
    "In addition, recall that we have shown in Theorem II.2.20 that if a linear\nmap has a two-sided inverse then that inverse is also linear.\n",
    "Thus, our goal in this subsection is, where a linear h has an inverse, to ﬁnd\nthe relationship between RepB,D(h) and RepD,B(h−1).\n",
    "4.1 Deﬁnition A matrix G is a left inverse matrix of the matrix H if GH is the\nidentity matrix.",
    "It is a right inverse if HG is the identity.",
    "A matrix H with\na two-sided inverse is an invertible matrix.",
    "That two-sided inverse is denoted\nH−1.\n",
    "Because of the correspondence between linear maps and matrices, statements\nabout map inverses translate into statements about matrix inverses.\n",
    "4.2 Lemma If a matrix has both a left inverse and a right inverse then the two\nare equal.\n\n",
    "256\nChapter Three.",
    "Maps Between Spaces\n4.3 Theorem A matrix is invertible if and only if it is nonsingular.\n",
    "Proof (For both results.)",
    "Given a matrix H, ﬁx spaces of appropriate dimension\nfor the domain and codomain and ﬁx bases for these spaces.",
    "With respect to\nthese bases, H represents a map h.",
    "The statements are true about the map and\ntherefore they are true about the matrix.\n",
    "QED\n4.4 Lemma A product of invertible matrices is invertible: if G and H are invertible\nand GH is deﬁned then GH is invertible and (GH)−1 = H−1G−1.\nProof Because the two matrices are invertible they are square, and because\ntheir product is deﬁned they must both be n×n.",
    "Fix spaces and bases — say,\nRn with the standard bases — to get maps g, h:",
    "Rn →Rn that are associated\nwith the matrices, G = RepEn,En(g) and H = RepEn,En(h).\n",
    "Consider h−1g−1.",
    "By the prior paragraph this composition is deﬁned.",
    "This\nmap is a two-sided inverse of gh since (h−1g−1)(gh) = h−1(id)h = h−1h = id\nand (gh)(h−1g−1) = g(id)g−1 = gg−1 = id.",
    "The matrices representing the\nmaps reﬂect this equality.\n",
    "QED\n",
    "This is the arrow diagram giving the relationship between map inverses and\nmatrix inverses.",
    "It is a special case of the diagram relating function composition\nto matrix multiplication.\n",
    "Vwrt B\nWwrt C\nVwrt B\nh\nH\nh−1\nH−1\nid\nI\nBeyond its place in our program of seeing how to represent map operations,\nanother reason for our interest in inverses comes from linear systems.",
    "A linear\nsystem is equivalent to a matrix equation, as here.\n",
    "x1",
    "+ x2 = 3\n2x1 −x2 = 2\n⇐⇒\n \n1\n1\n2\n−1\n!  \n",
    "x1\nx2\n!\n=\n \n3\n2\n!\n",
    "By ﬁxing spaces and bases (for instance, R2, R2 with the standard bases), we\ntake the matrix H to represent a map h.",
    "The matrix equation then becomes\nthis linear map equation.\n",
    "h(⃗x)",
    "= ⃗d\nIf we had a left inverse map",
    "g",
    "then we could apply it to both sides g◦h(⃗x) = g(⃗d)\nto get ⃗x = g(⃗d).",
    "Restating in terms of the matrices, we want to multiply by the\ninverse matrix RepC,B(g) · RepC(⃗d) to get RepB(⃗x).\n\n",
    "Section IV.",
    "Matrix Operations\n257\n4.5 Example",
    "We can ﬁnd a left inverse for the matrix just given\n \nm\nn\np\nq\n!  \n1\n1\n2\n−1\n!\n",
    "=\n \n1\n0\n0\n1\n!\nby using Gauss’s Method to solve the resulting linear system.\n",
    "m + 2n\n= 1\nm −n\n= 0\np + 2q",
    "= 0\np −q = 1\nAnswer: m = 1/3, n = 1/3, p = 2/3, and q = −1/3.",
    "(This matrix is actually\nthe two-sided inverse of H; the check is easy.)",
    "With it, we can solve the system\nfrom the prior example.\n \n",
    "x\ny\n!\n=\n \n1/3\n1/3\n2/3\n−1/3\n!  \n3\n2\n!\n=\n \n5/3\n4/3\n!\n",
    "4.6 Remark Why solve systems with inverse matrices when we have Gauss’s\nMethod?",
    "Beyond the conceptual appeal of representing the map inverse opera-\ntion, solving linear systems this way has two advantages.\n",
    "First, once we have done the work of ﬁnding an inverse then solving a\nsystem with the same coeﬃcients but diﬀerent constants is fast: if we change\nthe constants on the right of the system above then we get a related problem\n \n1\n1\n2\n−1\n!  \n",
    "x\ny\n!\n=\n \n5\n1\n!\nthat our inverse method solves quickly.\n \n",
    "x\ny\n!\n=\n \n1/3\n1/3\n2/3\n−1/3\n!  \n",
    "5\n1\n!\n=\n \n2\n3\n!\n",
    "Another advantage of inverses is that we can explore a system’s sensitivity\nto changes in the constants.",
    "For example, tweaking the 3 on the right of the\nprior example’s system to\n \n1\n1\n2\n−1\n!  \nx1\nx2\n!\n=\n \n3.01\n2\n!\nand solving with the inverse\n \n1/3\n1/3\n2/3\n−1/3\n!  \n",
    "3.01\n2\n!\n",
    "=\n \n(1/3)(3.01) +",
    "(1/3)(2)\n(2/3)(3.01) −(1/3)(2)\n!\n\n",
    "258\nChapter Three.",
    "Maps Between Spaces\nshows that the ﬁrst component of the solution changes by 1/3 of the tweak,\nwhile the second component moves by 2/3 of the tweak.",
    "This is sensitivity\nanalysis.",
    "We could use it to decide how accurately we must specify the data in\na linear model to ensure that the solution has a desired accuracy.\n",
    "4.7 Lemma A matrix H is invertible if and only if it can be written as the product\nof elementary reduction matrices.",
    "We can compute the inverse by applying to\nthe identity matrix the same row steps, in the same order, that Gauss-Jordan\nreduce H.\nProof The matrix H is invertible if and only if it is nonsingular and thus\nGauss-Jordan reduces to the identity.",
    "By Corollary 3.23 we can do this reduction\nwith elementary matrices.\n",
    "Rr · Rr−1 . . .",
    "R1 ·",
    "H = I\n(∗)\n",
    "For the ﬁrst sentence of the result, note that elementary matrices are invertible\nbecause elementary row operations are reversible, and that their inverses are also\nelementary.",
    "Apply R−1\nr\nfrom the left to both sides of (∗).",
    "Then apply R−1\nr−1, etc.\n",
    "The result gives H as the product of elementary matrices H = R−1\n1\n· · · R−1\nr\n· I.\n(The I there covers the case r = 0.)\n",
    "For the second sentence, group (∗) as (Rr · Rr−1 . . .",
    "R1) ·",
    "H = I and recognize\nwhat’s in the parentheses as the inverse H−1 = Rr · Rr−1 . . .",
    "R1 · I. Restated:\napplying R1 to the identity, followed by R2, etc., yields the inverse of H. QED\n4.8 Example To ﬁnd the inverse of\n \n1\n1\n2\n−1\n!\n",
    "do Gauss-Jordan reduction, meanwhile performing the same operations on\nthe identity.",
    "For clerical convenience we write the matrix and the identity\nside-by-side and do the reduction steps together.\n \n",
    "1\n1\n1\n0\n2\n−1\n0\n1\n!\n",
    "−2ρ1+ρ2\n−→\n \n1\n1\n1\n0\n0\n−3\n−2\n1\n!\n−1/3ρ2\n−→\n \n1\n1\n1\n0\n0\n1\n2/3\n−1/3\n!\n−ρ2+ρ1\n−→\n \n1\n0\n1/3\n1/3\n0\n1\n2/3\n−1/3\n!\n",
    "This calculation has found the inverse.\n \n",
    "1\n1\n2\n−1\n!−1\n=\n \n1/3\n1/3\n2/3\n−1/3\n!\n\nSection IV.",
    "Matrix Operations\n259\n4.9 Example This one happens to start with a row swap.\n",
    "\n\n\n0\n3\n−1\n1\n0\n0\n1\n0\n1\n0\n1\n0\n1\n−1\n0\n0\n0\n1\n\n\n\nρ1↔ρ2\n−→\n\n\n\n1\n0\n1\n0\n1\n0\n0\n3\n−1\n1\n0\n0\n1\n−1\n0\n0\n0\n1\n\n\n\n−ρ1+ρ3\n−→\n\n\n\n1\n0\n1\n0\n1\n0\n0\n3\n−1\n1\n0\n0\n0\n−1\n−1\n0\n−1\n1\n\n\n\n...\n−→\n\n\n\n1\n0\n0\n1/4\n1/4\n3/4\n0\n1\n0\n1/4\n1/4\n−1/4\n0\n0\n1\n−1/4\n3/4\n−3/4\n\n\n\n4.10 Example",
    "This algorithm detects a non-invertible matrix when the left half\nwon’t reduce to the identity.\n \n1\n1\n1\n0\n2\n2\n0\n1\n!\n−2ρ1+ρ2\n−→\n \n1\n1\n1\n0\n0\n0\n−2\n1\n!\n",
    "With this procedure we can give a formula for the inverse of a general 2×2\nmatrix, which is worth memorizing.\n",
    "4.11 Corollary The inverse for a 2×2 matrix exists and equals\n \na\nb\nc\nd\n!",
    "−1\n=\n1\nad −bc\n \nd\n−b\n−c\na\n!\n",
    "if and only if ad −bc ̸= 0.\nProof This computation is Exercise 21.\n",
    "QED\nWe have seen in this subsection, as in the subsection on Mechanics of Matrix\nMultiplication, how to exploit the correspondence between linear maps and\nmatrices.",
    "We can fruitfully study both maps and matrices, translating back and\nforth to use whichever is handiest.\n",
    "Over the course of this entire section we have developed an algebra system\nfor matrices.",
    "We can compare it with the familiar algebra of real numbers.\n",
    "Matrix addition and subtraction work in much the same way as the real number\noperations except that they only combine same-sized matrices.",
    "Scalar multipli-\ncation is in some ways an extension of real number multiplication.",
    "We also have\na matrix multiplication operation and its inverse that are somewhat like the\nfamiliar real number operations (associativity, and distributivity over addition,\n\n260\nChapter Three.",
    "Maps Between Spaces\nfor example), but there are diﬀerences (failure of commutativity).",
    "This section\nprovides an example that algebra systems other than the usual real number one\ncan be interesting and useful.\n",
    "Exercises\n4.12 Supply the intermediate steps in Example 4.9.\n",
    "✓4.13 Use Corollary 4.11 to decide if each matrix has an inverse.\n",
    "(a)\n\u0012 2\n1\n−1\n1\n\u0013\n(b)\n\u00120\n4\n1\n−3\n\u0013\n(c)\n\u0012 2\n−3\n−4\n6\n\u0013\n✓4.14 For each invertible matrix in the prior problem, use Corollary 4.11 to ﬁnd its\ninverse.\n",
    "✓4.15 Find the inverse, if it exists, by using the Gauss-Jordan Method.",
    "Check the\nanswers for the 2×2 matrices with Corollary 4.11.\n",
    "(a)\n\u00123\n1\n0\n2\n\u0013\n(b)\n\u00122\n1/2\n3\n1\n\u0013\n(c)\n\u0012 2\n−4\n−1\n2\n\u0013\n(d)\n\n\n1\n1\n3\n0\n2\n4\n−1\n1\n0\n\n\n(e)\n\n\n0\n1\n5\n0\n−2\n4\n2\n3\n−2\n\n",
    "\n(f)\n\n\n2\n2\n3\n1\n−2\n−3\n4\n−2\n−3\n\n\n✓4.16 What matrix has this one for its inverse?\n\u00121\n3\n2\n5\n\u0013\n4.17 How does the inverse operation interact with scalar multiplication and addition\nof matrices?\n(a)",
    "What is the inverse of rH?\n(b) Is (H + G)−1 = H−1 + G−1?\n✓4.18 Is (T k)−1",
    "= (T −1)k?\n4.19 Is H−1 invertible?\n",
    "4.20",
    "For each real number θ let tθ : R2 →R2 be represented with respect to the\nstandard bases by this matrix.\n",
    "\u0012cos θ\n−sin θ\nsin θ\ncos θ\n\u0013\nShow that tθ1+θ2 = tθ1 · tθ2.",
    "Show also that tθ−1 = t−θ.\n",
    "4.21 Do the calculations for the proof of Corollary 4.11.\n",
    "4.22 Show that this matrix\nH =\n\u00121\n0\n1\n0\n1\n0\n\u0013\nhas inﬁnitely many right inverses.",
    "Show also that it has no left inverse.\n",
    "4.23 In the review of inverses example, starting this subsection, how many left\ninverses has ι?\n4.24",
    "If a matrix has inﬁnitely many right-inverses, can it have inﬁnitely many\nleft-inverses?",
    "Must it have?\n\nSection IV.",
    "Matrix Operations\n261\n4.25 Assume that g: V →W is linear.",
    "One of these is true, the other is false.",
    "Which\nis which?\n(a) If f: W →V is a left inverse of g then f must be linear.\n(b) If f: W →V is a right inverse of g then f must be linear.\n",
    "✓4.26 Assume that H is invertible and that HG is the zero matrix.",
    "Show that G is a\nzero matrix.\n",
    "4.27 Prove that if H is invertible then the inverse commutes with a matrix GH−1 =\nH−1G if and only if H itself commutes with that matrix GH = HG.\n✓4.28 Show that if T is square and if T 4 is the zero matrix then (I−T)−1 = I+T+T 2+T 3.\nGeneralize.\n",
    "✓4.29 Let D be diagonal.",
    "Describe D2, D3, . . . , etc. Describe D−1, D−2, . . . , etc.\nDeﬁne D0 appropriately.\n",
    "4.30 Prove that any matrix row-equivalent to an invertible matrix is also invertible.\n",
    "4.31 The ﬁrst question below appeared as Exercise 30.\n(a) Show that the rank of the product of two matrices is less than or equal to the\nminimum of the rank of each.\n",
    "(b) Show that if T and S are square then TS",
    "= I if and only if ST = I.\n4.32 Show that the inverse of a permutation matrix is its transpose.\n",
    "4.33\n(a) Show that (GH)T = HTGT.\n(b) A square matrix is symmetric if each i, j entry equals the j, i entry (that is,\nif the matrix equals its transpose).",
    "Show that the matrices HHT and HTH are\nsymmetric.\n",
    "(c) Show that the inverse of the transpose is the transpose of the inverse.\n",
    "(d) Show that the inverse of a symmetric matrix is symmetric.\n",
    "✓4.34\n(a) Prove that the composition of the projections πx, πy : R3 →R3 is the zero\nmap despite that neither is the zero map.\n(b) Prove that the composition of the derivatives d2/dx2, d3/dx3 : P4 →P4 is the\nzero map despite that neither map is the zero map.\n",
    "(c) Give matrix equations representing each of the prior two items.\n",
    "When two things multiply to give zero despite that neither is zero, each is said\nto be a zero divisor.",
    "Prove that no zero divisor is invertible.\n",
    "4.35",
    "In the algebra of real numbers, quadratic equations have at most two solutions.\n",
    "Matrix algebra is diﬀerent.",
    "Show that the 2×2 matrix equation T 2 = I has more\nthan two solutions.\n",
    "4.36 Is the relation ‘is a two-sided inverse of’ transitive?",
    "Reﬂexive?",
    "Symmetric?\n4.37",
    "[Am.",
    "Math.",
    "Mon., Nov. 1951]",
    "Prove: if the sum of the elements of each row\nof a square matrix is k, then the sum of the elements in each row of the inverse\nmatrix is 1/k.\n\n262\nChapter Three.",
    "Maps Between Spaces\nV\nChange of Basis\nRepresentations vary with the bases.",
    "For instance, with respect to the bases E2\nand\nB = ⟨\n \n1\n1\n!\n,\n \n1\n−1\n!\n",
    "⟩\n⃗e1 ∈R2 has these diﬀerent representations.\n",
    "RepE2(⃗e1) =\n \n1\n0\n!\n",
    "RepB(⃗e1) =\n \n1/2\n1/2\n!\n",
    "The same holds for maps: with respect to the basis pairs E2, E2 and E2, B, the\nidentity map has these representations.\nRepE2,E2(id)",
    "=\n \n1\n0\n0\n1\n!\nRepE2,B(id)",
    "=\n \n1/2\n1/2\n1/2\n−1/2\n!\n",
    "This section shows how to translate among the representations.",
    "That is, we will\ncompute how the representations vary as the bases vary.\n",
    "V.1\nChanging Representations of Vectors\nIn converting RepB(⃗v) to RepD(⃗v) the underlying vector ⃗v doesn’t change.",
    "Thus,\nthe translation between these two ways of expressing the vector is accomplished\nby the identity map on the space, described so that the domain space vectors are\nrepresented with respect to B and the codomain space vectors are represented\nwith respect to D.\nVwrt B\nid\ny\nVwrt D\n(This diagram is vertical to ﬁt with the ones in the next subsection.)\n",
    "1.1 Deﬁnition The change of basis matrix for bases B, D ⊂V is the representa-\ntion of the identity map id: V →V with respect to those bases.\n",
    "RepB,D(id) =\n\n\n\n\n...\n...\nRepD(⃗β1)\n· · ·\nRepD(⃗βn)\n...\n...\n\n\n\n\n\nSection V. Change of Basis\n263\n1.2 Remark A better name would be ‘change of representation matrix’ but the\nabove name is standard.\n",
    "The next result supports the deﬁnition.\n",
    "1.3 Lemma To convert from the representation of a vector ⃗v with respect to B\nto its representation with respect to D use the change of basis matrix.\nRepB,D(id) RepB(⃗v) = RepD(⃗v)\n",
    "Conversely, if left-multiplication by a matrix changes bases M · RepB(⃗v) =\nRepD(⃗v) then M is a change of basis matrix.\n",
    "Proof The ﬁrst sentence holds because matrix-vector multiplication represents\na map application and so RepB,D(id) · RepB(⃗v)",
    "= RepD( id(⃗v) )",
    "= RepD(⃗v) for\neach ⃗v.",
    "For the second sentence, with respect to B, D the matrix M represents\na linear map whose action is to map each vector to itself, and is therefore the\nidentity map.\n",
    "QED\n1.4 Example With these bases for R2,\nB = ⟨\n \n2\n1\n!\n,\n \n1\n0\n!\n⟩\nD = ⟨\n \n−1\n1\n!\n,\n \n1\n1\n!\n",
    "⟩\nbecause\nRepD( id(\n \n2\n1\n!\n))",
    "=\n \n−1/2\n3/2\n!\nD\nRepD( id(\n \n1\n0\n!\n))",
    "=\n \n−1/2\n1/2\n!\n",
    "D\nthe change of basis matrix is this.\nRepB,D(id) =\n \n−1/2\n−1/2\n3/2\n1/2\n!\n",
    "For instance, this is the representation of ⃗e2\nRepB(\n \n0\n1\n!\n)",
    "=\n \n1\n−2\n!\nand the matrix does the conversion.\n \n",
    "−1/2\n−1/2\n3/2\n1/2\n!  \n",
    "1\n−2\n!\n=\n \n1/2\n1/2\n!\n",
    "Checking that vector on the right is RepD(⃗e2) is easy.\n\n",
    "264\nChapter Three.",
    "Maps Between Spaces\nWe ﬁnish this subsection by recognizing the change of basis matrices as a\nfamiliar set.\n",
    "1.5 Lemma A matrix changes bases if and only if it is nonsingular.\n",
    "Proof For the ‘only if’ direction, if left-multiplication by a matrix changes\nbases then the matrix represents an invertible function, simply because we can\ninvert the function by changing the bases back.",
    "Because it represents a function\nthat is invertible, the matrix itself is invertible, and so is nonsingular.\n",
    "For ‘if’ we will show that any nonsingular matrix M performs a change of\nbasis operation from any given starting basis B (having n vectors, where the\nmatrix is n×n) to some ending basis.\n",
    "If the matrix is the identity I then the statement is obvious.",
    "Otherwise\nbecause the matrix is nonsingular Corollary IV.3.23 says there are elementary\nreduction matrices such that Rr · · ·",
    "R1 ·",
    "M = I with r ⩾1.",
    "Elementary matrices\nare invertible and their inverses are also elementary so multiplying both sides of\nthat equation from the left by Rr\n−1, then by Rr−1\n−1, etc., gives M as a product\nof elementary matrices M = R1\n−1 · · ·",
    "Rr\n−1.\n",
    "We will be done if we show that elementary matrices change a given basis to\nanother basis, since then Rr\n−1 changes B to some other basis Br and Rr−1\n−1\nchanges Br to some Br−1, etc.",
    "We will cover the three types of elementary\nmatrices separately; recall the notation for the three.\nMi(k)\n\n\n\n\n\n\n\n\n\nc1\n...\nci\n...\n",
    "cn\n\n\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n\n\nc1\n...\n",
    "kci\n...\ncn\n\n\n\n\n\n\n\n\n\nPi,j\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nc1\n...\n",
    "ci\n...\ncj\n...\ncn\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nc1\n...\ncj\n...\n",
    "ci\n...\ncn\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCi,j(k)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nc1\n...\nci\n...\ncj\n...\ncn\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nc1\n...\nci\n...\n",
    "kci + cj\n...\ncn\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nApplying a row-multiplication matrix Mi(k) changes a representation with\nrespect to ⟨⃗β1, . . .",
    ", ⃗βi, . .",
    ". , ⃗βn⟩to one with respect to ⟨⃗β1, . .",
    ".",
    ", (1/k)⃗βi, . . .",
    ", ⃗βn⟩.\n⃗v = c1 · ⃗β1 + · · · + ci · ⃗βi + · · · + cn · ⃗βn\n7→c1 · ⃗β1 + · · · + kci · (1/k)⃗βi + · · · + cn · ⃗βn = ⃗v\nThe second one is a basis because the ﬁrst is a basis and because of the k ̸= 0\nrestriction in the deﬁnition of a row-multiplication matrix.\n",
    "Similarly, left-\nmultiplication by a row-swap matrix Pi,j changes a representation with respect\n\nSection V. Change of Basis\n265\nto the basis ⟨⃗β1, . . .",
    ", ⃗βi, . . . , ⃗βj, . . .",
    ", ⃗βn⟩into one with respect to this basis\n⟨⃗β1, . . .",
    ", ⃗βj, . . .",
    ", ⃗βi, . . . , ⃗βn⟩.\n⃗v = c1 · ⃗β1 + · · · + ci · ⃗βi + · · ·",
    "+ cj⃗βj",
    "+ · · · + cn · ⃗βn\n7→c1 · ⃗β1 + · · · + cj · ⃗βj + · · · + ci · ⃗βi + · · · + cn ·",
    "⃗βn = ⃗v\n",
    "And, a representation with respect to ⟨⃗β1, . . .",
    ", ⃗βi, . . . , ⃗βj, . . .",
    ", ⃗βn⟩changes via\nleft-multiplication by a row-combination matrix Ci,j(k) into a representation\nwith respect to ⟨⃗β1, . . .",
    ", ⃗βi −k⃗βj, . . .",
    ", ⃗βj, . . .",
    ", ⃗βn⟩\n⃗v = c1 · ⃗β1 + · · · + ci · ⃗βi + cj⃗βj + · · · + cn · ⃗βn\n7→c1 · ⃗β1 + · · · + ci · (⃗βi −k⃗βj) + · · · + (kci + cj) ·",
    "⃗βj + · · · + cn · ⃗βn = ⃗v\n(the deﬁnition of Ci,j(k) speciﬁes that i ̸= j and k ̸= 0).\n",
    "QED\n1.6 Corollary A matrix is nonsingular if and only if it represents the identity map\nwith respect to some pair of bases.\n",
    "Exercises\n✓1.7 In R2, where\nD = ⟨\n\u00122\n1\n\u0013\n,\n\u0012−2\n4\n\u0013\n⟩\nﬁnd the change of basis matrices from D to E2 and from E2 to D. Multiply the\ntwo.\n1.8 Which of these matrices could be used to change bases?\n(a)\n\u00121\n2\n3\n4\n\u0013\n(b)\n\u00120\n−1\n1\n−1\n\u0013\n(c)\n",
    "\u00122\n3\n−1\n0\n1\n0\n\u0013\n(d)\n\n\n2\n3\n−1\n0\n1\n0\n4\n7\n−2\n\n\n(e)\n\n\n0\n2\n0\n0\n0\n6\n1\n0\n0\n\n\n✓1.9 Find the change of basis matrix for B, D ⊆R2.\n(a) B = E2, D = ⟨⃗e2,⃗e1⟩\n(b) B = E2, D = ⟨\n\u00121\n2\n\u0013\n,\n\u00121\n4\n\u0013\n⟩\n(c) B = ⟨\n\u00121\n2\n\u0013\n,\n\u00121\n4\n\u0013\n⟩, D = E2\n(d) B = ⟨\n\u0012−1\n1\n\u0013\n,\n\u00122\n2\n\u0013\n⟩, D = ⟨\n\u00120\n4\n\u0013\n,\n\u00121\n3\n\u0013\n⟩\n✓1.10 Find the change of basis matrix for each B, D ⊆P2.\n(a) B = ⟨1, x, x2⟩, D = ⟨x2, 1, x⟩\n(b) B = ⟨1, x, x2⟩, D = ⟨1, 1 + x, 1 + x + x2⟩\n(c) B = ⟨2, 2x, x2⟩, D = ⟨1 + x2, 1 −x2, x + x2⟩\n1.11 For the bases in Exercise 9, ﬁnd the change of basis matrix in the other direction,\nfrom D to B.\n✓1.12 Decide if each changes bases on R2.",
    "To what basis is E2 changed?\n\n266\nChapter Three.",
    "Maps Between Spaces\n(a)\n\u00125\n0\n0\n4\n\u0013\n(b)\n",
    "\u00122\n1\n3\n1\n\u0013\n(c)\n\u0012−1\n4\n2\n−8\n\u0013\n(d)\n\u00121\n−1\n1\n1\n\u0013\n1.13 For each space ﬁnd the matrix changing a vector representation with respect\nto B to one with respect to D.\n(a) V = R3, B = E3, D = ⟨\n\n\n1\n2\n3\n\n,\n\n\n1\n1\n1\n\n,\n\n\n0\n1\n−1\n\n⟩\n(b) V = R3, B = ⟨\n\n\n1\n2\n3\n\n,\n\n\n1\n1\n1\n\n,\n\n\n0\n1\n−1\n\n⟩, D = E3\n(c) V = P2, B = ⟨x2, x2 + x, x2",
    "+ x",
    "+ 1⟩, D = ⟨2, −x, x2⟩\n1.14 Find bases such that this matrix represents the identity map with respect to\nthose bases.\n",
    "\n\n3\n1\n4\n2\n−1\n1\n0\n0\n4\n\n\n1.15 Consider the vector space of real-valued functions with basis ⟨sin(x), cos(x)⟩.\nShow that ⟨2 sin(x) + cos(x), 3 cos(x)⟩is also a basis for this space.",
    "Find the change\nof basis matrix in each direction.\n",
    "1.16 Where does this matrix\n\u0012cos(2θ)\nsin(2θ)\nsin(2θ)\n−cos(2θ)\n\u0013\nsend the standard basis for R2?",
    "Any other bases?",
    "Hint.",
    "Consider the inverse.\n",
    "✓1.17 What is the change of basis matrix with respect to B, B?\n1.18 Prove that a matrix changes bases if and only if it is invertible.\n",
    "1.19 Finish the proof of Lemma 1.5.\n",
    "✓1.20 Let H be an n×n nonsingular matrix.",
    "What basis of Rn does H change to the\nstandard basis?\n✓1.21\n(a) In P3 with basis B = ⟨1+x, 1−x, x2+x3, x2−x3⟩we have this representation.\n",
    "RepB(1 −x + 3x2 −x3)",
    "=\n\n\n\n\n0\n1\n1\n2\n\n\n\n\nB\nFind a basis D giving this diﬀerent representation for the same polynomial.\n",
    "RepD(1 −x + 3x2 −x3)",
    "=\n\n\n\n\n1\n0\n2\n0\n\n\n\n\nD\n(b) State and prove that we can change any nonzero vector representation to any\nother.\n",
    "Hint.",
    "The proof of Lemma 1.5 is constructive — it not only says the bases change,\nit shows how they change.\n",
    "1.22 Let V, W be vector spaces, and let B, ˆB be bases for V and D, ˆD be bases for\nW. Where h: V →W is linear, ﬁnd a formula relating RepB,D(h) to RepˆB, ˆD(h).\n\n",
    "Section V. Change of Basis\n267\n✓1.23 Show that the columns of an n×n change of basis matrix form a basis for\nRn.",
    "Do all bases appear in that way: can the vectors from any Rn basis make the\ncolumns of a change of basis matrix?\n✓1.24 Find a matrix having this eﬀect.\n",
    "\u00121\n3\n\u0013\n7→\n\u0012 4\n−1\n\u0013\nThat is, ﬁnd a M that left-multiplies the starting vector to yield the ending vector.\n",
    "Is there a matrix having these two eﬀects?\n(a)\n\u00121\n3\n\u0013\n7→\n\u00121\n1\n\u0013\n\u0012 2\n−1\n\u0013\n",
    "7→\n\u0012−1\n−1\n\u0013\n(b)\n\u00121\n3\n\u0013\n7→\n\u00121\n1\n\u0013\n\u00122\n6\n\u0013\n7→\n\u0012−1\n−1\n\u0013\nGive a necessary and suﬃcient condition for there to be a matrix such that ⃗v1 7→⃗w1\nand ⃗v2 7→⃗w2.\nV.2\nChanging Map Representations\nThe ﬁrst subsection shows how to convert the representation of a vector with\nrespect to one basis to the representation of that same vector with respect to\nanother basis.",
    "We next convert the representation of a map with respect to one\npair of bases to the representation with respect to a diﬀerent pair — we convert\nfrom RepB,D(h) to RepˆB, ˆD(h).",
    "Here is the arrow diagram.\n",
    "Vwrt B\nh\n−−−−→\nH\nWwrt D\nid\ny\nid\ny\nVwrt ˆB\nh\n−−−−→\nˆH\nWwrt ˆD\nTo move from the lower-left to the lower-right we can either go straight over,\nor else up to VB then over to WD and then down.",
    "So we can calculate ˆH =\nRepˆB, ˆD(h) either by directly using ˆB and ˆD, or else by ﬁrst changing bases with\nRepˆB,B(id) then multiplying by H = RepB,D(h) and then changing bases with\nRepD, ˆD(id).\n",
    "2.1 Theorem To convert from the matrix H representing a map h with respect\nto B, D to the matrix ˆH representing it with respect to ˆB, ˆD use this formula.\n",
    "ˆH = RepD, ˆD(id) ·",
    "H · RepˆB,B(id)\n(∗)\nProof This is evident from the diagram.\n",
    "QED\n\n268\nChapter Three.",
    "Maps Between Spaces\n2.2 Example",
    "The matrix\nT =\n \ncos(π/6)\n−sin(π/6)\nsin(π/6)\ncos(π/6)\n!\n=\n √\n3/2\n−1/2\n1/2\n√\n3/2\n!\nrepresents, with respect to E2, E2, the transformation t: R2 →R2 that rotates\nvectors through the counterclockwise angle of π/6 radians.\n",
    "\u00121\n3\n\u0013\n\u0012(−3",
    "+\n√\n3)/2\n(1 + 3\n√\n3)/2\n\u0013\ntπ/6\n−→\nWe can translate T to a representation with respect to these\nˆB = ⟨\n \n1\n1\n!  \n0\n2\n!\n⟩\nˆD = ⟨\n \n−1\n0\n!  \n",
    "2\n3\n!\n",
    "⟩\nby using the arrow diagram above.\n",
    "R2\nwrt E2\nt\n−−−−→\nT\nR2\nwrt E2\nid\ny\nid\ny\nR2\nwrt ˆB\nt\n−−−−→\nˆT\nR2\nwrt ˆD\nThe picture illustrates that we can compute ˆT either directly by going along the\nsquare’s bottom, or as in formula (∗) by going up on the left, then across the\ntop, and then down on the right, with ˆT = RepE2, ˆD(id) ·",
    "T · RepˆB,E2(id).",
    "(Note\nagain that the matrix multiplication reads right to left, as the three functions\nare composed and function composition reads right to left.)\nFind the matrix for the left-hand side, the matrix RepˆB,E2(id), in the usual\nway: ﬁnd the eﬀect of the identity matrix on the starting basis ˆB — which is\nno eﬀect at all — and then represent those basis elements with respect to the\nending basis E2.\n",
    "RepˆB,E2(id) =\n \n1\n0\n1\n2\n!\n",
    "This calculation is easy when the ending basis is the standard one.\n",
    "There are two ways to compute the matrix for going down the square’s right\nside, RepE2, ˆD(id).",
    "We could calculate it directly as we did for the other change\nof basis matrix.",
    "Or, we could instead calculate it as the inverse of the matrix\n\nSection V. Change of Basis\n269\nfor going up Rep ˆD,E2(id).",
    "That matrix is easy to ﬁnd",
    "and we have a formula\nfor the 2×2 inverse, so that’s what is in the equation below.\n",
    "RepˆB, ˆD(t) =\n \n−1\n2\n0\n3\n!−1  √\n3/2\n−1/2\n1/2\n√\n3/2\n!  \n",
    "1\n0\n1\n2\n!\n=\n \n(5 −\n√\n3)/6\n(3 + 2\n√\n3)/3\n(1 +\n√\n3)/6\n√\n3/3\n!\n",
    "The matrix is messier but the map that it represents is the same.",
    "For instance,\nto replicate the eﬀect of t in the picture, start with ˆB,\nRepˆB(\n \n1\n3\n!\n)",
    "=\n \n1\n1\n!\nˆB\napply ˆT,\n \n(5 −\n√\n3)/6\n(3 + 2\n√\n3)/3\n(1 +\n√\n3)/6\n√\n3/3\n!\n",
    "ˆB, ˆD\n \n1\n1\n!\n",
    "ˆB\n=\n \n(11 + 3\n√\n3)/6\n(1 + 3\n√\n3)/6\n!\nˆD\nand check it against ˆD.\n11 + 3\n√\n3\n6\n·\n \n−1\n0\n!\n",
    "+ 1 + 3\n√\n3\n6\n·\n \n2\n3\n!\n",
    "=\n \n(−3 +\n√\n3)/2\n(1 + 3\n√\n3)/2\n!\n2.3 Example Changing bases can make the matrix simpler.",
    "On R3 the map\n\n\n\nx\ny\nz\n\n\n\nt\n7−→\n\n\n\ny + z\nx + z\nx + y\n\n\n\nis represented with respect to the standard basis in this way.\n",
    "RepE3,E3(t) =\n\n\n\n0\n1\n1\n1\n0\n1\n1\n1\n0\n\n",
    "\n\nRepresenting it with respect to\nB = ⟨\n\n\n\n1\n−1\n0\n\n\n,\n\n\n\n1\n1\n−2\n\n\n,\n\n\n\n1\n1\n1\n\n\n⟩\ngives a matrix that is diagonal.\nRepB,B(t) =\n\n\n\n−1\n0\n0\n0\n−1\n0\n0\n0\n2\n\n\n\n\n270\nChapter Three.",
    "Maps Between Spaces\nNaturally we usually prefer representations that are easier to understand.\n",
    "We say that a map or matrix has been diagonalized when we ﬁnd a basis B such\nthat the representation is diagonal with respect to B, B, that is, with respect\nto the same starting basis as ending basis.",
    "Chapter Five ﬁnds which maps and\nmatrices are diagonalizable.\n",
    "The rest of this subsection develops the easier case of ﬁnding two bases B, D\nsuch that a representation is simple.",
    "Recall that the prior subsection shows that\na matrix is a change of basis matrix if and only if it is nonsingular.\n",
    "2.4 Deﬁnition Same-sized matrices H and ˆH are matrix equivalent if there are\nnonsingular matrices P and Q such that ˆH = PHQ.\n2.5 Corollary Matrix equivalent matrices represent the same map, with respect\nto appropriate pairs of bases.\n",
    "Proof This is immediate from equation (∗) above.\n",
    "QED\nExercise 24 checks that matrix equivalence is an equivalence relation.",
    "Thus\nit partitions the set of matrices into matrix equivalence classes.\n",
    "All matrices:\n. . .\n",
    "H\nˆH\nH matrix equivalent\nto ˆH\nWe can get insight into the classes by comparing matrix equivalence with row\nequivalence (remember that matrices are row equivalent when they can be\nreduced to each other by row operations).",
    "In ˆH = PHQ, the matrices P and Q\nare nonsingular and thus each is a product of elementary reduction matrices\nby Lemma IV.4.7.",
    "Left-multiplication by the reduction matrices making up P\nperforms row operations.",
    "Right-multiplication by the reduction matrices making\nup Q performs column operations.",
    "Hence, matrix equivalence is a generalization\nof row equivalence — two matrices are row equivalent if one can be converted to\nthe other by a sequence of row reduction steps, while two matrices are matrix\nequivalent if one can be converted to the other by a sequence of row reduction\nsteps followed by a sequence of column reduction steps.\n",
    "Consequently, if matrices are row equivalent then they are also matrix\nequivalent since we can take Q to be the identity matrix.",
    "The converse, however,\ndoes not hold: two matrices can be matrix equivalent but not row equivalent.\n",
    "2.6 Example These two are matrix equivalent\n \n1\n0\n0\n0\n!\n \n1\n1\n0\n0\n!\n\nSection V. Change of Basis\n271\nbecause the second reduces to the ﬁrst by the column operation of taking −1\ntimes the ﬁrst column and adding to the second.",
    "They are not row equivalent\nbecause they have diﬀerent reduced echelon forms (both are already in reduced\nform).\n",
    "We close this section by giving a set of representatives for the matrix equiva-\nlence classes.\n",
    "2.7 Theorem Any m×n matrix of rank k is matrix equivalent to the m×n matrix\nthat is all zeros except that the ﬁrst k diagonal entries are ones.\n",
    "\n\n\n\n\n\n\n\n\n\n\n\n\n1\n0\n. . .\n",
    "0\n0\n. .",
    ".\n",
    "0\n0\n1\n. . .\n",
    "0\n0\n. .",
    ".\n",
    "0\n...\n0\n0\n. .",
    ".\n",
    "1\n0\n. .",
    ".\n",
    "0\n0\n0\n. .",
    ".\n",
    "0\n0\n. .",
    ".\n",
    "0\n...\n0\n0\n. .",
    ".\n",
    "0\n0\n. .",
    ".\n",
    "0\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "This is a block partial-identity form.\n \n",
    "I\nZ\nZ\nZ\n!\nProof Gauss-Jordan reduce the given matrix and combine all the row reduction\nmatrices to make P. Then use the leading entries to do column reduction and\nﬁnish by swapping the columns to put the leading ones on the diagonal.",
    "Combine\nthe column reduction matrices into Q.\nQED\n2.8 Example",
    "We illustrate the proof by ﬁnding P and Q for this matrix.\n\n\n\n1\n2\n1\n−1\n0\n0\n1\n−1\n2\n4\n2\n−2\n\n\n\nFirst Gauss-Jordan row-reduce.\n",
    "\n\n\n1\n−1\n0\n0\n1\n0\n0\n0\n1\n\n\n\n\n\n\n1\n0\n0\n0\n1\n0\n−2\n0\n1\n\n\n\n\n\n\n1\n2\n1\n−1\n0\n0\n1\n−1\n2\n4\n2\n−2\n\n\n=\n\n\n\n1\n2\n0\n0\n0\n0\n1\n−1\n0\n0\n0\n0\n\n\n\nThen column-reduce, which involves right-multiplication.\n",
    "\n\n\n1\n2\n0\n0\n0\n0\n1\n−1\n0\n0\n0\n0\n\n\n\n\n\n\n\n\n1\n−2\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n\n\n\n\n\n\n\n\n\n\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n1\n0\n0\n0\n1\n\n\n\n\n=\n\n\n\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n\n\n272\nChapter Three.",
    "Maps Between Spaces\nFinish by swapping columns.\n",
    "\n\n\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n\n1\n0\n0\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n1\n\n\n\n\n=\n\n\n\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n\nFinally, combine the left-multipliers together as P and the right-multipliers\ntogether as Q to get PHQ.\n\n\n\n1\n−1\n0\n0\n1\n0\n−2\n0\n1\n\n\n\n\n\n\n1\n2\n1\n−1\n0\n0\n1\n−1\n2\n4\n2\n−2\n\n\n\n\n\n\n\n\n1\n0\n−2\n0\n0\n0\n1\n0\n0\n1\n0\n1\n0\n0\n0\n1\n\n\n\n\n=\n\n\n\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n\n2.9 Corollary Matrix equivalence classes are characterized by rank: two same-sized\nmatrices are matrix equivalent if and only if they have the same rank.\n",
    "Proof Two same-sized matrices with the same rank are equivalent to the same\nblock partial-identity matrix.\n",
    "QED\n2.10 Example",
    "The 2×2 matrices have only three possible ranks: zero, one, or two.\n",
    "Thus there are three matrix equivalence classes.\n",
    "All 2×2 matrices:\n⋆\n\u0012\n0\n0\n0\n0\u0013\n⋆\n\u0012\n0\n1\n0\n0\u0013\n⋆\n\u0012\n0\n1\n1\n0\u0013\nThree equivalence\nclasses\nEach class consists of all of the 2×2 matrices with the same rank.",
    "There is\nonly one rank zero matrix.",
    "The other two classes have inﬁnitely many members;\nwe’ve shown only the canonical representative.\n",
    "One nice thing about the representative in Theorem 2.7 is that we can\ncompletely understand the linear map when it is expressed in this way: where\nthe bases are B = ⟨⃗β1, . . .",
    ", ⃗βn⟩and D = ⟨⃗δ1, . . .",
    ",⃗δm⟩then the map’s action is\nc1⃗β1 + · · · + ck⃗βk + ck+1⃗βk+1 + · · · + cn⃗βn",
    "7→c1⃗δ1 + · · · + ck⃗δk +⃗0 + · · · +⃗0\nwhere k is the rank.",
    "Thus we can view any linear map as a projection.\n\n\n\n\n\n\n\n\n\n\n\nc1\n...\nck\nck+1\n...\n",
    "cn\n\n\n\n\n\n\n\n\n\n\n\nB\n7−→\n\n\n\n\n\n\n\n\n\n\n\nc1\n...\n",
    "ck\n0\n...\n0\n\n\n\n\n\n\n\n\n\n\n\nD\n\nSection V. Change of Basis\n273\nExercises\n✓2.11 Decide if these are matrix equivalent.\n",
    "(a)\n\u00121\n3\n0\n2\n3\n0\n\u0013\n,\n\u00122\n2\n1\n0\n5\n−1\n\u0013\n(b)\n\u00120\n3\n1\n1\n\u0013\n,\n\u00124\n0\n0\n5\n\u0013\n(c)\n\u00121\n3\n2\n6\n\u0013\n,\n\u00121\n3\n2\n−6\n\u0013\n2.12",
    "Which of these are matrix equivalent to each other?\n(a)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n(b)\n\u0012 1\n3\n−1\n−3\n\u0013\n(c)\n\u0012−5\n1\n0\n−1\n0\n1\n\u0013\n(d)\n\u00120\n−1\n0\n5\n\u0013\n(e)\n\n\n1\n0\n1\n2\n0\n2\n1\n3\n1\n\n\n(f)\n\n\n3\n1\n0\n9\n3\n0\n−3\n−1\n0\n\n\n✓2.13 Find the canonical representative of the matrix equivalence class of each ma-\ntrix.\n",
    "(a)\n\u00122\n1\n0\n4\n2\n0\n\u0013\n(b)\n\n\n0\n1\n0\n2\n1\n1\n0\n4\n3\n3\n3\n−1\n\n\n2.14 Suppose that, with respect to\nB = E2\nD = ⟨\n\u00121\n1\n\u0013\n,\n\u0012 1\n−1\n\u0013\n⟩\nthe transformation t: R2 →R2 is represented by this matrix.\n",
    "\u00121\n2\n3\n4\n\u0013\nUse change of basis matrices to represent t with respect to each pair.\n",
    "(a) ˆB = ⟨\n\u00120\n1\n\u0013\n,\n\u00121\n1\n\u0013\n⟩, ˆD = ⟨\n\u0012−1\n0\n\u0013\n,\n\u00122\n1\n\u0013\n⟩\n(b) ˆB = ⟨\n\u00121\n2\n\u0013\n,\n\u00121\n0\n\u0013\n",
    "⟩, ˆD = ⟨\n\u00121\n2\n\u0013\n,\n\u00122\n1\n\u0013\n⟩\n2.15",
    "What sizes are P and Q in the equation ˆH = PHQ?\n✓2.16 Consider the spaces V = P2 and W = M2×2, with these bases.\n",
    "B = ⟨1, 1 + x, 1 + x2⟩\n",
    "D = ⟨\n\u00120\n0\n0\n1\n\u0013\n,\n\u00120\n0\n1\n1\n\u0013\n,\n\u00120\n1\n1\n1\n\u0013\n,\n\u00121\n1\n1\n1\n\u0013\n⟩\nˆB = ⟨1, x, x2⟩\nˆD = ⟨\n\u0012−1\n0\n0\n0\n\u0013\n,\n\u00120\n−1\n0\n0\n\u0013\n,\n\u00120\n0\n1\n0\n\u0013\n,\n\u00120\n0\n0\n1\n\u0013\n",
    "⟩\nWe will ﬁnd P and Q to convert the representation of a map with respect to B, D\nto one with respect to ˆB, ˆD\n(a) Draw the appropriate arrow diagram.\n",
    "(b) Compute P and Q.\n✓2.17 Find the change of basis matrices Q and P that will convert the representation\nof a t: R2 →R2 with respect to B, D to one with respect to ˆB, ˆD.\nB = ⟨\n\u00121\n0\n\u0013\n,\n\u00121\n1\n\u0013\n⟩\nD = ⟨\n\u00120\n1\n\u0013\n,\n\u0012−1\n0\n\u0013\n⟩\nˆB = E2\nˆD = ⟨\n\u0012 1\n−1\n\u0013\n,\n\u00120\n1\n\u0013\n⟩\n\n274\nChapter Three.",
    "Maps Between Spaces\n✓2.18 Find the P and Q to express H via PHQ as a block partial identity matrix.\n",
    "H =\n\n\n2\n1\n1\n3\n−1\n0\n1\n3\n2\n\n\n✓2.19 Use Theorem 2.7 to show that a square matrix is nonsingular if and only if it\nis equivalent to an identity matrix.\n2.20 Show that, where A is a nonsingular square matrix, if P and Q are nonsingular\nsquare matrices such that PAQ",
    "= I then QP = A−1.\n",
    "2.21 Why does Theorem 2.7 not show that every matrix is diagonalizable (see\nExample 2.3)?\n2.22 Must matrix equivalent matrices have matrix equivalent transposes?\n",
    "2.23 What happens in Theorem 2.7 if k = 0?\n2.24 Show that matrix equivalence is an equivalence relation.\n",
    "✓2.25 Show that a zero matrix is alone in its matrix equivalence class.",
    "Are there\nother matrices like that?\n",
    "2.26 What are the matrix equivalence classes of matrices of transformations on R1?\nR3?\n2.27",
    "How many matrix equivalence classes are there?\n",
    "2.28 Are matrix equivalence classes closed under scalar multiplication?",
    "Addition?\n2.29 Let t: Rn →Rn represented by T with respect to En, En.\n(a) Find RepB,B(t) in this speciﬁc case.\n",
    "T =\n\u00121\n1\n3\n−1\n\u0013\nB = ⟨\n\u00121\n2\n\u0013\n,\n\u0012−1\n−1\n\u0013\n⟩\n(b) Describe RepB,B(t) in the general case where B = ⟨⃗β1, . . .",
    ", ⃗βn⟩.\n2.30\n(a) Let V have bases B1 and B2 and suppose that W has the basis D. Where\nh: V →W, ﬁnd the formula that computes RepB2,D(h) from RepB1,D(h).\n",
    "(b) Repeat the prior question with one basis for V and two bases for W.\n2.31\n(a) If two matrices are matrix equivalent and invertible, must their inverses\nbe matrix equivalent?\n(b) If two matrices have matrix equivalent inverses, must the two be matrix\nequivalent?\n(c) If two matrices are square and matrix equivalent, must their squares be matrix\nequivalent?\n(d)",
    "If two matrices are square and have matrix equivalent squares, must they be\nmatrix equivalent?\n2.32 Square matrices are similar if they represent the same transformation, but\neach with respect to the same ending as starting basis.",
    "That is, RepB1,B1(t) is\nsimilar to RepB2,B2(t).\n",
    "(a) Give a deﬁnition of matrix similarity like that of Deﬁnition 2.4.\n(b) Prove that similar matrices are matrix equivalent.\n",
    "(c) Show that similarity is an equivalence relation.\n",
    "(d) Show that if T is similar to ˆT then T 2 is similar to ˆT 2, the cubes are similar,\netc.\n(e) Prove that there are matrix equivalent matrices that are not similar.\n\nSection VI.",
    "Projection\n275\nVI\nProjection\nThis section is optional.",
    "It is a prerequisite only for the ﬁnal two sections\nof Chapter Five, and some Topics.\n",
    "We have described projection from R3 into its xy-plane subspace as a shadow\nmap.",
    "This shows why",
    "but it also shows that some shadows fall upward.\n",
    "\n\n1\n2\n2\n\n\n\n\n1\n2\n−1\n\n\n",
    "So perhaps a better description is: the projection of ⃗v is the vector ⃗p in the plane\nwith the property that someone standing on ⃗p and looking straight up or down —\nthat is, looking orthogonally to the plane — sees the tip of ⃗v.",
    "In this section we\nwill generalize this to other projections, orthogonal and non-orthogonal.\n",
    "VI.1\nOrthogonal Projection Into a Line\nWe ﬁrst consider orthogonal projection of a vector ⃗v into a line ℓ. This shows\na ﬁgure walking out on the line to a point ⃗p such that the tip of ⃗v is directly\nabove them, where “above” does not mean parallel to the y-axis but instead\nmeans orthogonal to the line.\n",
    "Since the line is the span of some vector ℓ= {c · ⃗s | c ∈R}, we have a coeﬃcient\nc⃗p with the property that ⃗v −c⃗p⃗s",
    "is orthogonal to c⃗p⃗s.\n",
    "c⃗p ⃗s\n⃗v\n⃗v −c⃗p ⃗s\n\n276\nChapter Three.",
    "Maps Between Spaces\nTo solve for this coeﬃcient, observe that because ⃗v −c⃗p⃗s is orthogonal to a\nscalar multiple of ⃗s, it must be orthogonal to ⃗s itself.",
    "Then (⃗v −c⃗p⃗s) • ⃗s = 0\ngives that c⃗p = ⃗v • ⃗s/⃗s • ⃗s.\n",
    "1.1 Deﬁnition The orthogonal projection of ⃗v into the line spanned by a\nnonzero ⃗s is this vector.\n",
    "proj[⃗s ](⃗v) = ⃗v • ⃗s\n⃗s • ⃗s · ⃗s\n(That says ‘spanned by ⃗s ’ instead the more formal ‘span of the set {⃗s }’.",
    "This\nmore casual phrase is common.)\n",
    "1.2 Example To orthogonally project the vector\n\u00002\n3\n\u0001\ninto the line y = 2x, ﬁrst\npick a direction vector for the line.\n",
    "⃗s =\n \n1\n2\n!\n",
    "The calculation is easy.\n",
    "\n2\n3\n\n•\n\n1\n2\n\n\n\n1\n2\n\n•\n\n1\n2\n\n\n·\n\u00121\n2\n\u0013\n= 8\n5 ·\n\u00121\n2\n\u0013\n=\n\u0012 8/5\n16/5\n\u0013\n1.3 Example",
    "In R3, the orthogonal projection of a general vector\n\n\n\nx\ny\nz\n\n\n\ninto the y-axis is\n\n\n\nx\ny\nz\n\n",
    "\n•\n\n\n\n0\n1\n0\n\n\n\n\n\n\n0\n1\n0\n\n\n•\n\n\n\n0\n1\n0\n\n\n\n·\n\n\n\n0\n1\n0\n\n\n=\n\n\n\n0\ny\n0\n\n\n\nwhich matches our intuitive expectation.\n",
    "The picture above showing the ﬁgure walking out on the line until ⃗v’s tip is\noverhead is one way to think of the orthogonal projection of a vector into a line.\n",
    "We ﬁnish this subsection with two other ways.\n\nSection VI.",
    "Projection\n277\n1.4 Example A railroad car left on an east-west track without its brake is pushed\nby a wind blowing toward the northeast at ﬁfteen miles per hour; what speed\nwill the car reach?\n",
    "For the wind we use a vector of length 15 that points toward the northeast.\n",
    "⃗v =\n \n15\np\n1/2\n15\np\n1/2\n!\n",
    "The car is only aﬀected by the part of the wind blowing in the east-west\ndirection — the part of ⃗v in the direction of the x-axis is this (the picture has\nthe same perspective as the railroad car picture above).\n",
    "east\nnorth\n⃗p =\n \n15\np\n1/2\n0\n!\n",
    "So the car will reach a velocity of 15\np\n1/2 miles per hour toward the east.\n",
    "Thus, another way to think of the picture that precedes the deﬁnition is that\nit shows ⃗v as decomposed into two parts, the part ⃗p with the line, and the part\nthat is orthogonal to the line (shown above on the north-south axis).",
    "These\ntwo are non-interacting in the sense that the east-west car is not at all aﬀected\nby the north-south part of the wind (see Exercise 10).",
    "So we can think of the\northogonal projection of ⃗v into the line spanned by ⃗s as the part of ⃗v that lies\nin the direction of ⃗s.\n",
    "Still another useful way to think of orthogonal projection into a line is to\nhave the person stand on the vector, not the line.",
    "This person holds a rope\nlooped over the line.",
    "As they pull, the loop slides on the line.\n",
    "When it is tight, the rope is orthogonal to the line.",
    "That is, we can think of the\nprojection ⃗p as being the vector in the line that is closest to ⃗v (see Exercise 17).\n",
    "1.5 Example A submarine is tracking a ship moving along the line y = 3x",
    "+",
    "2.\nTorpedo range is one-half mile.",
    "If the sub stays where it is, at the origin on the\nchart below, will the ship pass within range?\n\n278\nChapter Three.",
    "Maps Between Spaces\neast\nnorth\nThe formula for projection into a line does not immediately apply because the\nline doesn’t pass through the origin, and so isn’t the span of any ⃗s.",
    "To adjust\nfor this, we start by shifting the entire map down two units.",
    "Now the line is\ny = 3x, a subspace.",
    "We project to get the point ⃗p on the line closest to\n⃗v =\n \n0\n−2\n!\n",
    "the sub’s shifted position.\n",
    "⃗p =\n \n0\n−2\n!\n•\n \n1\n3\n!\n \n1\n3\n!\n•\n \n1\n3\n!",
    "·\n \n1\n3\n!\n=\n \n−3/5\n−9/5\n!\n",
    "The distance between ⃗v and ⃗p is about 0.63 miles.",
    "The ship will never be in\nrange.\n",
    "Exercises\n✓1.6 Project the ﬁrst vector orthogonally into the line spanned by the second vec-\ntor.\n(a)\n\u00122\n1\n\u0013\n,\n\u0012 3\n−2\n\u0013\n(b)\n\u00122\n1\n\u0013\n,\n\u00123\n0\n\u0013\n(c)\n\n\n1\n1\n4\n\n,\n\n\n1\n2\n−1\n\n\n(d)\n\n\n1\n1\n4\n\n,\n\n\n3\n3\n12\n\n\n✓1.7 Project the vector orthogonally into the line.\n",
    "(a)\n\n\n2\n−1\n4\n\n, {c\n\n\n−3\n1\n−3\n\n|",
    "c ∈R}\n(b)\n",
    "\u0012−1\n−1\n\u0013\n, the line y = 3x\n1.8 Although pictures guided our development of Deﬁnition 1.1, we are not restricted\nto spaces that we can draw.",
    "In R4 project this vector into this line.\n",
    "⃗v =\n\n\n\n\n1\n2\n1\n3\n\n\n\n\nℓ= {c ·\n\n\n\n\n−1\n1\n−1\n1\n\n\n\n| c ∈R}\n✓1.9 Deﬁnition 1.1 uses two vectors ⃗s and ⃗v.",
    "Consider the transformation of R2\nresulting from ﬁxing\n⃗s =\n\u00123\n1\n\u0013\nand projecting ⃗v into the line that is the span of ⃗s.\n",
    "Apply it to these vec-\ntors.\n\nSection VI.",
    "Projection\n279\n(a)\n\u00121\n2\n\u0013\n(b)\n\u00120\n4\n\u0013\nShow that in general the projection transformation is this.\n",
    "\u0012x1\nx2\n\u0013\n7→\n\u0012(9x1 +",
    "3x2)/10\n(3x1 + x2)/10\n\u0013\nExpress the action of this transformation with a matrix.\n",
    "1.10 Example 1.4 suggests that projection breaks ⃗v into two parts, proj[⃗s ](⃗v ) and\n⃗v −proj[⃗s ](⃗v ), that are non-interacting.",
    "Recall that the two are orthogonal.",
    "Show\nthat any two nonzero orthogonal vectors make up a linearly independent set.\n",
    "1.11\n(a)",
    "What is the orthogonal projection of ⃗v into a line if ⃗v is a member of that\nline?\n(b) Show that if ⃗v is not a member of the line then the set {⃗v,⃗v −proj[⃗s ](⃗v )} is\nlinearly independent.\n",
    "1.12 Deﬁnition 1.1 requires that ⃗s be nonzero.",
    "Why?",
    "What is the right deﬁnition\nof the orthogonal projection of a vector into the (degenerate) line spanned by the\nzero vector?\n1.13 Are all vectors the projection of some other vector into some line?\n1.14 Show that the projection of ⃗v into the line spanned by ⃗s has length equal to\nthe absolute value of the number ⃗v • ⃗s divided by the length of the vector ⃗s .\n",
    "1.15 Find the formula for the distance from a point to a line.\n",
    "1.16 Find the scalar c such that the point (cs1, cs2) is a minimum distance from the\npoint (v1, v2) by using Calculus (i.e., consider the distance function, set the ﬁrst\nderivative equal to zero, and solve).",
    "Generalize to Rn.\n✓1.17 Let ⃗p be the orthogonal projection of ⃗v ∈Rn onto a line ℓ. Show that ⃗p is the\npoint in the line closest to ⃗v.\n",
    "1.18 Prove that the orthogonal projection of a vector into a line has length less than\nor equal to that of the vector.\n",
    "✓1.19 Show that the deﬁnition of orthogonal projection into a line does not depend\non the spanning vector: if ⃗s is a nonzero multiple of ⃗q then (⃗v • ⃗s/⃗s • ⃗s ) ·",
    "⃗s equals\n(⃗v • ⃗q/⃗q • ⃗q ) ·",
    "⃗q.\n1.20 Consider the function mapping the plane to itself that takes a vector to its\nprojection into the line y = x.",
    "These two each show that the map is linear, the ﬁrst\none in a way that is coordinate-bound (that is, it ﬁxes a basis and then computes)\nand the second in a way that is more conceptual.\n",
    "(a) Produce a matrix that describes the function’s action.\n",
    "(b) Show that we can obtain this map by ﬁrst rotating everything in the plane\nπ/4 radians clockwise, then projecting into the x-axis, and then rotating π/4 ra-\ndians counterclockwise.\n",
    "1.21 For ⃗a,⃗b ∈Rn let ⃗v1 be the projection of ⃗a into the line spanned by ⃗b, let ⃗v2 be\nthe projection of ⃗v1 into the line spanned by ⃗a, let ⃗v3 be the projection of ⃗v2 into\nthe line spanned by ⃗b, etc., back and forth between the spans of ⃗a and ⃗b.",
    "That is,\n⃗vi+1 is the projection of ⃗vi into the span of ⃗a if i + 1 is even, and into the span\nof ⃗b if i + 1 is odd.",
    "Must that sequence of vectors eventually settle down — must\nthere be a suﬃciently large i such that ⃗vi+2 equals ⃗vi and ⃗vi+3 equals ⃗vi+1?",
    "If so,\nwhat is the earliest such i?\n\n280\nChapter Three.",
    "Maps Between Spaces\nVI.2\nGram-Schmidt Orthogonalization\nThe prior subsection suggests that projecting ⃗v into the line spanned by ⃗s\ndecomposes that vector into two parts\nproj[⃗s](⃗p)\n⃗v\n⃗v −proj[⃗s](⃗p)\n⃗v = proj[⃗s ](⃗v) +\n\u0000⃗v",
    "−proj[⃗s ](⃗v)\n\u0001\nthat are orthogonal and so are “non-interacting.”",
    "We now develop that suggestion.\n",
    "2.1 Deﬁnition Vectors ⃗v1, . . .",
    ",⃗vk ∈Rn are mutually orthogonal when any two\nare orthogonal: if i ̸= j then the dot product ⃗vi •⃗vj is zero.\n",
    "2.2 Theorem If the vectors in a set {⃗v1, . . .",
    ",⃗vk } ⊂Rn are mutually orthogonal\nand nonzero then that set is linearly independent.\n",
    "Proof Consider ⃗0 = c1⃗v1 + c2⃗v2 + · · · + ck⃗vk.",
    "For i ∈{1, .. , k}, taking the dot\nproduct of ⃗vi with both sides of the equation ⃗vi •(c1⃗v1+c2⃗v2+· · ·+ck⃗vk) = ⃗vi •⃗0,\nwhich gives ci · (⃗vi •⃗vi) = 0, shows that ci = 0 since ⃗vi ̸= ⃗0.\n",
    "QED\n2.3 Corollary In a k dimensional vector space, if the vectors in a size k set are\nmutually orthogonal and nonzero then that set is a basis for the space.\n",
    "Proof Any linearly independent size k subset of a k dimensional space is a\nbasis.\n",
    "QED\nOf course, the converse of Corollary 2.3 does not hold — not every basis of\nevery subspace of Rn has mutually orthogonal vectors.",
    "However, we can get\nthe partial converse that for every subspace of Rn there is at least one basis\nconsisting of mutually orthogonal vectors.\n",
    "2.4 Example The members ⃗β1 and ⃗β2 of this basis for R2 are not orthogonal.\n",
    "B = ⟨\n\u00124\n2\n\u0013\n,\n\u00121\n3\n\u0013\n⟩\n⃗β1\n⃗β2\nWe will derive from B a new basis for the space ⟨⃗κ1,⃗κ2⟩consisting of mutually\northogonal vectors.",
    "The ﬁrst member of the new basis is just ⃗β1.\n",
    "⃗κ1 =\n \n4\n2\n!\n\nSection VI.",
    "Projection\n281\nFor the second member of the new basis, we subtract from ⃗β2 the part in the\ndirection of ⃗κ1.",
    "This leaves the part of ⃗β2 that is orthogonal to ⃗κ1.\n",
    "⃗κ2 =\n\u00121\n3\n\u0013\n−proj[⃗κ1](\n\u00121\n3\n\u0013\n)",
    "=\n\u00121\n3\n\u0013\n−\n\u00122\n1\n\u0013\n=\n\u0012−1\n2\n\u0013\n⃗κ2\nBy the corollary ⟨⃗κ1,⃗κ2⟩is a basis for R2.\n",
    "2.5 Deﬁnition An orthogonal basis for a vector space is a basis of mutually\northogonal vectors.\n",
    "2.6 Example To produce from this basis for R3\nB = ⟨\n\n\n\n1\n1\n1\n\n\n,\n\n\n\n0\n2\n0\n\n\n,\n\n\n\n1\n0\n3\n\n\n⟩\nan orthogonal basis, start by taking the ﬁrst vector unchanged.\n",
    "⃗κ1 =\n\n\n\n1\n1\n1\n\n\n\nGet ⃗κ2 by subtracting from ⃗β2 its part in the direction of ⃗κ1.\n",
    "⃗κ2 =\n\n\n\n0\n2\n0\n\n\n−proj[⃗κ1](\n\n\n\n0\n2\n0\n\n\n)",
    "=\n\n\n\n0\n2\n0\n\n\n−\n\n\n\n2/3\n2/3\n2/3\n\n\n=\n\n\n\n−2/3\n4/3\n−2/3\n\n\n\nFind ⃗κ3 by subtracting from ⃗β3 the part in the direction of ⃗κ1",
    "and also the part\nin the direction of ⃗κ2.\n⃗κ3 =\n\n\n\n1\n0\n3\n\n\n−proj[⃗κ1](\n\n\n\n1\n0\n3\n\n\n) −proj[⃗κ2](\n\n\n\n1\n0\n3\n\n\n)",
    "=\n\n\n\n−1\n0\n1\n\n\n\nAs above, the corollary gives that the result is a basis for R3.\n",
    "⟨\n\n\n\n1\n1\n1\n\n\n,\n\n\n\n−2/3\n4/3\n−2/3\n\n\n,\n\n\n\n−1\n0\n1\n\n\n⟩\n\n282\nChapter Three.",
    "Maps Between Spaces\n2.7 Theorem (Gram-Schmidt orthogonalization) If ⟨⃗β1, . . .",
    "⃗βk⟩is a basis for a sub-\nspace of Rn then",
    "the vectors\n⃗κ1 = ⃗β1\n⃗κ2 = ⃗β2 −proj[⃗κ1](⃗β2)\n⃗κ3 = ⃗β3 −proj[⃗κ1](⃗β3) −proj[⃗κ2](⃗β3)\n...\n",
    "⃗κk = ⃗βk −proj[⃗κ1](⃗βk) −· · · −proj[⃗κk−1](⃗βk)\nform an orthogonal basis for the same subspace.\n",
    "2.8 Remark This is restricted to Rn only because we have not given a deﬁnition\nof orthogonality for other spaces.\n",
    "Proof We will use induction to check that each ⃗κi is nonzero, is in the span of\n⟨⃗β1, . . .",
    "⃗βi⟩, and is orthogonal to all preceding vectors ⃗κ1",
    "•⃗κi = · · · = ⃗κi−1 •⃗κi = 0.\n",
    "Then Corollary 2.3 gives that ⟨⃗κ1, . . .",
    "⃗κk⟩is a basis for the same space as is the\nstarting basis.\n",
    "We shall only cover the cases up to i = 3, to give the sense of the argument.\n",
    "The full argument is Exercise 28.\n",
    "The i = 1 case is trivial; taking ⃗κ1 to be ⃗β1 makes it a nonzero vector since\n⃗β1 is a member of a basis, it is obviously in the span of ⟨⃗β1⟩, and the ‘orthogonal\nto all preceding vectors’ condition is satisﬁed vacuously.\n",
    "In the i = 2 case the expansion\n⃗κ2 = ⃗β2 −proj[⃗κ1](⃗β2) = ⃗β2 −\n⃗β2 • ⃗κ1\n⃗κ1 • ⃗κ1\n· ⃗κ1 = ⃗β2 −\n⃗β2 • ⃗κ1\n⃗κ1 • ⃗κ1\n· ⃗β1\nshows that ⃗κ2 ̸= ⃗0 or else this would be a non-trivial linear dependence among\nthe ⃗β’s",
    "(it is nontrivial because the coeﬃcient of ⃗β2 is 1).",
    "It also shows that ⃗κ2\nis in the span of ⟨⃗β1, ⃗β2⟩. And, ⃗κ2 is orthogonal to the only preceding vector\n⃗κ1",
    "• ⃗κ2 = ⃗κ1 • (⃗β2 −proj[⃗κ1](⃗β2))",
    "= 0\nbecause this projection is orthogonal.\n",
    "The i = 3 case is the same as the i = 2 case except for one detail.",
    "As in the\ni = 2 case, expand the deﬁnition.\n",
    "⃗κ3 = ⃗β3 −\n⃗β3 • ⃗κ1\n⃗κ1 • ⃗κ1\n· ⃗κ1",
    "−\n⃗β3 • ⃗κ2\n⃗κ2 • ⃗κ2\n· ⃗κ2\n= ⃗β3 −\n⃗β3 • ⃗κ1\n⃗κ1 • ⃗κ1\n· ⃗β1 −\n⃗β3 • ⃗κ2\n⃗κ2 • ⃗κ2\n·\n\u0000⃗β2 −\n⃗β2 • ⃗κ1\n⃗κ1 • ⃗κ1\n· ⃗β1\n\u0001\n\nSection VI.",
    "Projection\n283\nBy the ﬁrst line ⃗κ3 ̸= ⃗0, since ⃗β3 isn’t in the span",
    "[⃗β1, ⃗β2] and therefore by the\ninductive hypothesis it isn’t in the span [⃗κ1,⃗κ2].",
    "By the second line ⃗κ3 is in\nthe span of the ﬁrst three ⃗β’s.",
    "Finally, the calculation below shows that ⃗κ3 is\northogonal to ⃗κ1.\n⃗κ1 • ⃗κ3 = ⃗κ1 • \u0000 ⃗β3 −proj[⃗κ1](⃗β3) −proj[⃗κ2](⃗β3)\n\u0001\n= ⃗κ1 • \u0000⃗β3 −proj[⃗κ1](⃗β3)\n\u0001\n−⃗κ1 • proj[⃗κ2](⃗β3)\n",
    "= 0\n(Here is the diﬀerence with the i = 2 case: as happened for i = 2 the ﬁrst term\nis 0 because this projection is orthogonal, but here the second term in the second\nline is 0 because ⃗κ1 is orthogonal to ⃗κ2 and so is orthogonal to any vector in\nthe line spanned by ⃗κ2.)",
    "A similar check shows that ⃗κ3 is also orthogonal to ⃗κ2.\nQED\n",
    "In addition to having the vectors in the basis be orthogonal, we can also\nnormalize each vector by dividing by its length, to end with an orthonormal\nbasis..\n2.9 Example From the orthogonal basis of Example 2.6, normalizing produces\nthis orthonormal basis.\n",
    "⟨\n\n\n\n1/\n√\n3\n1/\n√\n3\n1/\n√\n3\n\n\n,\n\n\n\n−1/\n√\n6\n2/\n√\n6\n−1/\n√\n6\n\n\n,\n\n\n\n−1/\n√\n2\n0\n1/\n√\n2\n\n\n⟩\nBesides its intuitive appeal, and its analogy with the standard basis En for\nRn, an orthonormal basis also simpliﬁes some computations.",
    "Exercise 22 is an\nexample.\n",
    "Exercises\n2.10 Normalize the lengths of these vectors.\n",
    "(a)\n\u00121\n2\n\u0013\n(b)\n\n\n−1\n3\n0\n\n\n(c)\n",
    "\u0012 1\n−1\n\u0013\n✓2.11 Perform Gram-Schmidt on this basis for R2.\n",
    "⟨\n\u00121\n1\n\u0013\n,\n\u0012−1\n2\n\u0013\n⟩\nCheck that the resulting vectors are orthogonal.\n",
    "✓2.12 Perform the Gram-Schmidt process on this basis for R3.\n⟨\n\n\n1\n2\n3\n\n,\n\n\n2\n1\n−3\n\n,\n\n\n3\n3\n3\n\n⟩\n✓2.13 Perform Gram-Schmidt on each of these bases for R2.\n\n",
    "284\nChapter Three.",
    "Maps Between Spaces\n(a) ⟨\n\u00121\n1\n\u0013\n,\n\u00122\n1\n\u0013\n⟩\n(b) ⟨\n\u00120\n1\n\u0013\n,\n\u0012−1\n3\n\u0013\n⟩\n(c) ⟨\n\u00120\n1\n\u0013\n,\n\u0012−1\n0\n\u0013\n⟩\nThen turn those orthogonal bases into orthonormal bases.\n",
    "2.14 Perform the Gram-Schmidt process on each of these bases for R3.\n(a) ⟨\n\n\n2\n2\n2\n\n,\n\n\n1\n0\n−1\n\n,\n\n\n0\n3\n1\n\n⟩\n(b) ⟨\n\n\n1\n−1\n0\n\n,\n\n\n0\n1\n0\n\n,\n\n\n2\n3\n1\n\n⟩\nThen turn those orthogonal bases into orthonormal bases.\n",
    "✓2.15 Find an orthonormal basis for this subspace of R3: the plane x −y + z = 0.\n",
    "2.16 Find an orthonormal basis for this subspace of R4.\n",
    "{\n\n\n\n\nx\ny\nz\nw\n\n\n\n|",
    "x −y −z + w = 0",
    "and x",
    "+ z = 0}\n2.17 Show that any linearly independent subset of Rn can be orthogonalized without\nchanging its span.\n",
    "2.18 What happens if we try to apply the Gram-Schmidt process to a ﬁnite set that\nis not a basis?\n✓2.19 What happens if we apply the Gram-Schmidt process to a basis that is already\northogonal?\n2.20 Let ⟨⃗κ1, . . .",
    ",⃗κk⟩be a set of mutually orthogonal vectors in Rn.\n(a) Prove that for any ⃗v in the space, the vector ⃗v−(proj[⃗κ1](⃗v )",
    "+· · ·",
    "+proj[⃗vk](⃗v ))\nis orthogonal to each of ⃗κ1, . . .",
    ", ⃗κk.\n(b) Illustrate the prior item in R3 by using ⃗e1 as ⃗κ1, using ⃗e2 as ⃗κ2, and taking ⃗v\nto have components 1, 2, and 3.\n(c) Show that proj[⃗κ1](⃗v ) + · · ·",
    "+ proj[⃗vk](⃗v ) is the vector in the span of the set of\n⃗κ’s that is closest to ⃗v.",
    "Hint.",
    "To the illustration done for the prior part, add a\nvector d1⃗κ1 + d2⃗κ2 and apply the Pythagorean Theorem to the resulting triangle.\n",
    "2.21 Find a nonzero vector in R3 that is orthogonal to both of these.\n\n\n1\n5\n−1\n\n\n\n\n2\n2\n0\n\n\n✓2.22 One advantage of orthogonal bases is that they simplify ﬁnding the representa-\ntion of a vector with respect to that basis.\n",
    "(a) For this vector and this non-orthogonal basis for R2\n⃗v =\n\u00122\n3\n\u0013\nB = ⟨\n\u00121\n1\n\u0013\n,\n\u00121\n0\n\u0013\n⟩\nﬁrst represent the vector with respect to the basis.",
    "Then project the vector into\nthe span of each basis vector [⃗β1] and [⃗β2].\n(b) With this orthogonal basis for R2\nK = ⟨\n\u00121\n1\n\u0013\n,\n\u0012 1\n−1\n\u0013\n⟩\nrepresent the same vector ⃗v with respect to the basis.",
    "Then project the vector\ninto the span of each basis vector.",
    "Note that the coeﬃcients in the representation\nand the projection are the same.\n\nSection VI.",
    "Projection\n285\n(c) Let K = ⟨⃗κ1, . . .",
    ",⃗κk⟩be an orthogonal basis for some subspace of Rn.",
    "Prove\nthat for any ⃗v in the subspace, the i-th component of the representation RepK(⃗v )\nis the scalar coeﬃcient (⃗v • ⃗κi)/(⃗κi • ⃗κi) from proj[⃗κi](⃗v ).\n",
    "(d) Prove that ⃗v = proj[⃗κ1](⃗v ) + · · · + proj[⃗κk](⃗v ).\n",
    "2.23 Bessel’s Inequality.",
    "Consider these orthonormal sets\nB1 = {⃗e1 }\nB2 = {⃗e1,⃗e2 }\nB3 = {⃗e1,⃗e2,⃗e3 }\nB4 = {⃗e1,⃗e2,⃗e3,⃗e4 }\nalong with the vector ⃗v ∈R4 whose components are 4, 3, 2, and 1.\n(a) Find the coeﬃcient c1 for the projection of ⃗v into the span of the vector in\nB1.",
    "Check that ∥⃗v ∥2",
    "⩾|c1|2.\n(b) Find the coeﬃcients c1 and c2 for the projection of ⃗v into the spans of the\ntwo vectors in B2.",
    "Check that ∥⃗v ∥2",
    "⩾|c1|2 + |c2|2.\n",
    "(c) Find c1, c2, and c3 associated with the vectors in B3, and c1, c2, c3, and\nc4 for the vectors in B4.",
    "Check that ∥⃗v ∥2",
    "⩾|c1|2 + · · · + |c3|2 and that ∥⃗v ∥2 ⩾\n|c1|2 + · · · + |c4|2.\nShow that this holds in general: where {⃗κ1, . . .",
    ",⃗κk } is an orthonormal set and ci is\ncoeﬃcient of the projection of a vector ⃗v from the space then ∥⃗v ∥2 ⩾|c1|2+· · ·+|ck|2.\n",
    "Hint.\n",
    "One way is to look at the inequality 0 ⩽∥⃗v −(c1⃗κ1 + · · · + ck⃗κk)∥2 and\nexpand the c’s.\n",
    "2.24 Prove or disprove: every vector in Rn is in some orthogonal basis.\n",
    "2.25 Show that the columns of an n×n matrix form an orthonormal set if and only\nif the inverse of the matrix is its transpose.",
    "Produce such a matrix.\n2.26 Does the proof of Theorem 2.2 fail to consider the possibility that the set of\nvectors is empty (i.e., that k = 0)?\n",
    "2.27 Theorem 2.7 describes a change of basis from any basis B = ⟨⃗β1, . . .",
    ", ⃗βk⟩to\none that is orthogonal K = ⟨⃗κ1, . . .",
    ",⃗κk⟩.\nConsider the change of basis matrix\nRepB,K(id).\n",
    "(a) Prove that the matrix RepK,B(id) changing bases in the direction opposite to\nthat of the theorem has an upper triangular shape — all of its entries below the\nmain diagonal are zeros.\n",
    "(b) Prove that the inverse of an upper triangular matrix is also upper triangular\n(if the matrix is invertible, that is).",
    "This shows that the matrix RepB,K(id)\nchanging bases in the direction described in the theorem is upper triangular.\n2.28 Complete the induction argument in the proof of Theorem 2.7.\n",
    "VI.3\nProjection Into a Subspace\nThis subsection uses material from the optional earlier subsection on Com-\nbining Subspaces.\n",
    "The prior subsections project a vector into a line by decomposing it into two\nparts: the part in the line proj[⃗s ](⃗v ) and the rest ⃗v −proj[⃗s ](⃗v ).",
    "To generalize\nprojection to arbitrary subspaces we will follow this decomposition idea.\n\n",
    "286\nChapter Three.",
    "Maps Between Spaces\n3.1 Deﬁnition Let a vector space be a direct sum V = M ⊕N. Then for any\n⃗v ∈V with ⃗v = ⃗m + ⃗n where ⃗m ∈M, ⃗n ∈N, the projection of ⃗v into M along\nN is projM,N(⃗v ) = ⃗m.\n",
    "This deﬁnition applies in spaces where we don’t have a ready deﬁnition\nof orthogonal.",
    "(Deﬁnitions of orthogonality for spaces other than the Rn are\nperfectly possible but we haven’t seen any in this book.)\n3.2 Example",
    "The space M2×2 of 2×2 matrices is the direct sum of these two.\n",
    "M = {\n \na\nb\n0\n0\n!\n",
    "| a, b ∈R}\nN = {\n \n0\n0\nc\nd\n!\n| c, d ∈R}\nTo project\nA =\n \n3\n1\n0\n4\n!\ninto M along N, we ﬁrst ﬁx bases for the two subspaces.\n",
    "BM = ⟨\n \n1\n0\n0\n0\n!\n,\n \n0\n1\n0\n0\n!\n⟩\nBN = ⟨\n \n0\n0\n1\n0\n!\n,\n \n0\n0\n0\n1\n!\n",
    "⟩\nTheir concatenation\nB = BM\n⌢BN = ⟨\n \n1\n0\n0\n0\n!\n,\n \n0\n1\n0\n0\n!\n,\n \n0\n0\n1\n0\n!\n,\n \n0\n0\n0\n1\n!\n",
    "⟩\nis a basis for the entire space because M2×2 is the direct sum.",
    "So we can use it\nto represent A.\n \n3\n1\n0\n4\n!\n= 3 ·\n \n1\n0\n0\n0\n!\n",
    "+ 1 ·\n \n0\n1\n0\n0\n!\n",
    "+ 0 ·\n \n0\n0\n1\n0\n!\n",
    "+ 4 ·\n \n0\n0\n0\n1\n!\n",
    "The projection of A into M along N keeps the M part and drops the N part.\nprojM,N(\n \n3\n1\n0\n4\n!\n)",
    "= 3 ·\n \n1\n0\n0\n0\n!\n",
    "+ 1 ·\n \n0\n1\n0\n0\n!\n",
    "=\n \n3\n1\n0\n0\n!\n3.3 Example Both subscripts on projM,N(⃗v ) are signiﬁcant.",
    "The ﬁrst subscript\nM matters because the result of the projection is a member of M. For an\nexample showing that the second one matters, ﬁx this plane subspace of R3 and\nits basis.\n",
    "M = {\n\n\n\nx\ny\nz\n\n\n|",
    "y −2z = 0}\nBM = ⟨\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n2\n1\n\n\n⟩\n\nSection VI.",
    "Projection\n287\nWe will compare the projections of this element of R3\n⃗v =\n\n\n\n2\n2\n5\n\n\n\ninto M along these two subspaces (veriﬁcation that R3 = M⊕N and R3 = M⊕ˆN\nis routine).\n",
    "N = {k\n\n\n\n0\n0\n1\n\n\n|",
    "k ∈R}\nˆN = {k\n\n\n\n0\n1\n−2\n\n",
    "\n|",
    "k ∈R}\nHere are natural bases for N and ˆN.\nBN = ⟨\n\n\n\n0\n0\n1\n\n",
    "\n⟩\nB ˆN = ⟨\n\n\n\n0\n1\n−2\n\n\n⟩\nTo project into M along N, represent ⃗v with respect to the concatenation BM\n⌢BN\n\n\n\n",
    "2\n2\n5\n\n\n= 2 ·\n\n\n\n1\n0\n0\n\n\n+ 1 ·\n\n\n\n0\n2\n1\n\n\n+ 4 ·\n\n\n\n0\n0\n1\n\n\n\nand drop the N term.\n",
    "projM,N(⃗v )",
    "= 2 ·\n\n\n\n1\n0\n0\n\n",
    "\n+ 1 ·\n\n\n\n0\n2\n1\n\n\n=\n\n\n\n2\n2\n1\n\n\n\nTo project into M along ˆN represent ⃗v with respect to BM\n⌢B ˆN\n\n\n\n2\n2\n5\n\n",
    "\n= 2 ·\n\n\n\n1\n0\n0\n\n\n+ (9/5) ·\n\n\n\n0\n2\n1\n\n\n−(8/5) ·\n\n\n\n0\n1\n−2\n\n\n\nand omit the ˆN part.\n",
    "projM, ˆN(⃗v )",
    "= 2 ·\n\n\n\n1\n0\n0\n\n\n+ (9/5) ·\n\n\n\n0\n2\n1\n\n\n=\n\n\n\n2\n18/5\n9/5\n\n\n\n",
    "So projecting along diﬀerent subspaces can give diﬀerent results.\n",
    "These pictures compare the two maps.",
    "Both show that the projection is\nindeed ‘into’ the plane and ‘along’ the line.\n\n",
    "288\nChapter Three.",
    "Maps Between Spaces\nM\nN\nM\nˆN\nNotice that the projection along N is not orthogonal since there are members\nof the plane M that are not orthogonal to the dotted line.",
    "But the projection\nalong ˆN is orthogonal.\n",
    "We have seen two projection operations, orthogonal projection into a line as\nwell as this subsections’s projection into an M and along an N, and we naturally\nask whether they are related.",
    "The right-hand picture above suggests the answer —\northogonal projection into a line is a special case of this subsection’s projection;\nit is projection along a subspace perpendicular to the line.\n",
    "N\nM\n3.4 Deﬁnition The orthogonal complement of a subspace M of Rn is\nM⊥= {⃗v ∈Rn | ⃗v is perpendicular to all vectors in M}\n(read “M perp”).",
    "The orthogonal projection projM(⃗v ) of a vector is its projec-\ntion into M along M⊥.\n3.5 Example In R3, to ﬁnd the orthogonal complement of the plane\nP",
    "= {\n\n\n\nx\ny\nz\n\n\n|",
    "3x + 2y −z = 0}\nwe start with a basis for P.\nB = ⟨\n\n\n\n1\n0\n3\n\n\n,\n\n\n\n0\n1\n2\n\n\n⟩\nAny ⃗v perpendicular to every vector in B is perpendicular to every vector in the\nspan of B (the proof of this is Exercise 22).",
    "Therefore, the subspace P⊥consists\n\nSection VI.",
    "Projection\n289\nof the vectors that satisfy these two conditions.\n\n\n\n1\n0\n3\n\n\n•\n\n\n\nv1\nv2\nv3\n\n\n= 0\n\n\n\n0\n1\n2\n\n\n•\n\n\n\nv1\nv2\nv3\n\n\n= 0\n",
    "Those conditions give a linear system.\n",
    "P⊥= {\n\n\n\nv1\nv2\nv3\n\n",
    "\n|\n \n1\n0\n3\n0\n1\n2\n!",
    "\n\n\nv1\nv2\nv3\n\n\n=\n \n0\n0\n!\n}\nWe are thus left with ﬁnding the null space of the map represented by the matrix,\nthat is, with calculating the solution set of the homogeneous linear system.\n",
    "v1\n+ 3v3 = 0\nv2 + 2v3 = 0\n=⇒\nP⊥= {k\n\n\n\n−3\n−2\n1\n\n\n|",
    "k ∈R}\n3.6 Example Where M is the xy-plane subspace of R3, what is M⊥?",
    "A common\nﬁrst reaction is that M⊥is the yz-plane but that’s not right because some\nvectors from the yz-plane are not perpendicular to every vector in the xy-plane.\n",
    "\n\n1\n1\n0\n\n̸⊥\n\n\n0\n3\n2\n\n\nθ = arccos(1 · 0",
    "+ 1 · 3 + 0 · 2\n√\n2 ·\n√\n13\n) ≈0.94 rad\nInstead M⊥is the z-axis, since proceeding as in the prior example and taking\nthe natural basis for the xy-plane gives this.\n",
    "M⊥= {\n\n\n\nx\ny\nz\n\n\n|\n \n1\n0\n0\n0\n1\n0\n!",
    "\n\n\nx\ny\nz\n\n\n=\n \n0\n0\n!\n} = {\n\n\n\nx\ny\nz\n\n\n|",
    "x = 0 and y = 0}\n3.7 Lemma If M is a subspace of Rn then its orthogonal complement M⊥is also\na subspace.",
    "The space is the direct sum of the two Rn = M ⊕M⊥. For any\n⃗v ∈Rn the vector ⃗v −projM(⃗v ) is perpendicular to every vector in M.\nProof First, the orthogonal complement M⊥is a subspace of Rn because it is\na null space, namely the null space of the orthogonal projection map.\n",
    "To show that the space Rn is the direct sum of the two, start with any basis\nBM = ⟨⃗µ1, . .",
    ".",
    ",⃗µk⟩for M. Expand it to a basis for the entire space and then\n\n290\nChapter Three.",
    "Maps Between Spaces\napply the Gram-Schmidt process to get an orthogonal basis K = ⟨⃗κ1, . . .",
    ",⃗κn⟩\nfor Rn.",
    "This K is the concatenation of two bases: ⟨⃗κ1, . . .",
    ",⃗κk⟩with the same\nnumber of members, k, as BM, and D = ⟨⃗κk+1, . . .",
    ",⃗κn⟩. The ﬁrst is a basis for\nM so if we show that the second is a basis for M⊥then we will have that the\nentire space is the direct sum.\n",
    "Exercise 22 from the prior subsection proves this about any orthogonal\nbasis: each vector ⃗v in the space is the sum of its orthogonal projections into\nthe lines spanned by the basis vectors.\n",
    "⃗v = proj[⃗κ1](⃗v ) + · · · + proj[⃗κn](⃗v )\n(∗)\nTo check this, represent the vector as ⃗v = r1⃗κ1 + · · ·",
    "+ rn⃗κn, apply ⃗κi to both\nsides ⃗v •",
    "⃗κi = (r1⃗κ1 + · · · + rn⃗κn) •",
    "⃗κi = r1 · 0 + · · · + ri · (⃗κi • ⃗κi) + · · · + rn · 0,\nand solve to get ri = (⃗v • ⃗κi)/(⃗κi • ⃗κi), as desired.\n",
    "Any member of the span of D is orthogonal to any vector in M so the span\nof D is a subset of M⊥. To show that D is a basis for M⊥we need only show\nthe other containment, that any ⃗w ∈M⊥is an element of the span of D. The\nprior paragraph works for this.",
    "Any ⃗w ∈M⊥gives this on projections into basis\nvectors from M: proj[⃗κ1](⃗w ) = ⃗0, . . .",
    ", proj[⃗κk](⃗w )",
    "= ⃗0.",
    "Therefore equation (∗)\ngives that ⃗w is a linear combination of ⃗κk+1, . . .",
    ",⃗κn.",
    "Thus D is a basis for M⊥\nand Rn is the direct sum of the two.\n",
    "The ﬁnal sentence of the lemma is proved in much the same way.",
    "Write\n⃗v = proj[⃗κ1](⃗v ) + · · · + proj[⃗κn](⃗v ).",
    "Then projM(⃗v ) keeps only the M part\nand drops the M⊥part: projM(⃗v )",
    "= proj[⃗κ1](⃗v )",
    "+ · · · + proj[⃗κk](⃗v ).",
    "Therefore\n⃗v −projM(⃗v ) consists of a linear combination of elements of M⊥and",
    "so is\nperpendicular to every vector in M.\nQED\nGiven a subspace, we could compute the orthogonal projection into that\nsubspace by following the steps of that proof: ﬁnding a basis, expanding it\nto a basis for the entire space, applying Gram-Schmidt to get an orthogonal\nbasis, and projecting into each linear subspace.",
    "However we will instead use a\nconvenient formula.\n",
    "3.8 Theorem Let M be a subspace of Rn with basis ⟨⃗β1, . . .",
    ", ⃗βk⟩and let A be\nthe matrix whose columns are the ⃗β’s.",
    "Then for any ⃗v ∈Rn",
    "the orthogonal\nprojection is projM(⃗v )",
    "= c1⃗β1 + · · · + ck⃗βk, where the coeﬃcients ci are the\nentries of the vector (ATA)−1AT ·⃗v.",
    "That is, projM(⃗v ) = A(ATA)−1AT ·⃗v.\n",
    "Proof The vector projM(⃗v) is a member of M and so is a linear combination\nof basis vectors c1 · ⃗β1 + · · · + ck · ⃗βk.",
    "Since A’s columns are the ⃗β’s, there is a\n⃗c ∈Rk such that projM(⃗v )",
    "= A⃗c.",
    "To ﬁnd ⃗c note that the vector ⃗v −projM(⃗v )\n\nSection VI.",
    "Projection\n291\nis perpendicular to each member of the basis so\n⃗0 = AT\u0000⃗v −A⃗c\n\u0001\n= AT⃗v −ATA⃗c\nand solving gives this (showing that ATA is invertible is an exercise).\n",
    "⃗c =\n\u0000ATA\n\u0001−1AT ·⃗v\nTherefore projM(⃗v )",
    "= A · ⃗c = A(ATA)−1AT ·⃗v, as required.\n",
    "QED\n3.9 Example To orthogonally project this vector into this subspace\n⃗v =\n\n\n\n1\n−1\n1\n\n\n\nP = {\n\n\n\nx\ny\nz\n\n\n|",
    "x + z = 0}\nﬁrst make a matrix whose columns are a basis for the subspace\nA =\n\n\n\n0\n1\n1\n0\n0\n−1\n\n\n\nand then compute.\n",
    "A\n\u0000ATA\n\u0001−1AT =\n\n\n\n0\n1\n1\n0\n0\n−1\n\n\n\n \n1\n0\n0\n1/2\n!  \n",
    "0\n1\n0\n1\n0\n−1\n!\n=\n\n\n\n1/2\n0\n−1/2\n0\n1\n0\n−1/2\n0\n1/2\n\n\n\nWith the matrix, calculating the orthogonal projection of any vector into P is\neasy.\n",
    "projP(⃗v)",
    "=\n\n\n\n1/2\n0\n−1/2\n0\n1\n0\n−1/2\n0\n1/2\n\n\n\n\n\n\n1\n−1\n1\n\n\n=\n\n\n\n0\n−1\n0\n\n\n\nNote, as a check, that this result is indeed in P.\nExercises\n✓3.10 Project the vectors into M along N.\n(a)\n\u0012 3\n−2\n\u0013\n,\nM = {\n\u0012x\ny\n\u0013\n| x",
    "+ y = 0},\nN = {\n\u0012x\ny\n\u0013\n| −x −2y = 0}\n(b)\n\u00121\n2\n\u0013\n,\nM = {\n\u0012x\ny\n\u0013\n| x −y = 0},\nN = {\n\u0012x\ny\n\u0013\n| 2x +",
    "y = 0}\n(c)\n\n\n3\n0\n1\n\n,\nM = {\n\n\nx\ny\nz\n\n",
    "|",
    "x",
    "+ y",
    "= 0},\nN = {c ·\n\n\n1\n0\n1\n\n",
    "| c ∈R}\n✓3.11 Find M⊥.\n\n292\nChapter Three.",
    "Maps Between Spaces\n(a) M = {\n\u0012x\ny\n\u0013\n| x",
    "+ y = 0}\n(b) M = {\n\u0012x\ny\n\u0013\n| −2x + 3y = 0}\n(c) M = {\n\u0012x\ny\n\u0013\n| x −y = 0}\n(d) M = {⃗0 }\n(e) M = {\n\u0012x\ny\n\u0013\n| x",
    "= 0}\n(f)",
    "M = {\n\n\nx\ny\nz\n\n| −x + 3y + z = 0}\n(g) M = {\n\n\nx\ny\nz\n\n",
    "| x",
    "= 0 and y + z = 0}\n✓3.12 Find the orthogonal projection of the vector into the subspace.\n",
    "\n\n1\n2\n0\n\n\nS = [ {\n\n\n0\n2\n0\n\n,\n\n\n1\n−1\n1\n\n} ]\n✓3.13 With the same subspace as in the prior problem, ﬁnd the orthogonal projection\nof this vector.\n",
    "\n\n1\n2\n−1\n\n\n✓3.14 Let ⃗p be the orthogonal projection of ⃗v ∈Rn onto a subspace S. Show that ⃗p\nis the point in the subspace closest to ⃗v.\n",
    "3.15",
    "This subsection shows how to project orthogonally in two ways, the method of\nExample 3.2 and 3.3, and the method of Theorem 3.8.",
    "To compare them, consider\nthe plane P speciﬁed by 3x + 2y −z = 0 in R3.\n(a) Find a basis for P.\n(b) Find P⊥and a basis for P⊥.\n(c)",
    "Represent this vector with respect to the concatenation of the two bases from\nthe prior item.\n",
    "⃗v",
    "=\n\n\n1\n1\n2\n\n\n(d) Find the orthogonal projection of ⃗v into P by keeping only the P part from\nthe prior item.\n",
    "(e) Check that against the result from applying Theorem 3.8.\n",
    "3.16 We have three ways to ﬁnd the orthogonal projection of a vector into a line,\nthe Deﬁnition 1.1 way from the ﬁrst subsection of this section, the Example 3.2\nand 3.3 way of representing the vector with respect to a basis for the space and\nthen keeping the M part, and the way of Theorem 3.8.",
    "For these cases, do all three\nways.\n",
    "(a) ⃗v =\n\u0012 1\n−3\n\u0013\n,\nM = {\n\u0012x\ny\n\u0013\n| x",
    "+ y = 0}\n(b) ⃗v",
    "=\n\n\n0\n1\n2\n\n,\nM = {\n\n\nx\ny\nz\n\n|",
    "x + z = 0 and y = 0}\n3.17 Check that the operation of Deﬁnition 3.1 is well-deﬁned.",
    "That is, in Exam-\nple 3.2 and 3.3, doesn’t the answer depend on the choice of bases?\n3.18",
    "What is the orthogonal projection into the trivial subspace?\n\nSection VI.",
    "Projection\n293\n3.19 What is the projection of ⃗v into M along N if ⃗v ∈M?\n3.20 Show that if M ⊆Rn is a subspace with orthonormal basis ⟨⃗κ1, . . .",
    ",⃗κn⟩then\nthe orthogonal projection of ⃗v into M is this.\n",
    "(⃗v • ⃗κ1) · ⃗κ1 + · · · + (⃗v • ⃗κn) · ⃗κn\n✓3.21 Prove that the map p: V →V is the projection into M along N if and only\nif the map id −p is the projection into N along M. (Recall the deﬁnition of the\ndiﬀerence of two maps: (id −p) (⃗v) = id(⃗v) −p(⃗v)",
    "= ⃗v −p(⃗v).)\n",
    "3.22 Show that if a vector is perpendicular to every vector in a set then it is\nperpendicular to every vector in the span of that set.\n",
    "3.23 True or false",
    ": the intersection of a subspace and its orthogonal complement is\ntrivial.\n",
    "3.24 Show that the dimensions of orthogonal complements add to the dimension of\nthe entire space.\n",
    "3.25 Suppose that ⃗v1,⃗v2 ∈Rn are such that for all complements M, N ⊆Rn, the\nprojections of ⃗v1 and ⃗v2 into M along N are equal.",
    "Must ⃗v1 equal ⃗v2?",
    "(If so, what\nif we relax the condition to: all orthogonal projections of the two are equal?)\n✓3.26 Let M, N be subspaces of Rn.",
    "The perp operator acts on subspaces; we can\nask how it interacts with other such operations.\n",
    "(a) Show that two perps cancel: (M⊥)⊥= M.\n(b) Prove that M ⊆N implies that N⊥⊆M⊥.\n(c) Show that (M + N)⊥= M⊥∩N⊥.\n✓3.27 The material in this subsection allows us to express a geometric relationship\nthat we have not yet seen between the range space and the null space of a linear\nmap.\n",
    "(a) Represent f: R3 →R given by\n\n\nv1\nv2\nv3\n\n7→1v1",
    "+ 2v2 + 3v3\nwith respect to the standard bases and show that\n\n\n1\n2\n3\n\n\nis a member of the perp of the null space.",
    "Prove that N (f)⊥is equal to the\nspan of this vector.\n",
    "(b) Generalize that to apply to any f:",
    "Rn →R.\n(c) Represent f: R3 →R2\n\n\nv1\nv2\nv3\n\n7→\n\u00121v1 + 2v2",
    "+ 3v3\n4v1",
    "+ 5v2 + 6v3\n\u0013\nwith respect to the standard bases and show that\n\n\n1\n2\n3\n\n,\n\n\n4\n5\n6\n\n\n\n294\nChapter Three.",
    "Maps Between Spaces\nare both members of the perp of the null space.",
    "Prove that N (f)⊥is the span\nof these two.",
    "(Hint.",
    "See the third item of Exercise 26.)\n(d) Generalize that to apply to any f: Rn →Rm.\n",
    "In [Strang 93]",
    "this is called the Fundamental Theorem of Linear Algebra\n3.28 Deﬁne a projection to be a linear transformation t: V →V with the property\nthat repeating the projection does nothing more than does the projection alone: (t◦\nt) (⃗v) = t(⃗v) for all ⃗v ∈V.\n(a) Show that orthogonal projection into a line has that property.\n",
    "(b) Show that projection along a subspace has that property.\n",
    "(c) Show that for any such t there is a basis B = ⟨⃗β1, . . .",
    ", ⃗βn⟩for V such that\nt(⃗βi) =\n\u000e⃗βi\ni = 1, 2, . .",
    ".",
    ", r\n⃗0\ni = r + 1, r + 2, . . .",
    ", n\nwhere r is the rank of t.\n(d) Conclude that every projection is a projection along a subspace.\n",
    "(e) Also conclude that every projection has a representation\nRepB,B(t) =\n \nI\nZ\nZ\nZ\n!\n",
    "in block partial-identity form.\n",
    "3.29",
    "A square matrix is symmetric if each i, j entry equals the j, i entry (i.e., if the\nmatrix equals its transpose).",
    "Show that the projection matrix A(ATA)−1AT is\nsymmetric.",
    "[Strang 80] Hint.",
    "Find properties of transposes by looking in the index\nunder ‘transpose’.\n\n",
    "Topic\nLine of Best Fit\nThis Topic requires the formulas from the subsections on Orthogonal Pro-\njection Into a Line and Projection Into a Subspace.\n",
    "Scientists are often presented with a system that has no solution and they\nmust ﬁnd an answer anyway.",
    "More precisely, they must ﬁnd a best answer.\n",
    "For instance, this is the result of ﬂipping a penny, including some intermediate\nnumbers.\n",
    "number of ﬂips\n30\n60\n90\nnumber of heads\n16\n34\n51\nBecause of the randomness in this experiment we expect that the ratio of heads\nto ﬂips will ﬂuctuate around a penny’s long-term ratio of 50-50.",
    "So the system\nfor such an experiment likely has no solution, and that’s what happened here.\n",
    "30m = 16\n60m = 34\n90m = 51\nThat is, the vector of data that we collected is not in the subspace where ideally\nit would be.\n",
    "\n\n\n16\n34\n51\n\n\n̸∈{m\n\n\n\n30\n60\n90\n\n\n| m ∈R}\nHowever, we have to do something so we look for the m that most nearly works.\n",
    "An orthogonal projection of the data vector into the line subspace gives a best\nguess, the vector in the subspace closest to the data vector.\n",
    "\n\n\n16\n34\n51\n\n\n•\n\n\n\n30\n60\n90\n\n\n\n\n\n\n30\n60\n90\n\n\n•\n\n\n\n30\n60\n90\n\n\n\n·\n\n\n\n30\n60\n90\n\n\n= 7110\n12600 ·\n\n\n\n30\n60\n90\n\n\n\n\n296\nChapter Three.",
    "Maps Between Spaces\nThe estimate (m = 7110/12600 ≈0.56) is a bit more than one half, but not\nmuch more than half, so probably the penny is fair enough.\n",
    "The line with the slope m ≈0.56 is the line of best ﬁt for this data.\n",
    "ﬂips\n30\n60\n90\nheads\n30\n60\nMinimizing the distance between the given vector and the vector used as the\nright-hand side minimizes the total of these vertical lengths, and consequently\nwe say that the line comes from ﬁtting by least-squares.\n",
    "This diagram exaggerates the vertical scale by a factor of ten to make the lengths\nmore visible.\n",
    "In the above equation the line must pass through (0, 0), because we take it\nto be the line whose slope is this coin’s true proportion of heads to ﬂips.",
    "We\ncan also handle cases where the line need not pass through the origin.\n",
    "Here is the progression of world record times for the men’s mile race\n[Oakley & Baker].",
    "In the early 1900’s many people wondered when, or if, this\nrecord would fall below the four minute mark.",
    "Here are the times that were in\nforce on January ﬁrst of each decade through the ﬁrst half of that century.\n",
    "year\n1870\n1880\n1890\n1900\n1910\n1920\n1930\n1940\n1950\nsecs\n268.8\n264.5\n258.4\n255.6\n255.6\n252.6\n250.4\n246.4\n241.4\n",
    "We can use this to give a circa 1950 prediction of the date for 240 seconds, and\nthen compare that to the actual date.",
    "As with the penny data, these numbers\ndo not lie in a perfect line.",
    "That is, this system does not have an exact solution\nfor the slope and intercept.\nb + 1870m",
    "= 268.8\nb + 1880m = 264.5\n...\n",
    "b + 1950m",
    "= 241.4\n",
    "We ﬁnd a best approximation by using orthogonal projection.\n",
    "(Comments on the data.",
    "Restricting to the times at the start of each decade\nreduces the data entry burden, smooths the data to some extent, and gives much\n\nTopic: Line of Best Fit\n297\nthe same result as entering all of the dates and records.",
    "There are diﬀerent\nsequences of times from competing standards bodies but the ones here are from\n[Wikipedia, Mens Mile].",
    "We’ve started the plot at 1870 because at one point\nthere were two classes of records, called ‘professional’ and ‘amateur’, and after a\nwhile the ﬁrst class stopped being active so we’ve followed the second class.)\n",
    "Write the linear system’s matrix of coeﬃcients and also its vector of constants,\nthe world record times.\n",
    "A =\n\n\n\n\n\n\n1\n1870\n1\n1880\n...\n...\n1\n1950\n\n\n\n\n\n\n⃗v =\n\n\n\n\n\n\n268.8\n264.5\n...\n241.4\n\n\n\n\n\n\n",
    "The ending result in the subsection on Projection into a Subspace gives the\nformula for the the coeﬃcients b and m that make the linear combination of\nA’s columns as close as possible to ⃗v.",
    "Those coeﬃcients are the entries of the\nvector (ATA)−1AT ·⃗v.\n",
    "Sage can do the computation for us.\n",
    "sage: year =",
    "[1870, 1880, 1890, 1900, 1910, 1920, 1930, 1940, 1950]\nsage: secs =",
    "[268.8, 264.5, 258.4, 255.6, 255.6, 252.6, 250.4, 246.4, 241.4]\nsage: var('a, b, t')\n(a, b, t)\nsage: model(t) = a*t+b\nsage: data = zip(year, secs)\nsage: fit = find_fit(data, model, solution_dict=True)\nsage: model.subs(fit)\nt |--> -0.3048333333333295*t + 837.0872222222147\nsage: g=points(data)+plot(model.subs(fit),(t,1860,1960),color='red',\n....:\nfigsize=3,fontsize=7,typeset='latex')\nsage: g.save(\"four_minute_mile.pdf\")\nsage: g\n1860\n1880\n1900\n1920\n1940\n1960\n240\n245\n250\n255\n260\n265\n270\n",
    "The progression makes a surprisingly good line.",
    "From the slope and intercept we\npredict 1958.73; the actual date of Roger Bannister’s record was 1954-May-06.\n",
    "The ﬁnal example compares team salaries from US major league baseball\nagainst the number of wins the team had, for the year 2002.",
    "In this year the\n\n298\nChapter Three.",
    "Maps Between Spaces\nOakland Athletics used mathematical techniques to optimize the players that\nthey ﬁelded for the money that they could spend, as told in the ﬁlm Moneyball.\n",
    "(Salaries are in millions of dollars and the number of wins is out of 162 games).\n",
    "To do the computations we again use Sage.\nsage: sal",
    "=",
    "[40, 40, 39, 42, 45, 42, 62, 34, 41, 57, 58, 63, 47, 75, 57, 78, 80, 50, 60, 93,\n....:\n77, 55, 95, 103, 79, 76, 108, 126, 95, 106]\nsage: wins =",
    "[103, 94, 83, 79, 78, 72, 99, 55, 66, 81, 80, 84, 62, 97, 73, 95, 93, 56, 67,\n....:\n101, 78, 55, 92, 98, 74, 67, 93, 103, 75, 72]\nsage: var('a, b, t')\n(a, b, t)\nsage: model(t) = a*t+b\nsage: data = zip(sal,wins)\nsage: fit = find_fit(data, model, solution_dict=True)\nsage: model.subs(fit)\nt |--> 0.2634981251436269*t + 63.06477642781477\nsage: p = points(data,size=25)+plot(model.subs(fit),(t,30,130),color='red',typeset='latex')\n",
    "sage: p.save('moneyball.pdf')\n",
    "The graph is below.",
    "The team in the upper left, who paid little for many\nwins, is the Oakland A’s.\n40\n60\n80\n100\n120\n60\n70\n80\n90\n100\nJudging this line by eye would be error-prone.",
    "So the equations give us a\ncertainty about the ‘best’ in best ﬁt.",
    "In addition, the model’s equation tells us\nroughly that by spending an additional million dollars a team owner can expect\nto buy 1/4 of a win (and that expectation is not very sure, thank goodness).\n",
    "Exercises\nThe calculations here are best done on a computer.",
    "Some of the problems require\ndata from the Internet.\n",
    "1 Use least-squares to judge if the coin in this experiment is fair.\n",
    "ﬂips\n8\n16\n24\n32\n40\nheads\n4\n9\n13\n17\n20\n2 For the men’s mile record, rather than give each of the many records and its exact\ndate, we’ve “smoothed” the data somewhat by taking a periodic sample.",
    "Do the\nlonger calculation and compare the conclusions.\n",
    "3 Find the line of best ﬁt for the men’s 1500 meter run.",
    "How does the slope compare\nwith that for the men’s mile?",
    "(The distances are close; a mile is about 1609 meters.)\n\n",
    "Topic: Line of Best Fit\n299\n4 Find the line of best ﬁt for the records for women’s mile.\n5 Do the lines of best ﬁt for the men’s and women’s miles cross?\n6 (This illustrates that there are data sets for which a linear model is not right,\nand that the line of best ﬁt doesn’t in that case have any predictive value.)",
    "In a\nhighway restaurant a trucker told me that his boss often sends him by a roundabout\nroute, using more gas but paying lower bridge tolls.",
    "He said that New York State\ncalibrates the toll for each bridge across the Hudson, playing oﬀthe extra gas to\nget there from New York City against a lower crossing cost, to encourage people to\ngo upstate.",
    "This table, from [Cost Of Tolls] and [Google Maps], lists for each toll\ncrossing of the Hudson River, the distance to drive from Times Square in miles\nand the cost in US dollars for a passenger car (if a crossings has a one-way toll\nthen it shows half that number).\n",
    "Crossing\nDistance\nToll\nLincoln Tunnel\nHolland Tunnel\nGeorge Washington Bridge\nVerrazano-Narrows Bridge\nTappan Zee Bridge\nBear Mountain Bridge\nNewburgh-Beacon Bridge\nMid-Hudson Bridge\nKingston-RhinecliﬀBridge\nRip Van Winkle Bridge\n2\n7\n8\n16\n27\n47\n67\n82\n102\n120\n6.00\n6.00\n6.00\n6.50\n2.50\n1.00\n1.00\n1.00\n1.00\n1.00\nFind the line of best ﬁt and graph the data to show that the driver was practicing\non my credulity.\n",
    "7",
    "When the space shuttle Challenger exploded in 1986, one of the criticisms made\nof NASA’s decision to launch was in the way they did the analysis of number of\nO-ring failures versus temperature (O-ring failure caused the explosion).",
    "Four\nO-ring failures would be fatal.",
    "NASA had data from 24 previous ﬂights.\n",
    "temp ◦F\n53\n75\n57\n58\n63\n70\n70\n66\n67\n67\n67\nfailures\n3\n2\n1\n1\n1\n1\n1\n0\n0\n0\n0\n68\n69\n70\n70\n72\n73\n75\n76\n76\n78\n79\n80\n81\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nThe temperature that day was forecast to be 31◦F.\n(a) NASA based the decision to launch partially on a chart showing only the\nﬂights that had at least one O-ring failure.",
    "Find the line that best ﬁts these\nseven ﬂights.",
    "On the basis of this data, predict the number of O-ring failures\nwhen the temperature is 31, and when the number of failures will exceed four.\n(b) Find the line that best ﬁts all 24 ﬂights.",
    "On the basis of this extra data,\npredict the number of O-ring failures when the temperature is 31, and when the\nnumber of failures will exceed four.\n",
    "Which do you think is the more accurate method of predicting?",
    "(An excellent\ndiscussion is in [Dalal, et.",
    "al.].)\n\n",
    "300\nChapter Three.",
    "Maps Between Spaces\n8",
    "This table lists the average distance from the sun to each of the ﬁrst seven planets,\nusing Earth’s average as a unit.\n",
    "Mercury\nVenus\nEarth\nMars\nJupiter\nSaturn\nUranus\n0.39\n0.72\n1.00\n1.52\n5.20\n9.54\n19.2\n(a) Plot the number of the planet (Mercury is 1, etc.)",
    "versus the distance.",
    "Note\nthat it does not look like a line, and so ﬁnding the line of best ﬁt is not fruitful.\n",
    "(b) It does, however look like an exponential curve.",
    "Therefore, plot the number\nof the planet versus the logarithm of the distance.",
    "Does this look like a line?\n(c)",
    "The asteroid belt between Mars and Jupiter is what is left of a planet that\nbroke apart.",
    "Renumber so that Jupiter is 6, Saturn is 7, and Uranus is 8, and\nplot against the log again.",
    "Does this look better?\n(d) Use least squares on that data to predict the location of Neptune.\n",
    "(e) Repeat to predict where Pluto is.\n",
    "(f) Is the formula accurate for Neptune and Pluto?\n",
    "This method was used to help discover Neptune (although the second item is\nmisleading about the history; actually, the discovery of Neptune in position 9\nprompted people to look for the “missing planet” in position 5).",
    "See [Gardner, 1970]\n9 Suppose that W is a subspace of Rn for some n and suppose that ⃗v is not an\nelement of W. Let the orthogonal projection of ⃗v into W be the vector projW(⃗v)",
    "= ⃗p.\n",
    "Show that ⃗p is the element of W that is closest to ⃗v.\n\n",
    "Topic\nGeometry of Linear Maps\nThese pairs of pictures contrast the geometric action of the nonlinear maps\nf1(x) = ex and f2(x) = x2\n0\n5\n0\n5\n0\n5\n0\n5\nwith the linear maps h1(x) = 2x and h2(x) = −x.\n-5\n0\n5\n-5\n0\n5\n-5\n0\n5\n-5\n0\n5\nEach of the four pictures shows the domain R on the left mapped to the codomain\nR on the right.",
    "Arrows trace where each map sends x = 0, x = 1, x = 2, x = −1,\nand x = −2.\n",
    "The nonlinear maps distort the domain in transforming it into the range.",
    "For\n\n302\nChapter Three.",
    "Maps Between Spaces\ninstance, f1(1) is further from f1(2) than it is from f1(0) — this map spreads the\ndomain out unevenly so that a domain interval near x = 2 is spread apart more\nthan is a domain interval near x",
    "= 0.",
    "The linear maps are nicer, more regular,\nin that for each map all of the domain spreads by the same factor.",
    "The map h1\non the left spreads all intervals apart to be twice as wide while on the right h2\nkeeps intervals the same length but reverses their orientation, as with the rising\ninterval from 1 to 2 being transformed to the falling interval from −1 to −2.\n",
    "The only linear maps from R to R are multiplications by a scalar but in\nhigher dimensions more can happen.",
    "For instance, this linear transformation of\nR2 rotates vectors counterclockwise.\n",
    "\nx\ny\n\n7→\n\nx cos θ −y sin θ\nx sin θ + y cos θ\n\n\n−−−−−−−−−−−−−−−−−→\nThe transformation of R3 that projects vectors into the xz-plane is also not\nsimply a rescaling.\n\n\n\n\nx\ny\nz\n\n\n\n7→\n\n\n\n\nx\n0\nz\n\n\n\n\n−−−−−−−→\nDespite this additional variety, even in higher dimensions linear maps behave\nnicely.",
    "Consider a linear h: Rn →Rm and use the standard bases to represent it\nby a matrix H. Recall from Theorem V.2.7 that H factors into H = PBQ where P\nand Q are nonsingular and B is a partial-identity matrix.",
    "Recall also that nonsin-\ngular matrices factor into elementary matrices PBQ = TnTn−1 · · · TsBTs−1 · · · T1,\nwhich are matrices that come from the identity I after one Gaussian row opera-\ntion, so each T matrix is one of these three kinds\nI\nkρi\n−→\nMi(k)\n",
    "I\nρi↔ρj\n−→\nPi,j\nI\nkρi+ρj\n−→\nCi,j(k)\nwith i ̸= j, k ̸= 0.",
    "So if we understand the geometric eﬀect of a linear map\ndescribed by a partial-identity matrix and the eﬀect of the linear maps described\nby the elementary matrices then we will in some sense completely understand\nthe eﬀect of any linear map.",
    "(The pictures below stick to transformations of R2\nfor ease of drawing but the principles extend for maps from any Rn to any Rm.)\n\n",
    "Topic: Geometry of Linear Maps\n303\nThe geometric eﬀect of the linear transformation represented by a partial-\nidentity matrix is projection.\n\n\n\nx\ny\nz\n\n\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n0\n\n\n−−−−−→\n\n\n\nx\ny\n0\n\n\n\n",
    "The geometric eﬀect of the Mi(k) matrices is to stretch vectors by a factor\nof k along the i-th axis.",
    "This map stretches by a factor of 3 along the x-axis.\n",
    "\nx\ny\n\n7→\n\n3x\ny\n\n\n−−−−−−−−→\nIf 0 ⩽k < 1 or if k < 0 then the i-th component goes the other way, here to the\nleft.\n",
    "\nx\ny\n\n7→\n\n−2x\ny\n\n\n−−−−−−−−−→\nEither of these stretches is a dilation.\n",
    "A transformation represented by a Pi,j matrix interchanges the i-th and j-th\naxes.",
    "This is reﬂection about the line xi = xj.\n\nx\ny\n\n7→\n\ny\nx\n\n\n−−−−−−−→\nPermutations involving more than two axes decompose into a combination of\nswaps of pairs of axes; see Exercise 7.\n",
    "The remaining matrices have the form Ci,j(k).",
    "For instance C1,2(2) performs\n2ρ1 + ρ2.\n \n",
    "x\ny\n!\n",
    "\u00121\n0\n2\n1\n\u0013\n−−−→\n \nx\n2x + y\n!\n",
    "In the picture below, the vector ⃗u with the ﬁrst component of 1 is aﬀected less\nthan the vector ⃗v with the ﬁrst component of 2.",
    "The vector ⃗u is mapped to a\nh(⃗u) that is only 2 higher than ⃗u while h(⃗v) is 4 higher than ⃗v.\n",
    "\nx\ny\n\n7→\n\n\nx\n2x + y\n\n\n−−−−−−−−−−−→\n⃗u\n⃗v\nh(⃗u)\nh(⃗v)\n\n304\nChapter Three.",
    "Maps Between Spaces\nAny vector with a ﬁrst component of 1 would be aﬀected in the same way as\n⃗u: it would slide up by 2.",
    "And any vector with a ﬁrst component of 2 would\nslide up 4, as was ⃗v.",
    "That is, the transformation represented by Ci,j(k) aﬀects\nvectors depending on their i-th component.\n",
    "Another way to see this point is to consider the action of this map on the\nunit square.",
    "In the next picture, vectors with a ﬁrst component of 0, such as the\norigin, are not pushed vertically at all but vectors with a positive ﬁrst component\nslide up.",
    "Here, all vectors with a ﬁrst component of 1, the entire right side of\nthe square, slide to the same extent.",
    "In general, vectors on the same vertical\nline slide by the same amount, by twice their ﬁrst component.",
    "The resulting\nshape has the same base and height as the square (and thus the same area) but\nthe right angle corners are gone.\n",
    "\nx\ny\n\n7→\n\n\nx\n2x + y\n\n\n−−−−−−−−−−−→\nFor contrast, the next picture shows the eﬀect of the map represented by\nC2,1(2).",
    "Here vectors are aﬀected according to their second component:\n\u0000x\ny\n\u0001\nslides horizontally by twice y.\n\nx\ny\n\n7→\n\nx + 2y\ny\n\n\n−−−−−−−−−−−→\nIn general, for any Ci,j(k), the sliding happens so that vectors with the same\ni-th component are slid by the same amount.",
    "This kind of map is a shear.\n",
    "With that we understand the geometric eﬀect of the four types of matrices\non the right-hand side of H = TnTn−1 · · · TjBTj−1 · · · T1 and so in some sense we\nunderstand the action of any matrix H. Thus, even in higher dimensions the\ngeometry of linear maps is easy: it is built by putting together a number of\ncomponents, each of which acts in a simple way.\n",
    "We will apply this understanding in two ways.",
    "The ﬁrst way is to prove\nsomething general about the geometry of linear maps.",
    "Recall that under a linear\nmap, the image of a subspace is a subspace and thus the linear transformation\nh represented by H maps lines through the origin to lines through the origin.\n",
    "(The dimension of the image space cannot be greater than the dimension of the\ndomain space, so a line can’t map onto, say, a plane.)",
    "We will show that h maps\nany line — not just one through the origin — to a line.",
    "The proof is simple: the\npartial-identity projection B and the elementary Ti’s each turn a line input into\na line output; verifying the four cases is Exercise 5.",
    "Therefore their composition\nalso preserves lines.\n\n",
    "Topic: Geometry of Linear Maps\n305\nThe second way that we will apply the geometric understanding of linear\nmaps is to elucidate a point from Calculus.",
    "Below is a picture of the action of\nthe one-variable real function y(x)",
    "= x2 + x.",
    "As with the nonlinear functions\npictured earlier, the geometric eﬀect of this map is irregular in that at diﬀerent\ndomain points it has diﬀerent eﬀects; for example as the input x goes from 2 to\n−2, the associated output f(x) at ﬁrst decreases, then pauses for an instant, and\nthen increases.\n",
    "0\n5\n0\n5\nBut in Calculus we focus less on the map overall and more on the local eﬀect\nof the map.",
    "Below we look closely at what this map does near x",
    "= 1.",
    "The\nderivative is dy/dx = 2x +",
    "1",
    "so that near x = 1 we have ∆y ≈3 · ∆x.",
    "That is, in\na neighborhood of x = 1, in carrying the domain over this map causes it to grow\nby a factor of 3 — it is, locally, approximately, a dilation.",
    "The picture below\nshows this as a small interval in the domain (1 −∆x ..",
    "1 + ∆x) carried over to an\ninterval in the codomain (2 −∆y ..",
    "2 + ∆y) that is three times as wide.\n",
    "x = 1\ny = 2\nIn higher dimensions the core idea is the same but more can happen.",
    "For a\nfunction y: Rn →Rm and a point ⃗x ∈Rn, the derivative is deﬁned to be the\nlinear map h:",
    "Rn →Rm that best approximates how y changes near y(⃗x).",
    "So\nthe geometry described above directly applies to the derivative.\n",
    "We close by remarking how this point of view makes clear an often misun-\nderstood result about derivatives, the Chain Rule.",
    "Recall that, under suitable\n\n306\nChapter Three.",
    "Maps Between Spaces\nconditions on the two functions, the derivative of the composition is this.\n",
    "d (g ◦f)\ndx\n(x) = dg\ndx(f(x)) ·",
    "df\ndx(x)\n",
    "For instance the derivative of sin(x2 + 3x) is cos(x2 + 3x) · (2x + 3).\n",
    "Where does this come from?",
    "Consider f, g: R →R.\nx\nf(x)\ng(f(x))\n",
    "The ﬁrst map f dilates the neighborhood of x by a factor of\ndf\ndx(x)\nand the second map g follows that by dilating a neighborhood of f(x) by a factor\nof\ndg\ndx( f(x) )\nand when combined, the composition dilates by the product of the two.",
    "In\nhigher dimensions the map expressing how a function changes near a point is\na linear map, and is represented by a matrix.",
    "The Chain Rule multiplies the\nmatrices.\n",
    "Exercises\n1 Use the H = PBQ decomposition to ﬁnd the combination of dilations, ﬂips, skews,\nand projections that produces the map h: R3 →R3 represented with respect to\nthe standard bases by this matrix.\n",
    "H =\n\n\n1\n2\n1\n3\n6\n0\n1\n2\n2\n\n\n2",
    "What combination of dilations, ﬂips, skews, and projections produces a rotation\ncounterclockwise by 2π/3 radians?\n3",
    "If a map is nonsingular then to get from its representation to the identity matrix\nwe do not need any column operations, so that in H = PBQ the matrix Q is the\nidentity.",
    "An example of a nonsingular map is the transformation t−π/4 : R2 →R2\nthat rotates vectors clockwise by π/4 radians.\n",
    "(a) Find the matrix H representing this map with respect to the standard bases.\n\n",
    "Topic: Geometry of Linear Maps\n307\n(b) Use Gauss-Jordan to reduce H to the identity, without column operations.\n",
    "(c) Translate that to a matrix equation TjTj−1 · · ·",
    "T1H = I.\n(d) Solve the matrix equation for H.\n(e) Describe H as a combination of dilations, ﬂips, skews, and projections (the\nidentity is a trivial projection).\n",
    "4 Show that any linear transformation of R1 is a map hk that multiplies by a scalar\nx 7→kx.\n5 Show that linear maps preserve the linear structures of a space.\n",
    "(a) Show that for any linear map from Rn to Rm, the image of any line is a line.\n",
    "The image may be a degenerate line, that is, a single point.\n",
    "(b) Show that the image of any linear surface is a linear surface.",
    "This generalizes\nthe result that under a linear map the image of a subspace is a subspace.\n",
    "(c) Linear maps preserve other linear ideas.",
    "Show that linear maps preserve\n“betweeness”: if the point B is between A and C then the image of B is between\nthe image of A and the image of C.\n6 Use a picture like the one that appears in the discussion of the Chain Rule to\nanswer: if a function f: R →R has an inverse, what’s the relationship between how\nthe function — locally, approximately — dilates space, and how its inverse dilates\nspace (assuming, of course, that it has an inverse)?\n",
    "7 Show that any permutation, any reordering, p of the numbers 1, . . .",
    ", n, the map\n\n\n\n\n\n\nx1\nx2\n...\n",
    "xn\n\n\n\n\n\n\n7→\n\n\n\n\n\n\nxp(1)\nxp(2)\n...\nxp(n)\n\n\n\n\n\n\ncan be done with a composition of maps, each of which only swaps a single pair of\ncoordinates.",
    "Hint: you can use induction on n. (Remark: in the fourth chapter we\nwill show this and we will also show that the parity of the number of swaps used is\ndetermined by p.",
    "That is, although a particular permutation could be expressed in\ntwo diﬀerent ways with two diﬀerent numbers of swaps, either both ways use an\neven number of swaps, or both use an odd number.)\n\n",
    "Topic\nMagic Squares\nA Chinese legend tells the story of a ﬂood by the Lo river.",
    "People oﬀered\nsacriﬁces to appease the river.",
    "Each time a turtle emerged, walked around the\nsacriﬁce, and returned to the water.",
    "Fuh-Hi, the founder of Chinese civilization,\ninterpreted this to mean that the river was still cranky.",
    "Fortunately, a child\nnoticed that on its shell the turtle had the pattern on the left below, which is\ntoday called Lo Shu (“river scroll”).\n",
    "4\n9\n2\n3\n5\n7\n8\n1\n6\nThe dots make the matrix on the right where the rows, columns, and diagonals\nadd to 15.",
    "Now that the people knew how much to sacriﬁce, the river’s anger\ncooled.\n",
    "A square matrix is magic if each row, column, and diagonal adds to the\nsame number, the matrix’s magic number.\n",
    "Another magic square appears in the engraving Melencolia I by Dürer.\n\n",
    "Topic: Magic Squares\n309\nOne interpretation is that it depicts melancholy, a depressed state.",
    "The ﬁgure,\ngenius, has a wealth of fascinating things to explore including the compass, the\ngeometrical solid, the scale, and the hourglass.",
    "But the ﬁgure is unmoved; all of\nthe things lie unused.",
    "One of the potential delights, in the upper right, is a 4×4\nmatrix whose rows, columns, and diagonals add to 34.\n",
    "16\n3\n2\n13\n5\n10\n11\n8\n9\n6\n7\n12\n4\n15\n14\n1\nThe middle entries on the bottom row give 1514, the date of the engraving.\n",
    "The above two squares are arrangements of 1 . . .",
    "n2.",
    "They are normal.",
    "The\n1×1 square whose sole entry is 1 is normal, Exercise 2 shows that there is no nor-\nmal 2×2 magic square, and there are normal magic squares of every other size; see\n[Wikipedia, Magic Square].",
    "Finding how many normal magic squares there are of\neach size is an unsolved problem; see [Online Encyclopedia of Integer Sequences].\n",
    "If we don’t require that the squares be normal then we can say much more.\n",
    "Every 1×1 square is magic, trivially.",
    "If the rows, columns, and diagonals of a\n2×2 matrix\n \na\nb\nc\nd\n!\nadd to s then a+b = s, c+d = s, a+c = s, b+d = s, a+d = s, and b+c = s.\nExercise 2 shows that this system has the unique solution a = b = c = d = s/2.\n",
    "So the set of 2×2 magic squares is a one-dimensional subspace of M2×2.\n",
    "A sum of two same-sized magic squares is magic and a scalar multiple of a\nmagic square is magic so the set of n×n magic squares Mn is a vector space,\na subspace of Mn×n.",
    "This Topic shows that for n ⩾3 the dimension of Mn is\nn2 −n.",
    "The set Mn,0 of n×n magic squares with magic number 0 is another\nsubspace and we will verify the formula for its dimension also: n2 −2n −1 when\nn ⩾3.\n",
    "We will ﬁrst prove that dim Mn = dim Mn,0 + 1.",
    "Deﬁne the trace of a\nmatrix to be the sum down its upper-left to lower-right diagonal Tr(M) =\nm1,1 + · · · + mn,n. Consider the restriction of the trace to the magic squares\n",
    "Tr: Mn →R.",
    "The null space N (Tr) is the set of magic squares with magic\nnumber zero Mn,0.",
    "Observe that the trace is onto because for any r in the\ncodomain R the n×n matrix whose entries are all r/n is a magic square with\nmagic number r. Theorem Two.",
    "II.2.14 says that for any linear map the dimension\n\n310\nChapter Three.",
    "Maps Between Spaces\nof the domain equals the dimension of the range space plus the dimension of the\nnull space, the map’s rank plus its nullity.",
    "Here the domain is Mn, the range\nspace is R and the null space is Mn,0, so we have that dim Mn = 1 + dim Mn,0.\n",
    "We will ﬁnish by ﬁnding the dimension of the vector space Mn,0.",
    "For n = 1\nthe dimension is clearly 0.",
    "Exercise 3 shows that dim Mn,0 is also 0 for n = 2.\n",
    "That leaves showing that dim Mn,0 = n2 −2n −1 for n ⩾3.",
    "The fact that\nthe squares in this vector space are magic gives us a linear system of restrictions,\nand the fact that they have magic number zero makes this system homogeneous:\nfor instance consider the 3×3 case.",
    "The restriction that the rows, columns, and\ndiagonals of\n\n\n\na\nb\nc\nd\ne\nf\ng\nh\ni\n\n\n\nadd to zero gives this (2n + 2)×n2 linear system.\n",
    "a + b + c\n= 0\nd + e + f\n= 0\ng",
    "+",
    "h",
    "+ i = 0\na\n+ d\n",
    "+ g\n= 0\nb\n+ e\n+ h\n= 0\nc\n+ f\n+",
    "i = 0\na\n+ e\n",
    "+ i = 0\nc\n+ e\n+ g\n= 0\n",
    "We will ﬁnd the dimension of the space by ﬁnding the number of free variables\nin the linear system.\n",
    "The matrix of coeﬃcients for the particular cases of n = 3 and n = 4 are\nbelow, with the rows and columns numbered to help in reading the proof.",
    "With\nrespect to the standard basis, each represents a linear map h: Rn2 →R2n+2.\n",
    "The domain has dimension n2 so if we show that the rank of the matrix is 2n+1\nthen we will have what we want, that the dimension of the null space Mn,0 is\nn2 −(2n",
    "+ 1).\n",
    "1\n2\n3\n4\n5\n6\n7\n8\n9\n⃗ρ1\n1\n1\n1\n0\n0\n0\n0\n0\n0\n⃗ρ2\n0\n0\n0\n1\n1\n1\n0\n0\n0\n⃗ρ3\n0\n0\n0\n0\n0\n0\n1\n1\n1\n⃗ρ4\n1\n0\n0\n1\n0\n0\n1\n0\n0\n⃗ρ5\n0\n1\n0\n0\n1\n0\n0\n1\n0\n⃗ρ6\n0\n0\n1\n0\n0\n1\n0\n0\n1\n⃗ρ7\n1\n0\n0\n0\n1\n0\n0\n0\n1\n⃗ρ8\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\nTopic: Magic Squares\n311\n1\n2\n3\n4\n5\n6\n7\n8\n9 10 11 12\n13 14 15 16\n⃗ρ1\n1\n1\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n⃗ρ2\n0\n0\n0\n0\n1\n1\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n⃗ρ3\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n1\n1\n0\n0\n0\n0\n⃗ρ4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n1\n1\n⃗ρ5\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n⃗ρ6\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n⃗ρ7\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n⃗ρ8\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n⃗ρ9\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n⃗ρ10\n0\n0\n0\n1\n0\n0\n1\n0\n0\n1\n0\n0\n1\n0\n0\n0\nWe want to show that the rank of the matrix of coeﬃcients, the number of\nrows in a maximal linearly independent set, is 2n",
    "+ 1.",
    "The ﬁrst n rows of the\nmatrix of coeﬃcients add to the same vector as the second n rows, the vector of\nall ones.",
    "So a maximal linearly independent must omit at least one row.",
    "We will\nshow that the set of all rows but the ﬁrst {⃗ρ2 . . .",
    "⃗ρ2n+2} is linearly independent.\n",
    "So consider this linear relationship.\nc2⃗ρ2 + · · · + c2n⃗ρ2n + c2n+1⃗ρ2n+1",
    "+ c2n+2⃗ρ2n+2 = ⃗0\n(∗)\n",
    "Now it gets messy.",
    "Focus on the lower left of the tables.",
    "Observe that in the\nﬁnal two rows, in the ﬁrst n columns, is a subrow that is all zeros except that it\nstarts with a one in column 1 and a subrow that is all zeros except that it ends\nwith a one in column n.\n",
    "First, with ⃗ρ1 omitted, both column 1 and column n contain only two ones.\n",
    "Since the only rows in (∗) with nonzero column 1 entries are rows ⃗ρn+1 and\n⃗ρ2n+1, which have ones, we must have c2n+1 = −cn+1.",
    "Likewise considering\nthe n-th entries of the vectors in (∗) gives that c2n+2 = −c2n.\n",
    "Next consider the columns between those two — in the n = 3 table this\nincludes only column 2 while in the n = 4 table it includes both columns 2\nand 3.",
    "Each such column has a single one.",
    "That is, for each column index\nj ∈{2 . . .",
    "n",
    "−2} the column consists of only zeros except for a one in row n + j,\nand hence cn+j = 0.\n",
    "On to the next block of columns, from n + 1 through 2n.",
    "Column n + 1 has\nonly two ones (because n ⩾3 the ones in the last two rows do not fall in the ﬁrst\ncolumn of this block).",
    "Thus c2 = −cn+1 and therefore c2 = c2n+1.",
    "Likewise,\nfrom column 2n we conclude that c2 = −c2n and so c2 = c2n+2.\n",
    "Because n ⩾3 there is at least one column between column n + 1 and\ncolumn 2n −1.",
    "In at least one of those columns a one appears in ⃗ρ2n+1.",
    "If a one\nalso appears in that column in ⃗ρ2n+2 then we have c2 = −(c2n+1 +c2n+2) since\n\n312\nChapter Three.",
    "Maps Between Spaces\ncn+j = 0 for j ∈{2 . . .",
    "n −2}.",
    "If a one does not appear in that column in ⃗ρ2n+2\nthen we have c2 = −c2n+1.",
    "In either case c2 = 0, and thus c2n+1 = c2n+2 = 0\nand cn+1 = c2n = 0.\n",
    "If the next block of n-many columns is not the last then similarly conclude\nfrom its ﬁrst column that c3 = cn+1 = 0.\n",
    "Keep this up until we reach the last block of columns, those numbered\n(n −1)n + 1 through n2.",
    "Because cn+1 = · · · = c2n = 0 column n2 gives that\ncn = −c2n+1",
    "= 0.\n",
    "Therefore the rank of the matrix is 2n + 1, as required.\n",
    "The classic source on normal magic squares is [Ball & Coxeter].",
    "More on the\nLo Shu square is at [Wikipedia, Lo Shu Square].",
    "The proof given here began\nwith [Ward].\n",
    "Exercises\n1 Let M be a 3×3 magic square with magic number s.\n(a) Prove that the sum of M’s entries is 3s.\n",
    "(b) Prove that s = 3 · m2,2.\n",
    "(c) Prove that m2,2 is the average of the entries in its row, its column, and in\neach diagonal.\n",
    "(d) Prove that m2,2 is the median of M’s entries.\n",
    "2 Solve the system a+b = s, c+d = s, a+c = s, b+d = s, a+d = s, and b+c = s.\n3 Show that dim M2,0 = 0.\n4 Let the trace function be Tr(M) = m1,1 + · · · + mn,n. Deﬁne also the sum down\nthe other diagonal Tr∗(M) = m1,n + · · · + mn,1.\n(a) Show that the two functions Tr, Tr∗:",
    "Mn×n →R are linear.\n",
    "(b) Show that the function θ: Mn×n →R2 given by θ(M)",
    "= (Tr(M), Tr∗(m)) is\nlinear.\n",
    "(c) Generalize the prior item.\n",
    "5 A square matrix is semimagic if the rows and columns add to the same value,\nthat is, if we drop the condition on the diagonals.\n",
    "(a) Show that the set of semimagic squares Hn is a subspace of Mn×n.\n",
    "(b) Show that the set Hn,0 of n×n semimagic squares with magic number 0 is\nalso a subspace of Mn×n.\n\n",
    "Topic\nMarkov Chains\nHere is a simple game: a player bets on coin tosses, a dollar each time, and the\ngame ends either when the player has no money or is up to ﬁve dollars.",
    "If the\nplayer starts with three dollars, what is the chance that the game takes at least\nﬁve ﬂips?",
    "Twenty-ﬁve ﬂips?\nAt any point, this player has either $0, or $1, . . .",
    ", or $5.",
    "We say that the\nplayer is in the state s0, s1, . .",
    ". , or s5.",
    "In the game the player moves from state\nto state.",
    "For instance, a player now in state s3 has on the next ﬂip a 0.5 chance\nof moving to state s2 and a 0.5 chance of moving to s4.",
    "The boundary states\nare diﬀerent; a player never leaves state s0 or state s5.\n",
    "Let pi(n) be the probability that the player is in state si after n ﬂips.",
    "Then\nfor instance the probability of being in state s0 after ﬂip n + 1 is p0(n + 1) =\np0(n) + 0.5 · p1(n).",
    "This equation summarizes.\n",
    "\n\n\n\n\n\n\n\n\n1.0\n0.5\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.5\n0.0\n0.0\n0.0\n0.0\n0.5\n0.0\n0.5\n0.0\n0.0\n0.0\n0.0\n0.5\n0.0\n0.5\n0.0\n0.0\n0.0\n0.0\n0.5\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.5\n1.0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\np0(n)\np1(n)\np2(n)\np3(n)\np4(n)\np5(n)\n\n\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n\n\np0(n",
    "+ 1)\n",
    "p1(n + 1)\n",
    "p2(n",
    "+ 1)\n",
    "p3(n",
    "+ 1)\np4(n",
    "+ 1)\np5(n",
    "+ 1)\n\n",
    "\n\n\n\n\n\n\n\nSage will compute the evolution of this game.\n",
    "sage: M = matrix(RDF, [[1.0, 0.5, 0.0, 0.0, 0.0, 0.0],\n....:\n",
    "[0.5, 0.0, 0.5, 0.0, 0.0, 0.0],\n....:\n",
    "[0.0, 0.5, 0.0, 0.5, 0.0, 0.0],\n....:\n",
    "[0.0, 0.0, 0.5, 0.0, 0.5, 0.0],\n....:\n",
    "[0.0, 0.0, 0.0, 0.5, 0.0, 0.5],\n....:\n",
    "[0.0, 0.0, 0.0, 0.0, 0.5, 1.0]])\nsage: M = M.transpose()\nsage: v0 = vector(RDF, [0.0, 0.0, 0.0, 1.0, 0.0, 0.0])\nsage: v1 = v0*M\nsage: v1\n(0.0, 0.0, 0.5, 0.0, 0.5, 0.0)\nsage: v2 = v1*M\nsage: v2\n(0.0, 0.25, 0.0, 0.5, 0.0, 0.25)\n\n314\nChapter Three.",
    "Maps Between Spaces\n(Two notes: (1) Sage can use various number systems to make the matrix entries\nand here we have used Real Double Float, and (2) Sage likes to do matrix\nmultiplication from the right, as ⃗vM instead of our usual M⃗v, so we needed to\ntake the matrix’s transpose.)\n",
    "These are components of the resulting vectors.\n",
    "n",
    "= 0\nn = 1\nn = 2\nn = 3\nn = 4\n· · ·\nn = 24\n0\n0\n0\n1\n0\n0\n0\n0\n0.5\n0\n0.5\n0\n0\n0.25\n0\n0.5\n0\n0.25\n0.125\n0\n0.375\n0\n0.25\n0.25\n0.125\n0.187 5\n0\n0.312 5\n0\n0.375\n0.396 00\n0.002 76\n0\n0.004 47\n0\n0.596 76\n",
    "This game is not likely to go on for long since the player quickly moves to an\nending state.",
    "For instance, after the fourth ﬂip there is already a 0.50 probability\nthat the game is over.\n",
    "This is a Markov chain.",
    "Each vector is a probability vector, whose entries\nare nonnegative real numbers that sum to 1.",
    "The matrix is a transition matrix\nor stochastic matrix, whose entries are nonnegative reals and whose columns\nsum to 1.\n",
    "A characteristic feature of a Markov chain model is that it is historyless in\nthat the next state depends only on the current state, not on any prior ones.\n",
    "Thus, a player who arrives at s2 by starting in state s3 and then going to state s2\nhas exactly the same chance of moving next to s3 as does a player whose history\nwas to start in s3 then go to s4 then to s3 and then to s2.\n",
    "Here is a Markov chain from sociology.\n",
    "A study ([Macdonald & Ridge],\np. 202) divided occupations in the United Kingdom into three levels: executives\nand professionals, supervisors and skilled manual workers, and unskilled workers.\n",
    "They asked about two thousand men, “At what level are you, and at what level\nwas your father when you were fourteen years old?”",
    "Here the Markov model\nassumption about history may seem reasonable — we may guess that while a\nparent’s occupation has a direct inﬂuence on the occupation of the child, the\ngrandparent’s occupation likely has no such direct inﬂuence.",
    "This summarizes\nthe study’s conclusions.\n\n\n\n.60\n.29\n.16\n.26\n.37\n.27\n.14\n.34\n.57\n\n\n\n\n\n\npU(n)\npM(n)\npL(n)\n\n\n=\n\n\n\npU(n + 1)\npM(n",
    "+ 1)\npL(n + 1)\n\n",
    "\n\nFor instance, looking at the middle class for the next generation, a child of an\nupper class worker has a 0.26 probability of becoming middle class, a child of\n\nTopic: Markov Chains\n315\na middle class worker has a 0.37 chance of being middle class, and a child of a\nlower class worker has a 0.27 probability of becoming middle class.\n",
    "Sage will compute the successive stages of this system (the current class\ndistribution is ⃗v0).\n",
    "sage: M = matrix(RDF, [[0.60, 0.29, 0.16],\n....:\n",
    "[0.26, 0.37, 0.27],\n....:\n[0.14, 0.34, 0.57]])\nsage: M = M.transpose()\nsage: v0 = vector(RDF, [0.12, 0.32, 0.56])\nsage: v0*M\n(0.2544, 0.3008, 0.4448)\nsage: v0*M^2\n(0.31104, 0.297536, 0.391424)\nsage: v0*M^3\n(0.33553728, 0.2966432, 0.36781952)\n",
    "Here are the next ﬁve generations.",
    "They show upward mobility, especially in\nthe ﬁrst generation.",
    "In particular, lower class shrinks a good bit.\n",
    "n",
    "= 0\nn = 1\nn = 2\nn = 3\nn = 4\nn = 5\n.12\n.32\n.56\n.25\n.30\n.44\n.31\n.30\n.39\n.34\n.30\n.37\n.35\n.30\n.36\n.35\n.30\n.35\nOne more example.",
    "In professional American baseball there are two leagues,\nthe American League and the National League.",
    "At the end of the annual season\nthe team winning the American League and the team winning the National\nLeague play the World Series.",
    "The winner is the ﬁrst team to take four games.\n",
    "That means that a series is in one of twenty-four states: 0-0 (no games won\nyet by either team), 1-0 (one game won for the American League team and no\ngames for the National League team), etc.\nConsider a series with a probability p that the American League team wins\neach game.",
    "We have this.\n\n\n\n\n\n\n\n\n\n\n\n\n0\n0\n0\n0\n. .",
    ".\n",
    "p\n0\n0\n0\n. .",
    ".\n",
    "1 −p\n0\n0\n0\n. .",
    ".\n",
    "0\np\n0\n0\n. . .\n",
    "0\n1 −p\np\n0\n. .",
    ".\n",
    "0\n0\n1 −p\n0\n. .",
    ".\n",
    "...\n...\n...\n...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\np0-0(n)\np1-0(n)\np0-1(n)\np2-0(n)\np1-1(n)\np0-2(n)\n...\n\n\n\n\n\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n\n\n\n\n\np0-0(n + 1)\np1-0(n + 1)\np0-1(n + 1)\np2-0(n + 1)\np1-1(n + 1)\np0-2(n + 1)\n...\n\n\n\n\n\n\n\n\n\n\n\n\nAn especially interesting special case is when the teams are evenly matched,\np = 0.50.",
    "This table below lists the resulting components of the n = 0 through\nn = 7 vectors.\n",
    "Note that evenly-matched teams are likely to have a long series — there is a\nprobability of 0.625 that the series goes at least six games.\n\n",
    "316\nChapter Three.",
    "Maps Between Spaces\nn = 0\nn = 1\nn = 2\nn = 3\nn = 4\nn = 5\nn = 6\nn = 7\n0",
    "−0\n1 −0\n0 −1\n2 −0\n1 −1\n0 −2\n3 −0\n2 −1\n1 −2\n0",
    "−3\n4 −0\n3 −1\n2 −2\n1 −3\n0",
    "−4\n4 −1\n3 −2\n2 −3\n1 −4\n4 −2\n3 −3\n2 −4\n4 −3\n3 −4\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.5\n0.5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.25\n0.5\n0.25\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.125\n0.375\n0.375\n0.125\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.062 5\n0.25\n0.375\n0.25\n0.062 5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.062 5\n0\n0\n0\n0.062 5\n0.125\n0.312 5\n0.312 5\n0.125\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.062 5\n0\n0\n0\n0.062 5\n0.125\n0\n0\n0.125\n0.156 25\n0.312 5\n0.156 25\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.062 5\n0\n0\n0\n0.062 5\n0.125\n0\n0\n0.125\n0.156 25\n0\n0.156 25\n0.156 25\n0.156 25\nMarkov chains are a widely used application of matrix operations.",
    "They\nalso give us an example of the use of matrices where we do not consider the\nsigniﬁcance of the maps represented by the matrices.",
    "For more on Markov chains,\nthere are many sources such as [Kemeny & Snell] and [Iosifescu].\n",
    "Exercises\n1",
    "These questions refer to the coin-ﬂipping game.\n",
    "(a) Check the computations in the table at the end of the ﬁrst paragraph.\n",
    "(b) Consider the second row of the vector table.",
    "Note that this row has alternating\n0’s.\n",
    "Must p1(j) be 0 when j is odd?\n",
    "Prove that it must be, or produce a\ncounterexample.\n",
    "(c) Perform a computational experiment to estimate the chance that the player\nends at ﬁve dollars, starting with one dollar, two dollars, and four dollars.\n",
    "2",
    "[Feller] We consider throws of a die, and say the system is in state si if the largest\nnumber yet appearing on the die was i.\n(a) Give the transition matrix.\n(b) Start the system in state s1, and run it for ﬁve throws.",
    "What is the vector at\nthe end?\n\nTopic:",
    "Markov Chains\n317\n3",
    "[Kelton] There has been much interest in whether industries in the United States\nare moving from the Northeast and North Central regions to the South and West,\nmotivated by the warmer climate, by lower wages, and by less unionization.",
    "Here\nis the transition matrix for large ﬁrms in Electric and Electronic Equipment.\nNE\nNC\nS\nW\nZ\nNE\nNC\nS\nW\nZ\n0.787\n0\n0\n0\n0.021\n0\n0.966\n0.063\n0\n0.009\n0\n0.034\n0.937\n0.074\n0.005\n0.111\n0\n0\n0.612\n0.010\n0.102\n0\n0\n0.314\n0.954\n",
    "For example, a ﬁrm in the Northeast region will be in the West region next\nyear with probability 0.111.",
    "(The Z entry is a “birth-death” state.",
    "For instance,\nwith probability 0.102 a large Electric and Electronic Equipment ﬁrm from the\nNortheast will move out of this system next year: go out of business, move abroad,\nor move to another category of ﬁrm.",
    "There is a 0.021 probability that a ﬁrm in the\nNational Census of Manufacturers will move into Electronics, or be created, or\nmove in from abroad, into the Northeast.",
    "Finally, with probability 0.954 a ﬁrm\nout of the categories will stay out, according to this research.)\n",
    "(a) Does the Markov model assumption of lack of history seem justiﬁed?\n(b) Assume that the initial distribution is even, except that the value at Z is 0.9.\n",
    "Compute the vectors for n = 1 through n = 4.\n(c) Suppose that the initial distribution is this.\n",
    "NE\nNC\nS\nW\nZ\n0.0000\n0.6522\n0.3478\n0.0000\n0.0000\nCalculate the distributions for n = 1 through n = 4.\n(d) Find the distribution for n = 50 and n = 51.",
    "Has the system settled down to\nan equilibrium?\n4",
    "[Wickens] Here is a model of some kinds of learning The learner starts in an\nundecided state sU. Eventually the learner has to decide to do either response A\n(that is, end in state sA) or response B (ending in sB).",
    "However, the learner doesn’t\njump right from undecided to sure that A is the correct thing to do (or B).",
    "Instead,\nthe learner spends some time in a “tentative-A” state, or a “tentative-B” state,\ntrying the response out (denoted here tA and tB).",
    "Imagine that once the learner has\ndecided, it is ﬁnal, so once in sA or sB, the learner stays there.",
    "For the other state\nchanges, we can posit transitions with probability p in either direction.\n",
    "(a) Construct the transition matrix.\n",
    "(b) Take p = 0.25 and take the initial vector to be 1 at sU. Run this for ﬁve steps.\n",
    "What is the chance of ending up at sA?\n(c) Do the same for p = 0.20.\n",
    "(d) Graph p versus the chance of ending at sA. Is there a threshold value for p,\nabove which the learner is almost sure not to take longer than ﬁve steps?\n5",
    "A certain town is in a certain country (this is a hypothetical problem).",
    "Each year\nten percent of the town dwellers move to other parts of the country.",
    "Each year one\npercent of the people from elsewhere move to the town.",
    "Assume that there are two\n\n318\nChapter Three.",
    "Maps Between Spaces\nstates sT, living in town, and sC, living elsewhere.\n",
    "(a) Construct the transition matrix.\n",
    "(b) Starting with an initial distribution sT = 0.3 and sC = 0.7, get the results for\nthe ﬁrst ten years.\n",
    "(c) Do the same for sT = 0.2.\n(d) Are the two outcomes alike or diﬀerent?\n6 For the World Series application, use a computer to generate the seven vectors for\np = 0.55 and p = 0.6.\n(a) What is the chance of the National League team winning it all, even though\nthey have only a probability of 0.45 or 0.40 of winning any one game?\n(b) Graph the probability p against the chance that the American League team\nwins it all.",
    "Is there a threshold value — a p above which the better team is\nessentially ensured of winning?\n7",
    "Above we deﬁne a transition matrix to have each entry nonnegative and each\ncolumn sum to 1.\n(a) Check that the three transition matrices shown in this Topic meet these two\nconditions.",
    "Must any transition matrix do so?\n(b) Observe that if A⃗v0 = ⃗v1 and A⃗v1 = ⃗v2 then A2 is a transition matrix from\n⃗v0 to ⃗v2.",
    "Show that a power of a transition matrix is also a transition matrix.\n",
    "(c) Generalize the prior item by proving that the product of two appropriately-\nsized transition matrices is a transition matrix.\n\n",
    "Topic\nOrthonormal Matrices\nIn The Elements, Euclid considers two ﬁgures to be the same if they have the\nsame size and shape.",
    "That is, while the triangles below are not equal because\nthey are not the same set of points, they are, for Euclid’s purposes, essentially\nindistinguishable because we can imagine picking the plane up, sliding it over\nand rotating it a bit, although not warping or stretching it, and then putting it\nback down, to superimpose the ﬁrst ﬁgure on the second.",
    "(Euclid never explicitly\nstates this principle but he uses it often",
    "[Casey].)\n",
    "P1\nP2\nP3\nQ1\nQ2\nQ3\nIn modern terms “picking the plane up . . . ”",
    "is taking a map from the plane to\nitself.",
    "Euclid considers only transformations that may slide or turn the plane but\nnot bend or stretch it.",
    "Accordingly, deﬁne a map f: R2 →R2 to be distance-\npreserving or a rigid motion or an isometry if for all points P1, P2 ∈R2, the\ndistance from f(P1) to f(P2) equals the distance from P1 to P2.",
    "We also deﬁne a\nplane ﬁgure to be a set of points in the plane and we say that two ﬁgures are\ncongruent if there is a distance-preserving map from the plane to itself that\ncarries one ﬁgure onto the other.\n",
    "Many statements from Euclidean geometry follow easily from these deﬁnitions.\n",
    "Some are: (i) collinearity is invariant under any distance-preserving map (that is,\nif P1, P2, and P3 are collinear then so are f(P1), f(P2), and f(P3)), (ii) betweeness\nis invariant under any distance-preserving map (if P2 is between P1 and P3 then\nso is f(P2) between f(P1) and f(P3)), (iii) the property of being a triangle is\ninvariant under any distance-preserving map (if a ﬁgure is a triangle then the\nimage of that ﬁgure is also a triangle), (iv) and the property of being a circle is\ninvariant under any distance-preserving map.",
    "In 1872, F. Klein suggested that\nwe can deﬁne Euclidean geometry as the study of properties that are invariant\n\n320\nChapter Three.",
    "Maps Between Spaces\nunder these maps.",
    "(This forms part of Klein’s Erlanger Program, which proposes\nthe organizing principle that we can describe each kind of geometry — Euclidean,\nprojective, etc. — as the study of the properties that are invariant under some\ngroup of transformations.",
    "The word ‘group’ here means more than just ‘collection’\nbut that lies outside of our scope.)\n",
    "We can use linear algebra to characterize the distance-preserving maps of\nthe plane.\n",
    "To begin, observe that there are distance-preserving transformations of the\nplane that are not linear.",
    "The obvious example is this translation.\n \n",
    "x\ny\n!\n7→\n \nx\ny\n!\n",
    "+\n \n1\n0\n!\n=\n \nx + 1\ny\n!\n",
    "However, this example turns out to be the only one, in that if f is distance-\npreserving and sends ⃗0 to ⃗v0 then the map ⃗v 7→f(⃗v)",
    "−⃗v0 is linear.",
    "That will\nfollow immediately from this statement: a map t that is distance-preserving\nand sends ⃗0 to itself is linear.",
    "To prove this equivalent statement, consider the\nstandard basis and suppose that\nt(⃗e1)",
    "=\n \na\nb\n!\nt(⃗e2)",
    "=\n \nc\nd\n!\n",
    "for some a, b, c, d ∈R.",
    "To show that t is linear we can show that it can be\nrepresented by a matrix, that is, that t acts in this way for all x, y ∈R.\n⃗v =\n \nx\ny\n!\nt\n7−→\n \nax + cy\nbx + dy\n!\n(∗)\nRecall that if we ﬁx three non-collinear points then we can determine any point\nby giving its distance from those three.",
    "So we can determine any point ⃗v in the\ndomain by its distance from ⃗0, ⃗e1, and ⃗e2.",
    "Similarly, we can determine any point\nt(⃗v) in the codomain by its distance from the three ﬁxed points t(⃗0), t(⃗e1), and\nt(⃗e2) (these three are not collinear because, as mentioned above, collinearity is\ninvariant and ⃗0, ⃗e1, and ⃗e2 are not collinear).",
    "Because t is distance-preserving\nwe can say more: for the point ⃗v in the plane that is determined by being the\ndistance d0 from ⃗0, the distance d1 from ⃗e1, and the distance d2 from ⃗e2, its\nimage t(⃗v) must be the unique point in the codomain that is determined by\nbeing d0 from t(⃗0), d1 from t(⃗e1), and d2 from t(⃗e2).",
    "Because of the uniqueness,\nchecking that the action in (∗) works in the d0, d1, and d2 cases\ndist(\n \nx\ny\n!\n,⃗0) = dist(t(\n \nx\ny\n!\n), t(⃗0))",
    "= dist(\n \nax + cy\nbx + dy\n!\n,⃗0)\n\n",
    "Topic: Orthonormal Matrices\n321\n(we assumed that t maps ⃗0 to itself)\ndist(\n \nx\ny\n!\n,⃗e1)",
    "= dist(t(\n \nx\ny\n!\n), t(⃗e1))",
    "= dist(\n \nax + cy\nbx + dy\n!\n,\n \na\nb\n!\n)\nand\ndist(\n \nx\ny\n!\n,⃗e2) = dist(t(\n \nx\ny\n!\n), t(⃗e2))",
    "= dist(\n \nax + cy\nbx + dy\n!\n,\n \nc\nd\n!\n)\nsuﬃces to show that (∗) describes t.",
    "Those checks are routine.\n",
    "Thus any distance-preserving f: R2 →R2 is a linear map plus a translation,\nf(⃗v) = t(⃗v)",
    "+⃗v0 for some constant vector ⃗v0 and linear map t that is distance-\npreserving.",
    "So in order to understand distance-preserving maps what remains is\nto understand distance-preserving linear maps.\n",
    "Not every linear map is distance-preserving.",
    "For example ⃗v 7→2⃗v does not\npreserve distances.\n",
    "But there is a neat characterization: a linear transformation t of the plane\nis distance-preserving",
    "if and only if both ∥t(⃗e1)∥= ∥t(⃗e2)∥= 1, and t(⃗e1) is\northogonal to t(⃗e2).",
    "The ‘only if’ half of that statement is easy — because t\nis distance-preserving it must preserve the lengths of vectors and because t\nis distance-preserving the Pythagorean theorem shows that it must preserve\northogonality.",
    "To show the ‘if’ half we can check that the map preserves lengths\nof vectors because then for all ⃗p and ⃗q the distance between the two is preserved\n∥t(⃗p −⃗q )∥= ∥t(⃗p) −t(⃗q )",
    "∥= ∥⃗p −⃗q ∥.",
    "For that check let\n⃗v =\n \nx\ny\n!\nt(⃗e1)",
    "=\n \na\nb\n!\nt(⃗e2)",
    "=\n \nc\nd\n!\n",
    "and with the ‘if’ assumptions that a2 + b2 = c2 + d2 = 1 and ac + bd = 0",
    "we\nhave this.\n∥t(⃗v )∥2",
    "= (ax + cy)2 + (bx + dy)2\n= a2x2",
    "+ 2acxy + c2y2 + b2x2",
    "+ 2bdxy +",
    "d2y2\n= x2(a2 + b2)",
    "+ y2(c2 + d2)",
    "+",
    "2xy(ac + bd)\n= x2 + y2\n= ∥⃗v ∥2\n",
    "One thing that is neat about this characterization is that we can easily\nrecognize matrices that represent such a map with respect to the standard\nbases: the columns are of length one and are mutually orthogonal.",
    "This is an\northonormal matrix (or, more informally, orthogonal matrix since people\n\n322\nChapter Three.",
    "Maps Between Spaces\noften use this term to mean not just that the columns are orthogonal but also\nthat they have length one).\n",
    "We can leverage this characterization to understand the geometric actions\nof distance-preserving maps.",
    "Because ∥t(⃗v )∥=",
    "∥⃗v ∥, the map t sends any ⃗v\nsomewhere on the circle about the origin that has radius equal to the length of\n⃗v.",
    "In particular, ⃗e1 and ⃗e2 map to the unit circle.",
    "What’s more, once we ﬁx the\nunit vector ⃗e1 as mapped to the vector with components a and b then there\nare only two places where ⃗e2 can go if its image is to be perpendicular to the\nﬁrst vector’s image: it can map either to one where ⃗e2 maintains its position a\nquarter circle clockwise from ⃗e1\n\u0012a\nb\n\u0013\n\u0012−b\na\n\u0013\nRepE2,E2(t)",
    "=\n \na\n−b\nb\na\n!\nor to one where it goes a quarter circle counterclockwise.\n",
    "\u0012a\nb\n\u0013\n\u0012 b\n−a\n\u0013\nRepE2,E2(t)",
    "=\n \na\nb\nb\n−a\n!\n",
    "The geometric description of these two cases is easy.",
    "Let θ be the counter-\nclockwise angle between the x-axis and the image of ⃗e1.",
    "The ﬁrst matrix above\nrepresents, with respect to the standard bases, a rotation of the plane by θ\nradians.\n",
    "\u0012a\nb\n\u0013\n\u0012−b\na\n\u0013\n \nx\ny\n!\n",
    "t\n7−→\n \nx cos θ −y sin θ\nx sin θ",
    "+ y",
    "cos θ\n!\n",
    "The second matrix above represents a reﬂection of the plane through the line\nbisecting the angle between ⃗e1 and t(⃗e1).\n\n",
    "Topic: Orthonormal Matrices\n323\n\u0012a\nb\n\u0013\n\u0012 b\n−a\n\u0013\n \nx\ny\n!\nt\n7−→\n \nx cos θ + y sin θ\nx sin θ −y cos θ\n!\n",
    "(This picture shows ⃗e1 reﬂected up into the ﬁrst quadrant and ⃗e2 reﬂected down\ninto the fourth quadrant.)\n",
    "Note: in the domain the angle between ⃗e1 and ⃗e2 runs counterclockwise, and\nin the ﬁrst map above the angle from t(⃗e1) to t(⃗e2) is also counterclockwise,\nso it preserves the orientation of the angle.",
    "But the second map reverses the\norientation.",
    "A distance-preserving map is direct if it preserves orientations and\nopposite if it reverses orientation.\n",
    "With that, we have characterized the Euclidean study of congruence.",
    "It\nconsiders, for plane ﬁgures, the properties that are invariant under combinations\nof (i) a rotation followed by a translation, or (ii) a reﬂection followed by a\ntranslation (a reﬂection followed by a non-trivial translation is a glide reﬂection).\n",
    "Another idea encountered in elementary geometry, besides congruence of\nﬁgures, is that ﬁgures are similar if they are congruent after a change of scale.\n",
    "The two triangles below are similar since the second is the same shape as the\nﬁrst but 3/2-ths the size.\n",
    "P1\nP2\nP3\nQ1\nQ2\nQ3\nFrom the above work we have that ﬁgures are similar if there is an orthonormal\nmatrix T such that the points ⃗q on one ﬁgure are the images of the points ⃗p on\nthe other ﬁgure by ⃗q = (kT)⃗v +⃗p0 for some nonzero real number k and constant\nvector ⃗p0.\n",
    "Although these ideas are from Euclid, mathematics is timeless and they are\nstill in use today.",
    "One application of the maps studied above is in computer\ngraphics.",
    "We can, for example, animate this top view of a cube by putting\ntogether ﬁlm frames of it rotating; that’s a rigid motion.\n",
    "Frame 1\nFrame 2\nFrame 3\n\n324\nChapter Three.",
    "Maps Between Spaces\nWe could also make the cube appear to be moving away from us by producing\nﬁlm frames of it shrinking, which gives us ﬁgures that are similar.\n",
    "Frame 1:\nFrame 2:\nFrame 3:\nComputer graphics incorporates techniques from linear algebra in many other\nways (see Exercise 4).\n",
    "A beautiful book that explores some of this area is [Weyl].",
    "More on groups,\nof transformations and otherwise, is in any book on Modern Algebra, for instance\n[Birkhoﬀ& MacLane].",
    "More on Klein and the Erlanger Program is in [Yaglom].\n",
    "Exercises\n1 Decide if each of these is an orthonormal matrix.\n(a)\n\u0012 1/\n√\n2\n−1/\n√\n2\n−1/\n√\n2\n−1/\n√\n2\n\u0013\n(b)\n",
    "\u0012 1/\n√\n3\n−1/\n√\n3\n−1/\n√\n3\n−1/\n√\n3\n\u0013\n(c)\n\u0012 1/\n√\n3\n−\n√\n2/\n√\n3\n−\n√\n2/\n√\n3\n−1/\n√\n3\n\u0013\n2 Write down the formula for each of these distance-preserving maps.\n",
    "(a) the map that rotates π/6 radians, and then translates by ⃗e2\n(b) the map that reﬂects about the line y = 2x\n(c) the map that reﬂects about y = −2x and translates over 1 and up 1\n3\n(a) The proof that a map that is distance-preserving and sends the zero vector\nto itself incidentally shows that such a map is one-to-one and onto (the point\nin the domain determined by d0, d1, and d2 corresponds to the point in the\ncodomain determined by those three).",
    "Therefore any distance-preserving map\nhas an inverse.",
    "Show that the inverse is also distance-preserving.\n",
    "(b) Prove that congruence is an equivalence relation between plane ﬁgures.\n",
    "4",
    "In practice the matrix for the distance-preserving linear transformation and the\ntranslation are often combined into one.",
    "Check that these two computations yield\nthe same ﬁrst two components.\n",
    "\u0012a\nc\nb\nd\n\u0013 \u0012x\ny\n\u0013\n+\n\u0012e\nf\n\u0013\n\n\na\nc\ne\nb\nd\nf\n0\n0\n1\n\n\n\n\nx\ny\n1\n\n\n(These are homogeneous coordinates; see the Topic on Projective Geometry).\n",
    "5\n(a) Verify that the properties described in the second paragraph of this Topic as\ninvariant under distance-preserving maps are indeed so.\n(b) Give two more properties that are of interest in Euclidean geometry from\nyour experience in studying that subject that are also invariant under distance-\npreserving maps.\n",
    "(c) Give a property that is not of interest in Euclidean geometry and is not\ninvariant under distance-preserving maps.\n\n",
    "Chapter Four\nDeterminants\nIn the ﬁrst chapter we highlighted the special case of linear systems with the\nsame number of equations as unknowns, those of the form T⃗x = ⃗b where T is a\nsquare matrix.",
    "We noted that there are only two kinds of T’s.",
    "If T is associated\nwith a unique solution for any ⃗b, such as for the homogeneous system T⃗x = ⃗0,\nthen T is associated with a unique solution for every such ⃗b.",
    "We call such a\nmatrix nonsingular.",
    "The other kind of T, where every linear system for which it\nis the matrix of coeﬃcients has either no solution or inﬁnitely many solutions,\nwe call singular.\n",
    "In our work since then this distinction has been a theme.",
    "For instance, we\nnow know that an n×n matrix T is nonsingular if and only if each of these holds:\n• any system T⃗x = ⃗b has a solution and that solution is unique;\n• Gauss-Jordan reduction of T yields an identity matrix;\n• the rows of T form a linearly independent set;\n• the columns of T form a linearly independent set, a basis for Rn;\n• any map that T represents is an isomorphism;\n• an inverse matrix T −1 exists.\n",
    "So when we look at a square matrix, one of the ﬁrst things that we ask is whether\nit is nonsingular.\n",
    "This chapter develops a formula that determines whether T is nonsingular.\n",
    "More precisely, we will develop a formula for 1×1 matrices, one for 2×2 matrices,\netc.",
    "These are naturally related; that is, we will develop a family of formulas, a\nscheme that describes the formula for each size.\n",
    "Since we will restrict the discussion to square matrices, in this chapter we\nwill often simply say ‘matrix’ in place of ‘square matrix’.\n\n",
    "326\nChapter Four.",
    "Determinants\nI\nDefinition\nDetermining nonsingularity is trivial for 1×1 matrices.\n",
    "\u0010\na\n\u0011\nis nonsingular iﬀ\na ̸= 0\nCorollary Three.",
    "IV.4.11 gives the 2×2 formula.\n \n",
    "a\nb\nc\nd\n!\n",
    "is nonsingular iﬀ\nad −bc ̸= 0\nWe can produce the 3×3 formula as we did the prior one, although the compu-\ntation is intricate (see Exercise 10).\n",
    "\n\n\na\nb\nc\nd\ne\nf\ng\nh\ni\n\n\n\nis nonsingular iﬀ\naei + bfg + cdh −hfa −idb −gec ̸= 0\n",
    "With these cases in mind, we posit a family of formulas: a, ad−bc, etc.",
    "For each\nn the formula deﬁnes a determinant function detn×n : Mn×n →R such that an\nn×n matrix T is nonsingular if and only if detn×n(T) ̸= 0.",
    "(We usually omit\nthe subscript n×n because the size of T describes which determinant function\nwe mean.)\n",
    "I.1\nExploration\nThis subsection is an optional motivation and development of the general\ndeﬁnition.",
    "The deﬁnition is in the next subsection.\n",
    "Above, in each case the matrix is nonsingular if and only if some formula is\nnonzero.",
    "But the three formulas don’t show an obvious pattern.",
    "We may spot\nthat the 1×1 term a has one letter, that the 2×2 terms ad and bc have two\nletters, and that the 3×3 terms each have three letters.",
    "We may even spot that\nin those terms there is a letter from each row and column of the matrix, e.g., in\nthe cdh term one letter comes from each row and from each column.\n",
    "\n\n\nc\nd\nh\n\n\n\n",
    "But these observations are perhaps more puzzling than enlightening.",
    "For instance,\nwe might wonder why some terms are added but some are subtracted.\n\n",
    "Section I. Definition\n327\nA good strategy for solving problems is to explore which properties the\nsolution must have, and then search for something with those properties.",
    "So we\nshall start by asking what properties we’d like the determinant formulas to have.\n",
    "At this point, our main way to decide whether a matrix is singular or not is\nto do Gaussian reduction and then check whether the diagonal of the echelon\nform matrix has any zeroes, that is, whether the product down the diagonal\nis zero.",
    "So we could guess that whatever determinant formula we ﬁnd, the proof\nthat it is right may involve applying Gauss’s Method to the matrix to show that\nin the end the product down the diagonal is zero if and only if our formula gives\nzero.\n",
    "This suggests a plan: we will look for a family of determinant formulas that\nare unaﬀected by row operations and such that the determinant of an echelon\nform matrix is the product of its diagonal entries.",
    "In the rest of this subsection\nwe will test this plan against the 2×2 and 3×3 formulas.",
    "In the end we will\nhave to modify the “unaﬀected by row operations” part, but not by much.\n",
    "First we check whether the 2×2 and 3×3 formulas are unaﬀected by the row\noperation of combining: if\nT\nkρi+ρj\n−→\nˆT\nthen is det(ˆT)",
    "= det(T)?",
    "This check of the 2×2 determinant after the kρ1 + ρ2\noperation\ndet(\n \na\nb\nka + c\nkb + d\n!\n)",
    "= a(kb + d) −(ka + c)b = ad −bc\nshows that it is indeed unchanged, and the other 2×2 combination kρ2 +ρ1 gives\nthe same result.",
    "Likewise, the 3×3 combination kρ3 + ρ2 leaves the determinant\nunchanged\ndet(\n\n\n\na\nb\nc\nkg + d\nkh + e\nki",
    "+ f\ng\nh\ni\n\n",
    "\n)",
    "= a(kh + e)i + b(ki + f)g + c(kg + d)h\n−h(ki + f)a −i(kg + d)b −g(kh",
    "+ e)c\n= aei + bfg + cdh −hfa −idb −gec\nas do the other 3×3 row combination operations.\n",
    "So there seems to be promise in the plan.",
    "Of course, perhaps if we had\nworked out the 4×4 determinant formula and tested it then we might have found\nthat it is aﬀected by row combinations.",
    "This is an exploration and we do not\nyet have all the facts.",
    "Nonetheless, so far, so good.\n",
    "Next we compare det(ˆT) with det(T) for row swaps.",
    "Here we hit a snag: the\n\n328\nChapter Four.",
    "Determinants\n2×2 row swap ρ1 ↔ρ2 does not yield ad −bc.\ndet(\n \nc\nd\na\nb\n!\n)",
    "= bc −ad\nAnd this ρ1 ↔ρ3 swap inside of a 3×3 matrix\ndet(\n\n\n\ng\nh\ni\nd\ne\nf\na\nb\nc\n\n\n) = gec + hfa + idb −bfg −cdh −aei\nalso does not give the same determinant as before the swap since again there is\na sign change.",
    "Trying a diﬀerent 3×3 swap ρ1 ↔ρ2\ndet(\n\n\n\nd\ne\nf\na\nb\nc\ng\nh\ni\n\n\n) = dbi + ecg + fah −hcd −iae −gbf\nalso gives a change of sign.\n",
    "So row swaps appear in this experiment to change the sign of a determinant.\n",
    "This does not wreck our plan entirely.",
    "We hope to decide nonsingularity by\nconsidering only whether the formula gives zero, not by considering its sign.\n",
    "Therefore, instead of expecting determinant formulas to be entirely unaﬀected\nby row operations we modify our plan so that on a swap they will change sign.\n",
    "Obviously we ﬁnish by comparing det(ˆT) with det(T) for the operation of\nmultiplying a row by a scalar.",
    "This\ndet(\n \na\nb\nkc\nkd\n!\n)",
    "= a(kd) −(kc)b",
    "= k · (ad −bc)\nends with the entire determinant multiplied by k, and the other 2×2 case has\nthe same result.",
    "This 3×3 case ends the same way\ndet(\n\n\n\na\nb\nc\nd\ne\nf\nkg\nkh\nki\n\n\n) = ae(ki) + bf(kg) + cd(kh)\n−(kh)fa −(ki)db −(kg)ec\n= k · (aei + bfg + cdh −hfa −idb −gec)\nas do the other two 3×3 cases.",
    "These make us suspect that multiplying a row\nby k multiplies the determinant by k.",
    "As before, this modiﬁes our plan but does\nnot wreck it.",
    "We are asking only that the zero-ness of the determinant formula\nbe unchanged, not focusing on the its sign or magnitude.\n",
    "So in this exploration our plan got modiﬁed in some inessential ways and is\nnow: we will look for n×n determinant functions that remain unchanged under\n\nSection I. Definition\n329\nthe operation of row combination, that change sign on a row swap, that rescale\non the rescaling of a row, and such that the determinant of an echelon form\nmatrix is the product down the diagonal.",
    "In the next two subsections we will\nsee that for each n there is one and only one such function.\n",
    "Finally, for the next subsection note that factoring out scalars is a row-wise\noperation: here\ndet(\n\n\n\n3\n3\n9\n2\n1\n1\n5\n11\n−5\n\n\n) = 3 · det(\n\n\n\n1\n1\n3\n2\n1\n1\n5\n11\n−5\n\n\n)\n",
    "the 3 comes only out of the top row only, leaving the other rows unchanged.\n",
    "Consequently in the deﬁnition of determinant we will write it as a function of\nthe rows det(⃗ρ1,⃗ρ2, . .",
    ".⃗ρn), rather than as det(T) or as a function of the entries\ndet(t1,1, . .",
    ".",
    ", tn,n).\n",
    "Exercises\n✓1.1 Evaluate the determinant of each.\n(a)\n\u0012 3\n1\n−1\n1\n\u0013\n(b)\n\n\n2\n0\n1\n3\n1\n1\n−1\n0\n1\n\n\n(c)\n\n\n4\n0\n1\n0\n0\n1\n1\n3\n−1\n\n\n1.2 Evaluate the determinant of each.\n",
    "(a)\n\u0012 2\n0\n−1\n3\n\u0013\n(b)\n\n\n2\n1\n1\n0\n5\n−2\n1\n−3\n4\n\n\n(c)\n\n\n2\n3\n4\n5\n6\n7\n8\n9\n1\n\n\n✓1.3 Verify that the determinant of an upper-triangular 3×3 matrix is the product\ndown the diagonal.\n",
    "det(\n\n\na\nb\nc\n0\ne\nf\n0\n0\ni\n\n) = aei\nDo lower-triangular matrices work the same way?\n",
    "✓1.4 Use the determinant to decide if each is singular or nonsingular.\n",
    "(a)\n\u00122\n1\n3\n1\n\u0013\n(b)\n\u00120\n1\n1\n−1\n\u0013\n(c)\n\u00124\n2\n2\n1\n\u0013\n1.5 Singular or nonsingular?",
    "Use the determinant to decide.\n",
    "(a)\n\n\n2\n1\n1\n3\n2\n2\n0\n1\n4\n\n\n(b)\n\n\n1\n0\n1\n2\n1\n1\n4\n1\n3\n\n\n(c)\n\n\n2\n1\n0\n3\n−2\n0\n1\n0\n0\n\n\n✓1.6 Each pair of matrices diﬀer by one row operation.",
    "Use this operation to compare\ndet(A) with det(B).\n",
    "(a)",
    "A =\n\u00121\n2\n2\n3\n\u0013\n, B =\n\u00121\n2\n0\n−1\n\u0013\n(b) A =\n\n\n3\n1\n0\n0\n0\n1\n0\n1\n2\n\n, B =\n\n\n3\n1\n0\n0\n1\n2\n0\n0\n1\n\n\n\n330\nChapter Four.",
    "Determinants\n(c) A =\n\n\n1\n−1\n3\n2\n2\n−6\n1\n0\n4\n\n, B =\n\n\n1\n−1\n3\n1\n1\n−3\n1\n0\n4\n\n\n✓1.7 Find the determinant of this 4×4 matrix by following the plan: perform Gauss’s\nMethod and look for the determinant to remain unchanged on a row combination,\nto change sign on a row swap, to rescale on the rescaling of a row, and such that\nthe determinant of the echelon form matrix is the product down its diagonal.\n",
    "\n\n\n\n1\n2\n0\n2\n2\n4\n1\n0\n0\n0\n−1\n3\n3\n−1\n1\n4\n\n\n\n\n1.8 Show this.\n",
    "det(\n\n\n1\n1\n1\na\nb\nc\na2\nb2\nc2\n\n)",
    "= (b −a)(c −a)(c −b)\n✓1.9 Which real numbers x make this matrix singular?\n",
    "\u001212 −x\n4\n8\n8 −x\n\u0013\n1.10 Do the Gaussian reduction to check the formula for 3×3 matrices stated in the\npreamble to this section.\n",
    "\n\na\nb\nc\nd\ne\nf\ng\nh\ni\n\nis nonsingular iﬀaei + bfg + cdh −hfa −idb −gec ̸= 0\n1.11 Show that the equation of a line in R2 through (x1, y1) and (x2, y2) is given by\nthis determinant.\n",
    "det(\n\n\nx\ny\n1\nx1\ny1\n1\nx2\ny2\n1\n\n)",
    "= 0\nx1 ̸= x2\n1.12 Many people have learned this mnemonic for the determinant of a 3×3 ma-\ntrix: copy the ﬁrst two columns to the right side of the matrix, then take the\nproducts down the forward diagonals and add them together, and then take the\nproducts on the backward diagonals and subtract them.",
    "That is, ﬁrst write\n\n\nh1,1\nh1,2\nh1,3\nh1,1\nh1,2\nh2,1\nh2,2\nh2,3\nh2,1\nh2,2\nh3,1\nh3,2\nh3,3\nh3,1\nh3,2\n\n\nand then calculate this.\n",
    "h1,1h2,2h3,3",
    "+ h1,2h2,3h3,1 + h1,3h2,1h3,2\n−h3,1h2,2h1,3 −h3,2h2,3h1,1",
    "−h3,3h2,1h1,2\n(a) Check that this agrees with the formula given in the preamble to this section.\n",
    "(b) Does it extend to other-sized determinants?\n1.13",
    "The cross product of the vectors\n⃗x =\n\n\nx1\nx2\nx3\n\n\n⃗y =\n\n\ny1\ny2\ny3\n\n\n\nSection I. Definition\n331\nis the vector computed as this determinant.\n",
    "⃗x × ⃗y = det(\n\n\n⃗e1\n⃗e2\n⃗e3\nx1\nx2\nx3\ny1\ny2\ny3\n\n)\nNote that the ﬁrst row’s entries are vectors, the vectors from the standard basis for\nR3.",
    "Show that the cross product of two vectors is perpendicular to each vector.\n",
    "1.14 Prove that each statement holds for 2×2 matrices.\n",
    "(a) The determinant of a product is the product of the determinants det(ST) =\ndet(S) · det(T).\n",
    "(b) If T is invertible then the determinant of the inverse is the inverse of the\ndeterminant det(T −1)",
    "= ( det(T) )−1.\n",
    "Matrices T and T ′ are similar if there is a nonsingular matrix P such that T ′ = PTP−1.\n",
    "(We shall look at this relationship in Chapter Five.)",
    "Show that similar 2×2 matrices\nhave the same determinant.\n",
    "✓1.15 Prove that the area of this region in the plane\n\u0012\n",
    "x1\ny1\n\u0013\n\u0012\nx2\ny2\n\u0013\nis equal to the value of this determinant.\n",
    "det(\n\u0012x1\nx2\ny1\ny2\n\u0013\n)\nCompare with this.\n",
    "det(\n\u0012x2\nx1\ny2\ny1\n\u0013\n)\n",
    "1.16 Prove that for 2×2 matrices, the determinant of a matrix equals the determinant\nof its transpose.",
    "Does that also hold for 3×3 matrices?\n1.17 Is the determinant function linear — is det(x · T + y · S) = x · det(T) + y · det(S)?\n1.18 Show that if A is 3×3 then det(c · A) = c3 · det(A) for any scalar c.\n1.19",
    "Which real numbers θ make \u0012cos θ\n−sin θ\nsin θ\ncos θ\n\u0013\nsingular?",
    "Explain geometrically.\n?",
    "1.20",
    "[Am.",
    "Math.",
    "Mon., Apr. 1955]",
    "If a third order determinant has elements 1, 2,\n. .",
    ".",
    ", 9, what is the maximum value it may have?\nI.2\nProperties of Determinants\nWe want a formula to determine whether an n×n matrix is nonsingular.",
    "We will\nnot begin by stating such a formula.",
    "Instead we will begin by considering, for\n\n332\nChapter Four.",
    "Determinants\neach n, the function that such a formula calculates.",
    "We will deﬁne this function\nby a list of properties.",
    "We will then prove that a function with these properties\nexists and is unique, and also describe how to compute it.",
    "(Because we will\neventually prove this, from the start we will just say ‘det(T)’ instead of ‘if there\nis a unique determinant function then det(T)’.)\n",
    "2.1 Deﬁnition A n×n determinant is a function det: Mn×n →R such that\n(1) det(⃗ρ1, . . .",
    ", k · ⃗ρi + ⃗ρj, . . .",
    ",⃗ρn) = det(⃗ρ1, . . .",
    ",⃗ρj, . . . ,⃗ρn) for i ̸= j\n(2) det(⃗ρ1, . . .",
    ",⃗ρj, . . . ,⃗ρi, . . .",
    ",⃗ρn) = −det(⃗ρ1, . . .",
    ",⃗ρi, . . .",
    ",⃗ρj, . . . ,⃗ρn) for i ̸= j\n(3) det(⃗ρ1, . . . , k⃗ρi, . . .",
    ",⃗ρn) = k · det(⃗ρ1, . . .",
    ",⃗ρi, . . .",
    ",⃗ρn) for any scalar k\n(4) det(I) = 1 where I is an identity matrix\n(the ⃗ρ ’s are the rows of the matrix).",
    "We often write |T| for det(T).\n",
    "2.2 Remark Condition (2) is redundant since\nT\nρi+ρj\n−→\n−ρj+ρi\n−→\nρi+ρj\n−→\n−ρi\n−→\nˆT\nswaps rows i and j.",
    "We have listed it for consistency with the Gauss’s Method\npresentation in earlier chapters.\n",
    "2.3 Remark Condition (3) does not have a k ̸= 0 restriction, although the Gauss’s\nMethod operation of multiplying a row by k does have it.",
    "The next result shows\nthat we do not need that restriction here.\n",
    "2.4 Lemma A matrix with two identical rows has a determinant of zero.",
    "A matrix\nwith a zero row has a determinant of zero.",
    "A matrix is nonsingular if and only\nif its determinant is nonzero.",
    "The determinant of an echelon form matrix is the\nproduct down its diagonal.\n",
    "Proof To verify the ﬁrst sentence swap the two equal rows.",
    "The sign of the\ndeterminant changes but the matrix is the same and so its determinant is the\nsame.",
    "Thus the determinant is zero.\n",
    "For the second sentence multiply the zero row by two.",
    "That doubles the de-\nterminant but it also leaves the row unchanged, and hence leaves the determinant\nunchanged.",
    "Thus the determinant must be zero.\n",
    "Do Gauss-Jordan reduction for the third sentence, T →· · · →ˆT. By the ﬁrst\nthree properties the determinant of T is zero if and only if the determinant of ˆT is\nzero (although the two could diﬀer in sign or magnitude).",
    "A nonsingular matrix\nT Gauss-Jordan reduces to an identity matrix and so has a nonzero determinant.\n\n",
    "Section I. Definition\n333\nA singular T reduces to a ˆT with a zero row; by the second sentence of this\nlemma its determinant is zero.\n",
    "The fourth sentence has two cases.",
    "If the echelon form matrix is singular\nthen it has a zero row.",
    "Thus it has a zero on its diagonal and the product down\nits diagonal is zero.",
    "By the third sentence of this result the determinant is zero\nand therefore this matrix’s determinant equals the product down its diagonal.\n",
    "If the echelon form matrix is nonsingular then none of its diagonal entries is\nzero.",
    "This means that we can divide by those entries and use condition (3) to\nget 1’s on the diagonal.\n\f\f\f\f\f\f\f\f\f\f\n",
    "t1,1\nt1,2\nt1,n\n0\nt2,2\nt2,n\n...\n0\ntn,n\n\f\f\f\f\f\f\f\f\f\f\n= t1,1 · t2,2 · · · tn,n ·\n\f\f\f\f\f\f\f\f\f\f\n1\nt1,2/t1,1\nt1,n/t1,1\n0\n1\nt2,n/t2,2\n...\n0\n1\n\f\f\f\f\f\f\f\f\f\f\nThen the Jordan half of Gauss-Jordan elimination leaves the identity matrix.\n",
    "= t1,1 · t2,2 · · · tn,n ·\n\f\f\f\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n...\n0\n1\n\f\f\f\f\f\f\f\f\f\f\n= t1,1 · t2,2 · · · tn,n · 1\n",
    "So in this case also, the determinant is the product down the diagonal.\n",
    "QED\nThat gives us a way to compute the value of a determinant function on a\nmatrix: do Gaussian reduction, keeping track of any changes of sign caused by\nrow swaps and any scalars that we factor out, and ﬁnish by multiplying down\nthe diagonal of the echelon form result.",
    "This algorithm is as fast as Gauss’s\nMethod and so is practical on all of the matrices that we will see.\n",
    "2.5 Example Doing 2×2 determinants with Gauss’s Method\n\f\f\f\f\f\n2\n4\n−1\n3\n\f\f\f\f\f =\n\f\f\f\f\f\n2\n4\n0\n5\n\f\f\f\f\f = 10\ndoesn’t give a big time savings because the 2×2 determinant formula is easy.\n",
    "However, a 3×3 determinant is often easier to calculate with Gauss’s Method\nthan with its formula.\n\f\f\f\f\f\f\f\n",
    "2\n2\n6\n4\n4\n3\n0\n−3\n5\n\f\f\f\f\f\f\f\n=\n\f\f\f\f\f\f\f\n2\n2\n6\n0\n0\n−9\n0\n−3\n5\n\f\f\f\f\f\f\f\n= −\n\f\f\f\f\f\f\f\n2\n2\n6\n0\n−3\n5\n0\n0\n−9\n\f\f\f\f\f\f\f\n= −54\n\n334\nChapter Four.",
    "Determinants\n2.6 Example Determinants bigger than 3×3 go quickly with the Gauss’s Method\nprocedure.\n\f\f\f\f\f\f\f\f\f\n",
    "1\n0\n1\n3\n0\n1\n1\n4\n0\n0\n0\n5\n0\n1\n0\n1\n\f\f\f\f\f\f\f\f\f\n=\n\f\f\f\f\f\f\f\f\f\n1\n0\n1\n3\n0\n1\n1\n4\n0\n0\n0\n5\n0\n0\n−1\n−3\n\f\f\f\f\f\f\f\f\f\n= −\n\f\f\f\f\f\f\f\f\f\n1\n0\n1\n3\n0\n1\n1\n4\n0\n0\n−1\n−3\n0\n0\n0\n5\n\f\f\f\f\f\f\f\f\f\n= −(−5) = 5\nThat example raises an important point.",
    "This chapter’s introduction gives\nformulas for 2×2 and 3×3 determinants, so we know that they exist, but not for\ndeterminant functions on matrices that are 4×4 or larger.",
    "Instead, Deﬁnition 2.1\ngives properties that a determinant function should have and leads to computing\ndeterminants by Gauss’s Method.\n",
    "However, for any matrix we can reduce it to echelon form by Gauss’s Method\nin multiple ways.",
    "For example, given a reduction we could change it by inserting\na ﬁrst step that multiplies the top row by 2 and then a second step that multiplies\nit by 1/2.",
    "So we have to worry that two diﬀerent Gauss’s Method reductions\ncould lead to two diﬀerent computed values for the determinant.\n",
    "That is, we must verify that Deﬁnition 2.1 gives a well-deﬁned function.",
    "The\nnext two subsections do this, showing that there exists a well-deﬁned function\nsatisfying the deﬁnition.\n",
    "But ﬁrst we show that if there is such a function then there is no more than\none.",
    "The example above illustrates the idea: we got 5 by following the properties\nof the deﬁnition.",
    "So while we have not yet proved that det4×4 exists, that there\nis a function with properties (1) – (4), if such a function satisfying them does\nexist then we know what value it gives on the above matrix.\n",
    "2.7 Lemma For each n, if there is an n×n determinant function then it is unique.\n",
    "Proof Suppose that there are two functions det1, det2 : Mn×n →R satisfying\nthe properties of Deﬁnition 2.1 and its consequence Lemma 2.4.",
    "Given a square\nmatrix M, ﬁx some way of performing Gauss’s Method to bring the matrix\nto echelon form (it does not matter that there are multiple ways, just ﬁx one\nof them).",
    "By using this ﬁxed reduction as in the above examples — keeping\ntrack of row-scaling factors and how the sign alternates on row swaps, and then\nmultiplying down the diagonal of the echelon form result — we can compute the\nvalue that these two functions must return on M, and they must return the\nsame value.",
    "Since they give the same output on every input, they are the same\nfunction.\n",
    "QED\nThe ‘if there is an n×n determinant function’ emphasizes that, although we\ncan use Gauss’s Method to compute the only value that a determinant function\n\nSection I. Definition\n335\ncould possibly return, we haven’t yet shown that such a function exists for all n.\n",
    "The rest of this section does that.\n",
    "Exercises\nFor these, assume that an n×n determinant function exists for all n.\n✓2.8 Find each determinant by performing one row operation.\n(a)\n\f\f\f\f\f\f\f\f\n1\n−2\n1\n2\n2\n−4\n1\n0\n0\n0\n−1\n0\n0\n0\n0\n5\n\f\f\f\f\f\f\f\f\n(b)\n\f\f\f\f\f\f\n1\n1\n−2\n0\n0\n4\n0\n3\n−6\n\f\f\f\f\f\f\n✓2.9 Use Gauss’s Method to ﬁnd each determinant.\n",
    "(a)\n\f\f\f\f\f\f\n3\n1\n2\n3\n1\n0\n0\n1\n4\n\f\f\f\f\f\f\n(b)\n\f\f\f\f\f\f\f\f\n1\n0\n0\n1\n2\n1\n1\n0\n−1\n0\n1\n0\n1\n1\n1\n0\n\f\f\f\f\f\f\f\f\n2.10 Use Gauss’s Method to ﬁnd each.\n",
    "(a)\n\f\f\f\f\n2\n−1\n−1\n−1\n\f\f\f\f\n(b)\n\f\f\f\f\f\f\n1\n1\n0\n3\n0\n2\n5\n2\n2\n\f\f\f\f\f\f\n2.11 For which values of k does this system have a unique solution?\nx\n+ z −w = 2\ny −2z\n= 3\nx\n+ kz\n= 4\nz −w = 2\n✓2.12 Express each of these in terms of |H|.\n",
    "(a)\n\f\f\f\f\f\f\nh3,1\nh3,2\nh3,3\nh2,1\nh2,2\nh2,3\nh1,1\nh1,2\nh1,3\n\f\f\f\f\f\f\n(b)\n\f\f\f\f\f\f\n−h1,1\n−h1,2\n−h1,3\n−2h2,1\n−2h2,2\n−2h2,3\n−3h3,1\n−3h3,2\n−3h3,3\n\f\f\f\f\f\f\n(c)\n\f\f\f\f\f\f\nh1,1 + h3,1\nh1,2 + h3,2\nh1,3 + h3,3\nh2,1\nh2,2\nh2,3\n5h3,1\n5h3,2\n5h3,3\n\f\f\f\f\f\f\n✓2.13 Find the determinant of a diagonal matrix.\n",
    "2.14 Describe the solution set of a homogeneous linear system if the determinant of\nthe matrix of coeﬃcients is nonzero.\n",
    "✓2.15 Show that this determinant is zero.\n\f\f\f\f\f\f\n",
    "y + z\nx + z\nx + y\nx\ny\nz\n1\n1\n1\n\f\f\f\f\f\f\n2.16\n(a) Find the 1×1, 2×2, and 3×3 matrices with i, j entry given by (−1)i+j.\n(b) Find the determinant of the square matrix with i, j entry (−1)i+j.\n2.17\n(a) Find the 1×1, 2×2, and 3×3 matrices with i, j entry given by i + j.\n\n336\nChapter Four.",
    "Determinants\n(b) Find the determinant of the square matrix with i, j entry i + j.\n✓2.18 Show that determinant functions are not linear by giving a case where |A+B| ̸=\n|A| + |B|.\n",
    "2.19",
    "The second condition in the deﬁnition, that row swaps change the sign of a\ndeterminant, is somewhat annoying.",
    "It means we have to keep track of the number\nof swaps, to compute how the sign alternates.",
    "Can we get rid of it?",
    "Can we replace\nit with the condition that row swaps leave the determinant unchanged?",
    "(If so\nthen we would need new 1×1, 2×2, and 3×3 formulas, but that would be a minor\nmatter.)\n",
    "2.20 Prove that the determinant of any triangular matrix, upper or lower, is the\nproduct down its diagonal.\n",
    "2.21 Refer to the deﬁnition of elementary matrices in the Mechanics of Matrix\nMultiplication subsection.\n",
    "(a) What is the determinant of each kind of elementary matrix?\n(b) Prove that if E is any elementary matrix then |ES| = |E||S| for any appropriately\nsized S.\n(c) (This question doesn’t involve determinants.)",
    "Prove that if T is singular\nthen a product TS is also singular.\n",
    "(d) Show that |TS| = |T||S|.\n(e) Show that if T is nonsingular then |T −1| = |T|−1.\n",
    "2.22 Prove that the determinant of a product is the product of the determinants\n|TS| = |T| |S| in this way.\n",
    "Fix the n × n matrix S and consider the function\nd: Mn×n →R given by T 7→|TS|/|S|.\n",
    "(a) Check that d satisﬁes condition (1) in the deﬁnition of a determinant function.\n",
    "(b) Check condition (2).\n",
    "(c) Check condition (3).\n",
    "(d) Check condition (4).\n",
    "(e) Conclude the determinant of a product is the product of the determinants.\n",
    "2.23",
    "A submatrix of a given matrix A is one that we get by deleting some of the\nrows and columns of A. Thus, the ﬁrst matrix here is a submatrix of the second.\n",
    "\u00123\n1\n2\n5\n\u0013\n\n\n3\n4\n1\n0\n9\n−2\n2\n−1\n5\n\n\nProve that for any square matrix, the rank of the matrix is r if and only if r is the\nlargest integer such that there is an r×r submatrix with a nonzero determinant.\n",
    "2.24 Prove that a matrix with rational entries has a rational determinant.\n?",
    "2.25",
    "[Am.",
    "Math.",
    "Mon., Feb. 1953] Find the element of likeness in (a) simplifying a\nfraction, (b) powdering the nose, (c) building new steps on the church, (d) keeping\nemeritus professors on campus, (e) putting B, C, D in the determinant\n\f\f\f\f\f\f\f\f\n1\na\na2\na3\na3\n1\na\na2\nB\na3\n1\na\nC\nD\na3\n1\n\f\f\f\f\f\f\f\f\n.\n\nSection I. Definition\n337\nI.3\nThe Permutation Expansion\nThe prior subsection deﬁnes a function to be a determinant if it satisﬁes four\nconditions and shows that there is at most one n×n determinant function for\neach n. What is left is to show that for each n such a function exists.\n",
    "But, we easily compute determinants: we use Gauss’s Method, keeping track\nof the sign changes from row swaps, and end by multiplying down the diagonal.\n",
    "How could they not exist?\n",
    "The diﬃculty is to show that the computation gives a well-deﬁned — that\nis, unique — result.",
    "Consider these two Gauss’s Method reductions of the same\nmatrix, the ﬁrst without any row swap\n \n1\n2\n3\n4\n!\n−3ρ1+ρ2\n−→\n \n1\n2\n0\n−2\n!\nand the second with one.\n \n1\n2\n3\n4\n!\nρ1↔ρ2\n−→\n \n3\n4\n1\n2\n!\n−(1/3)ρ1+ρ2\n−→\n \n3\n4\n0\n2/3\n!\n",
    "Both yield the determinant −2 since in the second one we note that the row\nswap changes the sign of the result we get by multiplying down the diagonal.\n",
    "The fact that we are able to proceed in two ways opens the possibility that the\ntwo give diﬀerent answers.",
    "That is, the way that we have given to compute\ndeterminant values does not plainly eliminate the possibility that there might be,\nsay, two reductions of some 7×7 matrix that lead to diﬀerent determinant values.\n",
    "In that case we would not have a function, since the deﬁnition of a function is\nthat for each input there must be exactly associated one output.",
    "The rest of\nthis section shows that the deﬁnition Deﬁnition 2.1 never leads to a conﬂict.\n",
    "To do this we will deﬁne an alternative way to ﬁnd the value of a determinant.\n",
    "(This alternative is less useful in practice because it is slow.",
    "But it is very useful\nfor theory.)",
    "The key idea is that condition (3) of Deﬁnition 2.1 shows that the\ndeterminant function is not linear.\n",
    "3.1 Example With condition (3) scalars come out of each row separately,\n\f\f\f\f\f\n4\n2\n−2\n6\n\f\f\f\f\f = 2 ·\n\f\f\f\f\f\n2\n1\n−2\n6\n\f\f\f\f\f = 4 ·\n\f\f\f\f\f\n2\n1\n−1\n3\n\f\f\f\f\f\nnot from the entire matrix at once.",
    "So, where\nA =\n \n2\n1\n−1\n3\n!\nthen det(2A) ̸= 2 · det(A) (instead, det(2A) = 4 · det(A)).\n\n",
    "338\nChapter Four.",
    "Determinants\nSince scalars come out a row at a time we might guess that determinants are\nlinear a row at a time.\n",
    "3.2 Deﬁnition Let V be a vector space.",
    "A map f:",
    "Vn →R is multilinear if\n(1) f(⃗ρ1, . . .",
    ",⃗v + ⃗w, . . .",
    ",⃗ρn) = f(⃗ρ1, . . .",
    ",⃗v, . . .",
    ",⃗ρn) + f(⃗ρ1, . . .",
    ", ⃗w, . . .",
    ",⃗ρn)\n(2) f(⃗ρ1, . . .",
    ", k⃗v, . . .",
    ",⃗ρn) = k · f(⃗ρ1, . . .",
    ",⃗v, . . .",
    ",⃗ρn)\nfor ⃗v, ⃗w ∈V and k ∈R.\n3.3 Lemma Determinants are multilinear.\n",
    "Proof Property (2) here is just Deﬁnition 2.1’s condition (3) so we need only\nverify property (1).\n",
    "There are two cases.",
    "If the set of other rows {⃗ρ1, . .",
    ".",
    ",⃗ρi−1,⃗ρi+1, . . .",
    ",⃗ρn}\nis linearly dependent then all three matrices are singular and so all three\ndeterminants are zero and the equality is trivial.\n",
    "Therefore assume that the set of other rows is linearly independent.",
    "We can\nmake a basis by adding one more vector ⟨⃗ρ1, . . .",
    ",⃗ρi−1, ⃗β,⃗ρi+1, . . .",
    ",⃗ρn⟩. Express\n⃗v and ⃗w with respect to this basis\n⃗v = v1⃗ρ1 + · · · + vi−1⃗ρi−1 + vi⃗β + vi+1⃗ρi+1 + · · · + vn⃗ρn\n⃗w = w1⃗ρ1 + · · · + wi−1⃗ρi−1 + wi⃗β + wi+1⃗ρi+1 + · · · + wn⃗ρn\nand add.\n",
    "⃗v + ⃗w = (v1 + w1)⃗ρ1 + · · · + (vi + wi)⃗β + · · · + (vn + wn)⃗ρn\nConsider the left side of (1) and expand ⃗v + ⃗w.\ndet(⃗ρ1, . . .",
    ", (v1 + w1)⃗ρ1 + · · · + (vi + wi)⃗β + · · · + (vn + wn)⃗ρn, . . .",
    ",⃗ρn) (∗)\n",
    "By the deﬁnition of determinant’s condition (1), the value of (∗) is unchanged\nby the operation of adding −(v1 + w1)⃗ρ1 to the i-th row ⃗v + ⃗w.",
    "The i-th row\nbecomes this.\n",
    "⃗v + ⃗w −(v1 + w1)⃗ρ1 = (v2 + w2)⃗ρ2 + · · · + (vi + wi)⃗β + · · · + (vn + wn)⃗ρn\nNext add −(v2 + w2)⃗ρ2, etc., to eliminate all of the terms from the other rows.\n",
    "Apply condition (3) from the deﬁnition of determinant.\ndet(⃗ρ1, . . . ,⃗v + ⃗w, . . .",
    ",⃗ρn)\n= det(⃗ρ1, . . .",
    ", (vi + wi) · ⃗β, . . .",
    ",⃗ρn)\n= (vi + wi) · det(⃗ρ1, . . .",
    ", ⃗β, . . .",
    ",⃗ρn)\n= vi · det(⃗ρ1, . . .",
    ", ⃗β, . . .",
    ",⃗ρn)",
    "+ wi · det(⃗ρ1, . . .",
    ", ⃗β, . . .",
    ",⃗ρn)\n\nSection I. Definition\n339\nNow this is a sum of two determinants.",
    "To ﬁnish, bring vi and wi back inside\nin front of the ⃗β’s and use row combinations again, this time to reconstruct the\nexpressions of ⃗v and ⃗w in terms of the basis.",
    "That is, start with the operations\nof adding v1⃗ρ1 to vi⃗β and w1⃗ρ1 to wi⃗ρ1, etc., to get the expansions of ⃗v and ⃗w.\n",
    "QED\nMultilinearity allows us to expand a determinant into a sum of determinants,\neach of which involves a simple matrix.\n",
    "3.4 Example Use property (1) of multilinearity to break up the ﬁrst row\n\f\f\f\f\f\n2\n1\n4\n3\n\f\f\f\f\f =\n\f\f\f\f\f\n2\n0\n4\n3\n\f\f\f\f\f +\n\f\f\f\f\f\n0\n1\n4\n3\n\f\f\f\f\f\nand then use (1) again to break each along the second row.\n",
    "=\n\f\f\f\f\f\n2\n0\n4\n0\n\f\f\f\f\f +\n\f\f\f\f\f\n2\n0\n0\n3\n\f\f\f\f\f +\n\f\f\f\f\f\n0\n1\n4\n0\n\f\f\f\f\f +\n\f\f\f\f\f\n0\n1\n0\n3\n\f\f\f\f\f\nThe result is four determinants.",
    "In each row of each of the four there is a single\nentry from the original matrix.\n",
    "3.5 Example",
    "In the same way, a 3×3 determinant separates into a sum of many\nsimpler determinants.",
    "Splitting along the ﬁrst row produces three determinants\n(we have highlighted the zero in the 1, 3 position to set it oﬀvisually from the\nzeroes that appear as part of the splitting).\n\f\f\f\f\f\f\f\n",
    "2\n1\n−1\n4\n3\n0\n2\n1\n5\n\f\f\f\f\f\f\f\n=\n\f\f\f\f\f\f\f\n2\n0\n0\n4\n3\n0\n2\n1\n5\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n0\n1\n0\n4\n3\n0\n2\n1\n5\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n0\n0\n−1\n4\n3\n0\n2\n1\n5\n\f\f\f\f\f\f\f\n",
    "In turn, each of the above splits in three along the second row.",
    "Then each of the\nnine splits in three along the third row.",
    "The result is twenty seven determinants,\nsuch that each row contains a single entry from the starting matrix.\n",
    "=\n\f\f\f\f\f\f\f\n2\n0\n0\n4\n0\n0\n2\n0\n0\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n2\n0\n0\n4\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n2\n0\n0\n4\n0\n0\n0\n0\n5\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n2\n0\n0\n0\n3\n0\n2\n0\n0\n\f\f\f\f\f\f\f\n+ · · · +\n\f\f\f\f\f\f\f\n0\n0\n−1\n0\n0\n0\n0\n0\n5\n\f\f\f\f\f\f\f\nSo multilinearity will expand an n×n determinant into a sum of nn-many\ndeterminants, where each row of each determinant contains a single entry from\nthe starting matrix.\n",
    "In this expansion, although there are lots of terms, most of them have a\ndeterminant of zero.\n\n",
    "340\nChapter Four.",
    "Determinants\n3.6 Example",
    "In each of these examples from the prior expansion, two of the\nentries from the original matrix are in the same column.\n\f\f\f\f\f\f\f\n",
    "2\n0\n0\n4\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n\f\f\f\f\f\f\f\n0\n0\n−1\n0\n3\n0\n0\n0\n5\n\f\f\f\f\f\f\f\n\f\f\f\f\f\f\f\n0\n1\n0\n0\n0\n0\n0\n0\n5\n\f\f\f\f\f\f\f\nFor instance, in the ﬁrst matrix the 2 and the 4 both come from the ﬁrst column\nof the original matrix.",
    "In the second matrix the −1 and 5 both come from the\nthird column.",
    "And in the third matrix the 0 and 5 both come from the third\ncolumn.",
    "Any such matrix is singular because one row is a multiple of the other.\n",
    "Thus any such determinant is zero, by Lemma 2.4.\n",
    "With that observation the above expansion of the 3×3 determinant into the\nsum of the twenty seven determinants simpliﬁes to the sum of these six where\nthe entries from the original matrix come one per row, and also one per column.\n\f\f\f\f\f\f\f\n",
    "2\n1\n−1\n4\n3\n0\n2\n1\n5\n\f\f\f\f\f\f\f\n=\n\f\f\f\f\f\f\f\n2\n0\n0\n0\n3\n0\n0\n0\n5\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n2\n0\n0\n0\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n0\n1\n0\n4\n0\n0\n0\n0\n5\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n0\n1\n0\n0\n0\n0\n2\n0\n0\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n0\n0\n−1\n4\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n+\n\f\f\f\f\f\f\f\n0\n0\n−1\n0\n3\n0\n2\n0\n0\n\f\f\f\f\f\f\f\nIn that expansion we can bring out the scalars.\n",
    "= (2)(3)(5)\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ (2)(0)(1)\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\f\f\f\f\f\f\f\n+ (1)(4)(5)\n\f\f\f\f\f\f\f\n0\n1\n0\n1\n0\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ (1)(0)(2)\n\f\f\f\f\f\f\f\n0\n1\n0\n0\n0\n1\n1\n0\n0\n\f\f\f\f\f\f\f\n+ (−1)(4)(1)\n\f\f\f\f\f\f\f\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n+ (−1)(3)(2)\n\f\f\f\f\f\f\f\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\f\f\f\f\f\f\f\nTo ﬁnish, evaluate those six determinants by row-swapping them to the identity\n\nSection I. Definition\n341\nmatrix, keeping track of the sign changes.\n",
    "= 30 · (+1) + 0 · (−1)\n+ 20 · (−1) + 0 · (+1)\n−4 · (+1) −6 · (−1) = 12\nThat example captures this subsection’s new calculation scheme.",
    "Multi-\nlinearity expands a determinant into many separate determinants, each with\none entry from the original matrix per row.",
    "Most of these have one row that\nis a multiple of another so we omit them.",
    "We are left with the determinants\nthat have one entry per row and column from the original matrix.",
    "Factoring\nout the scalars further reduces the determinants that we must compute to the\none-entry-per-row-and-column matrices where all entries are 1’s.\n",
    "Recall Deﬁnition Three.",
    "IV.3.14, that a permutation matrix is square, with\nentries 0’s except for a single 1 in each row and column.",
    "We now introduce a\nnotation for permutation matrices.\n",
    "3.7 Deﬁnition An n-permutation is a function on the ﬁrst n positive integers\nφ: {1, . .",
    ". , n} →{1, . .",
    ". , n} that is one-to-one and onto.\n",
    "In a permutation each number 1, . . .",
    ", n appears as output for one and only one\ninput.",
    "We can denote a permutation as a sequence φ = ⟨φ(1), φ(2), . . .",
    ", φ(n)⟩.\n3.8 Example The 2-permutations are the functions φ1 : {1, 2} →{1, 2} given by\nφ1(1) = 1, φ1(2) = 2, and φ2 :",
    "{1, 2} →{1, 2} given by φ2(1)",
    "= 2, φ2(2) = 1.\n",
    "The sequence notation is shorter: φ1 = ⟨1, 2⟩and φ2 = ⟨2, 1⟩.\n3.9 Example In the sequence notation the 3-permutations are φ1 = ⟨1, 2, 3⟩,\nφ2 = ⟨1, 3, 2⟩, φ3 = ⟨2, 1, 3⟩, φ4 = ⟨2, 3, 1⟩, φ5 = ⟨3, 1, 2⟩, and φ6 = ⟨3, 2, 1⟩.\n",
    "We denote the row vector that is all 0’s except for a 1 in entry j with ιj so\nthat the four-wide ι2 is (0 1 0 0).",
    "Now our notation for permutation matrices\nis: with any φ = ⟨φ(1), . . .",
    ", φ(n)⟩associate the matrix whose rows are ιφ(1),\n. .",
    ".",
    ", ιφ(n).",
    "For instance, associated with the 4-permutation φ = ⟨3, 2, 1, 4⟩is the\nmatrix whose rows are the corresponding ι’s.\n",
    "Pφ =\n\n\n\n\n\nι3\nι2\nι1\nι4\n\n\n\n\n=\n\n\n\n\n\n0\n0\n1\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n\n\n\n\n\n",
    "3.10 Example",
    "These are the permutation matrices for the 2-permutations listed\nin Example 3.8.\n",
    "Pφ1 =\n \nι1\nι2\n!\n=\n \n1\n0\n0\n1\n!\n",
    "Pφ2 =\n \nι2\nι1\n!\n",
    "=\n \n0\n1\n1\n0\n!\n\n342\nChapter Four.",
    "Determinants\nFor instance, Pφ2’s ﬁrst row is ιφ2(1) = ι2 and its second is ιφ2(2) = ι1.\n",
    "3.11 Example Consider the 3-permutation φ5 = ⟨3, 1, 2⟩.",
    "The permutation matrix\nPφ5 has rows ιφ5(1) = ι3, ιφ5(2) = ι1, and ιφ5(3)",
    "= ι2.\n",
    "Pφ5 =\n\n\n\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\n\n\n3.12 Deﬁnition The permutation expansion for determinants is\n\f\f\f\f\f\f\f\f\f\f\nt1,1\nt1,2\n. . .\n",
    "t1,n\nt2,1\nt2,2\n. . .\n",
    "t2,n\n...\ntn,1\ntn,2\n. .",
    ".\n",
    "tn,n\n\f\f\f\f\f\f\f\f\f\f\n= t1,φ1(1)t2,φ1(2) · · · tn,φ1(n)|Pφ1|\n+ t1,φ2(1)t2,φ2(2) · · · tn,φ2(n)|Pφ2|\n...\n+ t1,φk(1)t2,φk(2) · · · tn,φk(n)|Pφk|\nwhere φ1, . . .",
    ", φk are all of the n-permutations.\n",
    "We can restate the formula in summation notation\n|T| =\nX\npermutations φ\nt1,φ(1)t2,φ(2) · · · tn,φ(n) |Pφ|\nread aloud as, “the sum, over all permutations φ, of terms having the form\nt1,φ(1)t2,φ(2) · · · tn,φ(n)|Pφ|.”\n",
    "3.13 Example The familiar 2×2 determinant formula follows from the above\n\f\f\f\f\f\nt1,1\nt1,2\nt2,1\nt2,2\n\f\f\f\f\f = t1,1t2,2 · |Pφ1| + t1,2t2,1 · |Pφ2|\n= t1,1t2,2 ·\n\f\f\f\f\f\n1\n0\n0\n1\n\f\f\f\f\f + t1,2t2,1 ·\n\f\f\f\f\f\n0\n1\n1\n0\n\f\f\f\f\f\n= t1,1t2,2 −t1,2t2,1\nas does the 3×3 formula.\n\f\f\f\f\f\f\f\n",
    "t1,1\nt1,2\nt1,3\nt2,1\nt2,2\nt2,3\nt3,1\nt3,2\nt3,3\n\f\f\f\f\f\f\f\n= t1,1t2,2t3,3 |Pφ1| + t1,1t2,3t3,2 |Pφ2| + t1,2t2,1t3,3 |Pφ3|\n+ t1,2t2,3t3,1 |Pφ4| + t1,3t2,1t3,2 |Pφ5| + t1,3t2,2t3,1 |Pφ6|\n= t1,1t2,2t3,3 −t1,1t2,3t3,2 −t1,2t2,1t3,3\n+ t1,2t2,3t3,1 + t1,3t2,1t3,2 −t1,3t2,2t3,1\n\nSection I. Definition\n343\nComputing a determinant with the permutation expansion typically takes\nlonger than with Gauss’s Method.",
    "However, we will use it to prove that the\ndeterminant function exists.",
    "The proof is long so we will just state the result\nhere and defer the proof to the following subsection.\n",
    "3.14 Theorem For each n there is an n×n determinant function.\n",
    "Also in the next subsection is the proof of the next result (they are together\nbecause the two proofs overlap).\n",
    "3.15 Theorem The determinant of a matrix equals the determinant of its trans-\npose.\n",
    "Because of this theorem, while we have so far stated determinant results in\nterms of rows, all of the results also hold in terms of columns.\n",
    "3.16 Corollary A matrix with two equal columns is singular.",
    "Column swaps\nchange the sign of a determinant.",
    "Determinants are multilinear in their columns.\n",
    "Proof For the ﬁrst statement, transposing the matrix results in a matrix with\nthe same determinant, and with two equal rows, and hence a determinant of\nzero.",
    "Prove the other two in the same way.\n",
    "QED\n",
    "We ﬁnish this subsection with a summary: determinant functions exist, are\nunique, and we know how to compute them.",
    "As for what determinants are\nabout, perhaps these lines [Kemp] help make it memorable.\n",
    "Determinant none,\nSolution: lots or none.\n",
    "Determinant some,\nSolution: just one.\n",
    "Exercises\nThis summarizes our notation for the 2- and 3-permutations.\n",
    "i\n1\n2\nφ1(i)\n1\n2\nφ2(i)\n2\n1\ni\n1\n2\n3\nφ1(i)\n1\n2\n3\nφ2(i)\n1\n3\n2\nφ3(i)\n2\n1\n3\nφ4(i)\n2\n3\n1\nφ5(i)\n3\n1\n2\nφ6(i)\n3\n2\n1\n✓3.17 For this matrix, ﬁnd the term associated with each 3-permutation.\n",
    "M =\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n344\nChapter Four.",
    "Determinants\nThat is, ﬁll in the rest of this table.\n",
    "permutation φi\nφ1\nφ2\nφ3\nφ4\nφ5\nφ6\nterm m1,φi(1)m2,φi(2)m3,φi(3)\n1 · 5 · 9\n✓3.18 For each 3-permutation φ ﬁnd |Pφ|.\n",
    "3.19",
    "This determinant is 7 by the 2×2 formula.",
    "Compute it with the permutation\nexpansion.\n\f\f\f\f\n",
    "2\n3\n1\n5\n\f\f\f\f\n3.20",
    "This determinant is 0 because the ﬁrst two rows add to the third.",
    "Compute\nthe determinant using the permutation expansion.\n\f\f\f\f\f\f\n",
    "−1\n0\n1\n3\n1\n4\n2\n1\n5\n\f\f\f\f\f\f\n✓3.21 Compute the determinant by using the permutation expansion.\n",
    "(a)\n\f\f\f\f\f\f\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\f\f\f\f\f\f\n(b)\n\f\f\f\f\f\f\n2\n2\n1\n3\n−1\n0\n−2\n0\n5\n\f\f\f\f\f\f\n✓3.22 Compute these both with Gauss’s Method and the permutation expansion\nformula.\n",
    "(a)\n\f\f\f\f\n2\n1\n3\n1\n\f\f\f\f\n(b)\n\f\f\f\f\f\f\n0\n1\n4\n0\n2\n3\n1\n5\n1\n\f\f\f\f\f\f\n✓3.23 Use the permutation expansion formula to derive the formula for 3×3 determi-\nnants.\n",
    "3.24 List all of the 4-permutations.\n",
    "3.25 A permutation, regarded as a function from the set {1, .., n} to itself, is one-to-\none and onto.",
    "Therefore, each permutation has an inverse.\n",
    "(a) Find the inverse of each 2-permutation.\n",
    "(b) Find the inverse of each 3-permutation.\n",
    "3.26 Prove that f is multilinear",
    "if and only if for all ⃗v, ⃗w ∈V and k1, k2 ∈R, this\nholds.\n",
    "f(⃗ρ1, . . .",
    ", k1⃗v1 + k2⃗v2, . . .",
    ",⃗ρn) = k1f(⃗ρ1, . . .",
    ",⃗v1, . . .",
    ",⃗ρn)",
    "+ k2f(⃗ρ1, . . .",
    ",⃗v2, . . .",
    ",⃗ρn)\n3.27 How would determinants change if we changed property (4) of the deﬁnition to\nread that |I| = 2?\n3.28 Verify the second and third statements in Corollary 3.16.\n",
    "✓3.29 Show that if an n×n matrix has a nonzero determinant then we can express\nany column vector ⃗v ∈Rn as a linear combination of the columns of the matrix.\n3.30",
    "[Strang 80] True or false: a matrix whose entries are only zeros or ones has a\ndeterminant equal to zero, one, or negative one.\n3.31\n(a) Show that there are 120 terms in the permutation expansion formula of a\n5×5 matrix.\n",
    "(b) How many are sure to be zero if the 1, 2 entry is zero?\n3.32 How many n-permutations are there?\n3.33 Show that the inverse of a permutation matrix is its transpose.\n\nSection I. Definition\n345\n3.34 A matrix A is skew-symmetric if AT = −A, as in this matrix.\n",
    "A =\n\u0012 0\n3\n−3\n0\n\u0013\nShow that n×n skew-symmetric matrices with nonzero determinants exist only for\neven n.\n✓3.35 What is the smallest number of zeros, and the placement of those zeros, needed\nto ensure that a 4×4 matrix has a determinant of zero?\n3.36 If we have n data points (x1, y1), (x2, y2), . . .",
    ", (xn, yn) and want to ﬁnd a\npolynomial p(x) = an−1xn−1 + an−2xn−2 + · · · +",
    "a1x + a0 passing through those\npoints then we can plug in the points to get an n equation/n unknown linear\nsystem.",
    "The matrix of coeﬃcients for that system is the Vandermonde matrix.\n",
    "Prove that the determinant of the transpose of that matrix of coeﬃcients\n\f\f\f\f\f\f\f\f\f\f\f\f\n1\n1\n. .",
    ".\n",
    "1\nx1\nx2\n. . .\n",
    "xn\nx12\nx22\n. .",
    ".\n",
    "xn2\n...\nx1n−1\nx2n−1\n. .",
    ".\n",
    "xnn−1\n\f\f\f\f\f\f\f\f\f\f\f\f\nequals the product, over all indices i, j ∈{1, . .",
    ". , n} with i <",
    "j, of terms of the form\nxj −xi.",
    "(This shows that the determinant is zero, and the linear system has no\nsolution, if and only if the xi’s in the data are not distinct.)\n",
    "3.37 We can divide a matrix into blocks, as here,\n\n\n1\n2\n0\n3\n4\n0\n0\n0\n−2\n\n\nwhich shows four blocks, the square 2×2 and 1×1 ones in the upper left and lower\nright, and the zero blocks in the upper right and lower left.",
    "Show that if a matrix\nis such that we can partition it as\nT =\n\u0012 J\nZ2\nZ1\nK\n\u0013\nwhere J and K are square, and Z1 and Z2 are all zeroes, then |T| = |J| · |K|.\n",
    "3.38 Prove that for any n×n matrix T there are at most n distinct reals r such that\nthe matrix T −rI has determinant zero (we shall use this result in Chapter Five).\n?",
    "3.39",
    "[Math. Mag., Jan. 1963, Q307]",
    "The nine positive digits can be arranged into\n3×3 arrays in 9! ways.",
    "Find the sum of the determinants of these arrays.\n",
    "3.40",
    "[Math. Mag., Jan. 1963, Q237] Show that\n\f\f\f\f\f\f\nx −2\nx −3\nx −4\nx + 1\nx −1\nx −3\nx −4\nx −7\nx −10\n\f\f\f\f\f\f\n= 0.\n?",
    "3.41",
    "[Am.",
    "Math.",
    "Mon., Jan. 1949]",
    "Let S be the sum of the integer elements of a\nmagic square of order three and let D be the value of the square considered as a\ndeterminant.",
    "Show that D/S is an integer.\n\n",
    "346\nChapter Four.",
    "Determinants\n?",
    "3.42",
    "[Am.",
    "Math.",
    "Mon., Jun. 1931] Show that the determinant of the n2 elements in\nthe upper left corner of the Pascal triangle\n1\n1\n1\n1\n.\n.\n",
    "1\n2\n3\n.\n.\n",
    "1\n3\n.\n.\n",
    "1\n.\n.\n",
    ".\n.\n",
    "has the value unity.\n",
    "I.4\nDeterminants Exist\nThis subsection contains proofs of two results from the prior subsection.\n",
    "It is optional.",
    "We will use the material developed here only in the Jordan\nCanonical Form subsection, which is also optional.\n",
    "We wish to show that for any size n, the determinant function on n×n matrices\nis well-deﬁned.",
    "The prior subsection develops the permutation expansion formula.\n\f\f\f\f\f\f\f\f\f\f\n",
    "t1,1\nt1,2\n. . .\n",
    "t1,n\nt2,1\nt2,2\n. . .\n",
    "t2,n\n...\ntn,1\ntn,2\n. .",
    ".\n",
    "tn,n\n\f\f\f\f\f\f\f\f\f\f\n= t1,φ1(1)t2,φ1(2) · · · tn,φ1(n)|Pφ1|\n+ t1,φ2(1)t2,φ2(2) · · · tn,φ2(n)|Pφ2|\n...\n+ t1,φk(1)t2,φk(2) · · · tn,φk(n)|Pφk|\n=\nX\npermutations φ\nt1,φ(1)t2,φ(2) · · · tn,φ(n) |Pφ|\n",
    "This reduces the problem of showing that the determinant is well-deﬁned to only\nshowing that the determinant is well-deﬁned on the set of permutation matrices.\n",
    "A permutation matrix can be row-swapped to the identity matrix.",
    "So one\nway that we can calculate its determinant is by keeping track of the number of\nswaps.",
    "However, we still must show that the result is well-deﬁned.",
    "Recall what\nthe diﬃculty is: the determinant of\nPφ =\n\n\n\n\n\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n\n\n\n\n\n\nSection I. Definition\n347\ncould be computed with one swap\nPφ\nρ1↔ρ2\n−→\n\n\n\n\n\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n\n\n\n\n\nor with three.\n",
    "Pφ\nρ3↔ρ1\n−→\nρ2↔ρ3\n−→\nρ1↔ρ3\n−→\n\n\n\n\n\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n\n\n\n\n\nBoth reductions have an odd number of swaps so in this case we ﬁgure that\n|Pφ| = −1",
    "but if there were some way to do it with an even number of swaps then\nwe would have the determinant giving two diﬀerent outputs from a single input.\n",
    "Below, Corollary 4.5 proves that this cannot happen — there is no permutation\nmatrix that can be row-swapped to an identity matrix in two ways, one with an\neven number of swaps and the other with an odd number of swaps.\n",
    "4.1 Deﬁnition In a permutation φ = ⟨. . .",
    ", k, . . .",
    ", j, . .",
    ".⟩, elements such that k > j\nare in an inversion of their natural order.",
    "Similarly, in a permutation matrix\ntwo rows\nPφ =\n\n\n\n\n\n\n\n\n\n\n...\nιk\n...\nιj\n...\n\n\n\n\n\n\n\n\n\n\nsuch that k > j are in an inversion.\n",
    "4.2 Example This permutation matrix\n\n\n\n\n\n1\n0\n0\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n1\n\n\n\n\n=\n\n\n\n\n\nι1\nι3\nι2\nι4\n\n\n\n\n\nhas a single inversion, that ι3 precedes ι2.\n",
    "4.3 Example There are three inversions here:\n",
    "\n\n\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\n\n=\n\n\n\nι3\nι2\nι1\n\n\n\n\n348\nChapter Four.",
    "Determinants\nι3 precedes ι1, ι3 precedes ι2, and ι2 precedes ι1.\n",
    "4.4 Lemma A row-swap in a permutation matrix changes the number of inversions\nfrom even to odd, or from odd to even.\n",
    "Proof Consider a swap of rows j and k, where k > j.\nIf the two rows are adjacent\nPφ =\n\n\n\n\n\n\n\n...\nιφ(j)\nιφ(k)\n...\n\n\n\n\n\n\n\nρk↔ρj\n−→\n\n\n\n\n\n\n\n...\nιφ(k)\nιφ(j)\n...\n\n\n\n\n\n\n\nthen since inversions involving rows not in this pair are not aﬀected, the swap\nchanges the total number of inversions by one, either removing or producing one\ninversion depending on whether φ(j) > φ(k) or not.",
    "Consequently, the total\nnumber of inversions changes from odd to even or from even to odd.\n",
    "If the rows are not adjacent then we can swap them via a sequence of adjacent\nswaps, ﬁrst bringing row k up\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n...\nιφ(j)\nιφ(j+1)\nιφ(j+2)\n...\nιφ(k)\n...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nρk↔ρk−1\n−→\nρk−1↔ρk−2\n−→\n· · ·\nρj+1↔ρj\n−→\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n...\nιφ(k)\nιφ(j)\nιφ(j+1)\n...\nιφ(k−1)\n...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nand then bringing row j down.\n",
    "ρj+1↔ρj+2\n−→\nρj+2↔ρj+3\n−→\n· · ·\nρk−1↔ρk\n−→\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n...\nιφ(k)\nιφ(j+1)\nιφ(j+2)\n...\nιφ(j)\n...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEach of these adjacent swaps changes the number of inversions from odd to even\nor from even to odd.",
    "The total number of swaps (k −j)",
    "+ (k −j −1) is odd.\n\n",
    "Section I. Definition\n349\nThus, in aggregate, the number of inversions changes from even to odd, or from\nodd to even.\n",
    "QED\n4.5 Corollary",
    "If a permutation matrix has an odd number of inversions then\nswapping it to the identity takes an odd number of swaps.",
    "If it has an even\nnumber of inversions then swapping to the identity takes an even number.\n",
    "Proof The identity matrix has zero inversions.",
    "To change an odd number to\nzero requires an odd number of swaps, and to change an even number to zero\nrequires an even number of swaps.\n",
    "QED\n4.6 Example",
    "The matrix in Example 4.3 can be brought to the identity with one\nswap ρ1 ↔ρ3.",
    "(So the number of swaps needn’t be the same as the number of\ninversions, but the oddness or evenness of the two numbers is the same.)\n",
    "4.7 Deﬁnition The signum of a permutation sgn(φ) is −1 if the number of\ninversions in φ is odd and is +1 if the number of inversions is even.\n",
    "4.8 Example Using the notation for the 3-permutations from Example 3.8 we\nhave\nPφ1",
    "=\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\n\n\nPφ2 =\n\n\n\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\n\n\nso sgn(φ1) = 1 because there are no inversions, while sgn(φ2) = −1 because\nthere is one.\n",
    "We still have not shown that the determinant function is well-deﬁned because\nwe have not considered row operations on permutation matrices other than row\nswaps.",
    "We will ﬁnesse this issue.",
    "Deﬁne a function d: Mn×n →R by altering\nthe permutation expansion formula, replacing |Pφ| with sgn(φ).\nd(T) =\nX\npermutations φ\nt1,φ(1)t2,φ(2) · · · tn,φ(n) · sgn(φ)\n",
    "The advantage of this formula is that the number of inversions is clearly well-\ndeﬁned — just count them.",
    "Therefore, we will be ﬁnished showing that an n×n\ndeterminant function exists when we show that d satisﬁes the conditions in the\ndeﬁnition of a determinant.\n",
    "4.9 Lemma The function d above is a determinant.",
    "Hence determinant functions\ndetn×n exist for every n.\n\n350\nChapter Four.",
    "Determinants\nProof We must check that it satisﬁes the four conditions from the deﬁnition of\ndeterminant, Deﬁnition 2.1.\n",
    "Condition (4) is easy: where I is the n×n identity, in\nd(I)",
    "=\nX\nperm φ\nι1,φ(1)ι2,φ(2) · · · ιn,φ(n) sgn(φ)\nall of the terms in the summation are zero except for the one where the permu-\ntation φ is the identity, which gives the product down the diagonal, which is\none.\n",
    "For condition (3) suppose that T\nkρi\n−→ˆT and consider d(ˆT).\n",
    "X\nperm φ\nˆt1,φ(1) · · ·ˆti,φ(i) · · ·ˆtn,φ(n) sgn(φ)\n=\nX\nφ\nt1,φ(1) · · · kti,φ(i) · · · tn,φ(n) sgn(φ)\n",
    "Factor out k to get the desired equality.\n",
    "= k ·\nX\nφ\nt1,φ(1) ·",
    "· · ti,φ(i) · · · tn,φ(n) sgn(φ) = k · d(T)\n",
    "For (2) suppose that T\nρi↔ρj\n−→\nˆT. We must show that d(ˆT) is the negative\nof d(T).\n",
    "d(ˆT)",
    "=\nX\nperm φ\nˆt1,φ(1) · · ·ˆti,φ(i) · ·",
    "·ˆtj,φ(j) · · ·ˆtn,φ(n) sgn(φ)\n(∗)\nWe will show that each term in (∗) is associated with a term in d(T), and that the\ntwo terms are negatives of each other.",
    "Consider the matrix from the multilinear\nexpansion of d(ˆT)",
    "giving the term ˆt1,φ(1) · · ·ˆti,φ(i) · · ·ˆtj,φ(j) · · ·ˆtn,φ(n) sgn(φ).\n",
    "\n\n\n\n\n\n\n\n\n\n...\nˆti,φ(i)\n...\nˆtj,φ(j)\n...\n\n\n\n\n\n\n\n\n\n\n",
    "It is the result of the ρi ↔ρj operation performed on this matrix.\n\n\n\n\n\n\n\n\n\n\n...\nti,φ(j)\n...\ntj,φ(i)\n...\n\n\n\n\n\n\n\n\n\n\n\nSection I.",
    "Definition\n351\nThat is, the term with hatted t’s is associated with this term from the d(T)\nexpansion: t1,σ(1) · · · tj,σ(j) · · · ti,σ(i) · · · tn,σ(n) sgn(σ), where the permutation\nσ equals φ",
    "but with the i-th and j-th numbers interchanged, σ(i)",
    "= φ(j) and\nσ(j) = φ(i).",
    "The two terms have the same multiplicands ˆt1,φ(1) = t1,σ(1),\n. . .",
    ", including the entries from the swapped rows ˆti,φ(i) = tj,φ(i) = tj,σ(j) and\nˆtj,φ(j)",
    "= ti,φ(j) = ti,σ(i).",
    "But the two terms are negatives of each other since\nsgn(φ) = −sgn(σ) by Lemma 4.4.\n",
    "Now, any permutation φ can be derived from some other permutation σ by\nsuch a swap, in one and only one way.",
    "Therefore the summation in (∗) is in fact\na sum over all permutations, taken once and only once.\n",
    "d(ˆT)",
    "=\nX\nperm φ\nˆt1,φ(1) · · ·ˆti,φ(i) · ·",
    "·ˆtj,φ(j) · · ·ˆtn,φ(n) sgn(φ)\n=\nX\nperm σ\nt1,σ(1) · · · tj,σ(j) · · · ti,σ(i) · · · tn,σ(n) ·\n\u0000−sgn(σ)\n\u0001\nThus d(ˆT) = −d(T).\n",
    "Finally, for condition (1) suppose that T\nkρi+ρj\n−→\nˆT.\nd(ˆT) =\nX\nperm φ\nˆt1,φ(1) · · ·ˆti,φ(i) · · ·ˆtj,φ(j) · · ·ˆtn,φ(n) sgn(φ)\n=\nX\nφ\nt1,φ(1) · · · ti,φ(i) · · · (kti,φ(j) + tj,φ(j)) · · · tn,φ(n) sgn(φ)\nDistribute over the addition in kti,φ(j)",
    "+ tj,φ(j).\n",
    "=\nX\nφ\n\u0002\nt1,φ(1) · · · ti,φ(i) · · · kti,φ(j) · · · tn,φ(n) sgn(φ)\n+ t1,φ(1) · · · ti,φ(i) · · · tj,φ(j) · · · tn,φ(n)",
    "sgn(φ)\n\u0003\nBreak it into two summations.\n",
    "=\nX\nφ\nt1,φ(1) ·",
    "· · ti,φ(i) · · · kti,φ(j) · · · tn,φ(n) sgn(φ)\n+\nX\nφ\nt1,φ(1) · · · ti,φ(i) · · · tj,φ(j) · · · tn,φ(n) sgn(φ)\nRecognize the second one.\n",
    "= k ·\nX\nφ\nt1,φ(1) ·",
    "· · ti,φ(i) · · · ti,φ(j) · · · tn,φ(n) sgn(φ)\n+ d(T)\nConsider the terms t1,φ(1) · · · ti,φ(i) · · · ti,φ(j) · · · tn,φ(n) sgn(φ).",
    "Notice the sub-\nscripts; the entry is ti,φ(j), not tj,φ(j).",
    "The sum of these terms is the determinant\nof a matrix S that is equal to T except that row j of S is a copy of row i of T,\nthat is, S has two equal rows.",
    "In the same way that we proved Lemma 2.4 we\n\n352\nChapter Four.",
    "Determinants\ncan see that d(S)",
    "= 0: a swap of S’s equal rows will change the sign of d(S)\n",
    "but since the matrix is unchanged by that swap the value of d(S) must also be\nunchanged, and so that value must be zero.\n",
    "QED\n",
    "We have now proved that determinant functions exist for each size n×n.",
    "We\nalready know that for each size there is at most one determinant.",
    "Therefore, for\neach size there is one and only one determinant function.\n",
    "We end this subsection by proving the other result remaining from the prior\nsubsection.\n",
    "4.10 Theorem The determinant of a matrix equals the determinant of its trans-\npose.\n",
    "Proof The proof is best understood by doing the general 3×3 case.",
    "That the\nargument applies to the n×n case will be clear.\n",
    "Compare the permutation expansion of the matrix T\n\f\f\f\f\f\f\f\nt1,1\nt1,2\nt1,3\nt2,1\nt2,2\nt2,3\nt3,1\nt3,2\nt3,3\n\f\f\f\f\f\f\f\n= t1,1t2,2t3,3\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t1,1t2,3t3,2\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\f\f\f\f\f\f\f\n+ t1,2t2,1t3,3\n\f\f\f\f\f\f\f\n0\n1\n0\n1\n0\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t1,2t2,3t3,1\n\f\f\f\f\f\f\f\n0\n1\n0\n0\n0\n1\n1\n0\n0\n\f\f\f\f\f\f\f\n+ t1,3t2,1t3,2\n\f\f\f\f\f\f\f\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n+ t1,3t2,2t3,1\n\f\f\f\f\f\f\f\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\f\f\f\f\f\f\f\nwith the permutation expansion of its transpose.\n\f\f\f\f\f\f\f\n",
    "t1,1\nt2,1\nt3,1\nt1,2\nt2,2\nt3,2\nt1,3\nt2,3\nt3,3\n\f\f\f\f\f\f\f\n= t1,1t2,2t3,3\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t1,1t3,2t2,3\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\f\f\f\f\f\f\f\n+ t2,1t1,2t3,3\n\f\f\f\f\f\f\f\n0\n1\n0\n1\n0\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t2,1t3,2t1,3\n\f\f\f\f\f\f\f\n0\n1\n0\n0\n0\n1\n1\n0\n0\n\f\f\f\f\f\f\f\n+ t3,1t1,2t2,3\n\f\f\f\f\f\f\f\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n+ t3,1t2,2t1,3\n\f\f\f\f\f\f\f\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\f\f\f\f\f\f\f\nCompare ﬁrst the six products of t’s.",
    "The ones in the expansion of T are the\nsame as the ones in the expansion of the transpose; for instance, t1,2t2,3t3,1 is\n\nSection I. Definition\n353\nin the top and t3,1t1,2t2,3 is in the bottom.",
    "That’s perfectly sensible — the six\nin the top arise from all of the ways of picking one entry of T from each row and\ncolumn while the six in the bottom are all of the ways of picking one entry of T\nfrom each column and row, so of course they are the same set.\n",
    "Next observe that in the two expansions, each t-product expression is not\nnecessarily associated with the same permutation matrix.",
    "For instance, on the\ntop t1,2t2,3t3,1 is associated with the matrix for the map 1 7→2, 2 7→3, 3 7→1.\n",
    "On the bottom t3,1t1,2t2,3 is associated with the matrix for the map 1 7→3,\n2 7→1, 3 7→2.",
    "The second map is inverse to the ﬁrst.",
    "This is also perfectly\nsensible — both the matrix transpose and the map inverse ﬂip the 1, 2 to 2, 1,\nﬂip the 2, 3 to 3, 2, and ﬂip 3, 1 to 1, 3.\n",
    "We ﬁnish by noting that the determinant of Pφ equals the determinant of\nPφ−1, as Exercise 16 shows.\n",
    "QED\nExercises\nThese summarize the notation used in this book for the 2- and 3-permutations.\n",
    "i\n1\n2\nφ1(i)\n1\n2\nφ2(i)\n2\n1\ni\n1\n2\n3\nφ1(i)\n1\n2\n3\nφ2(i)\n1\n3\n2\nφ3(i)\n2\n1\n3\nφ4(i)\n2\n3\n1\nφ5(i)\n3\n1\n2\nφ6(i)\n3\n2\n1\n4.11 Give the permutation expansion of a general 2×2 matrix and its transpose.\n",
    "✓4.12 This problem appears also in the prior subsection.\n",
    "(a) Find the inverse of each 2-permutation.\n",
    "(b) Find the inverse of each 3-permutation.\n",
    "✓4.13\n(a) Find the signum of each 2-permutation.\n",
    "(b) Find the signum of each 3-permutation.\n",
    "4.14 Find the only nonzero term in the permutation expansion of this matrix.\n\f\f\f\f\f\f\f\f\n0\n1\n0\n0\n1\n0\n1\n0\n0\n1\n0\n1\n0\n0\n1\n0\n\f\f\f\f\f\f\f\f\nCompute that determinant by ﬁnding the signum of the associated permutation.\n",
    "4.15",
    "[Strang 80]",
    "What is the signum of the n-permutation φ = ⟨n, n −1, . . .",
    ", 2, 1⟩?\n",
    "4.16 Prove these.\n",
    "(a)",
    "Every permutation has an inverse.\n",
    "(b) sgn(φ−1)",
    "= sgn(φ)\n(c)",
    "Every permutation is the inverse of another.\n",
    "4.17 Prove that the matrix of the permutation inverse is the transpose of the matrix\nof the permutation",
    "Pφ−1 = Pφ\nT, for any permutation φ.\n\n",
    "354\nChapter Four.",
    "Determinants\n✓4.18 Show that a permutation matrix with m inversions can be row swapped to the\nidentity in m steps.",
    "Contrast this with Corollary 4.5.\n✓4.19 For any permutation φ let g(φ) be the integer deﬁned in this way.\ng(φ)",
    "=\nY\ni<j\n[φ(j) −φ(i)]\n(This is the product, over all indices i and j with i <",
    "j, of terms of the given\nform.)\n",
    "(a) Compute the value of g on all 2-permutations.\n",
    "(b) Compute the value of g on all 3-permutations.\n",
    "(c) Prove that g(φ) is not 0.\n",
    "(d) Prove this.\n",
    "sgn(φ) = g(φ)\n|g(φ)|\nMany authors give this formula as the deﬁnition of the signum function.\n\nSection II.",
    "Geometry of Determinants\n355\nII\nGeometry of Determinants\nThe prior section develops the determinant algebraically, by considering formulas\nsatisfying certain conditions.",
    "This section complements that with a geometric\napproach.",
    "Beyond its intuitive appeal, an advantage of this approach is that\nwhile we have so far only considered whether or not a determinant is zero, here\nwe shall give a meaning to the value of the determinant.",
    "(The prior section\ntreats the determinant as a function of the rows but this section focuses on\ncolumns.)\n",
    "II.1\nDeterminants as Size Functions\n",
    "This parallelogram picture is familiar from the construction of the sum of the\ntwo vectors.\n",
    "\u0012\nx1\ny1\n\u0013\n\u0012\nx2\ny2\n\u0013\n1.1 Deﬁnition In Rn the box (or parallelepiped) formed by ⟨⃗v1, . .",
    ".",
    ",⃗vn⟩is the\nset {t1⃗v1 + · · · + tn⃗vn | t1, . . .",
    ", tn ∈[0 . .",
    ".",
    "1]}.\n",
    "Thus the parallelogram above is the box formed by ⟨\n\u0000x1\ny1\n\u0001\n,\n\u0000x2\ny2\n\u0001\n⟩.",
    "A three-space\nbox is shown in Example 1.4.\n",
    "We can ﬁnd the area of the above box by drawing an enclosing rectangle and\nsubtracting away areas not in the box.\n",
    "y1\ny2\nx2\nx1\nA\nB\nC\nD\nE\nF\narea of parallelogram\n= area of rectangle −area of A −area of B\n−· · · −area of F\n= (x1 + x2)(y1 + y2) −x2y1 −x1y1/2\n−x2y2/2 −x2y2/2 −x1y1/2 −x2y1\n= x1y2 −x2y1\nThat the area equals the value of the determinant\n\f\f\f\f\f\nx1\nx2\ny1\ny2\n\f\f\f\f\f = x1y2 −x2y1\n\n356\nChapter Four.",
    "Determinants\nis no coincidence.",
    "The deﬁnition of determinants contains four properties that\nwe know lead to a unique function for each dimension n.",
    "We shall argue that\nthese properties make good postulates for a function that measures the size of\nboxes in n-space.\n",
    "For instance, such a function should have the property that multiplying one\nof the box-deﬁning vectors by a scalar will multiply the size by that scalar.\n",
    "⃗v\n⃗w\nk⃗v\n⃗w\nShown here is k = 1.4.",
    "On the right the rescaled region is in solid lines with the\noriginal region shaded for comparison.\n",
    "That is, we can reasonably expect that size(. . .",
    ", k⃗v, . . . )",
    "= k · size(. . . ,⃗v, . . . ).\n",
    "Of course, this condition is one of those in the deﬁnition of determinants.\n",
    "Another property of determinants that should apply to any function mea-\nsuring the size of a box is that it is unaﬀected by row combinations.",
    "Here are\nbefore-combining and after-combining boxes (the scalar shown is k = −0.35).\n",
    "⃗v\n⃗w\n⃗v\nk⃗v + ⃗w\nThe box formed by v and k⃗v + ⃗w slants diﬀerently than the original one but\nthe two have the same base and the same height, and hence the same area.",
    "So\nwe expect that size is not aﬀected by a shear operation size(. . .",
    ",⃗v, . . .",
    ", ⃗w, . . . )",
    "=\nsize(. . .",
    ",⃗v, . . .",
    ", k⃗v + ⃗w, . . . ).",
    "Again, this is a determinant condition.\n",
    "We expect that the box formed by unit vectors has unit size\n⃗e1\n⃗e2\nand we naturally extend that to any n-space size(⃗e1, . . .",
    ",⃗en) = 1.\n",
    "Condition (2) of the deﬁnition of determinant is redundant, as remarked\nfollowing the deﬁnition.",
    "We know from the prior section that for each n the\ndeterminant exists and is unique so we know that these postulates for size\nfunctions are consistent and that we do not need any more postulates.",
    "Therefore,\nwe are justiﬁed in interpreting det(⃗v1, . . .",
    ",⃗vn) as giving the size of the box\nformed by the vectors.\n",
    "1.2 Remark Although condition (2) is redundant it raises an important point.\n",
    "Consider these two.\n\nSection II.",
    "Geometry of Determinants\n357\n⃗u\n⃗v\n⃗u\n⃗v\n\f\f\f\f\n4\n1\n2\n3\n\f\f\f\f = 10\n\f\f\f\f\n1\n4\n3\n2\n\f\f\f\f = −10\nSwapping the columns changes the sign.\n",
    "On the left, starting with ⃗u and\nfollowing the arc inside the angle to ⃗v (that is, going counterclockwise), we get\na positive size.",
    "On the right, starting at ⃗v and going to ⃗u, and so following\nthe clockwise arc, gives a negative size.",
    "The sign returned by the size function\nreﬂects the orientation or sense of the box.",
    "(We see the same thing if we\npicture the eﬀect of scalar multiplication by a negative scalar.)\n",
    "1.3 Deﬁnition The volume of a box is the absolute value of the determinant of a\nmatrix with those vectors as columns.\n",
    "1.4 Example By the formula that takes the area of the base times the height, the\nvolume of this parallelepiped is 12.",
    "That agrees with the determinant.\n\f\f\f\f\f\f\f\n2\n0\n−1\n0\n3\n0\n2\n1\n1\n\f\f\f\f\f\f\f\n= 12\nTaking the vectors in a diﬀerent order changes the sign but not the magnitude.\n\f\f\f\f\f\f\f\n0\n2\n−1\n3\n0\n0\n1\n2\n1\n\f\f\f\f\f\f\f\n= −12\n\n358\nChapter Four.",
    "Determinants\n1.5 Theorem A transformation t:",
    "Rn →Rn changes the size of all boxes by the\nsame factor, namely, the size of the image of a box |t(S)| is |T| times the size of\nthe box |S|, where T is the matrix representing t with respect to the standard\nbasis.\n",
    "That is, the determinant of a product is the product of the determinants\n|TS| = |T| · |S|.\n",
    "The two sentences say the same thing, ﬁrst in map terms and then in matrix\nterms.",
    "This is because |t(S)| = |TS|, as both give the size of the box that is\nthe image of the unit box En under the composition t ◦s, where the maps\nare represented with respect to the standard basis.",
    "We will prove the second\nsentence.\n",
    "Proof First consider the case that T is singular and thus does not have an\ninverse.",
    "Observe that if TS is invertible then there is an M such that (TS)M = I,\nso T(SM) = I, and so T is invertible.",
    "The contrapositive of that observation is\nthat if T is not invertible then neither is TS — if |T| = 0 then |TS| = 0.\n",
    "Now consider the case that T is nonsingular.",
    "Any nonsingular matrix factors\ninto a product of elementary matrices T = E1E2 · · ·",
    "Er.",
    "To ﬁnish this argument\nwe will verify that |ES| = |E| · |S| for all matrices S and elementary matrices E.\n",
    "The result will then follow because |TS| = |E1 · · · ErS| = |E1| · · · |Er| · |S| =\n|E1 · · · Er| ·",
    "|S| = |T| · |S|.\n",
    "There are three types of elementary matrix.",
    "We will cover the Mi(k) case;\nthe Pi,j and Ci,j(k) checks are similar.",
    "The matrix Mi(k)S equals S except that\nrow i is multiplied by k. The third condition of determinant functions then\ngives that |Mi(k)S| = k · |S|.",
    "But |Mi(k)| = k, again by the third condition\nbecause Mi(k) is derived from the identity by multiplication of row i by k.",
    "Thus\n|ES| = |E| · |S| holds for E = Mi(k).\n",
    "QED\n1.6 Example Application of the map t represented with respect to the standard\nbases by\n \n1\n1\n−2\n0\n!\nwill double sizes of boxes, e.g., from this\n⃗\nw\n⃗v\n\f\f\f\f\f\n2\n1\n1\n2\n\f\f\f\f\f = 3\nto this\n\nSection II.",
    "Geometry of Determinants\n359\nt(⃗\nw)\nt(⃗v)\n\f\f\f\f\f\n3\n3\n−4\n−2\n\f\f\f\f\f = 6\n1.7 Corollary",
    "If a matrix is invertible then the determinant of its inverse is the\ninverse of its determinant |T −1| = 1/|T|.\nProof 1 = |I| = |TT −1|",
    "= |T| · |T −1|\nQED\nExercises\n1.8 Is\n\n\n4\n1\n2\n\n\ninside of the box formed by these three?\n\n\n3\n3\n1\n\n\n\n\n2\n6\n1\n\n\n\n\n1\n0\n5\n\n\n✓1.9 Find the volume of the region deﬁned by the vectors.\n",
    "(a) ⟨\n\u00121\n3\n\u0013\n,\n\u0012−1\n4\n\u0013\n⟩\n(b) ⟨\n\n\n2\n1\n0\n\n,\n\n\n3\n−2\n4\n\n,\n\n\n8\n−3\n8\n\n⟩\n(c) ⟨\n\n\n\n\n1\n2\n0\n1\n\n\n\n,\n\n\n\n\n2\n2\n2\n2\n\n\n\n,\n\n\n\n\n−1\n3\n0\n5\n\n\n\n,\n\n\n\n\n0\n1\n0\n7\n\n\n\n⟩\n✓1.10 In this picture the rectangle on the left is deﬁned by the points (3, 1) and (1, 2).\n",
    "Apply the matrix to get the rectangle on the right, deﬁned by (7, 1) and (4, 2).\n",
    "Why doesn’t this contradict Theorem 1.5?\n\u00002 1\n0 1\n\u0001\n−→\narea is 2\ndeterminant is 2\narea is 3\n✓1.11 Find the volume of this region.\n",
    "✓1.12 Suppose that |A| = 3.",
    "By what factor do these change volumes?\n\n360\nChapter Four.",
    "Determinants\n(a) A\n(b) A2\n(c) A−2\n✓1.13 Consider the linear transformation t of R3 represented with respect to the\nstandard bases by this matrix.\n\n\n1\n0\n−1\n3\n1\n1\n−1\n0\n3\n\n\n(a) Compute the determinant of the matrix.",
    "Does the transformation preserve\norientation or reverse it?\n(b) Find the size of the box deﬁned by these vectors.",
    "What is its orientation?\n\n\n1\n−1\n2\n\n\n\n\n2\n0\n−1\n\n",
    "\n\n\n1\n1\n0\n\n\n(c) Find the images under t of the vectors in the prior item and ﬁnd the size of\nthe box that they deﬁne.",
    "What is the orientation?\n1.14",
    "By what factor does each transformation change the size of boxes?\n(a)\n\u0012x\ny\n\u0013\n",
    "7→\n\u00122x\n3y\n\u0013\n(b)\n\u0012x\ny\n\u0013\n7→\n\u0012 3x −y\n−2x + y\n\u0013\n(c)\n\n\nx\ny\nz\n\n7→\n\n\nx −y\nx + y + z\ny −2z\n\n\n1.15",
    "What is the area of the image of the rectangle [2..4] ×",
    "[2..5] under the action of\nthis matrix?\n",
    "\u00122\n3\n4\n−1\n\u0013\n1.16",
    "If t: R3 →R3 changes volumes by a factor of 7 and s: R3 →R3 changes volumes\nby a factor of 3/2 then by what factor will their composition changes volumes?\n",
    "1.17 In what way does the deﬁnition of a box diﬀer from the deﬁnition of a span?\n",
    "1.18 Does |TS| = |ST|?",
    "|T(SP)| = |(TS)P|?\n1.19 Show that there are no 2×2 matrices A and B satisfying these.\n",
    "AB =\n\u00121\n−1\n2\n0\n\u0013\nBA =\n\u00122\n1\n1\n1\n\u0013\n1.20\n(a) Suppose that |A| = 3 and that |B| = 2.",
    "Find |A2 · BT · B−2 · AT|.\n",
    "(b) Assume that |A|",
    "= 0.",
    "Prove that |6A3 + 5A2",
    "+ 2A|",
    "= 0.\n",
    "✓1.21 Let T be the matrix representing (with respect to the standard bases) the map\nthat rotates plane vectors counterclockwise through θ radians.",
    "By what factor does\nT change sizes?\n✓1.22 Must a transformation t: R2 →R2 that preserves areas also preserve lengths?\n1.23 What is the volume of a parallelepiped in R3 bounded by a linearly dependent\nset?\n✓1.24 Find the area of the triangle in R3 with endpoints (1, 2, 1), (3, −1, 4), and\n(2, 2, 2).",
    "(This asks for area, not volume.",
    "The triangle deﬁnes a plane; what is the\narea of the triangle in that plane?)\n",
    "1.25",
    "An alternate proof of Theorem 1.5 uses the deﬁnition of determinant func-\ntions.\n",
    "(a) Note that the vectors forming S make a linearly dependent set if and only if\n|S| = 0, and check that the result holds in this case.\n\nSection II.",
    "Geometry of Determinants\n361\n(b) For the |S| ̸= 0 case, to show that |TS|/|S| = |T| for all transformations, consider\nthe function d: Mn×n →R given by T 7→|TS|/|S|.",
    "Show that d has the ﬁrst\nproperty of a determinant.\n",
    "(c) Show that d has the remaining three properties of a determinant function.\n",
    "(d) Conclude that |TS| = |T| · |S|.\n1.26 Give a non-identity matrix with the property that AT = A−1.",
    "Show that if\nAT = A−1 then |A| = ±1.",
    "Does the converse hold?\n",
    "1.27 The algebraic property of determinants that factoring a scalar out of a single\nrow will multiply the determinant by that scalar shows that where H is 3×3, the\ndeterminant of cH is c3 times the determinant of H. Explain this geometrically,\nthat is, using Theorem 1.5.",
    "(The observation that increasing the linear size of a\nthree-dimensional object by a factor of c will increase its volume by a factor of c3\nwhile only increasing its surface area by an amount proportional to a factor of c2\nis the Square-cube law [Wikipedia, Square-cube Law].)\n",
    "1.28 We say that matrices H and G are similar if there is a nonsingular matrix P\nsuch that H = P−1GP (we will study this relation in Chapter Five).",
    "Show that\nsimilar matrices have the same determinant.\n",
    "1.29 We usually represent vectors in R2 with respect to the standard basis so vectors\nin the ﬁrst quadrant have both coordinates positive.\n",
    "⃗v\nRepE2(⃗v) =\n\u0012+3\n+2\n\u0013\nMoving counterclockwise around the origin, we cycle through four regions:\n· · · −→\n\u0012\n+\n+\n\u0013\n−→\n\u0012\n−\n+\n\u0013\n−→\n\u0012\n−\n−\n\u0013\n−→\n\u0012\n+\n−\n\u0013\n−→· · · .\n",
    "Using this basis\nB = ⟨\n\u00120\n1\n\u0013\n,\n\u0012−1\n0\n\u0013\n⟩\n⃗β2\n⃗β1\ngives the same counterclockwise cycle.",
    "We say these two bases have the same\norientation.\n",
    "(a) Why do they give the same cycle?\n(b) What other conﬁgurations of unit vectors on the axes give the same cycle?\n",
    "(c) Find the determinants of the matrices formed from those (ordered) bases.\n",
    "(d)",
    "What other counterclockwise cycles are possible, and what are the associated\ndeterminants?\n(e) What happens in R1?\n(f)",
    "What happens in R3?\nA fascinating general-audience discussion of orientations is in [Gardner].\n",
    "1.30 This question uses material from the optional Determinant Functions Exist\nsubsection.",
    "Prove Theorem 1.5 by using the permutation expansion formula for\nthe determinant.\n✓1.31\n(a) Show that this gives the equation of a line in R2 through (x2, y2) and\n(x3, y3).\n\f\f\f\f\f\f\n",
    "x\nx2\nx3\ny\ny2\ny3\n1\n1\n1\n\f\f\f\f\f\f\n= 0\n\n362\nChapter Four.",
    "Determinants\n(b)",
    "[Petersen] Prove that the area of a triangle with vertices (x1, y1), (x2, y2), and\n(x3, y3) is\n1\n2\n\f\f\f\f\f\f\nx1\nx2\nx3\ny1\ny2\ny3\n1\n1\n1\n\f\f\f\f\f\f\n.\n",
    "(c)",
    "[Math. Mag., Jan. 1973] Prove that the area of a triangle with vertices at\n(x1, y1), (x2, y2), and (x3, y3) whose coordinates are integers has an area of N or\nN/2 for some positive integer N.\n\nSection III.",
    "Laplace’s Formula\n363\nIII\nLaplace’s Formula\nThis section is optional.\n",
    "The only later sections that depends on this\nmaterial is Five.III.\n",
    "Determinants are a font of interesting and amusing formulas.",
    "Here is one\nthat is often used to compute determinants by hand.\n",
    "III.1\nLaplace’s Expansion\nThe example shows a 3×3 case but the approach works for any size n > 1.\n1.1 Example Consider the permutation expansion.\n\f\f\f\f\f\f\f\n",
    "t1,1\nt1,2\nt1,3\nt2,1\nt2,2\nt2,3\nt3,1\nt3,2\nt3,3\n\f\f\f\f\f\f\f\n= t1,1t2,2t3,3\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t1,1t2,3t3,2\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\f\f\f\f\f\f\f\n+ t1,2t2,1t3,3\n\f\f\f\f\f\f\f\n0\n1\n0\n1\n0\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t1,2t2,3t3,1\n\f\f\f\f\f\f\f\n0\n1\n0\n0\n0\n1\n1\n0\n0\n\f\f\f\f\f\f\f\n+ t1,3t2,1t3,2\n\f\f\f\f\f\f\f\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n+ t1,3t2,2t3,1\n\f\f\f\f\f\f\f\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\f\f\f\f\f\f\f\nPick a row or column and factor out its entries; here we do the entries in the\nﬁrst row.\n",
    "= t1,1 ·\n\nt2,2t3,3\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t2,3t3,2\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\f\f\f\f\f\f\f\n\n\n+ t1,2 ·\n\nt2,1t3,3\n\f\f\f\f\f\f\f\n0\n1\n0\n1\n0\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t2,3t3,1\n\f\f\f\f\f\f\f\n0\n1\n0\n0\n0\n1\n1\n0\n0\n\f\f\f\f\f\f\f\n\n\n+ t1,3 ·\n\nt2,1t3,2\n\f\f\f\f\f\f\f\n0\n0\n1\n1\n0\n0\n0\n1\n0\n\f\f\f\f\f\f\f\n+ t2,2t3,1\n\f\f\f\f\f\f\f\n0\n0\n1\n0\n1\n0\n1\n0\n0\n\f\f\f\f\f\f\f\n\n\nIn those permutation matrices, swap to get the ﬁrst rows into place.",
    "This\nrequires one swap to each of the permutation matrices on the second line, and\ntwo swaps to each on the third line.",
    "(Recall that row swaps change the sign of\n\n364\nChapter Four.",
    "Determinants\nthe determinant.)\n",
    "= t1,1 ·\n\nt2,2t3,3\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t2,3t3,2\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\f\f\f\f\f\f\f\n\n\n−t1,2 ·\n\nt2,1t3,3\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t2,3t3,1\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\f\f\f\f\f\f\f\n\n\n+ t1,3 ·\n\nt2,1t3,2\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n1\n0\n0\n0\n1\n\f\f\f\f\f\f\f\n+ t2,2t3,1\n\f\f\f\f\f\f\f\n1\n0\n0\n0\n0\n1\n0\n1\n0\n\f\f\f\f\f\f\f\n\n\nOn each line the terms in square brackets involve only the second and third row\nand column, and simplify to a 2×2 determinant.\n",
    "= t1,1 ·\n\f\f\f\f\f\nt2,2\nt2,3\nt3,2\nt3,3\n\f\f\f\f\f −t1,2 ·\n\f\f\f\f\f\nt2,1\nt2,3\nt3,1\nt3,3\n\f\f\f\f\f + t1,3 ·\n\f\f\f\f\f\nt2,1\nt2,2\nt3,1\nt3,2\n\f\f\f\f\f\nThe formula given in Theorem 1.5, which generalizes this example, is a recur-\nrence — the determinant is expressed as a combination of determinants.",
    "This\nformula isn’t circular because it gives the n×n case in terms of smaller ones.\n",
    "1.2 Deﬁnition For any n×n matrix T, the (n −1)×(n −1) matrix formed by\ndeleting row i and column j of T is the i, j minor of T. The i, j cofactor Ti,j of\nT is (−1)i+j times the determinant of the i, j minor of T.\n1.3 Example The 1, 2 cofactor of the matrix from Example 1.1 is the negative of\nthe second 2×2 determinant.\n",
    "T1,2 = −1 ·\n\f\f\f\f\f\nt2,1\nt2,3\nt3,1\nt3,3\n\f\f\f\f\f\n1.4 Example Where\nT =\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\nthese are the 1, 2 and 2, 2 cofactors.\n",
    "T1,2 = (−1)1+2 ·\n\f\f\f\f\f\n4\n6\n7\n9\n\f\f\f\f\f = 6\nT2,2 = (−1)2+2 ·\n\f\f\f\f\f\n1\n3\n7\n9\n\f\f\f\f\f = −12\n\nSection III.",
    "Laplace’s Formula\n365\n1.5 Theorem (Laplace Expansion of Determinants)",
    "Where T is an n×n matrix, we\ncan ﬁnd the determinant by expanding by cofactors on any row i or column j.\n|T| = ti,1 · Ti,1 + ti,2 ·",
    "Ti,2 + · · · + ti,n · Ti,n\n= t1,j · T1,j + t2,j · T2,j + · · · + tn,j · Tn,j\nProof Exercise 27.\n",
    "QED\n1.6 Example",
    "We can compute the determinant\n|T| =\n\f\f\f\f\f\f\f\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\f\f\f\f\f\f\f\nby expanding along the ﬁrst row, as in Example 1.1.\n",
    "|T| = 1 · (+1)\n\f\f\f\f\f\n5\n6\n8\n9\n\f\f\f\f\f + 2 · (−1)\n\f\f\f\f\f\n4\n6\n7\n9\n\f\f\f\f\f + 3 · (+1)\n\f\f\f\f\f\n4\n5\n7\n8\n\f\f\f\f\f = −3",
    "+ 12 −9 = 0\nOr, we could expand down the second column.\n",
    "|T| = 2 · (−1)\n\f\f\f\f\f\n4\n6\n7\n9\n\f\f\f\f\f + 5 · (+1)\n\f\f\f\f\f\n1\n3\n7\n9\n\f\f\f\f\f + 8 · (−1)\n\f\f\f\f\f\n1\n3\n4\n6\n\f\f\f\f\f = 12 −60 + 48 = 0\n1.7 Example A row or column with many zeroes suggests a Laplace expansion.\n\f\f\f\f\f\f\f\n",
    "1\n5\n0\n2\n1\n1\n3\n−1\n0\n\f\f\f\f\f\f\f\n= 0 · (+1)\n\f\f\f\f\f\n2\n1\n3\n−1\n\f\f\f\f\f + 1 · (−1)\n\f\f\f\f\f\n1\n5\n3\n−1\n\f\f\f\f\f + 0 · (+1)\n\f\f\f\f\f\n1\n5\n2\n1\n\f\f\f\f\f = 16\n",
    "We ﬁnish by applying Laplace’s expansion to derive a new formula for the\ninverse of a matrix.",
    "With Theorem 1.5, we can calculate the determinant of a\nmatrix by taking linear combinations of entries from a row with their associated\ncofactors.\n",
    "ti,1 · Ti,1 + ti,2 · Ti,2 + · · · + ti,n · Ti,n = |T|\n(∗)\nRecall that a matrix with two identical rows has a zero determinant.",
    "Thus,\nweighting the cofactors by entries from row k with k ̸= i gives zero\nti,1 ·",
    "Tk,1 + ti,2 ·",
    "Tk,2 + · · · + ti,n · Tk,n = 0\n(∗∗)\nbecause it represents the expansion along the row k of a matrix with row i equal\nto row k.",
    "This summarizes (∗) and (∗∗).\n",
    "\n\n\n\n\n\nt1,1\nt1,2\n. . .\n",
    "t1,n\nt2,1\nt2,2\n. . .\n",
    "t2,n\n...\ntn,1\ntn,2\n. .",
    ".\n",
    "tn,n\n\n\n\n\n\n\n\n\n\n\n\n\nT1,1\nT2,1\n. .",
    ".\n",
    "Tn,1\nT1,2\nT2,2\n. . .\n",
    "Tn,2\n...\nT1,n\nT2,n\n. . .\n",
    "Tn,n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n|T|\n0\n. .",
    ".\n",
    "0\n0\n|T|\n. . .\n",
    "0\n...\n0\n0\n. .",
    ".\n",
    "|T|\n\n\n\n\n\n\n\n366\nChapter Four.",
    "Determinants\nNote that the order of the subscripts in the matrix of cofactors is opposite to\nthe order of subscripts in the other matrix; e.g., along the ﬁrst row of the matrix\nof cofactors the subscripts are 1, 1 then 2, 1, etc.\n1.8 Deﬁnition The matrix adjoint (or the classical adjoint or adjugate) to the\nsquare matrix T is\nadj(T) =\n\n\n\n\n\n\nT1,1\nT2,1\n. .",
    ".\n",
    "Tn,1\nT1,2\nT2,2\n. . .\n",
    "Tn,2\n...\nT1,n\nT2,n\n. . .\n",
    "Tn,n\n\n\n\n\n\n\nwhere the row i, column j entry, Tj,i, is the j, i cofactor.\n",
    "1.9 Theorem Where T is a square matrix, T · adj(T) = adj(T) ·",
    "T = |T| · I.",
    "Thus if\nT has an inverse, if |T| ̸= 0, then T −1 = (1/|T|) · adj(T).\nProof Equations (∗) and (∗∗).\n",
    "QED\n1.10 Example",
    "If\nT =\n\n\n\n1\n0\n4\n2\n1\n−1\n1\n0\n1\n\n\n\nthen adj(T) is\n\n\n\nT1,1\nT2,1\nT3,1\nT1,2\nT2,2\nT3,2\nT1,3\nT2,3\nT3,3\n\n\n=\n\n\n\n\n\n\n\n\n\n\n\n\f\f\f\f\f\n1\n−1\n0\n1\n\f\f\f\f\f\n−\n\f\f\f\f\f\n0\n4\n0\n1\n\f\f\f\f\f\n\f\f\f\f\f\n0\n4\n1\n−1\n\f\f\f\f\f\n−\n\f\f\f\f\f\n2\n−1\n1\n1\n\f\f\f\f\f\n\f\f\f\f\f\n1\n4\n1\n1\n\f\f\f\f\f\n−\n\f\f\f\f\f\n1\n4\n2\n−1\n\f\f\f\f\f\n\f\f\f\f\f\n2\n1\n1\n0\n\f\f\f\f\f\n−\n\f\f\f\f\f\n1\n0\n1\n0\n\f\f\f\f\f\n\f\f\f\f\f\n1\n0\n2\n1\n\f\f\f\f\f\n\n\n\n\n\n\n\n\n\n\n\n=\n\n\n\n1\n0\n−4\n−3\n−3\n9\n−1\n0\n1\n\n\n\nand taking the product with T gives the diagonal matrix |T| · I.\n\n\n\n1\n0\n4\n2\n1\n−1\n1\n0\n1\n\n\n\n\n\n\n1\n0\n−4\n−3\n−3\n9\n−1\n0\n1\n\n\n=\n\n\n\n−3\n0\n0\n0\n−3\n0\n0\n0\n−3\n\n\n\nThe inverse of T is (1/ −3) · adj(T).\n",
    "T −1 =\n\n\n\n1/−3\n0/−3\n−4/−3\n−3/−3\n−3/−3\n9/−3\n−1/−3\n0/−3\n1/−3\n\n\n=\n\n\n\n−1/3\n0\n4/3\n1\n1\n−3\n1/3\n0\n−1/3\n\n\n\n\nSection III.",
    "Laplace’s Formula\n367\nThe formulas from this subsection are often used for by-hand calculation\nand are sometimes useful with special types of matrices.",
    "However, for generic\nmatrices they are not the best choice because they require more arithmetic than,\nfor instance, the Gauss-Jordan method.\n",
    "Exercises\n✓1.11 Find the cofactor.\n",
    "T =\n\n\n1\n0\n2\n−1\n1\n3\n0\n2\n−1\n\n",
    "\n(a) T2,3\n(b) T3,2\n(c) T1,3\n✓1.12 Find the adjoint to this matrix.\n",
    "T =\n\n\n1\n0\n2\n−1\n1\n3\n0\n2\n−1\n\n\n1.13",
    "This determinant is 0.",
    "Compute that by expanding on the ﬁrst row.\n\f\f\f\f\f\f\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\f\f\f\f\f\f\n✓1.14 Find the determinant by expanding\n\f\f\f\f\f\f\n3\n0\n1\n1\n2\n2\n−1\n3\n0\n\f\f\f\f\f\f\n(a) on the ﬁrst row\n(b) on the second row\n(c) on the third column.\n",
    "1.15 Find the adjoint of the matrix in Example 1.6.\n",
    "✓1.16 Find the matrix adjoint to each.\n",
    "(a)\n\n\n2\n1\n4\n−1\n0\n2\n1\n0\n1\n\n\n(b)\n\u00123\n−1\n2\n4\n\u0013\n(c)\n\u00121\n1\n5\n0\n\u0013\n(d)\n\n\n1\n4\n3\n−1\n0\n3\n1\n8\n9\n\n\n✓1.17 Find the inverse of each matrix in the prior question with Theorem 1.9.\n",
    "1.18 Find the matrix adjoint to this one.\n\n\n\n\n2\n1\n0\n0\n1\n2\n1\n0\n0\n1\n2\n1\n0\n0\n1\n2\n\n\n\n\n✓1.19 Expand across the ﬁrst row to derive the formula for the determinant of a 2×2\nmatrix.\n",
    "✓1.20 Expand across the ﬁrst row to derive the formula for the determinant of a 3×3\nmatrix.\n✓1.21\n(a) Give a formula for the adjoint of a 2×2 matrix.\n",
    "(b) Use it to derive the formula for the inverse.\n",
    "✓1.22 Can we compute a determinant by expanding down the diagonal?\n\n368\nChapter Four.",
    "Determinants\n1.23 Give a formula for the adjoint of a diagonal matrix.\n",
    "✓1.24 Prove that the transpose of the adjoint is the adjoint of the transpose.\n1.25 Prove or disprove: adj(adj(T))",
    "= T.\n1.26 A square matrix is upper triangular if each i, j entry is zero in the part above\nthe diagonal, that is, when i > j.\n(a) Must the adjoint of an upper triangular matrix be upper triangular?",
    "Lower\ntriangular?\n(b) Prove that the inverse of a upper triangular matrix is upper triangular, if an\ninverse exists.\n",
    "1.27 This question requires material from the optional Determinants Exist sub-\nsection.",
    "Prove Theorem 1.5 by using the permutation expansion.\n",
    "1.28 Prove that the determinant of a matrix equals the determinant of its transpose\nusing Laplace’s expansion and induction on the size of the matrix.\n?",
    "1.29 Show that\nFn =\n\f\f\f\f\f\f\f\f\f\f\f\n1\n−1\n1\n−1\n1\n−1\n. . .\n",
    "1\n1\n0\n1\n0\n1\n. . .\n",
    "0\n1\n1\n0\n1\n0\n. .",
    ".\n",
    "0\n0\n1\n1\n0\n1\n. .",
    ".\n",
    ".\n.\n.\n.\n.\n.\n. .",
    ".\n\f\f\f\f\f\f\f\f\f\f\f\n",
    "where Fn is the n-th term of 1, 1, 2, 3, 5, . .",
    ".",
    ", x, y, x + y, . .",
    ".",
    ", the Fibonacci sequence,\nand the determinant is of order n −1.",
    "[Am.",
    "Math.",
    "Mon., Jun. 1949]\n\nTopic\nCramer’s Rule\nA linear system is equivalent to a linear relationship among vectors.\n",
    "x1 + 2x2",
    "= 6\n3x1 + x2 = 8\n⇐⇒\nx1 ·\n \n1\n3\n!\n",
    "+ x2 ·\n \n2\n1\n!\n=\n \n6\n8\n!\n",
    "In the picture below the small parallelogram is formed from the vectors\n\u00001\n3\n\u0001\nand\n\u00002\n1\n\u0001\n.",
    "It is nested inside a parallelogram with sides x1\n\u00001\n3\n\u0001\nand x2\n\u00002\n1\n\u0001\n.",
    "By the\nvector equation, the far corner of the larger parallelogram is\n\u00006\n8\n\u0001\n.\n",
    "\u00122\n1\n\u0013\n",
    "x2 ·\n\u00122\n1\n\u0013\n\u00121\n3\n\u0013\nx1 ·\n\u00121\n3\n\u0013\n\u00126\n8\n\u0013\n",
    "This drawing restates the algebraic question of ﬁnding the solution of a linear\nsystem into geometric terms: by what factors x1 and x2 must we dilate the sides\nof the starting parallelogram so that it will ﬁll the other one?\n",
    "We can use this picture, and our geometric understanding of determinants,\nto get a new formula for solving linear systems.",
    "Compare the sizes of these\nshaded boxes.\n",
    "\u00122\n1\n\u0013\n\u00121\n3\n\u0013\n",
    "\u00122\n1\n\u0013\nx1 ·\n\u00121\n3\n\u0013\n\u00122\n1\n\u0013\n\u00126\n8\n\u0013\n\n370\nChapter Four.",
    "Determinants\nThe second is deﬁned by the vectors x1\n\u00001\n3\n\u0001\nand\n\u00002\n1\n\u0001\nand one of the properties of\nthe size function — the determinant — is that therefore the size of the second\nbox is x1 times the size of the ﬁrst.",
    "The third box is derived from the second by\nshearing, adding x2\n\u00002\n1\n\u0001\nto x1\n\u00001\n3\n\u0001\nto get x1\n\u00001\n3\n\u0001\n+ x2\n\u00002\n1\n\u0001\n=\n\u00006\n8\n\u0001\n, along with\n\u00002\n1\n\u0001\n.",
    "The\ndeterminant is not aﬀected by shearing so the size of the third box equals that\nof the second.\n",
    "Taken together we have this.\n",
    "x1 ·\n\f\f\f\f\f\n1\n2\n3\n1\n\f\f\f\f\f =\n\f\f\f\f\f\nx1 · 1\n2\nx1 · 3\n1\n\f\f\f\f\f =\n\f\f\f\f\f\nx1 · 1",
    "+ x2 · 2\n2\nx1 · 3 + x2 · 1\n1\n\f\f\f\f\f =\n\f\f\f\f\f\n6\n2\n8\n1\n\f\f\f\f\f\nSolving gives the value of one of the variables.\n",
    "x1 =\n\f\f\f\f\f\n6\n2\n8\n1\n\f\f\f\f\f\n\f\f\f\f\f\n1\n2\n3\n1\n\f\f\f\f\f\n= −10\n−5 = 2\nThe generalization of this example is Cramer’s Rule: if |A| ̸= 0 then the\nsystem A⃗x",
    "= ⃗b has the unique solution xi = |Bi|/|A| where the matrix Bi is\nformed from A by replacing column i with the vector ⃗b.",
    "The proof is Exercise 3.\nFor instance, to solve this system for x2\n\n\n\n1\n0\n4\n2\n1\n−1\n1\n0\n1\n\n\n\n\n\n\nx1\nx2\nx3\n\n\n=\n\n\n\n2\n1\n−1\n\n\n\nwe do this computation.\n",
    "x2 =\n\f\f\f\f\f\f\f\n1\n2\n4\n2\n1\n−1\n1\n−1\n1\n\f\f\f\f\f\f\f\n\f\f\f\f\f\f\f\n1\n0\n4\n2\n1\n−1\n1\n0\n1\n\f\f\f\f\f\f\f\n= −18\n−3\nCramer’s Rule lets us by-eye solve systems that are small and simple.",
    "For\nexample, we can solve systems with two equations and two unknowns, or three\nequations and three unknowns, where the numbers are small integers.",
    "Such\ncases appear often enough that many people ﬁnd this formula handy.\n",
    "But using it to solving large or complex systems is not practical, either by\nhand or by a computer.",
    "A Gauss’s Method-based approach is faster.\n",
    "Exercises\n1 Use Cramer’s Rule to solve each for each of the variables.\n\n",
    "Topic: Cramer’s Rule\n371\n(a)\nx −y =\n4\n−x + 2y = −7\n(b) −2x",
    "+ y = −2\nx −2y = −2\n2 Use Cramer’s Rule to solve this system for z.\n2x",
    "+",
    "y + z = 1\n3x\n+ z = 4\nx −y −z = 2\n3 Prove Cramer’s Rule.\n",
    "4 Here is an alternative proof of Cramer’s Rule that doesn’t overtly contain any\ngeometry.",
    "Write Xi for the identity matrix with column i replaced by the vector ⃗x\nof unknowns x1, . . .",
    ", xn.\n",
    "(a) Observe that AXi = Bi.\n",
    "(b) Take the determinant of both sides.\n",
    "5 Suppose that a linear system has as many equations as unknowns, that all of\nits coeﬃcients and constants are integers, and that its matrix of coeﬃcients has\ndeterminant 1.",
    "Prove that the entries in the solution are all integers.",
    "(Remark.\n",
    "This is often used to invent linear systems for exercises.)\n",
    "6 Use Cramer’s Rule to give a formula for the solution of a two equations/two\nunknowns linear system.\n",
    "7 Can Cramer’s Rule tell the diﬀerence between a system with no solutions and one\nwith inﬁnitely many?\n8 The ﬁrst picture in this Topic (the one that doesn’t use determinants) shows a\nunique solution case.",
    "Produce a similar picture for the case of inﬁnitely many\nsolutions, and the case of no solutions.\n\n",
    "Topic\nSpeed of Calculating Determinants\nFor large matrices, ﬁnding the determinant by using row operations is typically\nmuch faster than using the permutation expansion.",
    "We make this statement\nprecise by ﬁnding how many operations each method performs.\n",
    "To compare the speed of two algorithms, we ﬁnd for each one how the time\ntaken grows as the size of its input data set grows.",
    "For instance, if we increase\nthe size of the input by a factor of ten does the time taken grow by a factor of\nten, or by a factor of a hundred, or by a factor of a thousand?",
    "That is, is the\ntime taken proportional to the size of the data set, or to the square of that size,\nor to the cube of that size, etc.?",
    "An algorithm whose time is proportional to the\nsquare is faster than one that takes time proportional to the cube.\n",
    "First consider the permutation expansion formula.\n\f\f\f\f\f\f\f\f\f\f\n",
    "t1,1\nt1,2\n. . .\n",
    "t1,n\nt2,1\nt2,2\n. . .\n",
    "t2,n\n...\ntn,1\ntn,2\n. .",
    ".\n",
    "tn,n\n\f\f\f\f\f\f\f\f\f\f\n=\nX\npermutations φ\nt1,φ(1)t2,φ(2) · · · tn,φ(n) |Pφ|\nThere are n!",
    "= n · (n −1) · · · 2 · 1 diﬀerent n-permutations so for a matrix with\nn rows this sum has n! terms (and inside each term is n-many multiplications).\n",
    "The factorial function grows quickly: when n is only 10 the expansion already\nhas 10!",
    "= 3, 628, 800 terms.",
    "Observe that growth proportional to the factorial is\nbigger than growth proportional to the square n! >",
    "n2 because multiplying the\nﬁrst two factors in n! gives n·(n−1), which for large n is approximately n2 and\nthen multiplying in more factors will make the factorial even larger.",
    "Similarly,\nthe factorial function grows faster than n3, etc.",
    "So an algorithm that uses the\npermutation expansion formula, and thus performs a number of operations at\nleast as large as the factorial of the number of rows, would be very slow.\n",
    "In contrast, the time taken by the row reduction method does not grow\nso fast.",
    "Below is a script for row reduction in the computer language Python.\n",
    "(Note: The code here is naive; for example it does not handle the case that the\n\nTopic: Speed of Calculating Determinants\n373\nm(p_row, p_row) entry is zero.",
    "Analysis of a ﬁnished version that includes all of\nthe tests and subcases is messier but would gives us roughly the same speed\nresults.)\n",
    "import random\ndef random_matrix(num_rows, num_cols):\nm =",
    "[]\nfor col in range(num_cols):\nnew_row =",
    "[]\nfor row in range(num_rows):\nnew_row.append(random.uniform(0,100))\nm.append(new_row)\nreturn m\ndef gauss_method(m):\n\"\"\"Perform Gauss's Method on m.\n",
    "This code is for illustration only\nand should not be used in practice.\n",
    "m\nlist of lists of numbers; each included list is a row\n\"\"\"\nnum_rows, num_cols = len(m), len(m[0])\nfor p_row in range(num_rows):\nfor row in range(p_row+1, num_rows):\nfactor = -m[row][p_row] / float(m[p_row][p_row])\nnew_row =",
    "[]\nfor col_num in range(num_cols):\np_entry, entry = m[p_row][col_num], m[row][col_num]\nnew_row.append(entry+factor*p_entry)\nm[row]",
    "= new_row\nreturn m\nresponse = raw_input('number of rows? ')\n",
    "num_rows = int(response)\n",
    "m = random_matrix(num_rows, num_rows)\nfor row in m:\nprint row\nM = gauss_method(m)\nprint \"-----\"\nfor row in M:\nprint row\nBesides a routine to do Gauss’s Method, this program also has a routine to\ngenerate a matrix ﬁlled with random numbers (the numbers are between 0\nand 100, to make them readable below).",
    "This program prompts a user for the\nnumber of rows, generates a random square matrix of that size, and does row\nreduction on it.\n",
    "$ python gauss_method.py\nnumber of rows?",
    "4\n[69.48033741746909, 32.393754742132586, 91.35245787350696, 87.04557918402462]\n[98.64189032145111, 28.58228108715638, 72.32273998878178, 26.310252241189257]\n[85.22896214660841, 39.93894635139987, 4.061683241757219, 70.5925099861901]\n[24.06322759315518, 26.699175587284373, 37.398583921673314, 87.42617087562161]\n-----\n[69.48033741746909, 32.393754742132586, 91.35245787350696, 87.04557918402462]\n[0.0, -17.40743803545155, -57.37120602662462, -97.2691774792963]\n[0.0, 0.0, -108.66513774392809, -37.31586824349682]\n[0.0, 0.0, 0.0, -13.678536859817994]\nInside of the gauss_method routine, for each row prow, the routine performs\nfactor · ρprow + ρrow on the rows below.",
    "For each of these rows below, this\n\n374\nChapter Four.",
    "Determinants\ninvolves operating on every entry in that row.",
    "That is a triply-nested loop.",
    "So\nthis program has a running time that is something like the cube of the number of\nrows in the matrix.",
    "(Comment.",
    "We are glossing over many issues.",
    "For example,\nwe may worry that the time taken by the program is dominated by the time\nto store and retrieve entries from memory, rather than by the row operations.\n",
    "However, development of a computation model is outside of our scope.)\n",
    "If we add this code at the bottom,\ndef do_matrix(num_rows):\ngauss_method(random_matrix(num_rows, num_rows))\n",
    "import timeit\nfor num_rows in [10,20,30,40,50,60,70,80,90,100]:\ns = \"do_matrix(\"+str(num_rows)+\")\"\nt = timeit.timeit(stmt=s, setup=\"from __main__",
    "import do_matrix\",\nnumber=100)\nprint \"num_rows=\", num_rows, \" seconds=\", t\nthen Python will time the program.",
    "Here is the output from a timed test run.\n",
    "num_rows= 10\nseconds= 0.0162539482117\nnum_rows= 20\nseconds= 0.0808238983154\nnum_rows= 30\nseconds= 0.248152971268\nnum_rows= 40\nseconds= 0.555531978607\nnum_rows= 50\nseconds= 1.05453586578\nnum_rows= 60\nseconds= 1.77881097794\nnum_rows= 70\nseconds= 2.75969099998\nnum_rows= 80\nseconds= 4.10647988319\nnum_rows= 90\nseconds= 5.81125879288\nnum_rows= 100\nseconds= 7.86893582344\nGraphing that data gives part of the curve of a cubic.\n",
    "20\n40\n60\n80\n100\n0\n1\n2\n3\n4\n5\n6\n7\n8\nFinding the fastest algorithm to compute the determinant is a topic of current\nresearch.",
    "So far, researchers have found algorithms that run in time between\nthe square and cube of the number of rows.\n",
    "The contrast between the times taken by the two determinant computation\nmethods of permutation expansion and row operations makes the point that\nalthough in principle they give the same answer, in practice we want the one\nwith the best performance.\n\n",
    "Topic: Speed of Calculating Determinants\n375\nExercises\n1 To get an idea of what happens for typical matrices we can use the ability of\ncomputer systems to generate random numbers (of course, these are only pseudo-\nrandom in that they come from an algorithm",
    "but they pass a number of reasonable\nstatistical tests for randomness).\n",
    "(a) Fill a 5×5 array with random numbers say, in the range [0 . .",
    ".",
    "1)).",
    "See if it is\nsingular.",
    "Repeat that experiment a few times.",
    "Are singular matrices frequent or\nrare in this sense?\n(b) Time your computer algebra system at ﬁnding the determinant of ten 10×10\narrays of random numbers.",
    "Find the average time per array.",
    "Repeat the prior\nitem for 20×20 arrays, 30×30 arrays, . . .",
    "100×100 arrays, and compare to the\nnumbers given above.",
    "(Notice that, when an array is singular, we can sometimes\ndecide that quickly, for instance if the ﬁrst row equals the second.",
    "In the light of\nyour answer to the ﬁrst part, do you expect that singular systems play a large\nrole in your average?)\n",
    "(c) Graph the input size versus the average time.\n",
    "2 Compute the determinant of each of these by hand using the two methods discussed\nabove.\n",
    "(a)\n\f\f\f\f\n2\n1\n5\n−3\n\f\f\f\f\n(b)\n\f\f\f\f\f\f\n3\n1\n1\n−1\n0\n5\n−1\n2\n−2\n\f\f\f\f\f\f\n(c)\n\f\f\f\f\f\f\f\f\n2\n1\n0\n0\n1\n3\n2\n0\n0\n−1\n−2\n1\n0\n0\n−2\n1\n\f\f\f\f\f\f\f\f\nCount the number of multiplications and divisions used in each case, for each of\nthe methods.\n",
    "3",
    "The use by the timing routine of do_matrix has a bug.\n",
    "That routine does\ntwo things, generate a random matrix and then do gauss_method on it, and the\ntiming number returned is for the combination.",
    "Produce code that times only the\ngauss_method routine.\n",
    "4 What 10×10 array can you invent that takes your computer the longest time to\nreduce?",
    "The shortest?\n5 Some computer language speciﬁcations requires that arrays be stored “by column,”\nthat is, the entire ﬁrst column is stored contiguously, then the second column, etc.\nDoes the code fragment given take advantage of this, or can it be rewritten to\nmake it faster, by taking advantage of the fact that computer fetches are faster\nfrom contiguous locations?\n\n",
    "Topic\nChiò’s Method\nWhen doing Gauss’s Method on a matrix that contains only integers people\noften like to keep it that way.",
    "To avoid fractions in the reduction of this matrix\nA =\n\n\n\n2\n1\n1\n3\n4\n−1\n1\n5\n1\n\n\n\nthey may start by multiplying the lower rows by 2\n2ρ2\n−→\n2ρ3\n\n\n\n2\n1\n1\n6\n8\n−2\n2\n10\n2\n\n\n\n(∗)\n",
    "so that elimination in the ﬁrst column goes like this.\n",
    "−3ρ1+ρ2\n−→\n−ρ1+ρ3\n\n\n\n2\n1\n1\n0\n5\n−5\n0\n8\n0\n\n\n\n(∗∗)\n",
    "This all-integer approach is easier for mental calculations.",
    "And, using integer\narithmetic on a computer avoids some sticky issues involving ﬂoating point\ncalculations [Kahan].",
    "So there are sound reasons for this approach.\n",
    "Another advantage of this approach is that we can easily apply Laplace’s ex-\npansion to the ﬁrst column of (∗∗) and then get the determinant by remembering\nto divide by 4 because of (∗).\n",
    "Here is the general 3×3 case of this approach to ﬁnding the determinant.\n",
    "First, assuming a1,1 ̸= 0, we can rescale the lower rows.\n",
    "A =\n\n\n\na1,1\na1,2\na1,3\na2,1\na2,2\na2,3\na3,1\na3,2\na3,3\n\n\n\na1,1ρ2\n−→\na1,1ρ3\n\n\n\na1,1\na1,2\na1,3\na2,1a1,1\na2,2a1,1\na2,3a1,1\na3,1a1,1\na3,2a1,1\na3,3a1,1\n\n\n\n\nTopic: Chiò’s Method\n377\n",
    "This rescales the determinant by a2\n1,1.",
    "Now eliminate down the ﬁrst column.\n",
    "−a2,1ρ1+ρ2\n−→\n−a3,1ρ1+ρ3\n\n\n\na1,1\na1,2\na1,3\n0\na2,2a1,1 −a2,1a1,2\na2,3a1,1 −a2,1a1,3\n0\na3,2a1,1 −a3,1a1,2\na3,3a1,1 −a3,1a1,3\n\n\n\nLet C be the 1, 1 minor.",
    "By Laplace the determinant of the above matrix is\na1,1 det(C).",
    "We thus have a2\n1,1 det(A) = a1,1 det(C) and since a1,1 ̸= 0 this\ngives det(A) = det(C)/a1,1.\n",
    "To do larger matrices we must see how to compute the minor’s entries.",
    "The\npattern above is that each element of the minor is a 2×2 determinant.",
    "For\ninstance, the entry in the minor’s upper left a2,2a1,1 −a2,1a1,2, which is the\n2, 2 entry in the above matrix, is the determinant of the matrix of these four\nelements of A.\n\n\n\na1,1\na1,2\na1,3\na2,1\na2,2\na2,3\na3,1\na3,2\na3,3\n\n\n\nAnd the minor’s lower left, the 3, 2 entry from above, is the determinant of the\nmatrix of these four.\n\n\n\na1,1\na1,2\na1,3\na2,1\na2,2\na2,3\na3,1\na3,2\na3,3\n\n\n\nSo, where A is n×n for n ⩾3, we let Chiò’s matrix C be the (n−1)×(n−1)\nmatrix whose i, j entry is the determinant\n\f\f\f\f\f\na1,1\na1,j+1\nai+1,1\nai+1,j+1\n\f\f\f\f\f\nwhere 1 < i, j ⩽n.",
    "Chiò’s method for ﬁnding the determinant of A is that if\na1,1 ̸= 0 then det(A) = det(C)/an−2\n1,1 .",
    "(By the way, nothing in Chiò’s formula\nrequires that the numbers be integers; it applies to reals as well.)\n",
    "To illustrate we ﬁnd the determinant of this 3×3 matrix.\n",
    "A =\n\n\n\n2\n1\n1\n3\n4\n−1\n1\n5\n1\n\n\n\n",
    "This is Chiò’s matrix.\n",
    "C =\n\n\n\n\n\n\n\n\f\f\f\f\f\n2\n1\n3\n4\n\f\f\f\f\f\n\f\f\f\f\f\n2\n1\n3\n−1\n\f\f\f\f\f\n\f\f\f\f\f\n2\n1\n1\n5\n\f\f\f\f\f\n\f\f\f\f\f\n2\n1\n1\n1\n\f\f\f\f\f\n\n\n\n\n\n\n\n=\n \n5\n−5\n9\n1\n!\n\n378\nChapter Four.",
    "Determinants\nThe formula for 3×3 matrices det(A) = det(C)/a1,1 gives det(A) = (50/2) = 25.\n",
    "For a larger determinant we must do multiple steps but each involves only\n2×2 determinants.",
    "So we can often calculate the determinant just by writing\ndown a bit of intermediate information.",
    "For instance, with this 4×4 matrix\nA =\n\n\n\n\n\n3\n0\n1\n1\n1\n2\n0\n1\n2\n−1\n0\n3\n1\n0\n0\n1\n\n\n\n\n\nwe can mentally doing each of the 2×2 calculations and only write down the\n3×3 result.\n",
    "C3 =\n\n\n\n\n\n\n\n\n\n\n\n\n\f\f\f\f\f\n3\n0\n1\n2\n\f\f\f\f\f\n\f\f\f\f\f\n3\n1\n1\n0\n\f\f\f\f\f\n\f\f\f\f\f\n3\n1\n1\n1\n\f\f\f\f\f\n\f\f\f\f\f\n3\n0\n2\n−1\n\f\f\f\f\f\n\f\f\f\f\f\n3\n1\n2\n0\n\f\f\f\f\f\n\f\f\f\f\f\n3\n1\n2\n3\n\f\f\f\f\f\n\f\f\f\f\f\n3\n0\n1\n0\n\f\f\f\f\f\n\f\f\f\f\f\n3\n1\n1\n0\n\f\f\f\f\f\n\f\f\f\f\f\n3\n1\n1\n1\n\f\f\f\f\f\n\n\n\n\n\n\n\n\n\n\n\n\n=\n\n\n\n6\n−1\n2\n−3\n−2\n7\n0\n−1\n2\n\n\n\nNote that the determinant of this is a4−2\n1,1 = 32 times the determinant of A.\nTo ﬁnish, iterate.",
    "Here is Chiò’s matrix of C3.\n",
    "C2 =\n\n\n\n\n\n\n\n\f\f\f\f\f\n6\n−1\n−3\n−2\n\f\f\f\f\f\n\f\f\f\f\f\n6\n2\n−3\n7\n\f\f\f\f\f\n\f\f\f\f\f\n6\n−1\n0\n−1\n\f\f\f\f\f\n\f\f\f\f\f\n6\n2\n0\n2\n\f\f\f\f\f\n\n\n\n\n\n\n\n=\n \n−15\n48\n−6\n12\n!\n",
    "The determinant of this matrix is 6 times the determinant of C3.",
    "The determinant\nof C2 is 108.",
    "So det(A) = 108/(32 · 6) = 2.\nLaplace’s expansion formula reduces the calculation of an n×n determinant\nto the evaluation of a number of (n −1)×(n −1) ones.",
    "Chiò’s formula is\nalso recursive but it reduces an n×n determinant to a single (n −1)×(n −1)\ndeterminant, calculated from a number of 2×2 determinants.",
    "However, for large\nmatrices Gauss’s Method is better than either of these; for instance, it takes\nroughly half as many operations as Chiò’s Method [Fuller & Logan].\n",
    "Exercises\n1 Use Chiò’s Method to ﬁnd each determinant.\n\n",
    "Topic: Chiò’s Method\n379\n(a)\n\f\f\f\f\f\f\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\f\f\f\f\f\f\n(b)\n\f\f\f\f\f\f\f\f\n2\n1\n4\n0\n0\n1\n4\n0\n1\n1\n1\n1\n0\n2\n1\n1\n\f\f\f\f\f\f\f\f\n2",
    "What if a1,1 is zero?\n",
    "3",
    "The Rule of Sarrus is a mnemonic that many people learn for the 3×3 determinant\nformula.",
    "To the right of the matrix, copy the ﬁrst two columns.\na\nb\nc\na\nb\nd\ne\nf\nd\ne\ng\nh\ni\ng\nh\nThen the determinant is the sum of the three upper-left to lower-right diagonals\nminus the three lower-left to upper-right diagonals aei+bfg+cdh−gec−hfa−idb.\nCount the operations involved in Sarrus’s formula and in Chiò’s.\n",
    "4 Prove Chiò’s formula.\n",
    "Computer Code\nThis implements Chiò’s Method.",
    "It is in the computer language Python.\n",
    "#!/usr/bin/python\n# chio.py\n#\nCalculate a determinant using Chio's method.\n",
    "# Jim Hefferon; Public Domain\n# For demonstration only; for instance, does not handle the M[0][0]=0 case\ndef det_two(a,b,c,d):\n\"\"\"Return the determinant of the 2x2 matrix",
    "[[a,b], [c,d]]\"\"\"\nreturn a*d-b*c\ndef chio_mat(M):\n",
    "\"\"\"Return the Chio matrix as a list of the rows\nM\nnxn matrix, list of rows\"\"\"\ndim=len(M)\nC=[]\nfor row in range(1,dim):\nC.append([])\nfor col in range(1,dim):\nC[-1].append(det_two(M[0][0], M[0][col], M[row][0], M[row][col]))\nreturn C\ndef chio_det(M,show=None):\n\"\"\"Find the determinant of M by Chio's method\nM\nmxm matrix, list of rows\"\"\"\ndim=len(M)\nkey_elet=M[0][0]\nif dim==1:\nreturn key_elet\nreturn chio_det(chio_mat(M))/(key_elet**(dim-2))\n",
    "if __name__=='__main__':\nM=[[2,1,1], [3,4,-1], [1,5,1]]\nprint \"M=\",M\nprint \"Det is\", chio_det(M)\n",
    "This is the result of calling the program from a command line.\n$ python chio.py\nM=[[2, 1, 1], [3, 4, -1], [1, 5, 1]]\nDet is 25\n\nTopic\nProjective Geometry\nThere are geometries other than the familiar Euclidean one.",
    "One such geometry\narose when artists observed that what a viewer sees is not necessarily what is\nthere.",
    "As an example, here is Leonardo da Vinci’s The Last Supper.\n",
    "Look at where the ceiling meets the left and right walls.",
    "In the room those lines\nare parallel but da Vinci has painted lines that, if extended, would intersect.\n",
    "The intersection is the vanishing point.",
    "This aspect of perspective is familiar\nas an image of railroad tracks that appear to converge at the horizon.\n",
    "Da Vinci has adopted a model of how we see.",
    "Imagine a person viewing a\nroom.",
    "From the person’s eye, in every direction, carry a ray outward until it\nintersects something, such as a point on the line where the wall meets the ceiling.\n",
    "This ﬁrst intersection point is what the person sees in that direction.",
    "Overall\nwhat the person sees is the collection of three-dimensional intersection points\nprojected to a common two dimensional image.\n",
    "A\nB\nC\n\nTopic: Projective Geometry\n381\n",
    "This is a central projection from a single point.",
    "As the sketch shows, this\nprojection is not orthogonal like the ones we have seen earlier because the line\nfrom the viewer to C is not orthogonal to the image plane.",
    "(This model is only\nan approximation — it does not take into account such factors as that we have\nbinocular vision or that our brain’s processing greatly aﬀects what we perceive.\n",
    "Nonetheless the model is interesting, both artistically and mathematically.)\n",
    "The operation of central projection preserves some geometric properties, for\ninstance lines project to lines.",
    "However, it fails to preserve some others.",
    "One\nexample is that equal length segments can project to segments of unequal length\n(above, AB is longer than BC because the segment projected to AB is closer to\nthe viewer and closer things look bigger).",
    "The study of the eﬀects of central\nprojections is projective geometry.\n",
    "There are three cases of central projection.",
    "The ﬁrst is the projection done\nby a movie projector.\n",
    "projector P\nsource S\nimage I\nWe can think that each source point is pushed from the domain plane S outward\nto the image plane I.",
    "The second case of projection is that of the artist pulling\nthe source back to a canvas.\n",
    "painter P\nimage I\nsource S\nThe two are diﬀerent because ﬁrst S is in the middle and then I. One more\nconﬁguration can happen, with P in the middle.",
    "An example of this is when we\nuse a pinhole to shine the image of a solar eclipse onto a paper.\n\n",
    "382\nChapter Four.",
    "Determinants\nsource S\npinhole P\nimage I\nAlthough the three are not exactly the same, they are similar.",
    "We shall say\nthat each is a central projection by P of S to I.",
    "We next look at three models of\ncentral projection, of increasing abstractness but also of increasing uniformity.\n",
    "The last model will bring out the linear algebra.\n",
    "Consider again the eﬀect of railroad tracks that appear to converge to a point.\n",
    "Model this with parallel lines in a domain plane S and a projection via a P to\na codomain plane I.",
    "(The gray lines shown are parallel to the S plane and to\nthe I plane.)\n",
    "S\nI\nP\n",
    "This single setting shows all three projection cases.",
    "The ﬁrst picture below shows\nP acting as a movie projector by pushing points from part of S out to image\npoints on the lower half of I.",
    "The middle picture shows P acting as the artist by\npulling points from another part of S back to image points in the middle of I.\n",
    "In the third picture P acts as the pinhole, projecting points from S to the upper\npart of I.",
    "This third picture is the trickiest — the points that are projected near\nto the vanishing point are the ones that are far out on the lower left of S. Points\nin S that are near to the vertical gray line are sent high up on I.\nS\nI\nP\nS\nI\nP\nS\nI\nP\n\nTopic: Projective Geometry\n383\nThere are two awkward things here.",
    "First, neither of the two points in the\ndomain nearest to the vertical gray line (see below) has an image because a\nprojection from those two is along the gray line that is parallel to the codomain\nplane (we say that these two are projected to inﬁnity).",
    "The second is that the\nvanishing point in I isn’t the image of any point from S because a projection to\nthis point would be along the gray line that is parallel to the domain plane (we\nsay that the vanishing point is the image of a projection from inﬁnity).\n",
    "S\nI\nP\nFor a model that eliminates this awkwardness, cover the projector P with\na hemispheric dome.",
    "In any direction, deﬁned by a line through the origin,\nproject anything in that direction to the single spot on the dome where the line\nintersects.",
    "This includes projecting things such as Q1 on the line between P and\nthe dome, as with the movie projector.",
    "It includes projecting things such as Q2\non the line further from P than the dome, as with the painter.",
    "More subtly, it\nalso includes projecting things such as Q3 that lie behind P, as with the pinhole.\n",
    "ℓ= {k ·\n\n\n1\n2\n3\n\n|",
    "k ∈R}\nQ1\nQ2\nQ3\nMore formally, for any nonzero vector ⃗v ∈R3, let the associated point v in the\nprojective plane be the set {k⃗v | k ∈R and k ̸= 0} of nonzero vectors lying on\nthe same line through the origin as ⃗v.",
    "To describe a projective point we can give\nany representative member of the line, so that the projective point shown above\ncan be represented in any of these three ways.\n",
    "\n\n\n1\n2\n3\n\n\n\n\n\n\n1/3\n2/3\n1\n\n\n\n\n\n\n−2\n−4\n−6\n\n\n\nEach of these is a homogeneous coordinate vector for the point ℓ.\n\n384\nChapter Four.",
    "Determinants\nThis picture and deﬁnition clariﬁes central projection but there is still\nsomething ungainly about the dome model: what happens when P looks down?\nConsider, in the sketch above, the part of P’s line of sight that comes up towards\nus, out of the page.",
    "Imagine that this part of the line falls, to the equator and\nbelow.",
    "Now the part of the line ℓthat intersects the dome lies behind the page.\n",
    "That is, as the line of sight continues down past the equator, the projective\npoint suddenly shifts from the front of the dome to the back of the dome.",
    "(This\nbrings out that the dome does not include the entire equator or else when the\nviewer is looking exactly along the equator then there would be two points in the\nline that are both on the dome.",
    "Instead we deﬁne the dome so that it includes\nthe points on the equator with a positive y coordinate, as well as the point\nwhere y = 0",
    "and x is positive.)",
    "This discontinuity means that we often have to\ntreat equatorial points as a separate case.",
    "So while the railroad track model of\ncentral projection has three cases, the dome has two.\n",
    "We can do better, we can reduce to a model having a single case.",
    "Consider a\nsphere centered at the origin.",
    "Any line through the origin intersects the sphere\nin two spots, said to be antipodal.",
    "Because we associate each line through\nthe origin with a point in the projective plane, we can draw such a point as a\npair of antipodal spots on the sphere.",
    "Below, we show the two antipodal spots\nconnected by a dotted line to emphasize that they are not two diﬀerent points,\nthe pair of spots together make one projective point.\n",
    "While drawing a point as a pair of antipodal spots on the sphere is not as intuitive\nas the one-spot-per-point dome mode, on the other hand the awkwardness of\nthe dome model is gone in that as a line of view slides from north to south, no\nsudden changes happen.",
    "This central projection model is uniform.\n",
    "So far we have described points in projective geometry.",
    "What about lines?\n",
    "What a viewer P at the origin sees as a line is shown below as a great circle, the\nintersection of the model sphere with a plane through the origin.\n\n",
    "Topic: Projective Geometry\n385\n(We’ve included one of the projective points on this line to bring out a subtlety.\n",
    "Because two antipodal spots together make up a single projective point, the\ngreat circle’s behind-the-paper part is the same set of projective points as its\nin-front-of-the-paper part.)",
    "Just as we did with each projective point, we can\nalso describe a projective line with a triple of reals.",
    "For instance, the members\nof this plane through the origin in R3\n{\n\n\n\nx\ny\nz\n\n\n|",
    "x + y −z = 0}\nproject to a line that we can describe with (1 1 −1) (using a row vector for\nthis typographically distinguishes lines from points).",
    "In general, for any nonzero\nthree-wide row vector ⃗L we deﬁne the associated line in the projective plane,\nto be the set L = {k⃗L | k ∈R and k ̸= 0}.\n",
    "The reason this description of a line as a triple is convenient is that in\nthe projective plane a point v and a line L are incident — the point lies on\nthe line, the line passes through the point — if and only if a dot product of\ntheir representatives v1L1 + v2L2 + v3L3 is zero (Exercise 4 shows that this is\nindependent of the choice of representatives ⃗v and ⃗L).",
    "For instance, the projective\npoint described above by the column vector with components 1, 2, and 3 lies\nin the projective line described by (1 1 −1), simply because any vector in R3\nwhose components are in ratio 1 : 2 : 3 lies in the plane through the origin whose\nequation is of the form k ·",
    "x + k · y −k · z = 0 for any nonzero k.",
    "That is, the\nincidence formula is inherited from the three-space lines and planes of which v\nand L are projections.\n",
    "With this, we can do analytic projective geometry.",
    "For instance, the projective\nline L = (1 1 −1) has the equation 1v1 + 1v2 −1v3 = 0, meaning that for any\nprojective point v incident with the line, any of v’s representative homogeneous\ncoordinate vectors will satisfy the equation.",
    "This is true simply because those\nvectors lie on the three space plane.",
    "One diﬀerence from Euclidean analytic\ngeometry is that in projective geometry besides talking about the equation of a\nline, we also talk about the equation of a point.",
    "For the ﬁxed point\nv =\n\n\n\n1\n2\n3\n\n\n\nthe property that characterizes lines incident on this point is that the components\nof any representatives satisfy 1L1",
    "+ 2L2 + 3L3 = 0",
    "and so this is the equation of\nv.\n\n386\nChapter Four.",
    "Determinants\nThis symmetry of the statements about lines and points is the Duality\nPrinciple of projective geometry: in any true statement, interchanging ‘point’\nwith ‘line’ results in another true statement.",
    "For example, just as two distinct\npoints determine one and only one line, in the projective plane two distinct lines\ndetermine one and only one point.",
    "Here is a picture showing two projective lines\nthat cross in antipodal spots and thus cross at one projective point.\n",
    "(∗)\nContrast this with Euclidean geometry, where two unequal lines may have a\nunique intersection or may be parallel.",
    "In this way, projective geometry is\nsimpler, more uniform, than Euclidean geometry.\n",
    "That simplicity is relevant because there is a relationship between the two\nspaces: we can view the projective plane as an extension of the Euclidean plane.\n",
    "Draw the sphere model of the projective plane as the unit sphere in R3.",
    "Take\nEuclidean 2-space to be the plane z = 1.",
    "As shown below, all of the points on the\nEuclidean plane are projections of antipodal spots from the sphere.",
    "Conversely,\nwe can view some points in the projective plane as corresponding to points in\nEuclidean space.",
    "(Note that projective points on the equator don’t correspond\nto points on the Euclidean plane; instead we say these project out to inﬁnity.)\n(∗∗)\n",
    "Thus we can think of projective space as consisting of the Euclidean plane with\nsome extra points adjoined — the Euclidean plane is embedded in the projective\nplane.",
    "The extra points in projective space, the equatorial points, are called\nideal points or points at inﬁnity and the equator is called the ideal line or\nline at inﬁnity (it is not a Euclidean line, it is a projective line).\n",
    "The advantage of this extension from the Euclidean plane to the projective\nplane is that some of the nonuniformity of Euclidean geometry disappears.",
    "For\ninstance, the projective lines shown above in (∗) cross at antipodal spots, a\nsingle projective point.",
    "If we put those lines into (∗∗) then they correspond to\nEuclidean lines that are parallel.",
    "That is, in moving from the Euclidean plane to\n\nTopic: Projective Geometry\n387\nthe projective plane, we move from having two cases, that distinct lines either\nintersect or are parallel, to having only one case, that distinct lines intersect\n(possibly at a point at inﬁnity).\n",
    "A disadvantage of the projective plane is that we don’t have the same\nfamiliarity with it as we have with the Euclidean plane.",
    "Doing analytic geometry\nin the projective plane helps because the equations lead us to the right conclusions.\n",
    "Analytic projective geometry uses linear algebra.",
    "For instance, for three points\nof the projective plane t, u, and v, setting up the equations for those points by\nﬁxing vectors representing each shows that the three are collinear if and only\nif the resulting three-equation system has inﬁnitely many row vector solutions\nrepresenting their line.",
    "That in turn holds if and only if this determinant is zero.\n\f\f\f\f\f\f\f\n",
    "t1\nu1\nv1\nt2\nu2\nv2\nt3\nu3\nv3\n\f\f\f\f\f\f\f\n",
    "Thus, three points in the projective plane are collinear if and only if any three\nrepresentative column vectors are linearly dependent.",
    "Similarly, by duality, three\nlines in the projective plane are incident on a single point if and only if any\nthree row vectors representing them are linearly dependent.\n",
    "The following result is more evidence of the niceness of the geometry of\nthe projective plane.",
    "These two triangles are in perspective from the point O\nbecause their corresponding vertices are collinear.\n",
    "O\nT1\nU1\nV1\nT2\nU2\nV2\nConsider the pairs of corresponding sides: the sides T1U1 and T2U2, the sides\nT1V1 and T2V2, and the sides U1V1 and U2V2.",
    "Desargue’s",
    "Theorem is that\nwhen we extend the three pairs of corresponding sides, they intersect (shown\nhere as the points TU, TV, and UV).",
    "What’s more, those three intersection\npoints are collinear.\n",
    "TU\nTV\nUV\n\n388\nChapter Four.",
    "Determinants\nWe will prove this using projective geometry.",
    "(We’ve drawn Euclidean ﬁgures\nbecause that is the more familiar image.",
    "To consider them as projective ﬁgures\nwe can imagine that, although the line segments shown are parts of great circles\nand so are curved, the model has such a large radius compared to the size of the\nﬁgures that the sides appear in our sketch to be straight.)\n",
    "For the proof we need a preliminary lemma",
    "[Coxeter]: if W, X, Y, Z are four\npoints in the projective plane, no three of which are collinear, then there are\nhomogeneous coordinate vectors ⃗w, ⃗x, ⃗y, and ⃗z for the projective points, and a\nbasis B for R3, satisfying this.\n",
    "RepB(⃗w)",
    "=\n\n\n\n1\n0\n0\n\n\n\nRepB(⃗x) =\n\n\n\n0\n1\n0\n\n\n\nRepB(⃗y) =\n\n\n\n0\n0\n1\n\n\n\nRepB(⃗z) =\n\n\n\n1\n1\n1\n\n\n\nTo prove the lemma, because W, X, and Y are not on the same projective line,\nany homogeneous coordinate vectors ⃗w0, ⃗x0, and ⃗y0 do not line on the same\nplane through the origin in R3 and so form a spanning set for R3.",
    "Thus any\nhomogeneous coordinate vector for Z is a combination ⃗z0 = a· ⃗w0 +b·⃗x0 +c·⃗y0.\n",
    "Then let the basis be B = ⟨⃗w,⃗x,⃗y⟩and take ⃗w = a · ⃗w0, ⃗x = b · ⃗x0, ⃗y = c · ⃗y0,\nand ⃗z = ⃗z0.\n",
    "To prove Desargue’s Theorem use the lemma to ﬁx homogeneous coordinate\nvectors and a basis.\n",
    "RepB(⃗t1) =\n\n\n\n1\n0\n0\n\n\n\nRepB(⃗u1) =\n\n\n\n0\n1\n0\n\n\n\nRepB(⃗v1) =\n\n\n\n0\n0\n1\n\n\n\nRepB(⃗o) =\n\n\n\n1\n1\n1\n\n\n\n",
    "The projective point T2 is incident on the projective line OT1 so any homogeneous\ncoordinate vector for T2 lies in the plane through the origin in R3 that is spanned\nby homogeneous coordinate vectors of O and T1:\nRepB(⃗t2) = a\n\n\n\n1\n1\n1\n\n\n+ b\n",
    "\n\n\n1\n0\n0\n\n\n\nfor some scalars a and b.",
    "Hence the homogeneous coordinate vectors of members\nT2 of the line OT1 are of the form on the left below.",
    "The forms for U2 and V2\nare similar.\n",
    "RepB(⃗t2) =\n\n\n\nt2\n1\n1\n\n\n\nRepB(⃗u2) =\n\n\n\n1\nu2\n1\n\n\n\nRepB(⃗v2) =\n\n\n\n1\n1\nv2\n\n\n\n\nTopic: Projective Geometry\n389\n",
    "The projective line T1U1 is the projection of a plane through the origin in R3.\n",
    "One way to get its equation is to note that any vector in it is linearly dependent\non the vectors for T1 and U1 and so this determinant is zero.\n\f\f\f\f\f\f\f\n1\n0\nx\n0\n1\ny\n0\n0\nz\n\f\f\f\f\f\f\f\n= 0\n=⇒\nz = 0\nThe equation of the plane in R3 whose image is the projective line T2U2 is this.\n\f\f\f\f\f\f\f\n",
    "t2\n1\nx\n1\nu2\ny\n1\n1\nz\n\f\f\f\f\f\f\f\n= 0\n=⇒\n(1 −u2) ·",
    "x + (1 −t2) ·",
    "y + (t2u2 −1) ·",
    "z = 0\nFinding the intersection of the two is routine.\n",
    "T1U1 ∩T2U2 =\n\n\n\nt2 −1\n1 −u2\n0\n\n\n\n(This is, of course, a homogeneous coordinate vector of a projective point.)",
    "The\nother two intersections are similar.\n",
    "T1V1 ∩T2V2 =\n\n\n\n1 −t2\n0\nv2 −1\n\n\n\nU1V1 ∩U2V2 =\n\n\n\n0\nu2 −1\n1 −v2\n\n\n\nFinish the proof by noting that these projective points are on one projective\nline because the sum of the three homogeneous coordinate vectors is zero.\n",
    "Every projective theorem has a translation to a Euclidean version, although\nthe Euclidean result may be messier to state and prove.",
    "Desargue’s theorem\nillustrates this.",
    "In the translation to Euclidean space, we must treat separately\nthe case where O lies on the ideal line, for then the lines T1T2, U1U2, and V1V2\nare parallel.\n",
    "The remark following the statement of Desargue’s Theorem suggests thinking\nof the Euclidean pictures as ﬁgures from projective geometry for a sphere model\nwith very large radius.",
    "That is, just as a small area of the world seems to people\nliving there to be ﬂat, the projective plane is locally Euclidean.\n",
    "We ﬁnish by describing one more thing about the projective plane.",
    "Although\nits local properties are familiar, the projective plane has a perhaps unfamiliar\nglobal property.\n",
    "The picture below shows a projective point.\n",
    "As we have\ndescribed above, it is made up of two antipodal spots, Q1 and Q2, but it is a\nsingle point in the projective plane.",
    "At that point we have drawn Cartesian\n\n390\nChapter Four.",
    "Determinants\naxes, xy-axes.",
    "These axes appear in the picture at both antipodal spots, one in\nthe northern hemisphere at Q1 and the other in the south at Q2.",
    "Observe that\nin the northern hemisphere the positive x axis points to the right.",
    "That is, a\nperson who puts their right hand on the sphere, palm down, with their thumb\non the y axis will have their ﬁngers pointing with the positive x-axis.\n",
    "Q1\nQ2\n",
    "The sequence of pictures below show a trip around this space along the projective\nline: Q1 moves up and over the north pole, ending on the far side of the sphere,\nand its companion Q2 comes to the front.",
    "(Be careful: this trip is not halfway\naround the projective plane.",
    "It is a full circuit.",
    "The antipodal spots at either\nend of the dotted line form a single projective point.",
    "So by the third picture\nthe trip has pretty much returned to the same projective point where it started\nfrom.)\nQ1\nQ2\n=⇒\nQ1\nQ2\n=⇒\nQ1\nQ2\nAt the end of the circuit, the x part of the xy-axes sticks out in the other\ndirection.",
    "That is, for a person to put their thumb on the y-axis and have\ntheir ﬁngers point positively on the x-axis, they must use their left hand.",
    "The\nprojective plane is not orientable — in this geometry, left and right handedness\nare not ﬁxed properties of ﬁgures.",
    "For instance, we cannot describe a spiral as\nclockwise or counterclockwise.\n",
    "This exhibition of the existence of a non-orientable space raises the question\nof whether our universe orientable.",
    "Could an astronaut leave earth right-handed\nand return left-handed?",
    "[Gardner] is a nontechnical reference.",
    "[Clarke] is a\nclassic science ﬁction story about orientation reversal.\n",
    "For an overview of projective geometry see [Courant & Robbins].",
    "The ap-\nproach we’ve taken here, the analytic approach, leads to quick theorems and\nillustrates the power of linear algebra; see [Hanes], [Ryan], and [Eggar].",
    "But\nanother approach, the synthetic approach of deriving the results from an axiom\nsystem, is both extraordinarily beautiful and is also the historical route of\ndevelopment.",
    "Two ﬁne sources for this approach are [Coxeter] or",
    "[Seidenberg].\n",
    "An easy and interesting application is in [Davies].\n\n",
    "Topic: Projective Geometry\n391\nExercises\n1",
    "What is the equation of this point?\n\n\n1\n0\n0\n\n\n2\n(a) Find the line incident on these points in the projective plane.\n",
    "\n\n1\n2\n3\n\n,\n\n\n4\n5\n6\n\n\n(b) Find the point incident on both of these projective lines.\n",
    "(1 2 3), (4 5 6)\n",
    "3 Find the formula for the line incident on two projective points.",
    "Find the formula\nfor the point incident on two projective lines.\n",
    "4 Prove that the deﬁnition of incidence is independent of the choice of the rep-\nresentatives of p and L.",
    "That is, if p1, p2, p3, and q1, q2, q3 are two triples of\nhomogeneous coordinates for p, and L1, L2, L3, and M1, M2, M3 are two triples of\nhomogeneous coordinates for L, prove that p1L1 + p2L2 + p3L3 = 0 if and only if\nq1M1 + q2M2 + q3M3 = 0.\n",
    "5 Give a drawing to show that central projection does not preserve circles, that a\ncircle may project to an ellipse.",
    "Can a (non-circular) ellipse project to a circle?\n6 Give the formula for the correspondence between the non-equatorial part of the\nantipodal modal of the projective plane, and the plane z = 1.\n7 (Pappus’s Theorem) Assume that T0, U0, and V0 are collinear and that T1, U1,\nand V1 are collinear.",
    "Consider these three points: (i) the intersection V2 of the lines\nT0U1 and T1U0, (ii) the intersection U2 of the lines T0V1 and T1V0, and (iii) the\nintersection T2 of U0V1 and U1V0.\n",
    "(a) Draw a (Euclidean) picture.\n",
    "(b) Apply the lemma used in Desargue’s Theorem to get simple homogeneous\ncoordinate vectors for the T’s and V0.\n",
    "(c) Find the resulting homogeneous coordinate vectors for U’s (these must each\ninvolve a parameter as, e.g., U0 could be anywhere on the T0V0 line).\n",
    "(d) Find the resulting homogeneous coordinate vectors for V1.",
    "(Hint: it involves\ntwo parameters.)\n",
    "(e) Find the resulting homogeneous coordinate vectors for V2.",
    "(It also involves\ntwo parameters.)\n",
    "(f) Show that the product of the three parameters is 1.\n(g) Verify that V2 is on the T2U2 line.\n\n",
    "Topic\nComputer Graphics\nThe prior topic on Projective Geometry gives this model of how our eye, or a\ncamera, sees the world.\n",
    "ℓ= {k ·\n\n\n1\n2\n3\n\n|",
    "k ∈R}\nQ1\nQ2\nQ3\nAll of the points on a line through the origin project to the same spot.\n",
    "In that topic we deﬁned that for any nonzero vector ⃗v ∈R3, the associated\npoint p in the projective plane is the set {k⃗v | k ∈R and k ̸= 0}.",
    "This is the\ncollection of nonzero vectors lying on the same line through the origin as ⃗v.\n",
    "To describe a projective point we can give any representative member of the\nline.",
    "Thus these each represent the same projective point.\n",
    "\n\n\n1\n2\n3\n\n\n\n\n\n\n1/3\n2/3\n1\n\n\n\n\n\n\n−2\n−4\n−6\n\n\n\nEach is a homogeneous coordinate vector for the point p.",
    "Two homogeneous\ncoordinate vectors (which are by deﬁnition nonzero)\n˜p1 =\n\n\n\na1\nb1\nc1\n\n\n\n˜p2 =\n\n\n\na2\nb2\nc2\n\n\n\nrepresent the same projective point if there is a scaling factor s ̸= 0",
    "so that\ns˜p1 = ˜p2.\n",
    "Of the inﬁnitely many possible representatives, often we use the one whose\nthird component is 1.",
    "This amounts to projecting onto the plane z = 1.\n\n",
    "Topic: Computer Graphics\n393\nIn this topic we will show how to use these ideas to perform some eﬀects\nfrom computer graphics.",
    "For that we will take the prior picture and redraw it\nwithout the sphere, with a movie projector at the origin, and with plane z = 1\nlooking like a movie theater screen.\n",
    "projector, at (0, 0, 0)\n",
    "z = 1\np =\n\u0012x\ny\n\u0013\n",
    "This associates vectors in three-space on the grey line with p in the screen plane.\n",
    "˜p =\n\n\n\na\nb\nc\n\n\n7→p =\n \nx\ny\n!\n",
    "=\n \na/c\nb/c\n!\n",
    "We can adapt the things we have already seen about matrices to perform the\ntransformations.",
    "Rotation is an example.",
    "This matrix rotates in the plane z = 1\nabout the origin by the angle θ.\n",
    "\n\n\ncos θ\n−sin θ\n0\nsin θ\ncos θ\n0\n0\n0\n1\n\n\n\n\n\n\nx\ny\n1\n\n\n=\n\n\n\ncosθ · x −sin θ · y\nsin θ ·",
    "x + cos θ · y\n1\n\n\n\nNotice that it works on any homogeneous coordinate vector; if we apply the\nmatrix\n\n\n\ncos θ\n−sin θ\n0\nsin θ\ncos θ\n0\n0\n0\n1\n\n\n\n\n\n\na\nb\nc\n\n\n=\n\n\n\ncosθ · a −sin θ · b\nsin θ · a + cos θ · b\nc\n\n\n\nand then move to the z = 1 plane\n\n\n\ncosθ · a −sin θ · b\nsin θ · a + cos θ · b\nc\n\n\n7→\n\n\n\n(cosθ · a −sin θ · b)/c\n(sin θ · a + cos θ · b)/c\n1\n\n\n\n\n394\nChapter Four.",
    "Determinants\nthen we get the same result as if we had ﬁrst moved to the plane and then\napplied the matrix.\n",
    "\n\n\ncos θ\n−sin θ\n0\nsin θ\ncos θ\n0\n0\n0\n1\n\n\n\n\n\n\na/c\nb/c\n1\n\n\n=\n\n\n\ncosθ · a/c −sin θ · b/c\nsin θ · a/c + cos θ · b/c\n1\n\n\n\nSo there is no harm in working with homogeneous coordinates.",
    "But what is\nthe advantage?\n",
    "The computer graphic operation of translation, of sliding things from one\nplace to another, is not a linear transformation because it does not leave the\norigin ﬁxed.",
    "But if we work with homogeneous coordinates then we can use\nmatrices.",
    "This matrix will translate points in the plane of interest by tx in the\nx direction and ty in the y direction.\n",
    "\n\n\n1\n0\ntx\n0\n1\nty\n0\n0\n1\n\n\n\n\n\n\na\nb\nc\n\n\n=\n\n\n\na + tx · c\nb + ty · c\nc\n\n",
    "\n7→\n\n\n\na/c + tx\nb/c + ty\n1\n\n\n\n",
    "That is, in the plane of interest this matrix slides\n\u0000a/c\nb/c\n\u0001\nto\n\u0000a/c+tx\nb/c+ty\n\u0001\n.",
    "So the\nhomogeneous coordinates allow us to use matrices.\n",
    "OK then, but what is the advantages of using these matrices?",
    "What does the\nextra coordinate get us?",
    "Suppose that we are making a movie with computer\ngraphics.",
    "We are at a moment where the camera is panning and rotating at\nthe same time.",
    "Every single point in the scene needs to be both translated\nand rotated.",
    "Rather than have the computer perform two operations to each\npoint, we can multiply the two matrices and then the computer only applies one\noperation to each point; it multiplies that point by the resulting matrix.",
    "That\nis a tremendous speedup and simpliﬁcation.\n",
    "We will list some examples of the eﬀects that we can get.",
    "We have already\ntalked about rotation.",
    "Here is the picture of rotation by a half radian.\n",
    "7→\n",
    "And here is a translation with tx = 1.5 and ty = 0.5.\n",
    "7→\nNext is scaling.",
    "This matrix rescales things in the target plane by a factor\nof s in the x-direction, and by a factor of t in the y direction.\n",
    "\n\n\ns\n0\n0\n0\nt\n0\n0\n0\n1\n\n\n\n\n\n\na/c\nb/c\n1\n\n\n=\n\n\n\ns · a/c\nt · b/c\n1\n\n\n\n\nTopic: Computer Graphics\n395\n",
    "In this picture we rescale in the x direction by a factor of s = 2.5 and in the\ny-direction by t = 0.75.\n",
    "7→\nIf we take s = t then the entire shape is rescaled.",
    "For instance, if we string\ntogether frames with s = t = 1.10 then in the movie it will seem that the object\nis getting closer to us.\n",
    "We can reﬂect the object.",
    "This reﬂects about the line y = x.\n\n\n\n0\n1\n0\n1\n0\n0\n0\n0\n1\n\n\n\n\n\n\na/c\nb/c\n1\n\n\n=\n\n\n\nb/c\na/c\n1\n\n\n\nThe dashed line here is y = x.\n7→\n",
    "This reﬂects about y = −x.\n",
    "\n\n\n0\n−1\n0\n−1\n0\n0\n0\n0\n1\n\n\n\n\n\n\na/c\nb/c\n1\n\n\n=\n\n\n\n−b/c\n−a/c\n1\n\n\n\nThe dashed line below is y = −x.\n",
    "7→\nMore complex transformations are possible.",
    "This is a shear.\n\n\n\n1\n1\n0\n0\n1\n0\n0\n0\n1\n\n\n\n\n\n\na/c\nb/c\n1\n\n\n=\n\n\n\na/c + b/c\nb/c\n1\n\n\n\n",
    "In this picture the y components of points are unchanged, but the x components\nhave added to them the value of y.\n7→\n\n396\nChapter Four.",
    "Determinants\nA major advantage of having this all be matrices is that we can do complex\nthings by combining simple things.",
    "To reﬂect about the line y = −x + 2 we\ncan ﬁnd the three matrices to slide everything to the origin, then reﬂect about\ny = −x, and then slide back.\n",
    "\n\n\n1\n0\n0\n0\n1\n2\n0\n0\n1\n\n\n\n\n\n\n0\n−1\n0\n−1\n0\n0\n0\n0\n1\n\n\n\n\n\n\n1\n0\n0\n0\n1\n−2\n0\n0\n1\n\n\n\n(*)\n(As always, the action done ﬁrst is described by the matrix on the right.",
    "That\nis, the matrix on the right describes sliding all points in the plane of interest by\n−2, the matrix in the middle reﬂects about y = −x, and the matrix on the left\nslides all points back.)\n",
    "There are even more complex eﬀects possible with matrices.",
    "These are the\nmatrices for the general aﬃne transformation, and the general projective\ntransformation.\n",
    "\n\n\nd\ne\nf\ng\nh\ni\n0\n0\n1\n\n\n\n\n\n\nd\ne\nf\ng\nh\ni\nj\nk\n1\n\n\n\nHowever, description of their geometric eﬀect is beyond our scope.\n",
    "There is a vast literature on computer graphics, in which linear algebra plays\nan important part.",
    "An excellent source is [Hughes et al.].",
    "The subject is a\nwonderful blend of mathematics and art; see [Disney].\n",
    "Exercises\n1 Calculate the product in (∗).\n",
    "2 Find the matrix that reﬂects about the line y = 2x.\n",
    "3 Find the matrix that reﬂects about the line y = 2x −4.\n",
    "4 Rotation and translation are rigid operations.",
    "What is the matrix for a rotation\nfollowed by a translation?\n",
    "5",
    "The homogeneous coordinates extend to manipulations of three dimensional space\nin the obvious way: every coordinate is a set of four-tall nonzero vectors that are\nrelated by being scalar multiples of each other.",
    "Give the matrix to do rotation\nabout the z axis, and the matrix for rotation about the y axis.\n\n",
    "Chapter Five\nSimilarity\nWe have shown that for any homomorphism there are bases B and D such that\nthe matrix representing the map has a block partial-identity form.\nRepB,D(h) =\n \nIdentity\nZero\nZero\nZero\n!\n",
    "This representation describes the map as sending c1⃗β1 + · · · + cn⃗βn to c1⃗δ1 +\n· · · + ck⃗δk + ⃗0 + · · · + ⃗0, where n is the dimension of the domain and k is the\ndimension of the range.",
    "Under this representation the action of the map is easy\nto understand because most of the matrix entries are zero.\n",
    "This chapter considers the special case where the domain and codomain are\nthe same.",
    "Here we naturally ask for the domain basis and codomain basis to be\nthe same.",
    "That is, we want a basis B so that RepB,B(t) is as simple as possible,\nwhere we take ‘simple’ to mean that it has many zeroes.",
    "We will ﬁnd that we\ncannot always get a matrix having the above block partial-identity form but we\nwill develop a form that comes close, a representation that is nearly diagonal.\n",
    "I\nComplex Vector Spaces\nThis chapter requires that we factor polynomials.",
    "But many polynomials do not\nfactor over the real numbers; for instance, x2 + 1 does not factor into a product\nof two linear polynomials with real coeﬃcients; instead it requires complex\nnumbers x2",
    "+ 1 = (x −i)(x + i).\n\n",
    "398\nChapter Five.",
    "Similarity\nConsequently in this chapter we shall use complex numbers for our scalars,\nincluding entries in vectors and matrices.",
    "That is, we shift from studying vector\nspaces over the real numbers to vector spaces over the complex numbers.",
    "Any\nreal number is a complex number and in this chapter most of the examples use\nonly real numbers but nonetheless, the critical theorems require that the scalars\nbe complex.",
    "So this ﬁrst section is a review of complex numbers.\n",
    "In this book our approach is to shift to this more general context of taking\nscalars to be complex for the pragmatic reason that we must do so in order\nto move forward.",
    "However, the idea of doing vector spaces by taking scalars\nfrom a structure other than the real numbers is an interesting and useful one.\n",
    "Delightful presentations that take this approach from the start are in [Halmos]\nand",
    "[Hoﬀman & Kunze].\n",
    "I.1\nPolynomial Factoring and Complex Numbers\nThis subsection is a review only.",
    "For a full development, including proofs,\nsee [Ebbinghaus].\nConsider a polynomial p(x)",
    "= cnxn + · · ·",
    "+ c1x + c0 with leading coeﬃcient\ncn ̸= 0.",
    "The degree of the polynomial is n.",
    "If n = 0 then p is a constant\npolynomial p(x)",
    "= c0.",
    "Constant polynomials that are not the zero polynomial,\nc0 ̸= 0, have degree zero.",
    "We deﬁne the zero polynomial to have degree −∞.\n1.1 Remark Deﬁning the degree of the zero polynomial to be −∞allows the\nequation degree(fg) = degree(f) + degree(g) to hold for all polynomials.\n",
    "Just as integers have a division operation — e.g., ‘4 goes 5 times into 21 with\nremainder 1’ — so do polynomials.\n",
    "1.2 Theorem (Division Theorem for Polynomials) Let p(x) be a polynomial.",
    "If d(x)\nis a non-zero polynomial then there are quotient and remainder polynomials\nq(x) and r(x) such that\np(x) = d(x) · q(x) + r(x)\nwhere the degree of r(x) is strictly less than the degree of d(x).\n",
    "The point of the integer statement ‘4 goes 5 times into 21 with remainder\n1’ is that the remainder is less than 4 — while 4 goes 5 times, it does not go 6\ntimes.",
    "Similarly, the ﬁnal clause of the polynomial division statement is crucial.\n",
    "1.3 Example If p(x) = 2x3 −3x2 + 4x and d(x)",
    "=",
    "x2",
    "+ 1 then q(x) = 2x −3",
    "and\n\nSection I. Complex Vector Spaces\n399\nr(x) = 2x + 3.",
    "Note that r(x) has a lower degree than does d(x).\n",
    "1.4 Corollary The remainder when p(x) is divided by x −λ is the constant\npolynomial r(x) = p(λ).\n",
    "Proof The remainder must be a constant polynomial because it is of degree less\nthan the divisor x −λ.",
    "To determine the constant, take the theorem’s divisor\nd(x) to be x −λ and substitute λ for x.\nQED\nIf a divisor d(x) goes into a dividend p(x) evenly, meaning that r(x) is the\nzero polynomial, then d(x) is a called a factor of p(x).",
    "Any root of the factor,\nany λ ∈R such that d(λ)",
    "= 0, is a root of p(x) since p(λ)",
    "= d(λ) ·",
    "q(λ) = 0.\n1.5 Corollary",
    "If λ is a root of the polynomial p(x) then x −λ divides p(x) evenly,\nthat is, x −λ is a factor of p(x).\n",
    "Proof By the above corollary p(x)",
    "= (x −λ) ·",
    "q(x) + p(λ).",
    "Since λ is a root,\np(λ) = 0",
    "so x −λ is a factor.\n",
    "QED\nA repeated root of a polynomial is a number λ such that the polynomial is\nevenly divisible by (x −λ)n for some power larger than one.",
    "The largest such\npower is called the multiplicity of λ.\n",
    "Finding the roots and factors of a high-degree polynomial can be hard.\n",
    "But for second-degree polynomials we have the quadratic formula: the roots of\nax2 + bx + c",
    "are these\nλ1 = −b +\n√\nb2 −4ac\n2a\nλ2 = −b −\n√\nb2 −4ac\n2a\n(if the discriminant b2 −4ac is negative then the polynomial has no real number\nroots).",
    "A polynomial that cannot be factored into two lower-degree polynomials\nwith real number coeﬃcients is said to be irreducible over the reals.\n",
    "1.6 Theorem Any constant or linear polynomial is irreducible over the reals.",
    "A\nquadratic polynomial is irreducible over the reals if and only if its discriminant\nis negative.",
    "No cubic or higher-degree polynomial is irreducible over the reals.\n",
    "1.7 Corollary Any polynomial with real coeﬃcients factors into a product of linear\nand irreducible quadratic polynomials with real coeﬃcients.",
    "That factorization is\nunique; any two factorizations have the same factors raised to the same powers.\n",
    "Note the analogy with the prime factorization of integers.",
    "In both cases the\nuniqueness clause is very useful.\n\n",
    "400\nChapter Five.",
    "Similarity\n1.8 Example Because of uniqueness we know, without multiplying them out, that\n(x + 3)2(x2",
    "+ 1)3 does not equal (x + 3)4(x2",
    "+ x + 1)2.\n",
    "1.9 Example By uniqueness, if c(x) = m(x)·q(x) then where c(x) = (x−3)2(x+2)3\nand m(x) = (x −3)(x + 2)2, we know that q(x) = (x −3)(x",
    "+ 2).\n",
    "While x2+1 has no real roots and so doesn’t factor over the real numbers, if we\nimagine a root — traditionally denoted i, so that i2 + 1 = 0 — then x2 + 1 factors\ninto a product of linears (x−i)(x+i).",
    "When we adjoin this root i to the reals and\nclose the new system with respect to addition and multiplication then we have\nthe complex numbers C = {a + bi | a, b ∈R and i2 = −1}.",
    "(These are often\npictured on a plane with a plotted on the horizontal axis and b on the vertical;\nnote that the distance of the point from the origin is |a + bi| =\n√\na2 + b2.)\n",
    "In C all quadratics factor.",
    "That is, in contrast with the reals, C has no\nirreducible quadratics.\n",
    "ax2 + bx",
    "+ c = a ·\n\u0000x −−b +\n√\nb2 −4ac\n2a\n\u0001\n·\n\u0000x −−b −\n√\nb2 −4ac\n2a\n\u0001\n1.10 Example",
    "The second degree polynomial x2",
    "+ x + 1 factors over the complex\nnumbers into the product of two ﬁrst degree polynomials.\n",
    "\u0000x −−1 +\n√\n−3\n2\n\u0001\u0000x −−1 −\n√\n−3\n2\n\u0001\n=\n\u0000x −(−1\n2 +\n√\n3\n2 i)\n\u0001\u0000x −(−1\n2 −\n√\n3\n2 i)\n\u0001\n1.11 Theorem (Fundamental Theorem of Algebra)\nPolynomials with complex coeﬃ-\ncients factor into linear polynomials with complex coeﬃcients.",
    "The factorization\nis unique.\n",
    "I.2\nComplex Representations\nRecall the deﬁnitions of the complex number addition\n(a + bi)",
    "+ (c + di) = (a + c)",
    "+ (b + d)i\nand multiplication.\n",
    "(a + bi)(c + di) = ac + adi + bci + bd(−1)\n= (ac −bd)",
    "+ (ad + bc)i\n2.1 Example For instance, (1 −2i)",
    "+ (5 + 4i)",
    "= 6 + 2i and (2 −3i)(4 −0.5i) =\n6.5 −13i.\n\nSection I. Complex Vector Spaces\n401\nWith these rules, all of the operations that we’ve used for real vector spaces\ncarry over unchanged to vector spaces with complex scalars.\n",
    "2.2 Example Matrix multiplication is the same, although the scalar arithmetic\ninvolves more bookkeeping.\n \n",
    "1 + 1i\n2 −0i\ni\n−2 + 3i\n!  \n",
    "1 + 0i\n1 −0i\n3i\n−i\n!\n",
    "=\n \n(1 + 1i) · (1 + 0i) + (2 −0i) · (3i)\n(1 + 1i) · (1 −0i) + (2 −0i) · (−i)\n(i) · (1 + 0i) + (−2 + 3i) · (3i)\n(i) · (1 −0i) + (−2 + 3i) · (−i)\n!\n",
    "=\n \n1 + 7i\n1 −1i\n−9 −5i\n3 + 3i\n!\n",
    "We shall carry over unchanged from the previous chapters everything that\nwe can.",
    "For instance, we shall call this\n⟨\n\n\n\n\n\n\n1 + 0i\n0 + 0i\n...\n0",
    "+ 0i\n\n\n\n\n\n\n, . . .",
    ",\n\n\n\n\n\n\n0 + 0i\n0 + 0i\n...\n1 + 0i\n\n\n\n\n\n\n⟩\nthe standard basis for Cn as a vector space over C and again denote it En.\n",
    "Another example is that Pn will be the vector space of degree n polynomials\nwith coeﬃcients that are complex.\n\n",
    "402\nChapter Five.",
    "Similarity\nII\nSimilarity\nWe’ve deﬁned two matrices H and ˆH to be matrix equivalent if there are\nnonsingular P and Q such that ˆH = PHQ.",
    "We were motivated by this diagram\nshowing H and ˆH both representing a map h, but with respect to diﬀerent pairs\nof bases, B, D and ˆB, ˆD.\nVwrt B\nh\n−−−−→\nH\nWwrt D\nid\ny\nid\ny\nVwrt ˆB\nh\n−−−−→\nˆH\nWwrt ˆD\nWe now consider the special case of transformations, where the codomain\nequals the domain, and we add the requirement that the codomain’s basis equals\nthe domain’s basis.",
    "So, we are considering representations with respect to B, B\nand D, D.\nVwrt B\nt\n−−−−→\nT\nVwrt B\nid\ny\nid\ny\nVwrt D\nt\n−−−−→\nˆT\nVwrt D\nIn matrix terms, RepD,D(t) = RepB,D(id) RepB,B(t)\n\u0000RepB,D(id)\n\u0001−1.\n",
    "II.1\nDeﬁnition and Examples\n1.1 Example Consider the derivative transformation d/dx: P2 →P2, and two\nbases for that space B = ⟨x2, x, 1⟩and D = ⟨1, 1 + x, 1 + x2⟩We will compute\nthe four sides of the arrow square.\n",
    "P2 wrt B\nd/dx\n−−−−→\nT\nP2 wrt B\nid\ny\nid\ny\nP2 wrt D\nd/dx\n−−−−→\nˆT\nP2 wrt D\nThe top is ﬁrst.",
    "The eﬀect of the transformation on the starting basis B\nx2 d/dx\n7−→2x\nx\nd/dx\n7−→1\n1\nd/dx\n7−→0\n\nSection II.",
    "Similarity\n403\nrepresented with respect to the ending basis (also B)\nRepB(2x) =\n\n\n\n0\n2\n0\n\n\n\nRepB(1)",
    "=\n\n\n\n0\n0\n1\n\n\n\nRepB(0) =\n\n\n\n0\n0\n0\n\n\n\ngives the representation of the map.\n",
    "T = RepB,B(d/dx) =\n\n\n\n0\n0\n0\n2\n0\n0\n0\n1\n0\n\n\n\nNext, computing the matrix for the right-hand side involves ﬁnding the eﬀect\nof the identity map on the elements of B.",
    "Of course, the identity map does\nnot transform them at all so to ﬁnd the matrix we represent B’s elements with\nrespect to D.\nRepD(x2) =\n\n\n\n−1\n0\n1\n\n\n\nRepD(x) =\n\n\n\n−1\n1\n0\n\n\n\nRepD(1) =\n\n\n\n1\n0\n0\n\n\n\nSo the matrix for going down the right side is the concatenation of those.\n",
    "P = RepB,D(id) =\n\n\n\n−1\n−1\n1\n0\n1\n0\n1\n0\n0\n\n\n\nWith that, we have two options to compute the matrix for going up on left\nside.",
    "The direct computation represents elements of D with respect to B\nRepB(1)",
    "=\n\n\n\n0\n0\n1\n\n\n\nRepB(1 + x) =\n\n\n\n0\n1\n1\n\n\n\nRepB(1 + x2) =\n\n\n\n1\n0\n1\n\n\n\nand concatenates to make the matrix.\n\n\n\n0\n0\n1\n0\n1\n0\n1\n1\n1\n\n\n\n",
    "The other option to compute the matrix for going up on the left is to take the\ninverse of the matrix P for going down on the right.\n",
    "\n\n\n−1\n−1\n1\n1\n0\n0\n0\n1\n0\n0\n1\n0\n1\n0\n0\n0\n0\n1\n\n\n\n−→\n· · ·\n−→\n\n\n\n1\n0\n0\n0\n0\n1\n0\n1\n0\n0\n1\n0\n0\n0\n1\n1\n1\n1\n\n\n\n\n404\nChapter Five.",
    "Similarity\nThat leaves the bottom of the square.",
    "There are two ways to compute the\nmatrix ˆT. One is to compute it directly by ﬁnding the eﬀect of the transformation\non elements of D\n1\nd/dx\n7−→0\n1 + x\nd/dx\n7−→1\n1",
    "+ x2 d/dx\n7−→2x\nrepresented with respect to D.\nˆT = RepD,D(d/dx) =\n\n\n\n0\n1\n−2\n0\n0\n2\n0\n0\n0\n\n\n\n",
    "The other way to compute ˆT, and this is the way we will usually do it, is to\nfollow the diagram up, over, and then down.\n",
    "RepD,D(d/dx) = RepB,D(id) RepB,B(d/dx) RepD,B(id)\nˆT = RepB,D(id) T RepD,B(id)\n=\n\n\n\n−1\n−1\n1\n0\n1\n0\n1\n0\n0\n\n\n\n\n\n\n0\n0\n0\n2\n0\n0\n0\n1\n0\n\n\n\n\n\n\n0\n0\n1\n0\n1\n0\n1\n1\n1\n\n\n\nMultiplying out gives the same matrix ˆT as we found above.\n",
    "1.2 Deﬁnition The matrices T and ˆT are similar if there is a nonsingular P such\nthat ˆT = PTP−1.\n",
    "Since nonsingular matrices are square, T and ˆT must be square and of the same\nsize.",
    "Exercise 15 checks that similarity is an equivalence relation.\n",
    "1.3 Example The deﬁnition does not require that we consider a map.",
    "Calculation\nwith these two\nP =\n \n2\n1\n1\n1\n!\nT =\n \n2\n−3\n1\n−1\n!\ngives that T is similar to this matrix.\n",
    "ˆT =\n \n12\n−19\n7\n−11\n!\n1.4 Example The only matrix similar to the zero matrix is itself: PZP−1 = PZ = Z.\n",
    "The identity matrix has the same property: PIP−1 = PP−1 = I.\n\nSection II.",
    "Similarity\n405\nA common special case is where the vector space is Cn and the matrix T\nrepresents a map with respect to the standard bases.\n",
    "Cn\nwrt",
    "En\nt\n−−−−→\nT\nCn\nwrt En\nid\ny\nid\ny\nCn\nwrt D\nt\n−−−−→\nˆT\nCn\nwrt D\n",
    "In this case in the similarity equation ˆT = PTP−1, the columns of P are the\nelements of D.\nMatrix similarity is a special case of matrix equivalence so if two matrices\nare similar then they are matrix equivalent.",
    "What about the converse: if they\nare square, must any two matrix equivalent matrices be similar?",
    "No; the matrix\nequivalence class of an identity matrix consists of all nonsingular matrices of\nthat size while the prior example shows that the only member of the similarity\nclass of an identity matrix is itself.",
    "Thus these two are matrix equivalent but\nnot similar.\n",
    "T =\n \n1\n0\n0\n1\n!\n",
    "S =\n \n1\n2\n0\n3\n!\n",
    "So some matrix equivalence classes split into two or more similarity classes —\nsimilarity gives a ﬁner partition than does matrix equivalence.",
    "This shows some\nmatrix equivalence classes subdivided into similarity classes.\n. . .\n",
    "S\nT\nTo understand the similarity relation we shall study the similarity classes.\n",
    "We approach this question in the same way that we’ve studied both the row\nequivalence and matrix equivalence relations, by ﬁnding a canonical form for\nrepresentatives of the similarity classes, called Jordan form.",
    "With this canonical\nform, we can decide if two matrices are similar by checking whether they are in\na class with the same representative.",
    "We’ve also seen with both row equivalence\nand matrix equivalence that a canonical form gives us insight into the ways in\nwhich members of the same class are alike (e.g., two identically-sized matrices\nare matrix equivalent if and only if they have the same rank).\n",
    "Exercises\n1.5 For\nT =\n\u0012 1\n3\n−2\n−6\n\u0013\nˆT =\n\u0012\n0\n0\n−11/2\n−5\n\u0013\nP =\n\u0012 4\n2\n−3\n2\n\u0013\ncheck that ˆT = PTP−1.\n\n406\nChapter Five.",
    "Similarity\n1.6 Example 1.4 shows that the only matrix similar to a zero matrix is itself and\nthat the only matrix similar to the identity is itself.\n",
    "(a) Show that the 1×1 matrix whose single entry is 2 is also similar only to itself.\n",
    "(b) Is a matrix of the form cI for some scalar c similar only to itself?\n(c) Is a diagonal matrix similar only to itself?\n",
    "✓1.7 Consider this transformation of C3\nt(\n\n\nx\ny\nz\n\n) =\n\n\nx −z\nz\n2y\n\n\nand these bases.\n",
    "B = ⟨\n\n\n1\n2\n3\n\n,\n\n\n0\n1\n0\n\n,\n\n\n0\n0\n1\n\n⟩\n",
    "D = ⟨\n\n\n1\n0\n0\n\n,\n\n\n1\n1\n0\n\n,\n\n\n1\n0\n1\n\n⟩\n",
    "We will compute the parts of the arrow diagram to represent the transformation\nusing two similar matrices.\n",
    "(a) Draw the arrow diagram, specialized for this case.\n",
    "(b) Compute T = RepB,B(t).\n",
    "(c) Compute ˆT = RepD,D(t).\n",
    "(d) Compute the matrices for the other two sides of the arrow square.\n",
    "1.8 Consider the transformation t: P2 →P2 described by x2 7→x",
    "+ 1, x 7→x2 −1,\nand 1 7→3.\n",
    "(a) Find T = RepB,B(t) where B = ⟨x2, x, 1⟩.\n(b) Find ˆT = RepD,D(t) where D = ⟨1, 1 + x, 1",
    "+ x",
    "+ x2⟩.\n(c) Find the matrix P such that ˆT = PTP−1.\n",
    "✓1.9 Let T represent t: C2 →C2 with respect to B, B.\nT =\n\u00121\n−1\n2\n1\n\u0013\nB = ⟨\n\u00121\n0\n\u0013\n,\n\u00121\n1\n\u0013\n⟩,\nD = ⟨\n\u00122\n0\n\u0013\n,\n\u0012 0\n−2\n\u0013\n⟩\nWe will convert to the matrix representing t with respect to D, D.\n(a) Draw the arrow diagram.\n",
    "(b) Give the matrix that represents the left and right sides of that diagram, in\nthe direction that we traverse the diagram to make the conversion.\n",
    "(c) Find RepD,D(t).\n",
    "✓1.10 Exhibit a nontrivial similarity relationship by letting t: C2 →C2 act in this\nway,\n\u00121\n2\n\u0013\n7→\n\u00123\n0\n\u0013\n\u0012−1\n1\n\u0013\n7→\n\u0012−1\n2\n\u0013\npicking two bases B, D, and representing t with respect to them, ˆT = RepB,B(t)\nand T = RepD,D(t).",
    "Then compute the P and P−1 to change bases from B to D\nand back again.\n",
    "✓1.11 Show that these matrices are not similar.\n\n\n1\n0\n4\n1\n1\n3\n2\n1\n7\n\n\n\n\n1\n0\n1\n0\n1\n1\n3\n1\n2\n\n\n1.12 Explain Example 1.4 in terms of maps.\n\nSection II.",
    "Similarity\n407\n✓1.13",
    "[Halmos] Are there two matrices A and B that are similar while A2 and B2 are\nnot similar?\n",
    "✓1.14 Prove that if two matrices are similar and one is invertible then so is the other.\n",
    "1.15 Show that similarity is an equivalence relation.",
    "(The deﬁnition given earlier\nalready reﬂects this, so instead start here with the deﬁnition that ˆT is similar to T\nif ˆT = PTP−1.)\n",
    "1.16 Consider a matrix representing, with respect to some B, B, reﬂection across\nthe x-axis in R2.",
    "Consider also a matrix representing, with respect to some D, D,\nreﬂection across the y-axis.",
    "Must they be similar?\n1.17 Prove that matrix similarity preserves rank and determinant.",
    "Does the converse\nhold?\n",
    "1.18 Is there a matrix equivalence class with only one matrix similarity class inside?\n",
    "One with inﬁnitely many similarity classes?\n1.19 Can two diﬀerent diagonal matrices be in the same similarity class?\n✓1.20 Prove that if two matrices are similar then their k-th powers are similar when\nk > 0.",
    "What if k ⩽0?\n✓1.21 Let p(x) be the polynomial cnxn + · · · + c1x + c0.",
    "Show that if T is similar to\nS then p(T) = cnT n + · · · + c1T + c0I is similar to p(S)",
    "= cnSn + · · · + c1S + c0I.\n1.22 List all of the matrix equivalence classes of 1×1 matrices.",
    "Also list the similarity\nclasses, and describe which similarity classes are contained inside of each matrix\nequivalence class.\n",
    "1.23 Does similarity preserve sums?\n1.24 Show that if T −λI and N are similar matrices then T and N + λI are also\nsimilar.\n",
    "II.2\nDiagonalizability\nThe prior subsection shows that although similar matrices are necessarily matrix\nequivalent, the converse does not hold.",
    "Some matrix equivalence classes break\ninto two or more similarity classes; for instance, the nonsingular 2×2 matrices\nform one matrix equivalence class but more than one similarity class.\n",
    "The diagram below illustrates.",
    "Solid curves show the matrix equivalence\nclasses while dashed dividers mark the similarity classes.",
    "Each star is a matrix\nrepresenting its similarity class.",
    "We cannot use the canonical form for matrix\nequivalence, a block partial-identity matrix, as a canonical form for similarity\nbecause each matrix equivalence class has only one partial identity matrix.\n. . .\n",
    "⋆\n⋆\n⋆⋆\n⋆\n⋆⋆⋆\n⋆\n\n408\nChapter Five.",
    "Similarity\nTo develop a canonical form for representatives of the similarity classes we\nnaturally build on previous work.",
    "So, if a similarity class does contain a partial\nidentity matrix then it should represent that class.",
    "Beyond that, representatives\nshould be as simple as possible.\n",
    "The simplest extension of the partial identity form is diagonal form.\n",
    "2.1 Deﬁnition A transformation is diagonalizable if it has a diagonal represen-\ntation with respect to the same basis for the codomain as for the domain.",
    "A\ndiagonalizable matrix is one that is similar to a diagonal matrix: T is diagonal-\nizable if there is a nonsingular P such that PTP−1 is diagonal.\n",
    "2.2 Example The matrix\n \n4\n−2\n1\n1\n!\nis diagonalizable.\n \n",
    "2\n0\n0\n3\n!\n=\n \n−1\n2\n1\n−1\n!  \n",
    "4\n−2\n1\n1\n!  \n",
    "−1\n2\n1\n−1\n!−1\n",
    "Below we will see how to ﬁnd the matrix",
    "P",
    "but ﬁrst we note that not every\nmatrix is similar to a diagonal matrix, so diagonal form will not suﬃce as a\ncanonical form for similarity.\n",
    "2.3 Example This matrix is not diagonalizable.\n",
    "N =\n \n0\n0\n1\n0\n!\n",
    "The fact that N is not the zero matrix means that it cannot be similar to the\nzero matrix, because the zero matrix is similar only to itself.",
    "Thus if N were to\nbe similar to a diagonal matrix D then D would have at least one nonzero entry\non its diagonal.\n",
    "The crucial point is that a power of N is the zero matrix, speciﬁcally N2 is\nthe zero matrix.",
    "This implies that for any map n represented by N with respect\nto some B, B, the composition n ◦n is the zero map.",
    "This in turn implies that\nany matrix representing n with respect to some ˆB, ˆB has a square that is the\nzero matrix.",
    "But for any nonzero diagonal matrix D2, the entries of D2 are the\nsquares of the entries of D, so D2 cannot be the zero matrix.",
    "Thus N is not\ndiagonalizable.\n",
    "So not every similarity class contains a diagonal matrix.",
    "We now characterize\nwhen a matrix is diagonalizable.\n\nSection II.",
    "Similarity\n409\n2.4 Lemma A transformation t is diagonalizable if and only if there is a basis\nB = ⟨⃗β1, . . .",
    ", ⃗βn⟩and scalars λ1, . . .",
    ", λn such that t(⃗βi) = λi⃗βi for each i.\nProof Consider a diagonal representation matrix.\nRepB,B(t) =\n\n\n\n\n...\n...\nRepB(t(⃗β1))\n· · ·\nRepB(t(⃗βn))\n...\n...\n\n\n\n=\n\n\n\nλ1\n0\n...\n...\n...\n0\nλn\n\n\n\nConsider the representation of a member of this basis with respect to the basis\nRepB(⃗βi).",
    "The product of the diagonal matrix and the representation vector\nRepB(t(⃗βi))",
    "=\n\n\n\nλ1\n0\n...\n...\n...\n0\nλn\n\n\n\n\n\n\n\n\n\n\n\n\n0\n...\n1\n...\n0\n\n\n\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n\n\n0\n...\nλi\n...\n0\n\n\n\n\n\n\n\n\n\nhas the stated action.\n",
    "QED\n2.5 Example To diagonalize\nT =\n \n3\n2\n0\n1\n!\n",
    "we take T as the representation of a transformation with respect to the standard\nbasis RepE2,E2(t) and look for a basis B = ⟨⃗β1, ⃗β2⟩such that\nRepB,B(t) =\n \nλ1\n0\n0\nλ2\n!\n",
    "that is, such that t(⃗β1)",
    "= λ1⃗β1 and t(⃗β2)",
    "= λ2⃗β2.\n \n3\n2\n0\n1\n!\n⃗β1 = λ1 · ⃗β1\n \n3\n2\n0\n1\n!\n",
    "⃗β2 = λ2 · ⃗β2\nWe are looking for scalars x such that this equation\n \n3\n2\n0\n1\n!  \nb1\nb2\n!\n",
    "= x ·\n \nb1\nb2\n!\nhas solutions b1 and b2 that are not both 0 (the zero vector is not the member\nof any basis).",
    "That’s a linear system.\n",
    "(3 −x) ·",
    "b1 +\n2 · b2 = 0\n(1 −x) ·",
    "b2 = 0\n(∗)\n\n410\nChapter Five.",
    "Similarity\nFocus ﬁrst on the bottom equation.",
    "There are two cases: either b2 = 0 or x = 1.\n",
    "In the b2 = 0 case the ﬁrst equation gives that either b1 = 0 or x = 3.",
    "Since\nwe’ve disallowed the possibility that both b2 = 0 and b1 = 0, we are left with\nthe ﬁrst diagonal entry λ1 = 3.",
    "With that, (∗)’s",
    "ﬁrst equation is 0·b1",
    "+2·b2",
    "= 0\nand so associated with λ1 = 3 are vectors having a second component of zero\nwhile the ﬁrst component is free.\n \n",
    "3\n2\n0\n1\n!  \n",
    "b1\n0\n!\n",
    "= 3 ·\n \nb1\n0\n!\n",
    "To get a ﬁrst basis vector choose any nonzero b1.\n",
    "⃗β1 =\n \n1\n0\n!\n",
    "The other case for the bottom equation of (∗) is λ2 = 1.",
    "Then (∗)’s ﬁrst\nequation is 2 · b1 + 2 · b2 = 0 and so associated with this case are vectors whose\nsecond component is the negative of the ﬁrst.\n \n3\n2\n0\n1\n!  \nb1\n−b1\n!\n= 1 ·\n \nb1\n−b1\n!\n",
    "Get the second basis vector by choosing a nonzero one of these.\n",
    "⃗β2 =\n \n1\n−1\n!\n",
    "Now draw the similarity diagram\nR2\nwrt E2\nt\n−−−−→\nT\nR2\nwrt E2\nid\ny\nid\ny\nR2\nwrt B\nt\n−−−−→\nD\nR2\nwrt B\nand note that the matrix RepB,E2(id) is easy, giving this diagonalization.\n \n",
    "3\n0\n0\n1\n!\n=\n \n1\n1\n0\n−1\n!−1  \n3\n2\n0\n1\n!  \n",
    "1\n1\n0\n−1\n!\n",
    "The rest of this section expands on that example by considering more closely\nthe property of Lemma 2.4, including seeing a streamlined way to ﬁnd the λ’s.\n",
    "The section after that expands on Example 2.3, to understand what can prevent\ndiagonalization.",
    "Then the ﬁnal section puts these two together, to produce a\ncanonical form that is in some sense as simple as possible.\n\n",
    "Section II.",
    "Similarity\n411\nExercises\n✓2.6 Repeat Example 2.5 for the matrix from Example 2.2.\n✓2.7 Diagonalize this matrix by following the steps of Example 2.5.\n",
    "\u00121\n1\n0\n0\n\u0013\n(a) Set up the matrix-vector equation described in Lemma 2.4 and rewrite it as a\nlinear system.\n",
    "(b) By considering solutions for that system, ﬁnd two vectors to make a basis.\n",
    "(Consider separately the system in the x = 0 and x ̸= 0 cases.",
    "Also, recall that\nthe zero vector cannot be a member of a basis.)\n",
    "(c) Use that basis in the similarity diagram to get the diagonal matrix as the\nproduct of three others.\n",
    "✓2.8 Follow Example 2.5 to diagonalize this matrix.\n",
    "\u00120\n1\n1\n0\n\u0013\n(a) Set up the matrix-vector equation and rewrite it as a linear system.\n",
    "(b) By considering solutions for that system, ﬁnd two vectors to make a basis.\n",
    "(Consider separately the x = 0 and x ̸= 0 cases.",
    "Also, recall that the zero vector\ncannot be a member of a basis.)\n",
    "(c) With that basis use the similarity diagram to get the diagonalization as the\nproduct of three matrices.\n",
    "2.9 Diagonalize these upper triangular matrices.\n",
    "(a)\n\u0012−2\n1\n0\n2\n\u0013\n(b)\n\u00125\n4\n0\n1\n\u0013\n2.10",
    "If we try to diagonalize the matrix of Example 2.3\n",
    "N =\n\u00120\n0\n1\n0\n\u0013\nusing the method of Example 2.5 then what goes wrong?\n(a) Draw the similarity diagram with N.\n(b) Set up the matrix-vector equation described in Lemma 2.4 and rewrite it as a\nlinear system.\n",
    "(c) By considering solutions for that system, ﬁnd the trouble.",
    "(Consider separately\nthe x = 0 and x ̸= 0 cases.)\n",
    "✓2.11 What form do the powers of a diagonal matrix have?\n2.12 Give two same-sized diagonal matrices that are not similar.",
    "Must any two\ndiﬀerent diagonal matrices come from diﬀerent similarity classes?\n2.13 Give a nonsingular diagonal matrix.",
    "Can a diagonal matrix ever be singular?\n✓2.14 Show that the inverse of a diagonal matrix is the diagonal of the inverses, if no\nelement on that diagonal is zero.",
    "What happens when a diagonal entry is zero?\n2.15",
    "The equation ending Example 2.5\n\u00121\n1\n0\n−1\n\u0013−1 \u00123\n2\n0\n1\n\u0013 \u00121\n1\n0\n−1\n\u0013\n=\n\u00123\n0\n0\n1\n\u0013\n\n412\nChapter Five.",
    "Similarity\nis a bit jarring because for P we must take the ﬁrst matrix, which is shown as an\ninverse, and for P−1 we take the inverse of the ﬁrst matrix, so that the two −1\npowers cancel and this matrix is shown without a superscript −1.\n",
    "(a) Check that this nicer-appearing equation holds.\n",
    "\u00123\n0\n0\n1\n\u0013\n=\n\u00121\n1\n0\n−1\n\u0013 \u00123\n2\n0\n1\n\u0013 \u00121\n1\n0\n−1\n\u0013−1\n(b) Is the previous item a coincidence?",
    "Or can we always switch the P and the\nP−1?\n",
    "2.16 Show that the P used to diagonalize in Example 2.5 is not unique.\n",
    "2.17 Find a formula for the powers of this matrix.",
    "Hint: see Exercise 11.\n",
    "\u0012−3\n1\n−4\n2\n\u0013\n2.18 We can ask how diagonalization interacts with the matrix operations.",
    "Assume\nthat t, s: V →V are each diagonalizable.",
    "Is ct diagonalizable for all scalars c?\nWhat about t + s? t ◦s?\n2.19 Show that matrices of this form are not diagonalizable.\n",
    "\u00121\nc\n0\n1\n\u0013\nc ̸= 0\n2.20 Show that each of these is diagonalizable.\n",
    "(a)\n\u00121\n2\n2\n1\n\u0013\n(b)\n\u0012x\ny\ny\nz\n\u0013\nx, y, z scalars\nII.3\nEigenvalues and Eigenvectors\n",
    "We will next focus on the property of Lemma 2.4.\n3.1 Deﬁnition A transformation t: V →V has a scalar eigenvalue",
    "λ if there is a\nnonzero eigenvector ⃗ζ ∈V such that t(⃗ζ)",
    "= λ · ⃗ζ.\n",
    "“Eigen” is German for “characteristic of” or “peculiar to.”",
    "Some authors call these\ncharacteristic values and vectors.",
    "No authors call them “peculiar” vectors.\n",
    "3.2 Example The projection map\n\n\n\nx\ny\nz\n\n\n\nπ\n7−→\n\n\n\nx\ny\n0\n\n\n\nx, y, z ∈C\nhas an eigenvalue of 1 associated with any eigenvector\n\n\n\nx\ny\n0\n\n\n\n\nSection II.",
    "Similarity\n413\nwhere x and y are scalars that are not both zero.\n",
    "In contrast, a number that is not an eigenvalue of this map is 2, since\nassuming that π doubles a vector leads to the three equations x = 2x, y = 2y,\nand 0 = 2z, and thus no non-⃗0 vector is doubled.\n",
    "Note that the deﬁnition requires that the eigenvector be non-⃗0.",
    "Some authors\nallow ⃗0 as an eigenvector for λ as long as there are also non-⃗0 vectors associated\nwith λ.",
    "The key point is to disallow the trivial case where λ is such that t(⃗v) = λ⃗v\nfor only the single vector ⃗v = ⃗0.\n",
    "Also, note that the eigenvalue λ could be 0.",
    "The issue is whether ⃗ζ equals ⃗0.\n",
    "3.3 Example The only transformation on the trivial space {⃗0} is ⃗0 7→⃗0.",
    "This\nmap has no eigenvalues because there are no non-⃗0 vectors ⃗v mapped to a scalar\nmultiple λ ·⃗v of themselves.\n",
    "3.4 Example Consider the homomorphism t: P1 →P1 given by c0 + c1x 7→\n(c0 + c1)",
    "+ (c0 + c1)x.",
    "While the codomain P1 of t is two-dimensional, its range\nis one-dimensional R(t) = {c + cx | c ∈C}.",
    "Application of t to a vector in that\nrange will simply rescale the vector c",
    "+ cx",
    "7→(2c)",
    "+ (2c)x.",
    "That is, t has an\neigenvalue of 2 associated with eigenvectors of the form c + cx, where c ̸= 0.\n",
    "This map also has an eigenvalue of 0 associated with eigenvectors of the form\nc −cx where c ̸= 0.\n",
    "The deﬁnition above is for maps.",
    "We can give a matrix version.\n",
    "3.5 Deﬁnition A square matrix T has a scalar eigenvalue λ associated with the\nnonzero eigenvector ⃗ζ if T⃗ζ = λ · ⃗ζ.\n",
    "This extension of the deﬁnition for maps to a deﬁnition for matrices is natural\nbut there is a point on which we must take care.",
    "The eigenvalues of a map are also\nthe eigenvalues of matrices representing that map, and so similar matrices have\nthe same eigenvalues.",
    "However, the eigenvectors can diﬀer — similar matrices\nneed not have the same eigenvectors.",
    "The next example explains.\n",
    "3.6 Example These matrices are similar\nT =\n \n2\n0\n0\n0\n!\n",
    "ˆT =\n \n4\n−2\n4\n−2\n!\n",
    "since ˆT = PTP−1 for this P.\nP =\n \n1\n1\n1\n2\n!\nP−1 =\n \n2\n−1\n−1\n1\n!\n",
    "The matrix T has two eigenvalues, λ1 = 2 and λ2 = 0.",
    "The ﬁrst one is associated\n\n414\nChapter Five.",
    "Similarity\nwith this eigenvector.\nT⃗e1 =\n \n2\n0\n0\n0\n!  \n",
    "1\n0\n!\n=\n \n2\n0\n!\n= 2⃗e1\nSuppose that T represents a transformation t: C2 →C2 with respect to the\nstandard basis.",
    "Then the action of this transformation t is simple.\n \n",
    "x\ny\n!\nt\n7−→\n \n2x\n0\n!\n",
    "Of course, ˆT represents the same transformation but with respect to a diﬀerent\nbasis B. We can ﬁnd this basis.",
    "Following the arrow diagram from the lower left\nto the upper left\nVwrt E2\nt\n−−−−→\nT\nVwrt E2\nid\ny\nid\ny\nVwrt B\nt\n−−−−→\nˆT\nVwrt B\nshows that P−1 = RepB,E2(id).",
    "By the deﬁnition of the matrix representation\nof a map, its ﬁrst column is RepE2(id(⃗β1))",
    "= RepE2(⃗β1).",
    "With respect to the\nstandard basis any vector is represented by itself, so the ﬁrst basis element ⃗β1 is\nthe ﬁrst column of P−1.",
    "The same goes for the other one.\n",
    "B = ⟨\n \n2\n−1\n!\n,\n \n−1\n1\n!\n",
    "⟩\nSince the matrices T and ˆT both represent the transformation t, both reﬂect the\naction t(⃗e1)",
    "= 2⃗e1.\nRepE2,E2(t) ·",
    "RepE2(⃗e1)",
    "= T · RepE2(⃗e1)",
    "= 2 · RepE2(⃗e1)\nRepB,B(t) · RepB(⃗e1) = ˆT · RepB(⃗e1) = 2 · RepB(⃗e1)\n",
    "But while in those two equations the eigenvalue 2’s are the same, the vector\nrepresentations diﬀer.\n",
    "T · RepE2(⃗e1) = T\n \n1\n0\n!\n= 2 ·\n \n1\n0\n!\nˆT · RepB(⃗e1) = ˆT ·\n \n1\n1\n!\n= 2 ·\n \n1\n1\n!\n",
    "That is, when the matrix representing the transformation is T = RepE2,E2(t)\nthen it “assumes” that column vectors are representations with respect to E2.\n",
    "However ˆT = RepB,B(t) “assumes” that column vectors are representations with\nrespect to B and so the column vectors that get doubled are diﬀerent.\n\nSection II.",
    "Similarity\n415\nWe next see the basic tool for ﬁnding eigenvectors and eigenvalues.\n",
    "3.7 Example If\nT =\n\n\n\n1\n2\n1\n2\n0\n−2\n−1\n2\n3\n\n\n\nthen to ﬁnd the scalars x such that T⃗ζ = x⃗ζ for nonzero eigenvectors ⃗ζ, bring\neverything to the left-hand side\n\n\n\n1\n2\n1\n2\n0\n−2\n−1\n2\n3\n\n\n\n\n\n\nz1\nz2\nz3\n\n\n−x\n\n\n\nz1\nz2\nz3\n\n\n= ⃗0\nand factor (T −xI)⃗ζ = ⃗0.",
    "(Note that it says T −xI.",
    "The expression T −x doesn’t\nmake sense because T is a matrix while x is a scalar.)",
    "This homogeneous linear\nsystem\n\n\n\n1 −x\n2\n1\n2\n0 −x\n−2\n−1\n2\n3 −x\n\n\n\n\n\n\nz1\nz2\nz3\n\n\n=\n\n\n\n0\n0\n0\n\n\n\nhas a nonzero solution ⃗z if and only if the matrix is singular.",
    "We can determine\nwhen that happens.\n0",
    "= |T −xI|\n=\n\f\f\f\f\f\f\f\n1 −x\n2\n1\n2\n0 −x\n−2\n−1\n2\n3 −x\n\f\f\f\f\f\f\f\n= x3 −4x2 + 4x\n= x(x −2)2\nThe eigenvalues are λ1 = 0 and λ2 = 2.",
    "To ﬁnd the associated eigenvectors plug\nin each eigenvalue.",
    "Plugging in λ1 = 0 gives\n\n\n\n1 −0\n2\n1\n2\n0 −0\n−2\n−1\n2\n3 −0\n\n\n",
    "\n\n\n\nz1\nz2\nz3\n\n\n=\n\n\n\n0\n0\n0\n\n\n\n=⇒\n\n\n\nz1\nz2\nz3\n\n\n=\n\n\n\na\n−a\na\n\n\n\nfor a ̸= 0 (a must be non-0 because eigenvectors are deﬁned to be non-⃗0).\n",
    "Plugging in λ2 = 2 gives\n\n\n\n1 −2\n2\n1\n2\n0 −2\n−2\n−1\n2\n3 −2\n\n\n",
    "\n\n\n\nz1\nz2\nz3\n\n\n=\n\n\n\n0\n0\n0\n\n\n\n=⇒\n\n\n\nz1\nz2\nz3\n\n\n=\n\n\n\nb\n0\nb\n\n\n\nwith b ̸= 0.\n\n416\nChapter Five.",
    "Similarity\n3.8 Example",
    "If\nS =\n \nπ\n1\n0\n3\n!\n(here π is not a projection map, it is the number 3.14 . . .)",
    "then\n\f\f\f\f\f\nπ −x\n1\n0\n3 −x\n\f\f\f\f\f = (x −π)(x −3)\n",
    "so S has eigenvalues of λ1 = π and λ2 = 3.",
    "To ﬁnd associated eigenvectors, ﬁrst\nplug in λ1 for x\n \nπ −π\n1\n0\n3 −π\n!  \n",
    "z1\nz2\n!\n",
    "=\n \n0\n0\n!\n=⇒\n \nz1\nz2\n!\n",
    "=\n \na\n0\n!\nfor a scalar a ̸= 0.",
    "Then plug in λ2\n \nπ −3\n1\n0\n3 −3\n!  \nz1\nz2\n!\n",
    "=\n \n0\n0\n!\n=⇒\n \nz1\nz2\n!\n=\n \n−b/(π −3)\nb\n!\n",
    "where b ̸= 0.\n3.9 Deﬁnition",
    "The characteristic polynomial of a square matrix T is the\ndeterminant |T −xI| where x is a variable.",
    "The characteristic equation is\n|T −xI| = 0.",
    "The characteristic polynomial of a transformation t is the\ncharacteristic polynomial of any matrix representation RepB,B(t).\n",
    "The characteristic polynomial of an n × n matrix, or of a transformation\nt: Cn →Cn, is of degree n. Exercise 35 checks that the characteristic polynomial\nof a transformation is well-deﬁned, that is, that the characteristic polynomial is\nthe same no matter which basis we use for the representation.\n",
    "3.10 Lemma A linear transformation on a nontrivial vector space has at least\none eigenvalue.\nProof Any root of the characteristic polynomial is an eigenvalue.",
    "Over the\ncomplex numbers, any polynomial of degree one or greater has a root.\n",
    "QED\n3.11 Remark That result is the reason that in this chapter we use scalars that\nare complex numbers.",
    "Had we stuck to real number scalars then there would be\ncharacteristic polynomials, such as x2",
    "+ 1, that do not factor.\n\nSection II.",
    "Similarity\n417\n3.12 Deﬁnition The eigenspace of a transformation t associated with the\neigenvalue λ is Vλ = {⃗ζ | t(⃗ζ )",
    "= λ⃗ζ }.",
    "The eigenspace of a matrix is analogous.\n",
    "3.13 Lemma An eigenspace is a subspace.",
    "It is a nontrivial subspace.\n",
    "Proof Notice ﬁrst that Vλ is not empty; it contains the zero vector since t(⃗0) = ⃗0,\nwhich equals λ ·⃗0.",
    "To show that an eigenspace is a subspace, what remains is to\ncheck closure of this set under linear combinations.",
    "Take ⃗ζ1, . . .",
    ", ⃗ζn ∈Vλ and\nthen\nt(c1⃗ζ1 + c2⃗ζ2 + · · · + cn⃗ζn) = c1t(⃗ζ1) + · · ·",
    "+ cnt(⃗ζn)\n= c1λ⃗ζ1 + · · · + cnλ⃗ζn\n= λ(c1⃗ζ1 + · · · + cn⃗ζn)\nthat the combination is also an element of Vλ.\n",
    "The space Vλ contains more than just the zero vector because by deﬁnition\nλ is an eigenvalue only if t(⃗ζ )",
    "= λ⃗ζ has solutions for ⃗ζ other than ⃗0.\n",
    "QED\n3.14 Example",
    "These are the eigenspaces associated with the eigenvalues 0 and 2\nof Example 3.7.\n",
    "V0 = {\n\n\n\na\n−a\na\n\n\n| a ∈C},\nV2 = {\n\n\n\nb\n0\nb\n\n\n| b ∈C}.\n",
    "3.15 Example These are the eigenspaces for the eigenvalues π and 3 of Exam-\nple 3.8.\n",
    "Vπ = {\n \na\n0\n!\n",
    "| a ∈C}\nV3 = {\n \n−b/(π −3)\nb\n!\n| b ∈C}\nThe characteristic equation in Example 3.7 is 0 = x(x −2)2",
    "so in some sense\n2 is an eigenvalue twice.",
    "However there are not twice as many eigenvectors in\nthat the dimension of the associated eigenspace V2 is one, not two.",
    "The next\nexample is a case where a number is a double root of the characteristic equation\nand the dimension of the associated eigenspace is two.\n",
    "3.16 Example With respect to the standard bases, this matrix\n\n\n\n1\n0\n0\n0\n1\n0\n0\n0\n0\n\n\n\nrepresents projection.\n\n\n\nx\ny\nz\n\n\n\nπ\n7−→\n\n\n\nx\ny\n0\n\n\n\nx, y, z ∈C\n\n418\nChapter Five.",
    "Similarity\nIts characteristic equation\n0 = |T −xI|\n=\n\f\f\f\f\f\f\f\n1 −x\n0\n0\n0\n1 −x\n0\n0\n0\n0 −x\n\f\f\f\f\f\f\f\n= (1 −x)2(0 −x)\nhas the double root x = 1 along with the single root x = 0.",
    "Its eigenspace\nassociated with the eigenvalue 1 and its eigenspace associated with the eigenvalue\n0 are easy to ﬁnd.\n",
    "V1 = {\n\n\n\nc1\nc2\n0\n\n\n| c1, c2 ∈C}\nV0 = {\n\n\n\n0\n0\nc3\n\n\n| c3 ∈C}\nNote that V1 has dimension two.\n",
    "3.17 Deﬁnition Where a characteristic polynomial factors into (x −λ1)m1 · · · (x −\nλk)mk then the eigenvalue λi has algebraic multiplicity mi.",
    "Its geometric\nmultiplicity is the dimension of the associated eigenspace Vλi.\n",
    "In Example 3.16, there are two eigenvalues, For λ1 = 1 both the algebraic\nand geometric multiplicities are 2.",
    "For λ2 = 0 both the algebraic and geometric\nmultiplicities are 1.",
    "In contrast, Example 3.14 shows that the eigenvalue λ = 2\nhas algebraic multiplicity 2 but geometric multiplicity 1.",
    "For every transforma-\ntion, each eigenvalue has geometric multiplicity greater than or equal to 1 by\nLemma 3.13.",
    "(And, an eigenvalue must have geometric multiplicity less than or\nequal to its algebraic multiplicity, although proving this is beyond our scope.)\n",
    "By Lemma 3.13 if two eigenvectors ⃗v1 and ⃗v2 are associated with the same\neigenvalue then a linear combination of those two is also an eigenvector, associated\nwith the same eigenvalue.",
    "As an illustration, referring to the prior example, this\nsum of two members of V1\n\n\n\n1\n0\n0\n\n\n+\n\n\n\n0\n1\n0\n\n\n\nyields another member of V1.\n",
    "The next result speaks to the situation where the vectors come from diﬀerent\neigenspaces.\n\nSection II.",
    "Similarity\n419\n3.18 Theorem For any set of distinct eigenvalues of a map or matrix, a set of\nassociated eigenvectors, one per eigenvalue, is linearly independent.\n",
    "Proof We will use induction on the number of eigenvalues.",
    "The base step is\nthat there are zero eigenvalues.",
    "Then the set of associated vectors is empty and\nso is linearly independent.\n",
    "For the inductive step assume that the statement is true for any set of\nk ⩾0 distinct eigenvalues.",
    "Consider distinct eigenvalues λ1, . . .",
    ", λk+1 and let\n⃗v1, . . .",
    ",⃗vk+1 be associated eigenvectors.",
    "Suppose that ⃗0 = c1⃗v1 + · · · + ck⃗vk +\nck+1⃗vk+1.",
    "Derive two equations from that, the ﬁrst by multiplying by λk+1 on\nboth sides ⃗0 = c1λk+1⃗v1 + · · · + ck+1λk+1⃗vk+1 and the second by applying the\nmap to both sides ⃗0 = c1t(⃗v1)+· · ·+ck+1t(⃗vk+1)",
    "= c1λ1⃗v1+· · ·+ck+1λk+1⃗vk+1\n(applying the matrix gives the same result).",
    "Subtract the second from the ﬁrst.\n",
    "⃗0 = c1(λk+1 −λ1)⃗v1 + · · ·",
    "+ ck(λk+1 −λk)⃗vk + ck+1(λk+1 −λk+1)⃗vk+1\nThe ⃗vk+1 term vanishes.",
    "Then the induction hypothesis gives that c1(λk+1 −\nλ1) = 0, . .",
    ".",
    ", ck(λk+1 −λk)",
    "= 0.",
    "The eigenvalues are distinct so the coeﬃcients\nc1, . . .",
    ", ck are all 0.",
    "With that we are left with the equation ⃗0 = ck+1⃗vk+1 so\nck+1 is also 0.\n",
    "QED\n3.19 Example",
    "The eigenvalues of\n\n\n\n2\n−2\n2\n0\n1\n1\n−4\n8\n3\n\n",
    "\n\nare distinct: λ1 = 1, λ2 = 2, and λ3 = 3.",
    "A set of associated eigenvectors\n{\n\n\n\n2\n1\n0\n\n\n,\n\n\n\n9\n4\n4\n\n\n,\n\n\n\n2\n1\n2\n\n\n}\nis linearly independent.\n",
    "3.20 Corollary An n×n matrix with n distinct eigenvalues is diagonalizable.\n",
    "Proof Form a basis of eigenvectors.",
    "Apply Lemma 2.4.\n",
    "QED\n3.21 Example Here is a summary.",
    "In the prior example we showed that the\nmatrix\nT =\n\n\n\n2\n−2\n2\n0\n1\n1\n−4\n8\n3\n\n\n\n\n420\nChapter Five.",
    "Similarity\nis diagonalizable with λ1 = 1, λ2 = 2, and λ3 = 3 and these are associated\neigenvectors, which make up a basis",
    "B.\n⃗β1 =\n\n\n\n2\n1\n0\n\n\n\n⃗β2 =\n\n\n\n9\n4\n4\n\n\n\n⃗β3 =\n\n\n\n2\n1\n2\n\n\n\n",
    "The arrow diagram\nVwrt E3\nt\n−−−−→\nT\nVwrt E3\nid\ny\nid\ny\nVwrt B\nt\n−−−−→\nD\nVwrt B\ngives this.\n",
    "D = P−1TP\n\n\n\n1\n0\n0\n0\n2\n0\n0\n0\n3\n\n\n=\n\n\n\n−2\n5\n−1/2\n1\n−2\n0\n−2\n4\n1/2\n\n\n\n\n\n\n2\n−2\n2\n0\n1\n1\n−4\n8\n3\n\n\n\n\n\n\n2\n9\n2\n1\n4\n1\n0\n4\n2\n\n\n\n",
    "The bottom line of the diagram has t(⃗β1) = 1 · ⃗β1, etc.",
    "That is, the action on\nthe basis is this.\n",
    "⃗β1\nt−1\n7−→⃗0\n⃗β2\nt−2\n7−→⃗0\n⃗β3\nt−3\n7−→⃗0\nHere is how the top line of the arrow diagram represents the ﬁrst of those three\nactions\n(T −1 ·",
    "I)⃗β1 = ⃗0\n\n\n\n1\n−2\n2\n0\n0\n1\n−4\n8\n2\n\n\n\n\n\n\n2\n1\n0\n\n\n=\n\n\n\n0\n0\n0\n\n\n\n(of course, the representation of ⃗β1 with respect to the standard basis is itself).\n",
    "This section observes that some matrices are similar to a diagonal matrix.\n",
    "The idea of eigenvalues arose as the entries of that diagonal matrix, although\nthe deﬁnition applies more broadly than just to diagonalizable matrices.",
    "To ﬁnd\neigenvalues we deﬁned the characteristic equation and that led to the ﬁnal result,\n\nSection II.",
    "Similarity\n421\na criterion for diagonalizability.",
    "(While it is useful for the theory, note that in\napplications ﬁnding eigenvalues this way is typically impractical; for one thing\nthe matrix may be large and ﬁnding roots of large-degree polynomials is hard.)\n",
    "In the next section we study matrices that cannot be diagonalized.\n",
    "Exercises\n3.22 This matrix has two eigenvalues λ1 = 3, λ2 = −4.\n",
    "\u0012 4\n1\n−8\n−5\n\u0013\nGive two diﬀerent diagonal form matrices with which it is similar.\n",
    "3.23 For each, ﬁnd the characteristic polynomial and the eigenvalues.\n",
    "(a)\n\u001210\n−9\n4\n−2\n\u0013\n(b)\n\u00121\n2\n4\n3\n\u0013\n(c)\n\u00120\n3\n7\n0\n\u0013\n(d)\n\u00120\n0\n0\n0\n\u0013\n(e)\n\u00121\n0\n0\n1\n\u0013\n✓3.24 For each matrix, ﬁnd the characteristic equation and the eigenvalues and\nassociated eigenvectors.\n",
    "(a)\n\u00123\n0\n8\n−1\n\u0013\n(b)\n\u0012 3\n2\n−1\n0\n\u0013\n3.25 Find the characteristic equation, and the eigenvalues and associated eigenvectors\nfor this matrix.",
    "Hint.",
    "The eigenvalues are complex.\n",
    "\u0012−2\n−1\n5\n2\n\u0013\n3.26 Find the characteristic polynomial, the eigenvalues, and the associated eigen-\nvectors of this matrix.\n\n\n1\n1\n1\n0\n0\n1\n0\n0\n1\n\n\n✓3.27 For each matrix, ﬁnd the characteristic equation, and the eigenvalues and\nassociated eigenvectors.\n",
    "(a)\n\n\n3\n−2\n0\n−2\n3\n0\n0\n0\n5\n\n\n(b)\n\n\n0\n1\n0\n0\n0\n1\n4\n−17\n8\n\n\n3.28 For each matrix, ﬁnd the characteristic polynomial, and the eigenvalues and asso-\nciated eigenspaces.",
    "Also ﬁnd the algebraic and geometric multiplicities.\n",
    "(a)\n\u001213\n−4\n−4\n7\n\u0013\n(b)\n\n\n1\n3\n−3\n−3\n7\n−3\n−6\n6\n−2\n\n\n(c)\n\n\n2\n3\n−3\n0\n2\n−3\n0\n0\n1\n\n\n✓3.29 Let t: P2 →P2 be this linear map.\n",
    "a0 +",
    "a1x",
    "+ a2x2 7→(5a0 + 6a1 + 2a2) −(a1",
    "+ 8a2)x",
    "+ (a0 −2a2)x2\nFind its eigenvalues and the associated eigenvectors.\n",
    "3.30 Find the eigenvalues and eigenvectors of this map t: M2 →M2.\n",
    "\u0012a\nb\nc\nd\n\u0013\n7→\n\u0012\n2c\na + c\nb −2c\nd\n\u0013\n\n422\nChapter Five.",
    "Similarity\n✓3.31 Find the eigenvalues and associated eigenvectors of the diﬀerentiation operator\nd/dx: P3 →P3.\n",
    "3.32 Prove that the eigenvalues of a triangular matrix (upper or lower triangular)\nare the entries on the diagonal.\n",
    "✓3.33 This matrix has distinct eigenvalues.\n",
    "\n\n1\n2\n1\n6\n−1\n0\n−1\n−2\n−1\n\n\n(a) Diagonalize it.\n",
    "(b) Find a basis with respect to which this matrix has that diagonal representation.\n",
    "(c) Draw the diagram.",
    "Find the matrices P and P−1 to eﬀect the change of basis.\n",
    "✓3.34 Find the formula for the characteristic polynomial of a 2×2 matrix.\n",
    "3.35 Prove that the characteristic polynomial of a transformation is well-deﬁned.\n",
    "3.36 Prove or disprove: if all the eigenvalues of a matrix are 0 then it must be the\nzero matrix.\n✓3.37\n(a) Show that any non-⃗0 vector in any nontrivial vector space can be an\neigenvector.",
    "That is, given a ⃗v ̸= ⃗0 from a nontrivial V, show that there is a\ntransformation t: V →V having a scalar eigenvalue λ ∈R such that ⃗v ∈Vλ.\n",
    "(b)",
    "What if we are given a scalar λ?",
    "Can any non-⃗0 member of any nontrivial\nvector space be an eigenvector associated with λ?\n✓3.38 Suppose that t: V →V and T = RepB,B(t).",
    "Prove that the eigenvectors of T\nassociated with λ are the non-⃗0 vectors in the kernel of the map represented (with\nrespect to the same bases) by T −λI.\n3.39 Prove that if a, . . .",
    ", d are all integers and a + b = c",
    "+ d",
    "then\n\u0012a\nb\nc\nd\n\u0013\nhas integral eigenvalues, namely a + b and a −c.\n",
    "✓3.40 Prove that if T is nonsingular and has eigenvalues λ1, . . .",
    ", λn then T −1 has\neigenvalues 1/λ1, . . .",
    ", 1/λn.",
    "Is the converse true?\n✓3.41 Suppose that T is n×n and c, d are scalars.\n",
    "(a) Prove that if T has the eigenvalue λ with an associated eigenvector ⃗v then ⃗v is\nan eigenvector of cT + dI associated with eigenvalue cλ + d.\n(b)",
    "Prove that if T is diagonalizable then so is cT + dI.\n✓3.42 Show that λ is an eigenvalue of T if and only if the map represented by T −λI\nis not an isomorphism.\n",
    "3.43",
    "[Strang 80]\n(a) Show that if λ is an eigenvalue of A then λk is an eigenvalue of Ak.\n(b) What is wrong with this proof generalizing that?",
    "“If λ is an eigenvalue of A\nand µ is an eigenvalue for B, then λµ is an eigenvalue for AB, for, if A⃗x = λ⃗x and\nB⃗x = µ⃗x then AB⃗x",
    "= Aµ⃗x = µA⃗x = µλ⃗x”?\n",
    "3.44 Do matrix equivalent matrices have the same eigenvalues?\n3.45 Show that a square matrix with real entries and an odd number of rows has at\nleast one real eigenvalue.\n\n",
    "Section II.",
    "Similarity\n423\n3.46 Diagonalize.\n",
    "\n\n−1\n2\n2\n2\n2\n2\n−3\n−6\n−6\n\n\n3.47 Suppose that P is a nonsingular n × n matrix.\n",
    "Show that the similarity\ntransformation map tP : Mn×n →Mn×n sending T 7→PTP−1 is an isomorphism.\n?",
    "3.48",
    "[Math. Mag., Nov. 1967]",
    "Show that if A is an n square matrix and each row\n(column) sums to c then c is a characteristic root of A. (“Characteristic root” is a\nsynonym for eigenvalue.)\n\n424\nChapter Five.",
    "Similarity\nIII\nNilpotence\nThis chapter shows that every square matrix is similar to one that is a sum of\ntwo kinds of simple matrices.",
    "The prior section focused on the ﬁrst simple kind,\ndiagonal matrices.",
    "We now consider the other kind.\n",
    "III.1\nSelf-Composition\nBecause a linear transformation t: V →V has the same domain as codomain,\nwe can compose t with itself t2 = t ◦t, and t3 = t ◦t ◦t, etc.∗\n⃗v\nt(⃗v )\nt2(⃗v )\n",
    "Note that the superscript power notation tj for iterates of the transformations\nﬁts with the notation that we’ve used for their square matrix representations\nbecause if RepB,B(t) = T then RepB,B(tj) = T j.\n1.1 Example",
    "For the derivative map d/dx: P3 →P3 given by\na + bx + cx2 + dx3 d/dx\n7−→b + 2cx",
    "+ 3dx2\nthe second power is the second derivative,\na + bx + cx2 + dx3 d2/dx2\n7−→\n2c + 6dx\nthe third power is the third derivative,\na + bx + cx2 + dx3 d3/dx3\n7−→\n6d\nand any higher power is the zero map.\n",
    "1.2 Example This transformation of the space M2×2 of 2×2 matrices\n \na\nb\nc\nd\n!\n",
    "t\n7−→\n \nb\na\nd\n0\n!\n",
    "∗More information on function iteration is in the appendix.\n\nSection III.",
    "Nilpotence\n425\nhas this second power\n \na\nb\nc\nd\n!\nt2\n7−→\n \na\nb\n0\n0\n!\nand this third power.\n \n",
    "a\nb\nc\nd\n!\nt3\n7−→\n \nb\na\n0\n0\n!\n",
    "After that, t4 = t2 and t5 = t3, etc.\n",
    "1.3 Example Consider the shift transformation t: C3 →C3.\n",
    "\n\n\nx\ny\nz\n\n\n\nt\n7−→\n\n\n\n0\nx\ny\n\n\n\n",
    "We have that\n\n\n\nx\ny\nz\n\n\n\nt\n7−→\n\n\n\n0\nx\ny\n\n\n\nt\n7−→\n\n\n\n0\n0\nx\n\n\n\nt\n7−→\n\n\n\n0\n0\n0\n\n\n\nso the range spaces descend to the trivial subspace.\n",
    "R(t) = {\n\n\n\n0\na\nb\n\n\n| a, b ∈C}\nR(t2) = {\n\n\n\n0\n0\nc\n\n",
    "\n| c ∈C}\nR(t3) = {\n\n\n\n0\n0\n0\n\n\n}\nThese examples suggest that after some number of iterations the map settles\ndown.\n",
    "1.4 Lemma For any transformation t: V →V, the range spaces of the powers\nform a descending chain\nV ⊇R(t) ⊇R(t2) ⊇· · ·\nand the null spaces form an ascending chain.\n",
    "{⃗0} ⊆N (t) ⊆N (t2) ⊆· · ·\nFurther, there is a k > 0 such that for powers less than k the subsets are\nproper: if if j < k then R(tj) ⊃R(tj+1) and N (tj) ⊂N (tj+1), while if j ⩾k\nthen R(tj) = R(tj+1) and N (tj) = N (tj+1)).\n",
    "(The k = 1 case can happen, for instance if t is the identity map, so that in the\nchains none of the subsets are proper subsets.)\n\n",
    "426\nChapter Five.",
    "Similarity\nProof First recall that for any map the dimension of its range space plus\nthe dimension of its null space equals the dimension of its domain.",
    "So if the\ndimensions of the range spaces shrink then the dimensions of the null spaces\nmust rise.",
    "We will do the range space half here and leave the rest for Exercise 14.\n",
    "We start by showing that the range spaces form a chain.",
    "If ⃗w ∈R(tj+1), so\nthat ⃗w = tj+1(⃗v) for some ⃗v, then ⃗w = tj( t(⃗v) ).",
    "Thus ⃗w ∈R(tj).\n",
    "Next we verify the “further” property: in the chain the subsets containments\nare proper initially, and then from some power k onward the range spaces\nare equal.\n",
    "We ﬁrst show that if any pair of adjacent range spaces in the\nchain are equal R(tk) = R(tk+1) then all subsequent ones are also equal\nR(tk+1) = R(tk+2), etc.\nThis holds because t: R(tk+1) →R(tk+2) is the\nsame map, with the same domain, as t: R(tk) →R(tk+1) and it therefore has\nthe same range R(tk+1) = R(tk+2) (it holds for all higher powers by induction).\n",
    "So if the chain of range spaces ever stops strictly decreasing then from that point\nonward it is stable.\n",
    "We end by showing that the chain must eventually stop decreasing.",
    "Each\nrange space is a subspace of the one before it.",
    "For it to be a proper subspace it\nmust be of strictly lower dimension (see Exercise 12).",
    "These spaces are ﬁnite-\ndimensional and so the chain can fall for only ﬁnitely many steps.",
    "That is, the\npower k is at most the dimension of V.\nQED\n1.5 Example",
    "The derivative map a + bx + cx2 + dx3 d/dx\n7−→b + 2cx",
    "+ 3dx2 on P3\nhas this chain of range spaces.\nR(t0) = P3 ⊃R(t1) = P2 ⊃R(t2) = P1 ⊃R(t3) = P0 ⊃R(t4) = {⃗0}\nAll later elements of the chain are the trivial space.",
    "It has this chain of null\nspaces.\n",
    "N (t0) = {⃗0} ⊂N (t1) = P0 ⊂N (t2) = P1 ⊂N (t3) = P2 ⊂N (t4)",
    "= P3\nLater elements are the entire space.\n",
    "1.6 Example Let t: P2 →P2 be the map d0 +",
    "d1x",
    "+ d2x2 7→2d0 + d2x.",
    "As the\nlemma describes, on iteration the range space shrinks\nR(t0) = P2\nR(t) = {a0 + a1x | a0, a1 ∈C}\nR(t2) = {a0 | a0 ∈C}\nand then stabilizes, so that R(t2) = R(t3) = · · · .",
    "The null space grows\nN (t0) = {0}\nN (t) = {b1x | b1 ∈C}\nN (t2) = {b1x + b2x2 | b1, b2 ∈C}\nand then stabilizes N (t2) = N (t3) = · · · .\n\nSection III.",
    "Nilpotence\n427\n1.7 Example",
    "The transformation π: C3 →C3 projecting onto the ﬁrst two coor-\ndinates\n\n\n\nc1\nc2\nc3\n\n",
    "\n\nπ\n7−→\n\n\n\nc1\nc2\n0\n\n\n\nhas C3 ⊃R(π) = R(π2) = · · · and {⃗0} ⊂N (π) = N (π2) = · · · where this is\nthe range space and the null space.\nR(π)",
    "= {\n\n\n\na\nb\n0\n\n\n| a, b ∈C}\nN (π) = {\n\n\n\n0\n0\nc\n\n",
    "\n| c ∈C}\n1.8 Deﬁnition Let t be a transformation on an n-dimensional space.",
    "The gen-\neralized range space (or closure of the range space) is R∞(t) = R(tn).",
    "The\ngeneralized null space (or closure of the null space) is N∞(t)",
    "= N (tn).\n",
    "This graph illustrates.",
    "The horizontal axis gives the power j of a transfor-\nmation.",
    "The vertical axis gives the dimension of the range space of tj as the\ndistance above zero, and thus also shows the dimension of the null space because\nthe two add to the dimension n of the domain.\n",
    "0 1 2\nj\nn\nn\n0\nnullity(tj)\nrank(tj)\n. .",
    ".\n",
    "dim(N∞(t))\n",
    "dim(R∞(t))\n",
    "On iteration the rank falls and the nullity rises until there is some k such\nthat the map reaches a steady state R(tk) = R(tk+1) = R∞(t) and N (tk) =\nN (tk+1) = N∞(t).",
    "This must happen by the n-th iterate.\n",
    "Exercises\n✓1.9 Give the chains of range spaces and null spaces for the zero and identity trans-\nformations.\n",
    "✓1.10 For each map, give the chain of range spaces and the chain of null spaces, and\nthe generalized range space and the generalized null space.\n",
    "(a) t0 :",
    "P2 →P2, a + bx + cx2 7→b + cx2\n(b) t1 : R2 →R2,\n\u0012a\nb\n\u0013\n7→\n\u00120\na\n\u0013\n\n428\nChapter Five.",
    "Similarity\n(c) t2 : P2 →P2, a + bx + cx2",
    "7→b",
    "+ cx + ax2\n(d) t3 : R3 →R3,\n\n\na\nb\nc\n\n7→\n\n\na\na\nb\n\n\n1.11 Prove that function composition is associative (t ◦t) ◦t = t ◦(t ◦t) and so we\ncan write t3 without specifying a grouping.\n",
    "1.12 Check that a subspace must be of dimension less than or equal to the dimension\nof its superspace.",
    "Check that if the subspace is proper (the subspace does not equal\nthe superspace) then the dimension is strictly less.",
    "(This is used in the proof of\nLemma 1.4.)\n✓1.13 Prove that the generalized range space R∞(t) is the entire space, and the\ngeneralized null space N∞(t) is trivial, if the transformation t is nonsingular.",
    "Is\nthis ‘only if’ also?\n",
    "1.14 Verify the null space half of Lemma 1.4.\n",
    "✓1.15 Give an example of a transformation on a three dimensional space whose range\nhas dimension two.",
    "What is its null space?",
    "Iterate your example until the range\nspace and null space stabilize.\n",
    "1.16 Show that the range space and null space of a linear transformation need not\nbe disjoint.",
    "Are they ever disjoint?\n",
    "III.2\nStrings\n",
    "This requires material from the optional Combining Subspaces subsection.\n",
    "The prior subsection shows that as j increases the dimensions of the R(tj)’s\nfall while the dimensions of the N (tj)’s rise, in such a way that this rank and\nnullity split between them the dimension of V. Can we say more; do the two\nsplit a basis — is V = R(tj) ⊕N (tj)?\n",
    "The answer is yes for the smallest power j = 0 since V = R(t0) ⊕N (t0) =\nV ⊕{⃗0}.",
    "The answer is also yes at the other extreme.\n",
    "2.1 Lemma For any linear t: V →V the function t: R∞(t) →R∞(t) is one-to-\none.\n",
    "Proof Let the dimension of V be n. Because R(tn) = R(tn+1), the map\nt: R∞(t) →R∞(t) is a dimension-preserving homomorphism.",
    "Therefore, by\nTheorem Three.II.2.20",
    "it is one-to-one.\n",
    "QED\n\nSection III.",
    "Nilpotence\n429\n2.2 Corollary Where t: V →V is a linear transformation, the space is the direct\nsum V = R∞(t)⊕N∞(t).",
    "That is, both (1) dim(V) = dim(R∞(t))+dim(N∞(t))\n",
    "and (2) R∞(t) ∩N∞(t) = {⃗0}.\n",
    "Proof Let the dimension of V be n.",
    "We will verify the second sentence, which\nis equivalent to the ﬁrst.",
    "Clause (1) is true because any transformation satisﬁes\nthat its rank plus its nullity equals the dimension of the space, and in particular\nthis holds for the transformation tn.\n",
    "For clause (2), assume that ⃗v ∈R∞(t) ∩N∞(t) to prove that ⃗v = ⃗0.",
    "Because\n⃗v is in the generalized null space, tn(⃗v) = ⃗0.",
    "On the other hand, by the lemma\nt: R∞(t) →R∞(t) is one-to-one and a composition of one-to-one maps is one-\nto-one, so tn : R∞(t) →R∞(t) is one-to-one.",
    "Only ⃗0 is sent by a one-to-one\nlinear map to ⃗0 so the fact that tn(⃗v) = ⃗0 implies that ⃗v = ⃗0.\n",
    "QED\n2.3 Remark Technically there is a diﬀerence between the map t: V →V and\nthe map on the subspace t: R∞(t) →R∞(t) if the generalized range space is\nnot equal to V, because the domains are diﬀerent.",
    "But the diﬀerence is small\nbecause the second is the restriction of the ﬁrst to R∞(t).\n",
    "For powers between j = 0 and j = n, the space V might not be the direct\nsum of R(tj) and N (tj).",
    "The next example shows that the two can have a\nnontrivial intersection.\n",
    "2.4 Example Consider the transformation of C2 deﬁned by this action on the\nelements of the standard basis.\n \n",
    "1\n0\n!\nn\n7−→\n \n0\n1\n!\n \n0\n1\n!\nn\n7−→\n \n0\n0\n!\n",
    "N = RepE2,E2(n) =\n \n0\n0\n1\n0\n!\n",
    "This is a shift map because it shifts the entries down, with the bottom entry\nshifting entirely out of the vector.\n \n",
    "x\ny\n!\n",
    "7→\n \n0\nx\n!\n",
    "On the basis, this map’s action gives a string.\n \n",
    "1\n0\n!\n",
    "7→\n \n0\n1\n!\n7→\n \n0\n0\n!\n",
    "that is\n⃗e1 7→⃗e2 7→⃗0\nThis map is a natural way to have a vector in both the range space and null\nspace; the string depiction shows that this is one such vector.\n",
    "⃗e2 =\n \n0\n1\n!\n\n430\nChapter Five.",
    "Similarity\nObserve also that although n is not the zero map, the function n2 = n ◦n is\nthe zero map.\n2.5 Example A linear function ˆn: C4 →C4 whose action on E4 is given by the\nstring\n⃗e1 7→⃗e2 7→⃗e3 7→⃗e4 7→⃗0\nhas R(ˆn)∩N (ˆn) equal to the span [{⃗e4}], has R(ˆn2)∩N (ˆn2) =",
    "[{⃗e3,⃗e4}], and\nhas R(ˆn3) ∩N (ˆn3) =",
    "[{⃗e4 }].",
    "The matrix representation is all zeros except for\nsome subdiagonal ones.\n",
    "ˆN = RepE4,E4(ˆn) =\n\n\n\n\n\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n\n\n\n\n\n",
    "Although ˆn is not the zero map, and neither is ˆn2 or ˆn3, the function ˆn4 is the\nzero function.\n",
    "2.6 Example Transformations can act via more than one string.",
    "The transforma-\ntion t acting on a basis B = ⟨⃗β1, . . .",
    ", ⃗β5⟩by\n⃗β1 7→⃗β2 7→⃗β3 7→⃗0\n⃗β4 7→⃗β5 7→⃗0\nwill have, for instance, ⃗β3 in the intersection of its range space and null space.\n",
    "The strings make clear that t3 is the zero map.",
    "This map is represented by a\nmatrix that is all zeros except for blocks of subdiagonal ones\nRepB,B(t) =\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n\n\n\n\n\n\n\n(the lines just visually organize the blocks).\n",
    "In those examples all vectors are eventually transformed to zero.\n",
    "2.7 Deﬁnition A nilpotent transformation is one with a power that is the zero\nmap.",
    "A nilpotent matrix is one with a power that is the zero matrix.",
    "In either\ncase, the least such power is the index of nilpotency.\n",
    "2.8 Example In Example 2.4 the index of nilpotency is two.",
    "In Example 2.5 it is\nfour.",
    "In Example 2.6 it is three.\n\nSection III.",
    "Nilpotence\n431\n2.9 Example",
    "The diﬀerentiation map d/dx: P2 →P2 is nilpotent of index three\nsince the third derivative of any quadratic polynomial is zero.",
    "This map’s action\nis described by the string x2 7→2x 7→2 7→0 and taking the basis B = ⟨x2, 2x, 2⟩\ngives this representation.\n",
    "RepB,B(d/dx) =\n\n\n\n0\n0\n0\n1\n0\n0\n0\n1\n0\n\n\n\nNot all nilpotent matrices are all zeros except for blocks of subdiagonal ones.\n",
    "2.10 Example With the matrix ˆN from Example 2.5, and this four-vector basis\nD = ⟨\n\n\n\n\n\n1\n0\n1\n0\n\n\n\n\n,\n\n\n\n\n\n0\n2\n1\n0\n\n\n\n\n,\n\n\n\n\n\n1\n1\n1\n0\n\n\n\n\n,\n\n\n\n\n\n0\n0\n0\n1\n\n\n\n\n⟩\na change of basis operation produces this representation with respect to D, D.\n\n\n\n\n\n1\n0\n1\n0\n0\n2\n1\n0\n1\n1\n1\n0\n0\n0\n0\n1\n\n\n\n\n\n\n\n\n\n\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n\n\n\n\n\n\n\n\n\n\n1\n0\n1\n0\n0\n2\n1\n0\n1\n1\n1\n0\n0\n0\n0\n1\n\n\n\n\n\n−1\n=\n\n\n\n\n\n−1\n0\n1\n0\n−3\n−2\n5\n0\n−2\n−1\n3\n0\n2\n1\n−2\n0\n\n\n\n\n\n",
    "The new matrix is nilpotent; its fourth power is the zero matrix.",
    "We could\nverify this with a tedious computation or we can instead just observe that it is\nnilpotent since its fourth power is similar to ˆN4, the zero matrix, and the only\nmatrix similar to the zero matrix is itself.\n",
    "(P ˆNP−1)4 = P ˆNP−1 ·",
    "P ˆNP−1 · P ˆNP−1 · P ˆNP−1 = P ˆN4P−1\nThe goal of this subsection is to show that the prior example is prototypical\nin that every nilpotent matrix is similar to one that is all zeros except for blocks\nof subdiagonal ones.\n",
    "2.11 Deﬁnition Let t be a nilpotent transformation on V. A t-string generated\nby ⃗v ∈V is a sequence ⟨⃗v, t(⃗v), . . .",
    ", tk−1(⃗v)⟩such that tk(⃗v) = ⃗0.",
    "A t-string\nbasis is a basis that is a concatenation of t-strings.\n",
    "(The strings cannot form a basis under concatenation unless they are disjoint\nbecause a basis cannot have a repeated vector.)\n",
    "2.12 Example This linear map t: C3 →C3\n\n\n\nx\ny\nz\n\n\n\nt\n7−→\n\n\n\ny\nz\n0\n\n\n\n\n432\nChapter Five.",
    "Similarity\nis nilpotent, of index 3.\n\n\n\nx\ny\nz\n\n\n\nt\n7−→\n\n\n\ny\nz\n0\n\n\n\nt\n7−→\n\n\n\nz\n0\n0\n\n\n\nt\n7−→\n\n\n\n0\n0\n0\n\n\n\n",
    "This is a t-string\n⟨\n\n\n\n0\n0\n1\n\n\n,\n\n\n\n0\n1\n0\n\n\n,\n\n\n\n1\n0\n0\n\n\n⟩\nthat is a t-string basis for the space C3.\n",
    "2.13 Example The linear map of diﬀerentiation d/dx: P2 →P2 is nilpotent.",
    "The\nsequence ⟨x2, 2x, 2⟩is a d/dx-string of length 3; in particular, this string satisﬁes\nthe requirement that d/dx(2) = 0.",
    "Because it is a basis, that sequence is a\nd/dx-string basis for P2.\n",
    "2.14 Example",
    "In Example 2.6, we can concatenate the t-strings ⟨⃗β1, ⃗β2, ⃗β3⟩and\n⟨⃗β4, ⃗β5⟩to make a basis for the domain of t.\n2.15 Lemma",
    "If a space has a t-string basis then the index of nilpotency of t\nequals the length of the longest string in that basis.\n",
    "Proof Let the space have a basis of t-strings and let t’s index of nilpotency\nbe k. Then tk sends any vector to ⃗0, and that must include including the vector\nstarting any string.",
    "So each string in the string basis has length at most k.\n",
    "Now instead suppose that the space has a t-string basis B where all of the\nstrings are shorter than length k.",
    "Because t has the index of nilpotency k, there\nis a ⃗v such that tk−1(⃗v) ̸= ⃗0.",
    "Represent ⃗v as a linear combination of elements\nfrom B and apply tk−1.",
    "We are supposing that tk−1 maps each element of B\nto ⃗0.",
    "It therefore maps each term in the linear combination to ⃗0, contradicting\nthat it does not map ⃗v to ⃗0.\n",
    "QED\n",
    "We shall show that each nilpotent map has an associated string basis, a basis\nof disjoint strings.\n",
    "To see the main idea of the argument, imagine that we want to construct\na counterexample, a map that is nilpotent but without an associated basis of\ndisjoint strings.",
    "We might think to make something like the map t: C5 →C5\nwith this action.\n",
    "⃗e1\n⃗e2\n7→\n7→\n⃗e3 7→⃗0\n⃗e4 7→⃗e5 7→⃗0\nRepE5,E5(t) =\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n\n\n\n\n\n\n\n\nSection III.",
    "Nilpotence\n433\n",
    "But, the fact that the shown basis isn’t disjoint doesn’t mean that there isn’t\nanother basis that consists of disjoint strings.\n",
    "To produce such a basis for this map we will ﬁrst ﬁnd the number and lengths\nof its strings.",
    "Observe that t’s index of nilpotency is two.",
    "Lemma 2.15 says that\nin a disjoint string basis at least one string has length two.",
    "There are ﬁve basis\nelements so if there is a disjoint string basis then the map must act in one of\nthese ways.\n",
    "⃗β1 7→⃗β2 7→⃗0\n⃗β3 7→⃗β4 7→⃗0\n⃗β5 7→⃗0\n⃗β1 7→⃗β2 7→⃗0\n⃗β3 7→⃗0\n⃗β4 7→⃗0\n⃗β5 7→⃗0\nNow, the key point.",
    "A transformation with the left-hand action has a null\nspace of dimension three since that’s how many basis vectors are mapped to\nzero.",
    "A transformation with the right-hand action has a null space of dimension\nfour.",
    "With the matrix representation above we can determine which of the two\npossible shapes is right.\n",
    "N (t) = {\n\n\n\n\n\n\n\nx\n−x\nz\n0\nr\n\n\n\n\n\n\n\n| x, z, r ∈C}\n",
    "This is three-dimensional, meaning that of the two disjoint string basis forms\nabove, t’s basis has the left-hand one.\n",
    "To produce a string basis for t, ﬁrst pick ⃗β2 and ⃗β4 from R(t) ∩N",
    "(t).\n",
    "⃗β2 =\n\n\n\n\n\n\n\n0\n0\n1\n0\n0\n\n\n\n\n\n\n\n⃗β4 =\n\n\n\n\n\n\n\n0\n0\n0\n0\n1\n\n\n\n\n\n\n\n(Other choices are possible, just be sure that the set {⃗β2, ⃗β4} is linearly inde-\npendent.)",
    "For ⃗β5 pick a vector from N (t) that is not in the span of {⃗β2, ⃗β4}.\n",
    "⃗β5 =\n\n\n\n\n\n\n\n1\n−1\n0\n0\n0\n\n\n\n\n\n\n\n\n434\nChapter Five.",
    "Similarity\nFinally, take ⃗β1 and ⃗β3 such that t(⃗β1) = ⃗β2 and t(⃗β3) = ⃗β4.\n",
    "⃗β1 =\n\n\n\n\n\n\n\n0\n1\n0\n0\n0\n\n\n\n\n\n\n\n⃗β3 =\n\n\n\n\n\n\n\n0\n0\n0\n1\n0\n\n\n\n\n\n\n\nTherefore, we have a string basis B = ⟨⃗β1, . .",
    ".",
    ", ⃗β5⟩and with respect to that basis\nthe matrix of t has blocks of subdiagonal 1’s.\nRepB,B(t) =\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n",
    "2.16 Theorem Any nilpotent transformation t is associated with a t-string basis.\n",
    "While the basis is not unique, the number and the length of the strings is\ndetermined by t.\n",
    "This illustrates the proof, which describes three kinds of basis vectors (shown\nin squares if they are in the null space and in circles if they are not).\n",
    "k\n3\n7→\nk\n1\n7→· · ·\n· · · 7→\nk\n1\n7→1 7→⃗0\nk\n3\n7→\nk\n1\n7→· · ·\n· · · 7→\nk\n1\n7→1 7→⃗0\n...\nk\n3\n7→\nk\n1\n7→· · ·\n7→\nk\n1\n7→1 7→⃗0\n2\n7→\n⃗0\n...\n2\n7→\n⃗0\nProof Fix a vector space",
    "V.",
    "We will argue by induction on the index of\nnilpotency.",
    "If the map t: V →V has index of nilpotency 1",
    "then it is the zero\nmap and any basis is a string basis ⃗β1 7→⃗0, . . .",
    ", ⃗βn 7→⃗0.\n",
    "For the inductive step, assume that the theorem holds for any transformation\nt: V →V with an index of nilpotency between 1 and k −1 (with k > 1) and\nconsider the index k case.\n",
    "Observe that the restriction of t to the range space t: R(t) →R(t) is also\nnilpotent, of index k −1.",
    "Apply the inductive hypothesis to get a string basis\nfor R(t), where the number and length of the strings is determined by t.\nB = ⟨⃗β1, t(⃗β1), . . .",
    ", th1(⃗β1)⟩\n⌢⟨⃗β2, . . .",
    ", th2(⃗β2)⟩\n⌢· · ·\n⌢⟨⃗βi, . . .",
    ", thi(⃗βi)⟩\n\nSection III.",
    "Nilpotence\n435\n(In the illustration above these are the vectors of kind 1.)\n",
    "Note that taking the ﬁnal nonzero vector in each of these strings gives a basis\nC = ⟨th1(⃗β1), . . .",
    ", thi(⃗βi)⟩for the intersection R(t) ∩N",
    "(t).",
    "This is because a\nmember of R(t) maps to zero if and only if it is a linear combination of those\nbasis vectors that map to zero.",
    "(The illustration shows these as 1’s in squares.)\n",
    "Now extend C to a basis for all of N (t).\n",
    "ˆC = C\n⌢⟨⃗ξ1, . . .",
    ",⃗ξp⟩\n(In the illustration the ⃗ξ’s are the vectors of kind 2 and so the set ˆC is the set of\nvectors in squares.)",
    "While the vectors ⃗ξ we choose aren’t uniquely determined\nby t, what is uniquely determined is the number of them: it is the dimension of\nN (t) minus the dimension of R(t) ∩N",
    "(t).\n",
    "Finally, B\n⌢ˆC is a basis for R(t)+N (t) because any sum of something in the\nrange space with something in the null space can be represented using elements\nof B for the range space part and elements of ˆC for the part from the null space.\n",
    "Note that\ndim\n\u0000R(t)",
    "+ N (t)\n",
    "\u0001\n= dim(R(t))",
    "+",
    "dim(N (t)) −dim(R(t) ∩N",
    "(t))\n",
    "= rank(t) + nullity(t) −i\n= dim(V) −i\nand so we can extend B\n⌢ˆC to a basis for all of V by the addition of i more\nvectors, provided that they are not linearly dependent on what we have already.\n",
    "Recall that each of ⃗β1, . . .",
    ", ⃗βi is in R(t), and extend B\n⌢ˆC with vectors ⃗v1, . . .",
    ",⃗vi\nsuch that t(⃗v1) = ⃗β1, . . .",
    ", t(⃗vi) = ⃗βi.",
    "(In the illustration these are the 3’s.)",
    "The\ncheck that this extension preserves linear independence is Exercise 32.\nQED\n2.17",
    "Corollary Every nilpotent matrix is similar to a matrix that is all zeros except\nfor blocks of subdiagonal ones.",
    "That is, every nilpotent map is represented with\nrespect to some basis by such a matrix.\n",
    "This form is unique in the sense that if a nilpotent matrix is similar to two\nsuch matrices then those two simply have their blocks ordered diﬀerently.",
    "Thus\nthis is a canonical form for the similarity classes of nilpotent matrices provided\nthat we order the blocks, say, from longest to shortest.\n",
    "2.18 Example The matrix\nM =\n \n1\n−1\n1\n−1\n!\nhas an index of nilpotency of two, as this calculation shows.\n\n",
    "436\nChapter Five.",
    "Similarity\npower p\nMp\nN (Mp)\n1\nM =\n \n1\n−1\n1\n−1\n!\n{\n \nx\nx\n!\n| x ∈C}\n2\nM2 =\n \n0\n0\n0\n0\n!\nC2\nBecause the matrix is 2×2, any transformation that it represents is on a space\nof dimension two.",
    "The nullspace of one application of the map N (m) has\ndimension one, and the nullspace of two applications N (m2) has dimension two.\n",
    "Thus the action of m on a string basis is ⃗β1 7→⃗β2 7→⃗0 and the canonical form\nof the matrix is this.\n",
    "N =\n \n0\n0\n1\n0\n!\n",
    "We can exhibit such a string basis, and also the change of basis matrices\nwitnessing the matrix similarity between M and N. Suppose that m: C2 →C2\nis such that M represents it with respect to the standard bases.",
    "(We could take\nM to be a representation with respect to some other basis but the standard one\nis convenient.)",
    "Pick ⃗β2 ∈N (m).",
    "Also pick ⃗β1",
    "so that m(⃗β1) = ⃗β2.\n⃗β2",
    "=\n \n1\n1\n!\n",
    "⃗β1 =\n \n1\n0\n!\n",
    "For the change of basis matrices, recall the similarity diagram.\n",
    "C2\nwrt E2\nm\n−−−−→\nM\nC2\nwrt E2\nid\nyP\nid\nyP\nC2\nwrt B\nm\n−−−−→\nN\nC2\nwrt B\n",
    "The canonical form is RepB,B(m) = PMP−1, where\nP−1 = RepB,E2(id) =\n \n1\n1\n0\n1\n!\n",
    "P = (P−1)−1 =\n \n1\n−1\n0\n1\n!\nand the veriﬁcation of the matrix calculation is routine.\n \n",
    "1\n−1\n0\n1\n!  \n1\n−1\n1\n−1\n!  \n",
    "1\n1\n0\n1\n!\n=\n \n0\n0\n1\n0\n!\n\nSection III.",
    "Nilpotence\n437\n2.19 Example",
    "This matrix\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n−1\n1\n1\n−1\n1\n0\n1\n0\n0\n0\n1\n0\n−1\n1\n−1\n\n\n\n\n\n\n\nis nilpotent, of index 3.\npower p\nNp\nN (Np)\n1\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n−1\n1\n",
    "1\n−1\n1\n0\n1\n0\n0\n0\n1\n0\n−1\n1\n−1\n\n\n\n\n\n\n\n{\n\n\n\n\n\n\n\n0\n0\nu −v\nu\nv\n\n\n\n\n\n\n\n| u, v ∈C}\n2\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n{\n\n\n\n\n\n\n\n0\ny\nz\nu\nv\n\n\n\n\n\n\n\n| y, z, u, v ∈C}\n3\n–zero matrix–\nC5\n",
    "The table tells us this about any string basis: the null space after one map\napplication has dimension two so two basis vectors map directly to zero, the\nnull space after the second application has dimension four so two additional\nbasis vectors map to zero by the second iteration, and the null space after three\napplications is of dimension ﬁve so the remaining one basis vector maps to zero\nin three hops.\n",
    "⃗β1 7→⃗β2 7→⃗β3 7→⃗0\n⃗β4 7→⃗β5 7→⃗0\nTo produce such a basis, ﬁrst pick two vectors from N (n) that form a linearly\nindependent set.\n",
    "⃗β3 =\n\n\n\n\n\n\n\n0\n0\n1\n1\n0\n\n\n\n\n\n\n\n⃗β5 =\n\n\n\n\n\n\n\n0\n0\n0\n1\n1\n\n\n\n\n\n\n\n\n438\nChapter Five.",
    "Similarity\nThen add ⃗β2, ⃗β4 ∈N (n2) such that n(⃗β2) = ⃗β3 and n(⃗β4) = ⃗β5.\n",
    "⃗β2 =\n\n\n\n\n\n\n\n0\n1\n0\n0\n0\n\n\n\n\n\n\n\n⃗β4 =\n\n\n\n\n\n\n\n0\n1\n0\n1\n0\n\n\n\n\n\n\n\nFinish by adding ⃗β1 such that n(⃗β1) = ⃗β2.\n",
    "⃗β1 =\n\n\n\n\n\n\n\n1\n0\n1\n0\n0\n\n\n\n\n\n\n\nExercises\n✓2.20 What is the index of nilpotency of the right-shift operator, here acting on the\nspace of triples of reals?\n",
    "(x, y, z) 7→(0, x, y)\n✓2.21 For each string basis state the index of nilpotency and give the dimension of\nthe range space and null space of each iteration of the nilpotent map.\n",
    "(a) ⃗β1 7→⃗β2 7→⃗0\n⃗β3",
    "7→⃗β4 7→⃗0\n(b) ⃗β1",
    "7→⃗β2 7→⃗β3 7→⃗0\n⃗β4 7→⃗0\n⃗β5 7→⃗0\n⃗β6 7→⃗0\n(c) ⃗β1",
    "7→⃗β2 7→⃗β3 7→⃗0\nAlso give the canonical form of the matrix.\n2.22 Decide which of these matrices are nilpotent.\n",
    "(a)\n\u0012−2\n4\n−1\n2\n\u0013\n(b)\n\u00123\n1\n1\n3\n\u0013\n(c)\n\n\n−3\n2\n1\n−3\n2\n1\n−3\n2\n1\n\n\n(d)\n\n\n1\n1\n4\n3\n0\n−1\n5\n2\n7\n\n\n(e)\n\n\n45\n−22\n−19\n33\n−16\n−14\n69\n−34\n−29\n\n\n✓2.23 Find the canonical form of this matrix.\n\n\n\n\n\n\n\n0\n1\n1\n0\n1\n0\n0\n1\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n\nSection III.",
    "Nilpotence\n439\n✓2.24 Consider the matrix from Example 2.19.\n",
    "(a) Use the action of the map on the string basis to give the canonical form.\n",
    "(b) Find the change of basis matrices that bring the matrix to canonical form.\n",
    "(c) Use the answer in the prior item to check the answer in the ﬁrst item.\n",
    "✓2.25 Each of these matrices is nilpotent.\n",
    "(a)\n\u00121/2\n−1/2\n1/2\n−1/2\n\u0013\n(b)\n\n\n0\n0\n0\n0\n−1\n1\n0\n−1\n1\n\n\n(c)\n\n\n−1\n1\n−1\n1\n0\n1\n1\n−1\n1\n\n\nPut each in canonical form.\n",
    "2.26 Describe the eﬀect of left or right multiplication by a matrix that is in the\ncanonical form for nilpotent matrices.\n",
    "2.27 Is nilpotence invariant under similarity?",
    "That is, must a matrix similar to a\nnilpotent matrix also be nilpotent?",
    "If so, with the same index?\n✓2.28 Show that the only eigenvalue of a nilpotent matrix is zero.\n",
    "2.29 Is there a nilpotent transformation of index three on a two-dimensional space?\n2.30",
    "In the proof of Theorem 2.16, why isn’t the proof’s base case that the index of\nnilpotency is zero?\n✓2.31 Let t: V →V be a linear transformation and suppose ⃗v ∈V is such that\ntk(⃗v) = ⃗0 but tk−1(⃗v) ̸= ⃗0.",
    "Consider the t-string ⟨⃗v, t(⃗v), . . .",
    ", tk−1(⃗v)⟩.\n(a) Prove that t is a transformation on the span of the set of vectors in the string,\nthat is, prove that t restricted to the span has a range that is a subset of the\nspan.",
    "We say that the span is a t-invariant subspace.\n",
    "(b) Prove that the restriction is nilpotent.\n",
    "(c) Prove that the t-string is linearly independent and so is a basis for its span.\n",
    "(d) Represent the restriction map with respect to the t-string basis.\n",
    "2.32 Finish the proof of Theorem 2.16.\n",
    "2.33 Show that the terms ‘nilpotent transformation’ and ‘nilpotent matrix’, as\ngiven in Deﬁnition 2.7, ﬁt with each other: a map is nilpotent if and only if it is\nrepresented by a nilpotent matrix.",
    "(Is it that a transformation is nilpotent if an\nonly if there is a basis such that the map’s representation with respect to that basis\nis a nilpotent matrix, or that any representation is a nilpotent matrix?)\n2.34 Let T be nilpotent of index four.",
    "How big can the range space of T 3 be?\n2.35 Recall that similar matrices have the same eigenvalues.",
    "Show that the converse\ndoes not hold.\n",
    "2.36 Lemma 2.1 shows that any for any linear transformation t: V →V the restriction\nt: R∞(t) →R∞(t) is one-to-one.",
    "Show that it is also onto, so it is an automorphism.\n",
    "Must it be the identity map?\n2.37 Prove that a nilpotent matrix is similar to one that is all zeros except for blocks\nof super-diagonal ones.\n",
    "✓2.38 Prove that if a transformation has the same range space as null space.",
    "then\nthe dimension of its domain is even.\n",
    "2.39 Prove that if two nilpotent matrices commute then their product and sum are\nalso nilpotent.\n\n",
    "440\nChapter Five.",
    "Similarity\nIV\nJordan Form\nThis section uses material from three optional subsections: Combining\nSubspaces, Determinants Exist, and Laplace’s Expansion.\n",
    "We began this chapter by recalling that every linear map h: V →W can be\nrepresented with respect to some bases B ⊂V and D ⊂W by a partial identity\nmatrix.\n",
    "Restated, the partial identity form is a canonical form for matrix\nequivalence.",
    "This chapter considers the case where the codomain equals the\ndomain so we naturally ask what is possible when the two bases are equal, when\nwe have RepB,B(t).",
    "In short, we want a canonical form for matrix similarity.\n",
    "We noted that in the B, B case a partial identity matrix is not always possible.\n",
    "We therefore extended the matrix forms of interest to the natural generalization,\ndiagonal matrices, and showed that a transformation or square matrix can be\ndiagonalized if its eigenvalues are distinct.",
    "But we also gave an example of a\nsquare matrix that cannot be diagonalized because it is nilpotent, and thus\ndiagonal form won’t suﬃce as the canonical form for matrix similarity.\n",
    "The prior section developed that example to get a canonical form for nilpotent\nmatrices, subdiagonal ones.\n",
    "This section ﬁnishes our program by showing that for any linear transforma-\ntion there is a basis B such that the matrix representation RepB,B(t) is the sum\nof a diagonal matrix and a nilpotent matrix.",
    "This is Jordan canonical form.\n",
    "IV.1\nPolynomials of Maps and Matrices\nRecall that the set of square matrices Mn×n is a vector space under entry-by-\nentry addition and scalar multiplication, and that this space has dimension n2.\n",
    "Thus for any n×n matrix T the n2 + 1-member set {I, T, T 2, . . .",
    ", T n2 } is linearly\ndependent and so there are scalars c0, . . .",
    ", cn2, not all zero, such that\ncn2T n2 + · · · + c1T + c0I\nis the zero matrix.",
    "Therefore every transformation has a sort of generalized\nnilpotency — the powers of a square matrix cannot climb forever without a kind\nof repeat.\n",
    "1.1 Deﬁnition Let t be a linear transformation of a vector space V. Where\nf(x)",
    "= cnxn + · · · + c1x + c0 is a polynomial, f(t) is the transformation cntn +\n· · · + c1t + c0(id) on V.",
    "In the same way, if T is a square matrix then f(T) is\nthe matrix cnT n + · · ·",
    "+ c1T + c0I.\n\nSection IV.",
    "Jordan Form\n441\nThe polynomial of the matrix represents the polynomial of the map: if T =\nRepB,B(t) then f(T) = RepB,B(f(t)).",
    "This is because T j = RepB,B(tj), and\ncT = RepB,B(ct), and T1 + T2 = RepB,B(t1 + t2).\n",
    "1.2 Remark We shall write the matrix polynomial slightly diﬀerently than the\nmap polynomial.",
    "For instance, if f(x) = x −3 then we shall write the identity\nmatrix, as in f(T)",
    "= T −3I, but not write the identity map, as in f(t)",
    "= t −3.\n",
    "1.3 Example Rotation of plane vectors π/3 radians counterclockwise is represented\nwith respect to the standard basis by\nT =\n \ncos(π/3)\n−sin(π/3)\nsin(π/3)\ncos(π/3)\n!\n",
    "=\n \n1/2\n−\n√\n3/2\n√\n3/2\n1/2\n!\nand verifying that T 2 −T +",
    "I = Z is routine.",
    "(Geometrically, T 2 rotates by 2π/3.\n",
    "On the standard basis vector ⃗e1, the action of T 2 −T is to give the diﬀerence\nbetween the unit vector with angle 2π/3 and the unit vector with angle π/3,\nwhich is\n\u0000−1\n0\n\u0001\n.",
    "On ⃗e2 it gives\n\u0000 0\n−1\n\u0001\n.",
    "So T 2 −T = −I.)\n",
    "The space M2×2 has dimension four so we know that for any 2×2 matrix T\nthere is a fourth degree polynomial f such that f(T)",
    "= Z.",
    "But in that example\nwe exhibited a degree two polynomial that works.",
    "So while degree n2 always\nsuﬃces, in some cases a smaller-degree polynomial is enough.\n",
    "1.4 Deﬁnition The minimal polynomial m(x) of a transformation t or a square\nmatrix T is the non-zero polynomial of least degree and with leading coeﬃcient 1\nsuch that m(t) is the zero map or m(T) is the zero matrix.\n",
    "A minimal polynomial cannot be a constant polynomial because of the restriction\non the leading coeﬃcient.",
    "So a minimal polynomial must have degree at least\none.",
    "The zero matrix has minimal polynomial p(x)",
    "= x while the identity matrix\nhas minimal polynomial ˆp(x)",
    "= x −1.\n",
    "1.5 Lemma Any transformation or square matrix has a unique minimal polyno-\nmial.\n",
    "Proof First we prove existence.",
    "By the earlier observation that degree n2\nsuﬃces, there is at least one nonzero polynomial p(x)",
    "= ckxk + · · ·",
    "+ c0 that\ntakes the map or matrix to zero.",
    "From among all such polynomials take one\nwith the smallest degree.",
    "Divide this polynomial by its leading coeﬃcient ck to\nget a leading 1.",
    "Hence any map or matrix has at least one minimal polynomial.\n",
    "Now for uniqueness.",
    "Suppose that m(x) and ˆm(x) both take the map or\nmatrix to zero, are both of minimal degree and are thus of equal degree, and\nboth have a leading 1.",
    "Consider the diﬀerence, m(x) −ˆm(x).",
    "If it is not the zero\n\n442\nChapter Five.",
    "Similarity\npolynomial then it has a nonzero leading coeﬃcient.",
    "Dividing through by that\nleading coeﬃcient would make it a polynomial that takes the map or matrix to\nzero, has leading coeﬃcient 1, and is of smaller degree than m and ˆm (because\nin the subtraction the leading 1’s cancel).",
    "That would contradict the minimality\nof the degree of m and ˆm.",
    "Thus m(x) −ˆm(x) is the zero polynomial and the\ntwo are equal.\n",
    "QED\n1.6 Example One way to compute the minimal polynomial for the matrix of\nExample 1.3 is to ﬁnd the powers of T up to n2 = 4.\nT 2 =\n \n−1/2\n−\n√\n3/2\n√\n3/2\n−1/2\n!\n",
    "T 3 =\n \n−1\n0\n0\n−1\n!\n",
    "T 4 =\n \n−1/2\n√\n3/2\n−\n√\n3/2\n−1/2\n!\n",
    "Put c4T 4 + c3T 3 + c2T 2 + c1T + c0I equal to the zero matrix.\n−(1/2)c4 −c3 −\n(1/2)c2 +\n(1/2)c1 + c0 = 0\n(\n√\n3/2)c4\n−(\n√\n3/2)c2 −(\n√\n3/2)c1\n= 0\n−(\n√\n3/2)c4\n+ (\n√\n3/2)c2",
    "+ (\n√\n3/2)c1\n= 0\n−(1/2)c4 −c3 −\n(1/2)c2 +\n(1/2)c1 + c0 = 0\nApply Gauss’ Method.\n",
    "−(1/2)c4 −\nc3 −(1/2)c2 + (1/2)c1 +\nc0 = 0\n−(\n√\n3)c3 −\n√\n3c2\n+\n√\n3c0 = 0\nWith an eye toward making the degree of the polynomial as small as possible,\nnote that setting c4, c3, and c2 to zero forces c1 and c0 to also come out as zero\nso the equations won’t allow a degree one minimal polynomial.",
    "Instead, set c4\nand c3 to zero.",
    "The system\n−(1/2)c2 + (1/2)c1 +\nc0 = 0\n−\n√\n3c2\n+\n√\n3c0 = 0\nhas the solution set c1 = −c0 and c2 = c0.",
    "Taking the leading coeﬃcient to\nbe c2 = 1 gives the minimal polynomial x2 −x + 1.\n",
    "That computation is ungainly.",
    "We shall develop an alternative.\n",
    "1.7 Lemma Suppose that the polynomial f(x) = cnxn + · · · + c1x + c0 factors\nas k(x −λ1)q1 · · · (x −λz)qz.",
    "If t is a linear transformation then these two are\nequal maps.\n",
    "cntn + · · · + c1t",
    "+ c0 = k · (t −λ1)q1 ◦· · · ◦(t −λz)qz\nConsequently, if T is a square matrix then f(T) and k·(T −λ1I)q1 · · · (T −λzI)qz\nare equal matrices.\n\n",
    "Section IV.",
    "Jordan Form\n443\nProof We use induction on the degree of the polynomial.",
    "The cases where\nthe polynomial is of degree zero and degree one are clear.",
    "The full induction\nargument is Exercise 33 but we will give its sense with the degree two case.\n",
    "A quadratic polynomial factors into two linear terms f(x) = k(x −λ1) · (x −\nλ2) = k(x2 + (−λ1 −λ2)x + λ1λ2).",
    "Substituting t for x in the factored and\nunfactored versions gives the same map.\n\u0000k · (t −λ1) ◦(t −λ2)\n",
    "\u0001\n(⃗v) =\n\u0000k · (t −λ1)\n\u0001\n(t(⃗v) −λ2⃗v)\n= k ·\n\u0000t(t(⃗v))",
    "−t(λ2⃗v) −λ1t(⃗v) −λ1λ2⃗v\n\u0001\n= k ·\n\u0000t ◦t (⃗v) −(λ1",
    "+ λ2)t(⃗v)",
    "+",
    "λ1λ2⃗v\n\u0001\n= k · (t2 −(λ1 + λ2)t + λ1λ2) (⃗v)\n",
    "The third equality uses linearity of t to bring λ2 out of the second term.",
    "QED\n",
    "The next result is that every root of the minimal polynomial is an eigenvalue\nand that every eigenvalue is a root of the minimal polynomial.",
    "(That is, the resule\nsays ‘1 ⩽qi’ and not just ‘0 ⩽qi’.)",
    "For that, recall that to ﬁnd eigenvalues we\nsolve |T −xI| = 0 and this determinant gives a polynomial in x, the characteristic\npolynomial, whose roots are the eigenvalues.\n",
    "1.8 Theorem (Cayley-Hamilton)\n",
    "If the characteristic polynomial of a transforma-\ntion or square matrix factors into\nk · (x −λ1)p1(x −λ2)p2 · · · (x −λz)pz\nthen its minimal polynomial factors into\n(x −λ1)q1(x −λ2)q2 · · · (x −λz)qz\nwhere 1 ⩽qi ⩽pi for each i between 1 and z.\n",
    "The proof takes up the next three lemmas.",
    "We will state them in matrix terms\nbecause that version is convenient for the ﬁrst proof but they apply equally well\nto maps.\n",
    "The ﬁrst result is the key.",
    "For the proof, observe that we can view a matrix\nof polynomials as a polynomial with matrix coeﬃcients.\n \n",
    "2x2 + 3x −1\n",
    "x2 + 2\n3x2 + 4x + 1\n4x2",
    "+ x",
    "+ 1\n!\n",
    "=\n \n2\n1\n3\n4\n!\n",
    "x2 +\n \n3\n0\n4\n1\n!\n",
    "x +\n \n−1\n2\n1\n1\n!\n",
    "1.9 Lemma If T is a square matrix with characteristic polynomial c(x) then c(T)\nis the zero matrix.\n\n444\nChapter Five.",
    "Similarity\nProof Let C be T −xI, the matrix whose determinant is the characteristic\npolynomial c(x) = cnxn + · · · + c1x + c0.\n",
    "C =\n\n\n\n\n\n\nt1,1 −x\nt1,2\n. .",
    ".\n",
    "t2,1\nt2,2 −x\n...\n...\ntn,n −x\n\n\n\n\n\n\nRecall Theorem Four.III.1.9, that the product of a matrix with its adjoint equals\nthe determinant of the matrix times the identity.\nc(x) ·",
    "I = adj(C)C = adj(C)(T −xI) = adj(C)T −adj(C) · x\n(∗)\n",
    "The left side of (∗) is cnIxn+cn−1Ixn−1+· · ·+c1Ix+c0I.",
    "For the right side, the\nentries of adj(C) are polynomials, each of degree at most n −1 since the minors\nof a matrix drop a row and column.",
    "As suggested before the proof, rewrite it\nas a polynomial with matrix coeﬃcients: adj(C)",
    "= Cn−1xn−1 + · · · + C1x + C0\nwhere each Ci is a matrix of scalars.",
    "Now this is the right side of (∗).\n",
    "[(Cn−1T)xn−1 + · · · + (C1T)x + C0T] −[Cn−1xn + Cn−2xn−1 + · · · + C0x]\nEquate the left and right side of (∗)’s coeﬃcients of xn, of xn−1, etc.\n",
    "cnI = −Cn−1\ncn−1I = −Cn−2 + Cn−1T\n...\nc1I = −C0 + C1T\nc0I = C0T\nMultiply, from the right, both sides of the ﬁrst equation by T n, both sides of\nthe second equation by T n−1, etc.\n",
    "cnT n = −Cn−1T n\ncn−1T n−1 = −Cn−2T n−1 + Cn−1T n\n...\nc1T = −C0T + C1",
    "T 2\nc0I = C0T\nAdd.",
    "The left is cnT n +cn−1T n−1 +· · ·+c0I.",
    "The right telescopes; for instance,\n−Cn−1T n from the ﬁrst line combines with the Cn−1T n half of the second line.\n",
    "The total on the right is the zero matrix.\n",
    "QED\n\nSection IV.",
    "Jordan Form\n445\n",
    "We refer to that result by saying that a matrix or map satisﬁes its charac-\nteristic polynomial.\n",
    "1.10 Lemma Any polynomial that is satisﬁed by T is divisible by T’s minimal\npolynomial.",
    "That is, for a polynomial f(x), if f(T) is the zero matrix then f(x)\nis divisible by the minimal polynomial of T.\nProof Let m(x) be minimal for T. The Division Theorem for Polynomials gives\nf(x) = q(x) · m(x) + r(x) where the degree of r is strictly less than the degree of\nm. Because T satisﬁes both f and m, plugging T into that equation gives that\nr(T) is the zero matrix.",
    "That contradicts the minimality of m unless r is the\nzero polynomial.\n",
    "QED\n",
    "Combining the prior two lemmas shows that the minimal polynomial divides\nthe characteristic polynomial.",
    "Thus any root of the minimal polynomial is also\na root of the characteristic polynomial.\n",
    "Thus so far we have that if the minimal polynomial factors as m(x) =\n(x −λ1)q1 · · · (x −λi)qi then the characteristic polynomial also has the roots λ1,\n. . .",
    ", λi.",
    "But as far as what we have established to this point, the characteristic\npolynomial might have additional roots: c(x) = (x −λ1)p1 · · · (x −λi)pi(x −\nλi+1)pi+1 · · · (x −λz)pz, where 1 ⩽qj ⩽pj for 1 ⩽j ⩽i.",
    "We ﬁnish the proof of\nthe Cayley-Hamilton Theorem by showing that the characteristic polynomial\nhas no additional roots so that there are no λi+1, λi+2, etc.\n",
    "1.11 Lemma Each linear factor of the characteristic polynomial of a square matrix\nis also a linear factor of the minimal polynomial.\n",
    "Proof Let T be a square matrix with minimal polynomial m(x) of degree n and\nassume that x −λ is a factor of the characteristic polynomial of T, so that λ is\nan eigenvalue of T. We will show that m(λ) = 0, i.e., that x −λ is a factor of m.\nAssume that λ is associated with the eigenvector ⃗v and consider the powers\nT 2(⃗v), . . .",
    ", T n(⃗v).",
    "We have T 2(⃗v) = T ·",
    "λ⃗v = λ · T⃗v = λ2⃗v.",
    "The same happens for\nall of the powers: T i⃗v = λi⃗v for 1 ⩽i ⩽n.",
    "Thus for any polynomial function\np(x), application of the matrix p(T) to ⃗v equals the result of multiplying ⃗v by\nthe scalar p(λ).\n",
    "p(T)⃗v = (ckT k + · · · + c1T + c0I)⃗v",
    "= ckT k⃗v + · · ·",
    "+ c1T⃗v + c0⃗v\n= ckλk⃗v + · · · + c1λ⃗v + c0⃗v = p(λ) ·⃗v\nSince m(T) is the zero matrix, ⃗0 = m(T)(⃗v) = m(λ) ·⃗v and hence m(λ) = 0, as\n⃗v ̸= ⃗0 because it is an eigenvector.\nQED\nThat concludes the proof of the Cayley-Hamilton Theorem.\n\n446\nChapter Five.",
    "Similarity\n1.12 Example",
    "We can use the Cayley-Hamilton Theorem to ﬁnd the minimal\npolynomial of this matrix.\n",
    "T =\n\n\n\n\n\n2\n0\n0\n1\n1\n2\n0\n2\n0\n0\n2\n−1\n0\n0\n0\n1\n\n\n\n\n\n",
    "First we ﬁnd its characteristic polynomial c(x) = (x −1)(x −2)3 with the usual\ndeterminant |T −xI|.",
    "With that, the Cayley-Hamilton Theorem says that T’s\nminimal polynomial is either (x −1)(x −2) or (x −1)(x −2)2 or (x −1)(x −2)3.\n",
    "We can decide among the choices just by computing\n(T −1I)(T −2I) =\n\n\n\n\n\n1\n0\n0\n1\n1\n1\n0\n2\n0\n0\n1\n−1\n0\n0\n0\n0\n\n\n\n\n\n\n\n\n\n\n0\n0\n0\n1\n1\n0\n0\n2\n0\n0\n0\n−1\n0\n0\n0\n−1\n\n\n\n\n=\n\n\n\n\n\n0\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\nand\n(T −1I)(T −2I)2 =\n\n\n\n\n\n0\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n\n\n\n0\n0\n0\n1\n1\n0\n0\n2\n0\n0\n0\n−1\n0\n0\n0\n−1\n\n\n\n\n=\n\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\nand so m(x) = (x −1)(x −2)2.\n",
    "Exercises\n✓1.13 What are the possible minimal polynomials if a matrix has the given character-\nistic polynomial?\n(a) (x −3)4\n(b) (x + 1)3(x −4)\n(c) (x −2)2(x −5)2\n(d) (x + 3)2(x −1)(x −2)2\nWhat is the degree of each possibility?\n1.14",
    "For this matrix\n\n\n\n\n0\n1\n0\n1\n1\n0\n1\n0\n0\n1\n0\n1\n1\n0\n1\n0\n\n\n\n\nﬁnd the characteristic polynomial and the minimal polynomial.\n1.15 Find the minimal polynomial of this matrix.\n\n\n0\n1\n0\n0\n0\n1\n1\n0\n0\n\n\n✓1.16 Find the minimal polynomial of each matrix.\n\nSection IV.",
    "Jordan Form\n447\n(a)\n\n\n3\n0\n0\n1\n3\n0\n0\n0\n4\n\n\n(b)\n\n\n3\n0\n0\n1\n3\n0\n0\n0\n3\n\n\n(c)\n\n\n3\n0\n0\n1\n3\n0\n0\n1\n3\n\n\n(d)\n\n\n2\n0\n1\n0\n6\n2\n0\n0\n2\n\n\n(e)\n\n\n2\n2\n1\n0\n6\n2\n0\n0\n2\n\n\n(f)\n\n\n\n\n\n\n\n−1\n4\n0\n0\n0\n0\n3\n0\n0\n0\n0\n−4\n−1\n0\n0\n3\n−9\n−4\n2\n−1\n1\n5\n4\n1\n4\n\n\n\n\n\n\n\n✓1.17",
    "What is the minimal polynomial of the diﬀerentiation operator d/dx on Pn?\n✓1.18 Find the minimal polynomial of matrices of this form\n\n\n\n\n\n\n\n\n\n\nλ\n0\n0\n. .",
    ".\n",
    "0\n1\nλ\n0\n0\n0\n1\nλ\n...\nλ\n0\n0\n0\n. .",
    ".\n",
    "1\nλ\n\n\n\n\n\n\n\n\n\n\nwhere the scalar λ is ﬁxed (i.e., is not a variable).\n",
    "1.19 What is the minimal polynomial of the transformation of Pn that sends p(x)\nto p(x + 1)?\n",
    "1.20 What is the minimal polynomial of the map π: C3 →C3 projecting onto the\nﬁrst two coordinates?\n1.21 Find a 3×3 matrix whose minimal polynomial is x2.\n",
    "1.22 What is wrong with this claimed proof of Lemma 1.9: “if c(x) = |T −xI| then\nc(T) = |T −TI| = 0 ” ?",
    "[Cullen]\n1.23 Verify Lemma 1.9 for 2×2 matrices by direct calculation.\n",
    "✓1.24 Prove that the minimal polynomial of an n×n matrix has degree at most n\n(not n2 as a person might guess from this subsection’s opening).",
    "Verify that this\nmaximum, n, can happen.\n",
    "✓1.25 Show that, on a nontrivial vector space, a linear transformation is nilpotent if\nand only if its only eigenvalue is zero.\n",
    "1.26 What is the minimal polynomial of a zero map or matrix?",
    "Of an identity map\nor matrix?\n✓1.27 What is the minimal polynomial of a diagonal matrix?\n",
    "✓1.28",
    "A projection is any transformation t such that t2 = t. (For instance, consider\nthe transformation of the plane R2 projecting each vector onto its ﬁrst coordinate.\n",
    "If we project twice then we get the same result as if we project just once.)",
    "What is\nthe minimal polynomial of a projection?\n1.29",
    "The ﬁrst two items of this question are review.\n",
    "(a) Prove that the composition of one-to-one maps is one-to-one.\n",
    "(b) Prove that if a linear map is not one-to-one then at least one nonzero vector\nfrom the domain maps to the zero vector in the codomain.\n\n",
    "448\nChapter Five.",
    "Similarity\n(c) Verify the statement, excerpted here, that precedes Theorem 1.8.\n. .",
    ".\n",
    "if a minimal polynomial m(x) for a transformation t factors as\nm(x) = (x −λ1)q1 · · · (x −λz)qz then m(t) = (t −λ1)q1 ◦· · · ◦(t −λz)qz\nis the zero map.",
    "Since m(t) sends every vector to zero, at least one of\nthe maps t −λi sends some nonzero vectors to zero. . . .",
    "That is, . . .\n",
    "at least some of the λi are eigenvalues.\n",
    "1.30 True or false: for a transformation on an n dimensional space, if the minimal\npolynomial has degree n then the map is diagonalizable.\n",
    "1.31 Let f(x) be a polynomial.",
    "Prove that if A and B are similar matrices then f(A)\nis similar to f(B).\n",
    "(a) Now show that similar matrices have the same characteristic polynomial.\n",
    "(b) Show that similar matrices have the same minimal polynomial.\n",
    "(c) Decide if these are similar.\n",
    "\u00121\n3\n2\n3\n\u0013\n\u00124\n−1\n1\n1\n\u0013\n1.32\n(a) Show that a matrix is invertible if and only if the constant term in its\nminimal polynomial is not 0.\n(b) Show that if a square matrix T is not invertible then there is a nonzero matrix\nS such that ST and TS both equal the zero matrix.\n",
    "✓1.33\n(a) Finish the proof of Lemma 1.7.\n(b) Give an example to show that the result does not hold if t is not linear.\n",
    "1.34 Any transformation or square matrix has a minimal polynomial.",
    "Does the\nconverse hold?\nIV.2\n",
    "Jordan Canonical Form\nWe are looking for a canonical form for matrix similarity.",
    "This subsection\ncompletes this program by moving from the canonical form for the classes of\nnilpotent matrices to the canonical form for all classes.\n",
    "2.1 Lemma A linear transformation on a nontrivial vector space is nilpotent if\nand only if its only eigenvalue is zero.\n",
    "Proof If the linear transformation t on a nontrivial vector space is nilpotent\nthen there is an n such that tn is the zero map, so t satisﬁes the polynomial\np(x)",
    "= xn = (x−0)n.",
    "By Lemma 1.10 the minimal polynomial of t divides p, so\nthe minimal polynomial’s only root is zero.",
    "By Cayley-Hamilton, Theorem 1.8,\nthe characteristic polynomial’s only root is zero.",
    "Thus t’s only eigenvalue is\nzero.\n\n",
    "Section IV.",
    "Jordan Form\n449\nConversely, if a transformation t on an n-dimensional space has only the\nsingle eigenvalue of zero then its characteristic polynomial is xn.",
    "Lemma 1.9\nsays that a map satisﬁes its characteristic polynomial so tn is the zero map.\n",
    "Thus t is nilpotent.\n",
    "QED\nThe ‘nontrivial vector space’ is in the statement of that lemma because on a\ntrivial space {⃗0} the only transformation is the zero map, which has no eigenvalues\nbecause there are no associated nonzero eigenvectors.\n",
    "2.2 Corollary The transformation t−λ is nilpotent if and only if t’s only eigenvalue\nis λ.\nProof The transformation t−λ is nilpotent if and only if t−λ’s only eigenvalue\nis 0.",
    "That holds if and only if t’s only eigenvalue is λ, because t(⃗v)",
    "= λ⃗v",
    "if and\nonly if (t −λ) (⃗v) = 0 ·⃗v.\n",
    "QED\n2.3 Lemma",
    "If the matrices T −λI and N are similar then T and N + λI are also\nsimilar, via the same change of basis matrices.\nProof With N = P(T −λI)P−1 = PTP−1 −P(λI)P−1 we have N = PTP−1 −\nPP−1(λI) because the diagonal matrix λI commutes with anything.",
    "Thus N =\nPTP−1 −λI, and therefore N + λI = PTP−1.\n",
    "QED\n",
    "We already have the canonical form for the case of nilpotent matrices, that is,\nfor the case of matrices whose only eigenvalue is zero.",
    "By Corollary III.2.17, each\nsuch matrix is similar to one that is all zeroes except for blocks of subdiagonal\nones.",
    "The prior results let us extend this to all matrices that have a single\neigenvalue λ.",
    "In the new form, besides blocks of subdiagonal ones, all of the\nentries on the diagonal are λ.",
    "(See Deﬁnition 2.6 below.)\n",
    "2.4 Example The characteristic polynomial of\nT =\n \n2\n−1\n1\n4\n!\nis (x −3)2 and so T has a single eigenvalue, 3.\n",
    "Because 3 is the only eigenvalue, T −3I has the single eigenvalue of 0 and\nis therefore nilpotent.",
    "To get the canonical form of T, start by ﬁnding a string\nbasis for T −3I as in the prior section, computing the powers of this matrix and\nthe null spaces of those powers.\n\n450\nChapter Five.",
    "Similarity\npower p\n(T −3I)p\nN ((T −3I)p)\n1\n \n−1\n−1\n1\n1\n!\n{\n \n−y\ny\n!\n",
    "| y ∈C}\n2\n \n0\n0\n0\n0\n!\n{\n \nx\ny\n!\n",
    "| x, y ∈C}\nThe null space of t −3 has dimension one and the null space of (t −3)2 has\ndimension two.",
    "So this is the canonical representation matrix and the form of\nthe associated string basis B for t −3.\n",
    "RepB,B(t −3)",
    "= N =\n \n0\n0\n1\n0\n!\n",
    "⃗β1\nt−3\n7−−→⃗β2\nt−3\n7−−→⃗0\nFind such a basis by ﬁrst picking a ⃗β2 that is mapped to ⃗0 by t −3",
    "(that is,\npick an element of the null space N (t −3) given in the table).",
    "Then choose\na ⃗β1 that is mapped to ⃗0 by (t −3)2.\n",
    "The only restriction on the choice,\nbesides membership in the null space, is that ⃗β1 and ⃗β2 need to form a linearly\nindependent set.",
    "Here is one possible choice.\n",
    "⃗β1 =\n \n1\n1\n!\n",
    "⃗β2 =\n \n−2\n2\n!\n",
    "With that, Lemma 2.3 says that T is similar to this matrix.\n",
    "RepB,B(t) = N + 3I =\n \n3\n0\n1\n3\n!\n",
    "We can exhibit the similarity computation.",
    "Take T to represent a transfor-\nmation t: C2 →C2 with respect to the standard basis (as we shall do for the\nrest of the chapter).",
    "The similarity diagram\nC2\nwrt E2\nt−3\n−−−−→\nT−3I\nC2\nwrt E2\nid\nyP\nid\nyP\nC2\nwrt B\nt−3\n−−−−→\nN\nC2\nwrt B\ndescribes that to move from the lower left to the upper left we multiply by\nP−1 =\n\u0000RepE2,B(id)\n\u0001−1 = RepB,E2(id) =\n \n1\n−2\n1\n2\n!\n\nSection IV.",
    "Jordan Form\n451\nand to move from the upper right to the lower right we multiply by this matrix.\n",
    "P =\n \n1\n−2\n1\n2\n!−1\n=\n \n1/2\n1/2\n−1/4\n1/4\n!\n",
    "So this equation shows the similarity.\n \n1/2\n1/2\n−1/4\n1/4\n!  \n2\n−1\n1\n4\n!  \n1\n−2\n1\n2\n!\n",
    "=\n \n3\n0\n1\n3\n!\n2.5 Example",
    "This matrix\nT =\n\n\n\n\n\n4\n1\n0\n−1\n0\n3\n0\n1\n0\n0\n4\n0\n1\n0\n0\n5\n\n\n\n\n\nhas characteristic polynomial (x −4)4 and so has the single eigenvalue 4.\npower p\n(T −4I)p\nN ((T −4I)p)\n1\n\n\n\n\n\n0\n1\n0\n−1\n0\n−1\n0\n1\n0\n0\n0\n0\n1\n0\n0\n1\n\n\n\n\n\n{\n\n\n\n\n\n−w\nw\nz\nw\n\n\n\n\n\n| z, w ∈C}\n2\n\n\n\n\n\n−1\n−1\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n\n\n\n\n\n{\n\n\n\n\n\n−y\ny\nz\nw\n\n\n\n\n\n| y, z, w ∈C}\n3\n\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n{\n\n\n\n\n\nx\ny\nz\nw\n\n",
    "\n\n\n\n| x, y, z, w ∈C}\n",
    "The null space of t−4 has dimension two, the null space of (t−4)2 has dimension\nthree, and the null space of (t −4)3 has dimension four.",
    "This gives the canonical\nform for t −4.\n",
    "N = RepB,B(t −4) =\n\n\n\n\n\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n⃗β1\nt−4\n7−−→⃗β2\nt−4\n7−−→⃗β3\nt−4\n7−−→⃗0\n⃗β4\nt−4\n7−−→⃗0\n\n452\nChapter Five.",
    "Similarity\nTo produce such a basis, choose a ⃗β3 and ⃗β4 that are mapped to ⃗0 by t−4.",
    "Also\nchoose a ⃗β2 that is mapped to ⃗0 by (t −4)2 and a ⃗β1 is mapped to ⃗0 by (t −4)3.\n",
    "⃗β1 =\n\n\n\n\n\n1\n0\n0\n0\n\n\n\n\n\n⃗β2 =\n\n\n\n\n\n−1\n1\n0\n0\n\n\n\n\n\n⃗β3 =\n\n\n\n\n\n−1\n1\n0\n1\n\n\n\n\n\n⃗β4 =\n\n\n\n\n\n0\n0\n1\n0\n\n\n\n\n\nNote that these four were chosen to not have any linear dependences.",
    "This is\nthe canonical form matrix similar to T.\nRepB,B(t) = N + 4I =\n\n\n\n\n\n4\n0\n0\n0\n1\n4\n0\n0\n0\n1\n4\n0\n0\n0\n0\n4\n\n\n\n\n\n2.6 Deﬁnition A Jordan block is a square matrix, or a square block of entries\ninside of a matrix, that is all zeroes except that there is a number λ ∈C such\nthat every diagonal entry is λ, and that every subdiagonal entry is 1.",
    "(If the\nblock is 1×1 then it has no subdiagonal 1’s.)\n",
    "The strings in the associated basis are Jordan strings or Jordan chains.\n",
    "The above examples illustrate that for single-eigenvalue matrices, the Jordan\nblock matrices are canonical representatives of the similarity classes.",
    "We can\nmake this matrix form unique by arranging the basis elements so that the blocks\nof subdiagonal ones go from longest to shortest, reading left to right.\n",
    "2.7 Example The 3×3 matrices whose only eigenvalue is 1/2 separate into three\nsimilarity classes.",
    "The three classes have these canonical representatives.\n",
    "\n\n\n1/2\n0\n0\n0\n1/2\n0\n0\n0\n1/2\n\n\n\n\n\n\n1/2\n0\n0\n1\n1/2\n0\n0\n0\n1/2\n\n\n\n\n\n\n1/2\n0\n0\n1\n1/2\n0\n0\n1\n1/2\n\n\n\nIn particular, this matrix\n\n\n\n1/2\n0\n0\n0\n1/2\n0\n0\n1\n1/2\n\n\n\nbelongs to the similarity class represented by the middle one, because of the\nconvention of ordering the blocks of subdiagonal ones.\n",
    "We are now set up to ﬁnish the program of this chapter.",
    "First we review of\nwhat we have so far about transformations t: Cn →Cn.\n\nSection IV.",
    "Jordan Form\n453\n",
    "The diagonalizable case is where t has n distinct eigenvalues λ1, . . .",
    ", λn,\nthat is, where the number of eigenvalues equals the dimension of the space.",
    "In\nthis case there is a basis ⟨⃗β1, . . .",
    ", ⃗βn⟩where ⃗βi is an eigenvector associated with\nthe eigenvalue λi.",
    "The example below has n = 3 and the three eigenvalues are\nλ1 = 1, λ2 = 3, and λ3 = −1.",
    "It shows the canonical representative matrix and\nthe associated basis.\n",
    "T1 =\n\n\n\n1\n0\n0\n0\n3\n0\n0\n0\n−1\n\n\n\n⃗β1\nt−1\n7−→⃗0\n⃗β2\nt−3\n7−→⃗0\n⃗β3\nt+1\n7−→⃗0\nOne diagonalization example is Five.II.3.21.\n",
    "The case where t has a single eigenvalue leverages the results on nilpotency\nto get a basis of associated eigenvectors that form disjoint strings.",
    "This example\nhas n = 10, a single eigenvalue λ",
    "= 2, and ﬁve Jordan blocks.\n",
    "T2 =\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n⃗β1\nt−2\n7−→⃗β2\nt−2\n7−→⃗β3\nt−2\n7−→⃗0\n⃗β4\nt−2\n7−→⃗β5\nt−2\n7−→⃗β6\nt−2\n7−→⃗0\n⃗β7\nt−2\n7−→⃗β8\nt−2\n7−→⃗0\n⃗β9\nt−2\n7−→⃗0\n⃗β10\nt−2\n7−→⃗0\nWe saw a full example as Example 2.5.\n",
    "Theorem 2.8 below extends these two to any transformation t: Cn →Cn.\n",
    "The canonical form consists of Jordan blocks containing the eigenvalues.",
    "This\nillustrates such a matrix for n = 6 with eigenvalues 3, 2, and −1 (examples with\nfull compuations are after the theorem).\n",
    "T3 =\n\n\n\n\n\n\n\n\n\n3\n0\n0\n0\n0\n0\n1\n3\n0\n0\n0\n0\n0\n0\n3\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n0\n0\n0\n−1\n\n\n\n\n\n\n\n\n\n⃗β1\nt−3\n7−→⃗β2\nt−3\n7−→⃗0\n⃗β3\nt−3\n7−→⃗0\n⃗β4\nt−2\n7−→⃗β5\nt−2\n7−→⃗0\n⃗β6\nt+1\n7−→⃗0\nIt has four blocks, two associated with the eigenvalue 3, and one each with 2\nand −1.\n\n",
    "454\nChapter Five.",
    "Similarity\n2.8 Theorem Any transformation t: Cn →Cn can be represented in Jordan\nform, where each Jλ is a Jordan block.\n",
    "\n\n\n\n\n\nJλ1\n–zeroes–\nJλ2\n...\n–zeroes–\nJλk\n\n\n\n\n\n\nRestated, any n×n matrix is similar to one in this form.\n",
    "In the prior example, if we apply t −3 to the basis then it will send two\nelements, ⃗β2 and ⃗β3, to ⃗0.",
    "This suggests doing the proof by induction since the\ndimension of the range space R(t",
    "−3) is less than that of the starting space.\n",
    "Proof We will do induction on n. The n = 1 base case is trivial since any 1×1\nmatrix is in Jordan form.",
    "For the inductive step assume that every transformation\nof C1, . . .",
    ", Cn−1 has a Jordan form representation and ﬁx t: Cn →Cn.\n",
    "Any transformation has at least one eigenvalue λ1 because it has a minimal\npolynomial, which has at least one root over the complex numbers.\n",
    "That\neigenvalue has a nonzero eigenvector ⃗v, so that (t −λ1)(⃗v) = ⃗0.",
    "Thus the\ndimension of N (t −λ1), the map’s nullity, is greater than zero.",
    "Since the rank\nplus the nullity equals the dimension of the domain, the rank of t −λ1 is strictly\nless than n. Write W for the range space R(t −λ1) and write r for the rank, its\ndimension.\n",
    "If ⃗w ∈W = R(t −λ1) then ⃗w ∈Cn",
    "and so (t −λ1)(⃗w)",
    "∈R(t −λ1).",
    "Thus\nthe restriction of t −λ1 to W induces a transformation of W, which we shall also\ncall t −λ1.",
    "The dimension of W is less than n and so the inductive hypothesis\napplies and we get a basis for W consisting of disjoint strings that are associated\nwith the eigenvalues of t −λ1 on W.",
    "For any λ that is an eigenvalue of t −λ1,\nthe transformation of the basis elements will be (t −λ1)",
    "−λ = t −(λ1 −λ),\nwhich we will write as t −λs.",
    "This diagram shows some strings for t −λ1, that\nis, where λ = 0; the argument remains valid if there are no such strings.\n⃗w1,n1\nt−λ1\n7−−−→· · ·\nt−λ1\n7−−−→⃗w1,1\nt−λ1\n7−−−→⃗0\n...\n⃗wq,nq\nt−λ1\n7−−−→· · ·\nt−λ1\n7−−−→⃗wq,1\nt−λ1\n7−−−→⃗0\n⃗wq+1,nq+1\nt−λ2\n7−−−→· · ·\nt−λ2\n7−−−→⃗wq+1,1\nt−λ2\n7−−−→⃗0\n...\n⃗wk,nk\nt−λi\n7−−−→· · ·\nt−λi\n",
    "7−−−→⃗wk,1\nt−λi\n7−−−→⃗0\nThese strings may have diﬀering lengths; for instance, perhaps n1 ̸= nk.\n\nSection IV.",
    "Jordan Form\n455\n",
    "The rightmost non-⃗0 vectors ⃗w1,1, . . .",
    ", ⃗wk,1 are in the null space of the\nassociated maps, (t −λ1)(⃗w1,1) = ⃗0, . . .",
    ", (t −λi)(⃗wk,1) = ⃗0.",
    "Thus the number\nof strings associated with t −λ1, denoted q in the above diagram, is equal to\nthe dimension of W ∩N (t −λ1).\n",
    "The string basis above is for the space W = R(t −λ1).",
    "We now expand it to\nmake it a basis for all of Cn.",
    "First, because each of the vectors ⃗w1,n1, . . .",
    ", ⃗wq,nq\nis an element of R(t−λ1), each is the image of some vector from Cn.",
    "Preﬁx each\nstring with one such vector, ⃗x1, . . .",
    ", ⃗xq, as shown below.",
    "Second, the dimension\nof W ∩N (t −λ1) is q, and the dimension of W is r, so the bookkeeping requires\nthat there be a subspace Y ⊆N (t−λ1) with dimension r−q whose intersection\nwith W is {⃗0}.",
    "Consequently, pick r −q linearly independent vectors ⃗y1, . . .",
    ",\n⃗yr−q ∈N (t −λ1) and incorporate them into the list of strings, again as shown\nbelow.\n",
    "⃗x1\nt−λ1\n7−−−→\n⃗w1,n1\nt−λ1\n7−−−→· · ·\nt−λ1\n7−−−→\n⃗w1,1\nt−λ1\n7−−−→⃗0\n...\n⃗xq\nt−λ1\n7−−−→\n⃗wq,nq\nt−λ1\n7−−−→· · ·\nt−λ1\n7−−−→\n⃗wq,1\nt−λ1\n7−−−→⃗0\n⃗wq+1,nq+1\nt−λ2\n7−−−→· · ·\nt−λ2\n7−−−→⃗wq+1,1\nt−λ2\n7−−−→⃗0\n...\n⃗wk,nk\nt−λi\n7−−−→· · ·\nt−λi\n7−−−→\n⃗wk,1\nt−λi\n7−−−→⃗0\n⃗y1\nt−λ1\n7−−−→⃗0\n...\n⃗yr−q\nt−λ1\n7−−−→⃗0\nWe will show that this is the desired basis for Cn.\nBecause of the bookkeeping the number of vectors in the set is equal to the\ndimension of the space, so we will be done if we verify that its elements are\nlinearly independent.",
    "Assume that this is equal to ⃗0.\n",
    "a1⃗x1 + · · · + aq⃗xq + b1,n1 ⃗w1,n1 + · · ·",
    "+ bk,1⃗wk,1 + c1⃗y1 + · · · + cr−q⃗yr−q (∗)\nWe ﬁrst show that that all of the a’s are zero.",
    "Apply t −λ1 to (∗).",
    "The vectors\n⃗y1, . .",
    ". , ⃗yr−q go to ⃗0.",
    "Each of the vectors ⃗xi is sent to ⃗wi,ni.",
    "As to the ⃗w’s,\nthey have the property that (t −λk)",
    "⃗wi,j = ⃗wi,j−1 for some λk.",
    "Write ˆλ for\nλ1 −λk to get this.\n",
    "(t −λ1)(⃗wi,j) = (t −(λ1 −ˆλ) + ˆλ)(⃗wi,j) = ⃗wi,j−1 + ˆλ · ⃗wi,j\n(∗∗)\n",
    "Thus, applying t −λ1 to (∗) ends with a linear combination of ⃗w’s.",
    "These\nvectors are linearly independent because they form a basis for W and so in this\n\n456\nChapter Five.",
    "Similarity\nlinear combination the coeﬃcients are 0.",
    "We will be done showing that ai = 0\nfor i = 1, . . .",
    ", q are zero if we verify that after we apply t −λ1 to (∗) then the\ncoeﬃcient of ⃗wi,ni is ai.",
    "But that’s true because for i = 1, . . .",
    ", q, equation (∗∗)\nhas ˆλ = 0 and so ⃗wi,ni is the image of xi alone.\n",
    "With the a’s equal to zero, what remains of (∗) is this.\n",
    "⃗0 = b1,n1 ⃗w1,n1 + · · · + bk,1⃗wk,1 + c1⃗y1 + · · · + cr−q⃗yr−q\nRewrite as −(b1,n1 ⃗w1,n1 +· · ·+bk,1⃗wk,1) = c1⃗y1+· · ·+cr−q⃗yr−q.",
    "The ⃗w’s are\nfrom W while the ⃗y’s are from Y and the two spaces have only a trivial intersection.\n",
    "Consequently b1,n1 ⃗w1,n1 + · · · + bk,1⃗wk,1 = ⃗0 and c1⃗y1 + · · · + cr−q⃗yr−q = ⃗0,\nand the b’s and c’s are all zero.\n",
    "QED\n2.9 Remark Technically, to be a canonical form for matrix similarity, Jordan form\nmust be unique.",
    "That is, for any square matrix there should be one and only\none matrix similar to it that is in Jordan form.",
    "We could make the theorem’s\nform unique by arranging the Jordan blocks so the eigenvalues are in some\nspeciﬁed order, and then arranging the blocks of subdiagonal ones from longest\nto shortest.",
    "In the examples below, we won’t address that.\n",
    "The examples to follow start with a matrix and calculate a Jordan form\nmatrix similar to it.",
    "Before those we will make one more point.",
    "For instance, in\nthe ﬁrst example belos we ﬁnd that the eigenvalues are 2 and 6.",
    "To pick the basis\nelements related to 2 we ﬁnd the null spaces of t −2, (t −2)2 and (t −2)3.",
    "That\nis, to ﬁnd the elements of this example’s basis we will look in the generalized null\nspaces N∞(t −2) and N∞(t −6).",
    "But we need to be sure that the calculation\nfor each map does not aﬀect the calculation for the other.\n",
    "2.10 Deﬁnition Let t: V →V be a transformation.",
    "A subspace M ⊆V is t\ninvariant if whenever ⃗m ∈M then t(⃗m) ∈M (shorter: t(M) ⊆M).\n",
    "2.11 Lemma A subspace is t invariant if and only if it is t −λ invariant for all\nscalars λ.",
    "In particular, if λi, λj ∈C are unequal eigenvalues of t then the spaces\nN∞(t −λi) and R∞(t −λi) are t −λj invariant.\n",
    "Proof The right-to-left half of the ﬁrst sentence is trivial: if the subspace is\nt −λ invariant for all scalars λ then taking λ = 0 shows that it is t invariant.\n",
    "For the other half suppose that the subspace is t invariant, so that if ⃗m ∈M\nthen t(⃗m) ∈M, and let λ be a scalar.",
    "The subspace M is closed under linear\ncombinations and so if t(⃗m) ∈M then t(⃗m)",
    "−λ⃗m",
    "∈M.",
    "Thus if ⃗m ∈M then\n(t −λ) (⃗m) ∈M.\nThe second sentence follows from the ﬁrst.",
    "The two spaces are t−λi invariant,\nso they are t invariant.",
    "Applying the ﬁrst sentence again gives that they are\nalso t −λj invariant.\n",
    "QED\n\nSection IV.",
    "Jordan Form\n457\n2.12 Example",
    "This matrix\nT =\n\n\n\n2\n0\n1\n0\n6\n2\n0\n0\n2\n\n\n\nhas the characteristic polynomial (x −2)2(x −6).\n",
    "|T −xI| =\n\f\f\f\f\f\f\f\n2 −x\n0\n1\n0\n6 −x\n2\n0\n0\n2 −x\n\f\f\f\f\f\f\f\n= (x −2)2(x −6)\n",
    "First we do the eigenvalue 2.",
    "Computation of the powers of T −2I, and of\nthe null spaces and nullities, is routine.",
    "(Recall our convention of taking T to\nrepresent a transformation t: C3 →C3 with respect to the standard basis.)\n",
    "p\n(T −2I)p\nN ((t −2)p)\nnullity\n1\n\n\n\n\n0\n0\n1\n0\n4\n2\n0\n0\n0\n\n\n\n\n{\n\n\n\n\nx\n0\n0\n\n\n\n| x ∈C}\n1\n2\n\n\n\n\n0\n0\n0\n0\n16\n8\n0\n0\n0\n\n\n\n\n{\n\n\n\n\nx\n−z/2\nz\n\n\n\n| x, z ∈C}\n2\n3\n\n\n\n\n0\n0\n0\n0\n64\n32\n0\n0\n0\n\n\n\n\n–same–\n–same–\n",
    "So the generalized null space N∞(t −2) has dimension two.",
    "We know that the\nrestriction of t −2 is nilpotent on this subspace.",
    "From the way that the nullities\ngrow we know that the action of t −2 on a string basis is ⃗β1 7→⃗β2 7→⃗0.",
    "Thus\nwe can represent the restriction in the canonical form\nN2 =\n \n0\n0\n1\n0\n!\n= RepB,B(t −2)\nB2 = ⟨\n\n\n\n1\n1\n−2\n\n\n,\n\n\n\n−2\n0\n0\n\n\n⟩\n(other choices of basis are possible).",
    "Consequently, the action of the restriction\nof t to N∞(t −2) is represented by this Jordan block.\n",
    "J2 = N2 + 2I = RepB2,B2(t) =\n \n2\n0\n1\n2\n!\n\n458\nChapter Five.",
    "Similarity\nThe second eigenvalue is 6.",
    "Its computations are easier.",
    "Because the power of\nx−6 in the characteristic polynomial is one, the restriction of t−6 to N∞(t−6)\nmust be nilpotent, of index one (it can’t be of index less than one and since\nx −6 is a factor of the characteristic polynomial with the exponent one it can’t\nbe of index more than one either).",
    "Its action on a string basis must be ⃗β3 7→⃗0\nand since it is the zero map, its canonical form N6 is the 1×1 zero matrix.\n",
    "Consequently, the canonical form J6 for the action of t on N∞(t −6) is the\n1×1 Jordan block matrix with the single entry 6.",
    "For the basis we can use any\nnonzero vector from the generalized null space.\n",
    "B6 = ⟨\n\n\n\n0\n1\n0\n\n\n⟩\nTaken together, these two give that the Jordan form of T is\nRepB,B(t) =\n\n\n\n2\n0\n0\n1\n2\n0\n0\n0\n6\n\n\n\nwhere B is the concatenation of B2 and B6.",
    "(If we want to be careful about\ngetting a unique Jordan form then we could, for instance, rearrange the basis\nelements to have the eigenvalues in descending order.",
    "But, ascending order is\nﬁne also.)\n",
    "2.13 Example This matrix has the same characteristic polynomial as the prior\nexample, (",
    "x −2)2(x −6).\n",
    "T =\n\n\n\n2\n2\n1\n0\n6\n2\n0\n0\n2\n\n\n\n",
    "But here the action of t −2 is stable after only one application — the restriction\nof t −2 to N∞(t −2) is nilpotent of index one.\n",
    "p\n(T −2I)p\nN ((t −2)p)\nnullity\n1\n\n\n\n0\n2\n1\n0\n4\n2\n0\n0\n0\n\n\n\n{\n\n\n\nx\n(−1/2)z\nz\n\n\n| x, z ∈C}\n2\n2\n\n\n\n0\n8\n4\n0\n16\n8\n0\n0\n0\n\n\n\n–same–\n–same–\n\nSection IV.",
    "Jordan Form\n459\n",
    "So the restriction of t −2 to the generalized null space acts on a string basis via\nthe two strings ⃗β1 7→⃗0 and ⃗β2 7→⃗0.",
    "We have this Jordan block associated with\nthe eigenvalue 2.\n",
    "J2 =\n \n2\n0\n0\n2\n!\n",
    "Thus, the contrast with the prior example is that while the characteristic\npolynomial tells us to look at the action of t−2 on its generalized null space, the\ncharacteristic polynomial does not completely describe t −2’s action.",
    "We must\ndo some computations to ﬁnd that the minimal polynomial is (x −2)(x −6).\n",
    "For the eigenvalue 6, the arguments for the second eigenvalue of the prior\nexample apply again: because the power of x −6 in the characteristic polynomial\nis one, the restriction of t −6 to N∞(t −6) must be nilpotent of index one.\n",
    "Alternatively, we can just compute it.\n",
    "p\n(T −6I)p\nN ((t −6)p)\nnullity\n1\n\n\n\n−4\n2\n1\n0\n0\n2\n0\n0\n−4\n\n\n\n{\n\n\n\nx\n2x\n0\n\n\n| x ∈C}\n1\n2\n\n\n\n16\n−8\n−4\n0\n0\n−8\n0\n0\n16\n\n\n\n–same–\n–same–\nEither way, on N∞(t −6)",
    "the restriction t −6’s canonical form N6 is the 1×1\nzero matrix.",
    "The Jordan block J6 is the 1×1 matrix with entry 6.\n",
    "Therefore the Jordan form for T is a diagonal matrix and so t is a diagonal-\nizable transformation.\n",
    "RepB,B(t) =\n\n\n\n2\n0\n0\n0\n2\n0\n0\n0\n6\n\n\n\nB = B2\n⌢B6 = ⟨\n\n\n\n1\n0\n0\n\n\n,\n\n\n\n0\n1\n−2\n\n\n,\n\n\n\n1\n2\n0\n\n\n⟩\n",
    "Of the three basis vectors, the ﬁrst two come from the nullspace of t −2 and\nthe third is from the nullspace of t −6.\n",
    "2.14 Example A bit of computing with\nT =\n\n\n\n\n\n\n\n−1\n4\n0\n0\n0\n0\n3\n0\n0\n0\n0\n−4\n−1\n0\n0\n3\n−9\n−4\n2\n−1\n1\n5\n4\n1\n4\n\n\n\n\n\n\n\nshows that its characteristic polynomial is (x −3)3(x + 1)2.",
    "This table\n\n460\nChapter Five.",
    "Similarity\np\n(T −3I)p\nN ((t −3)p)\nnullity\n1\n\n\n\n\n\n\n\n−4\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n−4\n−4\n0\n0\n3\n−9\n−4\n−1\n−1\n1\n5\n4\n1\n1\n\n\n\n\n\n\n\n{\n\n\n\n\n\n\n\n−(u + v)/2\n−(u + v)/2\n(u + v)/2\nu\nv\n\n\n\n\n\n\n\n| u, v ∈C}\n2\n2\n\n\n\n\n\n\n\n16\n−16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n16\n16\n0\n0\n−16\n32\n16\n0\n0\n0\n−16\n−16\n0\n0\n\n\n\n\n\n\n\n{\n\n\n\n\n\n\n\n−z\n−z\nz\nu\nv\n\n\n\n\n\n\n\n| z, u, v ∈C}\n3\n3\n\n\n\n\n\n\n\n−64\n64\n0\n0\n0\n0\n0\n0\n0\n0\n0\n−64\n−64\n0\n0\n64\n−128\n−64\n0\n0\n0\n64\n64\n0\n0\n\n\n\n\n\n\n\n–same–\n–same–\nshows that the restriction of t −3 to N∞(t −3) acts on a string basis via the\ntwo strings ⃗β1 7→⃗β2 7→⃗0 and ⃗β3 7→⃗0.\n",
    "A similar calculation for the other eigenvalue\np\n(T + 1I)p\nN ((t + 1)p)\nnullity\n1\n\n\n\n\n\n\n\n\n\n\n0\n4\n0\n0\n0\n0\n4\n0\n0\n0\n0\n−4\n0\n0\n0\n3\n−9\n−4\n3\n−1\n1\n5\n4\n1\n5\n\n\n\n\n\n\n\n\n\n\n{\n\n\n\n\n\n\n\n\n\n\n−(u + v)\n0\n−v\nu\nv\n\n\n\n\n\n\n\n\n\n\n| u, v ∈C}\n2\n2\n\n\n\n\n\n\n\n\n\n\n0\n16\n0\n0\n0\n0\n16\n0\n0\n0\n0\n−16\n0\n0\n0\n8\n−40\n−16\n8\n−8\n8\n24\n16\n8\n24\n\n\n\n\n\n\n\n\n\n\n–same–\n–same–\ngives that the restriction of t + 1 to its generalized null space acts on a string\nbasis via the two separate strings ⃗β4 7→⃗0 and ⃗β5 7→⃗0.\n\nSection IV.",
    "Jordan Form\n461\n",
    "Therefore T is similar to this Jordan form matrix.\n\n\n\n\n\n\n\n−1\n0\n0\n0\n0\n0\n−1\n0\n0\n0\n0\n0\n3\n0\n0\n0\n0\n1\n3\n0\n0\n0\n0\n0\n3\n\n\n\n\n\n\n\nExercises\n2.15 Do the check for Example 2.4.\n",
    "2.16",
    "Each matrix is in Jordan form.",
    "State its characteristic polynomial and its\nminimal polynomial.\n",
    "(a)\n\u00123\n0\n1\n3\n\u0013\n(b)\n\u0012−1\n0\n0\n−1\n\u0013\n(c)\n\n\n2\n0\n0\n1\n2\n0\n0\n0\n−1/2\n\n\n(d)\n\n\n3\n0\n0\n1\n3\n0\n0\n1\n3\n\n\n(e",
    ")\n\n\n\n\n3\n0\n0\n0\n1\n3\n0\n0\n0\n0\n3\n0\n0\n0\n1\n3\n\n\n\n\n(f)\n\n\n\n\n4\n0\n0\n0\n1\n4\n0\n0\n0\n0\n−4\n0\n0\n0\n1\n−4\n\n\n\n\n(g)\n\n\n5\n0\n0\n0\n2\n0\n0\n0\n3\n\n\n(h)\n\n\n\n\n5\n0\n0\n0\n0\n2\n0\n0\n0\n0\n2\n0\n0\n0\n0\n3\n\n\n\n\n(i)\n\n\n\n\n5\n0\n0\n0\n0\n2\n0\n0\n0\n1\n2\n0\n0\n0\n0\n3\n\n\n\n\n✓2.17 Find the Jordan form from the given data.\n",
    "(a) The matrix T is 5×5 with the single eigenvalue 3.",
    "The nullities of the powers\nare: T −3I has nullity two, (T −3I)2 has nullity three, (T −3I)3 has nullity four,\nand (T −3I)4 has nullity ﬁve.\n",
    "(b) The matrix S is 5×5 with two eigenvalues.",
    "For the eigenvalue 2 the nullities\nare: S −2I has nullity two, and (S −2I)2 has nullity four.",
    "For the eigenvalue −1\nthe nullities are: S + 1I has nullity one.\n2.18 Find the change of basis matrices for each example.\n",
    "(a) Example 2.12\n(b) Example 2.13\n(c) Example 2.14\n✓2.19 Find the Jordan form and a Jordan basis for each matrix.\n(a)\n\u0012−10\n4\n−25\n10\n\u0013\n(b)\n\u00125\n−4\n9\n−7\n\u0013\n(c)\n\n\n4\n0\n0\n2\n1\n3\n5\n0\n4\n\n\n(d)\n\n\n5\n4\n3\n−1\n0\n−3\n1\n−2\n1\n\n\n(e)\n\n\n9\n7\n3\n−9\n−7\n−4\n4\n4\n4\n\n\n(f)\n\n\n2\n2\n−1\n−1\n−1\n1\n−1\n−2\n2\n\n\n(g)\n\n\n\n\n7\n1\n2\n2\n1\n4\n−1\n−1\n−2\n1\n5\n−1\n1\n1\n2\n8\n\n\n\n\n✓2.20 Find all possible Jordan forms of a transformation with characteristic polynomial\n(x −1)2(x + 2)2.\n2.21 Find all possible Jordan forms of a transformation with characteristic polynomial\n(x −1)3(x + 2).\n\n",
    "462\nChapter Five.",
    "Similarity\n✓2.22 Find all possible Jordan forms of a transformation with characteristic polynomial\n(x −2)3(x + 1) and minimal polynomial (x −2)2(x + 1).\n",
    "2.23 Find all possible Jordan forms of a transformation with characteristic polynomial\n(x −2)4(x + 1) and minimal polynomial (x −2)2(x + 1).\n",
    "✓2.24 Diagonalize these.\n",
    "(a)\n\u00121\n1\n0\n0\n\u0013\n(b)\n\u00120\n1\n1\n0\n\u0013\n✓2.25 Find the Jordan matrix representing the diﬀerentiation operator on P3.\n",
    "✓2.26 Decide if these two are similar.\n",
    "\u00121\n−1\n4\n−3\n\u0013\n\u0012−1\n0\n1\n−1\n\u0013\n2.27 Find the Jordan form of this matrix.\n",
    "\u00120\n−1\n1\n0\n\u0013\nAlso give a Jordan basis.\n",
    "2.28 How many similarity classes are there for 3×3 matrices whose only eigenvalues\nare −3 and 4?\n✓2.29 Prove that a matrix is diagonalizable if and only if its minimal polynomial has\nonly linear factors.\n",
    "2.30 Give an example of a linear transformation on a vector space that has no\nnon-trivial invariant subspaces.\n",
    "2.31 Show that a subspace is t −λ1 invariant if and only if it is t −λ2 invariant.\n2.32 Prove or disprove: two n×n matrices are similar if and only if they have the\nsame characteristic and minimal polynomials.\n",
    "2.33",
    "The trace of a square matrix is the sum of its diagonal entries.\n",
    "(a) Find the formula for the characteristic polynomial of a 2×2 matrix.\n",
    "(b) Show that trace is invariant under similarity, and so we can sensibly speak of\nthe ‘trace of a map’.",
    "(Hint: see the prior item.)\n",
    "(c) Is trace invariant under matrix equivalence?\n(d) Show that the trace of a map is the sum of its eigenvalues (counting multi-\nplicities).\n",
    "(e) Show that the trace of a nilpotent map is zero.",
    "Does the converse hold?\n2.34 To use Deﬁnition 2.10 to check whether a subspace is t invariant, we seemingly\nhave to check all of the inﬁnitely many vectors in a (nontrivial) subspace to see if\nthey satisfy the condition.",
    "Prove that a subspace is t invariant if and only if its\nsubbasis has the property that for all of its elements, t(⃗β) is in the subspace.\n",
    "✓2.35 Is t invariance preserved under intersection?",
    "Under union?",
    "Complementation?\nSums of subspaces?\n2.36 Give a way to order the Jordan blocks if some of the eigenvalues are complex\nnumbers.",
    "That is, suggest a reasonable ordering for the complex numbers.\n",
    "2.37 Let Pj(R) be the vector space over the reals of degree j polynomials.",
    "Show\nthat if j ⩽k then Pj(R) is an invariant subspace of Pk(R) under the diﬀerentiation\noperator.",
    "In P7(R), does any of P0(R), . . .",
    ", P6(R) have an invariant complement?\n\nSection IV.",
    "Jordan Form\n463\n2.38",
    "In Pn(R), the vector space (over the reals) of degree n polynomials,\nE = {p(x) ∈Pn(R) | p(−x) = p(x) for all x}\nand\nO = {p(x) ∈Pn(R) | p(−x) = −p(x) for all x}\nare the even and the odd polynomials; p(x)",
    "= x2 is even while p(x) = x3 is odd.\n",
    "Show that they are subspaces.",
    "Are they complementary?",
    "Are they invariant under\nthe diﬀerentiation transformation?\n",
    "2.39 A matrix S is the square root of another T if S2 = T. Show that any nonsingular\nmatrix has a square root.\n\n",
    "Topic\nMethod of Powers\n",
    "In applications matrices can be large.",
    "Calculating eigenvalues and eigenvectors\nby ﬁnding and solving the characteristic polynomial is impractical, too slow and\ntoo error-prone.",
    "Some techniques avoid the characteristic polynomial.",
    "Here we\nshall see a method that is suitable for large matrices that are sparse, meaning\nthat the great majority of the entries are zero.\n",
    "Suppose that the n×n matrix T has n distinct eigenvalues λ1, λ2, . . .",
    ", λn.\nThen Cn has a basis made of the associated eigenvectors ⟨⃗ζ1, . . .",
    ", ⃗ζn⟩. For any\n⃗v ∈Cn, writing ⃗v = c1⃗ζ1 + · · · + cn⃗ζn and iterating T on ⃗v gives these.\n",
    "T⃗v = c1λ1⃗ζ1 + c2λ2⃗ζ2 + · · ·",
    "+ cnλn⃗ζn\nT 2⃗v = c1λ2\n1⃗ζ1 + c2λ2\n2⃗ζ2 + · · ·",
    "+ cnλ2\nn⃗ζn\nT 3⃗v = c1λ3\n1⃗ζ1 + c2λ3\n2⃗ζ2 + · · ·",
    "+ cnλ3\nn⃗ζn\n...\nT k⃗v = c1λk\n1⃗ζ1 + c2λk\n2⃗ζ2 + · · · + cnλk\nn⃗ζn\nAssuming that |λ1| is the largest and dividing through\nT k⃗v\nλk\n1\n= c1⃗ζ1",
    "+ c2\nλk\n2\nλk\n1\n⃗ζ2 + · · · + cn\nλk\nn\nλk\n1\n⃗ζn\nshows that as k gets larger the fractions go to zero and so λ1’s term will dominate\nthe expression and that expression has a limit of c1⃗ζ1.\n",
    "Thus if c1 ̸= 0, as k increases the vectors T k⃗v will tend toward the direction\nof the eigenvectors associated with the dominant eigenvalue.",
    "Consequently, the\nratios of the vector lengths |T k⃗v|/|T k−1⃗v| tend to that dominant eigenvalue.\n",
    "For example, the eigenvalues of the matrix\nT =\n \n3\n0\n8\n−1\n!\nare 3 and −1.",
    "If ⃗v has the components 1 and 1 then iterating gives this.\n\n",
    "Topic: Method of Powers\n465\n⃗v\nT⃗v\nT 2⃗v\n· · ·\nT 9⃗v\nT 10⃗v\n \n1\n1\n!\n \n3\n7\n!\n \n9\n17\n!\n· · ·\n \n19 683\n39 367\n!\n \n59 049\n118 097\n!\n",
    "The ratio between the lengths of the last two is 2.999 9.\n",
    "We note two implementation issues.",
    "First, instead of ﬁnding the powers of\nT and applying them to ⃗v, we will compute ⃗v1 as T⃗v and then compute ⃗v2 as\nT⃗v1, etc.",
    "(that is, we do not separately calculate T 2, T 3, . . . ).",
    "We can quickly\ndo these matrix-vector products even if T is large, provided that it is sparse.\n",
    "The second issue is that to avoid generating numbers that are so large that they\noverﬂow our computer’s capability, we can normalize the ⃗vi’s at each step.",
    "For\ninstance, we can divide each ⃗vi by its length (other possibilities are to divide it\nby its largest component, or simply by its ﬁrst component).",
    "We thus implement\nthis method by generating\n⃗w0 = ⃗v0/|⃗v0|\n⃗v1 = T ⃗w0\n⃗w1 = ⃗v1/|⃗v1|\n⃗v2 = T ⃗w2\n...\n⃗wk−1 = ⃗vk−1/|⃗vk−1|\n⃗vk = T ⃗wk\nuntil we are satisﬁed.",
    "Then ⃗vk is an approximation of an eigenvector, and\nthe approximation of the dominant eigenvalue is the ratio (T • ⃗vk)/(⃗vk • ⃗vk)",
    "≈\n(λ1⃗vk ·⃗vk)/(⃗vk •⃗vk) = λ1.\n",
    "One way that we could be ‘satisﬁed’ is to iterate until our approximation of\nthe eigenvalue settles down.",
    "We could decide for instance to stop the iteration\nprocess not after some ﬁxed number of steps, but instead when |⃗vk| diﬀers from\n|⃗vk−1| by less than one percent, or when they agree up to the second signiﬁcant\ndigit.\n",
    "The rate of convergence is determined by the rate at which the powers of\n|λ2/λ1| go to zero, where λ2 is the eigenvalue of second largest length.",
    "If that\nratio is much less than one then convergence is fast but if it is only slightly\nless than one then convergence can be quite slow.",
    "Consequently, the method\nof powers is not the most commonly used way of ﬁnding eigenvalues (although\nit is the simplest one, which is why it is here).",
    "Instead, there are a variety of\nmethods that generally work by ﬁrst replacing the given matrix T with another\nthat is similar to it and so has the same eigenvalues, but is in some reduced form\n\n466\nChapter Five.",
    "Similarity\nsuch as tridiagonal form, where the only nonzero entries are on the diagonal, or\njust above or below it.",
    "Then special case techniques can ﬁnd the eigenvalues.\n",
    "Once we know the eigenvalues then we can easily compute the eigenvectors of T.\n",
    "These other methods are outside of our scope.",
    "A good reference is [Goult, et al.]\nExercises\n1 Use ten iterations to estimate the largest eigenvalue of these matrices, starting\nfrom the vector with components 1 and 2.",
    "Compare the answer with the one\nobtained by solving the characteristic equation.\n",
    "(a)\n\u00121\n5\n0\n4\n\u0013\n(b)\n\u0012 3\n2\n−1\n0\n\u0013\n2 Redo the prior exercise by iterating until |⃗vk| −|⃗vk−1| has absolute value less than\n0.01 At each step, normalize by dividing each vector by its length.",
    "How many\niterations does it take?",
    "Are the answers signiﬁcantly diﬀerent?\n3 Use ten iterations to estimate the largest eigenvalue of these matrices, starting\nfrom the vector with components 1, 2, and 3.",
    "Compare the answer with the one\nobtained by solving the characteristic equation.\n",
    "(a)\n\n\n4\n0\n1\n−2\n1\n0\n−2\n0\n1\n\n\n(b)\n\n\n−1\n2\n2\n2\n2\n2\n−3\n−6\n−6\n\n\n4 Redo the prior exercise by iterating until |⃗vk| −|⃗vk−1| has absolute value less than\n0.01.",
    "At each step, normalize by dividing each vector by its length.",
    "How many\niterations does it take?",
    "Are the answers signiﬁcantly diﬀerent?\n5 What happens if c1 = 0?",
    "That is, what happens if the initial vector does not to\nhave any component in the direction of the relevant eigenvector?\n6 How can we adapt the method of powers to ﬁnd the smallest eigenvalue?\nComputer Code\n",
    "This is the code for the computer algebra system Octave that did the calculation\nabove.",
    "(It has been lightly edited to remove blank lines, etc.)\n",
    ">T=[3, 0;\n8, -1]\nT=\n3\n0\n8\n-1\n>v0=[1; 2]\nv0=\n1\n1\n>v1=T*v0\nv1=\n3\n7\n>v2=T*v1\nv2=\n9\n17\n>T9=T**9\nT9=\n19683\n0\n\nTopic: Method of Powers\n467\n39368 -1\n>T10=T**10\nT10=\n59049\n0\n118096\n1\n>v9=T9*v0\nv9=\n19683\n39367\n>v10=T10*v0\nv10=\n59049\n118096\n>norm(v10)/norm(v9)\nans=2.9999\nRemark.",
    "This does not use the full power of Octave; it has built-in functions to\nautomatically apply sophisticated methods to ﬁnd eigenvalues and eigenvectors.\n\n",
    "Topic\nStable Populations\nImagine a reserve park with animals from a species that we are protecting.",
    "The\npark doesn’t have a fence so animals cross the boundary, both from the inside\nout and from the outside in.",
    "Every year, 10% of the animals from inside of the\npark leave and 1% of the animals from the outside ﬁnd their way in.",
    "Can we\nreach a stable level; are there populations for the park and the rest of the world\nthat will stay constant over time, with the number of animals leaving equal to\nthe number of animals entering?\nLet pn be the year n population in the park and let rn be the population in\nthe rest of the world.\n",
    "pn+1 = .90pn",
    "+ .01rn\nrn+1 = .10pn",
    "+ .99rn\n",
    "We have this matrix equation.\n \n",
    "pn+1\nrn+1\n!\n=\n \n.90\n.01\n.10\n.99\n!  \n",
    "pn\nrn\n!\n",
    "The population will be stable if pn+1 = pn and rn+1 = rn so that the matrix\nequation ⃗vn+1 = T⃗vn becomes ⃗v =",
    "T⃗v.",
    "We are therefore looking for eigenvectors\nfor T that are associated with the eigenvalue λ",
    "= 1.",
    "The equation ⃗0 = (λI−T)⃗v =\n(I −T)⃗v is\n \n0.10\n−0.01\n−0.10\n0.01\n!  \n",
    "p\nr\n!\n",
    "=\n \n0\n0\n!\nand gives the eigenspace of vectors with the restriction that p = .1r.\n",
    "For\nexample, if we start with a park population p = 10 000 animals and a rest of the\nworld population of r = 100 000 animals then every year ten percent of those\ninside leave the park (this is a thousand animals), and every year one percent of\nthose from the rest of the world enter the park (also a thousand animals).",
    "The\npopulation is stable, self-sustaining.\n\n",
    "Topic: Stable Populations\n469\nNow imagine that we are trying to raise the total world population of this\nspecies.\n",
    "We are trying to have the world population grow at 1% per year.\n",
    "This makes the population level stable in some sense, although it is a dynamic\nstability, in contrast to the static population level of the λ = 1 case.",
    "The equation\n⃗vn+1 = 1.01 ·⃗vn = T⃗vn leads to ((1.01I −T)⃗v = ⃗0, which gives this system.\n \n0.11\n−0.01\n−0.10\n0.02\n!  \n",
    "p\nr\n!\n",
    "=\n \n0\n0\n!\n",
    "This matrix is nonsingular and so the only solution is p = 0, r = 0.",
    "Thus there is\nno nontrivial initial population that would lead to a regular annual one percent\ngrowth rate in p and r.\n",
    "We can look for the rates that allow an initial population for the park that\nresults in a steady growth behavior.",
    "We consider λ⃗v = T⃗v and solve for λ.\n0",
    "=\n\f\f\f\f\f\nλ −.9\n.01\n.10\nλ −.99\n\f\f\f\f\f = (λ −.9)(λ −.99) −(.10)(.01) = λ2 −1.89λ + .89\n",
    "We already know that λ = 1 is one solution of this characteristic equation.",
    "The\nother is 0.89.",
    "Thus there are two ways to have a dynamically stable p and r,\nwhere the two grow at the same rate despite the leaky park boundaries: (i) have\na world population that does not grow or shrink, and (ii) have a world population\nthat shrinks by 11% every year.\n",
    "So one way to look at eigenvalues and eigenvectors is that they give a stable\nstate for a system.",
    "If the eigenvalue is one then the system is static and if the\neigenvalue isn’t one then it is a dynamic stability.\n",
    "Exercises\n1 For the park discussed above, what should be the initial park population in the\ncase where the populations decline by 11% every year?\n",
    "2 What will happen to the population of the park in the event of a growth in the\nexternal population of 1% per year?",
    "Will the park growth rate lag the world or\nlead it?",
    "Assume that the initial park population is ten thousand, and the world\npopulation is one hundred thousand, and calculate over a ten year span.\n",
    "3",
    "The park discussed above is partially fenced so that now, every year, only 5% of\nthe animals from inside of the park leave (still, about 1% of the animals from the\noutside ﬁnd their way in).",
    "Under what conditions can the park maintain a stable\npopulation now?\n",
    "4 Suppose that a species of bird only lives in Canada, the United States, or in Mexico.\n",
    "Every year, 4% of the Canadian birds travel to the US, and 1% of them travel to\nMexico.",
    "Every year, 6% of the US birds travel to Canada, and 4% go to Mexico.\n",
    "From Mexico, every year 10% travel to the US, and 0% go to Canada.\n",
    "(a) Give the transition matrix.\n(b) Is there a way for the three countries to have constant populations?\n\n",
    "Topic\nPage Ranking\nImagine that you are looking for the best book on Linear Algebra.",
    "You probably\nwould try a web search engine such as Google.",
    "These lists pages ranked by impor-\ntance.",
    "The ranking is deﬁned, as Google’s founders have said in [Brin & Page],\nthat a page is important if other important pages link to it: “a page can have\na high PageRank if there are many pages that point to it, or if there are some\npages that point to it and have a high PageRank.”",
    "But isn’t that circular —\nhow can they tell whether a page is important without ﬁrst deciding on the\nimportant pages?",
    "The answer is to use eigenvalues and eigenvectors.\n",
    "We will present a simpliﬁed version of the Page Rank algorithm.",
    "For that\nwe will model the World Wide Web as a collection of pages connected by links.\n",
    "This diagram, from [Wills], shows the pages as circles and the links as arrows.\nPage p1 has a link to page p2.",
    "Page p2 has a link to p3.",
    "And p3 has links to\np1, p2, and p3\np1\np2\np3\np4\nThe key idea is that pages that should be highly ranked if they are cited often\nby other pages.",
    "That is, we raise the importance of a page pi if it is linked-to\nfrom page pj.",
    "The increment depends on the importance of the linking page pj\ndivided by how many out-links aj are on that page.\n",
    "I(pi) =\nX\nin-linking pages pj\nI(pj)\naj\nThus, the importance of p1 equals 1/3 times the importance of p3, since the\nonly link to p1 comes from p3.",
    "Similarly the importance of p2 is the sum of the\n\nTopic: Page Ranking\n471\nimportance of p1 plus 1/3 times the importance of p3.\n",
    "This stores the information.\n",
    "\n\n\n\n\n0\n0\n1/3\n0\n1\n0\n1/3\n0\n0\n1\n0\n0\n0\n0\n1/3\n0\n\n\n\n\n\n",
    "The algorithm’s inventors describe a way to think about that matrix.\n",
    "PageRank can be thought of as a model of user behavior.",
    "We\nassume there is a ‘random surfer’ who is given a web page at random\nand keeps clicking on links, never hitting “back” . . .",
    "The probability\nthat the random surfer visits a page is its PageRank.",
    "[Brin & Page]\nThus, looking at the ﬁrst row of the matrix, the only way for a random surfer to\nget to p1 is to have come from p3.",
    "That page has three links so the chance of\nclicking on p1’s is 1/3 times the chance of being on page p3.\n",
    "This brings up the question of page p4.",
    "On the Internet many pages are\ndangling or sink links, without any outbound links.",
    "What happens to the\nrandom surfer who visits this page?",
    "The simplest thing is to imagine that the\nsurfer chooses the next page entirely at random.\n",
    "H =\n\n\n\n\n\n0\n0\n1/3\n1/4\n1\n0\n1/3\n1/4\n0\n1\n0\n1/4\n0\n0\n1/3\n1/4\n\n\n\n\n\n",
    "We will ﬁnd vector ⃗I",
    "whose components are the importance rankings of each\npage I(pi).",
    "With this notation, our requirements for the page rank are that\nH⃗I = ⃗I. That is, we want an eigenvector of the matrix associated with the\neigenvalue λ",
    "= 1.\n",
    "Here is Sage’s calculation of the eigenvectors (edited to ﬁt the page).\n",
    "sage: H=matrix([[0,0,1/3,1/4], [1,0,1/3,1/4], [0,1,0,1/4], [0,0,1/3,1/4]])\nsage: H.eigenvectors_right()\n",
    "[(1, [(1, 2, 9/4, 1)], 1),\n(0, [(0, 1, 3, -4)], 1),\n(-0.3750000000000000? - 0.4389855730355308?*I,\n[(1, -0.1250000000000000?",
    "+ 1.316956719106593?*I,\n-1.875000000000000? - 1.316956719106593?*I, 1)], 1),\n(-0.3750000000000000?",
    "+ 0.4389855730355308?*I,\n[(1, -0.1250000000000000?",
    "- 1.316956719106593?*I,\n-1.875000000000000?",
    "+ 1.316956719106593?*I, 1)], 1)]\n\n472\nChapter Five.",
    "Similarity\nThe eigenvector that Sage gives associated with the eigenvalue λ = 1 is this.\n\n\n\n\n\n1\n2\n9/4\n1\n\n\n\n\n\nOf course, there are many vectors in that eigenspace.",
    "To get a page rank number\nwe normalize to length one.\nsage: v=vector([1, 2, 9/4, 1])\nsage: v/v.norm()\n(4/177*sqrt(177), 8/177*sqrt(177), 3/59*sqrt(177), 4/177*sqrt(177))\nsage: w=v/v.norm()\nsage: w.n()\n(0.300658411201132, 0.601316822402263, 0.676481425202546, 0.300658411201132)\n",
    "So we rank the ﬁrst and fourth pages as of equal importance.",
    "We rank the\nsecond and third pages as much more important than those, and about equal in\nimportance as each other.\n",
    "We’ll add one more reﬁnement.",
    "We will allow the surfer to pick a new page\nat random even if they are not on a dangling page.",
    "In this equation it happens\nwith probability 1 −α.\n",
    "G = α ·\n\n\n\n\n\n0\n0\n1/3\n1/4\n1\n0\n1/3\n1/4\n0\n1\n0\n1/4\n0\n0\n1/3\n1/4\n\n\n\n\n+ (1 −α) ·\n\n\n\n\n\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n1/4\n\n\n\n\n\n",
    "This is the Google matrix.\n",
    "In practice α is typically between 0.85 and 0.99.",
    "Here are the ranks for the\nfour pages with various α’s.\n",
    "α\n0.85\n0.90\n0.95\n0.99\np1\n0.325\n0.317\n0.309\n0.302\np2\n0.602\n0.602\n0.602\n0.601\np3\n0.652\n0.661\n0.669\n0.675\np4\n0.325\n0.317\n0.309\n0.302\n",
    "The details of the algorithms used by commercial search engines are secret,\nhave many reﬁnements, and also change frequently.",
    "But the inventors of Google\nwere gracious enough to outline the basis for their work in [Brin & Page].",
    "A\nmore current source is [Wikipedia, Google Page Rank].",
    "Two additional excellent\nexpositions are [Wills] and [Austin].\n\nTopic:",
    "Page Ranking\n473\nExercises\n1 A square matrix is stochastic if the sum of the entries in each column is one.",
    "The\nGoogle matrix is computed by taking a combination G = α ∗H",
    "+ (1 −α) ∗S of two\nstochastic matrices.",
    "Show that G must be stochastic.\n",
    "2",
    "For this web of pages, the importance of each page should be equal.",
    "Verify it for\nα = 0.85.\n",
    "p1\np2\np3\np4\n3",
    "[Bryan & Leise] Give the importance ranking for this web of pages.\n",
    "p1\np2\np3\np4\n(a) Use α = 0.85.\n",
    "(b) Use α = 0.95.\n",
    "(c) Observe that while p3 is linked-to from all other pages, and therefore seems\nimportant, it is not the highest ranked page.",
    "What is the highest ranked page?\nExplain.\n\n",
    "Topic\nLinear Recurrences\nIn 1202 Leonardo of Pisa, known as Fibonacci, posed this problem.\n",
    "A certain man put a pair of rabbits in a place surrounded on all sides\nby a wall.",
    "How many pairs of rabbits can be produced from that\npair in a year if it is supposed that every month each pair begets a\nnew pair which from the second month on becomes productive?\n",
    "This moves past an elementary exponential growth model for populations to\ninclude that newborns are not fertile for some period, here a month.",
    "However,\nit retains other simplifying assumptions such as that there is an age after which\nthe rabbits are infertile.\n",
    "To get next month’s total number of pairs we add the number of pairs alive\ngoing into next month to the number of pairs that will be newly born next\nmonth.",
    "The latter equals the number of pairs that will be productive going into\nnext month, which is the number that next month will have been alive for at\nleast two months.\n",
    "F(n) = F(n −1)",
    "+",
    "F(n −2)\nwhere F(0) = 0, F(1) = 1\n(∗)\nOn the left is a recurrence relation.",
    "It gets that name because F recurs in its\nown deﬁning equation.",
    "On the right are the initial conditions.",
    "From (∗) we can\ncompute F(2), F(3), etc., to work up to the answer for Fibonacci’s question.\n",
    "month n\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\npairs F(n)\n0\n1\n1\n2\n3\n5\n8\n13\n21\n34\n55\n89\n144\n",
    "We will use linear algebra to get a formula that calculates F(n) without having\nto ﬁrst calculate the intermediate values F(2), F(3), etc.\n",
    "We start by giving (∗) a matrix formulation.\n \n",
    "F(n)\nF(n −1)\n!\n",
    "=\n \n1\n1\n1\n0\n!  \n",
    "F(n −1)\nF(n −2)\n!\n",
    "where\n \nF(1)\nF(0)\n!\n=\n \n1\n0\n!\n\n",
    "Topic: Linear Recurrences\n475\nWrite T for the matrix and ⃗vn for the vector with components F(n) and F(n −1)\nso that ⃗vn = T n−1⃗v1 for n ⩾1.",
    "If we diagonalize T then we have a fast way\nto compute its powers: where T = PDP−1 then T n = PDnP−1 and the n-th\npower of the diagonal matrix D is the diagonal matrix whose entries are the\nn-th powers of the entries of D.\nThe characteristic equation of T is λ2 −λ −1 = 0.",
    "The quadratic formula\ngives its roots as (1+\n√\n5)/2 and (1−\n√\n5)/2.",
    "(These are sometimes called “golden\nratios;” see [Falbo].)",
    "Diagonalizing gives this.\n \n1\n1\n1\n0\n!\n=\n \n1+\n√\n5\n2\n1−\n√\n5\n2\n1\n1\n!  \n",
    "1+\n√\n5\n2\n0\n0\n1−\n√\n5\n2\n!  ",
    "1\n√\n5\n−( 1−\n√\n5\n2\n√\n5 )\n−1\n√\n5\n1+\n√\n5\n2\n√\n5\n!\n",
    "Introducing the vectors and taking the n-th power, we have\n \nF(n)\nF(n −1)\n!\n",
    "=\n \n1\n1\n1\n0\n!",
    "n−1  \nf(1)\nf(0)\n!\n",
    "=\n \n1+\n√\n5\n2\n1−\n√\n5\n2\n1\n1\n!",
    "\n\n\n\u0010\n1+\n√\n5\n2\n\u0011n−1\n0\n0\n\u0010\n1−\n√\n5\n2\n\u0011n−1\n\n\n\n 1\n√\n5\n−( 1−\n√\n5\n2\n√\n5 )\n−1\n√\n5\n1+\n√\n5\n2\n√\n5\n!  \n",
    "1\n0\n!\n",
    "The calculation is ugly but not hard.\n \n",
    "F(n)\nF(n −1)\n!\n",
    "=\n \n1+\n√\n5\n2\n1−\n√\n5\n2\n1\n1\n!",
    "\n\n\n\u0010\n1+\n√\n5\n2\n\u0011n−1\n0\n0\n\u0010\n1−\n√\n5\n2\n\u0011n−1\n\n\n\n \n1\n√\n5\n−1\n√\n5\n!\n=\n1\n√\n5\n \n1+\n√\n5\n2\n1−\n√\n5\n2\n1\n1\n!",
    "\n\n\n\u0010\n1+\n√\n5\n2\n\u0011n−1\n−\n\u0010\n1−\n√\n5\n2\n\u0011n−1\n\n\n\n=\n1\n√\n5\n\n\n\u0010\n1+\n√\n5\n2\n\u0011n\n−\n\u0010\n1−\n√\n5\n2\n\u0011n\n\u0010\n1+\n√\n5\n2\n\u0011n−1\n−\n\u0010\n1−\n√\n5\n2\n\u0011n−1\n\n\n",
    "We want the ﬁrst component.\n",
    "F(n) =\n1\n√\n5\n\" \n1 +\n√\n5\n2\n!n\n−\n \n1 −\n√\n5\n2\n!n",
    "#\nThis formula gives the value of any member of the sequence without having to\nﬁrst ﬁnd the intermediate values.\n",
    "Because (1 −\n√\n5)/2 ≈−0.618 has absolute value less than one, its powers\ngo to zero and so the F(n) formula is dominated by its ﬁrst term.",
    "Although we\n\n476\nChapter Five.",
    "Similarity\nhave extended the elementary model of population growth by adding a delay\nperiod before the onset of fertility, we nonetheless still get a function that is\nasymptotically exponential.\n",
    "In general, a homogeneous linear recurrence relation of order k has this\nform.\nf(n)",
    "= an−1f(n −1)",
    "+ an−2f(n −2)",
    "+ · · · + an−kf(n −k)\n",
    "This recurrence relation is homogeneous because it has no constant term, i.e, we\ncan rewrite it as 0 = −f(n)",
    "+ an−1f(n −1)",
    "+ an−2f(n −2)",
    "+ · · · + an−kf(n −k).\n",
    "It is of order k because it uses k-many prior terms to calculate f(n).",
    "The relation,\ncimbined with initial conditions giving values for f(0), . .",
    ".",
    ", f(k −1), completely\ndetermines a sequence, simply because we can compute f(n) by ﬁrst computing\nf(k), f(k + 1), etc.",
    "As with the Fibonacci case we will ﬁnd a formula that solves\nthe recurrence, that directly gives f(n)\n",
    "Let V be the set of functions with domain N = {0, 1, 2, . . .}",
    "and codomain\nC. (Where convenient we sometimes use the domain Z+",
    "= {1, 2, . . .}.)",
    "This is\na vector space under the usual meaning for addition and scalar multiplication,\nthat f + g is the map x 7→f(x) + g(x) and cf is the map x 7→c · f(x).\n",
    "If we put aside any initial conditions and look only at the recurrence, then\nthere may be many functions satisfying the relation.",
    "For example, the Fibonacci\nrecurrence that each value beyond the initial ones is the sum of the prior two is\nsatisﬁed by the function L whose ﬁrst few values are L(0)",
    "= 2, L(1) = 1, L(2) = 3,\nL(3) = 4, and L(4) = 7.\nFix a homogeneous linear recurrence relation of order k and consider the\nsubset S of functions satisfying the relation (without initial conditions).",
    "This S\nis a subspace of V.",
    "It is nonempty because the zero function is a solution, by\nhomogeneity.",
    "It is closed under addition because if f1 and f2 are solutions then\nthis holds.\n",
    "−(f1",
    "+ f2)(n)",
    "+",
    "an−1(f1",
    "+ f2)(n −1)",
    "+ · · · + an−k(f1 + f2)(n −k)\n= (−f1(n) + · · · + an−kf1(n −k))\n",
    "+ (−f2(n)",
    "+ · · ·",
    "+ an−kf2(n −k))\n",
    "= 0 + 0",
    "= 0\nIt is also closed under scalar multiplication.\n",
    "−(rf1)(n) + an−1(rf1)(n −1)",
    "+ · · ·",
    "+ an−k(rf1)(n −k)\n= r · (−f1(n) + · · · + an−kf1(n −k))\n=",
    "r · 0\n= 0\n\nTopic: Linear Recurrences\n477\n",
    "We can ﬁnd the dimension of S. Where k is the order of the recurrence, consider\nthis map from the set of functions S to the set of k-tall vectors.\n",
    "f 7→\n\n\n\n\n\n\nf(0)\nf(1)\n...\nf(k −1)\n\n\n\n\n\n\nExercise 4 shows that this is linear.",
    "Any solution of the recurrence is uniquely\ndetermined by the k-many initial conditions so this map is one-to-one and onto.\n",
    "Thus it is an isomorphism, and S has dimension k.\n",
    "So we can describe the set of solutions of our linear homogeneous recurrence\nrelation of order k by ﬁnding a basis consisting of k-many linearly independent\nfunctions.",
    "To produce those we give the recurrence a matrix formulation.\n",
    "\n\n\n\n\n\nf(n)\nf(n −1)\n...\n",
    "f(n −k + 1)\n\n\n\n\n\n\n=\n\n\n\n\n\n\n\n\n\n\nan−1\nan−2\nan−3\n. .",
    ".\n",
    "an−k+1\nan−k\n1\n0\n0\n. .",
    ".\n",
    "0\n0\n0\n1\n0\n0\n0\n1\n...\n...\n...\n...\n0\n0\n0\n. .",
    ".\n",
    "1\n0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nf(n −1)\nf(n −2)\n...\nf(n −k)\n\n\n\n\n\n\nCall the matrix A.",
    "We want its characteristic function, the determinant of\nA −λI.",
    "The pattern in the 2×2 case\n \nan−1 −λ\nan−2\n1\n−λ\n!\n= λ2 −an−1λ −an−2\nand the 3×3 case\n\n\n\nan−1 −λ\nan−2\nan−3\n1\n−λ\n0\n0\n1\n−λ\n\n\n= −λ3 + an−1λ2 + an−2λ",
    "+ an−3\nleads us to expect, and Exercise 5 veriﬁes, that this is the characteristic equation.\n",
    "0",
    "=\n\f\f\f\f\f\f\f\f\f\f\f\f\f\f\nan−1 −λ\nan−2\nan−3\n. . .\n",
    "an−k+1\nan−k\n1\n−λ\n0\n. .",
    ".\n",
    "0\n0\n0\n1\n−λ\n0\n0\n1\n...\n...\n...\n...\n0\n0\n0\n. .",
    ".\n",
    "1\n−λ\n\f\f\f\f\f\f\f\f\f\f\f\f\f\f\n= ±(−λk + an−1λk−1 + an−2λk−2 + · · · + an−k+1λ + an−k)\n\n478\nChapter Five.",
    "Similarity\nThe ± is not relevant to ﬁnd the roots",
    "so we drop it.",
    "We say that the polynomial\n−λk + an−1λk−1 + an−2λk−2 + · · · + an−k+1λ + an−k is associated with the\nrecurrence relation.\n",
    "If the characteristic equation has no repeated roots then the matrix is\ndiagonalizable and we can, in theory, get a formula for f(n), as in the Fibonacci\ncase.",
    "But because we know that the subspace of solutions has dimension k we\ndo not need to do the diagonalization calculation, provided that we can exhibit\nk diﬀerent linearly independent functions satisfying the relation.\n",
    "Where r1, r2, . .",
    ".",
    ", rk are the distinct roots, consider the functions of powers\nof those roots, fr1(n) = rn\n1 through frk(n)",
    "= rn\nk. Exercise 6 shows that each is\na solution of the recurrence and that they form a linearly independent set.",
    "So, if\nthe roots of the associated polynomial are distinct, any solution of the relation\nhas the form f(n) = c1rn\n1 + c2rn\n2 + · · · + ckrn\nk for some scalars c1, . . .",
    ", cn.",
    "(The\ncase of repeated roots is similar but we won’t cover it here; see any text on\nDiscrete Mathematics.)\n",
    "Now we bring in the initial conditions.",
    "Use them to solve for c1, . . .",
    ", cn.",
    "For\ninstance, the polynomial associated with the Fibonacci relation is −λ2 + λ",
    "+ 1,\nwhose roots are r1 = (1 +\n√\n5)/2 and r2 = (1 −\n√\n5)/2 and so any solution of the\nFibonacci recurrence has the form f(n)",
    "= c1((1 +\n√\n5)/2)n + c2((1 −\n√\n5)/2)n.\n",
    "Use the Fibonacci initial conditions for n = 0 and n = 1\nc1 +\nc2 = 0\n(1 +\n√\n5/2)c1 + (1 −\n√\n5/2)c2 = 1\nand solve to get c1 = 1/\n√\n5 and c2 = −1/\n√\n5, as we found above.\n",
    "We close by considering the nonhomogeneous case, where the relation has\nthe form f(n + 1) = anf(n) + an−1f(n −1)",
    "+ · · · + an−kf(n −k)",
    "+ b for some\nnonzero b.",
    "We only need a small adjustment to make the transition from the\nhomogeneous case.\n",
    "This classic example illustrates: in 1883, Edouard Lucas posed the Tower of\nHanoi problem.\n",
    "In the great temple at Benares, beneath the dome which marks\nthe center of the world, rests a brass plate in which are ﬁxed three\ndiamond needles, each a cubit high and as thick as the body of a\nbee.",
    "On one of these needles, at the creation, God placed sixty four\ndisks of pure gold, the largest disk resting on the brass plate, and\nthe others getting smaller and smaller up to the top one.",
    "This is the\nTower of Brahma.",
    "Day and night unceasingly the priests transfer\nthe disks from one diamond needle to another according to the ﬁxed\nand immutable laws of Bram-ah, which require that the priest on\nduty must not move more than one disk at a time and that he must\n\nTopic: Linear Recurrences\n479\nplace this disk on a needle so that there is no smaller disk below\nit.",
    "When the sixty-four disks shall have been thus transferred from\nthe needle on which at the creation God placed them to one of the\nother needles, tower, temple, and Brahmins alike will crumble into\ndusk, and with a thunderclap the world will vanish.",
    "(Translation of\n[De Parville] from [Ball & Coxeter].)\n",
    "We put aside the question of why the priests don’t sit down for a while and\nhave the world last a little longer, and instead ask how many disk moves it will\ntake.",
    "Before tackling the sixty four disk problem we will consider the problem\nfor three disks.\n",
    "To begin, all three disks are on the same needle.\n",
    "After the three moves of taking the small disk to the far needle, the mid-sized\ndisk to the middle needle, and then the small disk to the middle needle, we have\nthis.\n",
    "Now we can move the big disk to the far needle.",
    "Then to ﬁnish we repeat the\nthree-move process on the two smaller disks, this time so that they end up on\nthe third needle, on top of the big disk.\n",
    "That sequence of moves is the best that we can do.",
    "To move the bottom disk\nat a minimum we must ﬁrst move the smaller disks to the middle needle, then\nmove the big one, and then move all the smaller ones from the middle needle to\nthe ending needle.",
    "Since this minimum suﬃces, we get this recurrence.\n",
    "T(n) = T(n −1)",
    "+ 1 + T(n −1)",
    "= 2T(n −1)",
    "+ 1\nwhere T(1) = 1\nHere are the ﬁrst few values of T.\ndisks n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nmoves T(n)\n1\n3\n7\n15\n31\n63\n127\n255\n511\n1023\nOf course, these numbers are one less than a power of two.",
    "To derive this write\nthe original relation as −1 = −T(n)+2T(n−1).",
    "Consider 0 = −T(n)+2T(n−1),\n\n480\nChapter Five.",
    "Similarity\na linear homogeneous recurrence of order 1.",
    "Its associated polynomial is −λ + 2,\nwith the single root r1 = 2.",
    "Thus functions satisfying the homogeneous relation\ntake the form c12n.\n",
    "That’s the homogeneous solution.",
    "Now we need a particular solution.",
    "Because\nthe nonhomogeneous relation −1 = −T(n) + 2T(n −1) is so simple, we can\nby eye spot a particular solution T(n) = −1.",
    "Any solution of the recurrence\nT(n) = 2T(n −1)",
    "+ 1 (without initial conditions) is the sum of the homogeneous\nsolution and the particular solution: c12n−1.",
    "Now the initial condition T(1) = 1\ngives that c1 = 1 and we’ve gotten the formula that generates the table: the\nn-disk Tower of Hanoi problem requires T(n) = 2n −1 moves.\n",
    "Finding a particular solution in more complicated cases is, perhaps not\nsurprisingly, more complicated.",
    "A delightful and rewarding, but challenging,\nsource is [Graham, Knuth, Patashnik].",
    "For more on the Tower of Hanoi see\n[Ball & Coxeter], [Gardner 1957], and [Hofstadter].",
    "Some computer code follows\nthe exercises.\n",
    "Exercises\n1 How many months until the number of Fibonacci rabbit pairs passes a thousand?\nTen thousand?",
    "A million?\n2 Solve each homogeneous linear recurrence relations.\n",
    "(a) f(n)",
    "= 5f(n −1)",
    "−6f(n −2)\n(b) f(n)",
    "= 4f(n −2)\n(c) f(n)",
    "= 5f(n −1) −2f(n −2) −8f(n −3)\n",
    "3 Give a formula for the relations of the prior exercise, with these initial condi-\ntions.\n",
    "(a) f(0)",
    "= 1, f(1)",
    "= 1\n(b) f(0)",
    "= 0, f(1)",
    "= 1\n(c) f(0)",
    "= 1, f(1)",
    "= 1, f(2) = 3.\n4 Check that the isomorphism given between S and Rk is a linear map.\n",
    "5 Show that the characteristic equation of the matrix is as stated, that is, is the\npolynomial associated with the relation.",
    "(Hint: expanding down the ﬁnal column\nand using induction will work.)\n",
    "6 Given a homogeneous linear recurrence relation f(n)",
    "= anf(n−1)+· · ·+an−kf(n−\nk), let r1, . .",
    ".",
    ", rk be the roots of the associated polynomial.",
    "Prove that each function\nfri(n) = rn\nk satisﬁes the recurrence (without initial conditions).\n",
    "7 (This refers to the value T(64)",
    "= 18, 446, 744, 073, 709, 551, 615 given in the com-\nputer code below.)",
    "Transferring one disk per second, how many years would it\ntake the priests at the Tower of Hanoi to ﬁnish the job?\nComputer Code\nThis code generates the ﬁrst few values of a function deﬁned by a recur-\nrence and initial conditions.",
    "It is in the Scheme dialect of LISP, speciﬁcally,\n[Chicken Scheme].\n\n",
    "Topic: Linear Recurrences\n481\nAfter loading an extension that keeps the computer from switching to ﬂoating\npoint numbers when the integers get large, the Tower of Hanoi function is\nstraightforward.\n",
    "(require-extension numbers)\n(define (tower-of-hanoi-moves n)\n",
    "(if (= n 1)\n1\n(+ (* (tower-of-hanoi-moves (- n 1))\n2)\n1) ) )\n; Two helper funcitons\n(define (first-few-outputs proc n)\n(first-few-outputs-aux proc n '()) )\n(define (first-few-outputs-aux proc n lst)\n(if (< n 1)\nlst\n(first-few-outputs-aux proc (- n 1) (cons (proc n) lst)) ) )\n",
    "(For readers unused to recursive code: to compute T(64), the computer wants to\ncompute 2 ∗T(63) −1, which requires computing T(63).",
    "The computer puts the\n‘times 2’ and the ‘plus 1’ aside for a moment.",
    "It computes T(63) by using this\nsame piece of code (that’s what ‘recursive’ means), and to do that it wants to\ncompute 2 ∗T(62) −1.",
    "This keeps up until, after 63 steps, the computer tries to\ncompute T(1).",
    "It then returns T(1) = 1, which allows the computation of T(2)\nto proceed, etc., until the original computation of T(64) ﬁnishes.)\n",
    "The helper functions give a table of the ﬁrst few values.",
    "Here is the session\nat the prompt.\n",
    "#;1> (load \"hanoi.scm\")\n; loading hanoi.scm ...\n; loading /var/lib//chicken/6/numbers.import.so ...\n; loading /var/lib//chicken/6/chicken.import.so ...\n; loading /var/lib//chicken/6/foreign.import.so ...\n; loading /var/lib//chicken/6/numbers.so ...\n#;2> (tower-of-hanoi-moves 64)\n18446744073709551615\n#;3> (first-few-outputs tower-of-hanoi-moves 64)\n(1 3 7 15 31 63 127 255 511 1023 2047 4095 8191 16383 32767 65535 131071 262143 524287 1048575\n2097151 4194303 8388607 16777215 33554431 67108863 134217727 268435455 536870911 1073741823\n2147483647 4294967295 8589934591 17179869183 34359738367 68719476735 137438953471 274877906943\n549755813887 1099511627775 2199023255551 4398046511103 8796093022207 17592186044415\n35184372088831 70368744177663 140737488355327 281474976710655 562949953421311 1125899906842623\n2251799813685247 4503599627370495 9007199254740991 18014398509481983 36028797018963967\n72057594037927935 144115188075855871 288230376151711743 576460752303423487 1152921504606846975\n2305843009213693951 4611686018427387903 9223372036854775807 18446744073709551615)\n",
    "This is a list of T(1) through T(64) (the session was edited to put in line breaks\nfor readability).\n\n",
    "Topic\nCoupled Oscillators\n",
    "This is a Wilberforce pendulum.",
    "Hanging on the spring is a mass, or bob.",
    "Push\nit up a bit and release, and it will oscillate up and down.\n",
    "But then, if the device is properly adjusted, something fascinating happens.\n",
    "After a few seconds, in addition to going up and down, the mass begins to rotate\nabout the axis that runs up the middle of the spring.",
    "This yaw increases until the\nmotion becomes almost entirely rotary, with very little up and down.",
    "Perhaps\nﬁve seconds later the motion evolves back to a combination.",
    "After some more\ntime, order reappears.",
    "Amazingly, now the motion is almost entirely vertical.\n",
    "This continues, with the device trading oﬀperiods of pure vertical motion with\nperiods of pure rotational motion, interspersed with mixtures.",
    "(Search online\nfor “wilberforce pendulum video” to get some excellent demonstrations.)\n",
    "Each pure motion state is a normal mode of oscillation.",
    "We will analyze\nthis device’s behavior when it is in a normal mode.",
    "It is all about eigenvalues.\n",
    "θ(t)\nx(t)\n",
    "Write x(t) for the vertical motion over time and θ(t) for the rotational motion.\n",
    "Fix the coordinate system so that in rest position x = 0 and θ = 0, so that\npositive x’s are up, and so that positive θ’s are counterclockwise when viewed\nfrom above.\n\n",
    "Topic: Coupled Oscillators\n483\nWe start by modeling the motion of a mass on a spring constrained to have\nno twist.",
    "This is simpler because there is only one motion, one degree of freedom.\n",
    "Put the mass in rest position and push it up to compress the spring.",
    "Hooke’s\nLaw is that for small distances the restoring force is proportional to the distance,\nF = −k · x.",
    "The constant k is the stiﬀness of the spring.\n",
    "Newton’s Law is that a force is proportional to the associated acceleration\nF = m ·",
    "d2 x(t)/dt.",
    "The constant of proportionality, m, is the mass of the\nobject.",
    "Combining Hooke’s Law with Newton’s gives the diﬀerential equation\nexpressing the mass’s motion m ·",
    "d2 x(t)/dt = −k · x(t).",
    "We prefer the from\nwith the variables all on one side.\n",
    "m ·",
    "d2 x(t)\n",
    "dt\n+ k · x(t) = 0\n(∗)\n",
    "Our physical intuition is that over time the bob oscillates.",
    "It started high so\nthe graph should look like this.\n",
    "position x\ntime t\nOf course, this looks like a cosine graph and we recognize that the diﬀerential\nequation of motion (∗) is satisﬁed by x(t)",
    "= cos ωt, where ω =\np\nm/k, since\ndx/dt = ω · sin ωt and d2x/dt2 = −ω2 · cos ωt.\n",
    "Here, ω is the angular\nfrequency.",
    "It governs the period of the oscillation since if ω = 1 then the period\nis 2π, while if ω = 2 then the period is π, etc.\n",
    "We can give a more general solution of (∗).",
    "For a general amplitude we put\na factor A in front x(t)",
    "= A · cos wt.",
    "And we can allow a phase shift, so we are\nnot required to start the clock when the mass is high, with x(t)",
    "= A cos(wt+φ).\n",
    "This is the equation of simple harmonic motion.\n",
    "Now back to consideration of the coupled pair of motions, vertical and\nrotational.",
    "These two interact because a spring that is twisted will lengthen\nor shorten just a bit; for instance, it could work as here or could be reversed,\ndepending on the spring.\n",
    "spring lengthens\nspring shortens\nAnd, a spring that is stretched or compressed from its rest position will twist\nslightly.",
    "The interaction of the two produces coupled oscillations.\n\n",
    "484\nChapter Five.",
    "Similarity\nTo see how the interaction can produce the dramatic behavior that we see\nin a normal mode imagine that the mass is rotating in the direction that will\nmake the spring longer.",
    "If at the same moment the vertical motion is that the\nspring is getting shorter, then superimposing the two could result in their almost\ncanceling.",
    "The bob ends up not moving vertically much at all, just twisting.\n",
    "With a properly adjusted device this could last for a number of seconds.\n",
    "“Properly adjusted” means that the period of the pure vertical motion is the\nsame as, or close to, the period of the pure rotational motion.",
    "With that, the\ncancellation will go on for some time.\n",
    "The interaction between the motions can also produce the other normal\nmode behavior, where the bob moves mostly vertically without much rotation,\nif the spring’s motion x(t) produces a twist that opposes the bob’s twist θ(t).\n",
    "The bob will stop rotating, almost, so that its motion is almost entirely vertical.\n",
    "To get the equations of motion in this two degrees of freedom case, we make\nthe same assumption as in the one degree case, that for small displacements\nthe restoring force is proportional to the displacement.",
    "But now we take that\nassumption both for the vertical motion and for the rotation.",
    "Let the constant\nof proportionality in the rotational motion be κ.",
    "Similarly we also use Newton’s\nLaw that force is proportional to acceleration for the rotational motion as well,\nand take the constant of proportionality to be I.\nMost crucially, we add a coupling between the two motions, which we take\nto be proportional to each, with constant of proportionality ϵ/2.\n",
    "That gives a system of two diﬀerential equations, the ﬁrst for vertical motion\nand the second for rotation.",
    "These equations describe the behavior of the coupled\nsystem at any time t.\nm ·",
    "d2 x(t)\ndt2\n+ k · x(t)",
    "+ ϵ\n",
    "2 · θ(t) = 0\nI · d2 θ(t)\ndt2\n+ κ · θ(t)",
    "+ ϵ\n2 · x(t)",
    "= 0\n(∗∗)\n",
    "We will use them to analyze the system’s behavior at times when it is in a\nnormal mode.\n",
    "First consider the uncoupled motions, as given by the equations without the\nϵ terms.",
    "Without those terms these describe simple harmonic functions, and\nwe write ω2\nx for k/m, and ω2\nθ for κ/I. We have argued above that to observe\nthe stand-still behavior we should adjust the device so that the periods are the\nsame ω2\nx = ω2\nθ.",
    "Write ω0 for that number.\n",
    "Now consider the coupled motions x(t) and θ(t).",
    "By the same principle, to\nobserve the stand-still behavior we want them in in sync, for instance so that\nthe rotation is at its peak when the stretch is at its peak.",
    "That is, in a normal\nmode the oscillations have the same angular frequency ω.",
    "As to phase shift, as\n\nTopic: Coupled Oscillators\n485\nwe also discussed there are two cases: when the twist imparted by the spring’s\nmotion is in the same direction as the twist given by the rotational oscillation\nand when they are opposed.",
    "In either case to get a normal mode the peaks must\ncoincide.\nx(t) = A1 cos(ωt + φ)\nx(t)",
    "= A1 cos(ωt + φ)\nθ(t) = A2 cos(ωt + φ)\nθ(t) = A2 cos(ωt + (φ + π))\n",
    "We will work through the left-hand case, leaving the other as an exercise.\n",
    "We want to ﬁnd which ω’s are possible.",
    "Take the second derivatives\nd2 x(t)\ndt\n= −A1ω2 cos(ωt + φ)\nd2 θ(t)\ndt\n= −A2ω2 cos(ωt + φ)\nand plug into the equations of motion (∗∗).\n",
    "m · (−A1ω2 cos(ωt + φ))",
    "+ k · (A1 cos(ωt + φ))",
    "+ ϵ\n2 · (A2 cos(ωt + φ))",
    "= 0\nI · (−A2ω2 cos(ωt + φ))",
    "+ κ · (A2 cos(ωt + φ))",
    "+ ϵ\n2 · (A1 cos(ωt + φ))",
    "= 0\nFactor out cos(ωt + φ) and divide through by m.\n\u0000",
    "k\nm −ω2\u0001\n· A1 + ϵ\n2m · A2 = 0\n\u0000κ\nI −ω2\u0001\n· A2 + ϵ\n2m ·",
    "A1 = 0\nWe are assuming that k/m = ω2\nx and replace κ/I = ω2\nθ are equal, and writing\nω2\n0 for that number.",
    "Make the substitution and restate it as a matrix equation.\n \n",
    "ω2\n0",
    "−ω2\nϵ/2m\nϵ/2I\nω2\n0",
    "−ω2\n!  \n",
    "A1\nA2\n!\n",
    "=\n \n0\n0\n!\n",
    "Obviously this system has the trivial solution A1 = 0, A2 = 0, for the case\nwhere the mass is at rest.",
    "We want to know for which frequencies ω this system\nhas a nontrivial solution.\n \n",
    "ω2\n0\nϵ/2m\nϵ/2I\nω2\n0\n!  \n",
    "A1\nA2\n!\n= ω2\n \nA1\nA2\n!\n",
    "The normal mode angular frequencies ω are the eigenvalues of the matrix.\n",
    "To calculate it take the determinant and set it to zero.\n\f\f\f\f\f\n",
    "ω2\n0",
    "−ω2\nϵ/2m\nϵ/2I\nω2\n0",
    "−ω2\n\f\f\f\f\f = 0\n=⇒\nω4 −(2ω2\n0) ω2 + (ω4\n0 −ϵ2\n4mI) = 0\n\n486\nChapter Five.",
    "Similarity\nThat equation is quadratic in ω2.",
    "Apply the formula to solve quadratic equations,\n(−b ±\n√\nb2 −4ac)/(2a).\n",
    "ω2 =\n2ω2\n0 ±\nq\n4ω4\n0 −4(ω4\n0 −ϵ2/4mI)\n2\n= ω2\n0 ±\nϵ\n2\n√\nmI\nThe value ϵ/\n√\nmI = ϵ/\n√\nκk is often written ωB so that ω2 = ω2\n0 ± ωB/2.",
    "This\nis the beat frequency, the diﬀerence between the two normal mode frequencies.\n",
    "Although the argument is beyond our scope, the general formula for the\nmotion of the pendulum is a linear combination of the motions during the normal\nmodes.",
    "Thus, the pendulum’s motion is entirely determined by the eigenvalues\nof the above matrix.",
    "See [Berg & Marshall].\n",
    "Exercises\n1 Use the formula for the cosine of a sum to give an even more general formula for\nsimple harmonic motion.\n",
    "2 Find the eigenvectors associated with the eigenvalues.\n",
    "3 Find the values of ω in the case where x(t) = A1 cos(ωt+φ) and θ(t) = A2 cos(ωt+\n(φ + π)).\n",
    "4 Build a Wilberforce pendulum out of a Slinky Jr and a soup can.",
    "You can drill\nholes in the can for bolts, either two or four of them, that you can use to adjust\nthe moment of inertia of the can so the periods of vertical and rotational motion\ncoincide.\n\n",
    "Appendix\nMathematics is made of arguments (reasoned discourse that is, not crockery-\nthrowing).",
    "This section sketches the background material and argument tech-\nniques that we use in the book.\n",
    "This section informally outlines the topics, skipping proofs.\n",
    "For more,\n[Velleman2] is excellent.",
    "Two other sources, available online, are [Hefferon]\nand [Beck].\n",
    "Statements\nFormal mathematical statements come labelled as a Theorem for major points,\na Corollary for results that follow immediately from a prior one, or a Lemma\nfor results chieﬂy used to prove others.\n",
    "Statements can be complex and have many parts.",
    "The truth or falsity of the\nentire statement depends both on the truth value of the parts and on how the\nstatement is put together.\n",
    "Not\nWhere P is a proposition, ‘it is not the case that P’ is true provided that\nP is false.",
    "For instance, ‘n is not prime’ is true only when n is the product of\nsmaller integers.\n",
    "To prove that a ‘not P’ statement holds, show that P is false.\n",
    "And\nFor a statement of the form ‘P and Q’ to be true both halves must hold:\n‘7 is prime and so is 3’ is true, while ‘7 is prime and 3 is not’ is false.\n",
    "To prove a ‘P and Q’, prove each half.\nOr A ‘P or Q’ statement is true when either half holds: ‘7 is prime or 4 is prime’\nis true, while ‘8 is prime or 4 is prime’ is false.",
    "In the case that both clauses of\nthe statement are true, as in ‘7 is prime or 3 is prime’, we take the statement\nas a whole to be true.",
    "(In everyday speech people occasionally use ‘or’ in an\nexclusive way — “Live free or die” does not intend both halves to hold — but we\nwill not use ‘or’ in that way.)\n\nA-2\nTo prove ‘P or Q’, show that in all cases at least one half holds (perhaps\nsometimes one half and sometimes the other, but always at least one).\n",
    "If-then An ‘if P then Q’ statement may also appear as ‘P implies Q’ or ‘P =⇒Q’\nor ‘P is suﬃcient to give Q’ or ‘Q if P’.",
    "It is true unless P is true while Q is\nfalse.",
    "Thus ‘if 7 is prime then 4 is not’ is true while ‘if 7 is prime then 4 is also\nprime’ is false.",
    "(Contrary to its use in casual speech, in mathematics ‘if P then\nQ’ does not connote that P precedes Q or causes Q.)\nNote this consequence of the prior paragraph: if P is false then ‘if P then Q’\nis true irrespective of the value of Q: ‘if 4 is prime then 7 is prime’ and ‘if 4 is\nprime then 7 is not’ are both true statements.",
    "(They are vacuously true.)",
    "Also\nobserve that ‘if P then Q’ is true when Q is true: ‘if 4 is prime then 7 is prime’\nand ‘if 4 is not prime then 7 is prime’ are both true.\n",
    "There are two main ways to establish an implication.\n",
    "The ﬁrst way is\ndirect: assume that P is true and use that assumption to prove Q. For instance,\nto show ‘if a number is divisible by 5 then twice that number is divisible by\n10’ we can assume that the number is 5n and deduce that 2(5n) = 10n.",
    "The\nindirect way is to prove the contrapositive statement: ‘if Q is false then P is\nfalse’ (rephrased, ‘Q can only be false when P is also false’).",
    "Thus to show ‘if a\nnatural number is prime then it is not a perfect square’ we can argue that if it\nwere a square p = n2 then it could be factored p = n · n where n < p and so\nwouldn’t be prime (p = 0 or p = 1 don’t satisfy",
    "n < p",
    "but they are nonprime).\n",
    "Equivalent statements\nSometimes, not only does P imply Q but also Q implies P.\nSome ways to say this are: ‘P if and only if Q’, ‘P iﬀQ’, ‘P and Q are logically\nequivalent’, ‘P is necessary and suﬃcient to give Q’, ‘P ⇐⇒Q’.",
    "An example is\n‘an integer is divisible by ten if and only if that number ends in 0’.\n",
    "Although in simple arguments a chain like “P if and only if R, which holds if\nand only if S . . . ”",
    "may be practical, to prove that statements are equivalent we\nmore often prove the two halves ‘if P then Q’ and ‘if Q then P’ separately.\n",
    "Quantiﬁers\nCompare these statements about natural numbers: ‘there is a natural number x\nsuch that x is divisible by x2’ is true, while ‘for all natural numbers x, that x is\ndivisible by x2’ is false.",
    "The preﬁxes ‘there is’ and ‘for all’ are quantiﬁers.\n",
    "For all\nThe ‘for all’ preﬁx is the universal quantiﬁer, symbolized ∀.\nThe most straightforward way to prove that a statement holds in all cases is\nto prove that it holds in each case.",
    "Thus to show that ‘every number divisible by\np has its square divisible by p2’, take a single number of the form pn and square\nit (pn)2 = p2n2.",
    "This is a typical element proof.",
    "(In this kind of argument\nbe careful not to assume properties for that element other than the ones in the\n\nA-3\nhypothesis.",
    "This argument is wrong: “If n is divisible by a prime, say 2, so that\nn = 2k for some natural number k, then n2 = (2k)2 = 4k2 and the square of n\nis divisible by the square of the prime.”",
    "That is a proof for the special case p = 2\nbut it isn’t a proof for all p.",
    "Contrast it with a correct one: “If n is divisible\nby a prime",
    "so that n = pk for some natural number k then n2 = (pk)2 = p2k2\nand so the square of n is divisible by the square of the prime.”)\n",
    "There exists\nThe ‘there exists’ preﬁx is the existential quantiﬁer, symbolized ∃.\n",
    "We can prove an existence proposition by producing something satisfying\nthe property: for instance, to settle the question of primality of 225",
    "+ 1, Euler\nexhibited the divisor 641[Sandifer].",
    "But there are proofs showing that something\nexists without saying how to ﬁnd it; Euclid’s argument given in the next\nsubsection shows there are inﬁnitely many primes without giving a formula\nnaming them.\n",
    "Finally, after “Are there any?” we often ask “How many?”\nThat is, the\nquestion of uniqueness often arises in conjunction with the question of existence.\n",
    "Sometimes the two arguments are simpler if separated so note that just as\nproving something exists does not show that it is unique, neither does proving\nthat something is unique show that it exists.\n",
    "Techniques of Proof\nWe have many ways to prove mathematical statements.",
    "Here we will outline\ntwo techniques that we use often, and that might not come naturally, even to a\nperson with a technical turn of mind.\n",
    "Induction\nMany proofs are iterative, “Here’s why the statement is true for the\nnumber 0, it then follows for 1 and from there to 2 . . .",
    "”.",
    "These are proofs by\nmathematical induction.",
    "We will see two examples.\n",
    "We will ﬁrst prove that 1 + 2 + 3 + · · · + n = n(n + 1)/2.",
    "That formula has\na natural number variable n that is free, meaning that setting n to be 1, or\n2, etc., gives a family of cases of the statement: ﬁrst that 1 = 1(2)/2, second\nthat 1 + 2 = 2(3)/2, etc.",
    "Our induction proofs involve statements with one free\nnatural number variable.\n",
    "Each such proof has two steps.",
    "In the base step we show that the statement\nholds for some intial number",
    "i ∈N.",
    "Often this step is a routine veriﬁcation.\n",
    "The second step, the inductive step, is more subtle; we will show that this\nimplication holds:\n",
    "If the statement holds from n = i up to and including n = k\nthen the statement holds also in the n = k + 1 case\n(∗)\n(the ﬁrst line is the inductive hypothesis).",
    "Completing both steps proves that\nthe statement is true for all natural numbers greater than or equal to i.\n\nA-4\n",
    "For the sum of the initial n numbers statement the intuition behind the\nprinciple is that ﬁrst, the base step directly veriﬁes the statement for the case\nof the initial number n = 1.",
    "Then, because the inductive step veriﬁes the\nimplication (∗) for all k, that implication applied to k = 1 gives that the\nstatement is true for the case of the number n = 2.",
    "Now, with the statement\nestablished for both 1 and 2, apply (∗) again to conclude that the statement is\ntrue for the number n = 3.",
    "In this way, we bootstrap to all numbers n ⩾1.\n",
    "Here is a proof of 1 + 2 + 3 + · · · + n = n(n + 1)/2, with separate paragraphs\nfor the base step and the inductive step.\n",
    "For the base step we show that the formula holds when n = 1.",
    "That’s\neasy; the sum of the ﬁrst 1 natural number equals 1(1 + 1)/2.\n",
    "For the inductive step, assume the inductive hypothesis that the formula\nholds for the numbers n = 1, n = 2, . .",
    ".",
    ", n = k with k ⩾1.",
    "That is,\nassume 1 = 1(1)/2, and 1 + 2 = 2(3)/2, and 1 + 2 + 3 = 3(4)/2, through\n1 + 2 + · · ·",
    "+ k = k(k + 1)/2.",
    "With that, the formula holds also in the\nn = k + 1 case:\n1 + 2 + · · ·",
    "+ k",
    "+ (k + 1) = k(k + 1)\n2\n+ (k + 1) = (k + 1)(k + 2)\n2\n(the ﬁrst equality follows from the inductive hypothesis).\n",
    "Here is another example, proving that every integer greater than or equal to\n2 is a product of primes.\n",
    "The base step is easy: 2 is the product of a single prime.\n",
    "For the inductive step assume that each of 2, 3, . . .",
    ", k is a product of primes,\naiming to show k+1 is also a product of primes.",
    "There are two possibilities.\n",
    "First, if k + 1 is not divisible by a number smaller than itself then it is a\nprime and so is the product of primes.",
    "The second possibility is that k",
    "+ 1\nis divisible by a number smaller than itself, and then by the inductive\nhypothesis its factors can be written as a product of primes.",
    "In either case\nk + 1 can be rewritten as a product of primes.\n",
    "Contradiction\nAnother technique of proof is to show that something is true by\nshowing that it cannot be false.",
    "A proof by contradiction assumes that the\nproposition is false and derives some contradiction to known facts.\n",
    "The classic example of proof by contradiction is Euclid’s argument that there\nare inﬁnitely many primes.\n",
    "Suppose that there are only ﬁnitely many primes p1, . . .",
    ", pk.",
    "Consider the\nnumber p1 ·p2 . . .",
    "pk +1.",
    "None of the primes on the supposedly exhaustive\nlist divides this number evenly since each leaves a remainder of 1.",
    "But\nevery number is a product of primes so this can’t be.",
    "Therefore there\ncannot be only ﬁnitely many primes.\n\n",
    "A-5\nAnother example is this proof that\n√\n2 is not a rational number.\n",
    "Suppose that\n√\n2 = m/n, so that 2n2 = m2.",
    "Factor out any 2’s, giving\nn = 2kn · ˆn and m = 2km · ˆm.",
    "Rewrite.\n",
    "2 · (2kn · ˆn)2 = (2km · ˆm)2\nThe Prime Factorization Theorem says that there must be the same number\nof factors of 2 on both sides, but there are an odd number of them",
    "1",
    "+ 2kn\non the left and an even number 2km on the right.",
    "That’s a contradiction,\nso a rational number with a square of 2 is impossible.\n",
    "Sets, Functions, and Relations\nThe material here forms the backdrop, the vocabulary, for all of the development\nthat we do.\n",
    "Sets Mathematicians often work with collections.",
    "The most commonly-used kind\nof collection is a set.",
    "Sets are characterized by the Principle of Extensionality:\ntwo sets with the same elements are equal.",
    "Because of this, the order of the\nelements does not matter {2, π} = {π, 2}, and repeats collapse {7, 7} = {7}.\n",
    "We can describe a set using a listing between curly braces {1, 4, 9, 16} (as\nin the prior paragraph), or by using set-builder notation {x | x5 −3x3 + 2 = 0}\n(read “the set of all x such that . . .",
    "”).",
    "We name sets with capital roman letters;\nfor instance the set of primes is P = {2, 3, 5, 7, 11, . . .",
    "}",
    "(except that a few sets\nare so important that their names are reserved, such as the real numbers R and\nthe complex numbers C).",
    "To denote that something is an element, or member,)\nof a set we use ‘∈’, so that 7 ∈{3, 5, 7} while 8 ̸∈{3, 5, 7}.\n",
    "We say that A is a subset of B, written A ⊆B, when x ∈A implies that\nx ∈B.",
    "In this book we use ‘⊂’ for the proper subset relationship that A is a\nsubset of B but A ̸= B (some authors use this symbol for any kind of subset,\nproper or not).",
    "An example is {2, π} ⊂{2, π, 7}.",
    "These symbols may be ﬂipped,\nfor instance {2, π, 5} ⊃{2, 5}.\n",
    "Because of Extensionality, to prove that two sets are equal A = B show that\nthey have the same members.",
    "Often we do this by showing mutual inclusion,\nthat both A ⊆B and A ⊇B. Such a proof will have a part showing that if\nx ∈A then x ∈B, and a second part showing that if x ∈B then x ∈A.\nWhen a set has no members then it is the empty set { }, symbolized ∅.\nAny set has the empty set for a subset by the ‘vacuously true’ property of the\ndeﬁnition of implication.\n",
    "Diagrams\nWe picture basic set operations with a Venn diagram.",
    "This shows\nx ∈P.\n\nA-6\nP\nx\nThe outer rectangle contains the universe Ωof all objects under discussion.",
    "For\ninstance, in a statement about real numbers, the rectangle encloses all members\nof R. The set is pictured as a circle, enclosing its members.\n",
    "Here is the diagram for P ⊆Q.",
    "It shows that if x ∈P then x ∈Q.\nP\nQ\nSet Operations\nThe union of two sets is P ∪Q",
    "= {x | (x ∈P) or (x ∈Q)}.",
    "The\ndiagram shows that an element is in the union if it is in either of the sets.\n",
    "P\nQ\nThe intersection is P ∩Q",
    "= {x | (x ∈P) and (x ∈Q)}.\n",
    "P\nQ\nThe complement of a set P is Pcomp = {x ∈Ω| x ̸∈P}\nP\nx\nMultisets As described above, a set is a collection in which order does not matter,\nso that the sets {2, π} and {π, 2} are equal, and in which repeats collapse, so\nthat the sets {7, 7} and {7} are equal.\n\n",
    "A-7\nA collection that is like a set in that order does not matter, but in which\nrepeats do not collapse, is a multiset.",
    "(Note that we use the same curly brackets\nnotation {. . .",
    "}",
    "as for sets.)",
    "Thus the multiset {1, 2, 2} diﬀers from the multiset\n{1, 2}.",
    "Because order does not matter, these multisets are all equal: {1, 2, 2},\n{2, 1, 2}, and {2, 2, 1}.",
    "In this text we only mention multisets in a remark so\ngoing into how to do subsets, unions, or intersections, is beyond our scope.\n",
    "Sequences\n",
    "In addition to sets and multisets, we also use collections where order\nmatters and where repeats do not collapse.",
    "These are sequences, denoted with\nangle brackets: ⟨2, 3, 7⟩̸= ⟨2, 7, 3⟩. A sequence of length 2 is an ordered pair,\nand is often written with parentheses: (π, 3).",
    "We also sometimes say ‘ordered\ntriple’, ‘ordered 4-tuple’, etc.",
    "The set of ordered n-tuples of elements of a set A\nis denoted An.",
    "Thus R2 is the set of pairs of reals.\n",
    "Functions\nA function or map f: D →C is is an association between input\narguments x ∈D and output values f(x) ∈C subject to the the requirement that\nthe function must be well-deﬁned, that x suﬃces to determine f(x).",
    "Restated,\nthe condition is that if x1 = x2 then f(x1) = f(x2).\n",
    "The set of all arguments D is f’s domain and the set of output values is\nits range R(f).",
    "Often we don’t work with the range and instead work with\na convenient superset, the codomain C. For instance, we might describe the\nsquaring function with s: R →R instead of s: R →R+ ∪{0}.\n",
    "We picture functions with a bean diagram.\n",
    "The blob on the left is the domain while on the right is the codomain.",
    "The\nfunction associates the three points of the domain with three in the codomain.\n",
    "Note that by the deﬁnition of a function every point in the domain is associated\nwith a unique point in the codomain, but the converse needn’t be true.\n",
    "The association is arbitrary; no formula or algorithm is required, although in\nthis book there typically is one.",
    "We often use y to denote f(x).",
    "We also use the\nnotation x\nf\n7−→16x2 −100, read ‘x maps under f to 16x2 −100’ or ‘16x2 −100\nis the image of x’.\n",
    "A map such as x 7→sin(1/x) is a combinations of simpler maps, here g(y) =\nsin(y) applied to the image of f(x)",
    "= 1/x.",
    "The composition of g: Y →Z with\nf: X →Y, is the map sending x ∈X to g( f(x) )",
    "∈Z.",
    "It is denoted g ◦f: X",
    "→Z.\nThis deﬁnition only makes sense if the range of f is a subset of the domain of g.\n\nA-8\nAn identity map id:",
    "Y →Y deﬁned by id(y) = y has the property that for\nany f: X →Y, the composition id ◦f is equal to f.",
    "So an identity map plays the\nsame role with respect to function composition that the number 0 plays in real\nnumber addition or that 1 plays in multiplication.\n",
    "In line with that analogy, we deﬁne a left inverse of a map f: X →Y to be\na function g: range(f) →X such that g ◦f is the identity map on X. A right\ninverse of f is a h: Y →X such that f ◦h is the identity.\n",
    "For some f’s there is a map that is both a left and right inverse of f.",
    "If such\na map exists then it is unique because if both g1 and g2 have this property\nthen g1(x) = g1 ◦(f ◦g2) (x) = (g1 ◦f) ◦g2 (x) = g2(x) (the middle equality\ncomes from the associativity of function composition)",
    "so we call it a two-sided\ninverse or just “the” inverse, and denote it f−1.",
    "For instance, the inverse of\nthe function f: R →R given by f(x) = 2x −3 is the function f−1 : R →R given\nby f−1(x) = (x + 3)/2.\n",
    "The superscript notation for function inverse ‘f−1’ ﬁts into a larger scheme.\n",
    "Functions with the same codomain as domain f: X →X can be iterated, so that\nwe can consider the composition of f with itself: f ◦f, and f ◦f ◦f, etc.",
    "We write\nf ◦f as f2 and f ◦f ◦f as f3, etc.",
    "Note that the familiar exponent rules for real\nnumbers hold: fi ◦fj = fi+j and (fi)j = fi·j.",
    "Then where f is invertible, writing\nf−1 for the inverse and f−2 for the inverse of f2, etc., gives that these familiar\nexponent rules continue to hold, since we deﬁne f0 to be the identity map.\n",
    "The deﬁnition of function requires that for every input there is one and only\none associated output value.",
    "If a function f: D →C has the additional property\nthat for every output value there is at least one associated input value — that is,\nthe additional property that f’s codomain equals its range C = R(f) — then the\nfunction is onto.\n",
    "A function has a right inverse if and only if it is onto.",
    "(The f pictured above\nhas a right inverse",
    "g: C →D given by following the arrows backwards, from\nright to left.",
    "For the codomain point on the top, choose either one of the arrows\nto follow.",
    "With that, applying g ﬁrst followed by f takes elements y ∈C to\nthemselves, and so is the identity function.)\n",
    "If a function f: D →C has the property that for every output value there is\nat most one associated input value — that is, if no two arguments share an image\nso that f(x1)",
    "= f(x2) implies that x1 = x2 — then the function is one-to-one.\n",
    "The bean diagram from earlier illustrates.\n\n",
    "A-9\nA function has a left inverse if and only if it is one-to-one.",
    "(In the picture deﬁne\ng: C →D to follow the arrows backwards for those y ∈C that are at the end of\nan arrow, and to send the point to an arbitrary element in D otherwise.",
    "Then\napplying f followed by g to elements of D will act as the identity.)\n",
    "By the prior paragraphs, a map has a two-sided inverse if and only if that map\nis both onto and one-to-one.",
    "Such a function is a correspondence.",
    "It associates\none and only one element of the domain with each element of the codomain.\n",
    "Because a composition of one-to-one maps is one-to-one, and a composition of\nonto maps is onto, a composition of correspondences is a correspondence.\n",
    "We sometimes want to shrink the domain of a function.",
    "For instance, we\nmay take the function f: R →R given by f(x)",
    "= x2",
    "and, in order to have an\ninverse, limit input arguments to nonnegative reals ˆf: R+ ∪{0} →R. Then ˆf is\nthe restriction of f to the smaller domain.\n",
    "Relations\nSome familiar mathematical things, such as ‘<’ or ‘=’, are most\nnaturally understood as relations between things.",
    "A binary relation on a set\nA is a set of ordered pairs of elements of A. For example, some elements of\nthe set that is the relation ‘<’ on the integers are (3, 5), (3, 7), and (1, 100).\n",
    "Another binary relation on the integers is equality; this relation is the set\n{. . .",
    ", (−1, 1), (0, 0), (1, 1), . . .}.",
    "Still another example is ‘closer than 10’, the set\n{(x, y) | |x −y| < 10}.",
    "Some members of this relation are (1, 10), (10, 1), and\n(42, 44).",
    "Neither (11, 1) nor (1, 11) is a member.\n",
    "Those examples illustrate the generality of the deﬁnition.\n",
    "All kinds of\nrelationships (e.g., ‘both numbers even’ or ‘ﬁrst number is the second with the\ndigits reversed’) are covered.\n",
    "Equivalence Relations\nWe shall need to express that two objects are alike in\nsome way.",
    "They aren’t identical, but they are related (e.g., two integers that\ngive the same remainder when divided by 2).\n",
    "A binary relation {(a, b), . . .} is an equivalence relation when it satisﬁes\n(1) reﬂexivity: any object is related to itself, (2) symmetry: if a is related\nto b then b is related to a, and (3) transitivity: if a is related to b and b is\nrelated to c then a is related to c. Some examples (on the integers): ‘=’ is an\nequivalence relation, ‘<’ does not satisfy symmetry, ‘same sign’ is a equivalence,\nwhile ‘nearer than 10’ fails transitivity.\n",
    "Partitions\nIn the ‘same sign’ relation {(1, 3), (−5, −7), (0, 0), . . .",
    "}",
    "there are three\n\nA-10\nkinds of pairs, pairs with both numbers positive, pairs with both negative, and\nthe one pair with both zero.",
    "So integers fall into exactly one of three classes,\npositive, or negative, or zero.\n",
    "A partition of a set Ωis a collection of subsets {S0, S1, S2, . . .}",
    "such that\nevery element of S is an element of a subset S1 ∪S2 ∪· · · = Ωand overlapping\nparts are equal: if Si ∩Sj ̸= ∅then Si = Sj.",
    "Picture that Ωis decomposed into\nnon-overlapping parts.\n. .",
    ".\n",
    "S0\nS1\nS2\nS3\n",
    "Thus the prior paragraph says that ‘same sign’ partitions the integers into the\nset of positives, the set of negatives, and the set containing only zero.",
    "Similarly,\nthe equivalence relation ‘=’ partitions the integers into one-element sets.\n",
    "Another example is the set of strings consisting of a number, followed by\na slash, followed by a nonzero number Ω= {n/d | n, d ∈Z and d ̸= 0}.",
    "Deﬁne\nSn,d by: ˆn/ˆd ∈Sn,d if ˆnd = nˆd.",
    "Checking that this is a partition of Ωis\nroutine (observe for instance that S4,3 = S8,6).",
    "This shows some parts, listing\nin each a couple of its inﬁnitely many members.\n. . .\n.",
    "0/1\n.",
    "0/3\n.",
    "1/1\n.",
    "2/2\n.",
    "2/4\n.",
    "−2/−4\n.",
    "4/3\n.",
    "8/6\nEvery equivalence relation induces a partition, and every partition is induced\nby an equivalence.",
    "(This is routine to check.)",
    "Below are two examples.\n",
    "Consider the equivalence relationship between two integers of ‘gives the same\nremainder when divided by 2’, the set P = {(−1, 3), (2, 4), (0, 0), . . .}.",
    "In the set P\nare two kinds of pairs, the pairs with both members even and the pairs with both\nmembers odd.",
    "This equivalence induces a partition where the parts are found\nby: for each x we deﬁne the set of numbers related to it Sx = {y | (x, y) ∈P}.\n",
    "The parts are {. . .",
    ", −3, −1, 1, 3, . . .} and {. . .",
    ", −2, 0, 2, 4, . . .}.",
    "Each part can be\nnamed in many ways; for instance, {. . .",
    ", −3, −1, 1, 3, . . .} is S1 and also is S−3.\n",
    "Now consider the partition of the natural numbers where two numbers are\nin the same part if they leave the same remainder when divided by 10, that\nis, if they have the same least signiﬁcant digit.",
    "This partition is induced by\nthe equivalence relation R deﬁned by: two numbers n, m are related if they\nare together in the same part.",
    "For example, 3 is related to 33, but 3 is not\n\nA-11\nrelated to 102.",
    "Verifying the three conditions in the deﬁnition of equivalence\nare straightforward.\n",
    "We call each part of a partition an equivalence class.",
    "We sometimes pick a\nsingle element of each equivalence class to be the class representative.\n. . .\n",
    "⋆\n⋆\n⋆\n⋆\nUsually when we pick representatives we have some natural scheme in mind.",
    "In\nthat case we call them the canonical representatives.",
    "An example is that two\nfractions 3/5 and 9/15 are equivalent.",
    "In everyday work we often prefer to use\nthe ‘simplest form’ or ‘reduced form’ fraction 3/5 as the class representative.\n. . .\n",
    "⋆0/1\n⋆1/1\n⋆1/2\n⋆4/3\n\n\nBibliography\n[Ackerson] R. H. Ackerson, A Note on Vector Spaces, American Mathematical\nMonthly, vol.",
    "62 no. 10 (Dec. 1955), p. 721.\n",
    "[Am.",
    "Math.",
    "Mon., Jun. 1931] C. A. Rupp (proposer), H. T. R. Aude (solver),\nproblem 3468, American Mathematical Monthly, vol.",
    "37 no. 6 (June-July\n1931), p. 355.\n",
    "[Am.",
    "Math.",
    "Mon., Feb. 1933]",
    "V. F. Ivanoﬀ(proposer), T. C. Esty (solver), problem\n3529, American Mathematical Monthly, vol.",
    "39 no. 2 (Feb. 1933), p. 118.\n",
    "[Am.",
    "Math.",
    "Mon., Jan. 1935]",
    "W. R. Ransom (proposer), Hansraj Gupta (solver),\nElementary problem 105, American Mathematical Monthly, vol.",
    "42 no. 1 (Jan.\n1935), p. 47.\n",
    "[Am.",
    "Math.",
    "Mon., Jan. 1949] C. W. Trigg (proposer), R. J. Walker (solver),\nElementary problem 813, American Mathematical Monthly, vol.",
    "56 no. 1 (Jan.\n1949), p. 33.\n",
    "[Am.",
    "Math.",
    "Mon., Jun. 1949]",
    "Don Walter (proposer), Alex Tytun (solver),\nElementary problem 834, American Mathematical Monthly, vol.",
    "56 no. 6\n(June-July 1949), p. 409.\n",
    "[Am.",
    "Math.",
    "Mon., Nov. 1951]",
    "Albert Wilansky, The Row-Sums of the Inverse\nMatrix, American Mathematical Monthly, vol.",
    "58 no. 9 (Nov. 1951), p. 614.\n",
    "[Am.",
    "Math.",
    "Mon., Feb. 1953]",
    "Norman Anning (proposer), C. W. Trigg (solver),\nElementary problem 1016, American Mathematical Monthly, vol.",
    "60 no. 2 (Feb.\n1953), p. 115.\n",
    "[Am.",
    "Math.",
    "Mon., Apr. 1955]",
    "Vern Haggett (proposer), F. W. Saunders (solver),\nElementary problem 1135, American Mathematical Monthly, vol.",
    "62 no. 4\n(Apr. 1955), p. 257.\n",
    "[Am.",
    "Math.",
    "Mon., Jan. 1963]",
    "Underwood Dudley, Arnold Lebow (proposers), David\nRothman (solver), Elementary problem 1151, American Mathematical\nMonthly, vol.",
    "70 no. 1 (Jan. 1963), p. 93.\n\n",
    "[Am.",
    "Math.",
    "Mon., Dec. 1966]",
    "Hans Liebeck, A Proof of the Equality of Column\nRank and Row Rank of a Matrix American Mathematical Monthly, vol.",
    "73\nno. 10 (Dec. 1966), p. 1114.\n",
    "[Anton] Howard Anton, Elementary Linear Algebra, John Wiley & Sons, 1987.\n",
    "[Arrow] Kenneth J. Arrow, Social Choice and Individual Values, Wiley, 1963.\n",
    "[Austin] David Austin, How Google Finds Your Needle in the Web’s Haystack,\nhttp://www.ams.org/samplings/feature-column/fcarc-pagerank, retrieved\nFeb. 2012.\n",
    "[Ball & Coxeter] W.W. Rouse Ball, Mathematical Recreations and Essays, revised\nby H.S.M. Coxeter, MacMillan, 1962.\n",
    "[Beck] Matthias Beck, Ross Geoghegan, The Art of Proof,\nhttp://math.sfsu.edu/beck/papers/aop.noprint.pdf, 2011-Aug-08.\n",
    "[Beardon] A.F. Beardon, The Dimension of the Space of Magic Squares, The\nMathematical Gazette, vol.",
    "87, no. 508 (Mar. 2003), p. 112-114.\n",
    "[Berg & Marshall] Richar E Berg, Todd S Marshall, Wilberforce pendulum\noscillations and normal modes, American Journal of Physics, volume 59\nnumber 1 (Jan 1991), p. 32–38.\n",
    "[Birkhoﬀ& MacLane] Garrett Birkhoﬀ, Saunders MacLane, Survey of Modern\nAlgebra, third edition, Macmillan, 1965.\n",
    "[Blass 1984] A. Blass, Existence of Bases Implies the Axiom of Choice, pp.",
    "31 – 33,\nAxiomatic Set Theory, J. E. Baumgartner, ed., American Mathematical\nSociety, Providence RI, 1984.\n",
    "[Bridgman] P.W. Bridgman, Dimensional Analysis, Yale University Press, 1931.\n",
    "[Brin & Page] Sergey Brin and Lawrence Page, The Anatomy of a Large-Scale\nHypertextual Web Search Engine,\nhttp://infolab.stanford.edu/pub/papers/google.pdf, retrieved Feb. 2012.\n",
    "[Bryan & Leise] Kurt Bryan, Tanya Leise, The $25,000,000,000 Eigenvector: the\nLinear Algebra Behind Google, SIAM Review, Vol. 48, no. 3 (2006), p. 569-81.\n",
    "[Casey] John Casey, The Elements of Euclid, Books I to VI and XI, ninth edition,\nHodges, Figgis, and Co., Dublin, 1890.\n",
    "[ChessMaster] User ChessMaster of StackOverﬂow, answer to Python determinant\ncalculation(without the use of external libraries),\nhttp://stackoverflow.com/a/10037087/238366, answer posted 2012-Apr-05,\naccessed 2012-Jun-18.\n",
    "[Chicken Scheme] Free software implementation, Felix L. Winkelmann and The\nChicken Team, http://wiki.call-cc.org/, accessed 2013-Nov-20.\n",
    "[Clark & Coupe] David H. Clark, John D. Coupe, The Bangor Area Economy Its\nPresent and Future, report to the city of Bangor ME, Mar. 1967.\n",
    "[Cleary] R. Cleary, private communication, Nov. 2011.\n\n",
    "[Clarke] Arthur C. Clarke, Technical Error, Fantasy, December 1946, reprinted in\nGreat SF Stories 8 (1946), DAW Books, 1982.\n",
    "[Con. Prob.",
    "1955]",
    "The Contest Problem Book, 1955 number 38.\n",
    "[Cost Of Tolls] Cost of Tolls, http://costoftolls.com/Tolls_in_New_York.html,\n2012-Jan-07.\n",
    "[Coxeter] H.S.M. Coxeter, Projective Geometry, second edition, Springer-Verlag,\n1974.\n",
    "[Courant & Robbins] Richard Courant, Herbert Robbins, What is Mathematics?,\nOxford University Press, 1978.\n",
    "[Cullen] Charles G. Cullen, Matrices and Linear Transformations, second edition,\nDover, 1990.\n",
    "[Dalal, et. al.]",
    "Siddhartha R. Dalal, Edward B. Fowlkes, & Bruce Hoadley, Lesson\nLearned from Challenger: A Statistical Perspective, Stats: the Magazine for\nStudents of Statistics, Fall 1989, p. 3.\n",
    "[Davies] Thomas D. Davies, New Evidence Places Peary at the Pole, National\nGeographic Magazine, vol.",
    "177 no. 1 (Jan. 1990), p. 44.\n",
    "[de Mestre] Neville de Mestre, The Mathematics of Projectiles in Sport, Cambridge\nUniversity Press, 1990.\n",
    "[De Parville] De Parville, La Nature, Paris, 1884, part I, p. 285 – 286 (citation from\n[Ball & Coxeter]).\n",
    "[Ebbing] Darrell D. Ebbing, General Chemistry, fourth edition, Houghton Miﬄin,\n1993.\n",
    "[Ebbinghaus] H. D. Ebbinghaus, Numbers, Springer-Verlag, 1990.\n",
    "[Einstein] A. Einstein, Annals of Physics, v. 35, 1911, p. 686.\n",
    "[Eggar] M.H. Eggar, Pinhole Cameras, Perspective, and Projective Geometry,\nAmerican Mathematical Monthly, August-September 1998, p. 618 – 630.\n",
    "[Falbo] Clement Falbo, The Golden Ratio — a Contrary Viewpoint, College\nMathematics Journal, vol. 36, no. 2, March 2005, p. 123 – 134.\n",
    "[Feller] William Feller, An Introduction to Probability Theory and Its Applications\n(vol. 1, 3rd ed.), John Wiley, 1968.\n",
    "[Fuller & Logan] L.E. Fuller & J.D. Logan, On the Evaluation of Determinants by\nChiò’s Method, p 49-52, in Linear Algebra Gems, Carlson, et al, Mathematical\nAssociation of America, 2002.\n",
    "[Gardner] Martin Gardner, The New Ambidextrous Universe, third revised edition,\nW. H. Freeman and Company, 1990.\n",
    "[Gardner 1957]",
    "Martin Gardner, Mathematical Games: About the remarkable\nsimilarity between the Icosian Game and the Tower of Hanoi, Scientiﬁc\nAmerican, May 1957, p. 150 – 154.\n\n",
    "[Gardner, 1970]",
    "Martin Gardner, Mathematical Games, Some mathematical\ncuriosities embedded in the solar system, Scientiﬁc American, April 1970,\np. 108 – 112.\n",
    "[Gardner, 1980]",
    "Martin Gardner, Mathematical Games, From counting votes to\nmaking votes count: the mathematics of elections, Scientiﬁc American,\nOctober 1980.\n",
    "[Gardner, 1974]",
    "Martin Gardner, Mathematical Games, On the paradoxical\nsituations that arise from nontransitive relations, Scientiﬁc American,\nOctober 1974.\n",
    "[Giordano, Wells, Wilde] Frank R. Giordano, Michael E. Wells, Carroll O. Wilde,\nDimensional Analysis, UMAP Unit 526, in UMAP Modules, 1987, COMAP,\n1987.\n",
    "[Giordano, Jaye, Weir] Frank R. Giordano, Michael J. Jaye, Maurice D. Weir, The\nUse of Dimensional Analysis in Mathematical Modeling, UMAP Unit 632, in\nUMAP Modules, 1986, COMAP, 1986.\n",
    "[Google Maps] Directions — Google Maps,\nhttp://maps.google.com/help/maps/directions/, 2012-Jan-07.\n",
    "[Goult, et al.]",
    "R.J. Goult, R.F. Hoskins, J.A. Milner, M.J. Pratt, Computational\nMethods in Linear Algebra, Wiley, 1975.\n",
    "[Graham, Knuth, Patashnik]",
    "Ronald L. Graham, Donald E. Knuth, Oren Patashnik,\nConcrete Mathematics, Addison-Wesley, 1988.\n",
    "[Halmos] Paul R. Halmos, Finite Dimensional Vector Spaces, second edition, Van\nNostrand, 1958.\n",
    "[Hamming] Richard W. Hamming, Introduction to Applied Numerical Analysis,\nHemisphere Publishing, 1971.\n",
    "[Hanes] Kit Hanes, Analytic Projective Geometry and its Applications, UMAP Unit\n710, UMAP Modules, 1990, p. 111.\n",
    "[Heath] T. Heath, Euclid’s Elements, volume 1, Dover, 1956.\n",
    "[Hefferon] J Hefferon, Introduction to Proofs, an Inquiry-Based approach,\nhttp://joshua.smcvt.edu/proofs/, 2013.\n",
    "[Hoﬀman & Kunze]",
    "Kenneth Hoﬀman, Ray Kunze, Linear Algebra, second edition,\nPrentice-Hall, 1971.\n",
    "[Hofstadter] Douglas R. Hofstadter, Metamagical Themas: Questing for the Essence\nof Mind and Pattern, Basic Books, 1985.\n",
    "[Hughes et al.]",
    "John F. Hughes, Andries van Dam, Morgan McGuire, David F. Sklar,\nJames D. Foley, Steven K. Feiner, Kurt Akeley, Computer graphics:\nprinciples and practice, third edition, Addison-Wesley, 1995.\n",
    "[Iosifescu] Marius Iofescu, Finite Markov Processes and Their Applications, John\nWiley, 1980.\n\n",
    "[joriki] Mathematics Stack Exchange user joriki,\nhttp://math.stackexchange.com/a/118914/205168, 2012.\n",
    "[Kahan] William Kahan, Chiò’s Trick for Linear Equations with Integer\nCoeﬃcients, http://www.cs.berkeley.edu/~wkahan/MathH110/chio.pdf,\n1998, retrieved 2012-Jun-18.\n",
    "[Kelton] Christina M.L. Kelton, Trends on the Relocation of U.S. Manufacturing,\nUMI Research Press, 1983.\n",
    "[Kemeny & Snell] John G. Kemeny, J. Laurie Snell, Finite Markov Chains, D. Van\nNostrand, 1960.\n",
    "[Kemp] Franklin Kemp Linear Equations, American Mathematical Monthly, volume\n89 number 8 (Oct. 1982), p. 608.\n",
    "[Leontief 1951]",
    "Wassily W. Leontief, Input-Output Economics, Scientiﬁc American,\nvolume 185 number 4 (Oct. 1951), p. 15.\n",
    "[Leontief 1965]",
    "Wassily W. Leontief, The Structure of the U.S. Economy, Scientiﬁc\nAmerican, volume 212 number 4 (Apr. 1965), p. 25.\n",
    "[Macdonald & Ridge] Kenneth Macdonald, John Ridge, Social Mobility, in British\nSocial Trends Since 1900, A.H. Halsey, Macmillian, 1988.\n",
    "[Math. Mag., Sept. 1952]",
    "Dewey Duncan (proposer), W. H. Quelch (solver),\nMathematics Magazine, volume 26 number 1 (Sept-Oct. 1952), p. 48.\n",
    "[Math. Mag., Jan. 1957] M. S. Klamkin (proposer), Trickie T-27, Mathematics\nMagazine, volume 30 number 3 (Jan-Feb. 1957), p. 173.\n",
    "[Math. Mag., Jan. 1963, Q237] D. L. Silverman (proposer), C. W. Trigg (solver),\nQuickie 237, Mathematics Magazine, volume 36 number 1 (Jan. 1963).\n",
    "[Math. Mag., Jan. 1963, Q307] C. W. Trigg (proposer).",
    "Quickie 307, Mathematics\nMagazine, volume 36 number 1 (Jan. 1963), p. 77.\n",
    "[Math. Mag., Nov. 1967]",
    "Clarence C. Morrison (proposer), Quickie, Mathematics\nMagazine, volume 40 number 4 (Nov. 1967), p. 232.\n",
    "[Math. Mag., Jan. 1973]",
    "Marvin Bittinger (proposer), Quickie 578, Mathematics\nMagazine, volume 46 number 5 (Jan. 1973), p. 286, 296.\n",
    "[Mewes] Matthew Mewes, The Slinky Wilberforce pendulum: A simple coupled\noscillator, American Journal of Physics, volume 82, issue 3, March 2014,\np. 254.\n",
    "[Munkres] James R. Munkres, Elementary Linear Algebra, Addison-Wesley, 1964.\n",
    "[Neimi & Riker] Richard G. Neimi, William H. Riker, The Choice of Voting Systems,\nScientiﬁc American, June 1976, p. 21 – 27.\n",
    "[Oakley & Baker] Cletus O. Oakley, Justine C. Baker, Least Squares and the 3 : 40\nMile, Mathematics Teacher, Apr. 1977.\n",
    "[Ohanian] Hans O’Hanian, Physics, volume one, W. W. Norton, 1985.\n",
    "[Onan] Michael Onan, Linear Algebra, Harcourt, 1990.\n\n",
    "[Online Encyclopedia of Integer Sequences] Number of diﬀerent magic squares of\norder n that can be formed from the numbers 1, . . .",
    ", n2,\nhttp://oeis.org/A006052, 2012-Feb-17.\n",
    "[Petersen] G. M. Petersen, Area of a Triangle, American Mathematical Monthly,\nvolume 62 number 4 (Apr. 1955), p. 249.\n",
    "[Polya] G. Polya, Mathematics and Plausible Reasoning, Princeton University Press,\n1954.\n",
    "[Poundstone] W. Poundstone, Gaming the Vote, Hill and Wang, 2008.",
    "ISBN-13:\n978-0-8090-4893-9\n[Putnam, 1990, A-5]",
    "William Lowell Putnam Mathematical Competition, Problem\nA-5, 1990.\n",
    "[Rice]\nJohn R. Rice, Numerical Mathods, Software, and Analysis, second edition,\nAcademic Press, 1993.\n",
    "[Rucker] Rudy Rucker, Inﬁnity and the Mind, Birkhauser, 1982.\n",
    "[Ryan] Patrick J. Ryan, Euclidean and Non-Euclidean Geometry: an Analytic\nApproach, Cambridge University Press, 1986.\n",
    "[Sandifer] Ed Sandifer, How Euler Did It,\nhttp://www.maa.org/news/howeulerdidit.html, 2012-Dec-27.\n",
    "[Schmidt] Jack Schmidt, http://math.stackexchange.com/a/98558/12012,\n2012-Jan-12.\n",
    "[Shepelev] Anton Shepelev, private communication, Feb 19, 2011.\n",
    "[Seidenberg] A. Seidenberg, Lectures in Projective Geometry, Van Nostrand, 1962.\n",
    "[Sheﬀer] Adam Sheﬀer (attributed to Bob Krueger), A Linear Algebra Riddle, blog\npost,\nhttps://adamsheffer.wordpress.com/2018/07/21/linear-algebra-riddle/\nJuly 21, 2018.\n",
    "[Strang 93] Gilbert Strang",
    "The Fundamental Theorem of Linear Algebra, American\nMathematical Monthly, Nov. 1993, p. 848 – 855.\n",
    "[Strang 80] Gilbert Strang, Linear Algebra and its Applications, second edition,\nHarcourt Brace Jovanovich, 1980.\n",
    "[Taylor] Alan D. Taylor, Mathematics and Politics: Strategy, Voting, Power, and\nProof, Springer-Verlag, 1995.\n",
    "[Tilley] Burt Tilley, private communication, 1996.\n",
    "[Trono] Tony Trono, compiler, University of Vermont Mathematics Department\nHigh School Prize Examinations 1958-1991, mimeographed printing, 1991.\n",
    "[USSR Olympiad no. 174]",
    "The USSR Mathematics Olympiad, number 174.\n",
    "[Velleman] Dan Velleman, private communication, on multiset in the deﬁnition of\nlinearly independent set.\n\n",
    "[Velleman2] Daniel J Velleman, How to Prove It: A Structured Approach,\nCambridge University Press, 2006.\n",
    "[Disney] Walt Disney Animation Studios, Disney’s Practical Guide to Path Tracing,\nhttps://www.youtube.com/watch?v=frLwRLS_ZR0 (as of 2020-Apr-11).\n",
    "[Weston] J. D. Weston, Volume in Vector Spaces, American Mathematical Monthly,\nvolume 66 number 7 (Aug./Sept. 1959), p. 575 – 577.\n",
    "[Ward] James E. Ward III, Vector Spaces of Magic Squares, Mathematics Magazine,\nvol 53 no 2 (Mar 1980), p 108 – 111.\n",
    "[Weyl] Hermann Weyl, Symmetry, Princeton University Press, 1952.\n",
    "[Wickens] Thomas D. Wickens, Models for Behavior, W.H. Freeman, 1982.\n",
    "[Wilkinson 1965]",
    "The Algebraic Eigenvalue Problem, J. H. Wilkinson, Oxford\nUniversity Press, 1965\n",
    "[Wikipedia, Lo Shu Square]",
    "Lo Shu Square,\nhttp://en.wikipedia.org/wiki/Lo_Shu_Square, 2012-Feb-17.\n",
    "[Wikipedia, Magic Square]",
    "Magic square,\nhttp://en.wikipedia.org/wiki/Magic_square, 2012-Feb-17.\n",
    "[Wikipedia, Mens Mile] Mile run world record progression,\nhttp://en.wikipedia.org/wiki/Mile_run_world_record_progression,\n2011-Apr-09.\n",
    "[Wikipedia, Square-cube Law]",
    "The Square-cube law,\nhttp://en.wikipedia.org/wiki/Square-cube_law, 2011-Jan-17.\n",
    "[Wikipedia, Google Page Rank] Page Rank,\nhttp://en.wikipedia.org/wiki/PageRank, 2012-Feb-27.\n",
    "[Wills] Rebecca S. Wills, Google’s Page Rank, Mathematical Intelligencer, vol.",
    "28,\nno. 4, Fall 2006.\n",
    "[Wohascum no. 2] The Wohascum County Problem Book problem number 2.\n",
    "[Wohascum no. 47] The Wohascum County Problem Book problem number 47.\n",
    "[Yaglom] I. M. Yaglom, Felix Klein and Sophus Lie: Evolution of the Idea of\nSymmetry in the Nineteenth Century, translated by Sergei Sossinsky,\nBirkhäuser, 1988.\n",
    "[Yuster] Thomas Yuster, The Reduced Row Echelon Form of a Matrix is Unique: a\nSimple Proof, Mathematics Magazine, vol.",
    "57, no. 2 (Mar. 1984), pp.",
    "93-94.\n",
    "[Zwicker] William S. Zwicker, The Voters’ Paradox, Spin, and the Borda Count,\nMathematical Social Sciences, vol. 22 (1991), p. 187 – 227.\n\n",
    "Index\naccuracy\nof Gauss’s Method, 72–75\nrounding error, 74\nadding rows, 5\naddition of vectors, 17, 38, 84\nadditive inverse, 84\nadjacency matrix, 252\nadjoint matrix, 366\nadjugate matrix, 366\naﬃne transformation, 396\nalgebraic multiplicity, 418\nangle, 46\nantipodal points, 384\nantisymmetric matrix, 151\nargument, of a function, A-7\narrow diagram, 238, 256, 262, 267, 402\naugmented matrix, 16\nautomorphism, 177\ndilation, 177\nreﬂection, 178\nrotation, 178\nback-substitution, 5\nbase step, of induction proof, A-3\nbasis, 121–135\nchange of, 262\ndeﬁnition, 121\nJordan chain, 452\nJordan string, 452\northogonal, 281\northogonalization, 282\northonormal, 283\nstandard, 122, 401\nstring, 431\nbean diagram, A-7\nbest ﬁt line, 296\nblock matrix, 345\nbox, 355\norientation, 357\nsense, 357\nvolume, 357\nC language, 72\ncanonical form\nfor matrix equivalence, 271\nfor nilpotent matrices, 435\nfor row equivalence, 61\nfor similarity, 454\ncanonical representative, A-11\nCauchy-Schwarz Inequality, 45\nCayley-Hamilton theorem, 443\ncentral projection, 381\nchange of basis, 262–274\ncharacteristic\nequation, 416\npolynomial, 416\nsatisﬁed by, 445\nroot, 423\nvectors, values, 412\ncharacterize, 184\ncharacterizes, 272\nChemistry problem, 1, 11, 25\nChiò’s method, 376–379\ncircuits\nparallel, 77\nseries, 77\nseries-parallel, 78\nclass\n\nequivalence, A-11\nrepresentative, A-11\nclosure, 100\nof null space, 427\nof range space, 427\ncodomain, A-7\ncofactor, 364\ncolumn, 15\nrank, 137\nfull, 143\nspace, 137\nvector, 16\ncombining rows, 5\ncomplement, A-6\ncomplementary subspaces, 148\northogonal, 288\ncomplete equation, 165\ncomplex numbers, 400\nvector space over, 95, 398\ncomponent of a vector, 16\ncomposition, A-7\nself, 424\ncomputer algebra systems, 65–66\ncomputer graphics, 392–396\nconcatenation of sequences, 146\nconditioning number, 75\ncongruent plane ﬁgures, 319\nconstant polynomial, 398\ncontradiction, A-4\ncontrapositive, A-2\nconvex set, 198\ncoordinates\nhomogeneous, 383, 392\nwith respect to a basis, 124\ncorrespondence, 175, A-9\ncoset, 210\nCoupled Oscillators, 482–486\nCramer’s rule, 369–371\ncross product, 330\ncrystals, 155–158\nunit cell, 156\nda Vinci, Leonardo, 380\ndangling link, 471\ndegree of a polynomial, 398\nDesargue’s Theorem, 387\ndeterminant, 326, 331–354\nCramer’s rule, 370\ndeﬁnition, 332\nexists, 343, 349\nLaplace expansion, 365\nminor, 364\npermutation expansion, 342, 346, 372\nusing cofactors, 364\ndiagonal matrix, 230, 248\ndiagonalizable, 408–412\ndiamond, 157\ndilation, 177, 303\nrepresenting, 221\ndimension, 131\ndimensional\nconstant, 165\nformula, 165\ndirect map, 323\ndirect sum, 144–152\ndeﬁnition, 148\nexternal, 183\ninternal, 183\nof two subspaces, 148\ndirection vector, 39\ndistance-preserving map, 319\ndivision theorem, 398\ndomain, A-7\ndot product, 43\ndouble precision, 74\ndual space, 210\nDuality Principle, of projective geometry,\n386\nechelon form, 6\nfree variable, 13\nleading entry, 15\nleading variable, 6\nmatrix, 15\nreduced, 51\neigenspace, 417\neigenvalue, eigenvector\nof a matrix, 413\nof a transformation, 412\nelement, A-5\nelementary matrix, 250\nelementary reduction matrix, 250, 302\n\nelementary reduction operations, 5\nrescaling, 5\nrow combination, 5\nswapping, 5\nby matrix multiplication, 250\nelementary row operations, 5\nby matrix multiplication, 250\nelimination, Gaussian, 3\nempty set, A-5\nentry, matrix, 15\nequivalence, A-9\nclass, A-11\ncanonical representative, A-11\nrelation, A-9\nrepresentative, A-11\nequivalence relation, A-9\nisomorphism, 184\nmatrix equivalence, 270\nmatrix similarity, 404\nrow equivalence, 53\nequivalent statements, A-2\nErlanger Program, 320\nEuclid, 319\neven functions, 105, 150\neven polynomials, 463\nextended, linearly, 194\nexternal direct sum, 183\nfactor, 399\nﬁeld, 153–154\ndeﬁnition, 153\nﬁnite-dimensional vector space, 129\nﬂat, k-ﬂat, 40\nfree variable, 13\nfull column rank, 143\nfull row rank, 143\nfunction, A-7\ninverse image, 201\nargument, A-7\nbean diagram, A-7\ncodomain, A-7\ncomposition, 238, A-7\ncorrespondence, A-9\ndistance-preserving, 319\ndomain, A-7\neven, 105\nextended linearly, 194\nidentity, A-8\nimage, A-7\ninverse, 255, A-8\nleft inverse, 255\nmultilinear, 338\nodd, 105\none-to-one, A-8\nonto, A-8\nrange, A-7\nrestriction, A-9\nright inverse, 255\nstructure preserving, 175, 179\nsee homomorphism 191\ntwo-sided inverse, 255\nvalue, A-7\nwell-deﬁned, A-7\nzero, 192\nFundamental Theorem\nof Algebra, 400\nof Linear Algebra, 294\nGauss’s Method, 3\naccuracy, 72–75\nback-substitution, 5\nby matrix multiplication, 250\nelementary operations, 5\nGauss-Jordan, 51\nGauss-Jordan Method, 51\nGaussian elimination, 3\ngeneralized null space, 427\ngeneralized range space, 427\ngenerated, 27\ngenerated by, 27\ngeometric multiplicity, 418\nGeometry of Linear Maps, 301–307\nGoogle matrix, 472\nGram-Schmidt process, 280–285\ngraphite, 156\nhistoryless process, 314\nhomogeneous coordinate vector, 383, 392\nhomogeneous coordinates, 324\nhomogeneous equation, 24\nhomomorphism, 191\ncomposition, 238\n\nmatrix representing, 212–222, 224\nnonsingular, 227\nnull space, 204\nnullity, 204\nrange space, 200\nrank, 225\nsingular, 227\nzero, 192\nhyperplane, 40\nideal\nline, 386\npoint, 386\nidentity\nfunction, A-8\nmatrix, 247\nif-then statement, A-2\nill-conditioned problem, 73\nimage, under a function, A-7\nindex of nilpotency, 430\ninduction, 26, A-3\ninductive hypothesis, A-3\ninduction, mathematical, A-3\ninductive hypothesis, A-3\ninductive step, of induction proof, A-3\ninherited operations, 85\ninner product, 43\nInput-Output Analysis, 67–71\ninternal direct sum, 148, 183\nintersection, of sets, A-6\ninvariant subspace, 439, 456\ninverse, 255, A-8\nadditive, 84\nexists, 256\nfunction, A-8\nleft, A-8\nright, A-8\nleft, 255, A-8\nmatrix, 366\nright, 255, A-8\ntwo-sided, A-8\ninverse function, 255, A-8\ninverse image, 201\ninversion, 347, A-8\nirreducible polynomial, 399\nisometry, 319\nisomorphism, 173–190\nclasses characterized by dimension,\n184\ndeﬁnition, 175\nof a space with itself, 177\nJordan block, 452, 454\nJordan chain, 452\nJordan form, 440–463\ndeﬁnition, 454\nrepresents similarity classes, 454\nJordan string, 452\nkernel, of linear map, 204\nKirchhoﬀ’s Laws, 77\nKlein, F., 319\nLaplace determinant expansion, 363–368\nLast Supper, 380\nleading\nentry, 15\nvariable, 6\nleast squares, 295–300\nleft inverse, A-8\nlength of a vector, 42\nLeontief, W., 67\nline, 38\nbest ﬁt, 296\nin projective plane, 385\nline at inﬁnity, 386\nline of best ﬁt, 295–300\nlinear combination, 2\nLinear Combination Lemma, 57\nlinear elimination, 3\nlinear equation, 2\ncoeﬃcients, 2\nconstant, 2\nhomogeneous, 24\ninconsistent systems, 295\nsatisﬁed by a vector, 17\nsolution of, 2\nCramer’s rule, 370\nGauss’s Method, 4\nGauss-Jordan, 51\nsystem of, 2\nlinear extension of a function, 194\n\nlinear independence\nmultiset, 113\nlinear map, 191, see also homomorphism\ndilation, 303\nreﬂection, 303, 322\nrotation, 302, 322\nshear, 304\ntrace, 462\nlinear maps, vector space of, 195\nlinear recurrence, 474–481\ndeﬁnition, 476\nlinear relationship, 110\nlinear surface, 40\nlinear transformation, 195, see also trans-\nformation\nlinearly dependent, 109\nlinearly independent, 109\nlink\ndangling, 471\nsink, 471\nLINPACK, 65\nmagic square, 308–312\ndeﬁnition, 308\nnormal, 309\nmap, A-7\ndistance-preserving, 319\nself composition, 424\nMaple, 65\nMarkov chain, 313–318\ndeﬁnition, 314\nhistoryless, 314\nMathematica, 65\nmathematical induction, 26, A-3\nMATLAB, 65\nmatrices, {o}f15\nmatrix, 15\nadjacency, 252\nadjoint, 366\nadjugate, 366\nantisymmetric, 151\naugmented, 16\nblock, 271, 345\nchange of basis, 262\ncharacteristic polynomial, 416\ncolumn, 15\ncolumn space, 137\nconditioning number, 75\ndeterminant, 326, 332\ndiagonal, 230, 248\ndiagonalizable, 408\ndiagonalized, 270\nechelon form, 15\nelementary, 250\nelementary reduction, 250, 302\nentry, 15\nequivalent, 270\nGoogle, 472\nidentity, 244, 247\ninverse, 254–261, 366\ninverse, deﬁnition, 255\nmagic square, 308\nmain diagonal, 247\nMarkov, 253\nmatrix-vector product, 215\nminimal polynomial, 244, 441\nminor, 364\nmultiplication, 237\nnilpotent, 430\nnonsingular, 30, 227\northogonal, 321\northonormal, 319–324\npermutation, 248, 341\nrank, 225\nrepresentation, 214\nrow, 15\nrow equivalence, 53\nrow rank, 136\nrow space, 136\nscalar multiple, 233\nscalar multiplication, 17\nsimilar, 361\nsimilarity, 404\nsingular, 30\nskew-symmetric, 345\nsparse, 464\nstochastic, 314, 473\nsubmatrix, 336\nsum, 17, 233\nsymmetric, 128, 151, 235, 243, 252,\n294\n\ntrace, 235, 253, 309, 462\ntransition, 314\ntranspose, 22, 138, 235\ntriangular, 222, 253, 368\ntridiagonal, 466\nunit, 245\nVandermonde, 345\nzero, 234\nmatrix equivalence, 267–274\ncanonical form, 271\ndeﬁnition, 270\nmember, A-5\nmethod of powers, 464–467\nminimal polynomial, 244, 441\nminor, of a matrix, 364\nmorphism, 175\nmultilinear, 338\nmultiplication\nmatrix-matrix, 237\nmatrix-vector, 215\nmultiplicity\nalgebraic, 418\ngeometric, 418\nmultiplicity, of a root, 399\nmultiset, 113, A-6\nmutual inclusion, A-5\nnatural representative, A-11\nnetworks, 76–81\nKirchhoﬀ’s Laws, 77\nnilpotency, index of, 430\nnilpotent, 428–439\ncanonical form for, 435\ndeﬁnition, 430\nmatrix, 430\ntransformation, 430\nnonsingular, 227, 256\nhomomorphism, 227\nmatrix, 30\nnormalize, vector, 43, 283\nnull space, 204\nclosure of, 427\ngeneralized, 427\nnullity, 204\nodd function, 105, 150\none-to-one function, A-8\nonto function, A-8\nopposite map, 323\nordered pair, A-7\norientation, 357, 361\norientation preserving map, 323\norientation reversing map, 323\northogonal, 46\nbasis, 281\ncomplement, 288\nmutually, 280\nprojection, 288\northogonal matrix, 321\northogonalization, 282\northonormal basis, 283\northonormal matrix, 319–324\npage ranking, 470–473\npair, ordered, A-7\nparallelepiped, 355\nparallelogram rule, 38\nparameter, 14\nparametrized, 14\npartial pivoting, 74\npartition, A-9–A-11\ninto isomorphism classes, 184\nmatrix equivalence classes, 270, 272\nrow equivalence classes, 53\npermutation, 341\ninversions, 347\nmatrix, 248\nsignum, 349\npermutation expansion, 342, 346, 372\npermutation matrix, 341\nperp, of a subspace, 288\nperpendicular, 46\nperspective, triangles, 387\nphysical dimension, 165\npivoting, 51\nfull, 74\npartial\nscaled, 75\nplane ﬁgure, 319\ncongruence, 319\npoint\nat inﬁnity, 386\n\nin projective plane, 383, 392\npolynomial, 398\nassociated with recurrence, 478\nconstant, 398\ndegree, 398\ndivision theorem, 398\neven, 463\nfactor, 399\nirreducible, 399\nleading coeﬃcient, 398\nminimal, 441\nmultiplicity, 399\nof map, matrix, 440\nroot, 399\npopulations, stable, 468–469\npotential, electric, 76\npowers, method of, 464–467\npreserves structure, 191\nprobability vector, 314\nprojection, 191, 201, 275, 294, 447\nalong a subspace, 286\ncentral, 381\nvanishing point, 380\ninto a line, 276\ninto a subspace, 286\northogonal, 276, 288\nprojective geometry, 380–391\nprojective plane\nideal line, 386\nideal point, 386\nlines, 385\nprojective transformation, 396\nproof techniques, A-3–A-5\ninduction, 26\nproper subset, A-5\nproper subspace, 97\npropositions\nequivalent, A-2\nquantiﬁer, A-2\nexistential, A-3\nuniversal, A-2\nquantiﬁers, A-2\nrange, A-7\nrange space, 200\nclosure of, 427\ngeneralized, 427\nrank, 140, 225\ncolumn, 137\nof a homomorphism, 200, 205\nrecurrence, 364, 474, 476\nassociated polynomial, 478\ninitial conditions, 476\nrecurrence relation, 474–481\nreduced echelon form, 51\nreﬂection, 303, 322\nglide, 323\nreﬂection (or ﬂip) about a line, 178\nreﬂexivity, of a relation, A-9\nrelation, A-9\nequivalence, A-9\nreﬂexive, A-9\nsymmetric, A-9\ntransitive, A-9\nrelationship\nlinear, 110\nrepresentation\nof a matrix, 214\nof a vector, 124\nrepresentative\ncanonical, A-11\nclass, A-11\nfor row equivalence classes, 61\nof matrix equivalence classes, 271\nof similarity classes, 456\nrescaling rows, 5\nresistance, 76\nresistance:equivalent, 80\nresistor, 77\nrestriction, A-9\nright inverse, A-8\nrigid motion, 319\nroot, 399\ncharacteristic, 423\nrotation, 302, 322, 393\nrotation (or turning), 178\nrepresented, 217\nrow, 15\nrank, 136\nvector, 16\n\nrow equivalence, 53\nrow rank, 136\nfull, 143\nrow space, 136\nRule of Sarrus, 379\nSage, 65\nsalt, 155\nSarrus, Rule of, 379\nscalar, 84\nscalar multiple\nmatrix, 233\nvector, 17, 37, 84\nscalar multiplication\nmatrix, 17\nscalar product, 43\nscaled partial pivoting, 75\nSchwarz Inequality, 45\nself composition\nof maps, 424\nsense, 357\nsensitivity analysis, 258\nsequence, A-7\nconcatenation, 146\nset, A-5\ncomplement, A-6\nelement, A-5\nempty, A-5\nintersection, A-6\nmember, A-5\nunion, A-6\nsets, A-5\ndependent, independent, 109\nempty, 112\nmultiset, 113\nmutual inclusion, A-5\nproper subset, A-5\nspan of, 100\nsubset, A-5\nsgn\nsee signum, 349\nshear, 304, 395\nshift, 429\nsignum, 349\nsimilar, 331, 361\ncanonical form, 454\nsimilar matrices, 404\nsimilar triangles, 323\nsimilarity, 402–423\nsimilarity transformation, 423\nsingle precision, 72\nsingular\nhomomorphism, 227\nmatrix, 30\nsink link, 471\nsize, 356, 358\nskew-symmetric, 345\nspan, 27, 100\nof a singleton, 105\nspanned by, 27\nsparse matrix, 464\nspin, 162\nsquare root, 463\nstable populations, 468–469\nstandard basis, 122, 401\ncomplex number scalars, 401\nstate, 313\nStatics problem, 1, 5\nstochastic matrix, 314, 473\nstring, 431\nbasis, 431\nof basis vectors, 429\nstructure\npreservation, 191\nsubmatrix, 336\nsubset, proper, A-5\nsubspace, 96–107\nclosed, 98\ncomplementary, 148\ndeﬁnition, 96\ndirect sum, 148\nindependence, 147\ninvariant, 456\nproper, 97\nsum, 144\ntrivial, 97\nsum\nmatrix, 17\nof matrices, 233\nof subspaces, 144\nvector, 17, 37, 84\n\nsummation notation, for permutation ex-\npansion, 342\nswapping rows, 5\nsymmetric matrix, 128, 151, 235, 243\nsymmetry, of a relation, A-9\nsystem of linear equations, 2\nelimination, 3\nGauss’s Method, 3\nGaussian elimination, 3\nlinear elimination, 3\nsolving, 3\nTower of Hanoi, 478\ntrace, 235, 253, 309, 462\ntransformation\ncharacteristic polynomial, 416\ncomposed with itself, 424\ndiagonalizable, 408\neigenspace, 417\neigenvalue, eigenvector, 412\nJordan form for, 454\nminimal polynomial, 441\nnilpotent, 430\ncanonical representative, 435\nprojection, 447\nshift, 429\nsize change, 358\ntransition matrix, 314\ntransitivity, of a relation, A-9\ntranslation, 320, 394\ntranspose, 22, 138\ndeterminant, 343, 352\ninteraction with sum and scalar mul-\ntiplication, 235\nis linear, 143\nTriangle Inequality, 44\ntriangles, similar, 323\ntriangular matrix, 253\nTriangularization, 222\ntridiagonal form, 466\ntrivial space, 88, 122\ntrivial subspace, 97\nturning map, 178\nunion of sets, A-6\nunit matrix, 245\nvacuously true, A-2\nvalue, of a function, A-7\nVandermonde matrix, 345\nvanishing point, 380\nvector, 16, 36\nangle, 46\ncanonical position, 37\ncolumn, 16\ncomponent, 16\ncross product, 330\ndirection, 39\ndot product, 43\nfree, 36\nhomogeneous coordinate, 383, 392\nlength, 42\nnatural position, 37\nnormalize, 43\northogonal, 46\nperpendicular, 46\nprobability, 314\nrepresentation of, 124, 262\nrow, 16\nsatisﬁes an equation, 17\nscalar multiple, 17, 37, 84\nstandard position, 37\nsum, 17, 37, 38, 84\nunit, 48\nzero, 16\nvector space, 84–107\nbasis, 121\nclosure, 84\ncomplex scalars, 95\ndeﬁnition, 84\ndimension, 131\ndual, 210\nﬁnite dimensional, 129\nhomomorphism, 191\nisomorphism, 175\nmap, 191\nof matrices, 89\nof polynomials, 89\nover complex numbers, 397\nsubspace, 96\ntrivial, 88, 122\nVenn diagram, A-5\n\nvoltage drop, 77\nvolume, 357\nvoting paradox, 159–164\ndeﬁnition, 159\nmajority cycle, 159\nrational preference order, 160\nspin, 162\nwell-deﬁned, 185, 186, A-7\nWheatstone bridge, 78, 80\nWilberforce pendulum, 482\nzero division, 261\nzero divisor, 243\nzero homomorphism, 192\nzero matrix, 234\nzero vector, 16, 84\n\n"
  ]
}